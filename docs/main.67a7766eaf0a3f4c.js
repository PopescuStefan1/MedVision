(self.webpackChunklicentaApp=self.webpackChunklicentaApp||[]).push([[179],{2011:(kt,et,z)=>{"use strict";z.d(et,{Dh:()=>tt,GT:()=>je,cc:()=>Ce,on:()=>ne,pX:()=>He,xv:()=>Ne});var B=z(4650),Ee=z(9260);kt=z.hmd(kt);const te=["ngOnDestroy"],He=($e,Je,Gt,an={})=>new Proxy($e,{get:(nt,Pe)=>Gt.runOutsideAngular(()=>{var Oe;if($e[Pe])return!(null===(Oe=an?.spy)||void 0===Oe)&&Oe.get&&an.spy.get(Pe,$e[Pe]),$e[Pe];if(te.indexOf(Pe)>-1)return()=>{};const be=Je.toPromise().then(he=>{const J=he&&he[Pe];return"function"==typeof J?J.bind(he):J&&J.then?J.then(a=>Gt.run(()=>a)):Gt.run(()=>J)});return new Proxy(()=>{},{get:(he,J)=>be[J],apply:(he,J,a)=>be.then(Ft=>{var Wt;const bn=Ft&&Ft(...a);return!(null===(Wt=an?.spy)||void 0===Wt)&&Wt.apply&&an.spy.apply(Pe,a,bn),bn})})})}),je=($e,Je)=>{Je.forEach(Gt=>{Object.getOwnPropertyNames(Gt.prototype||Gt).forEach(an=>{Object.defineProperty($e.prototype,an,Object.getOwnPropertyDescriptor(Gt.prototype||Gt,an))})})};class Re{constructor(Je){return Je}}const tt=new B.OlP("angularfire2.app.options"),Ne=new B.OlP("angularfire2.app.name");function ne($e,Je,Gt){const nt="object"==typeof Gt&&Gt||{};nt.name=nt.name||"string"==typeof Gt&&Gt||"[DEFAULT]";const Oe=Ee.Z.apps.filter(be=>be&&be.name===nt.name)[0]||Je.runOutsideAngular(()=>Ee.Z.initializeApp($e,nt));try{JSON.stringify($e)!==JSON.stringify(Oe.options)&&K("error",`${Oe.name} Firebase App already initialized with different options${kt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new Re(Oe)}const K=($e,...Je)=>{(0,B.X6Q)()&&typeof console<"u"&&console[$e](...Je)};function Ce($e,Je,Gt,an,nt){const[,Pe,Oe]=globalThis.\u0275AngularfireInstanceCache.find(be=>be[0]===$e)||[];if(Pe)return function Ue($e,Je){try{return $e.toString()===Je.toString()}catch{return $e===Je}}(nt,Oe)||(Dt("error",`${Je} was already initialized on the ${Gt} Firebase App with different settings.${Ae?" You may need to reload as Firebase is not HMR aware.":""}`),Dt("warn",{is:nt,was:Oe})),Pe;{const be=an();return globalThis.\u0275AngularfireInstanceCache.push([$e,be,nt]),be}}const Ae=!!kt.hot,Dt=($e,...Je)=>{(0,B.X6Q)()&&typeof console<"u"&&console[$e](...Je)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},2090:(kt,et,z)=>{"use strict";z.d(et,{$s:()=>gd,BH:()=>Oe,DV:()=>lr,Dv:()=>Cc,G6:()=>vr,GJ:()=>Ls,L:()=>ne,LL:()=>Te,Pz:()=>Pe,Rd:()=>Ue,Sg:()=>be,UG:()=>a,UI:()=>Mt,US:()=>Re,Wj:()=>ji,Wl:()=>Fn,Yr:()=>Or,ZB:()=>X,ZR:()=>Le,aH:()=>nt,b$:()=>bn,cI:()=>Qt,dS:()=>pd,eu:()=>un,g5:()=>te,gK:()=>Ai,gQ:()=>Br,h$:()=>Ne,hl:()=>sr,hu:()=>Ee,jU:()=>Ft,k$:()=>Do,lb:()=>xc,m9:()=>sl,ne:()=>wc,p$:()=>ee,pd:()=>Js,r3:()=>Jn,ru:()=>Wt,tV:()=>K,uI:()=>J,ug:()=>md,vZ:()=>fn,w1:()=>Sr,w9:()=>Ar,xO:()=>Rh,xb:()=>Wn,z$:()=>he,zI:()=>ke,zd:()=>nl});const Ee=function(ae,ie){if(!ae)throw te(ie)},te=function(ae){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+ae)},He=function(ae){const ie=[];let me=0;for(let Ge=0;Ge<ae.length;Ge++){let Se=ae.charCodeAt(Ge);Se<128?ie[me++]=Se:Se<2048?(ie[me++]=Se>>6|192,ie[me++]=63&Se|128):55296==(64512&Se)&&Ge+1<ae.length&&56320==(64512&ae.charCodeAt(Ge+1))?(Se=65536+((1023&Se)<<10)+(1023&ae.charCodeAt(++Ge)),ie[me++]=Se>>18|240,ie[me++]=Se>>12&63|128,ie[me++]=Se>>6&63|128,ie[me++]=63&Se|128):(ie[me++]=Se>>12|224,ie[me++]=Se>>6&63|128,ie[me++]=63&Se|128)}return ie},Re={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(ae,ie){if(!Array.isArray(ae))throw Error("encodeByteArray takes an array as a parameter");this.init_();const me=ie?this.byteToCharMapWebSafe_:this.byteToCharMap_,Ge=[];for(let Se=0;Se<ae.length;Se+=3){const wt=ae[Se],yt=Se+1<ae.length,Rt=yt?ae[Se+1]:0,Nr=Se+2<ae.length,It=Nr?ae[Se+2]:0;let er=(15&Rt)<<2|It>>6,to=63&It;Nr||(to=64,yt||(er=64)),Ge.push(me[wt>>2],me[(3&wt)<<4|Rt>>4],me[er],me[to])}return Ge.join("")},encodeString(ae,ie){return this.HAS_NATIVE_SUPPORT&&!ie?btoa(ae):this.encodeByteArray(He(ae),ie)},decodeString(ae,ie){return this.HAS_NATIVE_SUPPORT&&!ie?atob(ae):function(ae){const ie=[];let me=0,Ge=0;for(;me<ae.length;){const Se=ae[me++];if(Se<128)ie[Ge++]=String.fromCharCode(Se);else if(Se>191&&Se<224){const wt=ae[me++];ie[Ge++]=String.fromCharCode((31&Se)<<6|63&wt)}else if(Se>239&&Se<365){const Nr=((7&Se)<<18|(63&ae[me++])<<12|(63&ae[me++])<<6|63&ae[me++])-65536;ie[Ge++]=String.fromCharCode(55296+(Nr>>10)),ie[Ge++]=String.fromCharCode(56320+(1023&Nr))}else{const wt=ae[me++],yt=ae[me++];ie[Ge++]=String.fromCharCode((15&Se)<<12|(63&wt)<<6|63&yt)}}return ie.join("")}(this.decodeStringToByteArray(ae,ie))},decodeStringToByteArray(ae,ie){this.init_();const me=ie?this.charToByteMapWebSafe_:this.charToByteMap_,Ge=[];for(let Se=0;Se<ae.length;){const wt=me[ae.charAt(Se++)],Rt=Se<ae.length?me[ae.charAt(Se)]:0;++Se;const It=Se<ae.length?me[ae.charAt(Se)]:64;++Se;const on=Se<ae.length?me[ae.charAt(Se)]:64;if(++Se,null==wt||null==Rt||null==It||null==on)throw new tt;Ge.push(wt<<2|Rt>>4),64!==It&&(Ge.push(Rt<<4&240|It>>2),64!==on&&Ge.push(It<<6&192|on))}return Ge},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let ae=0;ae<this.ENCODED_VALS.length;ae++)this.byteToCharMap_[ae]=this.ENCODED_VALS.charAt(ae),this.charToByteMap_[this.byteToCharMap_[ae]]=ae,this.byteToCharMapWebSafe_[ae]=this.ENCODED_VALS_WEBSAFE.charAt(ae),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[ae]]=ae,ae>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(ae)]=ae,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(ae)]=ae)}}};class tt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ne=function(ae){const ie=He(ae);return Re.encodeByteArray(ie,!0)},ne=function(ae){return Ne(ae).replace(/\./g,"")},K=function(ae){try{return Re.decodeString(ae,!0)}catch(ie){console.error("base64Decode failed: ",ie)}return null};function ee(ae){return X(void 0,ae)}function X(ae,ie){if(!(ie instanceof Object))return ie;switch(ie.constructor){case Date:return new Date(ie.getTime());case Object:void 0===ae&&(ae={});break;case Array:ae=[];break;default:return ie}for(const me in ie)!ie.hasOwnProperty(me)||!Ce(me)||(ae[me]=X(ae[me],ie[me]));return ae}function Ce(ae){return"__proto__"!==ae}function Ue(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Je=()=>{try{return Ue().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const ae=process.env.__FIREBASE_DEFAULTS__;return ae?JSON.parse(ae):void 0})()||(()=>{if(typeof document>"u")return;let ae;try{ae=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const ie=ae&&K(ae[1]);return ie&&JSON.parse(ie)})()}catch(ae){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${ae}`)}},nt=()=>{var ae;return null===(ae=Je())||void 0===ae?void 0:ae.config},Pe=ae=>{var ie;return null===(ie=Je())||void 0===ie?void 0:ie[`_${ae}`]};class Oe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((ie,me)=>{this.resolve=ie,this.reject=me})}wrapCallback(ie){return(me,Ge)=>{me?this.reject(me):this.resolve(Ge),"function"==typeof ie&&(this.promise.catch(()=>{}),1===ie.length?ie(me):ie(me,Ge))}}}function be(ae,ie){if(ae.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Ge=ie||"demo-project",Se=ae.iat||0,wt=ae.sub||ae.user_id;if(!wt)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const yt=Object.assign({iss:`https://securetoken.google.com/${Ge}`,aud:Ge,iat:Se,exp:Se+3600,auth_time:Se,sub:wt,user_id:wt,firebase:{sign_in_provider:"custom",identities:{}}},ae);return[ne(JSON.stringify({alg:"none",type:"JWT"})),ne(JSON.stringify(yt)),""].join(".")}function he(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function J(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(he())}function a(){var ae;const ie=null===(ae=Je())||void 0===ae?void 0:ae.forceEnvironment;if("node"===ie)return!0;if("browser"===ie)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Ft(){return"object"==typeof self&&self.self===self}function Wt(){const ae="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof ae&&void 0!==ae.id}function bn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Sr(){const ae=he();return ae.indexOf("MSIE ")>=0||ae.indexOf("Trident/")>=0}function Or(){return!1}function vr(){return!a()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sr(){try{return"object"==typeof indexedDB}catch{return!1}}function un(){return new Promise((ae,ie)=>{try{let me=!0;const Ge="validate-browser-context-for-indexeddb-analytics-module",Se=self.indexedDB.open(Ge);Se.onsuccess=()=>{Se.result.close(),me||self.indexedDB.deleteDatabase(Ge),ae(!0)},Se.onupgradeneeded=()=>{me=!1},Se.onerror=()=>{var wt;ie((null===(wt=Se.error)||void 0===wt?void 0:wt.message)||"")}}catch(me){ie(me)}})}function ke(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class Le extends Error{constructor(ie,me,Ge){super(me),this.code=ie,this.customData=Ge,this.name="FirebaseError",Object.setPrototypeOf(this,Le.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Te.prototype.create)}}class Te{constructor(ie,me,Ge){this.service=ie,this.serviceName=me,this.errors=Ge}create(ie,...me){const Ge=me[0]||{},Se=`${this.service}/${ie}`,wt=this.errors[ie],yt=wt?function ft(ae,ie){return ae.replace(ct,(me,Ge)=>{const Se=ie[Ge];return null!=Se?String(Se):`<${Ge}?>`})}(wt,Ge):"Error";return new Le(Se,`${this.serviceName}: ${yt} (${Se}).`,Ge)}}const ct=/\{\$([^}]+)}/g;function Qt(ae){return JSON.parse(ae)}function Fn(ae){return JSON.stringify(ae)}const kr=function(ae){let ie={},me={},Ge={},Se="";try{const wt=ae.split(".");ie=Qt(K(wt[0])||""),me=Qt(K(wt[1])||""),Se=wt[2],Ge=me.d||{},delete me.d}catch{}return{header:ie,claims:me,data:Ge,signature:Se}},Ar=function(ae){const me=kr(ae).claims;return!!me&&"object"==typeof me&&me.hasOwnProperty("iat")},Ls=function(ae){const ie=kr(ae).claims;return"object"==typeof ie&&!0===ie.admin};function Jn(ae,ie){return Object.prototype.hasOwnProperty.call(ae,ie)}function lr(ae,ie){if(Object.prototype.hasOwnProperty.call(ae,ie))return ae[ie]}function Wn(ae){for(const ie in ae)if(Object.prototype.hasOwnProperty.call(ae,ie))return!1;return!0}function Mt(ae,ie,me){const Ge={};for(const Se in ae)Object.prototype.hasOwnProperty.call(ae,Se)&&(Ge[Se]=ie.call(me,ae[Se],Se,ae));return Ge}function fn(ae,ie){if(ae===ie)return!0;const me=Object.keys(ae),Ge=Object.keys(ie);for(const Se of me){if(!Ge.includes(Se))return!1;const wt=ae[Se],yt=ie[Se];if(hr(wt)&&hr(yt)){if(!fn(wt,yt))return!1}else if(wt!==yt)return!1}for(const Se of Ge)if(!me.includes(Se))return!1;return!0}function hr(ae){return null!==ae&&"object"==typeof ae}function Rh(ae){const ie=[];for(const[me,Ge]of Object.entries(ae))Array.isArray(Ge)?Ge.forEach(Se=>{ie.push(encodeURIComponent(me)+"="+encodeURIComponent(Se))}):ie.push(encodeURIComponent(me)+"="+encodeURIComponent(Ge));return ie.length?"&"+ie.join("&"):""}function nl(ae){const ie={};return ae.replace(/^\?/,"").split("&").forEach(Ge=>{if(Ge){const[Se,wt]=Ge.split("=");ie[decodeURIComponent(Se)]=decodeURIComponent(wt)}}),ie}function Js(ae){const ie=ae.indexOf("?");if(!ie)return"";const me=ae.indexOf("#",ie);return ae.substring(ie,me>0?me:void 0)}class Br{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let ie=1;ie<this.blockSize;++ie)this.pad_[ie]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(ie,me){me||(me=0);const Ge=this.W_;if("string"==typeof ie)for(let on=0;on<16;on++)Ge[on]=ie.charCodeAt(me)<<24|ie.charCodeAt(me+1)<<16|ie.charCodeAt(me+2)<<8|ie.charCodeAt(me+3),me+=4;else for(let on=0;on<16;on++)Ge[on]=ie[me]<<24|ie[me+1]<<16|ie[me+2]<<8|ie[me+3],me+=4;for(let on=16;on<80;on++){const er=Ge[on-3]^Ge[on-8]^Ge[on-14]^Ge[on-16];Ge[on]=4294967295&(er<<1|er>>>31)}let It,Zt,Se=this.chain_[0],wt=this.chain_[1],yt=this.chain_[2],Rt=this.chain_[3],Nr=this.chain_[4];for(let on=0;on<80;on++){on<40?on<20?(It=Rt^wt&(yt^Rt),Zt=1518500249):(It=wt^yt^Rt,Zt=1859775393):on<60?(It=wt&yt|Rt&(wt|yt),Zt=2400959708):(It=wt^yt^Rt,Zt=3395469782);const er=(Se<<5|Se>>>27)+It+Nr+Zt+Ge[on]&4294967295;Nr=Rt,Rt=yt,yt=4294967295&(wt<<30|wt>>>2),wt=Se,Se=er}this.chain_[0]=this.chain_[0]+Se&4294967295,this.chain_[1]=this.chain_[1]+wt&4294967295,this.chain_[2]=this.chain_[2]+yt&4294967295,this.chain_[3]=this.chain_[3]+Rt&4294967295,this.chain_[4]=this.chain_[4]+Nr&4294967295}update(ie,me){if(null==ie)return;void 0===me&&(me=ie.length);const Ge=me-this.blockSize;let Se=0;const wt=this.buf_;let yt=this.inbuf_;for(;Se<me;){if(0===yt)for(;Se<=Ge;)this.compress_(ie,Se),Se+=this.blockSize;if("string"==typeof ie){for(;Se<me;)if(wt[yt]=ie.charCodeAt(Se),++yt,++Se,yt===this.blockSize){this.compress_(wt),yt=0;break}}else for(;Se<me;)if(wt[yt]=ie[Se],++yt,++Se,yt===this.blockSize){this.compress_(wt),yt=0;break}}this.inbuf_=yt,this.total_+=me}digest(){const ie=[];let me=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let Se=this.blockSize-1;Se>=56;Se--)this.buf_[Se]=255&me,me/=256;this.compress_(this.buf_);let Ge=0;for(let Se=0;Se<5;Se++)for(let wt=24;wt>=0;wt-=8)ie[Ge]=this.chain_[Se]>>wt&255,++Ge;return ie}}function wc(ae,ie){const me=new So(ae,ie);return me.subscribe.bind(me)}class So{constructor(ie,me){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=me,this.task.then(()=>{ie(this)}).catch(Ge=>{this.error(Ge)})}next(ie){this.forEachObserver(me=>{me.next(ie)})}error(ie){this.forEachObserver(me=>{me.error(ie)}),this.close(ie)}complete(){this.forEachObserver(ie=>{ie.complete()}),this.close()}subscribe(ie,me,Ge){let Se;if(void 0===ie&&void 0===me&&void 0===Ge)throw new Error("Missing Observer.");Se=function Pr(ae,ie){if("object"!=typeof ae||null===ae)return!1;for(const me of ie)if(me in ae&&"function"==typeof ae[me])return!0;return!1}(ie,["next","error","complete"])?ie:{next:ie,error:me,complete:Ge},void 0===Se.next&&(Se.next=rl),void 0===Se.error&&(Se.error=rl),void 0===Se.complete&&(Se.complete=rl);const wt=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?Se.error(this.finalError):Se.complete()}catch{}}),this.observers.push(Se),wt}unsubscribeOne(ie){void 0===this.observers||void 0===this.observers[ie]||(delete this.observers[ie],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(ie){if(!this.finalized)for(let me=0;me<this.observers.length;me++)this.sendOne(me,ie)}sendOne(ie,me){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[ie])try{me(this.observers[ie])}catch(Ge){typeof console<"u"&&console.error&&console.error(Ge)}})}close(ie){this.finalized||(this.finalized=!0,void 0!==ie&&(this.finalError=ie),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rl(){}const Cc=function(ae,ie,me,Ge){let Se;if(Ge<ie?Se="at least "+ie:Ge>me&&(Se=0===me?"none":"no more than "+me),Se)throw new Error(ae+" failed: Was called with "+Ge+(1===Ge?" argument.":" arguments.")+" Expects "+Se+".")};function Ai(ae,ie){return`${ae} failed: ${ie} argument `}function ji(ae,ie,me,Ge){if((!Ge||me)&&"function"!=typeof me)throw new Error(Ai(ae,ie)+"must be a valid function.")}function xc(ae,ie,me,Ge){if((!Ge||me)&&("object"!=typeof me||null===me))throw new Error(Ai(ae,ie)+"must be a valid context object.")}const pd=function(ae){const ie=[];let me=0;for(let Ge=0;Ge<ae.length;Ge++){let Se=ae.charCodeAt(Ge);if(Se>=55296&&Se<=56319){const wt=Se-55296;Ge++,Ee(Ge<ae.length,"Surrogate pair missing trail surrogate."),Se=65536+(wt<<10)+(ae.charCodeAt(Ge)-56320)}Se<128?ie[me++]=Se:Se<2048?(ie[me++]=Se>>6|192,ie[me++]=63&Se|128):Se<65536?(ie[me++]=Se>>12|224,ie[me++]=Se>>6&63|128,ie[me++]=63&Se|128):(ie[me++]=Se>>18|240,ie[me++]=Se>>12&63|128,ie[me++]=Se>>6&63|128,ie[me++]=63&Se|128)}return ie},md=function(ae){let ie=0;for(let me=0;me<ae.length;me++){const Ge=ae.charCodeAt(me);Ge<128?ie++:Ge<2048?ie+=2:Ge>=55296&&Ge<=56319?(ie+=4,me++):ie+=3}return ie},Do=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,ae=>{const ie=16*Math.random()|0;return("x"===ae?ie:3&ie|8).toString(16)})};function gd(ae,ie=1e3,me=2){const Ge=ie*Math.pow(me,ae),Se=Math.round(.5*Ge*(Math.random()-.5)*2);return Math.min(144e5,Ge+Se)}function sl(ae){return ae&&ae._delegate?ae._delegate:ae}},2116:(kt,et,z)=>{"use strict";var B={};z.r(B),z.d(B,{CompositeArrayBuffer:()=>rd,browserFiles:()=>k$e,browserHTTPRequest:()=>F$e,concatenateArrayBuffers:()=>lce,copyModel:()=>t$e,decodeWeights:()=>rce,decodeWeightsStream:()=>oce,encodeWeights:()=>a8,fromMemory:()=>L$e,fromMemorySync:()=>Oce,getLoadHandlers:()=>zLe,getModelArtifactsForJSON:()=>f8,getModelArtifactsForJSONSync:()=>dce,getModelArtifactsInfoForJSON:()=>zN,getSaveHandlers:()=>hce,getWeightSpecs:()=>m8,http:()=>R8,isHTTPScheme:()=>N8,listModels:()=>JLe,loadWeights:()=>N$e,moveModel:()=>n$e,registerLoadRouter:()=>ULe,registerSaveRouter:()=>VLe,removeModel:()=>e$e,weightsLoaderFactory:()=>Ace,withSaveHandler:()=>$$e,withSaveHandlerSync:()=>B$e});var Ee={};z.r(Ee),z.d(Ee,{assertParamsValid:()=>L8,computeFlatOffset:()=>V8,computeOutShape:()=>$8,getNormalizedAxes:()=>Z$e,isSliceContinous:()=>B8,maskToAxes:()=>q$e,parseSliceParams:()=>CV,sliceInfo:()=>U8,startForAxis:()=>Wce,startIndicesWithElidedDims:()=>zce,stopForAxis:()=>jce,stopIndicesWithElidedDims:()=>Hce,stridesForAxis:()=>Gce,stridesWithElidedDims:()=>Bce});var te={};z.r(te),z.d(te,{conv2d:()=>Wue,depthwiseConv2d:()=>pze,matMul:()=>EY});var He={};z.r(He),z.d(He,{collectGatherOpShapeInfo:()=>nK,computeOutShape:()=>Sde,segOpComputeOptimalWindowSize:()=>Tde});var je={};z.r(je),z.d(je,{ERF_A1:()=>zY,ERF_A2:()=>HY,ERF_A3:()=>GY,ERF_A4:()=>WY,ERF_A5:()=>jY,ERF_P:()=>UY,PARALLELIZE_THRESHOLD:()=>PY,RowPartitionType:()=>uu,SELU_SCALE:()=>KV,SELU_SCALEALPHA:()=>YV,applyActivation:()=>jV,assertAndGetBroadcastShape:()=>Bn,assertAxesAreInnerMostDims:()=>Co,assertParamsConsistent:()=>FY,assignToTypedArray:()=>cde,axesAreInnerMostDims:()=>X8,calculateShapes:()=>n0,checkEinsumDimSizes:()=>QY,checkPadOnDimRoundingMode:()=>ba,combineLocations:()=>vue,combineRaggedTensorToTensorShapes:()=>nde,complexWithEvenIndex:()=>ade,complexWithOddIndex:()=>lde,computeConv2DInfo:()=>Ys,computeConv3DInfo:()=>d_,computeDefaultPad:()=>H8,computeDilation2DInfo:()=>HN,computeOptimalWindowSize:()=>ZV,computeOutAndReduceShapes:()=>Ks,computeOutShape:()=>Ch,computePool2DInfo:()=>ou,computePool3DInfo:()=>yp,convertConv2DDataFormat:()=>vp,decodeEinsumEquation:()=>YY,eitherStridesOrDilationsAreOne:()=>wo,expandShapeToKeepDim:()=>rs,exponent:()=>dde,exponents:()=>ude,fromStringArrayToUint8:()=>Ede,fromUint8ToStringArray:()=>Cp,getAxesPermutation:()=>Pi,getBroadcastDims:()=>uT,getComplexWithIndex:()=>qY,getEinsumComputePath:()=>XY,getEinsumPermutation:()=>KY,getFusedBiasGradient:()=>WV,getFusedDyActivation:()=>GV,getImageCenter:()=>LY,getInnerMostAxes:()=>is,getPermuted:()=>sR,getRaggedRank:()=>ide,getReductionAxes:()=>As,getReshaped:()=>iR,getReshapedPermuted:()=>oR,getRowPartitionTypesHelper:()=>rde,getSliceBeginCoords:()=>$Y,getSliceSize:()=>BY,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>pde,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>mde,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>gde,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>vde,getSparseReshapeInputOutputMismatchErrorMessage:()=>wde,getSparseReshapeInputOutputMultipleErrorMessage:()=>bde,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>_de,getSparseReshapeNegativeOutputDimErrorMessage:()=>yde,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>Ide,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>tK,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Cde,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>xde,getUndoAxesPermutation:()=>p_,isIdentityPermutation:()=>JY,log:()=>eLe,mergeRealAndImagArrays:()=>wp,prepareAndValidate:()=>VY,prepareSplitSize:()=>eK,segment_util:()=>He,shouldFuse:()=>qV,slice_util:()=>Ee,splitRealAndImagArrays:()=>ode,stridesOrDilationsArePositive:()=>Kb,tupleValuesAreOne:()=>h_,upcastType:()=>Dl,validateDefaultValueShape:()=>sde,validateInput:()=>yY,validateUpdateShape:()=>$ue,warn:()=>hc});var Re={};z.r(Re),z.d(Re,{json:()=>rje});var tt={};z.r(tt),z.d(tt,{json:()=>ije});var Ne={};z.r(Ne),z.d(Ne,{json:()=>sje});var ne={};z.r(ne),z.d(ne,{json:()=>oje});var K={};z.r(K),z.d(K,{json:()=>aje});var ee={};z.r(ee),z.d(ee,{json:()=>lje});var X={};z.r(X),z.d(X,{json:()=>cje});var Ce={};z.r(Ce),z.d(Ce,{json:()=>uje});var Ue={};z.r(Ue),z.d(Ue,{json:()=>dje});var Ae={};z.r(Ae),z.d(Ae,{json:()=>hje});var Dt={};z.r(Dt),z.d(Dt,{json:()=>fje});var $e={};z.r($e),z.d($e,{json:()=>pje});var Je={};z.r(Je),z.d(Je,{json:()=>mje});var Gt={};z.r(Gt),z.d(Gt,{json:()=>gje});var an={};z.r(an),z.d(an,{json:()=>_je});var nt={};z.r(nt),z.d(nt,{json:()=>yje});var Pe={};z.r(Pe),z.d(Pe,{json:()=>vje});var Oe={};z.r(Oe),z.d(Oe,{json:()=>bje});var be={};z.r(be),z.d(be,{json:()=>wje});var he={};z.r(he),z.d(he,{OP_SCOPE_SUFFIX:()=>ece,abs:()=>ks,acos:()=>Zce,acosh:()=>Yce,add:()=>dt,addN:()=>eBe,all:()=>z8,any:()=>xV,argMax:()=>dT,argMin:()=>Kce,asin:()=>Qce,asinh:()=>Xce,atan:()=>Jce,atan2:()=>eue,atanh:()=>tue,avgPool:()=>IV,avgPool3d:()=>nue,basicLSTMCell:()=>xBe,batchNorm:()=>jN,batchNorm2d:()=>rue,batchNorm3d:()=>iue,batchNorm4d:()=>sue,batchToSpaceND:()=>TV,bincount:()=>oue,bitwiseAnd:()=>RBe,booleanMaskAsync:()=>ZUe,broadcastArgs:()=>OBe,broadcastTo:()=>fT,buffer:()=>qn,cast:()=>Pt,ceil:()=>aue,clipByValue:()=>kl,clone:()=>pp,complex:()=>o_,concat:()=>ms,concat1d:()=>lue,concat2d:()=>cue,concat3d:()=>uue,concat4d:()=>due,conv1d:()=>W8,conv2d:()=>f_,conv2dTranspose:()=>q8,conv3d:()=>hue,conv3dTranspose:()=>pue,cos:()=>SV,cosh:()=>Z8,cosineWindow:()=>IY,cumprod:()=>EV,cumsum:()=>Y8,denseBincount:()=>K8,depthToSpace:()=>mue,depthwiseConv2d:()=>qN,diag:()=>rVe,dilation2d:()=>gue,div:()=>ln,divNoNan:()=>_ue,dot:()=>yue,dropout:()=>Hue,einsum:()=>pT,elu:()=>ZN,enclosingPowerOfTwo:()=>Gue,ensureShape:()=>hVe,equal:()=>id,erf:()=>Q8,euclideanNorm:()=>wue,exp:()=>Al,expandDims:()=>wa,expm1:()=>Cue,eye:()=>J8,fft:()=>zV,fill:()=>cT,floor:()=>QN,floorDiv:()=>T8,fused:()=>te,gather:()=>XN,gatherND:()=>ize,greater:()=>Nl,greaterEqual:()=>m_,ifft:()=>nR,imag:()=>DV,image:()=>sd,inTopKAsync:()=>lze,irfft:()=>gY,isFinite:()=>xue,isInf:()=>Iue,isNaN:()=>Tue,leakyRelu:()=>kV,less:()=>JN,lessEqual:()=>Xb,linalg:()=>ede,linspace:()=>FVe,localResponseNormalization:()=>Sue,log:()=>fc,log1p:()=>AV,logSigmoid:()=>Eue,logSoftmax:()=>eY,logSumExp:()=>NV,logicalAnd:()=>bh,logicalNot:()=>RV,logicalOr:()=>tY,logicalXor:()=>Due,losses:()=>j4e,lowerBound:()=>YVe,matMul:()=>ir,max:()=>au,maxPool:()=>OV,maxPool3d:()=>kue,maxPoolWithArgmax:()=>JVe,maximum:()=>_p,mean:()=>Gi,meshgrid:()=>t3e,min:()=>YN,minimum:()=>Jb,mirrorPad:()=>Aue,mod:()=>Nue,moments:()=>FV,movingAverage:()=>QUe,mul:()=>ue,multiRNNCell:()=>a3e,multinomial:()=>c3e,neg:()=>pi,norm:()=>KN,notEqual:()=>gT,oneHot:()=>rY,ones:()=>Rl,onesLike:()=>pc,op:()=>se,outerProduct:()=>p3e,pad:()=>g_,pad1d:()=>_3e,pad2d:()=>v3e,pad3d:()=>w3e,pad4d:()=>x3e,pool:()=>Rue,pow:()=>gp,prelu:()=>LV,print:()=>bce,prod:()=>Mue,raggedGather:()=>N3e,raggedRange:()=>M3e,raggedTensorToTensor:()=>F3e,rand:()=>L3e,randomGamma:()=>G3e,randomNormal:()=>oY,randomStandardNormal:()=>q3e,randomUniform:()=>e0,randomUniformInt:()=>K3e,range:()=>_T,real:()=>eR,reciprocal:()=>Oue,relu:()=>wh,relu6:()=>aY,reshape:()=>fe,reverse:()=>mc,reverse1d:()=>rUe,reverse2d:()=>sUe,reverse3d:()=>aUe,reverse4d:()=>cUe,rfft:()=>HV,round:()=>lY,rsqrt:()=>cY,scalar:()=>gn,scatterND:()=>JUe,searchSorted:()=>nY,selu:()=>uY,separableConv2d:()=>dY,setdiff1dAsync:()=>mUe,sigmoid:()=>vh,sign:()=>Fue,signal:()=>W4e,sin:()=>fY,sinh:()=>pY,slice:()=>_r,slice1d:()=>BV,slice2d:()=>mY,slice3d:()=>VV,slice4d:()=>tR,softmax:()=>UV,softplus:()=>mT,spaceToBatchND:()=>PV,sparse:()=>q4e,sparseToDense:()=>nze,spectral:()=>G4e,split:()=>Ml,sqrt:()=>bo,square:()=>Xr,squaredDifference:()=>_Y,squeeze:()=>t0,stack:()=>Ol,step:()=>yT,stridedSlice:()=>Pue,string:()=>Z4e,sub:()=>Kt,sum:()=>tn,tan:()=>Lue,tanh:()=>Qb,tensor:()=>iu,tensor1d:()=>Ca,tensor2d:()=>rR,tensor3d:()=>Fce,tensor4d:()=>FUe,tensor5d:()=>PUe,tensor6d:()=>LUe,tensorScatterUpdate:()=>BUe,tile:()=>lu,topk:()=>Bue,transpose:()=>yr,truncatedNormal:()=>vY,unique:()=>Vue,unsortedSegmentSum:()=>bY,unstack:()=>cu,upperBound:()=>WUe,variable:()=>Uue,where:()=>Xo,whereAsync:()=>zue,zeros:()=>Ns,zerosLike:()=>gr});var J={};z.r(J),z.d(J,{addImpl:()=>$fe,bincountImpl:()=>m9,bincountReduceImpl:()=>Gfe,bitwiseAndImpl:()=>Wfe,castImpl:()=>Lfe,ceilImpl:()=>jfe,concatImpl:()=>qfe,equalImpl:()=>Kfe,expImpl:()=>Xfe,expm1Impl:()=>epe,floorDivImpl:()=>ipe,floorImpl:()=>rpe,gatherNdImpl:()=>spe,gatherV2Impl:()=>ope,greaterEqualImpl:()=>lpe,greaterImpl:()=>ape,lessEqualImpl:()=>upe,lessImpl:()=>cpe,linSpaceImpl:()=>dpe,logImpl:()=>hpe,maxImpl:()=>fpe,maximumImpl:()=>mpe,minimumImpl:()=>gpe,multiplyImpl:()=>g9,negImpl:()=>ype,notEqualImpl:()=>vpe,prodImpl:()=>xpe,raggedGatherImpl:()=>Tpe,raggedRangeImpl:()=>Epe,raggedTensorToTensorImpl:()=>Ape,rangeImpl:()=>Npe,rsqrtImpl:()=>Rpe,scatterImpl:()=>p0,sigmoidImpl:()=>qqe,simpleAbsImpl:()=>Vfe,sliceImpl:()=>Hfe,sparseFillEmptyRowsImpl:()=>Ope,sparseReshapeImpl:()=>Fpe,sparseSegmentReductionImpl:()=>C9,sqrtImpl:()=>v9e,squaredDifferenceImpl:()=>Ppe,staticRegexReplaceImpl:()=>Lpe,stridedSliceImpl:()=>$pe,stringNGramsImpl:()=>Bpe,stringSplitImpl:()=>Vpe,stringToHashBucketFastImpl:()=>Upe,subImpl:()=>tpe,tileImpl:()=>zpe,topKImpl:()=>Gpe,transposeImpl:()=>f9,uniqueImpl:()=>jpe});var a=z(4650);let Ft=null;function Wt(){return Ft}const Nt=new a.OlP("DocumentToken");let Or=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:function(){return function vr(){return(0,a.LFG)(un)}()},providedIn:"platform"}),n})();const sr=new a.OlP("Location Initialized");let un=(()=>{class n extends Or{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Wt().getBaseHref(this._doc)}onPopState(e){const r=Wt().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=Wt().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,i){ke()?this._history.pushState(e,r,i):this.location.hash=i}replaceState(e,r,i){ke()?this._history.replaceState(e,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:function(){return function qe(){return new un((0,a.LFG)(Nt))}()},providedIn:"platform"}),n})();function ke(){return!!window.history.pushState}function Le(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function Te(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function ft(n){return n&&"?"!==n[0]?"?"+n:n}let ct=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:function(){return(0,a.f3M)(Fn)},providedIn:"root"}),n})();const Qt=new a.OlP("appBaseHref");let Fn=(()=>{class n extends ct{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??(0,a.f3M)(Nt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return Le(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+ft(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${r}${i}`:r}pushState(e,r,i,s){const o=this.prepareExternalUrl(i+ft(s));this._platformLocation.pushState(e,r,o)}replaceState(e,r,i,s){const o=this.prepareExternalUrl(i+ft(s));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Or),a.LFG(Qt,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),kr=(()=>{class n extends ct{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=Le(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,i,s){let o=this.prepareExternalUrl(i+ft(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,r,o)}replaceState(e,r,i,s){let o=this.prepareExternalUrl(i+ft(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Or),a.LFG(Qt,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),_n=(()=>{class n{constructor(e){this._subject=new a.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=Te(Ls(r)),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+ft(r))}normalize(e){return n.stripTrailingSlash(function Ar(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,Ls(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",i=null){this._locationStrategy.pushState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ft(r)),i)}replaceState(e,r="",i=null){this._locationStrategy.replaceState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ft(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(i=>i(e,r))}subscribe(e,r,i){return this._subject.subscribe({next:e,error:r,complete:i})}}return n.normalizeQueryParams=ft,n.joinWithSlash=Le,n.stripTrailingSlash=Te,n.\u0275fac=function(e){return new(e||n)(a.LFG(ct))},n.\u0275prov=a.Yz7({token:n,factory:function(){return function Fr(){return new _n((0,a.LFG)(ct))}()},providedIn:"root"}),n})();function Ls(n){return n.replace(/\/index.html$/,"")}var lr=(()=>((lr=lr||{})[lr.Decimal=0]="Decimal",lr[lr.Percent=1]="Percent",lr[lr.Currency=2]="Currency",lr[lr.Scientific=3]="Scientific",lr))(),Mt=(()=>((Mt=Mt||{})[Mt.Format=0]="Format",Mt[Mt.Standalone=1]="Standalone",Mt))(),fn=(()=>((fn=fn||{})[fn.Narrow=0]="Narrow",fn[fn.Abbreviated=1]="Abbreviated",fn[fn.Wide=2]="Wide",fn[fn.Short=3]="Short",fn))(),hr=(()=>((hr=hr||{})[hr.Short=0]="Short",hr[hr.Medium=1]="Medium",hr[hr.Long=2]="Long",hr[hr.Full=3]="Full",hr))(),en=(()=>((en=en||{})[en.Decimal=0]="Decimal",en[en.Group=1]="Group",en[en.List=2]="List",en[en.PercentSign=3]="PercentSign",en[en.PlusSign=4]="PlusSign",en[en.MinusSign=5]="MinusSign",en[en.Exponential=6]="Exponential",en[en.SuperscriptingExponent=7]="SuperscriptingExponent",en[en.PerMille=8]="PerMille",en[en.Infinity=9]="Infinity",en[en.NaN=10]="NaN",en[en.TimeSeparator=11]="TimeSeparator",en[en.CurrencyDecimal=12]="CurrencyDecimal",en[en.CurrencyGroup=13]="CurrencyGroup",en))();function rl(n,t){return Dr((0,a.cg1)(n)[a.wAp.DateFormat],t)}function Cc(n,t){return Dr((0,a.cg1)(n)[a.wAp.TimeFormat],t)}function Ai(n,t){return Dr((0,a.cg1)(n)[a.wAp.DateTimeFormat],t)}function In(n,t){const e=(0,a.cg1)(n),r=e[a.wAp.NumberSymbols][t];if(typeof r>"u"){if(t===en.CurrencyDecimal)return e[a.wAp.NumberSymbols][en.Decimal];if(t===en.CurrencyGroup)return e[a.wAp.NumberSymbols][en.Group]}return r}function il(n){if(!n[a.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[a.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Dr(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function Ic(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const me=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Ge={},Se=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var wt=(()=>((wt=wt||{})[wt.Short=0]="Short",wt[wt.ShortGMT=1]="ShortGMT",wt[wt.Long=2]="Long",wt[wt.Extended=3]="Extended",wt))(),yt=(()=>((yt=yt||{})[yt.FullYear=0]="FullYear",yt[yt.Month=1]="Month",yt[yt.Date=2]="Date",yt[yt.Hours=3]="Hours",yt[yt.Minutes=4]="Minutes",yt[yt.Seconds=5]="Seconds",yt[yt.FractionalSeconds=6]="FractionalSeconds",yt[yt.Day=7]="Day",yt))(),Rt=(()=>((Rt=Rt||{})[Rt.DayPeriods=0]="DayPeriods",Rt[Rt.Days=1]="Days",Rt[Rt.Months=2]="Months",Rt[Rt.Eras=3]="Eras",Rt))();function Nr(n,t,e,r){let i=function Rr(n){if(Ap(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[i,s=1,o=1]=n.split("-").map(l=>+l);return It(i,s-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(me))return function Tc(n){const t=new Date(0);let e=0,r=0;const i=n[8]?t.setUTCFullYear:t.setFullYear,s=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,l=Number(n[5]||0)-r,c=Number(n[6]||0),u=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return s.call(t,o,l,c,u),t}(r)}const t=new Date(n);if(!Ap(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=Zt(e,t)||t;let l,o=[];for(;t;){if(l=Se.exec(t),!l){o.push(t);break}{o=o.concat(l.slice(1));const f=o.pop();if(!f)break;t=f}}let c=i.getTimezoneOffset();r&&(c=ta(r,c),i=function C0(n,t,e){const r=e?-1:1,i=n.getTimezoneOffset();return function _d(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,r*(ta(t,i)-i))}(i,r,!0));let u="";return o.forEach(f=>{const m=function Da(n){if(_s[n])return _s[n];let t;switch(n){case"G":case"GG":case"GGG":t=ve(Rt.Eras,fn.Abbreviated);break;case"GGGG":t=ve(Rt.Eras,fn.Wide);break;case"GGGGG":t=ve(Rt.Eras,fn.Narrow);break;case"y":t=Nn(yt.FullYear,1,0,!1,!0);break;case"yy":t=Nn(yt.FullYear,2,0,!0,!0);break;case"yyy":t=Nn(yt.FullYear,3,0,!1,!0);break;case"yyyy":t=Nn(yt.FullYear,4,0,!1,!0);break;case"Y":t=Zn(1);break;case"YY":t=Zn(2,!0);break;case"YYY":t=Zn(3);break;case"YYYY":t=Zn(4);break;case"M":case"L":t=Nn(yt.Month,1,1);break;case"MM":case"LL":t=Nn(yt.Month,2,1);break;case"MMM":t=ve(Rt.Months,fn.Abbreviated);break;case"MMMM":t=ve(Rt.Months,fn.Wide);break;case"MMMMM":t=ve(Rt.Months,fn.Narrow);break;case"LLL":t=ve(Rt.Months,fn.Abbreviated,Mt.Standalone);break;case"LLLL":t=ve(Rt.Months,fn.Wide,Mt.Standalone);break;case"LLLLL":t=ve(Rt.Months,fn.Narrow,Mt.Standalone);break;case"w":t=Vr(1);break;case"ww":t=Vr(2);break;case"W":t=Vr(1,!0);break;case"d":t=Nn(yt.Date,1);break;case"dd":t=Nn(yt.Date,2);break;case"c":case"cc":t=Nn(yt.Day,1);break;case"ccc":t=ve(Rt.Days,fn.Abbreviated,Mt.Standalone);break;case"cccc":t=ve(Rt.Days,fn.Wide,Mt.Standalone);break;case"ccccc":t=ve(Rt.Days,fn.Narrow,Mt.Standalone);break;case"cccccc":t=ve(Rt.Days,fn.Short,Mt.Standalone);break;case"E":case"EE":case"EEE":t=ve(Rt.Days,fn.Abbreviated);break;case"EEEE":t=ve(Rt.Days,fn.Wide);break;case"EEEEE":t=ve(Rt.Days,fn.Narrow);break;case"EEEEEE":t=ve(Rt.Days,fn.Short);break;case"a":case"aa":case"aaa":t=ve(Rt.DayPeriods,fn.Abbreviated);break;case"aaaa":t=ve(Rt.DayPeriods,fn.Wide);break;case"aaaaa":t=ve(Rt.DayPeriods,fn.Narrow);break;case"b":case"bb":case"bbb":t=ve(Rt.DayPeriods,fn.Abbreviated,Mt.Standalone,!0);break;case"bbbb":t=ve(Rt.DayPeriods,fn.Wide,Mt.Standalone,!0);break;case"bbbbb":t=ve(Rt.DayPeriods,fn.Narrow,Mt.Standalone,!0);break;case"B":case"BB":case"BBB":t=ve(Rt.DayPeriods,fn.Abbreviated,Mt.Format,!0);break;case"BBBB":t=ve(Rt.DayPeriods,fn.Wide,Mt.Format,!0);break;case"BBBBB":t=ve(Rt.DayPeriods,fn.Narrow,Mt.Format,!0);break;case"h":t=Nn(yt.Hours,1,-12);break;case"hh":t=Nn(yt.Hours,2,-12);break;case"H":t=Nn(yt.Hours,1);break;case"HH":t=Nn(yt.Hours,2);break;case"m":t=Nn(yt.Minutes,1);break;case"mm":t=Nn(yt.Minutes,2);break;case"s":t=Nn(yt.Seconds,1);break;case"ss":t=Nn(yt.Seconds,2);break;case"S":t=Nn(yt.FractionalSeconds,1);break;case"SS":t=Nn(yt.FractionalSeconds,2);break;case"SSS":t=Nn(yt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=ut(wt.Short);break;case"ZZZZZ":t=ut(wt.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=ut(wt.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=ut(wt.Long);break;default:return null}return _s[n]=t,t}(f);u+=m?m(i,e,c):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function It(n,t,e){const r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function Zt(n,t){const e=function nl(n){return(0,a.cg1)(n)[a.wAp.LocaleId]}(n);if(Ge[e]=Ge[e]||{},Ge[e][t])return Ge[e][t];let r="";switch(t){case"shortDate":r=rl(n,hr.Short);break;case"mediumDate":r=rl(n,hr.Medium);break;case"longDate":r=rl(n,hr.Long);break;case"fullDate":r=rl(n,hr.Full);break;case"shortTime":r=Cc(n,hr.Short);break;case"mediumTime":r=Cc(n,hr.Medium);break;case"longTime":r=Cc(n,hr.Long);break;case"fullTime":r=Cc(n,hr.Full);break;case"short":const i=Zt(n,"shortTime"),s=Zt(n,"shortDate");r=on(Ai(n,hr.Short),[i,s]);break;case"medium":const o=Zt(n,"mediumTime"),l=Zt(n,"mediumDate");r=on(Ai(n,hr.Medium),[o,l]);break;case"long":const c=Zt(n,"longTime"),u=Zt(n,"longDate");r=on(Ai(n,hr.Long),[c,u]);break;case"full":const f=Zt(n,"fullTime"),m=Zt(n,"fullDate");r=on(Ai(n,hr.Full),[f,m])}return r&&(Ge[e][t]=r),r}function on(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),n}function er(n,t,e="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=1-n:(n=-n,s=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),s+o}function Nn(n,t,e=0,r=!1,i=!1){return function(s,o){let l=function Bl(n,t){switch(n){case yt.FullYear:return t.getFullYear();case yt.Month:return t.getMonth();case yt.Date:return t.getDate();case yt.Hours:return t.getHours();case yt.Minutes:return t.getMinutes();case yt.Seconds:return t.getSeconds();case yt.FractionalSeconds:return t.getMilliseconds();case yt.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,s);if((e>0||l>-e)&&(l+=e),n===yt.Hours)0===l&&-12===e&&(l=12);else if(n===yt.FractionalSeconds)return function to(n,t){return er(n,3).substring(0,t)}(l,t);const c=In(o,en.MinusSign);return er(l,t,c,r,i)}}function ve(n,t,e=Mt.Format,r=!1){return function(i,s){return function Fe(n,t,e,r,i,s){switch(e){case Rt.Months:return function wc(n,t,e){const r=(0,a.cg1)(n),s=Dr([r[a.wAp.MonthsFormat],r[a.wAp.MonthsStandalone]],t);return Dr(s,e)}(t,i,r)[n.getMonth()];case Rt.Days:return function Br(n,t,e){const r=(0,a.cg1)(n),s=Dr([r[a.wAp.DaysFormat],r[a.wAp.DaysStandalone]],t);return Dr(s,e)}(t,i,r)[n.getDay()];case Rt.DayPeriods:const o=n.getHours(),l=n.getMinutes();if(s){const u=function gs(n){const t=(0,a.cg1)(n);return il(t),(t[a.wAp.ExtraData][2]||[]).map(r=>"string"==typeof r?Ic(r):[Ic(r[0]),Ic(r[1])])}(t),f=function eo(n,t,e){const r=(0,a.cg1)(n);il(r);const s=Dr([r[a.wAp.ExtraData][0],r[a.wAp.ExtraData][1]],t)||[];return Dr(s,e)||[]}(t,i,r),m=u.findIndex(_=>{if(Array.isArray(_)){const[y,w]=_,T=o>=y.hours&&l>=y.minutes,I=o<w.hours||o===w.hours&&l<w.minutes;if(y.hours<w.hours){if(T&&I)return!0}else if(T||I)return!0}else if(_.hours===o&&_.minutes===l)return!0;return!1});if(-1!==m)return f[m]}return function Js(n,t,e){const r=(0,a.cg1)(n),s=Dr([r[a.wAp.DayPeriodsFormat],r[a.wAp.DayPeriodsStandalone]],t);return Dr(s,e)}(t,i,r)[o<12?0:1];case Rt.Eras:return function So(n,t){return Dr((0,a.cg1)(n)[a.wAp.Eras],t)}(t,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(i,s,n,t,e,r)}}function ut(n){return function(t,e,r){const i=-1*r,s=In(e,en.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case wt.Short:return(i>=0?"+":"")+er(o,2,s)+er(Math.abs(i%60),2,s);case wt.ShortGMT:return"GMT"+(i>=0?"+":"")+er(o,1,s);case wt.Long:return"GMT"+(i>=0?"+":"")+er(o,2,s)+":"+er(Math.abs(i%60),2,s);case wt.Extended:return 0===r?"Z":(i>=0?"+":"")+er(o,2,s)+":"+er(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}function fr(n){return It(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function Vr(n,t=!1){return function(e,r){let i;if(t){const s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();i=1+Math.floor((o+s)/7)}else{const s=fr(e),o=function Rn(n){const t=It(n,0,1).getDay();return It(n,0,1+(t<=4?4:11)-t)}(s.getFullYear()),l=s.getTime()-o.getTime();i=1+Math.round(l/6048e5)}return er(i,n,In(r,en.MinusSign))}}function Zn(n,t=!1){return function(e,r){return er(fr(e).getFullYear(),n,In(r,en.MinusSign),t)}}const _s={};function ta(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function Ap(n){return n instanceof Date&&!isNaN(n.valueOf())}const Np=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Fp(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function jT(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[i,s]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(i.trim()===t)return decodeURIComponent(s)}return null}let Aa=(()=>{class n{constructor(e,r,i,s){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=i,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&((0,a.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,a.AaK)(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.ZZ4),a.Y36(a.aQg),a.Y36(a.SBq),a.Y36(a.Qsj))},n.\u0275dir=a.lG2({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class I0{constructor(t,e,r,i){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Na=(()=>{class n{constructor(e,r,i){this._viewContainer=e,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((i,s,o)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new I0(i.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===s?void 0:s);else if(null!==s){const l=r.get(s);r.move(l,o),V_(l,i)}});for(let i=0,s=r.length;i<s;i++){const l=r.get(i).context;l.index=i,l.count=s,l.ngForOf=this._ngForOf}e.forEachIdentityChange(i=>{V_(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(a.Rgc),a.Y36(a.ZZ4))},n.\u0275dir=a.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function V_(n,t){n.context.$implicit=t.item}let Ur=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new U_,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){z_("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){z_("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(a.Rgc))},n.\u0275dir=a.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class U_{constructor(){this.$implicit=null,this.ngIf=null}}function z_(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,a.AaK)(t)}'.`)}class vd{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let no=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const r=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||r,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),r}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let r=0;r<this._defaultViews.length;r++)this._defaultViews[r].enforceState(e)}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),n})(),ko=(()=>{class n{constructor(e,r,i){this.ngSwitch=i,i._addCase(),this._view=new vd(e,r)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(a.Rgc),a.Y36(no,9))},n.\u0275dir=a.lG2({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),n})(),T0=(()=>{class n{constructor(e,r,i){i._addDefault(new vd(e,r))}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(a.Rgc),a.Y36(no,9))},n.\u0275dir=a.lG2({type:n,selectors:[["","ngSwitchDefault",""]],standalone:!0}),n})(),S0=(()=>{class n{constructor(e,r,i){this._ngEl=e,this._differs=r,this._renderer=i,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,r){const[i,s]=e.split("."),o=-1===i.indexOf("-")?void 0:a.JOm.DashCase;null!=r?this._renderer.setStyle(this._ngEl.nativeElement,i,s?`${r}${s}`:r,o):this._renderer.removeStyle(this._ngEl.nativeElement,i,o)}_applyChanges(e){e.forEachRemovedItem(r=>this._setStyle(r.key,null)),e.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),e.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.aQg),a.Y36(a.Qsj))},n.\u0275dir=a.lG2({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),n})();function Ao(n,t){return new a.vHH(2100,!1)}class W_{createSubscription(t,e){return t.subscribe({next:e,error:r=>{throw r}})}dispose(t){t.unsubscribe()}}class ZT{createSubscription(t,e){return t.then(e,r=>{throw r})}dispose(t){}}const ro=new ZT,zl=new W_;let Oh=(()=>{class n{constructor(e){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=e}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue:(e&&this._subscribe(e),this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,r=>this._updateLatestValue(e,r))}_selectStrategy(e){if((0,a.QGY)(e))return ro;if((0,a.F4k)(e))return zl;throw Ao()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,r){e===this._obj&&(this._latestValue=r,this._ref.markForCheck())}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.sBO,16))},n.\u0275pipe=a.Yjl({name:"async",type:n,pure:!1,standalone:!0}),n})();const Hl=new a.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let ra=(()=>{class n{constructor(e,r){this.locale=e,this.defaultTimezone=r}transform(e,r="mediumDate",i,s){if(null==e||""===e||e!=e)return null;try{return Nr(e,r,s||this.locale,i??this.defaultTimezone??void 0)}catch(o){throw Ao()}}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.soG,16),a.Y36(Hl,24))},n.\u0275pipe=a.Yjl({name:"date",type:n,pure:!0,standalone:!0}),n})(),Wl=(()=>{class n{constructor(e){this._locale=e}transform(e,r,i){if(!function wd(n){return!(null==n||""===n||n!=n)}(e))return null;i=i||this._locale;try{return function na(n,t,e){return function yd(n,t,e,r,i,s,o=!1){let l="",c=!1;if(isFinite(n)){let u=function F_(n){let r,i,s,o,l,t=Math.abs(n)+"",e=0;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(i<0&&(i=s),i+=+t.slice(s+1),t=t.substring(0,s)):i<0&&(i=t.length),s=0;"0"===t.charAt(s);s++);if(s===(l=t.length))r=[0],i=1;else{for(l--;"0"===t.charAt(l);)l--;for(i-=s,r=[],o=0;s<=l;s++,o++)r[o]=Number(t.charAt(s))}return i>22&&(r=r.splice(0,21),e=i-1,i=1),{digits:r,exponent:e,integerLen:i}}(n);o&&(u=function HT(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(u));let f=t.minInt,m=t.minFrac,_=t.maxFrac;if(s){const A=s.match(Np);if(null===A)throw new Error(`${s} is not a valid digit info`);const M=A[1],O=A[3],$=A[5];null!=M&&(f=Fp(M)),null!=O&&(m=Fp(O)),null!=$?_=Fp($):null!=O&&m>_&&(_=m)}!function GT(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,i=r.length-n.integerLen;const s=Math.min(Math.max(t,i),e);let o=s+n.integerLen,l=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,o=s+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(l>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;i<Math.max(0,s);i++)r.push(0);let c=0!==s;const u=t+n.integerLen,f=r.reduceRight(function(m,_,y,w){return w[y]=(_+=m)<10?_:_-10,c&&(0===w[y]&&y>=u?w.pop():c=!1),_>=10?1:0},0);f&&(r.unshift(f),n.integerLen++)}(u,m,_);let y=u.digits,w=u.integerLen;const T=u.exponent;let I=[];for(c=y.every(A=>!A);w<f;w++)y.unshift(0);for(;w<0;w++)y.unshift(0);w>0?I=y.splice(w,y.length):(I=y,y=[0]);const E=[];for(y.length>=t.lgSize&&E.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)E.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&E.unshift(y.join("")),l=E.join(In(e,r)),I.length&&(l+=In(e,i)+I.join("")),T&&(l+=In(e,en.Exponential)+"+"+T)}else l=In(e,en.Infinity);return l=n<0&&!c?t.negPre+l+t.negSuf:t.posPre+l+t.posSuf,l}(n,function Mh(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),i=r[0],s=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],l=o[0],c=o[1]||"";e.posPre=l.substring(0,l.indexOf("#"));for(let f=0;f<c.length;f++){const m=c.charAt(f);"0"===m?e.minFrac=e.maxFrac=f+1:"#"===m?e.maxFrac=f+1:e.posSuf+=m}const u=l.split(",");if(e.gSize=u[1]?u[1].length:0,e.lgSize=u[2]||u[1]?(u[2]||u[1]).length:0,s){const f=i.length-e.posPre.length-e.posSuf.length,m=s.indexOf("#");e.negPre=s.substring(0,m).replace(/'/g,""),e.negSuf=s.slice(m+f).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function ji(n,t){return(0,a.cg1)(n)[a.wAp.NumberFormats][t]}(t,lr.Decimal),In(t,en.MinusSign)),t,en.Group,en.Decimal,e)}(function bs(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),i,r)}catch(s){throw Ao()}}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.soG,16))},n.\u0275pipe=a.Yjl({name:"number",type:n,pure:!0,standalone:!0}),n})();let No=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})();const Ph="browser";function Lh(n){return"server"===n}let Y_=(()=>{class n{}return n.\u0275prov=(0,a.Yz7)({token:n,providedIn:"root",factory:()=>new mi((0,a.LFG)(Nt),window)}),n})();class mi{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function yu(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,i=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=Bp(this.window.history)||Bp(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Bp(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Cd{}class Kp extends class py extends class Sr{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Gn(n){Ft||(Ft=n)}(new Kp)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function H0(){return Td=Td||document.querySelector("base"),Td?Td.getAttribute("href"):null}();return null==e?null:function bu(n){my=my||document.createElement("a"),my.setAttribute("href",n);const t=my.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){Td=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return jT(document.cookie,t)}}let my,Td=null;const Gh=new a.OlP("TRANSITION_ID"),G0=[{provide:a.ip1,useFactory:function Sc(n,t,e){return()=>{e.get(a.CZH).donePromise.then(()=>{const r=Wt(),i=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<i.length;s++)r.remove(i[s])})}},deps:[Gh,Nt,a.zs3],multi:!0}];let ol=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const Qp=new a.OlP("EventManagerPlugins");let Yr=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(i=>i.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,i){return this._findPluginFor(r).addEventListener(e,r,i)}addGlobalEventListener(e,r,i){return this._findPluginFor(r).addGlobalEventListener(e,r,i)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const i=this._plugins;for(let s=0;s<i.length;s++){const o=i[s];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Qp),a.LFG(a.R0b))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();class Xp{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const i=Wt().getGlobalEventTarget(this._doc,t);if(!i)throw new Error(`Unsupported event target ${i} for event ${e}`);return this.addEventListener(i,e,r)}}let Jp=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),Sd=(()=>{class n extends Jp{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,i){e.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,i.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(Ed),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(e,i,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(Ed))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();function Ed(n){Wt().remove(n)}const Ec={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Dc=/%COMP%/g;function wr(n,t,e){for(let r=0;r<t.length;r++){let i=t[r];Array.isArray(i)?wr(n,i,e):(i=i.replace(Dc,n),e.push(i))}return e}function _y(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let Wh=(()=>{class n{constructor(e,r,i){this.eventManager=e,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new j0(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case a.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new jh(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(e),i}case 1:case a.ifc.ShadowDom:return new oU(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const i=wr(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Yr),a.LFG(Sd),a.LFG(a.AFp))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();class j0{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(Ec[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(iS(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(iS(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,i){if(i){e=i+":"+e;const s=Ec[i];s?t.setAttributeNS(s,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const i=Ec[r];i?t.removeAttributeNS(i,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,i){i&(a.JOm.DashCase|a.JOm.Important)?t.style.setProperty(e,r,i&a.JOm.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&a.JOm.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,_y(r)):this.eventManager.addEventListener(t,e,_y(r))}}function iS(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class jh extends j0{constructor(t,e,r,i){super(t),this.component=r;const s=wr(i+"-"+r.id,r.styles,[]);e.addStyles(s),this.contentAttr=function em(n){return"_ngcontent-%COMP%".replace(Dc,n)}(i+"-"+r.id),this.hostAttr=function tm(n){return"_nghost-%COMP%".replace(Dc,n)}(i+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class oU extends j0{constructor(t,e,r,i){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=wr(i.id,i.styles,[]);for(let o=0;o<s.length;o++){const l=document.createElement("style");l.textContent=s[o],this.shadowRoot.appendChild(l)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let qh=(()=>{class n extends Xp{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,i){return e.addEventListener(r,i,!1),()=>this.removeEventListener(e,r,i)}removeEventListener(e,r,i){return e.removeEventListener(r,i)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const Ni=["alt","control","meta","shift"],yy={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Zh={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let GR=(()=>{class n extends Xp{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,i){const s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Wt().onAndCancel(e,s.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=n._normalizeKey(r.pop());let o="",l=r.indexOf("code");if(l>-1&&(r.splice(l,1),o="code."),Ni.forEach(u=>{const f=r.indexOf(u);f>-1&&(r.splice(f,1),o+=u+".")}),o+=s,0!=r.length||0===s.length)return null;const c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(e,r){let i=yy[e.key]||e.key,s="";return r.indexOf("code.")>-1&&(i=e.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),Ni.forEach(o=>{o!==i&&(0,Zh[o])(e)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(e,r,i){return s=>{n.matchEventFullKeyCode(s,e)&&i.runGuarded(()=>r(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const WR=(0,a.eFA)(a._c5,"browser",[{provide:a.Lbi,useValue:Ph},{provide:a.g9A,useValue:function Cu(){Kp.makeCurrent()},multi:!0},{provide:Nt,useFactory:function sS(){return(0,a.RDi)(document),document},deps:[]}]),oS=new a.OlP(""),nm=[{provide:a.rWj,useClass:class W0{addToWindow(t){a.dqk.getAngularTestability=(r,i=!0)=>{const s=t.findTestabilityInTree(r,i);if(null==s)throw new Error("Could not find testability for element.");return s},a.dqk.getAllAngularTestabilities=()=>t.getAllTestabilities(),a.dqk.getAllAngularRootElements=()=>t.getAllRootElements(),a.dqk.frameworkStabilizers||(a.dqk.frameworkStabilizers=[]),a.dqk.frameworkStabilizers.push(r=>{const i=a.dqk.getAllAngularTestabilities();let s=i.length,o=!1;const l=function(c){o=o||c,s--,0==s&&r(o)};i.forEach(function(c){c.whenStable(l)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?Wt().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:a.lri,useClass:a.dDg,deps:[a.R0b,a.eoX,a.rWj]},{provide:a.dDg,useClass:a.dDg,deps:[a.R0b,a.eoX,a.rWj]}],oo=[{provide:a.zSh,useValue:"root"},{provide:a.qLn,useFactory:function Y0(){return new a.qLn},deps:[]},{provide:Qp,useClass:qh,multi:!0,deps:[Nt,a.R0b,a.Lbi]},{provide:Qp,useClass:GR,multi:!0,deps:[Nt]},{provide:Wh,useClass:Wh,deps:[Yr,Sd,a.AFp]},{provide:a.FYo,useExisting:Wh},{provide:Jp,useExisting:Sd},{provide:Sd,useClass:Sd,deps:[Nt]},{provide:Yr,useClass:Yr,deps:[Qp,a.R0b]},{provide:Cd,useClass:ol,deps:[]},[]];let rm=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:a.AFp,useValue:e.appId},{provide:Gh,useExisting:a.AFp},G0]}}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(oS,12))},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[...oo,...nm],imports:[No,a.hGG]}),n})(),X0=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:function(e){let r=null;return r=e?new e:function Cy(){return new X0((0,a.LFG)(Nt))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let Iu=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:function(e){let r=null;return r=e?new(e||n):a.LFG(Nc),r},providedIn:"root"}),n})(),Nc=(()=>{class n extends Iu{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case a.q3G.NONE:return r;case a.q3G.HTML:return(0,a.qzn)(r,"HTML")?(0,a.z3N)(r):(0,a.EiD)(this._doc,String(r)).toString();case a.q3G.STYLE:return(0,a.qzn)(r,"Style")?(0,a.z3N)(r):r;case a.q3G.SCRIPT:if((0,a.qzn)(r,"Script"))return(0,a.z3N)(r);throw new Error("unsafe value used in a script context");case a.q3G.URL:return(0,a.qzn)(r,"URL")?(0,a.z3N)(r):(0,a.mCW)(String(r));case a.q3G.RESOURCE_URL:if((0,a.qzn)(r,"ResourceURL"))return(0,a.z3N)(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return(0,a.JVY)(e)}bypassSecurityTrustStyle(e){return(0,a.L6k)(e)}bypassSecurityTrustScript(e){return(0,a.eBb)(e)}bypassSecurityTrustUrl(e){return(0,a.LAX)(e)}bypassSecurityTrustResourceUrl(e){return(0,a.pB0)(e)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:function(e){let r=null;return r=e?new e:function am(n){return new Nc(n.get(Nt))}(a.LFG(a.zs3)),r},providedIn:"root"}),n})();class Ty{}const Mo="*";function Bs(n,t){return{type:7,name:n,definitions:t,options:{}}}function _i(n,t=null){return{type:4,styles:t,timings:n}}function sw(n,t=null){return{type:3,steps:n,options:t}}function Yl(n,t=null){return{type:2,steps:n,options:t}}function Sn(n){return{type:6,styles:n,offset:null}}function yi(n,t,e){return{type:0,name:n,styles:t,options:e}}function lm(n){return{type:5,steps:n}}function ei(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function cm(n=null){return{type:9,options:n}}function Xh(n,t,e=null){return{type:11,selector:n,animation:t,options:e}}function Su(n){Promise.resolve().then(n)}class Eu{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Su(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class um{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,i=0;const s=this.players.length;0==s?Su(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==s&&this._onFinish()}),o.onDestroy(()=>{++r==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,l)=>Math.max(o,l.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(i)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function hm(n){return new a.vHH(3e3,!1)}function mm(){return typeof window<"u"&&typeof window.document<"u"}function My(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Kl(n){switch(n.length){case 0:return new Eu;case 1:return n[0];default:return new um(n)}}function Oy(n,t,e,r,i=new Map,s=new Map){const o=[],l=[];let c=-1,u=null;if(r.forEach(f=>{const m=f.get("offset"),_=m==c,y=_&&u||new Map;f.forEach((w,T)=>{let I=T,E=w;if("offset"!==T)switch(I=t.normalizePropertyName(I,o),E){case"!":E=i.get(T);break;case Mo:E=s.get(T);break;default:E=t.normalizeStyleValue(T,I,E,o)}y.set(I,E)}),_||l.push(y),u=y,c=m}),o.length)throw function Ay(n){return new a.vHH(3502,!1)}();return l}function nf(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&gm(e,"start",n)));break;case"done":n.onDone(()=>r(e&&gm(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&gm(e,"destroy",n)))}}function gm(n,t,e){const s=pw(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(s._data=o),s}function pw(n,t,e,r,i="",s=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function ws(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function Fy(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let Nd=(n,t)=>!1,rf=(n,t,e)=>[],sf=null;function Py(n){const t=n.parentNode||n.host;return t===sf?null:t}(My()||typeof Element<"u")&&(mm()?(sf=(()=>document.documentElement)(),Nd=(n,t)=>{for(;t;){if(t===n)return!0;t=Py(t)}return!1}):Nd=(n,t)=>n.contains(t),rf=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let $a=null,mw=!1;const Ql=Nd,wS=rf;let Rd=(()=>{class n{validateStyleProperty(e){return function gw(n){$a||($a=function yw(){return typeof document<"u"?document.body:null}()||{},mw=!!$a.style&&"WebkitAppearance"in $a.style);let t=!0;return $a.style&&!function bS(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in $a.style,!t&&mw&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in $a.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return Ql(e,r)}getParentElement(e){return Py(e)}query(e,r,i){return wS(e,r,i)}computeStyle(e,r,i){return i||""}animate(e,r,i,s,o,l=[],c){return new Eu(i,s)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),_m=(()=>{class n{}return n.NOOP=new Rd,n})();const lf="ng-enter",vm="ng-leave",bm="ng-trigger",Md=".ng-trigger",vw="ng-animating",wm=".ng-animating";function Ba(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:Cm(parseFloat(t[1]),t[2])}function Cm(n,t){return"s"===t?1e3*n:n}function Od(n,t,e){return n.hasOwnProperty("duration")?n:function bw(n,t,e){let i,s=0,o="";if("string"==typeof n){const l=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===l)return t.push(hm()),{duration:0,delay:0,easing:""};i=Cm(parseFloat(l[1]),l[2]);const c=l[3];null!=c&&(s=Cm(parseFloat(c),l[4]));const u=l[5];u&&(o=u)}else i=n;if(!e){let l=!1,c=t.length;i<0&&(t.push(function uS(){return new a.vHH(3100,!1)}()),l=!0),s<0&&(t.push(function dS(){return new a.vHH(3101,!1)}()),l=!0),l&&t.splice(c,0,hm())}return{duration:i,delay:s,easing:o}}(n,t,e)}function Du(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function $y(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function Va(n,t=new Map,e){if(e)for(let[r,i]of e)t.set(r,i);for(let[r,i]of n)t.set(r,i);return t}function By(n,t,e){return e?t+":"+e+";":""}function Cw(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=By(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=By(0,Iw(e),n.style[e]));n.setAttribute("style",t)}function aa(n,t,e){n.style&&(t.forEach((r,i)=>{const s=ul(i);e&&!e.has(i)&&e.set(i,n.style[s]),n.style[s]=r}),My()&&Cw(n))}function cl(n,t){n.style&&(t.forEach((e,r)=>{const i=ul(r);n.style[i]=""}),My()&&Cw(n))}function cf(n){return Array.isArray(n)?1==n.length?n[0]:Yl(n):n}const uf=new RegExp("{{\\s*(.+?)\\s*}}","g");function Vy(n){let t=[];if("string"==typeof n){let e;for(;e=uf.exec(n);)t.push(e[1]);uf.lastIndex=0}return t}function ku(n,t,e){const r=n.toString(),i=r.replace(uf,(s,o)=>{let l=t[o];return null==l&&(e.push(function Jh(n){return new a.vHH(3003,!1)}()),l=""),l.toString()});return i==r?n:i}function df(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const xm=/-+([a-z0-9])/g;function ul(n){return n.replace(xm,(...t)=>t[1].toUpperCase())}function Iw(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Us(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function eM(n){return new a.vHH(3004,!1)}()}}function Fd(n,t){return window.getComputedStyle(n)[t]}function Bi(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function ff(n,t,e){if(":"==n[0]){const c=function Sw(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function hS(n){return new a.vHH(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof c)return void t.push(c);n=c}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function al(n){return new a.vHH(3015,!1)}()),t;const i=r[1],s=r[2],o=r[3];t.push(Bd(i,o));"<"==s[0]&&!("*"==i&&"*"==o)&&t.push(Bd(o,i))}(r,e,t)):e.push(n),e}const Wy=new Set(["true","1"]),$d=new Set(["false","0"]);function Bd(n,t){const e=Wy.has(n)||$d.has(n),r=Wy.has(t)||$d.has(t);return(i,s)=>{let o="*"==n||n==i,l="*"==t||t==s;return!o&&e&&"boolean"==typeof i&&(o=i?Wy.has(n):$d.has(n)),!l&&r&&"boolean"==typeof s&&(l=s?Wy.has(t):$d.has(t)),o&&l}}const jy=new RegExp("s*:selfs*,?","g");function Vd(n,t,e,r){return new qy(n).build(t,e,r)}class qy{constructor(t){this._driver=t}build(t,e,r){const i=new Au(e);return this._resetContextStyleTimingState(i),Us(this,cf(t),i)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,i=e.depCount=0;const s=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function Ey(){return new a.vHH(3006,!1)}()),t.definitions.forEach(l=>{if(this._resetContextStyleTimingState(e),0==l.type){const c=l,u=c.name;u.toString().split(/\s*,\s*/).forEach(f=>{c.name=f,s.push(this.visitState(c,e))}),c.name=u}else if(1==l.type){const c=this.visitTransition(l,e);r+=c.queryCount,i+=c.depCount,o.push(c)}else e.errors.push(function aw(){return new a.vHH(3007,!1)}())}),{type:7,name:t.name,states:s,transitions:o,queryCount:r,depCount:i,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),i=t.options&&t.options.params||null;if(r.containsDynamicStyles){const s=new Set,o=i||{};r.styles.forEach(l=>{l instanceof Map&&l.forEach(c=>{Vy(c).forEach(u=>{o.hasOwnProperty(u)||s.add(u)})})}),s.size&&(df(s.values()),e.errors.push(function nM(n,t){return new a.vHH(3008,!1)}()))}return{type:0,name:t.name,style:r,options:i?{params:i}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=Us(this,cf(t.animation),e);return{type:1,matchers:Bi(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:Xl(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>Us(this,r,e)),options:Xl(t.options)}}visitGroup(t,e){const r=e.currentTime;let i=0;const s=t.steps.map(o=>{e.currentTime=r;const l=Us(this,o,e);return i=Math.max(i,e.currentTime),l});return e.currentTime=i,{type:3,steps:s,options:Xl(t.options)}}visitAnimate(t,e){const r=function ao(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return pf(Od(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=pf(0,0,"");return s.dynamic=!0,s.strValue=e,s}const i=Od(e,t);return pf(i.duration,i.delay,i.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let i,s=t.styles?t.styles:Sn({});if(5==s.type)i=this.visitKeyframes(s,e);else{let o=t.styles,l=!1;if(!o){l=!0;const u={};r.easing&&(u.easing=r.easing),o=Sn(u)}e.currentTime+=r.duration+r.delay;const c=this.visitStyle(o,e);c.isEmptyStep=l,i=c}return e.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],i=Array.isArray(t.styles)?t.styles:[t.styles];for(let l of i)"string"==typeof l?l===Mo?r.push(l):e.errors.push(new a.vHH(3002,!1)):r.push($y(l));let s=!1,o=null;return r.forEach(l=>{if(l instanceof Map&&(l.has("easing")&&(o=l.get("easing"),l.delete("easing")),!s))for(let c of l.values())if(c.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:r,easing:o,offset:t.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let i=e.currentTime,s=e.currentTime;r&&s>0&&(s-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((l,c)=>{const u=e.collectedStyles.get(e.currentQuerySelector),f=u.get(c);let m=!0;f&&(s!=i&&s>=f.startTime&&i<=f.endTime&&(e.errors.push(function sM(n,t,e,r,i){return new a.vHH(3010,!1)}()),m=!1),s=f.startTime),m&&u.set(c,{startTime:s,endTime:i}),e.options&&function xw(n,t,e){const r=t.params||{},i=Vy(n);i.length&&i.forEach(s=>{r.hasOwnProperty(s)||e.push(function ow(n){return new a.vHH(3001,!1)}())})}(l,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function fm(){return new a.vHH(3011,!1)}()),r;let s=0;const o=[];let l=!1,c=!1,u=0;const f=t.steps.map(E=>{const A=this._makeStyleAst(E,e);let M=null!=A.offset?A.offset:function Aw(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(A.styles),O=0;return null!=M&&(s++,O=A.offset=M),c=c||O<0||O>1,l=l||O<u,u=O,o.push(O),A});c&&e.errors.push(function lw(){return new a.vHH(3012,!1)}()),l&&e.errors.push(function Dy(){return new a.vHH(3200,!1)}());const m=t.steps.length;let _=0;s>0&&s<m?e.errors.push(function cw(){return new a.vHH(3202,!1)}()):0==s&&(_=1/(m-1));const y=m-1,w=e.currentTime,T=e.currentAnimateTimings,I=T.duration;return f.forEach((E,A)=>{const M=_>0?A==y?1:_*A:o[A],O=M*I;e.currentTime=w+T.delay+O,T.duration=O,this._validateStyleAst(E,e),E.offset=M,r.styles.push(E)}),r}visitReference(t,e){return{type:8,animation:Us(this,cf(t.animation),e),options:Xl(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Xl(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Xl(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,i=t.options||{};e.queryCount++,e.currentQuery=t;const[s,o]=function Dw(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(jy,"")),n=n.replace(/@\*/g,Md).replace(/@\w+/g,e=>Md+"-"+e.slice(1)).replace(/:animating/g,wm),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+s:s,ws(e.collectedStyles,e.currentQuerySelector,new Map);const l=Us(this,cf(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:l,originalSelector:t.selector,options:Xl(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function uw(){return new a.vHH(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:Od(t.timings,e.errors,!0);return{type:12,animation:Us(this,cf(t.animation),e),timings:r,options:null}}}class Au{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Xl(n){return n?(n=Du(n)).params&&(n.params=function kw(n){return n?Du(n):null}(n.params)):n={},n}function pf(n,t,e){return{duration:n,delay:t,easing:e}}function Zy(n,t,e,r,i,s,o=null,l=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:l}}class Ri{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Rw=new RegExp(":enter","g"),Yy=new RegExp(":leave","g");function Ky(n,t,e,r,i,s=new Map,o=new Map,l,c,u=[]){return(new IS).buildKeyframes(n,t,e,r,i,s,o,l,c,u)}class IS{buildKeyframes(t,e,r,i,s,o,l,c,u,f=[]){u=u||new Ri;const m=new Qy(t,e,u,i,s,f,[]);m.options=c;const _=c.delay?Ba(c.delay):0;m.currentTimeline.delayNextStep(_),m.currentTimeline.setStyles([o],null,m.errors,c),Us(this,r,m);const y=m.timelines.filter(w=>w.containsAnimation());if(y.length&&l.size){let w;for(let T=y.length-1;T>=0;T--){const I=y[T];if(I.element===e){w=I;break}}w&&!w.allowOnlyTimelineStyles()&&w.setStyles([l],null,m.errors,c)}return y.length?y.map(w=>w.buildKeyframes()):[Zy(e,[],[],[],0,_,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const i=e.createSubContext(t.options),s=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,i,i.options);s!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const i of t){const s=i?.delay;if(s){const o="number"==typeof s?s:Ba(ku(s,i?.params??{},e.errors));r.delayNextStep(o)}}}_visitSubInstructions(t,e,r){let s=e.currentTimeline.currentTime;const o=null!=r.duration?Ba(r.duration):null,l=null!=r.delay?Ba(r.delay):null;return 0!==o&&t.forEach(c=>{const u=e.appendInstructionToTimeline(c,o,l);s=Math.max(s,u.duration+u.delay)}),s}visitReference(t,e){e.updateOptions(t.options,!0),Us(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let i=e;const s=t.options;if(s&&(s.params||s.delay)&&(i=e.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=mf);const o=Ba(s.delay);i.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>Us(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let i=e.currentTimeline.currentTime;const s=t.options&&t.options.delay?Ba(t.options.delay):0;t.steps.forEach(o=>{const l=e.createSubContext(t.options);s&&l.delayNextStep(s),Us(this,o,l),i=Math.max(i,l.currentTimeline.currentTime),r.push(l.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(i),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return Od(e.params?ku(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),i=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),i.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(r.duration),this.visitStyle(s,e),i.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,i=e.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const s=i&&i.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(s):r.setStyles(t.styles,s,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,i=e.currentTimeline.duration,s=r.duration,l=e.createSubContext().currentTimeline;l.easing=r.easing,t.styles.forEach(c=>{l.forwardTime((c.offset||0)*s),l.setStyles(c.styles,c.easing,e.errors,e.options),l.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(l),e.transformIntoNewTimeline(i+s),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,i=t.options||{},s=i.delay?Ba(i.delay):0;s&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=mf);let o=r;const l=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=l.length;let c=null;l.forEach((u,f)=>{e.currentQueryIndex=f;const m=e.createSubContext(t.options,u);s&&m.delayNextStep(s),u===e.element&&(c=m.currentTimeline),Us(this,t.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),c&&(e.currentTimeline.mergeTimelineCollectedStyles(c),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,i=e.currentTimeline,s=t.timings,o=Math.abs(s.duration),l=o*(e.currentQueryTotal-1);let c=o*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=l-c;break;case"full":c=r.currentStaggerTime}const f=e.currentTimeline;c&&f.delayNextStep(c);const m=f.currentTime;Us(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=i.currentTime-m+(i.startTime-r.currentTimeline.startTime)}}const mf={};class Qy{constructor(t,e,r,i,s,o,l,c){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=l,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=mf,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new S(this._driver,e,0),l.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let i=this.options;null!=r.duration&&(i.duration=Ba(r.duration)),null!=r.delay&&(i.delay=Ba(r.delay));const s=r.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(l=>{(!e||!o.hasOwnProperty(l))&&(o[l]=ku(s[l],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(i=>{r[i]=e[i]})}}return t}createSubContext(t=null,e,r){const i=e||this.element,s=new Qy(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=mf,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const i={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},s=new b(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,i,t.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,i,s,o){let l=[];if(i&&l.push(this.element),t.length>0){t=(t=t.replace(Rw,"."+this._enterClassName)).replace(Yy,"."+this._leaveClassName);let u=this._driver.query(this.element,t,1!=r);0!==r&&(u=r<0?u.slice(u.length+r,u.length):u.slice(0,r)),l.push(...u)}return!s&&0==l.length&&o.push(function dw(n){return new a.vHH(3014,!1)}()),l}}class S{constructor(t,e,r,i){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new S(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Mo),this._currentKeyframe.set(e,Mo);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,i){e&&this._previousKeyframe.set("easing",e);const s=i&&i.params||{},o=function k(n,t){const e=new Map;let r;return n.forEach(i=>{if("*"===i){r=r||t.keys();for(let s of r)e.set(s,Mo)}else Va(i,e)}),e}(t,this._globalTimelineStyles);for(let[l,c]of o){const u=ku(c,s,r);this._pendingStyles.set(l,u),this._localTimelineStyles.has(l)||this._backFill.set(l,this._globalTimelineStyles.get(l)??Mo),this._updateStyle(l,u)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const i=this._styleSummary.get(r);(!i||e.time>i.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((l,c)=>{const u=Va(l,new Map,this._backFill);u.forEach((f,m)=>{"!"===f?t.add(m):f===Mo&&e.add(m)}),r||u.set("offset",c/this.duration),i.push(u)});const s=t.size?df(t.values()):[],o=e.size?df(e.values()):[];if(r){const l=i[0],c=new Map(l);l.set("offset",0),c.set("offset",1),i=[l,c]}return Zy(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class b extends S{constructor(t,e,r,i,s,o,l=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=l,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],o=r+e,l=e/o,c=Va(t[0]);c.set("offset",0),s.push(c);const u=Va(t[0]);u.set("offset",C(l)),s.push(u);const f=t.length-1;for(let m=1;m<=f;m++){let _=Va(t[m]);const y=_.get("offset");_.set("offset",C((e+y*r)/o)),s.push(_)}r=o,e=0,i="",t=s}return Zy(this.element,t,this.preStyleProps,this.postStyleProps,r,e,i,!0)}}function C(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class U{}const xe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class at extends U{normalizePropertyName(t,e){return ul(t)}normalizeStyleValue(t,e,r,i){let s="";const o=r.toString().trim();if(xe.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)s="px";else{const l=r.match(/^[+-]?[\d\.]+([a-z]*)$/);l&&0==l[1].length&&i.push(function tM(n,t){return new a.vHH(3005,!1)}())}return o+s}}function Et(n,t,e,r,i,s,o,l,c,u,f,m,_){return{type:0,element:n,triggerName:t,isRemovalTransition:i,fromState:e,fromStyles:s,toState:r,toStyles:o,timelines:l,queriedElements:c,preStyleProps:u,postStyleProps:f,totalTime:m,errors:_}}const Ut={};class jt{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,i){return function Oo(n,t,e,r,i){return n.some(s=>s(t,e,r,i))}(this.ast.matchers,t,e,r,i)}buildStyles(t,e,r){let i=this._stateStyles.get("*");return void 0!==t&&(i=this._stateStyles.get(t?.toString())||i),i?i.buildStyles(e,r):new Map}build(t,e,r,i,s,o,l,c,u,f){const m=[],_=this.ast.options&&this.ast.options.params||Ut,w=this.buildStyles(r,l&&l.params||Ut,m),T=c&&c.params||Ut,I=this.buildStyles(i,T,m),E=new Set,A=new Map,M=new Map,O="void"===i,$={params:Xy(T,_),delay:this.ast.options?.delay},V=f?[]:Ky(t,e,this.ast.animation,s,o,w,I,$,u,m);let Z=0;if(V.forEach(re=>{Z=Math.max(re.duration+re.delay,Z)}),m.length)return Et(e,this._triggerName,r,i,O,w,I,[],[],A,M,Z,m);V.forEach(re=>{const oe=re.element,ye=ws(A,oe,new Set);re.preStyleProps.forEach(We=>ye.add(We));const Ve=ws(M,oe,new Set);re.postStyleProps.forEach(We=>Ve.add(We)),oe!==e&&E.add(oe)});const Q=df(E.values());return Et(e,this._triggerName,r,i,O,w,I,V,Q,A,M,Z)}}function Xy(n,t){const e=Du(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class TS{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,i=Du(this.defaultParams);return Object.keys(t).forEach(s=>{const o=t[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,l)=>{o&&(o=ku(o,i,e));const c=this.normalizer.normalizePropertyName(l,e);o=this.normalizer.normalizeStyleValue(l,c,o,e),r.set(c,o)})}),r}}class Mw{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(i=>{this.states.set(i.name,new TS(i.style,i.options&&i.options.params||{},r))}),Em(this.states,"true","1"),Em(this.states,"false","0"),e.transitions.forEach(i=>{this.transitionFactories.push(new jt(t,i,this.states))}),this.fallbackTransition=function Ow(n,t,e){return new jt(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,l)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,i){return this.transitionFactories.find(o=>o.match(t,e,r,i))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function Em(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const Fw=new Ri;class Jy{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],s=Vd(this._driver,e,r,[]);if(r.length)throw function pS(n){return new a.vHH(3503,!1)}();this._animations.set(t,s)}_buildPlayer(t,e,r){const i=t.element,s=Oy(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(i,s,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const i=[],s=this._animations.get(t);let o;const l=new Map;if(s?(o=Ky(this._driver,e,s,lf,vm,new Map,new Map,r,Fw,i),o.forEach(f=>{const m=ws(l,f.element,new Map);f.postStyleProps.forEach(_=>m.set(_,null))})):(i.push(function mS(){return new a.vHH(3300,!1)}()),o=[]),i.length)throw function gS(n){return new a.vHH(3504,!1)}();l.forEach((f,m)=>{f.forEach((_,y)=>{f.set(y,this._driver.computeStyle(m,y,Mo))})});const u=Kl(o.map(f=>{const m=l.get(f.element);return this._buildPlayer(f,new Map,m)}));return this._playersById.set(t,u),u.onDestroy(()=>this.destroy(t)),this.players.push(u),u}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function Ny(n){return new a.vHH(3301,!1)}();return e}listen(t,e,r,i){const s=pw(e,"","","");return nf(this._getPlayer(t),r,s,i),()=>{}}command(t,e,r,i){if("register"==r)return void this.register(t,i[0]);if("create"==r)return void this.create(t,e,i[0]||{});const s=this._getPlayer(t);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(t)}}}const Nu="ng-animate-queued",gf="ng-animate-disabled",lU=[],Pw={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},oM={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},hl="__ng_removed";class SS{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function DS(n){return n??null}(r?t.value:t),r){const s=Du(t);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(i=>{null==r[i]&&(r[i]=e[i])})}}}const nv="void",ES=new SS(nv);class cU{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,za(e,this._hostClassName)}listen(t,e,r,i){if(!this._triggers.has(e))throw function _S(n,t){return new a.vHH(3302,!1)}();if(null==r||0==r.length)throw function yS(n){return new a.vHH(3303,!1)}();if(!function lM(n){return"start"==n||"done"==n}(r))throw function Vs(n,t){return new a.vHH(3400,!1)}();const s=ws(this._elementListeners,t,[]),o={name:e,phase:r,callback:i};s.push(o);const l=ws(this._engine.statesByElement,t,new Map);return l.has(e)||(za(t,bm),za(t,bm+"-"+e),l.set(e,ES)),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(e)||l.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function Ry(n){return new a.vHH(3401,!1)}();return e}trigger(t,e,r,i=!0){const s=this._getTrigger(e),o=new aM(this.id,e,t);let l=this._engine.statesByElement.get(t);l||(za(t,bm),za(t,bm+"-"+e),this._engine.statesByElement.set(t,l=new Map));let c=l.get(e);const u=new SS(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&c&&u.absorbOptions(c.options),l.set(e,u),c||(c=ES),u.value!==nv&&c.value===u.value){if(!function uM(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let i=0;i<e.length;i++){const s=e[i];if(!t.hasOwnProperty(s)||n[s]!==t[s])return!1}return!0}(c.params,u.params)){const T=[],I=s.matchStyles(c.value,c.params,T),E=s.matchStyles(u.value,u.params,T);T.length?this._engine.reportError(T):this._engine.afterFlush(()=>{cl(t,I),aa(t,E)})}return}const _=ws(this._engine.playersByElement,t,[]);_.forEach(T=>{T.namespaceId==this.id&&T.triggerName==e&&T.queued&&T.destroy()});let y=s.matchTransition(c.value,u.value,t,u.params),w=!1;if(!y){if(!i)return;y=s.fallbackTransition,w=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:y,fromState:c,toState:u,player:o,isFallbackTransition:w}),w||(za(t,Nu),o.onStart(()=>{Ud(t,Nu)})),o.onDone(()=>{let T=this.players.indexOf(o);T>=0&&this.players.splice(T,1);const I=this._engine.playersByElement.get(t);if(I){let E=I.indexOf(o);E>=0&&I.splice(E,1)}}),this.players.push(o),_.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(i=>i.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,Md,!0);r.forEach(i=>{if(i[hl])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,e,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(t,e,r,i){const s=this._engine.statesByElement.get(t),o=new Map;if(s){const l=[];if(s.forEach((c,u)=>{if(o.set(u,c.value),this._triggers.has(u)){const f=this.trigger(t,u,nv,i);f&&l.push(f)}}),l.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&Kl(l).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const i=new Set;e.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const c=this._triggers.get(o).fallbackTransition,u=r.get(o)||ES,f=new SS(nv),m=new aM(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:c,fromState:u,toState:f,player:m,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let i=!1;if(r.totalAnimations){const s=r.players.length?r.playersByQueriedElement.get(t):[];if(s&&s.length)i=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(t),i)r.markElementAsRemoved(this.id,t,!1,e);else{const s=t[hl];(!s||s===Pw)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){za(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const s=r.element,o=this._elementListeners.get(s);o&&o.forEach(l=>{if(l.name==r.triggerName){const c=pw(s,r.triggerName,r.fromState.value,r.toState.value);c._data=t,nf(r.player,l.phase,c,l.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):e.push(r)}),this._queue=[],e.sort((r,i)=>{const s=r.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class z9{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new cU(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,l=this.driver.getParentElement(e);for(;l;){const c=i.get(l);if(c){const u=r.indexOf(c);r.splice(u+1,0,t),o=!0;break}l=this.driver.getParentElement(l)}o||r.unshift(t)}else r.push(t);return i.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let i=this._namespaceLookup[t];i&&i.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let i of r.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&e.add(s)}return e}trigger(t,e,r,i){if(iv(e)){const s=this._fetchNamespace(t);if(s)return s.trigger(e,r,i),!0}return!1}insertNode(t,e,r,i){if(!iv(e))return;const s=e[hl];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}i&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),za(t,gf)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Ud(t,gf))}removeNode(t,e,r,i){if(iv(e)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(e,i):this.markElementAsRemoved(t,e,!1,i),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,i)}}else this._onRemovalComplete(e,i)}markElementAsRemoved(t,e,r,i,s){this.collectedLeaveElements.push(e),e[hl]={namespaceId:t,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(t,e,r,i,s){return iv(e)?this._fetchNamespace(t).listen(e,r,i,s):()=>{}}_buildInstruction(t,e,r,i,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,i,t.fromState.options,t.toState.options,e,s)}destroyInnerAnimations(t){let e=this.driver.query(t,Md,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,wm,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Kl(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[hl];if(e&&e.setForRemoval){if(t[hl]=Pw,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(gf)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)za(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?Kl(e).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(t){throw function fw(n){return new a.vHH(3402,!1)}()}_flushAnimations(t,e){const r=new Ri,i=[],s=new Map,o=[],l=new Map,c=new Map,u=new Map,f=new Set;this.disabledNodes.forEach(ge=>{f.add(ge);const we=this.driver.query(ge,".ng-animate-queued",!0);for(let _e=0;_e<we.length;_e++)f.add(we[_e])});const m=this.bodyNode,_=Array.from(this.statesByElement.keys()),y=AS(_,this.collectedEnterElements),w=new Map;let T=0;y.forEach((ge,we)=>{const _e=lf+T++;w.set(we,_e),ge.forEach(ze=>za(ze,_e))});const I=[],E=new Set,A=new Set;for(let ge=0;ge<this.collectedLeaveElements.length;ge++){const we=this.collectedLeaveElements[ge],_e=we[hl];_e&&_e.setForRemoval&&(I.push(we),E.add(we),_e.hasAnimation?this.driver.query(we,".ng-star-inserted",!0).forEach(ze=>E.add(ze)):A.add(we))}const M=new Map,O=AS(_,Array.from(E));O.forEach((ge,we)=>{const _e=vm+T++;M.set(we,_e),ge.forEach(ze=>za(ze,_e))}),t.push(()=>{y.forEach((ge,we)=>{const _e=w.get(we);ge.forEach(ze=>Ud(ze,_e))}),O.forEach((ge,we)=>{const _e=M.get(we);ge.forEach(ze=>Ud(ze,_e))}),I.forEach(ge=>{this.processLeaveNode(ge)})});const $=[],V=[];for(let ge=this._namespaceList.length-1;ge>=0;ge--)this._namespaceList[ge].drainQueuedTransitions(e).forEach(_e=>{const ze=_e.player,it=_e.element;if($.push(ze),this.collectedEnterElements.length){const Ht=it[hl];if(Ht&&Ht.setForMove){if(Ht.previousTriggersValues&&Ht.previousTriggersValues.has(_e.triggerName)){const mn=Ht.previousTriggersValues.get(_e.triggerName),rn=this.statesByElement.get(_e.element);if(rn&&rn.has(_e.triggerName)){const On=rn.get(_e.triggerName);On.value=mn,rn.set(_e.triggerName,On)}}return void ze.destroy()}}const ht=!m||!this.driver.containsElement(m,it),bt=M.get(it),_t=w.get(it),xt=this._buildInstruction(_e,r,_t,bt,ht);if(xt.errors&&xt.errors.length)return void V.push(xt);if(ht)return ze.onStart(()=>cl(it,xt.fromStyles)),ze.onDestroy(()=>aa(it,xt.toStyles)),void i.push(ze);if(_e.isFallbackTransition)return ze.onStart(()=>cl(it,xt.fromStyles)),ze.onDestroy(()=>aa(it,xt.toStyles)),void i.push(ze);const At=[];xt.timelines.forEach(Ht=>{Ht.stretchStartingKeyframe=!0,this.disabledNodes.has(Ht.element)||At.push(Ht)}),xt.timelines=At,r.append(it,xt.timelines),o.push({instruction:xt,player:ze,element:it}),xt.queriedElements.forEach(Ht=>ws(l,Ht,[]).push(ze)),xt.preStyleProps.forEach((Ht,mn)=>{if(Ht.size){let rn=c.get(mn);rn||c.set(mn,rn=new Set),Ht.forEach((On,Vn)=>rn.add(Vn))}}),xt.postStyleProps.forEach((Ht,mn)=>{let rn=u.get(mn);rn||u.set(mn,rn=new Set),Ht.forEach((On,Vn)=>rn.add(Vn))})});if(V.length){const ge=[];V.forEach(we=>{ge.push(function Zi(n,t){return new a.vHH(3505,!1)}())}),$.forEach(we=>we.destroy()),this.reportError(ge)}const Z=new Map,Q=new Map;o.forEach(ge=>{const we=ge.element;r.has(we)&&(Q.set(we,we),this._beforeAnimationBuild(ge.player.namespaceId,ge.instruction,Z))}),i.forEach(ge=>{const we=ge.element;this._getPreviousPlayers(we,!1,ge.namespaceId,ge.triggerName,null).forEach(ze=>{ws(Z,we,[]).push(ze),ze.destroy()})});const re=I.filter(ge=>NS(ge,c,u)),oe=new Map;cM(oe,this.driver,A,u,Mo).forEach(ge=>{NS(ge,c,u)&&re.push(ge)});const Ve=new Map;y.forEach((ge,we)=>{cM(Ve,this.driver,new Set(ge),c,"!")}),re.forEach(ge=>{const we=oe.get(ge),_e=Ve.get(ge);oe.set(ge,new Map([...Array.from(we?.entries()??[]),...Array.from(_e?.entries()??[])]))});const We=[],Ke=[],Qe={};o.forEach(ge=>{const{element:we,player:_e,instruction:ze}=ge;if(r.has(we)){if(f.has(we))return _e.onDestroy(()=>aa(we,ze.toStyles)),_e.disabled=!0,_e.overrideTotalTime(ze.totalTime),void i.push(_e);let it=Qe;if(Q.size>1){let bt=we;const _t=[];for(;bt=bt.parentNode;){const xt=Q.get(bt);if(xt){it=xt;break}_t.push(bt)}_t.forEach(xt=>Q.set(xt,it))}const ht=this._buildAnimation(_e.namespaceId,ze,Z,s,Ve,oe);if(_e.setRealPlayer(ht),it===Qe)We.push(_e);else{const bt=this.playersByElement.get(it);bt&&bt.length&&(_e.parentPlayer=Kl(bt)),i.push(_e)}}else cl(we,ze.fromStyles),_e.onDestroy(()=>aa(we,ze.toStyles)),Ke.push(_e),f.has(we)&&i.push(_e)}),Ke.forEach(ge=>{const we=s.get(ge.element);if(we&&we.length){const _e=Kl(we);ge.setRealPlayer(_e)}}),i.forEach(ge=>{ge.parentPlayer?ge.syncPlayerEvents(ge.parentPlayer):ge.destroy()});for(let ge=0;ge<I.length;ge++){const we=I[ge],_e=we[hl];if(Ud(we,vm),_e&&_e.hasAnimation)continue;let ze=[];if(l.size){let ht=l.get(we);ht&&ht.length&&ze.push(...ht);let bt=this.driver.query(we,wm,!0);for(let _t=0;_t<bt.length;_t++){let xt=l.get(bt[_t]);xt&&xt.length&&ze.push(...xt)}}const it=ze.filter(ht=>!ht.destroyed);it.length?H9(this,we,it):this.processLeaveNode(we)}return I.length=0,We.forEach(ge=>{this.players.push(ge),ge.onDone(()=>{ge.destroy();const we=this.players.indexOf(ge);this.players.splice(we,1)}),ge.play()}),We}elementContainsData(t,e){let r=!1;const i=e[hl];return i&&i.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,i,s){let o=[];if(e){const l=this.playersByQueriedElement.get(t);l&&(o=l)}else{const l=this.playersByElement.get(t);if(l){const c=!s||s==nv;l.forEach(u=>{u.queued||!c&&u.triggerName!=i||o.push(u)})}}return(r||i)&&(o=o.filter(l=>!(r&&r!=l.namespaceId||i&&i!=l.triggerName))),o}_beforeAnimationBuild(t,e,r){const s=e.element,o=e.isRemovalTransition?void 0:t,l=e.isRemovalTransition?void 0:e.triggerName;for(const c of e.timelines){const u=c.element,f=u!==s,m=ws(r,u,[]);this._getPreviousPlayers(u,f,o,l,e.toState).forEach(y=>{const w=y.getRealPlayer();w.beforeDestroy&&w.beforeDestroy(),y.destroy(),m.push(y)})}cl(s,e.fromStyles)}_buildAnimation(t,e,r,i,s,o){const l=e.triggerName,c=e.element,u=[],f=new Set,m=new Set,_=e.timelines.map(w=>{const T=w.element;f.add(T);const I=T[hl];if(I&&I.removedBeforeQueried)return new Eu(w.duration,w.delay);const E=T!==c,A=function uU(n){const t=[];return Lw(n,t),t}((r.get(T)||lU).map(Z=>Z.getRealPlayer())).filter(Z=>!!Z.element&&Z.element===T),M=s.get(T),O=o.get(T),$=Oy(0,this._normalizer,0,w.keyframes,M,O),V=this._buildPlayer(w,$,A);if(w.subTimeline&&i&&m.add(T),E){const Z=new aM(t,l,T);Z.setRealPlayer(V),u.push(Z)}return V});u.forEach(w=>{ws(this.playersByQueriedElement,w.element,[]).push(w),w.onDone(()=>function rv(n,t,e){let r=n.get(t);if(r){if(r.length){const i=r.indexOf(e);r.splice(i,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,w.element,w))}),f.forEach(w=>za(w,vw));const y=Kl(_);return y.onDestroy(()=>{f.forEach(w=>Ud(w,vw)),aa(c,e.toStyles)}),m.forEach(w=>{ws(i,w,[]).push(y)}),y}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new Eu(t.duration,t.delay)}}class aM{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new Eu,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(i=>nf(t,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){ws(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function iv(n){return n&&1===n.nodeType}function kS(n,t){const e=n.style.display;return n.style.display=t??"none",e}function cM(n,t,e,r,i){const s=[];e.forEach(c=>s.push(kS(c)));const o=[];r.forEach((c,u)=>{const f=new Map;c.forEach(m=>{const _=t.computeStyle(u,m,i);f.set(m,_),(!_||0==_.length)&&(u[hl]=oM,o.push(u))}),n.set(u,f)});let l=0;return e.forEach(c=>kS(c,s[l++])),o}function AS(n,t){const e=new Map;if(n.forEach(l=>e.set(l,[])),0==t.length)return e;const i=new Set(t),s=new Map;function o(l){if(!l)return 1;let c=s.get(l);if(c)return c;const u=l.parentNode;return c=e.has(u)?u:i.has(u)?1:o(u),s.set(l,c),c}return t.forEach(l=>{const c=o(l);1!==c&&e.get(c).push(l)}),e}function za(n,t){n.classList?.add(t)}function Ud(n,t){n.classList?.remove(t)}function H9(n,t,e){Kl(e).onDone(()=>n.processLeaveNode(t))}function Lw(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof um?Lw(r.players,t):t.push(r)}}function NS(n,t,e){const r=e.get(n);if(!r)return!1;let i=t.get(n);return i?r.forEach(s=>i.add(s)):t.set(n,r),e.delete(n),!0}class Rc{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new z9(t,e,r),this._timelineEngine=new Jy(t,e,r),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(t,e,r,i,s){const o=t+"-"+i;let l=this._triggerCache[o];if(!l){const c=[],f=Vd(this._driver,s,c,[]);if(c.length)throw function hw(n,t){return new a.vHH(3404,!1)}();l=function Sm(n,t,e){return new Mw(n,t,e)}(i,f,this._normalizer),this._triggerCache[o]=l}this._transitionEngine.registerTrigger(e,i,l)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,i){this._transitionEngine.insertNode(t,e,r,i)}onRemove(t,e,r,i){this._transitionEngine.removeNode(t,e,i||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,i){if("@"==r.charAt(0)){const[s,o]=Fy(r);this._timelineEngine.command(s,e,o,i)}else this._transitionEngine.trigger(t,e,r,i)}listen(t,e,r,i,s){if("@"==r.charAt(0)){const[o,l]=Fy(r);return this._timelineEngine.listen(o,e,l,s)}return this._transitionEngine.listen(t,e,r,i,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let RS=(()=>{class n{constructor(e,r,i){this._element=e,this._startStyles=r,this._endStyles=i,this._state=0;let s=n.initialStylesByElement.get(e);s||n.initialStylesByElement.set(e,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&aa(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(aa(this._element,this._initialStyles),this._endStyles&&(aa(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(cl(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(cl(this._element,this._endStyles),this._endStyles=null),aa(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function Dm(n){let t=null;return n.forEach((e,r)=>{(function hU(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class $w{constructor(t,e,r,i){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&t.set(i,this._finished?r:Fd(this.element,i))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Bw{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return Ql(t,e)}getParentElement(t){return Py(t)}query(t,e,r){return wS(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,i,s,o=[]){const c={duration:r,delay:i,fill:0==i?"both":"forwards"};s&&(c.easing=s);const u=new Map,f=o.filter(y=>y instanceof $w);(function Im(n,t){return 0===n||0===t})(r,i)&&f.forEach(y=>{y.currentSnapshot.forEach((w,T)=>u.set(T,w))});let m=function ww(n){return n.length?n[0]instanceof Map?n:n.map(t=>$y(t)):[]}(e).map(y=>Va(y));m=function Uy(n,t,e){if(e.size&&t.length){let r=t[0],i=[];if(e.forEach((s,o)=>{r.has(o)||i.push(o),r.set(o,s)}),i.length)for(let s=1;s<t.length;s++){let o=t[s];i.forEach(l=>o.set(l,Fd(n,l)))}}return t}(t,m,u);const _=function dU(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=Dm(t[0]),t.length>1&&(r=Dm(t[t.length-1]))):t instanceof Map&&(e=Dm(t)),e||r?new RS(n,e,r):null}(t,m);return new $w(t,m,c,_)}}let _f=(()=>{class n extends Ty{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:a.ifc.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(e)?Yl(e):e;return hM(this._renderer,null,r,"register",[i]),new dM(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.FYo),a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();class dM extends class Tu{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new MS(this._id,t,e||{},this._renderer)}}class MS{constructor(t,e,r,i){this.id=t,this.element=e,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return hM(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function hM(n,t,e,r,i){return n.setProperty(t,`@@${e}:${r}`,i)}const OS="@.disabled";let km=(()=>{class n{constructor(e,r,i){this.delegate=e,this.engine=r,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(s,o)=>{const l=o?.parentNode(s);l&&o.removeChild(l,s)}}createRenderer(e,r){const s=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let f=this._rendererCache.get(s);return f||(f=new fM("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,f)),f}const o=r.id,l=r.id+"-"+this._currentId;this._currentId++,this.engine.register(l,e);const c=f=>{Array.isArray(f)?f.forEach(c):this.engine.registerTrigger(o,l,e,f.name,f)};return r.data.animation.forEach(c),new fU(this,l,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,i){e>=0&&e<this._microtaskId?this._zone.run(()=>r(i)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,l]=s;o(l)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.FYo),a.LFG(Rc),a.LFG(a.R0b))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();class fM{constructor(t,e,r,i){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=i,this.destroyNode=this.delegate.destroyNode?s=>e.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,i=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,i)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,i){this.delegate.setAttribute(t,e,r,i)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,i){this.delegate.setStyle(t,e,r,i)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==OS?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class fU extends fM{constructor(t,e,r,i,s){super(e,r,i,s),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==OS?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const i=function pU(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let s=e.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function mU(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,l=>{this.factory.scheduleListenerCallback(l._data||-1,r,l)})}return this.delegate.listen(t,e,r)}}let FS=(()=>{class n extends Rc{constructor(e,r,i,s){super(e.body,r,i)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt),a.LFG(_m),a.LFG(U),a.LFG(a.z2F))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const mM=[{provide:Ty,useClass:_f},{provide:U,useFactory:function gU(){return new at}},{provide:Rc,useClass:FS},{provide:a.FYo,useFactory:function pM(n,t,e){return new km(n,t,e)},deps:[Wh,Rc,a.R0b]}],Uw=[{provide:_m,useFactory:()=>new Bw},{provide:a.QbO,useValue:"BrowserAnimations"},...mM],_U=[{provide:_m,useClass:Rd},{provide:a.QbO,useValue:"NoopAnimations"},...mM];let yU=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?_U:Uw}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:Uw,imports:[rm]}),n})();var Dn=z(8996),Cr=z(9751);const{isArray:W9}=Array,{getPrototypeOf:gM,prototype:vU,keys:bU}=Object;function _M(n){if(1===n.length){const t=n[0];if(W9(t))return{args:t,keys:null};if(function yM(n){return n&&"object"==typeof n&&gM(n)===vU}(t)){const e=bU(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}var Ru=z(8421),Mu=z(3269),zr=z(5403),Ot=z(4004);const{isArray:PS}=Array;function LS(n){return(0,Ot.U)(t=>function ov(n,t){return PS(t)?n(...t):n(t)}(n,t))}function vM(n,t){return n.reduce((e,r,i)=>(e[r]=t[i],e),{})}function bM(...n){const t=(0,Mu.jO)(n),{args:e,keys:r}=_M(n),i=new Cr.y(s=>{const{length:o}=e;if(!o)return void s.complete();const l=new Array(o);let c=o,u=o;for(let f=0;f<o;f++){let m=!1;(0,Ru.Xf)(e[f]).subscribe((0,zr.x)(s,_=>{m||(m=!0,u--),l[f]=_},()=>c--,void 0,()=>{(!c||!m)&&(u||s.next(r?vM(r,l):l),s.complete())}))}});return t?i.pipe(LS(t)):i}let wM=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Qsj),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n}),n})(),yf=(()=>{class n extends wM{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,features:[a.qOj]}),n})();const Ha=new a.OlP("NgValueAccessor"),Ou={provide:Ha,useExisting:(0,a.Gpc)(()=>bf),multi:!0},xU=new a.OlP("CompositionEventMode");let bf=(()=>{class n extends wM{constructor(e,r,i){super(e,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function CU(){const n=Wt()?Wt().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Qsj),a.Y36(a.SBq),a.Y36(xU,8))},n.\u0275dir=a.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&a.NdJ("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[a._Bn([Ou]),a.qOj]}),n})();function Fu(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function IU(n){return null!=n&&"number"==typeof n.length}const ls=new a.OlP("NgValidators"),wf=new a.OlP("NgAsyncValidators"),CM=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class cn{static min(t){return $S(t)}static max(t){return xM(t)}static required(t){return function IM(n){return Fu(n.value)?{required:!0}:null}(t)}static requiredTrue(t){return function fl(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function TM(n){return Fu(n.value)||CM.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function BS(n){return t=>Fu(t.value)||!IU(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return SM(t)}static pattern(t){return function EM(n){if(!n)return Hw;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(Fu(r.value))return null;const i=r.value;return t.test(i)?null:{pattern:{requiredPattern:e,actualValue:i}}}}(t)}static nullValidator(t){return null}static compose(t){return US(t)}static composeAsync(t){return zS(t)}}function $S(n){return t=>{if(Fu(t.value)||Fu(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}function xM(n){return t=>{if(Fu(t.value)||Fu(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}function SM(n){return t=>IU(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function Hw(n){return null}function DM(n){return null!=n}function VS(n){return(0,a.QGY)(n)?(0,Dn.D)(n):n}function kM(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function AM(n,t){return t.map(e=>e(n))}function Mn(n){return n.map(t=>function TU(n){return!n.validate}(t)?t:e=>t.validate(e))}function US(n){if(!n)return null;const t=n.filter(DM);return 0==t.length?null:function(e){return kM(AM(e,t))}}function Gw(n){return null!=n?US(Mn(n)):null}function zS(n){if(!n)return null;const t=n.filter(DM);return 0==t.length?null:function(e){return bM(AM(e,t).map(VS)).pipe((0,Ot.U)(kM))}}function HS(n){return null!=n?zS(Mn(n)):null}function NM(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function GS(n){return n._rawValidators}function RM(n){return n._rawAsyncValidators}function Ww(n){return n?Array.isArray(n)?n:[n]:[]}function jw(n,t){return Array.isArray(n)?n.includes(t):n===t}function MM(n,t){const e=Ww(t);return Ww(n).forEach(i=>{jw(e,i)||e.push(i)}),e}function SU(n,t){return Ww(t).filter(e=>!jw(n,e))}class WS{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Gw(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=HS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class lo extends WS{get formDirective(){return null}get path(){return null}}class co extends WS{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class OM{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Cf=(()=>{class n extends OM{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(co,2))},n.\u0275dir=a.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&a.ekj("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[a.qOj]}),n})(),av=(()=>{class n extends OM{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(lo,10))},n.\u0275dir=a.lG2({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&a.ekj("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[a.qOj]}),n})();const cv="VALID",uv="INVALID",xf="PENDING",If="DISABLED";function BM(n){return(Pu(n)?n.validators:n)||null}function Yw(n){return Array.isArray(n)?Gw(n):n||null}function ZS(n,t){return(Pu(t)?t.asyncValidators:n)||null}function OU(n){return Array.isArray(n)?HS(n):n||null}function Pu(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function YS(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new a.vHH(1e3,"");if(!r[e])throw new a.vHH(1001,"")}function KS(n,t,e){n._forEachChild((r,i)=>{if(void 0===e[i])throw new a.vHH(1002,"")})}class Tf{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=Yw(this._rawValidators),this._composedAsyncValidatorFn=OU(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===cv}get invalid(){return this.status===uv}get pending(){return this.status==xf}get disabled(){return this.status===If}get enabled(){return this.status!==If}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=Yw(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=OU(t)}addValidators(t){this.setValidators(MM(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(MM(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(SU(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(SU(t,this._rawAsyncValidators))}hasValidator(t){return jw(this._rawValidators,t)}hasAsyncValidator(t){return jw(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=xf,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=If,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=cv,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===cv||this.status===xf)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?If:cv}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=xf,this._hasOwnPendingAsyncValidator=!0;const e=VS(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,i)=>r&&r._find(i),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new a.vpe,this.statusChanges=new a.vpe}_calculateStatus(){return this._allControlsDisabled()?If:this.errors?uv:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(xf)?xf:this._anyControlsHaveStatus(uv)?uv:cv}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Pu(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class Fo extends Tf{constructor(t,e,r){super(BM(e),ZS(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){KS(this,0,t),Object.keys(t).forEach(r=>{YS(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const i=this.controls[r];i&&i.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,i)=>{r.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,i)=>((r.enabled||this.disabled)&&(e[i]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((i,s)=>{r=e(r,i,s)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class Kw extends Fo{}function Am(n,t){return[...t.path,n]}function Nm(n,t){UM(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function Qw(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&Xw(n,t)})}(n,t),function JS(n,t){const e=(r,i)=>{t.valueAccessor.writeValue(r),i&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function XS(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&Xw(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function VM(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function Rm(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),Sf(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function QS(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function UM(n,t){const e=GS(n);null!==t.validator?n.setValidators(NM(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=RM(n);null!==t.asyncValidator?n.setAsyncValidators(NM(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();QS(t._rawValidators,i),QS(t._rawAsyncValidators,i)}function Sf(n,t){let e=!1;if(null!==n){if(null!==t.validator){const i=GS(n);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==t.validator);s.length!==i.length&&(e=!0,n.setValidators(s))}}if(null!==t.asyncValidator){const i=RM(n);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==t.asyncValidator);s.length!==i.length&&(e=!0,n.setAsyncValidators(s))}}}const r=()=>{};return QS(t._rawValidators,r),QS(t._rawAsyncValidators,r),e}function Xw(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function PU(n,t){UM(n,t)}function HM(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function UU(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Jw(n,t){if(!t)return null;let e,r,i;return Array.isArray(t),t.forEach(s=>{s.constructor===bf?e=s:function VU(n){return Object.getPrototypeOf(n.constructor)===yf}(s)?r=s:i=s}),i||r||e||null}const eE={provide:lo,useExisting:(0,a.Gpc)(()=>tC)},eC=(()=>Promise.resolve())();let tC=(()=>{class n extends lo{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new a.vpe,this.form=new Fo({},Gw(e),HS(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){eC.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),Nm(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){eC.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){eC.then(()=>{const r=this._findContainer(e.path),i=new Fo({});PU(i,e),r.registerControl(e.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){eC.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){eC.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,UU(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(ls,10),a.Y36(wf,10))},n.\u0275dir=a.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&a.NdJ("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[a._Bn([eE]),a.qOj]}),n})();function zU(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function HU(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const dv=class extends Tf{constructor(t=null,e,r){super(BM(e),ZS(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Pu(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=HU(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){zU(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){zU(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){HU(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};let GU=(()=>{class n extends lo{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return Am(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,features:[a.qOj]}),n})();const nE={provide:co,useExisting:(0,a.Gpc)(()=>hv)},rE=(()=>Promise.resolve())();let hv=(()=>{class n extends co{constructor(e,r,i,s,o){super(),this._changeDetectorRef=o,this.control=new dv,this._registered=!1,this.update=new a.vpe,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Jw(0,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),HM(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Nm(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){rE.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,i=0!==r&&(0,a.D6c)(r);rE.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Am(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(lo,9),a.Y36(ls,10),a.Y36(wf,10),a.Y36(Ha,10),a.Y36(a.sBO,8))},n.\u0275dir=a.lG2({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[a._Bn([nE]),a.qOj,a.TTD]}),n})(),Mm=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const Hd={provide:Ha,useExisting:(0,a.Gpc)(()=>nC),multi:!0};let nC=(()=>{class n extends yf{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,r){1&e&&a.NdJ("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[a._Bn([Hd]),a.qOj]}),n})(),iE=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})();const fv=new a.OlP("NgModelWithFormControlWarning"),sC={provide:lo,useExisting:(0,a.Gpc)(()=>Jl)};let Jl=(()=>{class n extends lo{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new a.vpe,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Sf(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return Nm(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){Rm(e.control||null,e,!1),function GM(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,UU(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,i=this.form.get(e.path);r!==i&&(Rm(r||null,e),(n=>n instanceof dv)(i)&&(Nm(i,e),e.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);PU(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function LU(n,t){return Sf(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){UM(this.form,this),this._oldForm&&Sf(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(ls,10),a.Y36(wf,10))},n.\u0275dir=a.lG2({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&a.NdJ("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[a._Bn([sC]),a.qOj,a.TTD]}),n})();const qM={provide:lo,useExisting:(0,a.Gpc)(()=>kf)};let kf=(()=>{class n extends GU{constructor(e,r,i){super(),this._parent=e,this._setValidators(r),this._setAsyncValidators(i)}_checkParentType(){aC(this._parent)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(lo,13),a.Y36(ls,10),a.Y36(wf,10))},n.\u0275dir=a.lG2({type:n,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[a._Bn([qM]),a.qOj]}),n})();const sE={provide:lo,useExisting:(0,a.Gpc)(()=>oC)};let oC=(()=>{class n extends lo{constructor(e,r,i){super(),this._parent=e,this._setValidators(r),this._setAsyncValidators(i)}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return Am(null==this.name?this.name:this.name.toString(),this._parent)}_checkParentType(){aC(this._parent)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(lo,13),a.Y36(ls,10),a.Y36(wf,10))},n.\u0275dir=a.lG2({type:n,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[a._Bn([sE]),a.qOj]}),n})();function aC(n){return!(n instanceof kf||n instanceof Jl||n instanceof oC)}const ZU={provide:co,useExisting:(0,a.Gpc)(()=>Fm)};let Fm=(()=>{class n extends co{constructor(e,r,i,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new a.vpe,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Jw(0,s)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),HM(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Am(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(a.Y36(lo,13),a.Y36(ls,10),a.Y36(wf,10),a.Y36(Ha,10),a.Y36(fv,8))},n.\u0275dir=a.lG2({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[a._Bn([ZU]),a.qOj,a.TTD]}),n})();function aE(n){return"number"==typeof n?n:parseFloat(n)}let Af=(()=>{class n{constructor(){this._validator=Hw}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Hw,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,features:[a.TTD]}),n})();const JU={provide:ls,useExisting:(0,a.Gpc)(()=>lE),multi:!0};let lE=(()=>{class n extends Af{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>aE(e),this.createValidator=e=>xM(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&a.uIk("max",r._enabled?r.max:null)},inputs:{max:"max"},features:[a._Bn([JU]),a.qOj]}),n})();const QM={provide:ls,useExisting:(0,a.Gpc)(()=>cE),multi:!0};let cE=(()=>{class n extends Af{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>aE(e),this.createValidator=e=>$S(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&a.uIk("min",r._enabled?r.min:null)},inputs:{min:"min"},features:[a._Bn([QM]),a.qOj]}),n})();const tz={provide:ls,useExisting:(0,a.Gpc)(()=>Pm),multi:!0};let Pm=(()=>{class n extends Af{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function cC(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>SM(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&a.uIk("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[a._Bn([tz]),a.qOj]}),n})(),hC=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[iE]}),n})(),nz=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[hC]}),n})(),tO=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:fv,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[hC]}),n})();class pv extends Tf{constructor(t,e,r){super(BM(e),ZS(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),e&&(this.controls.splice(i,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){KS(this,0,t),t.forEach((r,i)=>{YS(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,i)=>{r.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function rz(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let Nf=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const i=this._reduceControls(e);let s={};return rz(r)?s=r:null!==r&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new Fo(i,s)}record(e,r=null){const i=this._reduceControls(e);return new Kw(i,r)}control(e,r,i){let s={};return this.useNonNullable?(rz(r)?s=r:(s.validators=r,s.asyncValidators=i),new dv(e,{...s,nonNullable:!0})):new dv(e,r,i)}array(e,r,i){const s=e.map(o=>this._createControl(o));return new pv(s,r,i)}_reduceControls(e){const r={};return Object.keys(e).forEach(i=>{r[i]=this._createControl(e[i])}),r}_createControl(e){return e instanceof dv||e instanceof Tf?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:tO}),n})();function St(...n){const t=(0,Mu.yG)(n);return(0,Dn.D)(n,t)}var Cs=z(5577),Po=z(576);function uo(n,t){return(0,Po.m)(t)?(0,Cs.z)(n,t,1):(0,Cs.z)(n,1)}var ti=z(4482);function cr(n,t){return(0,ti.e)((e,r)=>{let i=0;e.subscribe((0,zr.x)(r,s=>n.call(t,s,i++)&&r.next(s)))})}class Lm{}class rO{}class ec{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const i=e.slice(0,r),s=i.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(i,r),this.maybeSetNormalizedName(e,i))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof ec?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new ec;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof ec?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const i=("a"===t.op?this.headers.get(e):void 0)||[];i.push(...r),this.headers.set(e,i);break;case"d":const s=t.value;if(s){let o=this.headers.get(e);if(!o)return;o=o.filter(l=>-1===s.indexOf(l)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class az{encodeKey(t){return uz(t)}encodeValue(t){return uz(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const mv=/%(\d[a-f0-9])/gi,cz={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function uz(n){return encodeURIComponent(n).replace(mv,(t,e)=>cz[e]??t)}function fC(n){return`${n}`}class Rf{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new az,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function lz(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,l]=-1==s?[t.decodeKey(i),""]:[t.decodeKey(i.slice(0,s)),t.decodeValue(i.slice(s+1))],c=e.get(o)||[];c.push(l),e.set(o,c)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],i=Array.isArray(r)?r.map(fC):[fC(r)];this.map.set(e,i)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const i=t[r];Array.isArray(i)?i.forEach(s=>{e.push({param:r,value:s,op:"a"})}):e.push({param:r,value:i,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Rf({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(fC(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const i=r.indexOf(fC(t.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class dz{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function fE(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function pC(n){return typeof Blob<"u"&&n instanceof Blob}function iO(n){return typeof FormData<"u"&&n instanceof FormData}class gv{constructor(t,e,r,i){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function hz(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new ec),this.context||(this.context=new dz),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const l=e.indexOf("?");this.urlWithParams=e+(-1===l?"?":l<e.length-1?"&":"")+o}}else this.params=new Rf,this.urlWithParams=e}serializeBody(){return null===this.body?null:fE(this.body)||pC(this.body)||iO(this.body)||function pE(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Rf?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||iO(this.body)?null:pC(this.body)?this.body.type||null:fE(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Rf?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,i=t.responseType||this.responseType,s=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,l=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let c=t.headers||this.headers,u=t.params||this.params;const f=t.context??this.context;return void 0!==t.setHeaders&&(c=Object.keys(t.setHeaders).reduce((m,_)=>m.set(_,t.setHeaders[_]),c)),t.setParams&&(u=Object.keys(t.setParams).reduce((m,_)=>m.set(_,t.setParams[_]),u)),new gv(e,r,s,{params:u,headers:c,context:f,reportProgress:l,responseType:i,withCredentials:o})}}var Yi=(()=>((Yi=Yi||{})[Yi.Sent=0]="Sent",Yi[Yi.UploadProgress=1]="UploadProgress",Yi[Yi.ResponseHeader=2]="ResponseHeader",Yi[Yi.DownloadProgress=3]="DownloadProgress",Yi[Yi.Response=4]="Response",Yi[Yi.User=5]="User",Yi))();class mE{constructor(t,e=200,r="OK"){this.headers=t.headers||new ec,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class gE extends mE{constructor(t={}){super(t),this.type=Yi.ResponseHeader}clone(t={}){return new gE({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class mC extends mE{constructor(t={}){super(t),this.type=Yi.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new mC({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class sO extends mE{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function $m(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let Oc=(()=>{class n{constructor(e){this.handler=e}request(e,r,i={}){let s;if(e instanceof gv)s=e;else{let c,u;c=i.headers instanceof ec?i.headers:new ec(i.headers),i.params&&(u=i.params instanceof Rf?i.params:new Rf({fromObject:i.params})),s=new gv(e,r,void 0!==i.body?i.body:null,{headers:c,context:i.context,params:u,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const o=St(s).pipe(uo(c=>this.handler.handle(c)));if(e instanceof gv||"events"===i.observe)return o;const l=o.pipe(cr(c=>c instanceof mC));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe((0,Ot.U)(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return l.pipe((0,Ot.U)(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return l.pipe((0,Ot.U)(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new Error("Response is not a string.");return c.body}));default:return l.pipe((0,Ot.U)(c=>c.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new Rf).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,i={}){return this.request("PATCH",e,$m(i,r))}post(e,r,i={}){return this.request("POST",e,$m(i,r))}put(e,r,i={}){return this.request("PUT",e,$m(i,r))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Lm))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();class fz{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const Bm=new a.OlP("HTTP_INTERCEPTORS");let pz=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const yE=/^\)\]\}',?\n/;let Mf=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Cr.y(r=>{const i=this.xhrFactory.build();if(i.open(e.method,e.urlWithParams),e.withCredentials&&(i.withCredentials=!0),e.headers.forEach((y,w)=>i.setRequestHeader(y,w.join(","))),e.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const y=e.detectContentTypeHeader();null!==y&&i.setRequestHeader("Content-Type",y)}if(e.responseType){const y=e.responseType.toLowerCase();i.responseType="json"!==y?y:"text"}const s=e.serializeBody();let o=null;const l=()=>{if(null!==o)return o;const y=i.statusText||"OK",w=new ec(i.getAllResponseHeaders()),T=function Um(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(i)||e.url;return o=new gE({headers:w,status:i.status,statusText:y,url:T}),o},c=()=>{let{headers:y,status:w,statusText:T,url:I}=l(),E=null;204!==w&&(E=typeof i.response>"u"?i.responseText:i.response),0===w&&(w=E?200:0);let A=w>=200&&w<300;if("json"===e.responseType&&"string"==typeof E){const M=E;E=E.replace(yE,"");try{E=""!==E?JSON.parse(E):null}catch(O){E=M,A&&(A=!1,E={error:O,text:E})}}A?(r.next(new mC({body:E,headers:y,status:w,statusText:T,url:I||void 0})),r.complete()):r.error(new sO({error:E,headers:y,status:w,statusText:T,url:I||void 0}))},u=y=>{const{url:w}=l(),T=new sO({error:y,status:i.status||0,statusText:i.statusText||"Unknown Error",url:w||void 0});r.error(T)};let f=!1;const m=y=>{f||(r.next(l()),f=!0);let w={type:Yi.DownloadProgress,loaded:y.loaded};y.lengthComputable&&(w.total=y.total),"text"===e.responseType&&!!i.responseText&&(w.partialText=i.responseText),r.next(w)},_=y=>{let w={type:Yi.UploadProgress,loaded:y.loaded};y.lengthComputable&&(w.total=y.total),r.next(w)};return i.addEventListener("load",c),i.addEventListener("error",u),i.addEventListener("timeout",u),i.addEventListener("abort",u),e.reportProgress&&(i.addEventListener("progress",m),null!==s&&i.upload&&i.upload.addEventListener("progress",_)),i.send(s),r.next({type:Yi.Sent}),()=>{i.removeEventListener("error",u),i.removeEventListener("abort",u),i.removeEventListener("load",c),i.removeEventListener("timeout",u),e.reportProgress&&(i.removeEventListener("progress",m),null!==s&&i.upload&&i.upload.removeEventListener("progress",_)),i.readyState!==i.DONE&&i.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Cd))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const Gd=new a.OlP("XSRF_COOKIE_NAME"),Wd=new a.OlP("XSRF_HEADER_NAME");class Of{}let zm=(()=>{class n{constructor(e,r,i){this.doc=e,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=jT(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt),a.LFG(a.Lbi),a.LFG(Gd))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),jd=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const i=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||i.startsWith("http://")||i.startsWith("https://"))return r.handle(e);const s=this.tokenService.getToken();return null!==s&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,s)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Of),a.LFG(Wd))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),Hm=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(Bm,[]);this.chain=r.reduceRight((i,s)=>new fz(i,s),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(rO),a.LFG(a.zs3))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),aO=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:jd,useClass:pz}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:Gd,useValue:e.cookieName}:[],e.headerName?{provide:Wd,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[jd,{provide:Bm,useExisting:jd,multi:!0},{provide:Of,useClass:zm},{provide:Gd,useValue:"XSRF-TOKEN"},{provide:Wd,useValue:"X-XSRF-TOKEN"}]}),n})(),vE=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[Oc,{provide:Lm,useClass:Hm},Mf,{provide:rO,useExisting:Mf}],imports:[aO.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();var Ki=z(2011),kn=z(727);class lO extends kn.w0{constructor(t,e){super()}schedule(t,e=0){return this}}const yv={setInterval(n,t,...e){const{delegate:r}=yv;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=yv;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};var yz=z(8737);class _C extends lO{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,e),this}requestAsyncId(t,e,r=0){return yv.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&yv.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i,r=!1;try{this.work(t)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,yz.P)(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const yC={now:()=>(yC.delegate||Date).now(),delegate:void 0};class vv{constructor(t,e=vv.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}vv.now=yC.now;class bv extends vv{constructor(t,e=vv.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const Fc=new bv(_C),bE=Fc;var cs=z(6451),Gm=z(3099);function wn(n,t){return(0,ti.e)((e,r)=>{let i=null,s=0,o=!1;const l=()=>o&&!i&&r.complete();e.subscribe((0,zr.x)(r,c=>{i?.unsubscribe();let u=0;const f=s++;(0,Ru.Xf)(n(c,f)).subscribe(i=(0,zr.x)(r,m=>r.next(t?t(c,m,f,u++):m),()=>{i=null,l()}))},()=>{o=!0,l()}))})}function wE(n,t,e,r,i){return(s,o)=>{let l=e,c=t,u=0;s.subscribe((0,zr.x)(o,f=>{const m=u++;c=l?n(c,f,m):(l=!0,f),r&&o.next(c)},i&&(()=>{l&&o.next(c),o.complete()})))}}function Ff(n,t){return(0,ti.e)(wE(n,t,arguments.length>=2,!0))}var Pc=z(4671);function $u(n,t=Pc.y){return n=n??CE,(0,ti.e)((e,r)=>{let i,s=!0;e.subscribe((0,zr.x)(r,o=>{const l=t(o);(s||!n(i,l))&&(s=!1,i=l,r.next(o))}))})}function CE(n,t){return n===t}var vC=z(5032),An=z(6881);(0,An.registerVersion)("firebase","9.23.0","app");var q=z(5861),W=z(2090),us=z(4859),$o=z(1877);let dO,SE;const bC=new WeakMap,wC=new WeakMap,EE=new WeakMap,CC=new WeakMap,xC=new WeakMap;let IC={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return wC.get(n);if("objectStoreNames"===t)return n.objectStoreNames||EE.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return qd(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function vz(n){return"function"==typeof n?function d7(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function fO(){return SE||(SE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(TC(this),t),qd(bC.get(this))}:function(...t){return qd(n.apply(TC(this),t))}:function(t,...e){const r=n.call(TC(this),t,...e);return EE.set(r,t.sort?t.sort():[t]),qd(r)}}(n):(n instanceof IDBTransaction&&function mO(n){if(wC.has(n))return;const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{e(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});wC.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function hO(){return dO||(dO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,IC):n)}function qd(n){if(n instanceof IDBRequest)return function pO(n){const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{e(qd(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&bC.set(e,n)}).catch(()=>{}),xC.set(t,n),t}(n);if(CC.has(n))return CC.get(n);const t=vz(n);return t!==n&&(CC.set(n,t),xC.set(t,n)),t}const TC=n=>xC.get(n),_O=["get","getKey","getAll","getAllKeys","count"],wz=["put","add","delete","clear"],DE=new Map;function kE(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(DE.get(t))return DE.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,i=wz.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!_O.includes(e))return;const s=function(){var o=(0,q.Z)(function*(l,...c){const u=this.transaction(l,i?"readwrite":"readonly");let f=u.store;return r&&(f=f.index(c.shift())),(yield Promise.all([f[e](...c),i&&u.done]))[0]});return function(c){return o.apply(this,arguments)}}();return DE.set(t,s),s}!function gO(n){IC=n(IC)}(n=>({...n,get:(t,e,r)=>kE(t,e)||n.get(t,e,r),has:(t,e)=>!!kE(t,e)||n.has(t,e)}));const yO="@firebase/installations",Pf="w:0.6.4",vO="FIS_v2",nc=new W.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function EC(n){return n instanceof W.ZR&&n.code.includes("request-failed")}function pl({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function CO(n){return{token:n.token,requestStatus:2,expiresIn:Iz(n.expiresIn),creationTime:Date.now()}}function NE(n,t){return ml.apply(this,arguments)}function ml(){return(ml=(0,q.Z)(function*(n,t){const r=(yield t.json()).error;return nc.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})})).apply(this,arguments)}function gl({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function _l(n,{refreshToken:t}){const e=gl(n);return e.append("Authorization",function Tz(n){return`${vO} ${n}`}(t)),e}function DC(n){return kC.apply(this,arguments)}function kC(){return(kC=(0,q.Z)(function*(n){const t=yield n();return t.status>=500&&t.status<600?n():t})).apply(this,arguments)}function Iz(n){return Number(n.replace("s","000"))}function Sz(n,t){return RE.apply(this,arguments)}function RE(){return(RE=(0,q.Z)(function*({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const r=pl(n),i=gl(n),s=t.getImmediate({optional:!0});if(s){const u=yield s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const l={method:"POST",headers:i,body:JSON.stringify({fid:e,authVersion:vO,appId:n.appId,sdkVersion:Pf})},c=yield DC(()=>fetch(r,l));if(c.ok){const u=yield c.json();return{fid:u.fid||e,registrationStatus:2,refreshToken:u.refreshToken,authToken:CO(u.authToken)}}throw yield NE("Create Installation",c)})).apply(this,arguments)}function AC(n){return new Promise(t=>{setTimeout(t,n)})}const Ez=/^[cdef][\w-]{21}$/;function Dz(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=function xO(n){return function wv(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return Ez.test(e)?e:""}catch{return""}}function Lf(n){return`${n.appName}!${n.appId}`}const Bu=new Map;function IO(n,t){const e=Lf(n);RC(e,t),function MC(n,t){const e=function OC(){return!Vu&&"BroadcastChannel"in self&&(Vu=new BroadcastChannel("[Firebase] FID Change"),Vu.onmessage=n=>{RC(n.data.key,n.data.fid)}),Vu}();e&&e.postMessage({key:n,fid:t}),function FC(){0===Bu.size&&Vu&&(Vu.close(),Vu=null)}()}(e,t)}function RC(n,t){const e=Bu.get(n);if(e)for(const r of e)r(t)}let Vu=null;const Zd="firebase-installations-store";let PC=null;function LC(){return PC||(PC=function bz(n,t,{blocked:e,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,t),l=qd(o);return r&&o.addEventListener("upgradeneeded",c=>{r(qd(o.result),c.oldVersion,c.newVersion,qd(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),l}("firebase-installations-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(Zd)}})),PC}function Cv(n,t){return ME.apply(this,arguments)}function ME(){return(ME=(0,q.Z)(function*(n,t){const e=Lf(n),i=(yield LC()).transaction(Zd,"readwrite"),s=i.objectStore(Zd),o=yield s.get(e);return yield s.put(t,e),yield i.done,(!o||o.fid!==t.fid)&&IO(n,t.fid),t})).apply(this,arguments)}function OE(n){return FE.apply(this,arguments)}function FE(){return(FE=(0,q.Z)(function*(n){const t=Lf(n),r=(yield LC()).transaction(Zd,"readwrite");yield r.objectStore(Zd).delete(t),yield r.done})).apply(this,arguments)}function xv(n,t){return PE.apply(this,arguments)}function PE(){return(PE=(0,q.Z)(function*(n,t){const e=Lf(n),i=(yield LC()).transaction(Zd,"readwrite"),s=i.objectStore(Zd),o=yield s.get(e),l=t(o);return void 0===l?yield s.delete(e):yield s.put(l,e),yield i.done,l&&(!o||o.fid!==l.fid)&&IO(n,l.fid),l})).apply(this,arguments)}function LE(n){return $E.apply(this,arguments)}function $E(){return($E=(0,q.Z)(function*(n){let t;const e=yield xv(n.appConfig,r=>{const i=kz(r),s=Az(n,i);return t=s.registrationPromise,s.installationEntry});return""===e.fid?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}})).apply(this,arguments)}function kz(n){return AO(n||{fid:Dz(),registrationStatus:0})}function Az(n,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(nc.create("app-offline"))};const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function Nz(n,t){return BE.apply(this,arguments)}(n,e);return{installationEntry:e,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Rz(n)}:{installationEntry:t}}function BE(){return(BE=(0,q.Z)(function*(n,t){try{const e=yield Sz(n,t);return Cv(n.appConfig,e)}catch(e){throw EC(e)&&409===e.customData.serverCode?yield OE(n.appConfig):yield Cv(n.appConfig,{fid:t.fid,registrationStatus:0}),e}})).apply(this,arguments)}function Rz(n){return VE.apply(this,arguments)}function VE(){return(VE=(0,q.Z)(function*(n){let t=yield kO(n.appConfig);for(;1===t.registrationStatus;)yield AC(100),t=yield kO(n.appConfig);if(0===t.registrationStatus){const{installationEntry:e,registrationPromise:r}=yield LE(n);return r||e}return t})).apply(this,arguments)}function kO(n){return xv(n,t=>{if(!t)throw nc.create("installation-not-found");return AO(t)})}function AO(n){return function Mz(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function Oz(n,t){return $C.apply(this,arguments)}function $C(){return($C=(0,q.Z)(function*({appConfig:n,heartbeatServiceProvider:t},e){const r=NO(n,e),i=_l(n,e),s=t.getImmediate({optional:!0});if(s){const u=yield s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const l={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:Pf,appId:n.appId}})},c=yield DC(()=>fetch(r,l));if(c.ok)return CO(yield c.json());throw yield NE("Generate Auth Token",c)})).apply(this,arguments)}function NO(n,{fid:t}){return`${pl(n)}/${t}/authTokens:generate`}function BC(n){return VC.apply(this,arguments)}function VC(){return(VC=(0,q.Z)(function*(n,t=!1){let e;const r=yield xv(n.appConfig,s=>{if(!HC(s))throw nc.create("not-registered");const o=s.authToken;if(!t&&zE(o))return s;if(1===o.requestStatus)return e=RO(n,t),s;{if(!navigator.onLine)throw nc.create("app-offline");const l=Fz(s);return e=MO(n,l),l}});return e?yield e:r.authToken})).apply(this,arguments)}function RO(n,t){return UC.apply(this,arguments)}function UC(){return(UC=(0,q.Z)(function*(n,t){let e=yield UE(n.appConfig);for(;1===e.authToken.requestStatus;)yield AC(100),e=yield UE(n.appConfig);const r=e.authToken;return 0===r.requestStatus?BC(n,t):r})).apply(this,arguments)}function UE(n){return xv(n,t=>{if(!HC(t))throw nc.create("not-registered");return function Pz(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function MO(n,t){return zC.apply(this,arguments)}function zC(){return(zC=(0,q.Z)(function*(n,t){try{const e=yield Oz(n,t),r=Object.assign(Object.assign({},t),{authToken:e});return yield Cv(n.appConfig,r),e}catch(e){if(!EC(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode){const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield Cv(n.appConfig,r)}else yield OE(n.appConfig);throw e}})).apply(this,arguments)}function HC(n){return void 0!==n&&2===n.registrationStatus}function zE(n){return 2===n.requestStatus&&!function $f(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+36e5}(n)}function Fz(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function OO(){return(OO=(0,q.Z)(function*(n){const t=n,{installationEntry:e,registrationPromise:r}=yield LE(t);return r?r.catch(console.error):BC(t).catch(console.error),e.fid})).apply(this,arguments)}function FO(){return(FO=(0,q.Z)(function*(n,t=!1){const e=n;return yield PO(e),(yield BC(e,t)).token})).apply(this,arguments)}function PO(n){return GC.apply(this,arguments)}function GC(){return(GC=(0,q.Z)(function*(n){const{registrationPromise:t}=yield LE(n);t&&(yield t)})).apply(this,arguments)}function jm(n){return nc.create("missing-app-config-values",{valueName:n})}const bi="installations",LO=n=>{const t=n.getProvider("app").getImmediate(),e=function WC(n){if(!n||!n.options)throw jm("App Configuration");if(!n.name)throw jm("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw jm(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(t);return{app:t,appConfig:e,heartbeatServiceProvider:(0,An._getProvider)(t,"heartbeat"),_delete:()=>Promise.resolve()}},$O=n=>{const t=n.getProvider("app").getImmediate(),e=(0,An._getProvider)(t,bi).getImmediate();return{getId:()=>function Wm(n){return OO.apply(this,arguments)}(e),getToken:i=>function HE(n){return FO.apply(this,arguments)}(e,i)}};(function $z(){(0,An._registerComponent)(new us.wA(bi,LO,"PUBLIC")),(0,An._registerComponent)(new us.wA("installations-internal",$O,"PRIVATE"))})(),(0,An.registerVersion)(yO,"0.6.4"),(0,An.registerVersion)(yO,"0.6.4","esm2017");const jC="@firebase/remote-config",ca=new W.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class zO{constructor(t,e,r,i){this.client=t,this.storage=e,this.storageCache=r,this.logger=i}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-e,i=r<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${i}.`),i}fetch(t){var e=this;return(0,q.Z)(function*(){const[r,i]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(i&&e.isCachedDataFresh(t.cacheMaxAgeMillis,r))return i;t.eTag=i&&i.eTag;const s=yield e.client.fetch(t),o=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===s.status&&o.push(e.storage.setLastSuccessfulFetchResponse(s)),yield Promise.all(o),s})()}}function Zz(n=navigator){return n.languages&&n.languages[0]||n.language}class Yz{constructor(t,e,r,i,s,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=r,this.projectId=i,this.apiKey=s,this.appId=o}fetch(t){var e=this;return(0,q.Z)(function*(){const[r,i]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},c={sdk_version:e.sdkVersion,app_instance_id:r,app_instance_id_token:i,app_id:e.appId,language_code:Zz()},u={method:"POST",headers:l,body:JSON.stringify(c)},f=fetch(o,u),m=new Promise((E,A)=>{t.signal.addEventListener(()=>{const M=new Error("The operation was aborted.");M.name="AbortError",A(M)})});let _;try{yield Promise.race([f,m]),_=yield f}catch(E){let A="fetch-client-network";throw"AbortError"===E?.name&&(A="fetch-timeout"),ca.create(A,{originalErrorMessage:E?.message})}let y=_.status;const w=_.headers.get("ETag")||void 0;let T,I;if(200===_.status){let E;try{E=yield _.json()}catch(A){throw ca.create("fetch-client-parse",{originalErrorMessage:A?.message})}T=E.entries,I=E.state}if("INSTANCE_STATE_UNSPECIFIED"===I?y=500:"NO_CHANGE"===I?y=304:("NO_TEMPLATE"===I||"EMPTY_CONFIG"===I)&&(T={}),304!==y&&200!==y)throw ca.create("fetch-status",{httpStatus:y});return{status:y,eTag:w,config:T}})()}}class C7{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return(0,q.Z)(function*(){const r=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,r)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:r}){var i=this;return(0,q.Z)(function*(){yield function b7(n,t){return new Promise((e,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(e,i);n.addEventListener(()=>{clearTimeout(s),r(ca.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(t.signal,e);try{const s=yield i.client.fetch(t);return yield i.storage.deleteThrottleMetadata(),s}catch(s){if(!function w7(n){if(!(n instanceof W.ZR&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}(s))throw s;const o={throttleEndTimeMillis:Date.now()+(0,W.$s)(r),backoffCount:r+1};return yield i.storage.setThrottleMetadata(o),i.attemptFetch(t,o)}})()}}class ZC{constructor(t,e,r,i,s){this.app=t,this._client=e,this._storageCache=r,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function YC(n,t){const e=n.target.error||void 0;return ca.create(t,{originalErrorMessage:e&&e?.message})}const Vf="app_namespace_store";class Qz{constructor(t,e,r,i=function Kz(){return new Promise((n,t)=>{try{const e=indexedDB.open("firebase_remote_config",1);e.onerror=r=>{t(YC(r,"storage-open"))},e.onsuccess=r=>{n(r.target.result)},e.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(Vf,{keyPath:"compositeKey"})}}catch(e){t(ca.create("storage-open",{originalErrorMessage:e?.message}))}})}()){this.appId=t,this.appName=e,this.namespace=r,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return(0,q.Z)(function*(){const r=yield e.openDbPromise;return new Promise((i,s)=>{const l=r.transaction([Vf],"readonly").objectStore(Vf),c=e.createCompositeKey(t);try{const u=l.get(c);u.onerror=f=>{s(YC(f,"storage-get"))},u.onsuccess=f=>{const m=f.target.result;i(m?m.value:void 0)}}catch(u){s(ca.create("storage-get",{originalErrorMessage:u?.message}))}})})()}set(t,e){var r=this;return(0,q.Z)(function*(){const i=yield r.openDbPromise;return new Promise((s,o)=>{const c=i.transaction([Vf],"readwrite").objectStore(Vf),u=r.createCompositeKey(t);try{const f=c.put({compositeKey:u,value:e});f.onerror=m=>{o(YC(m,"storage-set"))},f.onsuccess=()=>{s()}}catch(f){o(ca.create("storage-set",{originalErrorMessage:f?.message}))}})})()}delete(t){var e=this;return(0,q.Z)(function*(){const r=yield e.openDbPromise;return new Promise((i,s)=>{const l=r.transaction([Vf],"readwrite").objectStore(Vf),c=e.createCompositeKey(t);try{const u=l.delete(c);u.onerror=f=>{s(YC(f,"storage-delete"))},u.onsuccess=()=>{i()}}catch(u){s(ca.create("storage-delete",{originalErrorMessage:u?.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class Xz{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return(0,q.Z)(function*(){const e=t.storage.getLastFetchStatus(),r=t.storage.getLastSuccessfulFetchTimestampMillis(),i=t.storage.getActiveConfig(),s=yield e;s&&(t.lastFetchStatus=s);const o=yield r;o&&(t.lastSuccessfulFetchTimestampMillis=o);const l=yield i;l&&(t.activeConfig=l)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function e4(){return qE.apply(this,arguments)}function qE(){return(qE=(0,q.Z)(function*(){if(!(0,W.hl)())return!1;try{return yield(0,W.eu)()}catch{return!1}})).apply(this,arguments)}let WO,ZE;!function Jz(){(0,An._registerComponent)(new us.wA("remote-config",function n(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),i=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw ca.create("registration-window");if(!(0,W.hl)())throw ca.create("indexed-db-unavailable");const{projectId:s,apiKey:o,appId:l}=r.options;if(!s)throw ca.create("registration-project-id");if(!o)throw ca.create("registration-api-key");if(!l)throw ca.create("registration-app-id");const c=new Qz(l,r.name,e=e||"firebase"),u=new Xz(c),f=new $o.Yd(jC);f.logLevel=$o.in.ERROR;const m=new Yz(i,An.SDK_VERSION,e,s,o,l),_=new C7(m,c),y=new zO(_,c,u,f),w=new ZC(r,y,u,c,f);return function Gz(n){const t=(0,W.m9)(n);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(w),w},"PUBLIC").setMultipleInstances(!0)),(0,An.registerVersion)(jC,"0.4.4"),(0,An.registerVersion)(jC,"0.4.4","esm2017")}();const qO=new WeakMap,QC=new WeakMap,ZO=new WeakMap,Av=new WeakMap,YE=new WeakMap;let KE={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return QC.get(n);if("objectStoreNames"===t)return n.objectStoreNames||ZO.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Uu(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function QE(n){return"function"==typeof n?function r4(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function jO(){return ZE||(ZE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(XC(this),t),Uu(qO.get(this))}:function(...t){return Uu(n.apply(XC(this),t))}:function(t,...e){const r=n.call(XC(this),t,...e);return ZO.set(r,t.sort?t.sort():[t]),Uu(r)}}(n):(n instanceof IDBTransaction&&function KO(n){if(QC.has(n))return;const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{e(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});QC.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function t4(){return WO||(WO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,KE):n)}function Uu(n){if(n instanceof IDBRequest)return function YO(n){const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{e(Uu(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&qO.set(e,n)}).catch(()=>{}),YE.set(t,n),t}(n);if(Av.has(n))return Av.get(n);const t=QE(n);return t!==n&&(Av.set(n,t),YE.set(t,n)),t}const XC=n=>YE.get(n);function QO(n,t,{blocked:e,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,t),l=Uu(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Uu(o.result),c.oldVersion,c.newVersion,Uu(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),l}function XE(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",()=>t()),Uu(e).then(()=>{})}const s4=["get","getKey","getAll","getAllKeys","count"],o4=["put","add","delete","clear"],JE=new Map;function XO(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(JE.get(t))return JE.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,i=o4.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!s4.includes(e))return;const s=function(){var o=(0,q.Z)(function*(l,...c){const u=this.transaction(l,i?"readwrite":"readonly");let f=u.store;return r&&(f=f.index(c.shift())),(yield Promise.all([f[e](...c),i&&u.done]))[0]});return function(c){return o.apply(this,arguments)}}();return JE.set(t,s),s}!function n4(n){KE=n(KE)}(n=>({...n,get:(t,e,r)=>XO(t,e)||n.get(t,e,r),has:(t,e)=>!!XO(t,e)||n.has(t,e)}));const a4="/firebase-messaging-sw.js",l4="/firebase-cloud-messaging-push-scope",eD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",eF="google.c.a.c_id",c4="google.c.a.c_l",tF="google.c.a.ts",u4="google.c.a.e";var Zm=(()=>{return(n=Zm||(Zm={})).PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",Zm;var n})();function rc(n){const t=new Uint8Array(n);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function tD(n){const e=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}const JC="fcm_token_details_db",nF="fcm_token_object_Store";function d4(n){return Nv.apply(this,arguments)}function Nv(){return Nv=(0,q.Z)(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(JC))return null;let t=null;return(yield QO(JC,5,{upgrade:(r=(0,q.Z)(function*(i,s,o,l){var c;if(s<2||!i.objectStoreNames.contains(nF))return;const u=l.objectStore(nF),f=yield u.index("fcmSenderId").get(n);if(yield u.clear(),f)if(2===s){const m=f;if(!m.auth||!m.p256dh||!m.endpoint)return;t={token:m.fcmToken,createTime:null!==(c=m.createTime)&&void 0!==c?c:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:rc(m.vapidKey)}}}else if(3===s){const m=f;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:rc(m.auth),p256dh:rc(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:rc(m.vapidKey)}}}else if(4===s){const m=f;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:rc(m.auth),p256dh:rc(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:rc(m.vapidKey)}}}}),function(s,o,l,c){return r.apply(this,arguments)})})).close(),yield XE(JC),yield XE("fcm_vapid_details_db"),yield XE("undefined"),h4(t)?t:null;var r}),Nv.apply(this,arguments)}function h4(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:t}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const Yd="firebase-messaging-store";let rD=null;function iF(){return rD||(rD=QO("firebase-messaging-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(Yd)}})),rD}function iD(n){return Rv.apply(this,arguments)}function Rv(){return(Rv=(0,q.Z)(function*(n){const t=Ov(n),r=yield(yield iF()).transaction(Yd).objectStore(Yd).get(t);if(r)return r;{const i=yield d4(n.appConfig.senderId);if(i)return yield sD(n,i),i}})).apply(this,arguments)}function sD(n,t){return Mv.apply(this,arguments)}function Mv(){return(Mv=(0,q.Z)(function*(n,t){const e=Ov(n),i=(yield iF()).transaction(Yd,"readwrite");return yield i.objectStore(Yd).put(t,e),yield i.done,t})).apply(this,arguments)}function f4(n){return ex.apply(this,arguments)}function ex(){return(ex=(0,q.Z)(function*(n){const t=Ov(n),r=(yield iF()).transaction(Yd,"readwrite");yield r.objectStore(Yd).delete(t),yield r.done})).apply(this,arguments)}function Ov({appConfig:n}){return n.appId}const Is=new W.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function oF(n,t){return tx.apply(this,arguments)}function tx(){return(tx=(0,q.Z)(function*(n,t){const e=yield lF(n),r=cF(t),i={method:"POST",headers:e,body:JSON.stringify(r)};let s;try{s=yield(yield fetch(nx(n.appConfig),i)).json()}catch(o){throw Is.create("token-subscribe-failed",{errorInfo:o?.toString()})}if(s.error)throw Is.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw Is.create("token-subscribe-no-token");return s.token})).apply(this,arguments)}function p4(n,t){return oD.apply(this,arguments)}function oD(){return(oD=(0,q.Z)(function*(n,t){const e=yield lF(n),r=cF(t.subscriptionOptions),i={method:"PATCH",headers:e,body:JSON.stringify(r)};let s;try{s=yield(yield fetch(`${nx(n.appConfig)}/${t.token}`,i)).json()}catch(o){throw Is.create("token-update-failed",{errorInfo:o?.toString()})}if(s.error)throw Is.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw Is.create("token-update-no-token");return s.token})).apply(this,arguments)}function aF(n,t){return aD.apply(this,arguments)}function aD(){return(aD=(0,q.Z)(function*(n,t){const r={method:"DELETE",headers:yield lF(n)};try{const s=yield(yield fetch(`${nx(n.appConfig)}/${t}`,r)).json();if(s.error)throw Is.create("token-unsubscribe-failed",{errorInfo:s.error.message})}catch(i){throw Is.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}})).apply(this,arguments)}function nx({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function lF(n){return rx.apply(this,arguments)}function rx(){return(rx=(0,q.Z)(function*({appConfig:n,installations:t}){const e=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${e}`})})).apply(this,arguments)}function cF({p256dh:n,auth:t,endpoint:e,vapidKey:r}){const i={web:{endpoint:e,auth:t,p256dh:n}};return r!==eD&&(i.web.applicationPubKey=r),i}const m4=6048e5;function S7(n){return uF.apply(this,arguments)}function uF(){return(uF=(0,q.Z)(function*(n){const t=yield g4(n.swRegistration,n.vapidKey),e={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:t.endpoint,auth:rc(t.getKey("auth")),p256dh:rc(t.getKey("p256dh"))},r=yield iD(n.firebaseDependencies);if(r){if(_4(r.subscriptionOptions,e))return Date.now()>=r.createTime+m4?hF(n,{token:r.token,createTime:Date.now(),subscriptionOptions:e}):r.token;try{yield aF(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return cD(n.firebaseDependencies,e)}return cD(n.firebaseDependencies,e)})).apply(this,arguments)}function dF(n){return lD.apply(this,arguments)}function lD(){return(lD=(0,q.Z)(function*(n){const t=yield iD(n.firebaseDependencies);t&&(yield aF(n.firebaseDependencies,t.token),yield f4(n.firebaseDependencies));const e=yield n.swRegistration.pushManager.getSubscription();return!e||e.unsubscribe()})).apply(this,arguments)}function hF(n,t){return ix.apply(this,arguments)}function ix(){return(ix=(0,q.Z)(function*(n,t){try{const e=yield p4(n.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:e,createTime:Date.now()});return yield sD(n.firebaseDependencies,r),e}catch(e){throw yield dF(n),e}})).apply(this,arguments)}function cD(n,t){return uD.apply(this,arguments)}function uD(){return(uD=(0,q.Z)(function*(n,t){const r={token:yield oF(n,t),createTime:Date.now(),subscriptionOptions:t};return yield sD(n,r),r.token})).apply(this,arguments)}function g4(n,t){return dD.apply(this,arguments)}function dD(){return(dD=(0,q.Z)(function*(n,t){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:tD(t)})})).apply(this,arguments)}function _4(n,t){return t.vapidKey===n.vapidKey&&t.endpoint===n.endpoint&&t.auth===n.auth&&t.p256dh===n.p256dh}function fF(n){const t={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function y4(n,t){if(!t.notification)return;n.notification={};const e=t.notification.title;e&&(n.notification.title=e);const r=t.notification.body;r&&(n.notification.body=r);const i=t.notification.image;i&&(n.notification.image=i);const s=t.notification.icon;s&&(n.notification.icon=s)}(t,n),function v4(n,t){!t.data||(n.data=t.data)}(t,n),function Fv(n,t){var e,r,i,s,o;if(!(t.fcmOptions||null!==(e=t.notification)&&void 0!==e&&e.click_action))return;n.fcmOptions={};const l=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;l&&(n.fcmOptions.link=l);const c=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(n.fcmOptions.analyticsLabel=c)}(t,n),t}function pF(n){return"object"==typeof n&&!!n&&eF in n}function hD(n,t){const e=[];for(let r=0;r<n.length;r++)e.push(n.charAt(r)),r<t.length&&e.push(t.charAt(r));return e.join("")}function sx(n){return Is.create("missing-app-config-values",{valueName:n})}hD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),hD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class gF{constructor(t,e,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function mF(n){if(!n||!n.options)throw sx("App Configuration Object");if(!n.name)throw sx("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:e}=n;for(const r of t)if(!e[r])throw sx(r);return{appName:n.name,projectId:e.projectId,apiKey:e.apiKey,appId:e.appId,senderId:e.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:e,analyticsProvider:r}}_delete(){return Promise.resolve()}}function fD(n){return pD.apply(this,arguments)}function pD(){return(pD=(0,q.Z)(function*(n){try{n.swRegistration=yield navigator.serviceWorker.register(a4,{scope:l4}),n.swRegistration.update().catch(()=>{})}catch(t){throw Is.create("failed-service-worker-registration",{browserErrorMessage:t?.message})}})).apply(this,arguments)}function E7(n,t){return ox.apply(this,arguments)}function ox(){return(ox=(0,q.Z)(function*(n,t){if(!t&&!n.swRegistration&&(yield fD(n)),t||!n.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw Is.create("invalid-sw-registration");n.swRegistration=t}})).apply(this,arguments)}function _F(n,t){return mD.apply(this,arguments)}function mD(){return(mD=(0,q.Z)(function*(n,t){t?n.vapidKey=t:n.vapidKey||(n.vapidKey=eD)})).apply(this,arguments)}function gD(){return(gD=(0,q.Z)(function*(n,t){if(!navigator)throw Is.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Is.create("permission-blocked");return yield _F(n,t?.vapidKey),yield E7(n,t?.serviceWorkerRegistration),S7(n)})).apply(this,arguments)}function Pv(n,t,e){return _D.apply(this,arguments)}function _D(){return(_D=(0,q.Z)(function*(n,t,e){const r=yD(t);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:e[eF],message_name:e[c4],message_time:e[tF],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function yD(n){switch(n){case Zm.NOTIFICATION_CLICKED:return"notification_open";case Zm.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function vD(){return(vD=(0,q.Z)(function*(n,t){const e=t.data;if(!e.isFirebaseMessaging)return;n.onMessageHandler&&e.messageType===Zm.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(fF(e)):n.onMessageHandler.next(fF(e)));const r=e.data;pF(r)&&"1"===r[u4]&&(yield Pv(n,e.messageType,r))})).apply(this,arguments)}const Lv="@firebase/messaging",b4=n=>{const t=new gF(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function Lc(n,t){return vD.apply(this,arguments)}(t,e)),t},w4=n=>{const t=n.getProvider("messaging").getImmediate();return{getToken:r=>function yF(n,t){return gD.apply(this,arguments)}(t,r)}};function $v(){return Qm.apply(this,arguments)}function Qm(){return(Qm=(0,q.Z)(function*(){try{yield(0,W.eu)()}catch{return!1}return typeof window<"u"&&(0,W.hl)()&&(0,W.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function C4(){(0,An._registerComponent)(new us.wA("messaging",b4,"PUBLIC")),(0,An._registerComponent)(new us.wA("messaging-internal",w4,"PRIVATE")),(0,An.registerVersion)(Lv,"0.12.4"),(0,An.registerVersion)(Lv,"0.12.4","esm2017")}();const wD="analytics",CD="firebase_id",ID="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Bv="https://www.googletagmanager.com/gtag/js",Ts=new $o.Yd("@firebase/analytics"),Bo=new W.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function S4(n){if(!n.startsWith(Bv)){const t=Bo.create("invalid-gtag-resource",{gtagURL:n});return Ts.warn(t.message),""}return n}function TD(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function CF(n,t){const e=function SD(n,t){let e;return window.trustedTypes&&(e=window.trustedTypes.createPolicy(n,t)),e}("firebase-js-sdk-policy",{createScriptURL:S4}),r=document.createElement("script"),i=`${Bv}?l=${n}&id=${t}`;r.src=e?e?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function IF(n,t,e,r,i,s){return lx.apply(this,arguments)}function lx(){return(lx=(0,q.Z)(function*(n,t,e,r,i,s){const o=r[i];try{if(o)yield t[o];else{const c=(yield TD(e)).find(u=>u.measurementId===i);c&&(yield t[c.appId])}}catch(l){Ts.error(l)}n("config",i,s)})).apply(this,arguments)}function E4(n,t,e,r,i){return cx.apply(this,arguments)}function cx(){return(cx=(0,q.Z)(function*(n,t,e,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const l=yield TD(e);for(const c of o){const u=l.find(m=>m.measurementId===c),f=u&&t[u.appId];if(!f){s=[];break}s.push(f)}}0===s.length&&(s=Object.values(t)),yield Promise.all(s),n("event",r,i||{})}catch(s){Ts.error(s)}})).apply(this,arguments)}function SF(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(Bv)&&e.src.includes(n))return e;return null}const DF=new class Xm{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function k4(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function A7(n){return kF.apply(this,arguments)}function kF(){return(kF=(0,q.Z)(function*(n){var t;const{appId:e,apiKey:r}=n,i={method:"GET",headers:k4(r)},s=ID.replace("{app-id}",e),o=yield fetch(s,i);if(200!==o.status&&304!==o.status){let l="";try{const c=yield o.json();null!==(t=c.error)&&void 0!==t&&t.message&&(l=c.error.message)}catch{}throw Bo.create("config-fetch-failed",{httpStatus:o.status,responseMessage:l})}return o.json()})).apply(this,arguments)}function AF(n){return ux.apply(this,arguments)}function ux(){return(ux=(0,q.Z)(function*(n,t=DF,e){const{appId:r,apiKey:i,measurementId:s}=n.options;if(!r)throw Bo.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Bo.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new NF;return setTimeout((0,q.Z)(function*(){l.abort()}),void 0!==e?e:6e4),Jm({appId:r,apiKey:i,measurementId:s},o,l,t)})).apply(this,arguments)}function Jm(n,t,e){return ED.apply(this,arguments)}function ED(){return(ED=(0,q.Z)(function*(n,{throttleEndTimeMillis:t,backoffCount:e},r,i=DF){var s;const{appId:o,measurementId:l}=n;try{yield DD(r,t)}catch(c){if(l)return Ts.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:o,measurementId:l};throw c}try{const c=yield A7(n);return i.deleteThrottleMetadata(o),c}catch(c){const u=c;if(!A4(u)){if(i.deleteThrottleMetadata(o),l)return Ts.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u?.message}]`),{appId:o,measurementId:l};throw c}const f=503===Number(null===(s=u?.customData)||void 0===s?void 0:s.httpStatus)?(0,W.$s)(e,i.intervalMillis,30):(0,W.$s)(e,i.intervalMillis),m={throttleEndTimeMillis:Date.now()+f,backoffCount:e+1};return i.setThrottleMetadata(o,m),Ts.debug(`Calling attemptFetch again in ${f} millis`),Jm(n,m,r,i)}})).apply(this,arguments)}function DD(n,t){return new Promise((e,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(e,i);n.addEventListener(()=>{clearTimeout(s),r(Bo.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function A4(n){if(!(n instanceof W.ZR&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}class NF{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let kD,OD;function AD(){return(AD=(0,q.Z)(function*(n,t,e,r,i){if(i&&i.global)n("event",e,r);else{const s=yield t;n("event",e,Object.assign(Object.assign({},r),{send_to:s}))}})).apply(this,arguments)}function FD(n){OD=n}function hx(n){kD=n}function N7(){return PD.apply(this,arguments)}function PD(){return(PD=(0,q.Z)(function*(){if(!(0,W.hl)())return Ts.warn(Bo.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,W.eu)()}catch(n){return Ts.warn(Bo.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}return!0})).apply(this,arguments)}function LD(){return(LD=(0,q.Z)(function*(n,t,e,r,i,s,o){var l;const c=AF(n);c.then(y=>{e[y.measurementId]=y.appId,n.options.measurementId&&y.measurementId!==n.options.measurementId&&Ts.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${y.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(y=>Ts.error(y)),t.push(c);const u=N7().then(y=>{if(y)return r.getId()}),[f,m]=yield Promise.all([c,u]);SF(s)||CF(s,f.measurementId),OD&&(i("consent","default",OD),FD(void 0)),i("js",new Date);const _=null!==(l=o?.config)&&void 0!==l?l:{};return _.origin="firebase",_.update=!0,null!=m&&(_[CD]=m),i("config",f.measurementId,_),kD&&(i("set",kD),hx(void 0)),f.measurementId})).apply(this,arguments)}class R4{constructor(t){this.app=t}_delete(){return delete $c[this.app.options.appId],Promise.resolve()}}let $c={},$D=[];const BD={};let UD,Bc,fx="dataLayer",zD=!1;function PF(n,t,e){!function O4(){const n=[];if((0,W.ru)()&&n.push("This is a browser extension environment."),(0,W.zI)()||n.push("Cookies are not available."),n.length>0){const t=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),e=Bo.create("invalid-analytics-context",{errorInfo:t});Ts.warn(e.message)}}();const r=n.options.appId;if(!r)throw Bo.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw Bo.create("no-api-key");Ts.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=$c[r])throw Bo.create("already-exists",{id:r});if(!zD){!function xF(n){let t=[];Array.isArray(window[n])?t=window[n]:window[n]=t}(fx);const{wrappedGtag:s,gtagCore:o}=function D4(n,t,e,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=function TF(n,t,e,r){function s(){return(s=(0,q.Z)(function*(o,...l){try{if("event"===o){const[c,u]=l;yield E4(n,t,e,c,u)}else if("config"===o){const[c,u]=l;yield IF(n,t,e,r,c,u)}else if("consent"===o){const[c]=l;n("consent","update",c)}else if("get"===o){const[c,u,f]=l;n("get",c,u,f)}else if("set"===o){const[c]=l;n("set",c)}else n(o,...l)}catch(c){Ts.error(c)}})).apply(this,arguments)}return function i(o){return s.apply(this,arguments)}}(s,n,t,e),{gtagCore:s,wrappedGtag:window[i]}}($c,$D,BD,fx,"gtag");Bc=s,UD=o,zD=!0}return $c[r]=function R7(n,t,e,r,i,s,o){return LD.apply(this,arguments)}(n,$D,BD,t,UD,fx,e),new R4(n)}function $F(){return HD.apply(this,arguments)}function HD(){return(HD=(0,q.Z)(function*(){if((0,W.ru)()||!(0,W.zI)()||!(0,W.hl)())return!1;try{return yield(0,W.eu)()}catch{return!1}})).apply(this,arguments)}const P4="@firebase/analytics";!function mx(){(0,An._registerComponent)(new us.wA(wD,(t,{options:e})=>PF(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),(0,An._registerComponent)(new us.wA("analytics-internal",function n(t){try{const e=t.getProvider(wD).getImmediate();return{logEvent:(r,i,s)=>function O7(n,t,e,r){n=(0,W.m9)(n),function N4(n,t,e,r,i){return AD.apply(this,arguments)}(Bc,$c[n.app.options.appId],t,e,r).catch(i=>Ts.error(i))}(e,r,i,s)}}catch(e){throw Bo.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),(0,An.registerVersion)(P4,"0.10.0"),(0,An.registerVersion)(P4,"0.10.0","esm2017")}();const gx=new class BF extends bv{}(class F7 extends _C{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(t,e,r):(t.flush(this),0)}});function Qr(n,t,e){const r=(0,Po.m)(n)||t||e?{next:n,error:t,complete:e}:n;return r?(0,ti.e)((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let l=!0;i.subscribe((0,zr.x)(s,c=>{var u;null===(u=r.next)||void 0===u||u.call(r,c),s.next(c)},()=>{var c;l=!1,null===(c=r.complete)||void 0===c||c.call(r),s.complete()},c=>{var u;l=!1,null===(u=r.error)||void 0===u||u.call(r,c),s.error(c)},()=>{var c,u;l&&(null===(c=r.unsubscribe)||void 0===c||c.call(r)),null===(u=r.finalize)||void 0===u||u.call(r)}))}):Pc.y}var tg=z(5363),Uf=z(9468);const zf=new a.GfV("7.6.1"),GD="__angularfire_symbol__analyticsIsSupportedValue",_x="__angularfire_symbol__analyticsIsSupported",VF="__angularfire_symbol__remoteConfigIsSupportedValue",WD="__angularfire_symbol__remoteConfigIsSupported",jD="__angularfire_symbol__messagingIsSupportedValue",qD="__angularfire_symbol__messagingIsSupported";function rg(){}globalThis[_x]||(globalThis[_x]=$F().then(n=>globalThis[GD]=n).catch(()=>globalThis[GD]=!1)),globalThis[qD]||(globalThis[qD]=$v().then(n=>globalThis[jD]=n).catch(()=>globalThis[jD]=!1)),globalThis[WD]||(globalThis[WD]=e4().then(n=>globalThis[VF]=n).catch(()=>globalThis[VF]=!1));class UF{constructor(t,e=gx){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{t.apply(this,[o])})},e,r)}}class $7{constructor(t){this.zone=t,this.task=null}call(t,e){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",rg,{},rg,rg)),e.pipe(Qr({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let ig=(()=>{class n{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new UF(Zone.current)),this.insideAngular=e.run(()=>new UF(Zone.current,Fc)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.R0b))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Qd(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function zF(n){return Qd().ngZone.runOutsideAngular(()=>n())}function sg(n){return Qd().ngZone.run(()=>n())}function yl(n){return n.pipe((0,tg.Q)(Qd().outsideAngular))}function wi(n){return Qd(),function V4(n){return function(e){return(e=e.lift(new $7(n.ngZone))).pipe((0,Uf.R)(n.outsideAngular),(0,tg.Q)(n.insideAngular))}}(Qd())(n)}const vl=(n,t)=>function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),sg(()=>n.apply(void 0,r))},HF=(n,t)=>function(){let e;const r=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof r[s]&&(t&&(e||(e=sg(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",rg,{},rg,rg)))),r[s]=vl(r[s],e));const i=zF(()=>n.apply(this,r));if(!t){if(i instanceof Cr.y){const s=Qd();return i.pipe((0,Uf.R)(s.outsideAngular),(0,tg.Q)(s.insideAngular))}return sg(()=>i)}return i instanceof Cr.y?i.pipe(wi):i instanceof Promise?sg(()=>new Promise((s,o)=>i.then(l=>sg(()=>s(l)),l=>sg(()=>o(l))))):"function"==typeof i&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),i.apply(this,arguments)}:sg(()=>i)};z(2644);var ZD=z(3942);const WF="@firebase/database";let vx="";function YD(n){vx=n}class U4{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,W.Wl)(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,W.cI)(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class jF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return(0,W.r3)(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const KD=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const t=window[n];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new U4(t)}}catch{}return new jF},Hf=KD("localStorage"),bx=KD("sessionStorage"),og=new $o.Yd("@firebase/database"),wx=function(){let n=1;return function(){return n++}}(),zu=function(n){const t=(0,W.dS)(n),e=new W.gQ;e.update(t);const r=e.digest();return W.US.encodeByteArray(r)},ag=function(...n){let t="";for(let e=0;e<n.length;e++){const r=n[e];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=ag.apply(null,r):t+="object"==typeof r?(0,W.Wl)(r):r,t+=" "}return t};let Hu=null,Vc=!0;const qF=function(n,t){(0,W.hu)(!t||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(og.logLevel=$o.in.VERBOSE,Hu=og.log.bind(og),t&&bx.set("logging_enabled",!0)):"function"==typeof n?Hu=n:(Hu=null,bx.remove("logging_enabled"))},zs=function(...n){if(!0===Vc&&(Vc=!1,null===Hu&&!0===bx.get("logging_enabled")&&qF(!0)),Hu){const t=ag.apply(null,n);Hu(t)}},Vv=function(n){return function(...t){zs(n,...t)}},QD=function(...n){const t="FIREBASE INTERNAL ERROR: "+ag(...n);og.error(t)},Uc=function(...n){const t=`FIREBASE FATAL ERROR: ${ag(...n)}`;throw og.error(t),new Error(t)},ho=function(...n){const t="FIREBASE WARNING: "+ag(...n);og.warn(t)},XD=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Xd="[MIN_NAME]",zc="[MAX_NAME]",lg=function(n,t){if(n===t)return 0;if(n===Xd||t===zc)return-1;if(t===Xd||n===zc)return 1;{const e=JF(n),r=JF(t);return null!==e?null!==r?e-r==0?n.length-t.length:e-r:-1:null!==r?1:n<t?-1:1}},JD=function(n,t){return n===t?0:n<t?-1:1},cg=function(n,t){if(t&&n in t)return t[n];throw new Error("Missing required key ("+n+") in object: "+(0,W.Wl)(t))},Cx=function(n){if("object"!=typeof n||null===n)return(0,W.Wl)(n);const t=[];for(const r in n)t.push(r);t.sort();let e="{";for(let r=0;r<t.length;r++)0!==r&&(e+=","),e+=(0,W.Wl)(t[r]),e+=":",e+=Cx(n[t[r]]);return e+="}",e},ek=function(n,t){const e=n.length;if(e<=t)return[n];const r=[];for(let i=0;i<e;i+=t)r.push(n.substring(i,i+t>e?e:i+t));return r};function ds(n,t){for(const e in n)n.hasOwnProperty(e)&&t(e,n[e])}const tk=function(n){(0,W.hu)(!XD(n),"Invalid JSON number");const r=1023;let i,s,o,l,c;0===n?(s=0,o=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=l+r,o=Math.round(n*Math.pow(2,52-l)-Math.pow(2,52))):(s=0,o=Math.round(n/Math.pow(2,-1074))));const u=[];for(c=52;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=11;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const f=u.join("");let m="";for(c=0;c<64;c+=8){let _=parseInt(f.substr(c,8),2).toString(16);1===_.length&&(_="0"+_),m+=_}return m.toLowerCase()},z4=new RegExp("^-?(0*)\\d{1,10}$"),JF=function(n){if(z4.test(n)){const t=Number(n);if(t>=-2147483648&&t<=2147483647)return t}return null},ug=function(n){try{n()}catch(t){setTimeout(()=>{throw ho("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},Tx=function(n,t){const e=setTimeout(n,t);return"number"==typeof e&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):"object"==typeof e&&e.unref&&e.unref(),e};class eP{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(r=>this.appCheck=r)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((e,r)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,r):e(null)},0)})}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(r=>r.addTokenListener(t))}notifyForInvalidToken(){ho(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class H4{constructor(t,e,r){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(e=>e&&"auth/token-not-initialized"===e.code?(zs("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,r)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,r):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';t+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ho(t)}}let Uv=(()=>{class n{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const Z4=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,nP="websocket",rk="long_polling";class Gu{constructor(t,e,r,i,s=!1,o="",l=!1,c=!1){this.secure=e,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Hf.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Hf.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function Ex(n,t,e){let r;if((0,W.hu)("string"==typeof t,"typeof type must == string"),(0,W.hu)("object"==typeof e,"typeof params must == object"),t===nP)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(t!==rk)throw new Error("Unknown connection type: "+t);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function rP(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(e.ns=n.namespace);const i=[];return ds(e,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class ik{constructor(){this.counters_={}}incrementCounter(t,e=1){(0,W.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return(0,W.p$)(this.counters_)}}const sk={},Hv={};function Gv(n){const t=n.toString();return sk[t]||(sk[t]=new ik),sk[t]}class U7{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ug(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Hc{constructor(t,e,r,i,s,o,l){this.connId=t,this.repoInfo=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Vv(t),this.stats_=Gv(e),this.urlFn=c=>(this.appCheckToken&&(c.ac=this.appCheckToken),Ex(e,rk,c))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new U7(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,W.Yr)()||"complete"===document.readyState)n();else{let t=!1;const e=function(){document.body?t||(t=!0,n()):setTimeout(e,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&e()}),window.attachEvent("onload",e))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new lk((...s)=>{const[o,l,c,u,f]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=l,this.password=c;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,l]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&Z4.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Hc.forceAllow_=!0}static forceDisallow(){Hc.forceDisallow_=!0}static isAvailable(){return!((0,W.Yr)()||!Hc.forceAllow_&&(Hc.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=(0,W.Wl)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const r=(0,W.h$)(e),i=ek(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(t,e){if((0,W.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=t,r.pw=e,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=(0,W.Wl)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class lk{constructor(t,e,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,W.Yr)())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=wx(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=lk.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){zs("frame writing exception"),l.stack&&zs(l.stack),zs(l)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||zs("No IE domain setting required")}catch{const r=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return e+=r,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,r){this.pendingSegs.push({seg:t,ts:e,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const r=()=>{this.outstandingRequests.delete(e),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,()=>{clearTimeout(i),r()})}addTag(t,e){(0,W.Yr)()?this.doNodeLongPoll(t,e):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=()=>{zs("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let ck=null;typeof MozWebSocket<"u"?ck=MozWebSocket:typeof WebSocket<"u"&&(ck=WebSocket);let dg=(()=>{class n{constructor(e,r,i,s,o,l,c){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Vv(this.connId),this.stats_=Gv(r),this.connURL=n.connectionURL_(r,l,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(e,r,i,s,o){const l={v:"5"};return!(0,W.Yr)()&&typeof location<"u"&&location.hostname&&Z4.test(location.hostname)&&(l.r="f"),r&&(l.s=r),i&&(l.ls=i),s&&(l.ac=s),o&&(l.p=o),Ex(e,nP,l)}open(e,r){this.onDisconnect=r,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Hf.set("previous_websocket_failure",!0);try{let i;if((0,W.Yr)()){i={headers:{"User-Agent":`Firebase/5/${vx}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,l=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;l&&(i.proxy={origin:l})}this.mySock=new ck(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&null!==ck&&!n.forceDisallow_}static previouslyFailed(){return Hf.isInMemoryStorage||!0===Hf.get("previous_websocket_failure")}markConnectionHealthy(){Hf.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,W.cI)(r);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,W.hu)(null===this.frames,"We already have a frame buffer"),e.length<=6){const r=Number(e);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const r=e.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const r=(0,W.Wl)(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=ek(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),fP=(()=>{class n{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Hc,dg]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const r=dg&&dg.isAvailable();let i=r&&!dg.previouslyFailed();if(e.webSocketOnly&&(r||ho("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[dg];else{const s=this.transports_=[];for(const o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class h{constructor(t,e,r,i,s,o,l,c,u,f){this.id=t,this.repoInfo_=e,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Vv("c:"+this.id+":"),this.transportManager_=new fP(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,r)},Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=Tx(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){this.sendData_({t:"d",d:t})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=cg("t",t),r=cg("d",t);if("c"===e)this.onSecondaryControl_(r);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=cg("t",t),r=cg("d",t);"c"===e?this.onControl_(r):"d"===e&&this.onDataMessage_(r)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=cg("t",t);if("d"in t){const r=t.d;if("h"===e){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(r):"r"===e?this.onReset_(r):"e"===e?QD("Server Error: "+r):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):QD("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,r=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==r&&ho("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,r),Tx(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Tx(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Hf.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class p{put(t,e,r,i){}merge(t,e,r,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,r){}onDisconnectMerge(t,e,r){}onDisconnectCancel(t,e){}reportStats(t){}}class g{constructor(t){this.allowedEvents_=t,this.listeners_={},(0,W.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const r=[...this.listeners_[t]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)}}on(t,e,r){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:r});const i=this.getInitialEvent(t);i&&e.apply(r,i)}off(t,e,r){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let s=0;s<i.length;s++)if(i[s].callback===e&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(t){(0,W.hu)(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}class v extends g{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,W.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new v}getInitialEvent(t){return(0,W.hu)("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class N{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function R(){return new N("")}function F(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function H(n){return n.pieces_.length-n.pieceNum_}function Y(n){let t=n.pieceNum_;return t<n.pieces_.length&&t++,new N(n.pieces_,t)}function de(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function rt(n,t=0){return n.pieces_.slice(n.pieceNum_+t)}function Tt(n){if(n.pieceNum_>=n.pieces_.length)return null;const t=[];for(let e=n.pieceNum_;e<n.pieces_.length-1;e++)t.push(n.pieces_[e]);return new N(t,0)}function mt(n,t){const e=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)e.push(n.pieces_[r]);if(t instanceof N)for(let r=t.pieceNum_;r<t.pieces_.length;r++)e.push(t.pieces_[r]);else{const r=t.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&e.push(r[i])}return new N(e,0)}function gt(n){return n.pieceNum_>=n.pieces_.length}function Yt(n,t){const e=F(n),r=F(t);if(null===e)return t;if(e===r)return Yt(Y(n),Y(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+n+")")}function lt(n,t){const e=rt(n,0),r=rt(t,0);for(let i=0;i<e.length&&i<r.length;i++){const s=lg(e[i],r[i]);if(0!==s)return s}return e.length===r.length?0:e.length<r.length?-1:1}function Cn(n,t){if(H(n)!==H(t))return!1;for(let e=n.pieceNum_,r=t.pieceNum_;e<=n.pieces_.length;e++,r++)if(n.pieces_[e]!==t.pieces_[r])return!1;return!0}function Un(n,t){let e=n.pieceNum_,r=t.pieceNum_;if(H(n)>H(t))return!1;for(;e<n.pieces_.length;){if(n.pieces_[e]!==t.pieces_[r])return!1;++e,++r}return!0}class li{constructor(t,e){this.errorPrefix_=e,this.parts_=rt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,W.ug)(this.parts_[r]);kx(this)}}function kx(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Wu(n))}function Wu(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class Wv extends g{constructor(){let t,e;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const r=!document[t];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Wv}getInitialEvent(t){return(0,W.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]}}const Wf=1e3;let gP,jv=(()=>{class n extends p{constructor(e,r,i,s,o,l,c,u){if(super(),this.repoInfo_=e,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=l,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Vv("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Wf,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!(0,W.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Wv.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&v.getInstance().on("online",this.onOnline_,this)}sendRequest(e,r,i){const s=++this.requestNumber_,o={r:s,a:e,b:r};this.log_((0,W.Wl)(o)),(0,W.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const r=new W.BH,i={p:e._path.toString(),q:e._queryObject};return this.outstandingGets_.push({action:"g",request:i,onComplete:l=>{const c=l.d;"ok"===l.s?r.resolve(c):r.reject(c)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(e,r,i,s){this.initConnection_();const o=e._queryIdentifier,l=e._path.toString();this.log_("Listen called for "+l+" "+o),this.listens.has(l)||this.listens.set(l,new Map),(0,W.hu)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,W.hu)(!this.listens.get(l).has(o),"listen() called twice for same path/queryId.");const c={onComplete:s,hashFn:r,query:e,tag:i};this.listens.get(l).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(e){const r=this.outstandingGets_[e];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(e){const r=e.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,c=>{const u=c.d,f=c.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",c),"ok"!==f&&this.removeListen_(i,s),e.onComplete&&e.onComplete(f,u))})}static warnOnListenWarnings_(e,r){if(e&&"object"==typeof e&&(0,W.r3)(e,"w")){const i=(0,W.DV)(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();ho(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,W.GJ)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,r=(0,W.w9)(e)?"auth":"gauth",i={cred:e};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,l=s.d||"error";this.authToken_===e&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const r=e.s,i=e.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(e,r){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),(0,W.hu)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,r)}sendUnlisten_(e,r,i,s){this.log_("Unlisten on "+e+" for "+r);const o={p:e};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(e,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,r,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:r,onComplete:i})}onDisconnectMerge(e,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,r,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:r,onComplete:i})}onDisconnectCancel(e,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(e,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,l=>{s&&setTimeout(()=>{s(l.s,l.d)},Math.floor(0))})}put(e,r,i,s){this.putInternal("p",e,r,i,s)}merge(e,r,i,s){this.putInternal("m",e,r,i,s)}putInternal(e,r,i,s,o){this.initConnection_();const l={p:r,d:i};void 0!==o&&(l.h=o),this.outstandingPuts_.push({action:e,request:l,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(e){const r=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,W.Wl)(e));const r=e.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,r){this.log_("handleServerMessage",e,r),"d"===e?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===e?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===e?this.onListenRevoked_(r.p,r.q):"ac"===e?this.onAuthRevoked_(r.s,r.d):"apc"===e?this.onAppCheckRevoked_(r.s,r.d):"sd"===e?this.onSecurityDebugPacket_(r):QD("Unrecognized action received from server: "+(0,W.Wl)(e)+"\nAre you using the latest client?")}onReady_(e,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,W.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Wf,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Wf,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Wf),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-e);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var e=this;return(0,q.Z)(function*(){if(e.shouldReconnect_()){e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null;const r=e.onDataMessage_.bind(e),i=e.onReady_.bind(e),s=e.onRealtimeDisconnect_.bind(e),o=e.id+":"+n.nextConnectionId_++,l=e.lastSessionId;let c=!1,u=null;const f=function(){u?u.close():(c=!0,s())};e.realtime_={close:f,sendRequest:function(y){(0,W.hu)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(y)}};const _=e.forceTokenRefresh_;e.forceTokenRefresh_=!1;try{const[y,w]=yield Promise.all([e.authTokenProvider_.getToken(_),e.appCheckTokenProvider_.getToken(_)]);c?zs("getToken() completed but was canceled"):(zs("getToken() completed. Creating connection."),e.authToken_=y&&y.accessToken,e.appCheckToken_=w&&w.token,u=new h(o,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,r,i,s,T=>{ho(T+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},l))}catch(y){e.log_("Failed to get token: "+y),c||(e.repoInfo_.nodeAdmin&&ho(y),f())}}})()}interrupt(e){zs("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){zs("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,W.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Wf,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const r=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const r=this.outstandingPuts_[e];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,r){let i;i=r?r.map(o=>Cx(o)).join("$"):"default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,r){const i=new N(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,r){zs("Auth token revoked: "+e+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,r){zs("App check token revoked: "+e+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const r of e.values())this.sendListen_(r);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let r="js";(0,W.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+r+"."+vx.replace(/\./g,"-")]=1,(0,W.uI)()?e["framework.cordova"]=1:(0,W.b$)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=v.getInstance().currentlyOnline();return(0,W.xb)(this.interruptReasons_)&&e}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class or{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new or(t,e)}}class mP{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const r=new or(Xd,t),i=new or(Xd,e);return 0!==this.compare(r,i)}minPost(){return or.MIN}}class Q7 extends mP{static get __EMPTY_NODE(){return gP}static set __EMPTY_NODE(t){gP=t}compare(t,e){return lg(t.name,e.name)}isDefinedOn(t){throw(0,W.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return or.MIN}maxPost(){return new or(zc,gP)}makePost(t,e){return(0,W.hu)("string"==typeof t,"KeyIndex indexValue must always be a string."),new or(t,gP)}toString(){return".key"}}const Jd=new Q7;class _P{constructor(t,e,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!t.isEmpty();)if(o=e?r(t.key,e):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}let lH,ju=(()=>{class n{constructor(e,r,i,s,o){this.key=e,this.value=r,this.color=i??n.RED,this.left=s??bl.EMPTY_NODE,this.right=o??bl.EMPTY_NODE}copy(e,r,i,s,o){return new n(e??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,i){let s=this;const o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return bl.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,r){let i,s;if(i=this,r(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(e,i.key)){if(i.right.isEmpty())return bl.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class bl{constructor(t,e=bl.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new bl(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,ju.BLACK,null,null))}remove(t){return new bl(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,ju.BLACK,null,null))}get(t){let e,r=this.root_;for(;!r.isEmpty();){if(e=this.comparator_(t,r.key),0===e)return r.value;e<0?r=r.left:e>0&&(r=r.right)}return null}getPredecessorKey(t){let e,r=this.root_,i=null;for(;!r.isEmpty();){if(e=this.comparator_(t,r.key),0===e){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}e<0?r=r.left:e>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new _P(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new _P(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new _P(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new _P(this.root_,null,this.comparator_,!0,t)}}function Dge(n,t){return lg(n.name,t.name)}function aH(n,t){return lg(n,t)}bl.EMPTY_NODE=new class Ege{copy(t,e,r,i,s){return this}insert(t,e,r){return new ju(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const X7=function(n){return"number"==typeof n?"number:"+tk(n):"string:"+n},J7=function(n){if(n.isLeafNode()){const t=n.val();(0,W.hu)("string"==typeof t||"number"==typeof t||"object"==typeof t&&(0,W.r3)(t,".sv"),"Priority must be a string or number.")}else(0,W.hu)(n===lH||n.isEmpty(),"priority of unexpected type.");(0,W.hu)(n===lH||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let eQ,tQ,nQ,Nx=(()=>{class n{constructor(e,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=r,this.lazyHash_=null,(0,W.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),J7(this.priorityNode_)}static set __childrenNodeConstructor(e){eQ=e}static get __childrenNodeConstructor(){return eQ}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new n(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return gt(e)?this:".priority"===F(e)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,r){return null}updateImmediateChild(e,r){return".priority"===e?this.updatePriority(r):r.isEmpty()&&".priority"!==e?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,r).updatePriority(this.priorityNode_)}updateChild(e,r){const i=F(e);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,W.hu)(".priority"!==i||1===H(e),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Y(e),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,r){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+X7(this.priorityNode_.val())+":");const r=typeof this.value_;e+=r+":",e+="number"===r?tk(this.value_):this.value_,this.lazyHash_=zu(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===n.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof n.__childrenNodeConstructor?-1:((0,W.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const r=typeof e.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return(0,W.hu)(s>=0,"Unknown leaf type: "+r),(0,W.hu)(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const r=e;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const ci=new class Rge extends mP{compare(t,e){const r=t.node.getPriority(),i=e.node.getPriority(),s=r.compareTo(i);return 0===s?lg(t.name,e.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return or.MIN}maxPost(){return new or(zc,new Nx("[PRIORITY-POST]",nQ))}makePost(t,e){const r=tQ(t);return new or(e,new Nx("[PRIORITY-POST]",r))}toString(){return".priority"}},Mge=Math.log(2);class Oge{constructor(t){this.count=parseInt(Math.log(t+1)/Mge,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=t+1&i}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const yP=function(n,t,e,r){n.sort(t);const i=function(c,u){const f=u-c;let m,_;if(0===f)return null;if(1===f)return m=n[c],_=e?e(m):m,new ju(_,m.node,ju.BLACK,null,null);{const y=parseInt(f/2,10)+c,w=i(c,y),T=i(y+1,u);return m=n[y],_=e?e(m):m,new ju(_,m.node,ju.BLACK,w,T)}},l=function(c){let u=null,f=null,m=n.length;const _=function(w,T){const I=m-w,E=m;m-=w;const A=i(I+1,E),M=n[I],O=e?e(M):M;y(new ju(O,M.node,T,null,A))},y=function(w){u?(u.left=w,u=w):(f=w,u=w)};for(let w=0;w<c.count;++w){const T=c.nextBitIsOne(),I=Math.pow(2,c.count-(w+1));T?_(I,ju.BLACK):(_(I,ju.BLACK),_(I,ju.RED))}return f}(new Oge(n.length));return new bl(r||t,l)};let cH;const Rx={};class jf{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return(0,W.hu)(Rx&&ci,"ChildrenNode.ts has not been loaded"),cH=cH||new jf({".priority":Rx},{".priority":ci}),cH}get(t){const e=(0,W.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof bl?e:null}hasIndex(t){return(0,W.r3)(this.indexSet_,t.toString())}addIndex(t,e){(0,W.hu)(t!==Jd,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=e.getIterator(or.Wrap);let l,o=s.getNext();for(;o;)i=i||t.isDefinedOn(o.node),r.push(o),o=s.getNext();l=i?yP(r,t.getCompare()):Rx;const c=t.toString(),u=Object.assign({},this.indexSet_);u[c]=t;const f=Object.assign({},this.indexes_);return f[c]=l,new jf(f,u)}addToIndexes(t,e){const r=(0,W.UI)(this.indexes_,(i,s)=>{const o=(0,W.DV)(this.indexSet_,s);if((0,W.hu)(o,"Missing index implementation for "+s),i===Rx){if(o.isDefinedOn(t.node)){const l=[],c=e.getIterator(or.Wrap);let u=c.getNext();for(;u;)u.name!==t.name&&l.push(u),u=c.getNext();return l.push(t),yP(l,o.getCompare())}return Rx}{const l=e.get(t.name);let c=i;return l&&(c=c.remove(new or(t.name,l))),c.insert(t,t.node)}});return new jf(r,this.indexSet_)}removeFromIndexes(t,e){const r=(0,W.UI)(this.indexes_,i=>{if(i===Rx)return i;{const s=e.get(t.name);return s?i.remove(new or(t.name,s)):i}});return new jf(r,this.indexSet_)}}let pk,Hn=(()=>{class n{constructor(e,r,i){this.children_=e,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&J7(this.priorityNode_),this.children_.isEmpty()&&(0,W.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return pk||(pk=new n(new bl(aH),null,jf.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||pk}updatePriority(e){return this.children_.isEmpty()?this:new n(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const r=this.children_.get(e);return null===r?pk:r}}getChild(e){const r=F(e);return null===r?this:this.getImmediateChild(r).getChild(Y(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,r){if((0,W.hu)(r,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(r);{const i=new or(e,r);let s,o;r.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,r),o=this.indexMap_.addToIndexes(i,this.children_));const l=s.isEmpty()?pk:this.priorityNode_;return new n(s,l,o)}}updateChild(e,r){const i=F(e);if(null===i)return r;{(0,W.hu)(".priority"!==F(e)||1===H(e),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Y(e),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(ci,(l,c)=>{r[l]=c.val(e),i++,o&&n.INTEGER_REGEXP_.test(l)?s=Math.max(s,Number(l)):o=!1}),!e&&o&&s<2*i){const l=[];for(const c in r)l[c]=r[c];return l}return e&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+X7(this.getPriority().val())+":"),this.forEachChild(ci,(r,i)=>{const s=i.hash();""!==s&&(e+=":"+r+":"+s)}),this.lazyHash_=""===e?"":zu(e)}return this.lazyHash_}getPredecessorChildName(e,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new or(e,r));return o?o.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const r=this.resolveIndex_(e);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(e){const r=this.getFirstChildName(e);return r?new or(r,this.children_.get(r)):null}getLastChildName(e){const r=this.resolveIndex_(e);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(e){const r=this.getLastChildName(e);return r?new or(r,this.children_.get(r)):null}forEachChild(e,r){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,or.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,or.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===mk?-1:0}withIndex(e){if(e===Jd||this.indexMap_.hasIndex(e))return this;{const r=this.indexMap_.addIndex(e,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(e){return e===Jd||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const r=e;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(ci),s=r.getIterator(ci);let o=i.getNext(),l=s.getNext();for(;o&&l;){if(o.name!==l.name||!o.node.equals(l.node))return!1;o=i.getNext(),l=s.getNext()}return null===o&&null===l}return!1}return!1}}resolveIndex_(e){return e===Jd?null:this.indexMap_.get(e.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const mk=new class Fge extends Hn{constructor(){super(new bl(aH),Hn.EMPTY_NODE,jf.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return Hn.EMPTY_NODE}isEmpty(){return!1}};function Vi(n,t=null){if(null===n)return Hn.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(t=n[".priority"]),(0,W.hu)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new Nx(n,Vi(t));if(n instanceof Array){let e=Hn.EMPTY_NODE;return ds(n,(r,i)=>{if((0,W.r3)(n,r)&&"."!==r.substring(0,1)){const s=Vi(i);(s.isLeafNode()||!s.isEmpty())&&(e=e.updateImmediateChild(r,s))}}),e.updatePriority(Vi(t))}{const e=[];let r=!1;if(ds(n,(o,l)=>{if("."!==o.substring(0,1)){const c=Vi(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),e.push(new or(o,c)))}}),0===e.length)return Hn.EMPTY_NODE;const s=yP(e,Dge,o=>o.name,aH);if(r){const o=yP(e,ci.getCompare());return new Hn(s,Vi(t),new jf({".priority":o},{".priority":ci}))}return new Hn(s,Vi(t),jf.Default)}}Object.defineProperties(or,{MIN:{value:new or(Xd,Hn.EMPTY_NODE)},MAX:{value:new or(zc,mk)}}),Q7.__EMPTY_NODE=Hn.EMPTY_NODE,Nx.__childrenNodeConstructor=Hn,function kge(n){lH=n}(mk),function Nge(n){nQ=n}(mk),function Age(n){tQ=n}(Vi);class uH extends mP{constructor(t){super(),this.indexPath_=t,(0,W.hu)(!gt(t)&&".priority"!==F(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const r=this.extractChild(t.node),i=this.extractChild(e.node),s=r.compareTo(i);return 0===s?lg(t.name,e.name):s}makePost(t,e){const r=Vi(t),i=Hn.EMPTY_NODE.updateChild(this.indexPath_,r);return new or(e,i)}maxPost(){const t=Hn.EMPTY_NODE.updateChild(this.indexPath_,mk);return new or(zc,t)}toString(){return rt(this.indexPath_,0).join("/")}}const dH=new class Lge extends mP{compare(t,e){const r=t.node.compareTo(e.node);return 0===r?lg(t.name,e.name):r}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return or.MIN}maxPost(){return or.MAX}makePost(t,e){const r=Vi(t);return new or(e,r)}toString(){return".value"}};function rQ(n){return{type:"value",snapshotNode:n}}function Mx(n,t){return{type:"child_added",snapshotNode:t,childName:n}}function gk(n,t){return{type:"child_removed",snapshotNode:t,childName:n}}function _k(n,t,e){return{type:"child_changed",snapshotNode:t,childName:n,oldSnap:e}}class hH{constructor(t){this.index_=t}updateChild(t,e,r,i,s,o){(0,W.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=t.getImmediateChild(e);return l.getChild(i).equals(r.getChild(i))&&l.isEmpty()===r.isEmpty()||(null!=o&&(r.isEmpty()?t.hasChild(e)?o.trackChildChange(gk(e,l)):(0,W.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(Mx(e,r)):o.trackChildChange(_k(e,r,l))),t.isLeafNode()&&r.isEmpty())?t:t.updateImmediateChild(e,r).withIndex(this.index_)}updateFullNode(t,e,r){return null!=r&&(t.isLeafNode()||t.forEachChild(ci,(i,s)=>{e.hasChild(i)||r.trackChildChange(gk(i,s))}),e.isLeafNode()||e.forEachChild(ci,(i,s)=>{if(t.hasChild(i)){const o=t.getImmediateChild(i);o.equals(s)||r.trackChildChange(_k(i,s,o))}else r.trackChildChange(Mx(i,s))})),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?Hn.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class yk{constructor(t){this.indexedFilter_=new hH(t.getIndex()),this.index_=t.getIndex(),this.startPost_=yk.getStartPost_(t),this.endPost_=yk.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,r=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&r}updateChild(t,e,r,i,s,o){return this.matches(new or(e,r))||(r=Hn.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,r,i,s,o)}updateFullNode(t,e,r){e.isLeafNode()&&(e=Hn.EMPTY_NODE);let i=e.withIndex(this.index_);i=i.updatePriority(Hn.EMPTY_NODE);const s=this;return e.forEachChild(ci,(o,l)=>{s.matches(new or(o,l))||(i=i.updateImmediateChild(o,Hn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,i,r)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class Bge{constructor(t){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=e=>{const r=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new yk(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,r,i,s,o){return this.rangedFilter_.matches(new or(e,r))||(r=Hn.EMPTY_NODE),t.getImmediateChild(e).equals(r)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,r,i,s,o):this.fullLimitUpdateChild_(t,e,r,s,o)}updateFullNode(t,e,r){let i;if(e.isLeafNode()||e.isEmpty())i=Hn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let s;i=Hn.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const l=s.getNext();if(this.withinDirectionalStart(l)){if(!this.withinDirectionalEnd(l))break;i=i.updateImmediateChild(l.name,l.node),o++}}}else{let s;i=e.withIndex(this.index_),i=i.updatePriority(Hn.EMPTY_NODE),s=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let o=0;for(;s.hasNext();){const l=s.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,Hn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,r)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,r,i,s){let o;if(this.reverse_){const m=this.index_.getCompare();o=(_,y)=>m(y,_)}else o=this.index_.getCompare();const l=t;(0,W.hu)(l.numChildren()===this.limit_,"");const c=new or(e,r),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),f=this.rangedFilter_.matches(c);if(l.hasChild(e)){const m=l.getImmediateChild(e);let _=i.getChildAfterChild(this.index_,u,this.reverse_);for(;null!=_&&(_.name===e||l.hasChild(_.name));)_=i.getChildAfterChild(this.index_,_,this.reverse_);const y=null==_?1:o(_,c);if(f&&!r.isEmpty()&&y>=0)return s?.trackChildChange(_k(e,r,m)),l.updateImmediateChild(e,r);{s?.trackChildChange(gk(e,m));const T=l.updateImmediateChild(e,Hn.EMPTY_NODE);return null!=_&&this.rangedFilter_.matches(_)?(s?.trackChildChange(Mx(_.name,_.node)),T.updateImmediateChild(_.name,_.node)):T}}return r.isEmpty()?t:f&&o(u,c)>=0?(null!=s&&(s.trackChildChange(gk(u.name,u.node)),s.trackChildChange(Mx(e,r))),l.updateImmediateChild(e,r).updateImmediateChild(u.name,Hn.EMPTY_NODE)):t}}class vP{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ci}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,W.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,W.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Xd}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,W.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,W.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:zc}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,W.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ci}copy(){const t=new vP;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function fH(n,t,e){const r=n.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=e?(r.startNameSet_=!0,r.indexStartName_=e):(r.startNameSet_=!1,r.indexStartName_=""),r}function pH(n,t,e){const r=n.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==e?(r.endNameSet_=!0,r.indexEndName_=e):(r.endNameSet_=!1,r.indexEndName_=""),r}function bP(n,t){const e=n.copy();return e.index_=t,e}function iQ(n){const t={};if(n.isDefault())return t;let e;if(n.index_===ci?e="$priority":n.index_===dH?e="$value":n.index_===Jd?e="$key":((0,W.hu)(n.index_ instanceof uH,"Unrecognized index type!"),e=n.index_.toString()),t.orderBy=(0,W.Wl)(e),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";t[r]=(0,W.Wl)(n.indexStartValue_),n.startNameSet_&&(t[r]+=","+(0,W.Wl)(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";t[r]=(0,W.Wl)(n.indexEndValue_),n.endNameSet_&&(t[r]+=","+(0,W.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?t.limitToFirst=n.limit_:t.limitToLast=n.limit_),t}function sQ(n){const t={};if(n.startSet_&&(t.sp=n.indexStartValue_,n.startNameSet_&&(t.sn=n.indexStartName_),t.sin=!n.startAfterSet_),n.endSet_&&(t.ep=n.indexEndValue_,n.endNameSet_&&(t.en=n.indexEndName_),t.ein=!n.endBeforeSet_),n.limitSet_){t.l=n.limit_;let e=n.viewFrom_;""===e&&(e=n.isViewFromLeft()?"l":"r"),t.vf=e}return n.index_!==ci&&(t.i=n.index_.toString()),t}class wP extends p{constructor(t,e,r,i){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Vv("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:((0,W.hu)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,r,i){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const o=wP.getListenId_(t,r),l={};this.listens_[o]=l;const c=iQ(t._queryParams);this.restRequest_(s+".json",c,(u,f)=>{let m=f;if(404===u&&(m=null,u=null),null===u&&this.onDataUpdate_(s,m,!1,r),(0,W.DV)(this.listens_,o)===l){let _;_=u?401===u?"permission_denied":"rest_error:"+u:"ok",i(_,null)}})}unlisten(t,e){const r=wP.getListenId_(t,e);delete this.listens_[r]}get(t){const e=iQ(t._queryParams),r=t._path.toString(),i=new W.BH;return this.restRequest_(r+".json",e,(s,o)=>{let l=o;404===s&&(l=null,s=null),null===s?(this.onDataUpdate_(r,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(t){}restRequest_(t,e={},r){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(e.auth=i.accessToken),s&&s.token&&(e.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+(0,W.xO)(e);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&4===l.readyState){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=(0,W.cI)(l.responseText)}catch{ho("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,c)}else 401!==l.status&&404!==l.status&&ho("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}class Wge{constructor(){this.rootNode_=Hn.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function CP(){return{value:null,children:new Map}}function Ox(n,t,e){if(gt(t))n.value=e,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(t,e);else{const r=F(t);n.children.has(r)||n.children.set(r,CP()),Ox(n.children.get(r),t=Y(t),e)}}function mH(n,t){if(gt(t))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const e=n.value;return n.value=null,e.forEachChild(ci,(r,i)=>{Ox(n,new N(r),i)}),mH(n,t)}}if(n.children.size>0){const e=F(t);return t=Y(t),n.children.has(e)&&mH(n.children.get(e),t)&&n.children.delete(e),0===n.children.size}return!0}function gH(n,t,e){null!==n.value?e(t,n.value):function jge(n,t){n.children.forEach((e,r)=>{t(r,e)})}(n,(r,i)=>{gH(i,new N(t.toString()+"/"+r),e)})}class qge{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&ds(this.last_,(r,i)=>{e[r]=e[r]-i}),this.last_=t,e}}class Kge{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new qge(t);const r=1e4+2e4*Math.random();Tx(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const t=this.statsListener_.get(),e={};let r=!1;ds(t,(i,s)=>{s>0&&(0,W.r3)(this.statsToReport_,i)&&(e[i]=s,r=!0)}),r&&this.server_.reportStats(e),Tx(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Gc=(()=>{return(n=Gc||(Gc={}))[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",Gc;var n})();function vH(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class xP{constructor(t,e,r){this.path=t,this.affectedTree=e,this.revert=r,this.type=Gc.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(gt(this.path)){if(null!=this.affectedTree.value)return(0,W.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new N(t));return new xP(R(),e,this.revert)}}return(0,W.hu)(F(this.path)===t,"operationForChild called for unrelated child."),new xP(Y(this.path),this.affectedTree,this.revert)}}class vk{constructor(t,e){this.source=t,this.path=e,this.type=Gc.LISTEN_COMPLETE}operationForChild(t){return gt(this.path)?new vk(this.source,R()):new vk(this.source,Y(this.path))}}class qv{constructor(t,e,r){this.source=t,this.path=e,this.snap=r,this.type=Gc.OVERWRITE}operationForChild(t){return gt(this.path)?new qv(this.source,R(),this.snap.getImmediateChild(t)):new qv(this.source,Y(this.path),this.snap)}}class Fx{constructor(t,e,r){this.source=t,this.path=e,this.children=r,this.type=Gc.MERGE}operationForChild(t){if(gt(this.path)){const e=this.children.subtree(new N(t));return e.isEmpty()?null:e.value?new qv(this.source,R(),e.value):new Fx(this.source,R(),e)}return(0,W.hu)(F(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Fx(this.source,Y(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class hg{constructor(t,e,r){this.node_=t,this.fullyInitialized_=e,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(gt(t))return this.isFullyInitialized()&&!this.filtered_;const e=F(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class Qge{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function bk(n,t,e,r,i,s){const o=r.filter(l=>l.type===e);o.sort((l,c)=>function e_e(n,t,e){if(null==t.childName||null==e.childName)throw(0,W.g5)("Should only compare child_ events.");const r=new or(t.childName,t.snapshotNode),i=new or(e.childName,e.snapshotNode);return n.index_.compare(r,i)}(n,l,c)),o.forEach(l=>{const c=function Jge(n,t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,n.index_)),t}(n,l,s);i.forEach(u=>{u.respondsTo(l.type)&&t.push(u.createEvent(c,n.query_))})})}function IP(n,t){return{eventCache:n,serverCache:t}}function wk(n,t,e,r){return IP(new hg(t,e,r),n.serverCache)}function aQ(n,t,e,r){return IP(n.eventCache,new hg(t,e,r))}function TP(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Zv(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let bH;class ui{constructor(t,e=(()=>(bH||(bH=new bl(JD)),bH))()){this.value=t,this.children=e}static fromObject(t){let e=new ui(null);return ds(t,(r,i)=>{e=e.set(new N(r),i)}),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:R(),value:this.value};if(gt(t))return null;{const r=F(t),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(Y(t),e);return null!=s?{path:mt(new N(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(gt(t))return this;{const e=F(t),r=this.children.get(e);return null!==r?r.subtree(Y(t)):new ui(null)}}set(t,e){if(gt(t))return new ui(e,this.children);{const r=F(t),s=(this.children.get(r)||new ui(null)).set(Y(t),e),o=this.children.insert(r,s);return new ui(this.value,o)}}remove(t){if(gt(t))return this.children.isEmpty()?new ui(null):new ui(null,this.children);{const e=F(t),r=this.children.get(e);if(r){const i=r.remove(Y(t));let s;return s=i.isEmpty()?this.children.remove(e):this.children.insert(e,i),null===this.value&&s.isEmpty()?new ui(null):new ui(this.value,s)}return this}}get(t){if(gt(t))return this.value;{const e=F(t),r=this.children.get(e);return r?r.get(Y(t)):null}}setTree(t,e){if(gt(t))return e;{const r=F(t),s=(this.children.get(r)||new ui(null)).setTree(Y(t),e);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new ui(this.value,o)}}fold(t){return this.fold_(R(),t)}fold_(t,e){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(mt(t,i),e)}),e(t,this.value,r)}findOnPath(t,e){return this.findOnPath_(t,R(),e)}findOnPath_(t,e,r){const i=!!this.value&&r(e,this.value);if(i)return i;if(gt(t))return null;{const s=F(t),o=this.children.get(s);return o?o.findOnPath_(Y(t),mt(e,s),r):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,R(),e)}foreachOnPath_(t,e,r){if(gt(t))return this;{this.value&&r(e,this.value);const i=F(t),s=this.children.get(i);return s?s.foreachOnPath_(Y(t),mt(e,i),r):new ui(null)}}foreach(t){this.foreach_(R(),t)}foreach_(t,e){this.children.inorderTraversal((r,i)=>{i.foreach_(mt(t,r),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,r)=>{r.value&&t(e,r.value)})}}class qu{constructor(t){this.writeTree_=t}static empty(){return new qu(new ui(null))}}function Ck(n,t,e){if(gt(t))return new qu(new ui(e));{const r=n.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Yt(i,t);return s=s.updateChild(o,e),new qu(n.writeTree_.set(i,s))}{const i=new ui(e),s=n.writeTree_.setTree(t,i);return new qu(s)}}}function wH(n,t,e){let r=n;return ds(e,(i,s)=>{r=Ck(r,mt(t,i),s)}),r}function lQ(n,t){if(gt(t))return qu.empty();{const e=n.writeTree_.setTree(t,new ui(null));return new qu(e)}}function CH(n,t){return null!=Yv(n,t)}function Yv(n,t){const e=n.writeTree_.findRootMostValueAndPath(t);return null!=e?n.writeTree_.get(e.path).getChild(Yt(e.path,t)):null}function cQ(n){const t=[],e=n.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(ci,(r,i)=>{t.push(new or(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&t.push(new or(r,i.value))}),t}function fg(n,t){if(gt(t))return n;{const e=Yv(n,t);return new qu(null!=e?new ui(e):n.writeTree_.subtree(t))}}function xH(n){return n.writeTree_.isEmpty()}function Px(n,t){return uQ(R(),n.writeTree_,t)}function uQ(n,t,e){if(null!=t.value)return e.updateChild(n,t.value);{let r=null;return t.children.inorderTraversal((i,s)=>{".priority"===i?((0,W.hu)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):e=uQ(mt(n,i),s,e)}),!e.getChild(n).isEmpty()&&null!==r&&(e=e.updateChild(mt(n,".priority"),r)),e}}function SP(n,t){return mQ(t,n)}function o_e(n,t){if(n.snap)return Un(n.path,t);for(const e in n.children)if(n.children.hasOwnProperty(e)&&Un(mt(n.path,e),t))return!0;return!1}function l_e(n){return n.visible}function dQ(n,t,e){let r=qu.empty();for(let i=0;i<n.length;++i){const s=n[i];if(t(s)){const o=s.path;let l;if(s.snap)Un(e,o)?(l=Yt(e,o),r=Ck(r,l,s.snap)):Un(o,e)&&(l=Yt(o,e),r=Ck(r,R(),s.snap.getChild(l)));else{if(!s.children)throw(0,W.g5)("WriteRecord should have .snap or .children");if(Un(e,o))l=Yt(e,o),r=wH(r,l,s.children);else if(Un(o,e))if(l=Yt(o,e),gt(l))r=wH(r,R(),s.children);else{const c=(0,W.DV)(s.children,F(l));if(c){const u=c.getChild(Y(l));r=Ck(r,R(),u)}}}}}return r}function hQ(n,t,e,r,i){if(r||i){const s=fg(n.visibleWrites,t);return!i&&xH(s)?e:i||null!=e||CH(s,R())?Px(dQ(n.allWrites,function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Un(u.path,t)||Un(t,u.path))},t),e||Hn.EMPTY_NODE):null}{const s=Yv(n.visibleWrites,t);if(null!=s)return s;{const o=fg(n.visibleWrites,t);return xH(o)?e:null!=e||CH(o,R())?Px(o,e||Hn.EMPTY_NODE):null}}}function EP(n,t,e,r){return hQ(n.writeTree,n.treePath,t,e,r)}function IH(n,t){return function c_e(n,t,e){let r=Hn.EMPTY_NODE;const i=Yv(n.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(ci,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(e){const s=fg(n.visibleWrites,t);return e.forEachChild(ci,(o,l)=>{const c=Px(fg(s,new N(o)),l);r=r.updateImmediateChild(o,c)}),cQ(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return cQ(fg(n.visibleWrites,t)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(n.writeTree,n.treePath,t)}function fQ(n,t,e,r){return function u_e(n,t,e,r,i){(0,W.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=mt(t,e);if(CH(n.visibleWrites,s))return null;{const o=fg(n.visibleWrites,s);return xH(o)?i.getChild(e):Px(o,i.getChild(e))}}(n.writeTree,n.treePath,t,e,r)}function DP(n,t){return function h_e(n,t){return Yv(n.visibleWrites,t)}(n.writeTree,mt(n.treePath,t))}function TH(n,t,e){return function d_e(n,t,e,r){const i=mt(t,e),s=Yv(n.visibleWrites,i);return null!=s?s:r.isCompleteForChild(e)?Px(fg(n.visibleWrites,i),r.getNode().getImmediateChild(e)):null}(n.writeTree,n.treePath,t,e)}function pQ(n,t){return mQ(mt(n.treePath,t),n.writeTree)}function mQ(n,t){return{treePath:n,writeTree:t}}class g_e{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,r=t.childName;(0,W.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,W.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===e&&"child_removed"===s)this.changeMap.set(r,_k(r,t.snapshotNode,i.snapshotNode));else if("child_removed"===e&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===e&&"child_changed"===s)this.changeMap.set(r,gk(r,i.oldSnap));else if("child_changed"===e&&"child_added"===s)this.changeMap.set(r,Mx(r,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==s)throw(0,W.g5)("Illegal combination of changes: "+t+" occurred after "+i);this.changeMap.set(r,_k(r,t.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,t)}getChanges(){return Array.from(this.changeMap.values())}}const gQ=new class __e{getCompleteChild(t){return null}getChildAfterChild(t,e,r){return null}};class SH{constructor(t,e,r=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=r}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const r=null!=this.optCompleteServerCache_?new hg(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return TH(this.writes_,t,r)}}getChildAfterChild(t,e,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Zv(this.viewCache_),s=function m_e(n,t,e,r,i,s){return function f_e(n,t,e,r,i,s,o){let l;const c=fg(n.visibleWrites,t),u=Yv(c,R());if(null!=u)l=u;else{if(null==e)return[];l=Px(c,e)}if(l=l.withIndex(o),l.isEmpty()||l.isLeafNode())return[];{const f=[],m=o.getCompare(),_=s?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let y=_.getNext();for(;y&&f.length<i;)0!==m(y,r)&&f.push(y),y=_.getNext();return f}}(n.writeTree,n.treePath,t,e,r,i,s)}(this.writes_,i,e,1,r,t);return 0===s.length?null:s[0]}}function _Q(n,t,e,r,i,s){const o=t.eventCache;if(null!=DP(r,e))return t;{let l,c;if(gt(e))if((0,W.hu)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const u=Zv(t),m=IH(r,u instanceof Hn?u:Hn.EMPTY_NODE);l=n.filter.updateFullNode(t.eventCache.getNode(),m,s)}else{const u=EP(r,Zv(t));l=n.filter.updateFullNode(t.eventCache.getNode(),u,s)}else{const u=F(e);if(".priority"===u){(0,W.hu)(1===H(e),"Can't have a priority with additional path components");const f=o.getNode();c=t.serverCache.getNode();const m=fQ(r,e,f,c);l=null!=m?n.filter.updatePriority(f,m):o.getNode()}else{const f=Y(e);let m;if(o.isCompleteForChild(u)){c=t.serverCache.getNode();const _=fQ(r,e,o.getNode(),c);m=null!=_?o.getNode().getImmediateChild(u).updateChild(f,_):o.getNode().getImmediateChild(u)}else m=TH(r,u,t.serverCache);l=null!=m?n.filter.updateChild(o.getNode(),u,m,f,i,s):o.getNode()}}return wk(t,l,o.isFullyInitialized()||gt(e),n.filter.filtersNodes())}}function kP(n,t,e,r,i,s,o,l){const c=t.serverCache;let u;const f=o?n.filter:n.filter.getIndexedFilter();if(gt(e))u=f.updateFullNode(c.getNode(),r,null);else if(f.filtersNodes()&&!c.isFiltered()){const y=c.getNode().updateChild(e,r);u=f.updateFullNode(c.getNode(),y,null)}else{const y=F(e);if(!c.isCompleteForPath(e)&&H(e)>1)return t;const w=Y(e),I=c.getNode().getImmediateChild(y).updateChild(w,r);u=".priority"===y?f.updatePriority(c.getNode(),I):f.updateChild(c.getNode(),y,I,w,gQ,null)}const m=aQ(t,u,c.isFullyInitialized()||gt(e),f.filtersNodes());return _Q(n,m,e,i,new SH(i,m,s),l)}function EH(n,t,e,r,i,s,o){const l=t.eventCache;let c,u;const f=new SH(i,t,s);if(gt(e))u=n.filter.updateFullNode(t.eventCache.getNode(),r,o),c=wk(t,u,!0,n.filter.filtersNodes());else{const m=F(e);if(".priority"===m)u=n.filter.updatePriority(t.eventCache.getNode(),r),c=wk(t,u,l.isFullyInitialized(),l.isFiltered());else{const _=Y(e),y=l.getNode().getImmediateChild(m);let w;if(gt(_))w=r;else{const T=f.getCompleteChild(m);w=null!=T?".priority"===de(_)&&T.getChild(Tt(_)).isEmpty()?T:T.updateChild(_,r):Hn.EMPTY_NODE}c=y.equals(w)?t:wk(t,n.filter.updateChild(l.getNode(),m,w,_,f,o),l.isFullyInitialized(),n.filter.filtersNodes())}}return c}function yQ(n,t){return n.eventCache.isCompleteForChild(t)}function vQ(n,t,e){return e.foreach((r,i)=>{t=t.updateChild(r,i)}),t}function DH(n,t,e,r,i,s,o,l){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let u,c=t;u=gt(e)?r:new ui(null).setTree(e,r);const f=t.serverCache.getNode();return u.children.inorderTraversal((m,_)=>{if(f.hasChild(m)){const w=vQ(0,t.serverCache.getNode().getImmediateChild(m),_);c=kP(n,c,new N(m),w,i,s,o,l)}}),u.children.inorderTraversal((m,_)=>{const y=!t.serverCache.isCompleteForChild(m)&&null===_.value;if(!f.hasChild(m)&&!y){const T=vQ(0,t.serverCache.getNode().getImmediateChild(m),_);c=kP(n,c,new N(m),T,i,s,o,l)}}),c}class S_e{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new hH(r.getIndex()),s=function Vge(n){return n.loadsAllData()?new hH(n.getIndex()):n.hasLimit()?new Bge(n):new yk(n)}(r);this.processor_=function y_e(n){return{filter:n}}(s);const o=e.serverCache,l=e.eventCache,c=i.updateFullNode(Hn.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(Hn.EMPTY_NODE,l.getNode(),null),f=new hg(c,o.isFullyInitialized(),i.filtersNodes()),m=new hg(u,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=IP(m,f),this.eventGenerator_=new Qge(this.query_)}get query(){return this.query_}}function k_e(n,t){const e=Zv(n.viewCache_);return e&&(n.query._queryParams.loadsAllData()||!gt(t)&&!e.getImmediateChild(F(t)).isEmpty())?e.getChild(t):null}function bQ(n){return 0===n.eventRegistrations_.length}function wQ(n,t,e){const r=[];if(e){(0,W.hu)(null==t,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(e,i);o&&r.push(o)})}if(t){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(o.matches(t)){if(t.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}else i.push(o)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function CQ(n,t,e,r){t.type===Gc.MERGE&&null!==t.source.queryId&&((0,W.hu)(Zv(n.viewCache_),"We should always have a full cache before handling merges"),(0,W.hu)(TP(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=function b_e(n,t,e,r,i){const s=new g_e;let o,l;if(e.type===Gc.OVERWRITE){const u=e;u.source.fromUser?o=EH(n,t,u.path,u.snap,r,i,s):((0,W.hu)(u.source.fromServer,"Unknown source."),l=u.source.tagged||t.serverCache.isFiltered()&&!gt(u.path),o=kP(n,t,u.path,u.snap,r,i,l,s))}else if(e.type===Gc.MERGE){const u=e;u.source.fromUser?o=function C_e(n,t,e,r,i,s,o){let l=t;return r.foreach((c,u)=>{const f=mt(e,c);yQ(t,F(f))&&(l=EH(n,l,f,u,i,s,o))}),r.foreach((c,u)=>{const f=mt(e,c);yQ(t,F(f))||(l=EH(n,l,f,u,i,s,o))}),l}(n,t,u.path,u.children,r,i,s):((0,W.hu)(u.source.fromServer,"Unknown source."),l=u.source.tagged||t.serverCache.isFiltered(),o=DH(n,t,u.path,u.children,r,i,l,s))}else if(e.type===Gc.ACK_USER_WRITE){const u=e;o=u.revert?function T_e(n,t,e,r,i,s){let o;if(null!=DP(r,e))return t;{const l=new SH(r,t,i),c=t.eventCache.getNode();let u;if(gt(e)||".priority"===F(e)){let f;if(t.serverCache.isFullyInitialized())f=EP(r,Zv(t));else{const m=t.serverCache.getNode();(0,W.hu)(m instanceof Hn,"serverChildren would be complete if leaf node"),f=IH(r,m)}u=n.filter.updateFullNode(c,f,s)}else{const f=F(e);let m=TH(r,f,t.serverCache);null==m&&t.serverCache.isCompleteForChild(f)&&(m=c.getImmediateChild(f)),u=null!=m?n.filter.updateChild(c,f,m,Y(e),l,s):t.eventCache.getNode().hasChild(f)?n.filter.updateChild(c,f,Hn.EMPTY_NODE,Y(e),l,s):c,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=EP(r,Zv(t)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=DP(r,R()),wk(t,u,o,n.filter.filtersNodes())}}(n,t,u.path,r,i,s):function x_e(n,t,e,r,i,s,o){if(null!=DP(i,e))return t;const l=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(gt(e)&&c.isFullyInitialized()||c.isCompleteForPath(e))return kP(n,t,e,c.getNode().getChild(e),i,s,l,o);if(gt(e)){let u=new ui(null);return c.getNode().forEachChild(Jd,(f,m)=>{u=u.set(new N(f),m)}),DH(n,t,e,u,i,s,l,o)}return t}{let u=new ui(null);return r.foreach((f,m)=>{const _=mt(e,f);c.isCompleteForPath(_)&&(u=u.set(f,c.getNode().getChild(_)))}),DH(n,t,e,u,i,s,l,o)}}(n,t,u.path,u.affectedTree,r,i,s)}else{if(e.type!==Gc.LISTEN_COMPLETE)throw(0,W.g5)("Unknown operation type: "+e.type);o=function I_e(n,t,e,r,i){const s=t.serverCache;return _Q(n,aQ(t,s.getNode(),s.isFullyInitialized()||gt(e),s.isFiltered()),e,r,gQ,i)}(n,t,e.path,r,s)}const c=s.getChanges();return function w_e(n,t,e){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=TP(n);(e.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&e.push(rQ(TP(t)))}}(t,o,c),{viewCache:o,changes:c}}(n.processor_,i,t,e,r);return function v_e(n,t){(0,W.hu)(t.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,W.hu)(t.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),(0,W.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,xQ(n,s.changes,s.viewCache.eventCache.getNode(),null)}function xQ(n,t,e,r){return function Xge(n,t,e,r){const i=[],s=[];return t.forEach(o=>{"child_changed"===o.type&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function $ge(n,t){return{type:"child_moved",snapshotNode:t,childName:n}}(o.childName,o.snapshotNode))}),bk(n,i,"child_removed",t,r,e),bk(n,i,"child_added",t,r,e),bk(n,i,"child_moved",s,r,e),bk(n,i,"child_changed",t,r,e),bk(n,i,"value",t,r,e),i}(n.eventGenerator_,t,e,r?[r]:n.eventRegistrations_)}let AP,RP;class IQ{constructor(){this.views=new Map}}function kH(n,t,e,r){const i=t.source.queryId;if(null!==i){const s=n.views.get(i);return(0,W.hu)(null!=s,"SyncTree gave us an op for an invalid query."),CQ(s,t,e,r)}{let s=[];for(const o of n.views.values())s=s.concat(CQ(o,t,e,r));return s}}function TQ(n,t,e,r,i){const o=n.views.get(t._queryIdentifier);if(!o){let l=EP(e,i?r:null),c=!1;l?c=!0:r instanceof Hn?(l=IH(e,r),c=!1):(l=Hn.EMPTY_NODE,c=!1);const u=IP(new hg(l,c,!1),new hg(r,i,!1));return new S_e(t,u)}return o}function SQ(n){const t=[];for(const e of n.views.values())e.query._queryParams.loadsAllData()||t.push(e);return t}function pg(n,t){let e=null;for(const r of n.views.values())e=e||k_e(r,t);return e}function EQ(n,t){return t._queryParams.loadsAllData()?NP(n):n.views.get(t._queryIdentifier)}function DQ(n,t){return null!=EQ(n,t)}function mg(n){return null!=NP(n)}function NP(n){for(const t of n.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let B_e=1;class kQ{constructor(t){this.listenProvider_=t,this.syncPointTree_=new ui(null),this.pendingWriteTree_=function p_e(){return{visibleWrites:qu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function AH(n,t,e,r,i){return function n_e(n,t,e,r,i){(0,W.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:t,snap:e,writeId:r,visible:i}),i&&(n.visibleWrites=Ck(n.visibleWrites,t,e)),n.lastWriteId=r}(n.pendingWriteTree_,t,e,r,i),i?Lx(n,new qv({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,e)):[]}function gg(n,t,e=!1){const r=function i_e(n,t){for(let e=0;e<n.allWrites.length;e++){const r=n.allWrites[e];if(r.writeId===t)return r}return null}(n.pendingWriteTree_,t);if(function s_e(n,t){const e=n.allWrites.findIndex(l=>l.writeId===t);(0,W.hu)(e>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[e];n.allWrites.splice(e,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const l=n.allWrites[o];l.visible&&(o>=e&&o_e(l,r.path)?i=!1:Un(r.path,l.path)&&(s=!0)),o--}return!!i&&(s?(function a_e(n){n.visibleWrites=dQ(n.allWrites,l_e,R()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=lQ(n.visibleWrites,r.path):ds(r.children,c=>{n.visibleWrites=lQ(n.visibleWrites,mt(r.path,c))}),!0))}(n.pendingWriteTree_,t)){let s=new ui(null);return null!=r.snap?s=s.set(R(),!0):ds(r.children,o=>{s=s.set(new N(o),!0)}),Lx(n,new xP(r.path,s,e))}return[]}function xk(n,t,e){return Lx(n,new qv({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,e))}function MP(n,t,e,r,i=!1){const s=t._path,o=n.syncPointTree_.get(s);let l=[];if(o&&("default"===t._queryIdentifier||DQ(o,t))){const c=function P_e(n,t,e,r){const i=t._queryIdentifier,s=[];let o=[];const l=mg(n);if("default"===i)for(const[c,u]of n.views.entries())o=o.concat(wQ(u,e,r)),bQ(u)&&(n.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{const c=n.views.get(i);c&&(o=o.concat(wQ(c,e,r)),bQ(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return l&&!mg(n)&&s.push(new(function M_e(){return(0,W.hu)(AP,"Reference.ts has not been loaded"),AP}())(t._repo,t._path)),{removed:s,events:o}}(o,t,e,r);(function O_e(n){return 0===n.views.size})(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const u=c.removed;if(l=c.events,!i){const f=-1!==u.findIndex(_=>_._queryParams.loadsAllData()),m=n.syncPointTree_.findOnPath(s,(_,y)=>mg(y));if(f&&!m){const _=n.syncPointTree_.subtree(s);if(!_.isEmpty()){const y=function j_e(n){return n.fold((t,e,r)=>{if(e&&mg(e))return[NP(e)];{let i=[];return e&&(i=SQ(e)),ds(r,(s,o)=>{i=i.concat(o)}),i}})}(_);for(let w=0;w<y.length;++w){const T=y[w],I=T.query,E=MQ(n,T);n.listenProvider_.startListening(Tk(I),Ik(n,I),E.hashFn,E.onComplete)}}}!m&&u.length>0&&!r&&(f?n.listenProvider_.stopListening(Tk(t),null):u.forEach(_=>{const y=n.queryToTagMap.get(FP(_));n.listenProvider_.stopListening(Tk(_),y)}))}!function q_e(n,t){for(let e=0;e<t.length;++e){const r=t[e];if(!r._queryParams.loadsAllData()){const i=FP(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}(n,u)}return l}function AQ(n,t,e,r){const i=RH(n,r);if(null!=i){const s=MH(i),o=s.path,l=s.queryId,c=Yt(o,t);return OH(n,o,new qv(vH(l),c,e))}return[]}function NH(n,t,e,r=!1){const i=t._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(_,y)=>{const w=Yt(_,i);s=s||pg(y,w),o=o||mg(y)});let c,l=n.syncPointTree_.get(i);l?(o=o||mg(l),s=s||pg(l,R())):(l=new IQ,n.syncPointTree_=n.syncPointTree_.set(i,l)),null!=s?c=!0:(c=!1,s=Hn.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((y,w)=>{const T=pg(w,R());T&&(s=s.updateImmediateChild(y,T))}));const u=DQ(l,t);if(!u&&!t._queryParams.loadsAllData()){const _=FP(t);(0,W.hu)(!n.queryToTagMap.has(_),"View does not exist, but we have a tag");const y=function Z_e(){return B_e++}();n.queryToTagMap.set(_,y),n.tagToQueryMap.set(y,_)}let m=function F_e(n,t,e,r,i,s){const o=TQ(n,t,r,i,s);return n.views.has(t._queryIdentifier)||n.views.set(t._queryIdentifier,o),function A_e(n,t){n.eventRegistrations_.push(t)}(o,e),function N_e(n,t){const e=n.viewCache_.eventCache,r=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(ci,(s,o)=>{r.push(Mx(s,o))}),e.isFullyInitialized()&&r.push(rQ(e.getNode())),xQ(n,r,e.getNode(),t)}(o,e)}(l,t,e,SP(n.pendingWriteTree_,i),s,c);if(!u&&!o&&!r){const _=EQ(l,t);m=m.concat(function Y_e(n,t,e){const r=t._path,i=Ik(n,t),s=MQ(n,e),o=n.listenProvider_.startListening(Tk(t),i,s.hashFn,s.onComplete),l=n.syncPointTree_.subtree(r);if(i)(0,W.hu)(!mg(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((u,f,m)=>{if(!gt(u)&&f&&mg(f))return[NP(f).query];{let _=[];return f&&(_=_.concat(SQ(f).map(y=>y.query))),ds(m,(y,w)=>{_=_.concat(w)}),_}});for(let u=0;u<c.length;++u){const f=c[u];n.listenProvider_.stopListening(Tk(f),Ik(n,f))}}return o}(n,t,_))}return m}function OP(n,t,e){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(t,(o,l)=>{const u=pg(l,Yt(o,t));if(u)return u});return hQ(i,t,s,e,!0)}function Lx(n,t){return NQ(t,n.syncPointTree_,null,SP(n.pendingWriteTree_,R()))}function NQ(n,t,e,r){if(gt(n.path))return RQ(n,t,e,r);{const i=t.get(R());null==e&&null!=i&&(e=pg(i,R()));let s=[];const o=F(n.path),l=n.operationForChild(o),c=t.children.get(o);if(c&&l){const u=e?e.getImmediateChild(o):null,f=pQ(r,o);s=s.concat(NQ(l,c,u,f))}return i&&(s=s.concat(kH(i,n,r,e))),s}}function RQ(n,t,e,r){const i=t.get(R());null==e&&null!=i&&(e=pg(i,R()));let s=[];return t.children.inorderTraversal((o,l)=>{const c=e?e.getImmediateChild(o):null,u=pQ(r,o),f=n.operationForChild(o);f&&(s=s.concat(RQ(f,l,c,u)))}),i&&(s=s.concat(kH(i,n,r,e))),s}function MQ(n,t){const e=t.query,r=Ik(n,e);return{hashFn:()=>(function E_e(n){return n.viewCache_.serverCache.getNode()}(t)||Hn.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function H_e(n,t,e){const r=RH(n,e);if(r){const i=MH(r),s=i.path,o=i.queryId,l=Yt(s,t);return OH(n,s,new vk(vH(o),l))}return[]}(n,e._path,r):function z_e(n,t){return Lx(n,new vk({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(n,e._path);{const s=function KF(n,t){let e="Unknown Error";"too_big"===n?e="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?e="Client doesn't have permission to access the desired data.":"unavailable"===n&&(e="The service is unavailable");const r=new Error(n+" at "+t._path.toString()+": "+e);return r.code=n.toUpperCase(),r}(i,e);return MP(n,e,null,s)}}}}function Ik(n,t){const e=FP(t);return n.queryToTagMap.get(e)}function FP(n){return n._path.toString()+"$"+n._queryIdentifier}function RH(n,t){return n.tagToQueryMap.get(t)}function MH(n){const t=n.indexOf("$");return(0,W.hu)(-1!==t&&t<n.length-1,"Bad queryKey."),{queryId:n.substr(t+1),path:new N(n.substr(0,t))}}function OH(n,t,e){const r=n.syncPointTree_.get(t);return(0,W.hu)(r,"Missing sync point for query tag that we're tracking"),kH(r,e,SP(n.pendingWriteTree_,t),null)}function Tk(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function $_e(){return(0,W.hu)(RP,"Reference.ts has not been loaded"),RP}())(n._repo,n._path):n}class FH{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new FH(e)}node(){return this.node_}}class PH{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=mt(this.path_,t);return new PH(this.syncTree_,e)}node(){return OP(this.syncTree_,this.path_)}}const OQ=function(n,t,e){return n&&"object"==typeof n?((0,W.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Q_e(n[".sv"],t,e):"object"==typeof n[".sv"]?X_e(n[".sv"],t):void(0,W.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Q_e=function(n,t,e){if("timestamp"===n)return e.timestamp;(0,W.hu)(!1,"Unexpected server value: "+n)},X_e=function(n,t,e){n.hasOwnProperty("increment")||(0,W.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,W.hu)(!1,"Unexpected increment value: "+r);const i=t.node();if((0,W.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},FQ=function(n,t,e,r){return $H(t,new PH(e,n),r)},LH=function(n,t,e){return $H(n,new FH(t),e)};function $H(n,t,e){const r=n.getPriority().val(),i=OQ(r,t.getImmediateChild(".priority"),e);let s;if(n.isLeafNode()){const o=n,l=OQ(o.getValue(),t,e);return l!==o.getValue()||i!==o.getPriority().val()?new Nx(l,Vi(i)):n}{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Nx(i))),o.forEachChild(ci,(l,c)=>{const u=$H(c,t.getImmediateChild(l),e);u!==c&&(s=s.updateImmediateChild(l,u))}),s}}class BH{constructor(t="",e=null,r={children:{},childCount:0}){this.name=t,this.parent=e,this.node=r}}function PP(n,t){let e=t instanceof N?t:new N(t),r=n,i=F(e);for(;null!==i;){const s=(0,W.DV)(r.node.children,i)||{children:{},childCount:0};r=new BH(i,r,s),e=Y(e),i=F(e)}return r}function Kv(n){return n.node.value}function VH(n,t){n.node.value=t,UH(n)}function PQ(n){return n.node.childCount>0}function LP(n,t){ds(n.node.children,(e,r)=>{t(new BH(e,n,r))})}function LQ(n,t,e,r){e&&!r&&t(n),LP(n,i=>{LQ(i,t,!0,r)}),e&&r&&t(n)}function Sk(n){return new N(null===n.parent?n.name:Sk(n.parent)+"/"+n.name)}function UH(n){null!==n.parent&&function tye(n,t,e){const r=function J_e(n){return void 0===Kv(n)&&!PQ(n)}(e),i=(0,W.r3)(n.node.children,t);r&&i?(delete n.node.children[t],n.node.childCount--,UH(n)):!r&&!i&&(n.node.children[t]=e.node,n.node.childCount++,UH(n))}(n.parent,n.name,n)}const nye=/[\[\].#$\/\u0000-\u001F\u007F]/,rye=/[\[\].#$\u0000-\u001F\u007F]/,zH=10485760,$P=function(n){return"string"==typeof n&&0!==n.length&&!nye.test(n)},$Q=function(n){return"string"==typeof n&&0!==n.length&&!rye.test(n)},Ek=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!XD(n)||n&&"object"==typeof n&&(0,W.r3)(n,".sv")},eh=function(n,t,e,r){r&&void 0===t||Dk((0,W.gK)(n,"value"),t,e)},Dk=function(n,t,e){const r=e instanceof N?new li(e,n):e;if(void 0===t)throw new Error(n+"contains undefined "+Wu(r));if("function"==typeof t)throw new Error(n+"contains a function "+Wu(r)+" with contents = "+t.toString());if(XD(t))throw new Error(n+"contains "+t.toString()+" "+Wu(r));if("string"==typeof t&&t.length>zH/3&&(0,W.ug)(t)>zH)throw new Error(n+"contains a string greater than "+zH+" utf8 bytes "+Wu(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let i=!1,s=!1;if(ds(t,(o,l)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!$P(o)))throw new Error(n+" contains an invalid key ("+o+") "+Wu(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Gf(n,t){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(t),n.byteLength_+=(0,W.ug)(t),kx(n)})(r,o),Dk(n,l,r),function uk(n){const t=n.parts_.pop();n.byteLength_-=(0,W.ug)(t),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&s)throw new Error(n+' contains ".value" child '+Wu(r)+" in addition to actual children.")}},BQ=function(n,t,e,r){if(r&&void 0===t)return;const i=(0,W.gK)(n,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];ds(t,(o,l)=>{const c=new N(o);if(Dk(i,l,mt(e,c)),".priority"===de(c)&&!Ek(l))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),function(n,t){let e,r;for(e=0;e<t.length;e++){r=t[e];const s=rt(r);for(let o=0;o<s.length;o++)if((".priority"!==s[o]||o!==s.length-1)&&!$P(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(lt);let i=null;for(e=0;e<t.length;e++){if(r=t[e],null!==i&&Un(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},HH=function(n,t,e){if(!e||void 0!==t){if(XD(t))throw new Error((0,W.gK)(n,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ek(t))throw new Error((0,W.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},kk=function(n,t,e,r){if(!(r&&void 0===e||$P(e)))throw new Error((0,W.gK)(n,t)+'was an invalid key = "'+e+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Ak=function(n,t,e,r){if(!(r&&void 0===e||$Q(e)))throw new Error((0,W.gK)(n,t)+'was an invalid path = "'+e+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Wc=function(n,t){if(".info"===F(t))throw new Error(n+" failed = Can't modify data under /.info/")},VQ=function(n,t){const e=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!$P(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==e.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),$Q(n)}(e))throw new Error((0,W.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class aye{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function BP(n,t){let e=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null!==e&&!Cn(s,e.path)&&(n.eventLists_.push(e),e=null),null===e&&(e={events:[],path:s}),e.events.push(i)}e&&n.eventLists_.push(e)}function UQ(n,t,e){BP(n,e),zQ(n,r=>Cn(r,t))}function ic(n,t,e){BP(n,e),zQ(n,r=>Un(r,t)||Un(t,r))}function zQ(n,t){n.recursionDepth_++;let e=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(t(i.path)?(lye(n.eventLists_[r]),n.eventLists_[r]=null):e=!1)}e&&(n.eventLists_=[]),n.recursionDepth_--}function lye(n){for(let t=0;t<n.events.length;t++){const e=n.events[t];if(null!==e){n.events[t]=null;const r=e.getEventRunner();Hu&&zs("event: "+e.toString()),ug(r)}}}const HQ="repo_interrupt";class uye{constructor(t,e,r,i){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new aye,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=CP(),this.transactionQueueTree_=new BH,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function GQ(n){const e=n.infoData_.getNode(new N(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function Nk(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:GQ(n)})}function WQ(n,t,e,r,i){n.dataUpdateCount++;const s=new N(t);e=n.interceptServerDataCallback_?n.interceptServerDataCallback_(t,e):e;let o=[];if(i)if(r){const c=(0,W.UI)(e,u=>Vi(u));o=function G_e(n,t,e,r){const i=RH(n,r);if(i){const s=MH(i),o=s.path,l=s.queryId,c=Yt(o,t),u=ui.fromObject(e);return OH(n,o,new Fx(vH(l),c,u))}return[]}(n.serverSyncTree_,s,c,i)}else{const c=Vi(e);o=AQ(n.serverSyncTree_,s,c,i)}else if(r){const c=(0,W.UI)(e,u=>Vi(u));o=function U_e(n,t,e){const r=ui.fromObject(e);return Lx(n,new Fx({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(n.serverSyncTree_,s,c)}else{const c=Vi(e);o=xk(n.serverSyncTree_,s,c)}let l=s;o.length>0&&(l=Bx(n,s)),ic(n.eventQueue_,l,o)}function jQ(n,t){GH(n,"connected",t),!1===t&&function mye(n){$x(n,"onDisconnectEvents");const t=Nk(n),e=CP();gH(n.onDisconnect_,R(),(i,s)=>{const o=FQ(i,s,n.serverSyncTree_,t);Ox(e,i,o)});let r=[];gH(e,R(),(i,s)=>{r=r.concat(xk(n.serverSyncTree_,i,s));const o=ZH(n,i);Bx(n,o)}),n.onDisconnect_=CP(),ic(n.eventQueue_,R(),r)}(n)}function GH(n,t,e){const r=new N("/.info/"+t),i=Vi(e);n.infoData_.updateSnapshot(r,i);const s=xk(n.infoSyncTree_,r,i);ic(n.eventQueue_,r,s)}function VP(n){return n.nextWriteId_++}function WH(n,t,e,r,i){$x(n,"set",{path:t.toString(),value:e,priority:r});const s=Nk(n),o=Vi(e,r),l=OP(n.serverSyncTree_,t),c=LH(o,l,s),u=VP(n),f=AH(n.serverSyncTree_,t,c,u,!0);BP(n.eventQueue_,f),n.server_.put(t.toString(),o.val(!0),(_,y)=>{const w="ok"===_;w||ho("set at "+t+" failed: "+_);const T=gg(n.serverSyncTree_,u,!w);ic(n.eventQueue_,t,T),_g(0,i,_,y)});const m=ZH(n,t);Bx(n,m),ic(n.eventQueue_,m,[])}function gye(n,t,e){n.server_.onDisconnectCancel(t.toString(),(r,i)=>{"ok"===r&&mH(n.onDisconnect_,t),_g(0,e,r,i)})}function qQ(n,t,e,r){const i=Vi(e);n.server_.onDisconnectPut(t.toString(),i.val(!0),(s,o)=>{"ok"===s&&Ox(n.onDisconnect_,t,i),_g(0,r,s,o)})}function jH(n,t,e){let r;r=".info"===F(t._path)?MP(n.infoSyncTree_,t,e):MP(n.serverSyncTree_,t,e),UQ(n.eventQueue_,t._path,r)}function ZQ(n){n.persistentConnection_&&n.persistentConnection_.interrupt(HQ)}function $x(n,...t){let e="";n.persistentConnection_&&(e=n.persistentConnection_.id+":"),zs(e,...t)}function _g(n,t,e,r){t&&ug(()=>{if("ok"===e)t(null);else{const i=(e||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,t(o)}})}function qH(n,t,e){return OP(n.serverSyncTree_,t,e)||Hn.EMPTY_NODE}function UP(n,t=n.transactionQueueTree_){if(t||zP(n,t),Kv(t)){const e=KQ(n,t);(0,W.hu)(e.length>0,"Sending zero length transaction queue"),e.every(i=>0===i.status)&&function Cye(n,t,e){const r=e.map(u=>u.currentWriteId),i=qH(n,t,r);let s=i;const o=i.hash();for(let u=0;u<e.length;u++){const f=e[u];(0,W.hu)(0===f.status,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const m=Yt(t,f.path);s=s.updateChild(m,f.currentOutputSnapshotRaw)}const l=s.val(!0),c=t;n.server_.put(c.toString(),l,u=>{$x(n,"transaction put response",{path:c.toString(),status:u});let f=[];if("ok"===u){const m=[];for(let _=0;_<e.length;_++)e[_].status=2,f=f.concat(gg(n.serverSyncTree_,e[_].currentWriteId)),e[_].onComplete&&m.push(()=>e[_].onComplete(null,!0,e[_].currentOutputSnapshotResolved)),e[_].unwatcher();zP(n,PP(n.transactionQueueTree_,t)),UP(n,n.transactionQueueTree_),ic(n.eventQueue_,t,f);for(let _=0;_<m.length;_++)ug(m[_])}else{if("datastale"===u)for(let m=0;m<e.length;m++)e[m].status=3===e[m].status?4:0;else{ho("transaction at "+c.toString()+" failed: "+u);for(let m=0;m<e.length;m++)e[m].status=4,e[m].abortReason=u}Bx(n,t)}},o)}(n,Sk(t),e)}else PQ(t)&&LP(t,e=>{UP(n,e)})}function Bx(n,t){const e=YQ(n,t),r=Sk(e);return function xye(n,t,e){if(0===t.length)return;const r=[];let i=[];const o=t.filter(l=>0===l.status).map(l=>l.currentWriteId);for(let l=0;l<t.length;l++){const c=t[l],u=Yt(e,c.path);let m,f=!1;if((0,W.hu)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)f=!0,m=c.abortReason,i=i.concat(gg(n.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)f=!0,m="maxretry",i=i.concat(gg(n.serverSyncTree_,c.currentWriteId,!0));else{const _=qH(n,c.path,o);c.currentInputSnapshot=_;const y=t[l].update(_.val());if(void 0!==y){Dk("transaction failed: Data returned ",y,c.path);let w=Vi(y);"object"==typeof y&&null!=y&&(0,W.r3)(y,".priority")||(w=w.updatePriority(_.getPriority()));const I=c.currentWriteId,E=Nk(n),A=LH(w,_,E);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=A,c.currentWriteId=VP(n),o.splice(o.indexOf(I),1),i=i.concat(AH(n.serverSyncTree_,c.path,A,c.currentWriteId,c.applyLocally)),i=i.concat(gg(n.serverSyncTree_,I,!0))}else f=!0,m="nodata",i=i.concat(gg(n.serverSyncTree_,c.currentWriteId,!0))}ic(n.eventQueue_,e,i),i=[],f&&(t[l].status=2,setTimeout(t[l].unwatcher,Math.floor(0)),t[l].onComplete&&r.push("nodata"===m?()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot):()=>t[l].onComplete(new Error(m),!1,null)))}zP(n,n.transactionQueueTree_);for(let l=0;l<r.length;l++)ug(r[l]);UP(n,n.transactionQueueTree_)}(n,KQ(n,e),r),r}function YQ(n,t){let e,r=n.transactionQueueTree_;for(e=F(t);null!==e&&void 0===Kv(r);)r=PP(r,e),e=F(t=Y(t));return r}function KQ(n,t){const e=[];return QQ(n,t,e),e.sort((r,i)=>r.order-i.order),e}function QQ(n,t,e){const r=Kv(t);if(r)for(let i=0;i<r.length;i++)e.push(r[i]);LP(t,i=>{QQ(n,i,e)})}function zP(n,t){const e=Kv(t);if(e){let r=0;for(let i=0;i<e.length;i++)2!==e[i].status&&(e[r]=e[i],r++);e.length=r,VH(t,e.length>0?e:void 0)}LP(t,r=>{zP(n,r)})}function ZH(n,t){const e=Sk(YQ(n,t)),r=PP(n.transactionQueueTree_,t);return function eye(n,t,e){let r=e?n:n.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,i=>{YH(n,i)}),YH(n,r),LQ(r,i=>{YH(n,i)}),e}function YH(n,t){const e=Kv(t);if(e){const r=[];let i=[],s=-1;for(let o=0;o<e.length;o++)3===e[o].status||(1===e[o].status?((0,W.hu)(s===o-1,"All SENT items should be at beginning of queue."),s=o,e[o].status=3,e[o].abortReason="set"):((0,W.hu)(0===e[o].status,"Unexpected transaction status in abort"),e[o].unwatcher(),i=i.concat(gg(n.serverSyncTree_,e[o].currentWriteId,!0)),e[o].onComplete&&r.push(e[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?VH(t,void 0):e.length=s+1,ic(n.eventQueue_,Sk(t),i);for(let o=0;o<r.length;o++)ug(r[o])}}const KH=function(n,t){const e=Sye(n),r=e.namespace;return"firebase.com"===e.domain&&Uc(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==e.domain&&Uc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ho("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Gu(e.host,e.secure,r,"ws"===e.scheme||"wss"===e.scheme,t,"",r!==e.subdomain),path:new N(e.pathString)}},Sye=function(n){let t="",e="",r="",i="",s="",o=!0,l="https",c=443;if("string"==typeof n){let u=n.indexOf("//");u>=0&&(l=n.substring(0,u-1),n=n.substring(u+2));let f=n.indexOf("/");-1===f&&(f=n.length);let m=n.indexOf("?");-1===m&&(m=n.length),t=n.substring(0,Math.min(f,m)),f<m&&(i=function Iye(n){let t="";const e=n.split("/");for(let r=0;r<e.length;r++)if(e[r].length>0){let i=e[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}t+="/"+i}return t}(n.substring(f,m)));const _=function Tye(n){const t={};"?"===n.charAt(0)&&(n=n.substring(1));for(const e of n.split("&")){if(0===e.length)continue;const r=e.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ho(`Invalid query segment '${e}' in query '${n}'`)}return t}(n.substring(Math.min(n.length,m)));u=t.indexOf(":"),u>=0?(o="https"===l||"wss"===l,c=parseInt(t.substring(u+1),10)):u=t.length;const y=t.slice(0,u);if("localhost"===y.toLowerCase())e="localhost";else if(y.split(".").length<=2)e=y;else{const w=t.indexOf(".");r=t.substring(0,w).toLowerCase(),e=t.substring(w+1),s=r}"ns"in _&&(s=_.ns)}return{host:t,port:c,domain:e,subdomain:r,secure:o,scheme:l,pathString:i,namespace:s}},XQ="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Eye=function(){let n=0;const t=[];return function(e){const r=e===n;let i;n=e;const s=new Array(8);for(i=7;i>=0;i--)s[i]=XQ.charAt(e%64),e=Math.floor(e/64);(0,W.hu)(0===e,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=XQ.charAt(t[i]);return(0,W.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();class JQ{constructor(t,e,r,i){this.eventType=t,this.eventRegistration=e,this.snapshot=r,this.prevName=i}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,W.Wl)(this.snapshot.exportVal())}}class eX{constructor(t,e,r){this.eventRegistration=t,this.error=e,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class QH{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return(0,W.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class tX{constructor(t,e){this._repo=t,this._path=e}cancel(){const t=new W.BH;return gye(this._repo,this._path,t.wrapCallback(()=>{})),t.promise}remove(){Wc("OnDisconnect.remove",this._path);const t=new W.BH;return qQ(this._repo,this._path,null,t.wrapCallback(()=>{})),t.promise}set(t){Wc("OnDisconnect.set",this._path),eh("OnDisconnect.set",t,this._path,!1);const e=new W.BH;return qQ(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}setWithPriority(t,e){Wc("OnDisconnect.setWithPriority",this._path),eh("OnDisconnect.setWithPriority",t,this._path,!1),HH("OnDisconnect.setWithPriority",e,!1);const r=new W.BH;return function _ye(n,t,e,r,i){const s=Vi(e,r);n.server_.onDisconnectPut(t.toString(),s.val(!0),(o,l)=>{"ok"===o&&Ox(n.onDisconnect_,t,s),_g(0,i,o,l)})}(this._repo,this._path,t,e,r.wrapCallback(()=>{})),r.promise}update(t){Wc("OnDisconnect.update",this._path),BQ("OnDisconnect.update",t,this._path,!1);const e=new W.BH;return function yye(n,t,e,r){if((0,W.xb)(e))return zs("onDisconnect().update() called with empty data.  Don't do anything."),void _g(0,r,"ok",void 0);n.server_.onDisconnectMerge(t.toString(),e,(i,s)=>{"ok"===i&&ds(e,(o,l)=>{const c=Vi(l);Ox(n.onDisconnect_,mt(t,o),c)}),_g(0,r,i,s)})}(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}}class wl{constructor(t,e,r,i){this._repo=t,this._path=e,this._queryParams=r,this._orderByCalled=i}get key(){return gt(this._path)?null:de(this._path)}get ref(){return new jc(this._repo,this._path)}get _queryIdentifier(){const t=sQ(this._queryParams),e=Cx(t);return"{}"===e?"default":e}get _queryObject(){return sQ(this._queryParams)}isEqual(t){if(!((t=(0,W.m9)(t))instanceof wl))return!1;const e=this._repo===t._repo,r=Cn(this._path,t._path);return e&&r&&this._queryIdentifier===t._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function De(n){let t="";for(let e=n.pieceNum_;e<n.pieces_.length;e++)""!==n.pieces_[e]&&(t+="/"+encodeURIComponent(String(n.pieces_[e])));return t||"/"}(this._path)}}function HP(n,t){if(!0===n._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function yg(n){let t=null,e=null;if(n.hasStart()&&(t=n.getIndexStartValue()),n.hasEnd()&&(e=n.getIndexEndValue()),n.getIndex()===Jd){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Xd)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==zc)throw new Error(r);if("string"!=typeof e)throw new Error(i)}}else if(n.getIndex()===ci){if(null!=t&&!Ek(t)||null!=e&&!Ek(e))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,W.hu)(n.getIndex()instanceof uH||n.getIndex()===dH,"unknown index type."),null!=t&&"object"==typeof t||null!=e&&"object"==typeof e)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function GP(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class jc extends wl{constructor(t,e){super(t,e,new vP,!1)}get parent(){const t=Tt(this._path);return null===t?null:new jc(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class Qv{constructor(t,e,r){this._node=t,this.ref=e,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new N(t),r=Xv(this.ref,t);return new Qv(this._node.getChild(e),r,ci)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>t(new Qv(i,Xv(this.ref,r),ci)))}hasChild(t){const e=new N(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function nX(n,t){return(n=(0,W.m9)(n))._checkNotDeleted("ref"),void 0!==t?Xv(n._root,t):n._root}function rX(n,t){(n=(0,W.m9)(n))._checkNotDeleted("refFromURL");const e=KH(t,n._repo.repoInfo_.nodeAdmin);VQ("refFromURL",e);const r=e.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Uc("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),nX(n,e.path.toString())}function Xv(n,t){return null===F((n=(0,W.m9)(n))._path)?(e=t,e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Ak("child","path",e,!1)):Ak("child","path",t,!1),new jc(n._repo,mt(n._path,t));var e}function XH(n,t){n=(0,W.m9)(n),Wc("set",n._path),eh("set",t,n._path,!1);const e=new W.BH;return WH(n._repo,n._path,t,null,e.wrapCallback(()=>{})),e.promise}function Rye(n,t){BQ("update",t,n._path,!1);const e=new W.BH;return function pye(n,t,e,r){$x(n,"update",{path:t.toString(),value:e});let i=!0;const s=Nk(n),o={};if(ds(e,(l,c)=>{i=!1,o[l]=FQ(mt(t,l),Vi(c),n.serverSyncTree_,s)}),i)zs("update() called with empty data.  Don't do anything."),_g(0,r,"ok",void 0);else{const l=VP(n),c=function V_e(n,t,e,r){!function r_e(n,t,e,r){(0,W.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:t,children:e,writeId:r,visible:!0}),n.visibleWrites=wH(n.visibleWrites,t,e),n.lastWriteId=r}(n.pendingWriteTree_,t,e,r);const i=ui.fromObject(e);return Lx(n,new Fx({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}(n.serverSyncTree_,t,o,l);BP(n.eventQueue_,c),n.server_.merge(t.toString(),e,(u,f)=>{const m="ok"===u;m||ho("update at "+t+" failed: "+u);const _=gg(n.serverSyncTree_,l,!m),y=_.length>0?Bx(n,t):t;ic(n.eventQueue_,y,_),_g(0,r,u,f)}),ds(e,u=>{const f=ZH(n,mt(t,u));Bx(n,f)}),ic(n.eventQueue_,t,[])}}(n._repo,n._path,t,e.wrapCallback(()=>{})),e.promise}function Mye(n){n=(0,W.m9)(n);const t=new QH(()=>{}),e=new Rk(t);return function fye(n,t,e){const r=function W_e(n,t){const e=t._path;let r=null;n.syncPointTree_.foreachOnPath(e,(u,f)=>{const m=Yt(u,e);r=r||pg(f,m)});let i=n.syncPointTree_.get(e);i?r=r||pg(i,R()):(i=new IQ,n.syncPointTree_=n.syncPointTree_.set(e,i));const s=null!=r,o=s?new hg(r,!0,!1):null;return function D_e(n){return TP(n.viewCache_)}(TQ(i,t,SP(n.pendingWriteTree_,t._path),s?o.getNode():Hn.EMPTY_NODE,s))}(n.serverSyncTree_,t);return null!=r?Promise.resolve(r):n.server_.get(t).then(i=>{const s=Vi(i).withIndex(t._queryParams.getIndex());let o;if(NH(n.serverSyncTree_,t,e,!0),t._queryParams.loadsAllData())o=xk(n.serverSyncTree_,t._path,s);else{const l=Ik(n.serverSyncTree_,t);o=AQ(n.serverSyncTree_,t._path,s,l)}return ic(n.eventQueue_,t._path,o),MP(n.serverSyncTree_,t,e,null,!0),s},i=>($x(n,"get for query "+(0,W.Wl)(t)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,e).then(r=>new Qv(r,new jc(n._repo,n._path),n._queryParams.getIndex()))}class Rk{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const r=e._queryParams.getIndex();return new JQ("value",this,new Qv(t.snapshotNode,new jc(e._repo,e._path),r))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new eX(this,t,e):null}matches(t){return t instanceof Rk&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class WP{constructor(t,e){this.eventType=t,this.callbackContext=e}respondsTo(t){let e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new eX(this,t,e):null}createEvent(t,e){(0,W.hu)(null!=t.childName,"Child events should have a childName.");const r=Xv(new jc(e._repo,e._path),t.childName),i=e._queryParams.getIndex();return new JQ(t.type,this,new Qv(t.snapshotNode,r,i),t.prevName)}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof WP&&this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Mk(n,t,e,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const c=e,u=(f,m)=>{jH(n._repo,n,l),c(f,m)};u.userCallback=e.userCallback,u.context=e.context,e=u}const o=new QH(e,s||void 0),l="value"===t?new Rk(o):new WP(t,o);return function vye(n,t,e){let r;r=".info"===F(t._path)?NH(n.infoSyncTree_,t,e):NH(n.serverSyncTree_,t,e),UQ(n.eventQueue_,t._path,r)}(n._repo,n,l),()=>jH(n._repo,n,l)}function JH(n,t,e,r){return Mk(n,"value",t,e,r)}function iX(n,t,e,r){return Mk(n,"child_added",t,e,r)}function sX(n,t,e,r){return Mk(n,"child_changed",t,e,r)}function oX(n,t,e,r){return Mk(n,"child_moved",t,e,r)}function aX(n,t,e,r){return Mk(n,"child_removed",t,e,r)}function lX(n,t,e){let r=null;const i=e?new QH(e):null;"value"===t?r=new Rk(i):t&&(r=new WP(t,i)),jH(n._repo,n,r)}class Zu{}class cX extends Zu{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){eh("endAt",this._value,t._path,!0);const e=pH(t._queryParams,this._value,this._key);if(GP(e),yg(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new wl(t._repo,t._path,e,t._orderByCalled)}}class Fye extends Zu{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){eh("endBefore",this._value,t._path,!1);const e=function Gge(n,t,e){let r;return r=pH(n,t,n.index_===Jd||e?e:Xd),r.endBeforeSet_=!0,r}(t._queryParams,this._value,this._key);if(GP(e),yg(e),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new wl(t._repo,t._path,e,t._orderByCalled)}}class uX extends Zu{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){eh("startAt",this._value,t._path,!0);const e=fH(t._queryParams,this._value,this._key);if(GP(e),yg(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new wl(t._repo,t._path,e,t._orderByCalled)}}class $ye extends Zu{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){eh("startAfter",this._value,t._path,!1);const e=function Hge(n,t,e){let r;return r=fH(n,t,n.index_===Jd||e?e:zc),r.startAfterSet_=!0,r}(t._queryParams,this._value,this._key);if(GP(e),yg(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new wl(t._repo,t._path,e,t._orderByCalled)}}class Vye extends Zu{constructor(t){super(),this._limit=t}_apply(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new wl(t._repo,t._path,function Uge(n,t){const e=n.copy();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="l",e}(t._queryParams,this._limit),t._orderByCalled)}}class zye extends Zu{constructor(t){super(),this._limit=t}_apply(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new wl(t._repo,t._path,function zge(n,t){const e=n.copy();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="r",e}(t._queryParams,this._limit),t._orderByCalled)}}class Gye extends Zu{constructor(t){super(),this._path=t}_apply(t){HP(t,"orderByChild");const e=new N(this._path);if(gt(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new uH(e),i=bP(t._queryParams,r);return yg(i),new wl(t._repo,t._path,i,!0)}}class jye extends Zu{_apply(t){HP(t,"orderByKey");const e=bP(t._queryParams,Jd);return yg(e),new wl(t._repo,t._path,e,!0)}}class Zye extends Zu{_apply(t){HP(t,"orderByPriority");const e=bP(t._queryParams,ci);return yg(e),new wl(t._repo,t._path,e,!0)}}class Kye extends Zu{_apply(t){HP(t,"orderByValue");const e=bP(t._queryParams,dH);return yg(e),new wl(t._repo,t._path,e,!0)}}class Xye extends Zu{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){if(eh("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new cX(this._value,this._key)._apply(new uX(this._value,this._key)._apply(t))}}function Yu(n,...t){let e=(0,W.m9)(n);for(const r of t)e=r._apply(e);return e}(function R_e(n){(0,W.hu)(!AP,"__referenceConstructor has already been defined"),AP=n})(jc),function L_e(n){(0,W.hu)(!RP,"__referenceConstructor has already been defined"),RP=n}(jc);const eG={};function hX(n,t,e,r,i){let s=r||n.options.databaseURL;void 0===s&&(n.options.projectId||Uc("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),zs("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c,u,o=KH(s,i),l=o.repoInfo;typeof process<"u"&&process.env&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(c=!0,s=`http://${u}?ns=${l.namespace}`,o=KH(s,i),l=o.repoInfo):c=!o.repoInfo.secure;const f=i&&c?new Uv(Uv.OWNER):new H4(n.name,n.options,t);VQ("Invalid Firebase Database URL",o),gt(o.path)||Uc("Database URL must point to the root of a Firebase Database (not including a child path).");const m=function rve(n,t,e,r){let i=eG[t.name];i||(i={},eG[t.name]=i);let s=i[n.toURLString()];return s&&Uc("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new uye(n,false,e,r),i[n.toURLString()]=s,s}(l,n,f,new eP(n.name,e));return new sve(m,n)}class sve{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function dye(n,t,e){if(n.stats_=Gv(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new wP(n.repoInfo_,(r,i,s,o)=>{WQ(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>jQ(n,!0),0);else{if(typeof e<"u"&&null!==e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,W.Wl)(e)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new jv(n.repoInfo_,t,(r,i,s,o)=>{WQ(n,r,i,s,o)},r=>{jQ(n,r)},r=>{!function hye(n,t){ds(t,(e,r)=>{GH(n,e,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,e),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function Dx(n,t){const e=n.toString();return Hv[e]||(Hv[e]=t()),Hv[e]}(n.repoInfo_,()=>new Kge(n.stats_,n.server_)),n.infoData_=new Wge,n.infoSyncTree_=new kQ({startListening:(r,i,s,o)=>{let l=[];const c=n.infoData_.getNode(r._path);return c.isEmpty()||(l=xk(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),GH(n,"connected",!1),n.serverSyncTree_=new kQ({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(l,c)=>{const u=o(l,c);ic(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new jc(this._repo,R())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function nve(n,t){const e=eG[t];(!e||e[n.key]!==n)&&Uc(`Database ${t}(${n.repoInfo_}) has already been deleted.`),ZQ(n),delete e[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&Uc("Cannot call "+t+" on a deleted database.")}}function fX(){fP.IS_TRANSPORT_INITIALIZED&&ho("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function ove(){fX(),Hc.forceDisallow()}function ave(){fX(),dg.forceDisallow(),Hc.forceAllow()}function uve(n,t){qF(n,t)}const hve={".sv":"timestamp"};class mve{constructor(t,e){this.committed=t,this.snapshot=e}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}jv.prototype.simpleListen=function(n,t){this.sendRequest("q",{p:n},t)},jv.prototype.echo=function(n,t){this.sendRequest("echo",{d:n},t)},function dve(n){YD(An.SDK_VERSION),(0,An._registerComponent)(new us.wA("database",(t,{instanceIdentifier:e})=>hX(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e),"PUBLIC").setMultipleInstances(!0)),(0,An.registerVersion)(WF,"0.14.4",n),(0,An.registerVersion)(WF,"0.14.4","esm2017")}();const vve=new $o.Yd("@firebase/database-compat"),mX=function(n){vve.warn("FIREBASE WARNING: "+n)};class Cve{constructor(t){this._delegate=t}cancel(t){(0,W.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,W.Wj)("OnDisconnect.cancel","onComplete",t,!0);const e=this._delegate.cancel();return t&&e.then(()=>t(null),r=>t(r)),e}remove(t){(0,W.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,W.Wj)("OnDisconnect.remove","onComplete",t,!0);const e=this._delegate.remove();return t&&e.then(()=>t(null),r=>t(r)),e}set(t,e){(0,W.Dv)("OnDisconnect.set",1,2,arguments.length),(0,W.Wj)("OnDisconnect.set","onComplete",e,!0);const r=this._delegate.set(t);return e&&r.then(()=>e(null),i=>e(i)),r}setWithPriority(t,e,r){(0,W.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,W.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(t,e);return r&&i.then(()=>r(null),s=>r(s)),i}update(t,e){if((0,W.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){const i={};for(let s=0;s<t.length;++s)i[""+s]=t[s];t=i,mX("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,W.Wj)("OnDisconnect.update","onComplete",e,!0);const r=this._delegate.update(t);return e&&r.then(()=>e(null),i=>e(i)),r}}class xve{constructor(t,e){this.committed=t,this.snapshot=e}toJSON(){return(0,W.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class vg{constructor(t,e){this._database=t,this._delegate=e}val(){return(0,W.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,W.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,W.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,W.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(t){return(0,W.Dv)("DataSnapshot.child",0,1,arguments.length),t=String(t),Ak("DataSnapshot.child","path",t,!1),new vg(this._database,this._delegate.child(t))}hasChild(t){return(0,W.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Ak("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)}getPriority(){return(0,W.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(t){return(0,W.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,W.Wj)("DataSnapshot.forEach","action",t,!1),this._delegate.forEach(e=>t(new vg(this._database,e)))}hasChildren(){return(0,W.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,W.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,W.Dv)("DataSnapshot.ref",0,0,arguments.length),new sc(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Uo{constructor(t,e){this.database=t,this._delegate=e}on(t,e,r,i){var s;(0,W.Dv)("Query.on",2,4,arguments.length),(0,W.Wj)("Query.on","callback",e,!1);const o=Uo.getCancelAndContextArgs_("Query.on",r,i),l=(u,f)=>{e.call(o.context,new vg(this.database,u),f)};l.userCallback=e,l.context=o.context;const c=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(t){case"value":return JH(this._delegate,l,c),e;case"child_added":return iX(this._delegate,l,c),e;case"child_removed":return aX(this._delegate,l,c),e;case"child_changed":return sX(this._delegate,l,c),e;case"child_moved":return oX(this._delegate,l,c),e;default:throw new Error((0,W.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(t,e,r){if((0,W.Dv)("Query.off",0,3,arguments.length),function(n,t,e){if(void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,W.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,t),(0,W.Wj)("Query.off","callback",e,!0),(0,W.lb)("Query.off","context",r,!0),e){const i=()=>{};i.userCallback=e,i.context=r,lX(this._delegate,t,i)}else lX(this._delegate,t)}get(){return Mye(this._delegate).then(t=>new vg(this.database,t))}once(t,e,r,i){(0,W.Dv)("Query.once",1,4,arguments.length),(0,W.Wj)("Query.once","callback",e,!0);const s=Uo.getCancelAndContextArgs_("Query.once",r,i),o=new W.BH,l=(u,f)=>{const m=new vg(this.database,u);e&&e.call(s.context,m,f),o.resolve(m)};l.userCallback=e,l.context=s.context;const c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(t){case"value":JH(this._delegate,l,c,{onlyOnce:!0});break;case"child_added":iX(this._delegate,l,c,{onlyOnce:!0});break;case"child_removed":aX(this._delegate,l,c,{onlyOnce:!0});break;case"child_changed":sX(this._delegate,l,c,{onlyOnce:!0});break;case"child_moved":oX(this._delegate,l,c,{onlyOnce:!0});break;default:throw new Error((0,W.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(t){return(0,W.Dv)("Query.limitToFirst",1,1,arguments.length),new Uo(this.database,Yu(this._delegate,function Uye(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Vye(n)}(t)))}limitToLast(t){return(0,W.Dv)("Query.limitToLast",1,1,arguments.length),new Uo(this.database,Yu(this._delegate,function Hye(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new zye(n)}(t)))}orderByChild(t){return(0,W.Dv)("Query.orderByChild",1,1,arguments.length),new Uo(this.database,Yu(this._delegate,function Wye(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Ak("orderByChild","path",n,!1),new Gye(n)}(t)))}orderByKey(){return(0,W.Dv)("Query.orderByKey",0,0,arguments.length),new Uo(this.database,Yu(this._delegate,function qye(){return new jye}()))}orderByPriority(){return(0,W.Dv)("Query.orderByPriority",0,0,arguments.length),new Uo(this.database,Yu(this._delegate,function Yye(){return new Zye}()))}orderByValue(){return(0,W.Dv)("Query.orderByValue",0,0,arguments.length),new Uo(this.database,Yu(this._delegate,function Qye(){return new Kye}()))}startAt(t=null,e){return(0,W.Dv)("Query.startAt",0,2,arguments.length),new Uo(this.database,Yu(this._delegate,function Lye(n=null,t){return kk("startAt","key",t,!0),new uX(n,t)}(t,e)))}startAfter(t=null,e){return(0,W.Dv)("Query.startAfter",0,2,arguments.length),new Uo(this.database,Yu(this._delegate,function Bye(n,t){return kk("startAfter","key",t,!0),new $ye(n,t)}(t,e)))}endAt(t=null,e){return(0,W.Dv)("Query.endAt",0,2,arguments.length),new Uo(this.database,Yu(this._delegate,function Oye(n,t){return kk("endAt","key",t,!0),new cX(n,t)}(t,e)))}endBefore(t=null,e){return(0,W.Dv)("Query.endBefore",0,2,arguments.length),new Uo(this.database,Yu(this._delegate,function Pye(n,t){return kk("endBefore","key",t,!0),new Fye(n,t)}(t,e)))}equalTo(t,e){return(0,W.Dv)("Query.equalTo",1,2,arguments.length),new Uo(this.database,Yu(this._delegate,function Jye(n,t){return kk("equalTo","key",t,!0),new Xye(n,t)}(t,e)))}toString(){return(0,W.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,W.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(t){if((0,W.Dv)("Query.isEqual",1,1,arguments.length),!(t instanceof Uo))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(t._delegate)}static getCancelAndContextArgs_(t,e,r){const i={cancel:void 0,context:void 0};if(e&&r)i.cancel=e,(0,W.Wj)(t,"cancel",i.cancel,!0),i.context=r,(0,W.lb)(t,"context",i.context,!0);else if(e)if("object"==typeof e&&null!==e)i.context=e;else{if("function"!=typeof e)throw new Error((0,W.gK)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=e}return i}get ref(){return new sc(this.database,new jc(this._delegate._repo,this._delegate._path))}}class sc extends Uo{constructor(t,e){super(t,new wl(e._repo,e._path,new vP,!1)),this.database=t,this._delegate=e}getKey(){return(0,W.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(t){return(0,W.Dv)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new sc(this.database,Xv(this._delegate,t))}getParent(){(0,W.Dv)("Reference.parent",0,0,arguments.length);const t=this._delegate.parent;return t?new sc(this.database,t):null}getRoot(){return(0,W.Dv)("Reference.root",0,0,arguments.length),new sc(this.database,this._delegate.root)}set(t,e){(0,W.Dv)("Reference.set",1,2,arguments.length),(0,W.Wj)("Reference.set","onComplete",e,!0);const r=XH(this._delegate,t);return e&&r.then(()=>e(null),i=>e(i)),r}update(t,e){if((0,W.Dv)("Reference.update",1,2,arguments.length),Array.isArray(t)){const i={};for(let s=0;s<t.length;++s)i[""+s]=t[s];t=i,mX("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Wc("Reference.update",this._delegate._path),(0,W.Wj)("Reference.update","onComplete",e,!0);const r=Rye(this._delegate,t);return e&&r.then(()=>e(null),i=>e(i)),r}setWithPriority(t,e,r){(0,W.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,W.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function Nye(n,t,e){if(Wc("setWithPriority",n._path),eh("setWithPriority",t,n._path,!1),HH("setWithPriority",e,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new W.BH;return WH(n._repo,n._path,t,e,r.wrapCallback(()=>{})),r.promise}(this._delegate,t,e);return r&&i.then(()=>r(null),s=>r(s)),i}remove(t){(0,W.Dv)("Reference.remove",0,1,arguments.length),(0,W.Wj)("Reference.remove","onComplete",t,!0);const e=function kye(n){return Wc("remove",n._path),XH(n,null)}(this._delegate);return t&&e.then(()=>t(null),r=>t(r)),e}transaction(t,e,r){(0,W.Dv)("Reference.transaction",1,3,arguments.length),(0,W.Wj)("Reference.transaction","transactionUpdate",t,!1),(0,W.Wj)("Reference.transaction","onComplete",e,!0),function(n,t,e,r){if(void 0!==e&&"boolean"!=typeof e)throw new Error((0,W.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function gve(n,t,e){var r;if(n=(0,W.m9)(n),Wc("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=e?.applyLocally)||void 0===r||r,s=new W.BH,l=JH(n,()=>{});return function wye(n,t,e,r,i,s){$x(n,"transaction on "+t);const o={path:t,update:e,onComplete:r,status:null,order:wx(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=qH(n,t,void 0);o.currentInputSnapshot=l;const c=o.update(l.val());if(void 0===c)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Dk("transaction failed: Data returned ",c,o.path),o.status=0;const u=PP(n.transactionQueueTree_,t),f=Kv(u)||[];let m;f.push(o),VH(u,f),"object"==typeof c&&null!==c&&(0,W.r3)(c,".priority")?(m=(0,W.DV)(c,".priority"),(0,W.hu)(Ek(m),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):m=(OP(n.serverSyncTree_,t)||Hn.EMPTY_NODE).getPriority().val();const _=Nk(n),y=Vi(c,m),w=LH(y,l,_);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=w,o.currentWriteId=VP(n);const T=AH(n.serverSyncTree_,t,w,o.currentWriteId,o.applyLocally);ic(n.eventQueue_,t,T),UP(n,n.transactionQueueTree_)}}(n._repo,n._path,t,(c,u,f)=>{let m=null;c?s.reject(c):(m=new Qv(f,new jc(n._repo,n._path),ci),s.resolve(new mve(u,m)))},l,i),s.promise}(this._delegate,t,{applyLocally:r}).then(s=>new xve(s.committed,new vg(this.database,s.snapshot)));return e&&i.then(s=>e(null,s.committed,s.snapshot),s=>e(s,!1,null)),i}setPriority(t,e){(0,W.Dv)("Reference.setPriority",1,2,arguments.length),(0,W.Wj)("Reference.setPriority","onComplete",e,!0);const r=function Aye(n,t){n=(0,W.m9)(n),Wc("setPriority",n._path),HH("setPriority",t,!1);const e=new W.BH;return WH(n._repo,mt(n._path,".priority"),t,null,e.wrapCallback(()=>{})),e.promise}(this._delegate,t);return e&&r.then(()=>e(null),i=>e(i)),r}push(t,e){(0,W.Dv)("Reference.push",0,2,arguments.length),(0,W.Wj)("Reference.push","onComplete",e,!0);const r=function Dye(n,t){n=(0,W.m9)(n),Wc("push",n._path),eh("push",t,n._path,!0);const e=GQ(n._repo),r=Eye(e),i=Xv(n,r),s=Xv(n,r);let o;return o=null!=t?XH(s,t).then(()=>s):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,t),i=r.then(o=>new sc(this.database,o));e&&i.then(()=>e(null),o=>e(o));const s=new sc(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Wc("Reference.onDisconnect",this._delegate._path),new Cve(new tX(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Ok{constructor(t,e){this._delegate=t,this.app=e,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:ove,forceLongPolling:ave}}useEmulator(t,e,r={}){!function pX(n,t,e,r={}){(n=(0,W.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Uc("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Uc('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Uv(Uv.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:(0,W.Sg)(r.mockUserToken,n.app.options.projectId);s=new Uv(o)}!function tve(n,t,e,r){n.repoInfo_=new Gu(`${t}:${e}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}(i,t,e,s)}(this._delegate,t,e,r)}ref(t){if((0,W.Dv)("database.ref",0,1,arguments.length),t instanceof sc){const e=rX(this._delegate,t.toString());return new sc(this,e)}{const e=nX(this._delegate,t);return new sc(this,e)}}refFromURL(t){(0,W.Dv)("database.refFromURL",1,1,arguments.length);const r=rX(this._delegate,t);return new sc(this,r)}goOffline(){return(0,W.Dv)("database.goOffline",0,0,arguments.length),function lve(n){(n=(0,W.m9)(n))._checkNotDeleted("goOffline"),ZQ(n._repo)}(this._delegate)}goOnline(){return(0,W.Dv)("database.goOnline",0,0,arguments.length),function cve(n){(n=(0,W.m9)(n))._checkNotDeleted("goOnline"),function bye(n){n.persistentConnection_&&n.persistentConnection_.resume(HQ)}(n._repo)}(this._delegate)}}Ok.ServerValue={TIMESTAMP:function fve(){return hve}(),increment:n=>function pve(n){return{".sv":{increment:n}}}(n)};var Tve=Object.freeze({__proto__:null,initStandalone:function Ive({app:n,url:t,version:e,customAuthImpl:r,namespace:i,nodeAdmin:s=!1}){YD(e);const o=new us.zt("auth-internal",new us.H0("database-standalone"));return o.setComponent(new us.wA("auth-internal",()=>r,"PRIVATE")),{instance:new Ok(hX(n,o,void 0,t,s),n),namespace:i}}});const Sve=Ok.ServerValue;!function Eve(n){n.INTERNAL.registerComponent(new us.wA("database-compat",(t,{instanceIdentifier:e})=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("database").getImmediate({identifier:e});return new Ok(i,r)},"PUBLIC").setServiceProps({Reference:sc,Query:Uo,Database:Ok,DataSnapshot:vg,enableLogging:uve,INTERNAL:Tve,ServerValue:Sve}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.3.4")}(ZD.Z);var Xt=z(7579);class Dve extends Xt.x{constructor(t=1/0,e=1/0,r=yC){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;e||(r.push(t),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!t.closed;o+=r?1:2)t.next(s[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*t;if(t<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=e.now();let l=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)l=c;l&&r.splice(0,l+1)}}}function gX(n,t,e){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:t=1/0,refCount:i=!1,scheduler:e}=n):r=n??1/0,(0,Gm.B)({connector:()=>new Dve(r,t,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}const jP=(0,z(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var Ga=z(515);function nr(n){return n<=0?()=>Ga.E:(0,ti.e)((t,e)=>{let r=0;t.subscribe((0,zr.x)(e,i=>{++r<=n&&(e.next(i),n<=r&&e.complete())}))})}function qP(n){return(0,ti.e)((t,e)=>{let r=!1;t.subscribe((0,zr.x)(e,i=>{r=!0,e.next(i)},()=>{r||e.next(n),e.complete()}))})}function _X(n=Ave){return(0,ti.e)((t,e)=>{let r=!1;t.subscribe((0,zr.x)(e,i=>{r=!0,e.next(i)},()=>r?e.complete():e.error(n())))})}function Ave(){return new jP}function qf(n,t){const e=arguments.length>=2;return r=>r.pipe(n?cr((i,s)=>n(i,s,r)):Pc.y,nr(1),e?qP(t):_X(()=>new jP))}function yX(n,t){return(0,Po.m)(t)?wn(()=>n,t):wn(()=>n)}class ZP{constructor(t){return t}}class vX{constructor(){return(0,An.getApps)()}}const tG=new a.OlP("angularfire2._apps"),Rve={provide:ZP,useFactory:function Nve(n){return n&&1===n.length?n[0]:new ZP((0,An.getApp)())},deps:[[new a.FiY,tG]]},Mve={provide:vX,deps:[[new a.FiY,tG]]};function Ove(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new ZP(r)}}let Fve=(()=>{class n{constructor(e){(0,An.registerVersion)("angularfire",zf.full,"core"),(0,An.registerVersion)("angularfire",zf.full,"app"),(0,An.registerVersion)("angular",a.q4F.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.Lbi))},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[Rve,Mve]}),n})();function Pve(n,...t){return{ngModule:Fve,providers:[{provide:tG,useFactory:Ove(n),multi:!0,deps:[a.R0b,a.zs3,ig,...t]}]}}const Lve=HF(An.initializeApp,!0),nG=new Map,bX={activated:!1,tokenObservers:[]},$ve={initialized:!1,enabled:!1};function Qi(n){return nG.get(n)||Object.assign({},bX)}function YP(){return $ve}const rG="https://content-firebaseappcheck.googleapis.com/v1";class Gve{constructor(t,e,r,i,s){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return(0,q.Z)(function*(){e.stop();try{e.pending=new W.BH,yield function Wve(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new W.BH,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(r){e.retryPolicy(r)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const zo=new W.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function KP(n=!1){var t;return n?null===(t=self.grecaptcha)||void 0===t?void 0:t.enterprise:self.grecaptcha}function iG(n){if(!Qi(n).activated)throw zo.create("use-before-activation",{appName:n.name})}function sG(n){const t=Math.round(n/1e3),e=Math.floor(t/86400),r=Math.floor((t-3600*e*24)/3600),i=Math.floor((t-3600*e*24-3600*r)/60),s=t-3600*e*24-3600*r-60*i;let o="";return e&&(o+=QP(e)+"d:"),r&&(o+=QP(r)+"h:"),o+=QP(i)+"m:"+QP(s)+"s",o}function QP(n){return 0===n?"00":n>=10?n.toString():"0"+n}function XP(n,t){return oG.apply(this,arguments)}function oG(){return(oG=(0,q.Z)(function*({url:n,body:t},e){const r={"Content-Type":"application/json"},i=e.getImmediate({optional:!0});if(i){const m=yield i.getHeartbeatsHeader();m&&(r["X-Firebase-Client"]=m)}const s={method:"POST",body:JSON.stringify(t),headers:r};let o,l;try{o=yield fetch(n,s)}catch(m){throw zo.create("fetch-network-error",{originalErrorMessage:m?.message})}if(200!==o.status)throw zo.create("fetch-status-error",{httpStatus:o.status});try{l=yield o.json()}catch(m){throw zo.create("fetch-parse-error",{originalErrorMessage:m?.message})}const c=l.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw zo.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});const u=1e3*Number(c[1]),f=Date.now();return{token:l.token,expireTimeMillis:f+u,issuedAtTimeMillis:f}})).apply(this,arguments)}function CX(n,t){const{projectId:e,appId:r,apiKey:i}=n.options;return{url:`${rG}/projects/${e}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:t}}}const Fk="firebase-app-check-store",xX="debug-token";let JP=null;function IX(){return JP||(JP=new Promise((n,t)=>{try{const e=indexedDB.open("firebase-app-check-database",1);e.onsuccess=r=>{n(r.target.result)},e.onerror=r=>{var i;t(zo.create("storage-open",{originalErrorMessage:null===(i=r.target.error)||void 0===i?void 0:i.message}))},e.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(Fk,{keyPath:"compositeKey"})}}catch(e){t(zo.create("storage-open",{originalErrorMessage:e?.message}))}}),JP)}function Qve(n){return SX(EX(n))}function Jve(n){return TX(xX,n)}function ebe(){return SX(xX)}function TX(n,t){return aG.apply(this,arguments)}function aG(){return(aG=(0,q.Z)(function*(n,t){const r=(yield IX()).transaction(Fk,"readwrite"),s=r.objectStore(Fk).put({compositeKey:n,value:t});return new Promise((o,l)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;l(zo.create("storage-set",{originalErrorMessage:null===(u=c.target.error)||void 0===u?void 0:u.message}))}})})).apply(this,arguments)}function SX(n){return lG.apply(this,arguments)}function lG(){return(lG=(0,q.Z)(function*(n){const e=(yield IX()).transaction(Fk,"readonly"),i=e.objectStore(Fk).get(n);return new Promise((s,o)=>{i.onsuccess=l=>{const c=l.target.result;s(c?c.value:void 0)},e.onerror=l=>{var c;o(zo.create("storage-get",{originalErrorMessage:null===(c=l.target.error)||void 0===c?void 0:c.message}))}})})).apply(this,arguments)}function EX(n){return`${n.options.appId}-${n.name}`}const Pk=new $o.Yd("@firebase/app-check");function cG(){return(cG=(0,q.Z)(function*(n){if((0,W.hl)()){let t;try{t=yield Qve(n)}catch(e){Pk.warn(`Failed to read token from IndexedDB. Error: ${e}`)}return t}})).apply(this,arguments)}function uG(n,t){return(0,W.hl)()?function Xve(n,t){return TX(EX(n),t)}(n,t).catch(e=>{Pk.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function dG(){return(dG=(0,q.Z)(function*(){let n;try{n=yield ebe()}catch{}if(n)return n;{const t=(0,W.k$)();return Jve(t).catch(e=>Pk.warn(`Failed to persist debug token to IndexedDB. Error: ${e}`)),t}})).apply(this,arguments)}function hG(){return YP().enabled}function fG(){return pG.apply(this,arguments)}function pG(){return(pG=(0,q.Z)(function*(){const n=YP();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const ibe={error:"UNKNOWN_ERROR"};function sbe(n){return W.US.encodeString(JSON.stringify(n),!1)}function e2(n){return mG.apply(this,arguments)}function mG(){return(mG=(0,q.Z)(function*(n,t=!1){const e=n.app;iG(e);const r=Qi(e);let s,i=r.token;if(i&&!Vx(i)&&(r.token=void 0,i=void 0),!i){const c=yield r.cachedTokenPromise;c&&(Vx(c)?i=c:yield uG(e,void 0))}if(!t&&i&&Vx(i))return{token:i.token};let l,o=!1;if(hG()){r.exchangeTokenPromise||(r.exchangeTokenPromise=XP(CX(e,yield fG()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const c=yield r.exchangeTokenPromise;return yield uG(e,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Qi(e).exchangeTokenPromise}catch(c){"appCheck/throttled"===c.code?Pk.warn(c.message):Pk.error(c),s=c}return i?s?l=Vx(i)?{token:i.token,internalError:s}:NX(s):(l={token:i.token},r.token=i,yield uG(e,i)):l=NX(s),o&&AX(e,l),l})).apply(this,arguments)}function gG(){return(gG=(0,q.Z)(function*(n){const t=n.app;iG(t);const{provider:e}=Qi(t);if(hG()){const r=yield fG(),{token:i}=yield XP(CX(t,r),n.heartbeatServiceProvider);return{token:i}}{const{token:r}=yield e.getToken();return{token:r}}})).apply(this,arguments)}function _G(n,t,e,r){const{app:i}=n,s=Qi(i);if(s.tokenObservers=[...s.tokenObservers,{next:e,error:r,type:t}],s.token&&Vx(s.token)){const l=s.token;Promise.resolve().then(()=>{e({token:l.token}),kX(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>kX(n))}function yG(n,t){const e=Qi(n),r=e.tokenObservers.filter(i=>i.next!==t);0===r.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=r}function kX(n){const{app:t}=n,e=Qi(t);let r=e.tokenRefresher;r||(r=function obe(n){const{app:t}=n;return new Gve((0,q.Z)(function*(){let r;if(r=Qi(t).token?yield e2(n,!0):yield e2(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const e=Qi(t);if(e.token){let r=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,e.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=r),!r.isRunning()&&e.isTokenAutoRefreshEnabled&&r.start()}function AX(n,t){const e=Qi(n).tokenObservers;for(const r of e)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function Vx(n){return n.expireTimeMillis-Date.now()>0}function NX(n){return{token:sbe(ibe),error:n}}class abe{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=Qi(this.app);for(const e of t)yG(this.app,e.next);return Promise.resolve()}}function pbe(n,t){const e=new W.BH;Qi(n).reCAPTCHAState={initialized:e};const i=function RX(n){const t=`fire_app_check_${n.name}`,e=document.createElement("div");return e.id=t,e.style.display="none",document.body.appendChild(e),t}(n),s=KP(!1);return s?t2(n,t,s,i,e):function _be(n){const t=document.createElement("script");t.src="https://www.google.com/recaptcha/api.js",t.onload=n,document.head.appendChild(t)}(()=>{const o=KP(!1);if(!o)throw new Error("no recaptcha");t2(n,t,o,i,e)}),e.promise}function t2(n,t,e,r,i){e.ready(()=>{(function gbe(n,t,e,r){const i=e.render(r,{sitekey:t,size:"invisible",callback:()=>{Qi(n).reCAPTCHAState.succeeded=!0},"error-callback":()=>{Qi(n).reCAPTCHAState.succeeded=!1}}),s=Qi(n);s.reCAPTCHAState=Object.assign(Object.assign({},s.reCAPTCHAState),{widgetId:i})})(n,t,e,r),i.resolve(e)})}function vG(){return(vG=(0,q.Z)(function*(n){iG(n);const e=yield Qi(n).reCAPTCHAState.initialized.promise;return new Promise((r,i)=>{const s=Qi(n).reCAPTCHAState;e.ready(()=>{r(e.execute(s.widgetId,{action:"fire_app_check"}))})})})).apply(this,arguments)}class bG{constructor(t){this._siteKey=t,this._throttleData=null}getToken(){var t=this;return(0,q.Z)(function*(){var e,r,i;!function LX(n){if(n&&Date.now()-n.allowRequestsAfter<=0)throw zo.create("throttled",{time:sG(n.allowRequestsAfter-Date.now()),httpStatus:n.httpStatus})}(t._throttleData);const s=yield function MX(n){return vG.apply(this,arguments)}(t._app).catch(l=>{throw zo.create("recaptcha-error")});if(null===(e=Qi(t._app).reCAPTCHAState)||void 0===e||!e.succeeded)throw zo.create("recaptcha-error");let o;try{o=yield XP(function qve(n,t){const{projectId:e,appId:r,apiKey:i}=n.options;return{url:`${rG}/projects/${e}/apps/${r}:exchangeRecaptchaV3Token?key=${i}`,body:{recaptcha_v3_token:t}}}(t._app,s),t._heartbeatServiceProvider)}catch(l){throw null!==(r=l.code)&&void 0!==r&&r.includes("fetch-status-error")?(t._throttleData=function PX(n,t){if(404===n||403===n)return{backoffCount:1,allowRequestsAfter:Date.now()+864e5,httpStatus:n};{const e=t?t.backoffCount:0,r=(0,W.$s)(e,1e3,2);return{backoffCount:e+1,allowRequestsAfter:Date.now()+r,httpStatus:n}}}(Number(null===(i=l.customData)||void 0===i?void 0:i.httpStatus),t._throttleData),zo.create("throttled",{time:sG(t._throttleData.allowRequestsAfter-Date.now()),httpStatus:t._throttleData.httpStatus})):l}return t._throttleData=null,o})()}initialize(t){this._app=t,this._heartbeatServiceProvider=(0,An._getProvider)(t,"heartbeat"),pbe(t,this._siteKey).catch(()=>{})}isEqual(t){return t instanceof bG&&this._siteKey===t._siteKey}}function vbe(n=(0,An.getApp)(),t){n=(0,W.m9)(n);const e=(0,An._getProvider)(n,"app-check");if(YP().initialized||function rbe(){const n=(0,W.Rd)(),t=YP();if(t.initialized=!0,"string"!=typeof n.FIREBASE_APPCHECK_DEBUG_TOKEN&&!0!==n.FIREBASE_APPCHECK_DEBUG_TOKEN)return;t.enabled=!0;const e=new W.BH;t.token=e,e.resolve("string"==typeof n.FIREBASE_APPCHECK_DEBUG_TOKEN?n.FIREBASE_APPCHECK_DEBUG_TOKEN:function nbe(){return dG.apply(this,arguments)}())}(),hG()&&fG().then(i=>console.log(`App Check debug token: ${i}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),e.isInitialized()){const i=e.getImmediate(),s=e.getOptions();if(s.isTokenAutoRefreshEnabled===t.isTokenAutoRefreshEnabled&&s.provider.isEqual(t.provider))return i;throw zo.create("already-initialized",{appName:n.name})}const r=e.initialize({options:t});return function bbe(n,t,e){const r=function Bve(n,t){return nG.set(n,t),nG.get(n)}(n,Object.assign({},bX));r.activated=!0,r.provider=t,r.cachedTokenPromise=function tbe(n){return cG.apply(this,arguments)}(n).then(i=>(i&&Vx(i)&&(r.token=i,AX(n,{token:i.token})),i)),r.isTokenAutoRefreshEnabled=void 0===e?n.automaticDataCollectionEnabled:e,r.provider.initialize(n)}(n,t.provider,t.isTokenAutoRefreshEnabled),Qi(n).isTokenAutoRefreshEnabled&&_G(r,"INTERNAL",()=>{}),r}const $X="app-check-internal";!function Cbe(){(0,An._registerComponent)(new us.wA("app-check",n=>function lbe(n,t){return new abe(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider($X).initialize()})),(0,An._registerComponent)(new us.wA($X,n=>function cbe(n){return{getToken:t=>e2(n,t),getLimitedUseToken:()=>function DX(n){return gG.apply(this,arguments)}(n),addTokenListener:t=>_G(n,"INTERNAL",t),removeTokenListener:t=>yG(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,An.registerVersion)("@firebase/app-check","0.8.0")}();const BX="app-check";class CG{constructor(t){return t}}class Lk{constructor(){return((n,t)=>{const e=(0,An.getApps)(),r=[];return e.forEach(i=>{i.container.getProvider("app-check").instances.forEach(o=>{r.includes(o)||r.push(o)})}),r})()}}const xG=new a.OlP("angularfire2.app-check-instances"),Ibe=typeof window<"u"&&["localhost","0.0.0.0","127.0.0.1"].includes(window.location.hostname);function Tbe(n){return(t,e,r)=>{var i;!Lh(r)&&((0,a.X6Q)()||Ibe)&&(null!==(i=globalThis.FIREBASE_APPCHECK_DEBUG_TOKEN)&&void 0!==i||(globalThis.FIREBASE_APPCHECK_DEBUG_TOKEN=!0));const s=t.runOutsideAngular(()=>n(e));return new CG(s)}}const Sbe={provide:Lk,deps:[[new a.FiY,xG]]},Ebe={provide:CG,useFactory:function xbe(n,t){const e=function L7(n,t,e){if(t){if(1===t.length)return t[0];const s=t.filter(o=>o.app===e);if(1===s.length)return s[0]}return e.container.getProvider(n).getImmediate({optional:!0})}(BX,n,t);return e&&new CG(e)},deps:[[new a.FiY,xG],ZP,a.Lbi]};let Dbe=(()=>{class n{constructor(){(0,An.registerVersion)("angularfire",zf.full,"app-check")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[Ebe,Sbe]}),n})();function kbe(n,...t){return{ngModule:Dbe,providers:[{provide:xG,useFactory:Tbe(n),multi:!0,deps:[a.R0b,a.zs3,a.Lbi,ig,vX,...t]}]}}const Abe=HF(vbe,!0);var IG=z(9260);const TG=new a.OlP("angularfire2.auth.use-emulator"),SG=new a.OlP("angularfire2.auth.settings"),EG=new a.OlP("angularfire2.auth.tenant-id"),DG=new a.OlP("angularfire2.auth.langugage-code"),kG=new a.OlP("angularfire2.auth.use-device-language"),AG=new a.OlP("angularfire.auth.persistence"),NG=(n,t,e,r,i,s,o,l)=>(0,Ki.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const c=t.runOutsideAngular(()=>n.auth());if(e&&c.useEmulator(...e),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(const[u,f]of Object.entries(o))c.settings[u]=f;return l&&c.setPersistence(l),c},[e,r,i,s,o,l]);let n2=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f,m,_,y){const w=new Xt.x,T=St(void 0).pipe((0,tg.Q)(o.outsideAngular),wn(()=>s.runOutsideAngular(()=>Promise.resolve().then(z.bind(z,2644)))),(0,Ot.U)(()=>(0,Ki.on)(e,s,r)),(0,Ot.U)(I=>NG(I,s,l,u,f,m,c,_)),gX({bufferSize:1,refCount:!1}));if(Lh(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=St(null);else{T.pipe(qf()).subscribe();const E=T.pipe(wn(O=>O.getRedirectResult().then($=>$,()=>null)),wi,gX({bufferSize:1,refCount:!1})),A=T.pipe(wn(O=>new Cr.y($=>({unsubscribe:s.runOutsideAngular(()=>O.onAuthStateChanged(V=>$.next(V),V=>$.error(V),()=>$.complete()))})))),M=T.pipe(wn(O=>new Cr.y($=>({unsubscribe:s.runOutsideAngular(()=>O.onIdTokenChanged(V=>$.next(V),V=>$.error(V),()=>$.complete()))}))));this.authState=E.pipe(yX(A),(0,Uf.R)(o.outsideAngular),(0,tg.Q)(o.insideAngular)),this.user=E.pipe(yX(M),(0,Uf.R)(o.outsideAngular),(0,tg.Q)(o.insideAngular)),this.idToken=this.user.pipe(wn(O=>O?(0,Dn.D)(O.getIdToken()):St(null))),this.idTokenResult=this.user.pipe(wn(O=>O?(0,Dn.D)(O.getIdTokenResult()):St(null))),this.credential=(0,cs.T)(E,w,this.authState.pipe(cr(O=>!O))).pipe((0,Ot.U)(O=>O?.user?O:null),(0,Uf.R)(o.outsideAngular),(0,tg.Q)(o.insideAngular))}return(0,Ki.pX)(this,T,s,{spy:{apply:(I,E,A)=>{(I.startsWith("signIn")||I.startsWith("createUser"))&&A.then(M=>w.next(M))}}})}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Ki.Dh),a.LFG(Ki.xv,8),a.LFG(a.Lbi),a.LFG(a.R0b),a.LFG(ig),a.LFG(TG,8),a.LFG(SG,8),a.LFG(EG,8),a.LFG(DG,8),a.LFG(kG,8),a.LFG(AG,8),a.LFG(Lk,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function VX(n){return null==n}function UX(n){return"function"==typeof n.set}function zX(n,t){return UX(t)?t:n.ref(t)}function HX(n,t){if(function Rbe(n){return"string"==typeof n}(n))return t.stringCase();if(UX(n))return t.firebaseCase();if(function Mbe(n){return"function"==typeof n.exportVal}(n))return t.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function $k(n,t,e="on",r=Fc){return new Cr.y(i=>{let s=null;return s=n[e](t,(o,l)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:l})}),"once"===e&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),"on"===e?{unsubscribe(){null!=s&&n.off(t,s)}}:{unsubscribe(){}}}).pipe((0,Ot.U)(i=>{const{snapshot:s,prevKey:o}=i;let l=null;return s.exists()&&(l=s.key),{type:t,payload:s,prevKey:o,key:l}}),(0,Gm.B)())}function GX(n,t){const e=n.length;for(let r=0;r<e;r++)if(n[r].payload.key===t)return r;return-1}function Pbe(n,t){const{payload:e,prevKey:r,key:i}=t,s=GX(n,i),o=function Fbe(n,t){if(VX(t))return 0;{const e=GX(n,t);return-1===e?n.length:e+1}}(n,r);switch(t.type){case"value":if(t.payload&&t.payload.exists()){let l=null;t.payload.forEach(c=>{const u={payload:c,type:"value",prevKey:l,key:c.key};return l=c.key,n=[...n,u],!1})}return n;case"child_added":if(s>-1){const l=n[s-1];(l&&l.key||null)!==r&&(n=n.filter(c=>c.payload.key!==e.key)).splice(o,0,t)}else{if(null==r)return[t,...n];(n=n.slice()).splice(o,0,t)}return n;case"child_removed":return n.filter(l=>l.payload.key!==e.key);case"child_changed":return n.map(l=>l.payload.key===i?t:l);case"child_moved":if(s>-1){const l=n.splice(s,1)[0];return(n=n.slice()).splice(o,0,l),n}return n;default:return n}}function WX(n){return(VX(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function jX(n,t,e){return function Obe(n,t,e){return $k(n,"value","once",e).pipe(wn(r=>{const i=[St(r)];return t.forEach(s=>i.push($k(n,s,"on",e))),(0,cs.T)(...i).pipe(Ff(Pbe,[]))}),$u())}(n,t=WX(t),e)}function qX(n,t,e){const r=(t=WX(t)).map(i=>$k(n,i,"on",e));return(0,cs.T)(...r)}function ZX(n,t){return function(r,i){return HX(r,{stringCase:()=>n.child(r)[t](i),firebaseCase:()=>r[t](i),snapshotCase:()=>r.ref[t](i)})}}function Vbe(n){return function(e){return e?HX(e,{stringCase:()=>n.child(e).remove(),firebaseCase:()=>e.remove(),snapshotCase:()=>e.ref.remove()}):n.remove()}}function YX(n,t){return function(){return $k(n,"value","on",t)}}const Hbe=new a.OlP("angularfire2.realtimeDatabaseURL"),Gbe=new a.OlP("angularfire2.database.use-emulator");let Wbe=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f,m,_,y,w,T,I){this.schedulers=l;const E=c,A=(0,Ki.on)(e,o,r);u&&NG(A,o,f,_,y,w,m,T),this.database=(0,Ki.cc)(`${A.name}.database.${i}`,"AngularFireDatabase",A.name,()=>{const M=o.runOutsideAngular(()=>A.database(i||void 0));return E&&M.useEmulator(...E),M},[E])}list(e,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>zX(this.database,e));let s=i;return r&&(s=r(i)),function Ube(n,t){const e=t.schedulers.outsideAngular,r=t.schedulers.ngZone.run(()=>n.ref);return{query:n,update:ZX(r,"update"),set:ZX(r,"set"),push:i=>r.push(i),remove:Vbe(r),snapshotChanges:i=>jX(n,i,e).pipe(wi),stateChanges:i=>qX(n,i,e).pipe(wi),auditTrail:i=>function Lbe(n,t,e){return function Bbe(n,t,e){return function $be(n,t){return $k(n,"value","on",t).pipe((0,Ot.U)(e=>{let r;return e.payload.forEach(i=>(r=i.key,!1)),{data:e,lastKeyToLoad:r}}))}(n,e).pipe(function xE(...n){const t=(0,Mu.jO)(n);return(0,ti.e)((e,r)=>{const i=n.length,s=new Array(i);let o=n.map(()=>!1),l=!1;for(let c=0;c<i;c++)(0,Ru.Xf)(n[c]).subscribe((0,zr.x)(r,u=>{s[c]=u,!l&&!o[c]&&(o[c]=!0,(l=o.every(Pc.y))&&(o=null))},vC.Z));e.subscribe((0,zr.x)(r,c=>{if(l){const u=[c,...s];r.next(t?t(...u):u)}}))})}(t),(0,Ot.U)(([i,s])=>{const o=i.lastKeyToLoad,l=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:l}}),function cO(n){return(0,ti.e)((t,e)=>{let r=!1,i=0;t.subscribe((0,zr.x)(e,s=>(r||(r=!n(s,i++)))&&e.next(s)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,Ot.U)(i=>i.actions))}(n,qX(n,t).pipe(Ff((i,s)=>[...i,s],[])),e)}(n,i,e).pipe(wi),valueChanges:(i,s)=>jX(n,i,e).pipe((0,Ot.U)(l=>l.map(c=>s&&s.idField?Object.assign(Object.assign({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),wi)}}(s,this)}object(e){return function zbe(n,t){return{query:n,snapshotChanges:()=>YX(n,t.schedulers.outsideAngular)().pipe(wi),update:e=>n.ref.update(e),set:e=>n.ref.set(e),remove:()=>n.ref.remove(),valueChanges:()=>YX(n,t.schedulers.outsideAngular)().pipe(wi,(0,Ot.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>zX(this.database,e)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Ki.Dh),a.LFG(Ki.xv,8),a.LFG(Hbe,8),a.LFG(a.Lbi),a.LFG(a.R0b),a.LFG(ig),a.LFG(Gbe,8),a.LFG(n2,8),a.LFG(TG,8),a.LFG(SG,8),a.LFG(EG,8),a.LFG(DG,8),a.LFG(kG,8),a.LFG(AG,8),a.LFG(Lk,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),jbe=(()=>{class n{constructor(){IG.Z.registerVersion("angularfire",zf.full,"rtdb-compat")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[Wbe]}),n})();var Bk=z(8189);function Vk(...n){return function qbe(){return(0,Bk.J)(1)}()((0,Dn.D)(n,(0,Mu.yG)(n)))}function Ui(...n){const t=(0,Mu.yG)(n);return(0,ti.e)((e,r)=>{(t?Vk(n,e,t):Vk(n,e)).subscribe(r)})}function RG(){return(0,ti.e)((n,t)=>{let e,r=!1;n.subscribe((0,zr.x)(t,i=>{const s=e;e=i,r&&t.next([s,i]),r=!0}))})}var zt,Zbe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ku={},MG=MG||{},Ln=Zbe||self;function r2(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function Uk(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var OG="closure_uid_"+(1e9*Math.random()>>>0),Kbe=0;function Qbe(n,t,e){return n.call.apply(n.bind,arguments)}function Xbe(n,t,e){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(t,i)}}return function(){return n.apply(t,arguments)}}function ua(n,t,e){return(ua=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Qbe:Xbe).apply(null,arguments)}function s2(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var r=e.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function fo(n,t){function e(){}e.prototype=t.prototype,n.$=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.ac=function(r,i,s){for(var o=Array(arguments.length-2),l=2;l<arguments.length;l++)o[l-2]=arguments[l];return t.prototype[i].apply(r,o)}}function bg(){this.s=this.s,this.o=this.o}bg.prototype.s=!1,bg.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Ybe(n){Object.prototype.hasOwnProperty.call(n,OG)&&n[OG]||(n[OG]=++Kbe)}(this)},bg.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const KX=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function FG(n){const t=n.length;if(0<t){const e=Array(t);for(let r=0;r<t;r++)e[r]=n[r];return e}return[]}function QX(n,t){for(let e=1;e<arguments.length;e++){const r=arguments[e];if(r2(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let o=0;o<s;o++)n[i+o]=r[o]}else n.push(r)}}function da(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}da.prototype.h=function(){this.defaultPrevented=!0};var e0e=function(){if(!Ln.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Ln.addEventListener("test",()=>{},t),Ln.removeEventListener("test",()=>{},t)}catch{}return n}();function zk(n){return/^[\s\xa0]*$/.test(n)}function o2(){var n=Ln.navigator;return n&&(n=n.userAgent)?n:""}function th(n){return-1!=o2().indexOf(n)}function PG(n){return PG[" "](n),n}PG[" "]=function(){};var $G,n,n0e=th("Opera"),Ux=th("Trident")||th("MSIE"),XX=th("Edge"),LG=XX||Ux,JX=th("Gecko")&&!(-1!=o2().toLowerCase().indexOf("webkit")&&!th("Edge"))&&!(th("Trident")||th("MSIE"))&&!th("Edge"),r0e=-1!=o2().toLowerCase().indexOf("webkit")&&!th("Edge");function eJ(){var n=Ln.document;return n?n.documentMode:void 0}e:{var BG="",VG=(n=o2(),JX?/rv:([^\);]+)(\)|;)/.exec(n):XX?/Edge\/([\d\.]+)/.exec(n):Ux?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):r0e?/WebKit\/(\S+)/.exec(n):n0e?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(VG&&(BG=VG?VG[1]:""),Ux){var UG=eJ();if(null!=UG&&UG>parseFloat(BG)){$G=String(UG);break e}}$G=BG}var i0e=Ln.document&&Ux&&(eJ()||parseInt($G,10))||void 0;function Hk(n,t){if(da.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(JX){e:{try{PG(t.nodeName);var i=!0;break e}catch{}i=!1}i||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:s0e[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Hk.$.h.call(this)}}fo(Hk,da);var s0e={2:"touch",3:"pen",4:"mouse"};Hk.prototype.h=function(){Hk.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Gk="closure_listenable_"+(1e6*Math.random()|0),o0e=0;function a0e(n,t,e,r,i){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!r,this.la=i,this.key=++o0e,this.fa=this.ia=!1}function a2(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function HG(n,t,e){for(const r in n)t.call(e,n[r],r,n)}function nJ(n){const t={};for(const e in n)t[e]=n[e];return t}const rJ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function iJ(n,t){let e,r;for(let i=1;i<arguments.length;i++){for(e in r=arguments[i],r)n[e]=r[e];for(let s=0;s<rJ.length;s++)e=rJ[s],Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}}function l2(n){this.src=n,this.g={},this.h=0}function GG(n,t){var e=t.type;if(e in n.g){var s,r=n.g[e],i=KX(r,t);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(a2(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function WG(n,t,e,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==t&&s.capture==!!e&&s.la==r)return i}return-1}l2.prototype.add=function(n,t,e,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var o=WG(n,t,r,i);return-1<o?(t=n[o],e||(t.ia=!1)):((t=new a0e(t,this.src,s,!!r,i)).ia=e,n.push(t)),t};var jG="closure_lm_"+(1e6*Math.random()|0),qG={};function sJ(n,t,e,r,i){if(r&&r.once)return aJ(n,t,e,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)sJ(n,t[s],e,r,i);return null}return e=QG(e),n&&n[Gk]?n.O(t,e,Uk(r)?!!r.capture:!!r,i):oJ(n,t,e,!1,r,i)}function oJ(n,t,e,r,i,s){if(!t)throw Error("Invalid event type");var o=Uk(i)?!!i.capture:!!i,l=YG(n);if(l||(n[jG]=l=new l2(n)),(e=l.add(t,e,r,o,s)).proxy)return e;if(r=function c0e(){const t=u0e;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=r,r.src=n,r.listener=e,n.addEventListener)e0e||(i=o),void 0===i&&(i=!1),n.addEventListener(t.toString(),r,i);else if(n.attachEvent)n.attachEvent(cJ(t.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return e}function aJ(n,t,e,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)aJ(n,t[s],e,r,i);return null}return e=QG(e),n&&n[Gk]?n.P(t,e,Uk(r)?!!r.capture:!!r,i):oJ(n,t,e,!0,r,i)}function lJ(n,t,e,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)lJ(n,t[s],e,r,i);else r=Uk(r)?!!r.capture:!!r,e=QG(e),n&&n[Gk]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=WG(s=n.g[t],e,r,i))&&(a2(s[e]),Array.prototype.splice.call(s,e,1),0==s.length&&(delete n.g[t],n.h--))):n&&(n=YG(n))&&(t=n.g[t.toString()],n=-1,t&&(n=WG(t,e,r,i)),(e=-1<n?t[n]:null)&&ZG(e))}function ZG(n){if("number"!=typeof n&&n&&!n.fa){var t=n.src;if(t&&t[Gk])GG(t.i,n);else{var e=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(e,r,n.capture):t.detachEvent?t.detachEvent(cJ(e),r):t.addListener&&t.removeListener&&t.removeListener(r),(e=YG(t))?(GG(e,n),0==e.h&&(e.src=null,t[jG]=null)):a2(n)}}}function cJ(n){return n in qG?qG[n]:qG[n]="on"+n}function u0e(n,t){if(n.fa)n=!0;else{t=new Hk(t,this);var e=n.listener,r=n.la||n.src;n.ia&&ZG(n),n=e.call(r,t)}return n}function YG(n){return(n=n[jG])instanceof l2?n:null}var KG="__closure_events_fn_"+(1e9*Math.random()>>>0);function QG(n){return"function"==typeof n?n:(n[KG]||(n[KG]=function(t){return n.handleEvent(t)}),n[KG])}function po(){bg.call(this),this.i=new l2(this),this.S=this,this.J=null}function Ho(n,t){var e,r=n.J;if(r)for(e=[];r;r=r.J)e.push(r);if(n=n.S,r=t.type||t,"string"==typeof t)t=new da(t,n);else if(t instanceof da)t.target=t.target||n;else{var i=t;iJ(t=new da(r,n),i)}if(i=!0,e)for(var s=e.length-1;0<=s;s--){var o=t.g=e[s];i=c2(o,r,!0,t)&&i}if(i=c2(o=t.g=n,r,!0,t)&&i,i=c2(o,r,!1,t)&&i,e)for(s=0;s<e.length;s++)i=c2(o=t.g=e[s],r,!1,t)&&i}function c2(n,t,e,r){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==e){var l=o.listener,c=o.la||o.src;o.ia&&GG(n.i,o),i=!1!==l.call(c,r)&&i}}return i&&!r.defaultPrevented}fo(po,bg),po.prototype[Gk]=!0,po.prototype.removeEventListener=function(n,t,e,r){lJ(this,n,t,e,r)},po.prototype.N=function(){if(po.$.N.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],r=0;r<e.length;r++)a2(e[r]);delete n.g[t],n.h--}}this.J=null},po.prototype.O=function(n,t,e,r){return this.i.add(String(n),t,!1,e,r)},po.prototype.P=function(n,t,e,r){return this.i.add(String(n),t,!0,e,r)};var XG=Ln.JSON.stringify;function h0e(){var n=JG;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var uJ=new class d0e{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new p0e,n=>n.reset());class p0e{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function m0e(n){var t=1;n=n.split(":");const e=[];for(;0<t&&n.length;)e.push(n.shift()),t--;return n.length&&e.push(n.join(":")),e}function g0e(n){Ln.setTimeout(()=>{throw n},0)}let Wk,jk=!1,JG=new class f0e{constructor(){this.h=this.g=null}add(t,e){const r=uJ.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}},dJ=()=>{const n=Ln.Promise.resolve(void 0);Wk=()=>{n.then(_0e)}};var _0e=()=>{for(var n;n=h0e();){try{n.h.call(n.g)}catch(e){g0e(e)}var t=uJ;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}jk=!1};function u2(n,t){po.call(this),this.h=n||1,this.g=t||Ln,this.j=ua(this.qb,this),this.l=Date.now()}function e6(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function t6(n,t,e){if("function"==typeof n)e&&(n=ua(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=ua(n.handleEvent,n)}return 2147483647<Number(t)?-1:Ln.setTimeout(n,t||0)}function hJ(n){n.g=t6(()=>{n.g=null,n.i&&(n.i=!1,hJ(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}fo(u2,po),(zt=u2.prototype).ga=!1,zt.T=null,zt.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ho(this,"tick"),this.ga&&(e6(this),this.start()))}},zt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},zt.N=function(){u2.$.N.call(this),e6(this),delete this.g};class y0e extends bg{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:hJ(this)}N(){super.N(),this.g&&(Ln.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qk(n){bg.call(this),this.h=n,this.g={}}fo(qk,bg);var fJ=[];function pJ(n,t,e,r){Array.isArray(e)||(e&&(fJ[0]=e.toString()),e=fJ);for(var i=0;i<e.length;i++){var s=sJ(t,e[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function mJ(n){HG(n.g,function(t,e){this.g.hasOwnProperty(e)&&ZG(t)},n),n.g={}}function d2(){this.g=!0}function zx(n,t,e,r){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function C0e(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var r=e[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return XG(e)}catch{return t}}(n,e)+(r?" "+r:"")})}qk.prototype.N=function(){qk.$.N.call(this),mJ(this)},qk.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},d2.prototype.Ea=function(){this.g=!1},d2.prototype.info=function(){};var Jv={},gJ=null;function h2(){return gJ=gJ||new po}function _J(n){da.call(this,Jv.Ta,n)}function Zk(n){const t=h2();Ho(t,new _J(t))}function yJ(n,t){da.call(this,Jv.STAT_EVENT,n),this.stat=t}function Wa(n){const t=h2();Ho(t,new yJ(t,n))}function vJ(n,t){da.call(this,Jv.Ua,n),this.size=t}function Yk(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Ln.setTimeout(function(){n()},t)}Jv.Ta="serverreachability",fo(_J,da),Jv.STAT_EVENT="statevent",fo(yJ,da),Jv.Ua="timingevent",fo(vJ,da);var f2={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},bJ={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function n6(){}function CJ(){}n6.prototype.h=null;var s6,Kk={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function r6(){da.call(this,"d")}function i6(){da.call(this,"c")}function p2(){}function Qk(n,t,e,r){this.l=n,this.j=t,this.m=e,this.W=r||1,this.U=new qk(this),this.P=x0e,this.V=new u2(n=LG?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new xJ}function xJ(){this.i=null,this.g="",this.h=!1}fo(r6,da),fo(i6,da),fo(p2,n6),p2.prototype.g=function(){return new XMLHttpRequest},p2.prototype.i=function(){return{}},s6=new p2;var x0e=45e3,o6={},m2={};function a6(n,t,e){n.L=1,n.v=v2(Zf(t)),n.s=e,n.S=!0,IJ(n,null)}function IJ(n,t){n.G=Date.now(),Xk(n),n.A=Zf(n.v);var e=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),OJ(e.i,"t",r),n.C=0,e=n.l.J,n.h=new xJ,n.g=iee(n.l,e?t:null,!n.s),0<n.O&&(n.M=new y0e(ua(n.Pa,n,n.g),n.O)),pJ(n.U,n.g,"readystatechange",n.nb),t=n.I?nJ(n.I):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,t)):(n.u="GET",n.g.ha(n.A,n.u,null,t)),Zk(),function v0e(n,t,e,r,i,s){n.info(function(){if(n.g)if(s)for(var o="",l=s.split("&"),c=0;c<l.length;c++){var u=l[c].split("=");if(1<u.length){var f=u[0];u=u[1];var m=f.split("_");o=2<=m.length&&"type"==m[1]?o+(f+"=")+u+"&":o+(f+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+e+"\n"+o})}(n.j,n.u,n.A,n.m,n.W,n.s)}function TJ(n){return!!n.g&&"GET"==n.u&&2!=n.L&&n.l.Ha}function SJ(n,t,e){let i,r=!0;for(;!n.J&&n.C<e.length;){if(i=I0e(n,e),i==m2){4==t&&(n.o=4,Wa(14),r=!1),zx(n.j,n.m,null,"[Incomplete Response]");break}if(i==o6){n.o=4,Wa(15),zx(n.j,n.m,e,"[Invalid Chunk]"),r=!1;break}zx(n.j,n.m,i,null),l6(n,i)}TJ(n)&&i!=m2&&i!=o6&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,Wa(16),r=!1),n.i=n.i&&r,r?0<e.length&&!n.ba&&(n.ba=!0,(t=n.l).g==n&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+e.length),m6(t),t.M=!0,Wa(11))):(zx(n.j,n.m,e,"[Invalid Chunked Response]"),eb(n),Jk(n))}function I0e(n,t){var e=n.C,r=t.indexOf("\n",e);return-1==r?m2:(e=Number(t.substring(e,r)),isNaN(e)?o6:(r+=1)+e>t.length?m2:(t=t.slice(r,r+e),n.C=r+e,t))}function Xk(n){n.Y=Date.now()+n.P,EJ(n,n.P)}function EJ(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Yk(ua(n.lb,n),t)}function g2(n){n.B&&(Ln.clearTimeout(n.B),n.B=null)}function Jk(n){0==n.l.H||n.J||eee(n.l,n)}function eb(n){g2(n);var t=n.M;t&&"function"==typeof t.sa&&t.sa(),n.M=null,e6(n.V),mJ(n.U),n.g&&(t=n.g,n.g=null,t.abort(),t.sa())}function l6(n,t){try{var e=n.l;if(0!=e.H&&(e.g==n||c6(e.i,n)))if(!n.K&&c6(e.i,n)&&3==e.H){try{var r=e.Ja.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!e.u){if(e.g){if(!(e.g.G+3e3<n.G))break e;T2(e),x2(e)}p6(e),Wa(18)}}else e.Fa=i[1],0<e.Fa-e.V&&37500>i[2]&&e.G&&0==e.A&&!e.v&&(e.v=Yk(ua(e.ib,e),6e3));if(1>=LJ(e.i)&&e.oa){try{e.oa()}catch{}e.oa=void 0}}else nb(e,11)}else if((n.K||e.g==n)&&T2(e),!zk(t))for(i=e.Ja.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(e.V=u[0],u=u[1],2==e.H)if("c"==u[0]){e.K=u[1],e.pa=u[2];const f=u[3];null!=f&&(e.ra=f,e.l.info("VER="+e.ra));const m=u[4];null!=m&&(e.Ga=m,e.l.info("SVER="+e.Ga));const _=u[5];null!=_&&"number"==typeof _&&0<_&&(e.L=r=1.5*_,e.l.info("backChannelRequestTimeoutMs_="+r)),r=e;const y=n.g;if(y){const w=y.g?y.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(w){var s=r.i;s.g||-1==w.indexOf("spdy")&&-1==w.indexOf("quic")&&-1==w.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(u6(s,s.h),s.h=null))}if(r.F){const T=y.g?y.g.getResponseHeader("X-HTTP-Session-Id"):null;T&&(r.Da=T,Ci(r.I,r.F,T))}}e.H=3,e.h&&e.h.Ba(),e.ca&&(e.S=Date.now()-n.G,e.l.info("Handshake RTT: "+e.S+"ms"));var o=n;if((r=e).wa=ree(r,r.J?r.pa:null,r.Y),o.K){$J(r.i,o);var l=o,c=r.L;c&&l.setTimeout(c),l.B&&(g2(l),Xk(l)),r.g=o}else XJ(r);0<e.j.length&&I2(e)}else"stop"!=u[0]&&"close"!=u[0]||nb(e,7);else 3==e.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?nb(e,7):f6(e):"noop"!=u[0]&&e.h&&e.h.Aa(u),e.A=0)}Zk()}catch{}}function DJ(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(r2(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function S0e(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(r2(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const r in n)t[e++]=r;return t}}}(n),r=function T0e(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(r2(n)){for(var t=[],e=n.length,r=0;r<e;r++)t.push(n[r]);return t}for(r in t=[],e=0,n)t[e++]=n[r];return t}(n),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],e&&e[s],n)}(zt=Qk.prototype).setTimeout=function(n){this.P=n},zt.nb=function(n){n=n.target;const t=this.M;t&&3==nh(n)?t.l():this.Pa(n)},zt.Pa=function(n){try{if(n==this.g)e:{const f=nh(this.g);var t=this.g.Ia();if(this.g.da(),!(3>f)&&(3!=f||LG||this.g&&(this.h.h||this.g.ja()||jJ(this.g)))){this.J||4!=f||7==t||Zk(),g2(this);var e=this.g.da();this.ca=e;t:if(TJ(this)){var r=jJ(this.g);n="";var i=r.length,s=4==nh(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){eb(this),Jk(this);var o="";break t}this.h.i=new Ln.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,n+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==e,function b0e(n,t,e,r,i,s,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+e+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,f,e),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!zk(l)){var u=l;break t}}u=null}if(!(e=u)){this.i=!1,this.o=3,Wa(12),eb(this),Jk(this);break e}zx(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,l6(this,e)}this.S?(SJ(this,f,o),LG&&this.i&&3==f&&(pJ(this.U,this.V,"tick",this.mb),this.V.start())):(zx(this.j,this.m,o,null),l6(this,o)),4==f&&eb(this),this.i&&!this.J&&(4==f?eee(this.l,this):(this.i=!1,Xk(this)))}else(function G0e(n){const t={};n=(n.g&&2<=nh(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<n.length;r++){if(zk(n[r]))continue;var e=m0e(n[r]);const i=e[0];if("string"!=typeof(e=e[1]))continue;e=e.trim();const s=t[i]||[];t[i]=s,s.push(e)}!function l0e(n,t){for(const e in n)t.call(void 0,n[e],e,n)}(t,function(r){return r.join(", ")})})(this.g),400==e&&0<o.indexOf("Unknown SID")?(this.o=3,Wa(12)):(this.o=0,Wa(13)),eb(this),Jk(this)}}}catch{}},zt.mb=function(){if(this.g){var n=nh(this.g),t=this.g.ja();this.C<t.length&&(g2(this),SJ(this,n,t),this.i&&4!=n&&Xk(this))}},zt.cancel=function(){this.J=!0,eb(this)},zt.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function w0e(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.L&&(Zk(),Wa(17)),eb(this),this.o=2,Jk(this)):EJ(this,this.Y-n)};var kJ=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tb(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof tb){this.h=n.h,_2(this,n.j),this.s=n.s,this.g=n.g,y2(this,n.m),this.l=n.l;var t=n.i,e=new nA;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),AJ(this,e),this.o=n.o}else n&&(t=String(n).match(kJ))?(this.h=!1,_2(this,t[1]||"",!0),this.s=eA(t[2]||""),this.g=eA(t[3]||"",!0),y2(this,t[4]),this.l=eA(t[5]||"",!0),AJ(this,t[6]||"",!0),this.o=eA(t[7]||"")):(this.h=!1,this.i=new nA(null,this.h))}function Zf(n){return new tb(n)}function _2(n,t,e){n.j=e?eA(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function y2(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function AJ(n,t,e){t instanceof nA?(n.i=t,function M0e(n,t){t&&!n.j&&(wg(n),n.i=null,n.g.forEach(function(e,r){var i=r.toLowerCase();r!=i&&(RJ(this,r),OJ(this,i,e))},n)),n.j=t}(n.i,n.h)):(e||(t=tA(t,N0e)),n.i=new nA(t,n.h))}function Ci(n,t,e){n.i.set(t,e)}function v2(n){return Ci(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function eA(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function tA(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,D0e),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function D0e(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}tb.prototype.toString=function(){var n=[],t=this.j;t&&n.push(tA(t,NJ,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(tA(t,NJ,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(tA(e,"/"==e.charAt(0)?A0e:k0e,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",tA(e,R0e)),n.join("")};var NJ=/[#\/\?@]/g,k0e=/[#\?:]/g,A0e=/[#\?]/g,N0e=/[#\?@]/g,R0e=/#/g;function nA(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function wg(n){n.g||(n.g=new Map,n.h=0,n.i&&function E0e(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var r=n[e].indexOf("="),i=null;if(0<=r){var s=n[e].substring(0,r);i=n[e].substring(r+1)}else s=n[e];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function RJ(n,t){wg(n),t=Hx(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function MJ(n,t){return wg(n),t=Hx(n,t),n.g.has(t)}function OJ(n,t,e){RJ(n,t),0<e.length&&(n.i=null,n.g.set(Hx(n,t),FG(e)),n.h+=e.length)}function Hx(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function FJ(n){this.l=n||F0e,n=Ln.PerformanceNavigationTiming?0<(n=Ln.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Ln.g&&Ln.g.Ka&&Ln.g.Ka()&&Ln.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(zt=nA.prototype).add=function(n,t){wg(this),this.i=null,n=Hx(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},zt.forEach=function(n,t){wg(this),this.g.forEach(function(e,r){e.forEach(function(i){n.call(t,i,r,this)},this)},this)},zt.ta=function(){wg(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let r=0;r<t.length;r++){const i=n[r];for(let s=0;s<i.length;s++)e.push(t[r])}return e},zt.Z=function(n){wg(this);let t=[];if("string"==typeof n)MJ(this,n)&&(t=t.concat(this.g.get(Hx(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},zt.set=function(n,t){return wg(this),this.i=null,MJ(this,n=Hx(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},zt.get=function(n,t){return n&&0<(n=this.Z(n)).length?String(n[0]):t},zt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var r=t[e];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),n.push(i)}}return this.i=n.join("&")};var F0e=10;function PJ(n){return!!n.h||!!n.g&&n.g.size>=n.j}function LJ(n){return n.h?1:n.g?n.g.size:0}function c6(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function u6(n,t){n.g?n.g.add(t):n.h=t}function $J(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function BJ(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.F);return t}return FG(n.i)}function L0e(){this.g=new class{stringify(n){return Ln.JSON.stringify(n,void 0)}parse(n){return Ln.JSON.parse(n,void 0)}}}function $0e(n,t,e){const r=e||"";try{DJ(n,function(i,s){let o=i;Uk(i)&&(o=XG(i)),t.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function b2(n,t,e,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch{}}function rA(n){this.l=n.fc||null,this.j=n.ob||!1}function w2(n,t){po.call(this),this.F=n,this.u=t,this.m=void 0,this.readyState=d6,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}FJ.prototype.cancel=function(){if(this.i=BJ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},fo(rA,n6),rA.prototype.g=function(){return new w2(this.l,this.j)},rA.prototype.i=function(n){return function(){return n}}({}),fo(w2,po);var d6=0;function VJ(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function iA(n){n.readyState=4,n.l=null,n.j=null,n.A=null,sA(n)}function sA(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(zt=w2.prototype).open=function(n,t){if(this.readyState!=d6)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,sA(this)},zt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.F||Ln).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},zt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,iA(this)),this.readyState=d6},zt.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,sA(this)),this.g&&(this.readyState=3,sA(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Ln.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;VJ(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},zt.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?iA(this):sA(this),3==this.readyState&&VJ(this)}},zt.Za=function(n){this.g&&(this.response=this.responseText=n,iA(this))},zt.Ya=function(n){this.g&&(this.response=n,iA(this))},zt.ka=function(){this.g&&iA(this)},zt.setRequestHeader=function(n,t){this.v.append(n,t)},zt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},zt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(w2.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var V0e=Ln.JSON.parse;function Xi(n){po.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=UJ,this.L=this.M=!1}fo(Xi,po);var UJ="",U0e=/^https?$/i,z0e=["POST","PUT"];function zJ(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,HJ(n),C2(n)}function HJ(n){n.F||(n.F=!0,Ho(n,"complete"),Ho(n,"error"))}function GJ(n){if(n.h&&typeof MG<"u"&&(!n.C[1]||4!=nh(n)||2!=n.da()))if(n.v&&4==nh(n))t6(n.La,0,n);else if(Ho(n,"readystatechange"),4==nh(n)){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var r;if(r=0===o){var i=String(n.I).match(kJ)[1]||null;!i&&Ln.self&&Ln.self.location&&(i=Ln.self.location.protocol.slice(0,-1)),r=!U0e.test(i?i.toLowerCase():"")}e=r}if(e)Ho(n,"complete"),Ho(n,"success");else{n.m=6;try{var s=2<nh(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",HJ(n)}}finally{C2(n)}}}function C2(n,t){if(n.g){WJ(n);const e=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,t||Ho(n,"ready");try{e.onreadystatechange=r}catch{}}}function WJ(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Ln.clearTimeout(n.A),n.A=null)}function nh(n){return n.g?n.g.readyState:0}function jJ(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case UJ:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function qJ(n){let t="";return HG(n,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function h6(n,t,e){e:{for(r in e){var r=!1;break e}r=!0}r||(e=qJ(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Ci(n,t,e))}function oA(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function ZJ(n){this.Ga=0,this.j=[],this.l=new d2,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=oA("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=oA("baseRetryDelayMs",5e3,n),this.hb=oA("retryDelaySeedMs",1e4,n),this.eb=oA("forwardChannelMaxRetries",2,n),this.xa=oA("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new FJ(n&&n.concurrentRequestLimit),this.Ja=new L0e,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function f6(n){if(YJ(n),3==n.H){var t=n.W++,e=Zf(n.I);if(Ci(e,"SID",n.K),Ci(e,"RID",t),Ci(e,"TYPE","terminate"),aA(n,e),(t=new Qk(n,n.l,t)).L=2,t.v=v2(Zf(e)),e=!1,Ln.navigator&&Ln.navigator.sendBeacon)try{e=Ln.navigator.sendBeacon(t.v.toString(),"")}catch{}!e&&Ln.Image&&((new Image).src=t.v,e=!0),e||(t.g=iee(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Xk(t)}nee(n)}function x2(n){n.g&&(m6(n),n.g.cancel(),n.g=null)}function YJ(n){x2(n),n.u&&(Ln.clearTimeout(n.u),n.u=null),T2(n),n.i.cancel(),n.m&&("number"==typeof n.m&&Ln.clearTimeout(n.m),n.m=null)}function I2(n){if(!PJ(n.i)&&!n.m){n.m=!0;var t=n.Na;Wk||dJ(),jk||(Wk(),jk=!0),JG.add(t,n),n.C=0}}function KJ(n,t){var e;e=t?t.m:n.W++;const r=Zf(n.I);Ci(r,"SID",n.K),Ci(r,"RID",e),Ci(r,"AID",n.V),aA(n,r),n.o&&n.s&&h6(r,n.o,n.s),e=new Qk(n,n.l,e,n.C+1),null===n.o&&(e.I=n.s),t&&(n.j=t.F.concat(n.j)),t=QJ(n,e,1e3),e.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),u6(n.i,e),a6(e,r,t)}function aA(n,t){n.na&&HG(n.na,function(e,r){Ci(t,r,e)}),n.h&&DJ({},function(e,r){Ci(t,r,e)})}function QJ(n,t,e){e=Math.min(n.j.length,e);var r=n.h?ua(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const o=["count="+e];-1==s?0<e?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let l=!0;for(let c=0;c<e;c++){let u=i[c].g;const f=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),l=!1;else try{$0e(f,o,"req"+u+"_")}catch{r&&r(f)}}if(l){r=o.join("&");break e}}}return n=n.j.splice(0,e),t.F=n,r}function XJ(n){if(!n.g&&!n.u){n.ba=1;var t=n.Ma;Wk||dJ(),jk||(Wk(),jk=!0),JG.add(t,n),n.A=0}}function p6(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=Yk(ua(n.Ma,n),tee(n,n.A)),n.A++,0))}function m6(n){null!=n.B&&(Ln.clearTimeout(n.B),n.B=null)}function JJ(n){n.g=new Qk(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var t=Zf(n.wa);Ci(t,"RID","rpc"),Ci(t,"SID",n.K),Ci(t,"AID",n.V),Ci(t,"CI",n.G?"0":"1"),!n.G&&n.qa&&Ci(t,"TO",n.qa),Ci(t,"TYPE","xmlhttp"),aA(n,t),n.o&&n.s&&h6(t,n.o,n.s),n.L&&n.g.setTimeout(n.L);var e=n.g;n=n.pa,e.L=1,e.v=v2(Zf(t)),e.s=null,e.S=!0,IJ(e,n)}function T2(n){null!=n.v&&(Ln.clearTimeout(n.v),n.v=null)}function eee(n,t){var e=null;if(n.g==t){T2(n),m6(n),n.g=null;var r=2}else{if(!c6(n.i,t))return;e=t.F,$J(n.i,t),r=1}if(0!=n.H)if(t.i)if(1==r){e=t.s?t.s.length:0,t=Date.now()-t.G;var i=n.C;Ho(r=h2(),new vJ(r,e)),I2(n)}else XJ(n);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function W0e(n,t){return!(LJ(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=t.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=Yk(ua(n.Na,n,t),tee(n,n.C)),n.C++,0)))}(n,t)||2==r&&p6(n)))switch(e&&0<e.length&&(t=n.i,t.i=t.i.concat(e)),i){case 1:nb(n,5);break;case 4:nb(n,10);break;case 3:nb(n,6);break;default:nb(n,2)}}function tee(n,t){let e=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(e*=2),e*t}function nb(n,t){if(n.l.info("Error code "+t),2==t){var e=null;n.h&&(e=null);var r=ua(n.pb,n);e||(e=new tb("//www.google.com/images/cleardot.gif"),Ln.location&&"http"==Ln.location.protocol||_2(e,"https"),v2(e)),function B0e(n,t){const e=new d2;if(Ln.Image){const r=new Image;r.onload=s2(b2,e,r,"TestLoadImage: loaded",!0,t),r.onerror=s2(b2,e,r,"TestLoadImage: error",!1,t),r.onabort=s2(b2,e,r,"TestLoadImage: abort",!1,t),r.ontimeout=s2(b2,e,r,"TestLoadImage: timeout",!1,t),Ln.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else t(!1)}(e.toString(),r)}else Wa(2);n.H=0,n.h&&n.h.za(t),nee(n),YJ(n)}function nee(n){if(n.H=0,n.ma=[],n.h){const t=BJ(n.i);(0!=t.length||0!=n.j.length)&&(QX(n.ma,t),QX(n.ma,n.j),n.i.i.length=0,FG(n.j),n.j.length=0),n.h.ya()}}function ree(n,t,e){var r=e instanceof tb?Zf(e):new tb(e);if(""!=r.g)t&&(r.g=t+"."+r.g),y2(r,r.m);else{var i=Ln.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new tb(null);r&&_2(s,r),t&&(s.g=t),i&&y2(s,i),e&&(s.l=e),r=s}return t=n.Da,(e=n.F)&&t&&Ci(r,e,t),Ci(r,"VER",n.ra),aA(n,r),r}function iee(n,t,e){if(t&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Xi(e&&n.Ha&&!n.va?new rA({ob:!0}):n.va)).Oa(n.J),t}function see(){}function S2(){if(Ux&&!(10<=Number(i0e)))throw Error("Environmental error: no available transport.")}function oc(n,t){po.call(this),this.g=new ZJ(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(n?n["X-WebChannel-Client-Profile"]=t.Ca:n={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=n,(n=t&&t.cc)&&!zk(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!zk(t)&&(this.g.F=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new Gx(this)}function oee(n){r6.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function aee(){i6.call(this),this.status=1}function Gx(n){this.g=n}function Qu(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function g6(n,t,e){e||(e=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;else for(i=0;16>i;++i)r[i]=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;var s=n.g[3],o=(t=n.g[0])+(s^(e=n.g[1])&((i=n.g[2])^s))+r[0]+3614090360&4294967295;o=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=(e=(i=(s=(t=e+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(e^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(e^s&(t^e))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=e+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^e&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(e^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(e^s&(t^e))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=e+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^e&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(e^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(e^s&(t^e))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=e+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^e&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(e^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(e^s&(t^e))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=e+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(e^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(e^i&(t^e))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^e&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=e+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(e^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(e^i&(t^e))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^e&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=e+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(e^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(e^i&(t^e))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^e&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=e+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(e^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(e^i&(t^e))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^e&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=e+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(e^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^e^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^e)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=e+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(e^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^e^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^e)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=e+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(e^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^e^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^e)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=e+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(e^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^e^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^e)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=e+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(e|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(e^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~e))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=e+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(e|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(e^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~e))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=e+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(e|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(e^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~e))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=e+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=e+((o=t+(i^(e|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(e^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~e))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+t&4294967295,n.g[1]=n.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}function Hr(n,t){this.h=t;for(var e=[],r=!0,i=n.length-1;0<=i;i--){var s=0|n[i];r&&s==t||(e[i]=s,r=!1)}this.g=e}(zt=Xi.prototype).Oa=function(n){this.M=n},zt.ha=function(n,t,e,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);t=t?t.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():s6.g(),this.C=function wJ(n){return n.h||(n.h=n.i())}(this.u?this.u:s6),this.g.onreadystatechange=ua(this.La,this);try{this.G=!0,this.g.open(t,String(n),!0),this.G=!1}catch(s){return void zJ(this,s)}if(n=e||"",e=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)e.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())e.set(s,r.get(s))}r=Array.from(e.keys()).find(s=>"content-type"==s.toLowerCase()),i=Ln.FormData&&n instanceof Ln.FormData,!(0<=KX(z0e,t))||r||i||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of e)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{WJ(this),0<this.B&&((this.L=function H0e(n){return Ux&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ua(this.ua,this)):this.A=t6(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){zJ(this,s)}},zt.ua=function(){typeof MG<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ho(this,"timeout"),this.abort(8))},zt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Ho(this,"complete"),Ho(this,"abort"),C2(this))},zt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),C2(this,!0)),Xi.$.N.call(this)},zt.La=function(){this.s||(this.G||this.v||this.l?GJ(this):this.kb())},zt.kb=function(){GJ(this)},zt.isActive=function(){return!!this.g},zt.da=function(){try{return 2<nh(this)?this.g.status:-1}catch{return-1}},zt.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},zt.Wa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),V0e(t)}},zt.Ia=function(){return this.m},zt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(zt=ZJ.prototype).ra=8,zt.H=1,zt.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new Qk(this,this.l,n);let s=this.s;if(this.U&&(s?(s=nJ(s),iJ(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,e=0;e<this.j.length;e++){var r=this.j[e];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=e;break e}if(4096===t||e===this.j.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=QJ(this,i,t),Ci(e=Zf(this.I),"RID",n),Ci(e,"CVER",22),this.F&&Ci(e,"X-HTTP-Session-Id",this.F),aA(this,e),s&&(this.O?t="headers="+encodeURIComponent(String(qJ(s)))+"&"+t:this.o&&h6(e,this.o,s)),u6(this.i,i),this.bb&&Ci(e,"TYPE","init"),this.P?(Ci(e,"$req",t),Ci(e,"SID","null"),i.aa=!0,a6(i,e,null)):a6(i,e,t),this.H=2}}else 3==this.H&&(n?KJ(this,n):0==this.j.length||PJ(this.i)||KJ(this))},zt.Ma=function(){if(this.u=null,JJ(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Yk(ua(this.jb,this),n)}},zt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Wa(10),x2(this),JJ(this))},zt.ib=function(){null!=this.v&&(this.v=null,x2(this),p6(this),Wa(19))},zt.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Wa(2)):(this.l.info("Failed to ping google.com"),Wa(1))},zt.isActive=function(){return!!this.h&&this.h.isActive(this)},(zt=see.prototype).Ba=function(){},zt.Aa=function(){},zt.za=function(){},zt.ya=function(){},zt.isActive=function(){return!0},zt.Va=function(){},S2.prototype.g=function(n,t){return new oc(n,t)},fo(oc,po),oc.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,t=this.l,e=this.h||void 0;Wa(0),n.Y=t,n.na=e||{},n.G=n.aa,n.I=ree(n,null,n.Y),I2(n)},oc.prototype.close=function(){f6(this.g)},oc.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=XG(n),n=e);t.j.push(new class{constructor(n,t){this.g=n,this.map=t}}(t.fb++,n)),3==t.H&&I2(t)},oc.prototype.N=function(){this.g.h=null,delete this.j,f6(this.g),delete this.g,oc.$.N.call(this)},fo(oee,r6),fo(aee,i6),fo(Gx,see),Gx.prototype.Ba=function(){Ho(this.g,"a")},Gx.prototype.Aa=function(n){Ho(this.g,new oee(n))},Gx.prototype.za=function(n){Ho(this.g,new aee)},Gx.prototype.ya=function(){Ho(this.g,"b")},fo(Qu,function j0e(){this.blockSize=-1}),Qu.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Qu.prototype.j=function(n,t){void 0===t&&(t=n.length);for(var e=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=e;)g6(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<t;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){g6(this,r),i=0;break}}else for(;s<t;)if(r[i++]=n[s++],i==this.blockSize){g6(this,r),i=0;break}}this.h=i,this.i+=t},Qu.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var t=1;t<n.length-8;++t)n[t]=0;var e=8*this.i;for(t=n.length-8;t<n.length;++t)n[t]=255&e,e/=256;for(this.j(n),n=Array(16),t=e=0;4>t;++t)for(var r=0;32>r;r+=8)n[e++]=this.g[t]>>>r&255;return n};var q0e={};function _6(n){return-128<=n&&128>n?function t0e(n,t){var e=q0e;return Object.prototype.hasOwnProperty.call(e,n)?e[n]:e[n]=t(n)}(n,function(t){return new Hr([0|t],0>t?-1:0)}):new Hr([0|n],0>n?-1:0)}function rh(n){if(isNaN(n)||!isFinite(n))return Wx;if(0>n)return Go(rh(-n));for(var t=[],e=1,r=0;n>=e;r++)t[r]=n/e|0,e*=y6;return new Hr(t,0)}var y6=4294967296,Wx=_6(0),v6=_6(1),cee=_6(16777216);function Yf(n){if(0!=n.h)return!1;for(var t=0;t<n.g.length;t++)if(0!=n.g[t])return!1;return!0}function qc(n){return-1==n.h}function Go(n){for(var t=n.g.length,e=[],r=0;r<t;r++)e[r]=~n.g[r];return new Hr(e,~n.h).add(v6)}function E2(n,t){return n.add(Go(t))}function D2(n,t){for(;(65535&n[t])!=n[t];)n[t+1]+=n[t]>>>16,n[t]&=65535,t++}function lA(n,t){this.g=n,this.h=t}function k2(n,t){if(Yf(t))throw Error("division by zero");if(Yf(n))return new lA(Wx,Wx);if(qc(n))return t=k2(Go(n),t),new lA(Go(t.g),Go(t.h));if(qc(t))return t=k2(n,Go(t)),new lA(Go(t.g),t.h);if(30<n.g.length){if(qc(n)||qc(t))throw Error("slowDivide_ only works with positive integers.");for(var e=v6,r=t;0>=r.X(n);)e=uee(e),r=uee(r);var i=jx(e,1),s=jx(r,1);for(r=jx(r,2),e=jx(e,2);!Yf(r);){var o=s.add(r);0>=o.X(n)&&(i=i.add(e),s=o),r=jx(r,1),e=jx(e,1)}return t=E2(n,i.R(t)),new lA(i,t)}for(i=Wx;0<=n.X(t);){for(e=Math.max(1,Math.floor(n.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(e)/Math.LN2))?1:Math.pow(2,r-48),o=(s=rh(e)).R(t);qc(o)||0<o.X(n);)o=(s=rh(e-=r)).R(t);Yf(s)&&(s=v6),i=i.add(s),n=E2(n,o)}return new lA(i,n)}function uee(n){for(var t=n.g.length+1,e=[],r=0;r<t;r++)e[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Hr(e,n.h)}function jx(n,t){var e=t>>5;t%=32;for(var r=n.g.length-e,i=[],s=0;s<r;s++)i[s]=0<t?n.D(s+e)>>>t|n.D(s+e+1)<<32-t:n.D(s+e);return new Hr(i,n.h)}(zt=Hr.prototype).ea=function(){if(qc(this))return-Go(this).ea();for(var n=0,t=1,e=0;e<this.g.length;e++){var r=this.D(e);n+=(0<=r?r:y6+r)*t,t*=y6}return n},zt.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(Yf(this))return"0";if(qc(this))return"-"+Go(this).toString(n);for(var t=rh(Math.pow(n,6)),e=this,r="";;){var i=k2(e,t).g,s=((0<(e=E2(e,i.R(t))).g.length?e.g[0]:e.h)>>>0).toString(n);if(Yf(e=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},zt.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},zt.X=function(n){return qc(n=E2(this,n))?-1:Yf(n)?0:1},zt.abs=function(){return qc(this)?Go(this):this},zt.add=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&n.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=o>>>16,e[i]=(o&=65535)<<16|(s&=65535)}return new Hr(e,-2147483648&e[e.length-1]?-1:0)},zt.R=function(n){if(Yf(this)||Yf(n))return Wx;if(qc(this))return qc(n)?Go(this).R(Go(n)):Go(Go(this).R(n));if(qc(n))return Go(this.R(Go(n)));if(0>this.X(cee)&&0>n.X(cee))return rh(this.ea()*n.ea());for(var t=this.g.length+n.g.length,e=[],r=0;r<2*t;r++)e[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),l=n.D(i)>>>16,c=65535&n.D(i);e[2*r+2*i]+=o*c,D2(e,2*r+2*i),e[2*r+2*i+1]+=s*c,D2(e,2*r+2*i+1),e[2*r+2*i+1]+=o*l,D2(e,2*r+2*i+1),e[2*r+2*i+2]+=s*l,D2(e,2*r+2*i+2)}for(r=0;r<t;r++)e[r]=e[2*r+1]<<16|e[2*r];for(r=t;r<2*t;r++)e[r]=0;return new Hr(e,0)},zt.gb=function(n){return k2(this,n).h},zt.and=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],r=0;r<t;r++)e[r]=this.D(r)&n.D(r);return new Hr(e,this.h&n.h)},zt.or=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],r=0;r<t;r++)e[r]=this.D(r)|n.D(r);return new Hr(e,this.h|n.h)},zt.xor=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],r=0;r<t;r++)e[r]=this.D(r)^n.D(r);return new Hr(e,this.h^n.h)},S2.prototype.createWebChannel=S2.prototype.g,oc.prototype.send=oc.prototype.u,oc.prototype.open=oc.prototype.m,oc.prototype.close=oc.prototype.close,f2.NO_ERROR=0,f2.TIMEOUT=8,f2.HTTP_ERROR=6,bJ.COMPLETE="complete",CJ.EventType=Kk,Kk.OPEN="a",Kk.CLOSE="b",Kk.ERROR="c",Kk.MESSAGE="d",po.prototype.listen=po.prototype.O,Xi.prototype.listenOnce=Xi.prototype.P,Xi.prototype.getLastError=Xi.prototype.Sa,Xi.prototype.getLastErrorCode=Xi.prototype.Ia,Xi.prototype.getStatus=Xi.prototype.da,Xi.prototype.getResponseJson=Xi.prototype.Wa,Xi.prototype.getResponseText=Xi.prototype.ja,Xi.prototype.send=Xi.prototype.ha,Xi.prototype.setWithCredentials=Xi.prototype.Oa,Qu.prototype.digest=Qu.prototype.l,Qu.prototype.reset=Qu.prototype.reset,Qu.prototype.update=Qu.prototype.j,Hr.prototype.add=Hr.prototype.add,Hr.prototype.multiply=Hr.prototype.R,Hr.prototype.modulo=Hr.prototype.gb,Hr.prototype.compare=Hr.prototype.X,Hr.prototype.toNumber=Hr.prototype.ea,Hr.prototype.toString=Hr.prototype.toString,Hr.prototype.getBits=Hr.prototype.D,Hr.fromNumber=rh,Hr.fromString=function lee(n,t){if(0==n.length)throw Error("number format error: empty string");if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if("-"==n.charAt(0))return Go(lee(n.substring(1),t));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var e=rh(Math.pow(t,8)),r=Wx,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),o=parseInt(n.substring(i,i+s),t);8>s?(s=rh(Math.pow(t,s)),r=r.R(s).add(rh(o))):r=(r=r.R(e)).add(rh(o))}return r};var Z0e=Ku.createWebChannelTransport=function(){return new S2},Y0e=Ku.getStatEventTarget=function(){return h2()},b6=Ku.ErrorCode=f2,K0e=Ku.EventType=bJ,Q0e=Ku.Event=Jv,dee=Ku.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},X0e=Ku.FetchXmlHttpFactory=rA,A2=Ku.WebChannel=CJ,J0e=Ku.XhrIo=Xi,ewe=Ku.Md5=Qu,qx=Ku.Integer=Hr;const hee="@firebase/firestore";class mo{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}mo.UNAUTHENTICATED=new mo(null),mo.GOOGLE_CREDENTIALS=new mo("google-credentials-uid"),mo.FIRST_PARTY=new mo("first-party-uid"),mo.MOCK_USER=new mo("mock-user");let Zx="9.23.0";const Cg=new $o.Yd("@firebase/firestore");function w6(){return Cg.logLevel}function Ct(n,...t){if(Cg.logLevel<=$o.in.DEBUG){const e=t.map(C6);Cg.debug(`Firestore (${Zx}): ${n}`,...e)}}function hs(n,...t){if(Cg.logLevel<=$o.in.ERROR){const e=t.map(C6);Cg.error(`Firestore (${Zx}): ${n}`,...e)}}function Zc(n,...t){if(Cg.logLevel<=$o.in.WARN){const e=t.map(C6);Cg.warn(`Firestore (${Zx}): ${n}`,...e)}}function C6(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Jt(n="Unexpected state"){const t=`FIRESTORE (${Zx}) INTERNAL ASSERTION FAILED: `+n;throw hs(t),new Error(t)}function dn(n,t){n||Jt()}function Vt(n,t){return n}const Ze={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ot extends W.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Hs{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class fee{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class rwe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(mo.UNAUTHENTICATED))}shutdown(){}}class iwe{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class swe{constructor(t){this.t=t,this.currentUser=mo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var r=this;let i=this.i;const s=u=>this.i!==i?(i=this.i,e(u)):Promise.resolve();let o=new Hs;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Hs,t.enqueueRetryable(()=>s(this.currentUser))};const l=()=>{const u=o;t.enqueueRetryable((0,q.Z)(function*(){yield u.promise,yield s(r.currentUser)}))},c=u=>{Ct("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),l()};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ct("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Hs)}},0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?(Ct("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(dn("string"==typeof r.accessToken),new fee(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return dn(null===t||"string"==typeof t),new mo(t)}}class owe{constructor(t,e,r){this.h=t,this.l=e,this.m=r,this.type="FirstParty",this.user=mo.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const t=this.p();return t&&this.g.set("Authorization",t),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class awe{constructor(t,e,r){this.h=t,this.l=e,this.m=r}getToken(){return Promise.resolve(new owe(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable(()=>e(mo.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pee{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lwe{constructor(t){this.I=t,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(t,e){const r=s=>{null!=s.error&&Ct("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,Ct("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};const i=s=>{Ct("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):Ct("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(dn("string"==typeof e.token),this.T=e.token,new pee(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function cwe(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class mee{static A(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const i=cwe(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<e&&(r+=t.charAt(i[s]%t.length))}return r}}function Pn(n,t){return n<t?-1:n>t?1:0}function Yx(n,t,e){return n.length===t.length&&n.every((r,i)=>e(r,t[i]))}function gee(n){return n+"\0"}class Gr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ot(Ze.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ot(Ze.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ot(Ze.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ot(Ze.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Gr.fromMillis(Date.now())}static fromDate(t){return Gr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new Gr(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Pn(this.nanoseconds,t.nanoseconds):Pn(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class hn{constructor(t){this.timestamp=t}static fromTimestamp(t){return new hn(t)}static min(){return new hn(new Gr(0,0))}static max(){return new hn(new Gr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class cA{constructor(t,e,r){void 0===e?e=0:e>t.length&&Jt(),void 0===r?r=t.length-e:r>t.length-e&&Jt(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===cA.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof cA?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let i=0;i<r;i++){const s=t.get(i),o=e.get(i);if(s<o)return-1;if(s>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class xr extends cA{construct(t,e,r){return new xr(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new ot(Ze.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(i=>i.length>0))}return new xr(e)}static emptyPath(){return new xr([])}}const uwe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ji extends cA{construct(t,e,r){return new Ji(t,e,r)}static isValidIdentifier(t){return uwe.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ji.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ji(["__name__"])}static fromServerFormat(t){const e=[];let r="",i=0;const s=()=>{if(0===r.length)throw new ot(Ze.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;i<t.length;){const l=t[i];if("\\"===l){if(i+1===t.length)throw new ot(Ze.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new ot(Ze.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,i+=2}else"`"===l?(o=!o,i++):"."!==l||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new ot(Ze.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ji(e)}static emptyPath(){return new Ji([])}}class $t{constructor(t){this.path=t}static fromPath(t){return new $t(xr.fromString(t))}static fromName(t){return new $t(xr.fromString(t).popFirst(5))}static empty(){return new $t(xr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===xr.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return xr.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new $t(new xr(t.slice()))}}class N2{constructor(t,e,r,i){this.indexId=t,this.collectionGroup=e,this.fields=r,this.indexState=i}}function x6(n){return n.fields.find(t=>2===t.kind)}function rb(n){return n.fields.filter(t=>2!==t.kind)}N2.UNKNOWN_ID=-1;class R2{constructor(t,e){this.fieldPath=t,this.kind=e}}class uA{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new uA(0,ac.min())}}function _ee(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=hn.fromTimestamp(1e9===r?new Gr(e+1,0):new Gr(e,r));return new ac(i,$t.empty(),t)}function yee(n){return new ac(n.readTime,n.key,-1)}class ac{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new ac(hn.min(),$t.empty(),-1)}static max(){return new ac(hn.max(),$t.empty(),-1)}}function I6(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=$t.comparator(n.documentKey,t.documentKey),0!==e?e:Pn(n.largestBatchId,t.largestBatchId))}const vee="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bee{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}function xg(n){return T6.apply(this,arguments)}function T6(){return T6=(0,q.Z)(function*(n){if(n.code!==Ze.FAILED_PRECONDITION||n.message!==vee)throw n;Ct("LocalStore","Unexpectedly lost primary lease")}),T6.apply(this,arguments)}class Be{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Jt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Be((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(e,s).next(r,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof Be?e:Be.resolve(e)}catch(e){return Be.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):Be.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):Be.reject(e)}static resolve(t){return new Be((e,r)=>{e(t)})}static reject(t){return new Be((e,r)=>{r(t)})}static waitFor(t){return new Be((e,r)=>{let i=0,s=0,o=!1;t.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&e()},c=>r(c))}),o=!0,s===i&&e()})}static or(t){let e=Be.resolve(!1);for(const r of t)e=e.next(i=>i?Be.resolve(i):r());return e}static forEach(t,e){const r=[];return t.forEach((i,s)=>{r.push(e.call(this,i,s))}),this.waitFor(r)}static mapArray(t,e){return new Be((r,i)=>{const s=t.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;e(t[u]).next(f=>{o[u]=f,++l,l===s&&r(o)},f=>i(f))}})}static doWhile(t,e){return new Be((r,i)=>{const s=()=>{!0===t()?e().next(()=>{s()},i):r()};s()})}}class M2{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.v=new Hs,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{e.error?this.v.reject(new dA(t,e.error)):this.v.resolve()},this.transaction.onerror=r=>{const i=S6(r.target.error);this.v.reject(new dA(t,i))}}static open(t,e,r,i){try{return new M2(e,t.transaction(i,r))}catch(s){throw new dA(e,s)}}get R(){return this.v.promise}abort(t){t&&this.v.reject(t),this.aborted||(Ct("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new pwe(e)}}class Xu{constructor(t,e,r){this.name=t,this.version=e,this.V=r,12.2===Xu.S((0,W.z$)())&&hs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return Ct("SimpleDb","Removing database:",t),ib(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!(0,W.hl)())return!1;if(Xu.C())return!0;const t=(0,W.z$)(),e=Xu.S(t),r=0<e&&e<10,i=Xu.N(t),s=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||s)}static C(){var t;return typeof process<"u"&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.k)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static N(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}$(t){var e=this;return(0,q.Z)(function*(){return e.db||(Ct("SimpleDb","Opening database:",e.name),e.db=yield new Promise((r,i)=>{const s=indexedDB.open(e.name,e.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new dA(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const l=o.target.error;i("VersionError"===l.name?new ot(Ze.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===l.name?new ot(Ze.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l):new dA(t,l))},s.onupgradeneeded=o=>{Ct("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',o.oldVersion),e.V.O(o.target.result,s.transaction,o.oldVersion,e.version).next(()=>{Ct("SimpleDb","Database upgrade to version "+e.version+" complete")})}})),e.F&&(e.db.onversionchange=r=>e.F(r)),e.db})()}B(t){this.F=t,this.db&&(this.db.onversionchange=e=>t(e))}runTransaction(t,e,r,i){var s=this;return(0,q.Z)(function*(){const o="readonly"===e;let l=0;for(;;){++l;try{s.db=yield s.$(t);const c=M2.open(s.db,t,o?"readonly":"readwrite",r),u=i(c).next(f=>(c.P(),f)).catch(f=>(c.abort(f),Be.reject(f))).toPromise();return u.catch(()=>{}),yield c.R,u}catch(c){const u=c,f="FirebaseError"!==u.name&&l<3;if(Ct("SimpleDb","Transaction failed with error:",u.message,"Retrying:",f),s.close(),!f)return Promise.reject(u)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class fwe{constructor(t){this.L=t,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(t){this.L=t}done(){this.q=!0}G(t){this.U=t}delete(){return ib(this.L.delete())}}class dA extends ot{constructor(t,e){super(Ze.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Ig(n){return"IndexedDbTransactionError"===n.name}class pwe{constructor(t){this.store=t}put(t,e){let r;return void 0!==e?(Ct("SimpleDb","PUT",this.store.name,t,e),r=this.store.put(e,t)):(Ct("SimpleDb","PUT",this.store.name,"<auto-key>",t),r=this.store.put(t)),ib(r)}add(t){return Ct("SimpleDb","ADD",this.store.name,t,t),ib(this.store.add(t))}get(t){return ib(this.store.get(t)).next(e=>(void 0===e&&(e=null),Ct("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return Ct("SimpleDb","DELETE",this.store.name,t),ib(this.store.delete(t))}count(){return Ct("SimpleDb","COUNT",this.store.name),ib(this.store.count())}j(t,e){const r=this.options(t,e);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.W(i,(o,l)=>{s.push(l)}).next(()=>s)}{const i=this.store.getAll(r.range);return new Be((s,o)=>{i.onerror=l=>{o(l.target.error)},i.onsuccess=l=>{s(l.target.result)}})}}H(t,e){const r=this.store.getAll(t,null===e?void 0:e);return new Be((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}J(t,e){Ct("SimpleDb","DELETE ALL",this.store.name);const r=this.options(t,e);r.Y=!1;const i=this.cursor(r);return this.W(i,(s,o,l)=>l.delete())}X(t,e){let r;e?r=t:(r={},e=t);const i=this.cursor(r);return this.W(i,e)}Z(t){const e=this.cursor({});return new Be((r,i)=>{e.onerror=s=>{const o=S6(s.target.error);i(o)},e.onsuccess=s=>{const o=s.target.result;o?t(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}W(t,e){const r=[];return new Be((i,s)=>{t.onerror=o=>{s(o.target.error)},t.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const c=new fwe(l),u=e(l.primaryKey,l.value,c);if(u instanceof Be){const f=u.catch(m=>(c.done(),Be.reject(m)));r.push(f)}c.isDone?i():null===c.K?l.continue():l.continue(c.K)}}).next(()=>Be.waitFor(r))}options(t,e){let r;return void 0!==t&&("string"==typeof t?r=t:e=t),{index:r,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const r=this.store.index(t.index);return t.Y?r.openKeyCursor(t.range,e):r.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function ib(n){return new Be((t,e)=>{n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{const i=S6(r.target.error);e(i)}})}let wee=!1;function S6(n){const t=Xu.S((0,W.z$)());if(t>=12.2&&t<13){const e="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(e)>=0){const r=new ot("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return wee||(wee=!0,setTimeout(()=>{throw r},0)),r}}return n}class mwe{constructor(t,e){this.asyncQueue=t,this.tt=e,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(t){var e=this;Ct("IndexBackiller",`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,(0,q.Z)(function*(){e.task=null;try{Ct("IndexBackiller",`Documents written: ${yield e.tt.nt()}`)}catch(r){Ig(r)?Ct("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield xg(r)}yield e.et(6e4)}))}}class gwe{constructor(t,e){this.localStore=t,this.persistence=e}nt(t=50){var e=this;return(0,q.Z)(function*(){return e.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>e.st(r,t))})()}st(t,e){const r=new Set;let i=e,s=!0;return Be.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next(o=>{if(null!==o&&!r.has(o))return Ct("IndexBackiller",`Processing collection: ${o}`),this.it(t,o,i).next(l=>{i-=l,r.add(o)});s=!1})).next(()=>e-i)}it(t,e,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next(i=>this.localStore.localDocuments.getNextDocuments(t,e,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(t,o).next(()=>this.rt(i,s)).next(l=>(Ct("IndexBackiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(t,e,l))).next(()=>o.size)}))}rt(t,e){let r=t;return e.changes.forEach((i,s)=>{const o=yee(s);I6(o,r)>0&&(r=o)}),new ac(r.readTime,r.documentKey,Math.max(e.batchId,t.largestBatchId))}}let lc=(()=>{class n{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>r.writeSequenceNumber(i))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}return n.ct=-1,n})();function hA(n){return null==n}function fA(n){return 0===n&&1/n==-1/0}function Cee(n){return"number"==typeof n&&Number.isInteger(n)&&!fA(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function ha(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=xee(t)),t=_we(n.get(e),t);return xee(t)}function _we(n,t){let e=t;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":e+="\x01\x10";break;case"\x01":e+="\x01\x11";break;default:e+=s}}return e}function xee(n){return n+"\x01\x01"}function ih(n){const t=n.length;if(dn(t>=2),2===t)return dn("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),xr.emptyPath();const e=t-2,r=[];let i="";for(let s=0;s<t;){const o=n.indexOf("\x01",s);switch((o<0||o>e)&&Jt(),n.charAt(o+1)){case"\x01":const l=n.substring(s,o);let c;0===i.length?c=l:(i+=l,c=i,i=""),r.push(c);break;case"\x10":i+=n.substring(s,o),i+="\0";break;case"\x11":i+=n.substring(s,o+1);break;default:Jt()}s=o+2}return new xr(r)}const Iee=["userId","batchId"];function O2(n,t){return[n,ha(t)]}function Tee(n,t,e){return[n,ha(t),e]}const ywe={},vwe=["prefixPath","collectionGroup","readTime","documentId"],bwe=["prefixPath","collectionGroup","documentId"],wwe=["collectionGroup","readTime","prefixPath","documentId"],Cwe=["canonicalId","targetId"],xwe=["targetId","path"],Iwe=["path","targetId"],Twe=["collectionId","parent"],Swe=["indexId","uid"],Ewe=["uid","sequenceNumber"],Dwe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],kwe=["indexId","uid","orderedDocumentKey"],Awe=["userId","collectionPath","documentId"],Nwe=["userId","collectionPath","largestBatchId"],Rwe=["userId","collectionGroup","largestBatchId"],See=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Mwe=[...See,"documentOverlays"],Eee=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Dee=Eee,Owe=[...Dee,"indexConfiguration","indexState","indexEntries"];class E6 extends bee{constructor(t,e){super(),this.ht=t,this.currentSequenceNumber=e}}function go(n,t){const e=Vt(n);return Xu.M(e.ht,t)}function kee(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Tg(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function Aee(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class di{constructor(t,e){this.comparator=t,this.root=e||Wo.EMPTY}insert(t,e){return new di(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Wo.BLACK,null,null))}remove(t){return new di(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Wo.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(0===i)return e+r.left.size;i<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new F2(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new F2(this.root,t,this.comparator,!1)}getReverseIterator(){return new F2(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new F2(this.root,t,this.comparator,!0)}}class F2{constructor(t,e,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?r(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Wo{constructor(t,e,r,i,s){this.key=t,this.value=e,this.color=r??Wo.RED,this.left=i??Wo.EMPTY,this.right=s??Wo.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,i,s){return new Wo(t??this.key,e??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,r),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Wo.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return Wo.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Wo.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Wo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Jt();const t=this.left.check();if(t!==this.right.check())throw Jt();return t+(this.isRed()?0:1)}}Wo.EMPTY=null,Wo.RED=!0,Wo.BLACK=!1,Wo.EMPTY=new class{constructor(){this.size=0}get key(){throw Jt()}get value(){throw Jt()}get color(){throw Jt()}get left(){throw Jt()}get right(){throw Jt()}copy(n,t,e,r,i){return this}insert(n,t,e){return new Wo(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class xi{constructor(t){this.comparator=t,this.data=new di(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Nee(this.data.getIterator())}getIteratorFrom(t){return new Nee(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof xi)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new xi(this.comparator);return e.data=t,e}}class Nee{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Kx(n){return n.hasNext()?n.getNext():void 0}class Cl{constructor(t){this.fields=t,t.sort(Ji.comparator)}static empty(){return new Cl([])}unionWith(t){let e=new xi(Ji.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Cl(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Yx(this.fields,t.fields,(e,r)=>e.isEqual(r))}}class Ree extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Gs{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ree("Invalid base64 string: "+i):i}}(t);return new Gs(e)}static fromUint8Array(t){const e=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(t);return new Gs(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Pn(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Gs.EMPTY_BYTE_STRING=new Gs("");const Pwe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sg(n){if(dn(!!n),"string"==typeof n){let t=0;const e=Pwe.exec(n);if(dn(!!e),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:es(n.seconds),nanos:es(n.nanos)}}function es(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Kf(n){return"string"==typeof n?Gs.fromBase64String(n):Gs.fromUint8Array(n)}function P2(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function L2(n){const t=n.mapValue.fields.__previous_value__;return P2(t)?L2(t):t}function pA(n){const t=Sg(n.mapValue.fields.__local_write_time__.timestampValue);return new Gr(t.seconds,t.nanos)}class Lwe{constructor(t,e,r,i,s,o,l,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Eg{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Eg("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Eg&&t.projectId===this.projectId&&t.database===this.database}}const Dg={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},$2={nullValue:"NULL_VALUE"};function kg(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?P2(n)?4:Pee(n)?9007199254740991:10:Jt()}function sh(n,t){if(n===t)return!0;const e=kg(n);if(e!==kg(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return pA(n).isEqual(pA(t));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=Sg(r.timestampValue),o=Sg(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return i=t,Kf(n.bytesValue).isEqual(Kf(i.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,i){return es(r.geoPointValue.latitude)===es(i.geoPointValue.latitude)&&es(r.geoPointValue.longitude)===es(i.geoPointValue.longitude)}(n,t);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return es(r.integerValue)===es(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=es(r.doubleValue),o=es(i.doubleValue);return s===o?fA(s)===fA(o):isNaN(s)&&isNaN(o)}return!1}(n,t);case 9:return Yx(n.arrayValue.values||[],t.arrayValue.values||[],sh);case 10:return function(r,i){const s=r.mapValue.fields||{},o=i.mapValue.fields||{};if(kee(s)!==kee(o))return!1;for(const l in s)if(s.hasOwnProperty(l)&&(void 0===o[l]||!sh(s[l],o[l])))return!1;return!0}(n,t);default:return Jt()}var i}function mA(n,t){return void 0!==(n.values||[]).find(e=>sh(e,t))}function Ag(n,t){if(n===t)return 0;const e=kg(n),r=kg(t);if(e!==r)return Pn(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return Pn(n.booleanValue,t.booleanValue);case 2:return function(i,s){const o=es(i.integerValue||i.doubleValue),l=es(s.integerValue||s.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(n,t);case 3:return Mee(n.timestampValue,t.timestampValue);case 4:return Mee(pA(n),pA(t));case 5:return Pn(n.stringValue,t.stringValue);case 6:return function(i,s){const o=Kf(i),l=Kf(s);return o.compareTo(l)}(n.bytesValue,t.bytesValue);case 7:return function(i,s){const o=i.split("/"),l=s.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=Pn(o[c],l[c]);if(0!==u)return u}return Pn(o.length,l.length)}(n.referenceValue,t.referenceValue);case 8:return function(i,s){const o=Pn(es(i.latitude),es(s.latitude));return 0!==o?o:Pn(es(i.longitude),es(s.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(i,s){const o=i.values||[],l=s.values||[];for(let c=0;c<o.length&&c<l.length;++c){const u=Ag(o[c],l[c]);if(u)return u}return Pn(o.length,l.length)}(n.arrayValue,t.arrayValue);case 10:return function(i,s){if(i===Dg.mapValue&&s===Dg.mapValue)return 0;if(i===Dg.mapValue)return 1;if(s===Dg.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=s.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const m=Pn(l[f],u[f]);if(0!==m)return m;const _=Ag(o[l[f]],c[u[f]]);if(0!==_)return _}return Pn(l.length,u.length)}(n.mapValue,t.mapValue);default:throw Jt()}}function Mee(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return Pn(n,t);const e=Sg(n),r=Sg(t),i=Pn(e.seconds,r.seconds);return 0!==i?i:Pn(e.nanos,r.nanos)}function Qx(n){return D6(n)}function D6(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=Sg(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Kf(n.bytesValue).toBase64():"referenceValue"in n?$t.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(r){let i="[",s=!0;for(const o of r.values||[])s?s=!1:i+=",",i+=D6(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",o=!0;for(const l of i)o?o=!1:s+=",",s+=`${l}:${D6(r.fields[l])}`;return s+"}"}(n.mapValue):Jt();var t}function sb(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function k6(n){return!!n&&"integerValue"in n}function gA(n){return!!n&&"arrayValue"in n}function Oee(n){return!!n&&"nullValue"in n}function Fee(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function V2(n){return!!n&&"mapValue"in n}function _A(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Tg(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=_A(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=_A(n.arrayValue.values[e]);return t}return Object.assign({},n)}function Pee(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function $we(n){return"nullValue"in n?$2:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?sb(Eg.empty(),$t.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Jt()}function Bwe(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?sb(Eg.empty(),$t.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Dg:Jt()}function Lee(n,t){const e=Ag(n.value,t.value);return 0!==e?e:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function $ee(n,t){const e=Ag(n.value,t.value);return 0!==e?e:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}class jo{constructor(t){this.value=t}static empty(){return new jo({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!V2(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=_A(e)}setAll(t){let e=Ji.emptyPath(),r={},i=[];t.forEach((o,l)=>{if(!e.isImmediateParentOf(l)){const c=this.getFieldsMap(e);this.applyChanges(c,r,i),r={},i=[],e=l.popLast()}o?r[l.lastSegment()]=_A(o):i.push(l.lastSegment())});const s=this.getFieldsMap(e);this.applyChanges(s,r,i)}delete(t){const e=this.field(t.popLast());V2(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return sh(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=e.mapValue.fields[t.get(r)];V2(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,r){Tg(e,(i,s)=>t[i]=s);for(const i of r)delete t[i]}clone(){return new jo(_A(this.value))}}function Bee(n){const t=[];return Tg(n.fields,(e,r)=>{const i=new Ji([e]);if(V2(r)){const s=Bee(r.mapValue).fields;if(0===s.length)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new Cl(t)}class Ii{constructor(t,e,r,i,s,o,l){this.key=t,this.documentType=e,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(t){return new Ii(t,0,hn.min(),hn.min(),hn.min(),jo.empty(),0)}static newFoundDocument(t,e,r,i){return new Ii(t,1,e,hn.min(),r,i,0)}static newNoDocument(t,e){return new Ii(t,2,e,hn.min(),hn.min(),jo.empty(),0)}static newUnknownDocument(t,e){return new Ii(t,3,e,hn.min(),hn.min(),jo.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(hn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=jo.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=jo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=hn.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ii&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ii(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ng{constructor(t,e){this.position=t,this.inclusive=e}}function Vee(n,t,e){let r=0;for(let i=0;i<n.position.length;i++){const s=t[i],o=n.position[i];if(r=s.field.isKeyField()?$t.comparator($t.fromName(o.referenceValue),e.key):Ag(o,e.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Uee(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!sh(n.position[e],t.position[e]))return!1;return!0}class Xx{constructor(t,e="asc"){this.field=t,this.dir=e}}function Vwe(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class zee{}class pr extends zee{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,r):new Uwe(t,e,r):"array-contains"===e?new Gwe(t,r):"in"===e?new Zee(t,r):"not-in"===e?new Wwe(t,r):"array-contains-any"===e?new jwe(t,r):new pr(t,e,r)}static createKeyFieldInFilter(t,e,r){return"in"===e?new zwe(t,r):new Hwe(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Ag(e,this.value)):null!==e&&kg(this.value)===kg(e)&&this.matchesComparison(Ag(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Jt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Wr extends zee{constructor(t,e){super(),this.filters=t,this.op=e,this.lt=null}static create(t,e){return new Wr(t,e)}matches(t){return Jx(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.ft(e=>e.isInequality());return null!==t?t.field:null}ft(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function Jx(n){return"and"===n.op}function A6(n){return"or"===n.op}function N6(n){return Hee(n)&&Jx(n)}function Hee(n){for(const t of n.filters)if(t instanceof Wr)return!1;return!0}function R6(n){if(n instanceof pr)return n.field.canonicalString()+n.op.toString()+Qx(n.value);if(N6(n))return n.filters.map(t=>R6(t)).join(",");{const t=n.filters.map(e=>R6(e)).join(",");return`${n.op}(${t})`}}function Gee(n,t){return n instanceof pr?(e=n,(r=t)instanceof pr&&e.op===r.op&&e.field.isEqual(r.field)&&sh(e.value,r.value)):n instanceof Wr?function(e,r){return r instanceof Wr&&e.op===r.op&&e.filters.length===r.filters.length&&e.filters.reduce((i,s,o)=>i&&Gee(s,r.filters[o]),!0)}(n,t):void Jt();var e,r}function Wee(n,t){const e=n.filters.concat(t);return Wr.create(e,n.op)}function jee(n){return n instanceof pr?`${(t=n).field.canonicalString()} ${t.op} ${Qx(t.value)}`:n instanceof Wr?function(t){return t.op.toString()+" {"+t.getFilters().map(jee).join(" ,")+"}"}(n):"Filter";var t}class Uwe extends pr{constructor(t,e,r){super(t,e,r),this.key=$t.fromName(r.referenceValue)}matches(t){const e=$t.comparator(t.key,this.key);return this.matchesComparison(e)}}class zwe extends pr{constructor(t,e){super(t,"in",e),this.keys=qee(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Hwe extends pr{constructor(t,e){super(t,"not-in",e),this.keys=qee(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function qee(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(r=>$t.fromName(r.referenceValue))}class Gwe extends pr{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return gA(e)&&mA(e.arrayValue,this.value)}}class Zee extends pr{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&mA(this.value.arrayValue,e)}}class Wwe extends pr{constructor(t,e){super(t,"not-in",e)}matches(t){if(mA(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!mA(this.value.arrayValue,e)}}class jwe extends pr{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!gA(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>mA(this.value.arrayValue,r))}}class qwe{constructor(t,e=null,r=[],i=[],s=null,o=null,l=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.dt=null}}function M6(n,t=null,e=[],r=[],i=null,s=null,o=null){return new qwe(n,t,e,r,i,s,o)}function ob(n){const t=Vt(n);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>R6(r)).join(","),e+="|ob:",e+=t.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),hA(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>Qx(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>Qx(r)).join(",")),t.dt=e}return t.dt}function yA(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!Vwe(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Gee(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!Uee(n.startAt,t.startAt)&&Uee(n.endAt,t.endAt)}function U2(n){return $t.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function z2(n,t){return n.filters.filter(e=>e instanceof pr&&e.field.isEqual(t))}function Yee(n,t,e){let r=$2,i=!0;for(const s of z2(n,t)){let o=$2,l=!0;switch(s.op){case"<":case"<=":o=$we(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=$2}Lee({value:r,inclusive:i},{value:o,inclusive:l})<0&&(r=o,i=l)}if(null!==e)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(t)){const o=e.position[s];Lee({value:r,inclusive:i},{value:o,inclusive:e.inclusive})<0&&(r=o,i=e.inclusive);break}return{value:r,inclusive:i}}function Kee(n,t,e){let r=Dg,i=!0;for(const s of z2(n,t)){let o=Dg,l=!0;switch(s.op){case">=":case">":o=Bwe(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Dg}$ee({value:r,inclusive:i},{value:o,inclusive:l})>0&&(r=o,i=l)}if(null!==e)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(t)){const o=e.position[s];$ee({value:r,inclusive:i},{value:o,inclusive:e.inclusive})>0&&(r=o,i=e.inclusive);break}return{value:r,inclusive:i}}class Qf{constructor(t,e=null,r=[],i=[],s=null,o="F",l=null,c=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.wt=null,this._t=null}}function Qee(n,t,e,r,i,s,o,l){return new Qf(n,t,e,r,i,s,o,l)}function eI(n){return new Qf(n)}function Xee(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function O6(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function H2(n){for(const t of n.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function F6(n){return null!==n.collectionGroup}function ab(n){const t=Vt(n);if(null===t.wt){t.wt=[];const e=H2(t),r=O6(t);if(null!==e&&null===r)e.isKeyField()||t.wt.push(new Xx(e)),t.wt.push(new Xx(Ji.keyField(),"asc"));else{let i=!1;for(const s of t.explicitOrderBy)t.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new Xx(Ji.keyField(),s))}}}return t.wt}function ja(n){const t=Vt(n);if(!t._t)if("F"===t.limitType)t._t=M6(t.path,t.collectionGroup,ab(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const s of ab(t))e.push(new Xx(s.field,"desc"===s.dir?"asc":"desc"));const r=t.endAt?new Ng(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Ng(t.startAt.position,t.startAt.inclusive):null;t._t=M6(t.path,t.collectionGroup,e,t.filters,t.limit,r,i)}return t._t}function P6(n,t){t.getFirstInequalityField(),H2(n);const e=n.filters.concat([t]);return new Qf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function G2(n,t,e){return new Qf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function vA(n,t){return yA(ja(n),ja(t))&&n.limitType===t.limitType}function Jee(n){return`${ob(ja(n))}|lt:${n.limitType}`}function L6(n){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(r=>jee(r)).join(", ")}]`),hA(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(r=>{return`${(i=r).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>Qx(r)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>Qx(r)).join(",")),`Target(${e})`}(ja(n))}; limitType=${n.limitType})`}function bA(n,t){return t.isFoundDocument()&&function(e,r){const i=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(i):$t.isDocumentKey(e.path)?e.path.isEqual(i):e.path.isImmediateParentOf(i)}(n,t)&&function(e,r){for(const i of ab(e))if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,t)&&function(e,r){for(const i of e.filters)if(!i.matches(r))return!1;return!0}(n,t)&&(r=t,!((e=n).startAt&&!function(i,s,o){const l=Vee(i,s,o);return i.inclusive?l<=0:l<0}(e.startAt,ab(e),r)||e.endAt&&!function(i,s,o){const l=Vee(i,s,o);return i.inclusive?l>=0:l>0}(e.endAt,ab(e),r)));var e,r}function ete(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function tte(n){return(t,e)=>{let r=!1;for(const i of ab(n)){const s=Zwe(i,t,e);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function Zwe(n,t,e){const r=n.field.isKeyField()?$t.comparator(t.key,e.key):function(i,s,o){const l=s.data.field(i),c=o.data.field(i);return null!==l&&null!==c?Ag(l,c):Jt()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Jt()}}class Xf{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,t))return s}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),i=this.inner[r];if(void 0===i)return this.inner[r]=[[t,e]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return 1===r.length?delete this.inner[e]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Tg(this.inner,(e,r)=>{for(const[i,s]of r)t(i,s)})}isEmpty(){return Aee(this.inner)}size(){return this.innerSize}}const Ywe=new di($t.comparator);function xl(){return Ywe}const nte=new di($t.comparator);function wA(...n){let t=nte;for(const e of n)t=t.insert(e.key,e);return t}function rte(n){let t=nte;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function oh(){return CA()}function ite(){return CA()}function CA(){return new Xf(n=>n.toString(),(n,t)=>n.isEqual(t))}const Kwe=new di($t.comparator),Qwe=new xi($t.comparator);function jn(...n){let t=Qwe;for(const e of n)t=t.add(e);return t}const Xwe=new xi(Pn);function $6(){return Xwe}function ste(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fA(t)?"-0":t}}function ote(n){return{integerValue:""+n}}function ate(n,t){return Cee(t)?ote(t):ste(n,t)}class W2{constructor(){this._=void 0}}function Jwe(n,t,e){return n instanceof tI?function(r,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&P2(i)&&(i=L2(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(e,t):n instanceof lb?cte(n,t):n instanceof cb?ute(n,t):function(r,i){const s=lte(r,i),o=dte(s)+dte(r.gt);return k6(s)&&k6(r.gt)?ote(o):ste(r.serializer,o)}(n,t)}function eCe(n,t,e){return n instanceof lb?cte(n,t):n instanceof cb?ute(n,t):e}function lte(n,t){return n instanceof nI?k6(e=t)||(r=e)&&"doubleValue"in r?t:{integerValue:0}:null;var r,e}class tI extends W2{}class lb extends W2{constructor(t){super(),this.elements=t}}function cte(n,t){const e=hte(t);for(const r of n.elements)e.some(i=>sh(i,r))||e.push(r);return{arrayValue:{values:e}}}class cb extends W2{constructor(t){super(),this.elements=t}}function ute(n,t){let e=hte(t);for(const r of n.elements)e=e.filter(i=>!sh(i,r));return{arrayValue:{values:e}}}class nI extends W2{constructor(t,e){super(),this.serializer=t,this.gt=e}}function dte(n){return es(n.integerValue||n.doubleValue)}function hte(n){return gA(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class xA{constructor(t,e){this.field=t,this.transform=e}}class nCe{constructor(t,e){this.version=t,this.transformResults=e}}class Mi{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Mi}static exists(t){return new Mi(void 0,t)}static updateTime(t){return new Mi(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function j2(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class q2{}function fte(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new iI(n.key,Mi.none()):new rI(n.key,n.data,Mi.none());{const e=n.data,r=jo.empty();let i=new xi(Ji.comparator);for(let s of t.fields)if(!i.has(s)){let o=e.field(s);null===o&&s.length>1&&(s=s.popLast(),o=e.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new Jf(n.key,r,new Cl(i.toArray()),Mi.none())}}function rCe(n,t,e){n instanceof rI?function(r,i,s){const o=r.value.clone(),l=gte(r.fieldTransforms,i,s.transformResults);o.setAll(l),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(n,t,e):n instanceof Jf?function(r,i,s){if(!j2(r.precondition,i))return void i.convertToUnknownDocument(s.version);const o=gte(r.fieldTransforms,i,s.transformResults),l=i.data;l.setAll(mte(r)),l.setAll(o),i.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function IA(n,t,e,r){return n instanceof rI?function(i,s,o,l){if(!j2(i.precondition,s))return o;const c=i.value.clone(),u=_te(i.fieldTransforms,l,s);return c.setAll(u),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(n,t,e,r):n instanceof Jf?function(i,s,o,l){if(!j2(i.precondition,s))return o;const c=_te(i.fieldTransforms,l,s),u=s.data;return u.setAll(mte(i)),u.setAll(c),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null===o?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,t,e,r):(o=e,j2(n.precondition,s=t)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o);var s,o}function iCe(n,t){let e=null;for(const r of n.fieldTransforms){const i=t.data.field(r.field),s=lte(r.transform,i||null);null!=s&&(null===e&&(e=jo.empty()),e.set(r.field,s))}return e||null}function pte(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===r||e&&r&&Yx(e,r,(i,s)=>function tCe(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(e=n.transform)instanceof lb&&r instanceof lb||e instanceof cb&&r instanceof cb?Yx(e.elements,r.elements,sh):e instanceof nI&&r instanceof nI?sh(e.gt,r.gt):e instanceof tI&&r instanceof tI);var e,r}(i,s))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,r}class rI extends q2{constructor(t,e,r,i=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Jf extends q2{constructor(t,e,r,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function mte(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function gte(n,t,e){const r=new Map;dn(n.length===e.length);for(let i=0;i<e.length;i++){const s=n[i],o=s.transform,l=t.data.field(s.field);r.set(s.field,eCe(o,l,e[i]))}return r}function _te(n,t,e){const r=new Map;for(const i of n){const s=i.transform,o=e.data.field(i.field);r.set(i.field,Jwe(s,o,t))}return r}class iI extends q2{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class B6 extends q2{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class V6{constructor(t,e,r,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&rCe(s,t,r[i])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=IA(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=IA(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=ite();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=e.has(i.key)?null:l;const c=fte(o,l);null!==c&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(hn.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),jn())}isEqual(t){return this.batchId===t.batchId&&Yx(this.mutations,t.mutations,(e,r)=>pte(e,r))&&Yx(this.baseMutations,t.baseMutations,(e,r)=>pte(e,r))}}class U6{constructor(t,e,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=i}static from(t,e,r){dn(t.mutations.length===r.length);let i=Kwe;const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new U6(t,e,r,i)}}class z6{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class oCe{constructor(t,e){this.count=t,this.unchangedNames=e}}var Ss,Ir;function yte(n){switch(n){default:return Jt();case Ze.CANCELLED:case Ze.UNKNOWN:case Ze.DEADLINE_EXCEEDED:case Ze.RESOURCE_EXHAUSTED:case Ze.INTERNAL:case Ze.UNAVAILABLE:case Ze.UNAUTHENTICATED:return!1;case Ze.INVALID_ARGUMENT:case Ze.NOT_FOUND:case Ze.ALREADY_EXISTS:case Ze.PERMISSION_DENIED:case Ze.FAILED_PRECONDITION:case Ze.ABORTED:case Ze.OUT_OF_RANGE:case Ze.UNIMPLEMENTED:case Ze.DATA_LOSS:return!0}}function vte(n){if(void 0===n)return hs("GRPC error has no .code"),Ze.UNKNOWN;switch(n){case Ss.OK:return Ze.OK;case Ss.CANCELLED:return Ze.CANCELLED;case Ss.UNKNOWN:return Ze.UNKNOWN;case Ss.DEADLINE_EXCEEDED:return Ze.DEADLINE_EXCEEDED;case Ss.RESOURCE_EXHAUSTED:return Ze.RESOURCE_EXHAUSTED;case Ss.INTERNAL:return Ze.INTERNAL;case Ss.UNAVAILABLE:return Ze.UNAVAILABLE;case Ss.UNAUTHENTICATED:return Ze.UNAUTHENTICATED;case Ss.INVALID_ARGUMENT:return Ze.INVALID_ARGUMENT;case Ss.NOT_FOUND:return Ze.NOT_FOUND;case Ss.ALREADY_EXISTS:return Ze.ALREADY_EXISTS;case Ss.PERMISSION_DENIED:return Ze.PERMISSION_DENIED;case Ss.FAILED_PRECONDITION:return Ze.FAILED_PRECONDITION;case Ss.ABORTED:return Ze.ABORTED;case Ss.OUT_OF_RANGE:return Ze.OUT_OF_RANGE;case Ss.UNIMPLEMENTED:return Ze.UNIMPLEMENTED;case Ss.DATA_LOSS:return Ze.DATA_LOSS;default:return Jt()}}(Ir=Ss||(Ss={}))[Ir.OK=0]="OK",Ir[Ir.CANCELLED=1]="CANCELLED",Ir[Ir.UNKNOWN=2]="UNKNOWN",Ir[Ir.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ir[Ir.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ir[Ir.NOT_FOUND=5]="NOT_FOUND",Ir[Ir.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ir[Ir.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ir[Ir.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ir[Ir.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ir[Ir.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ir[Ir.ABORTED=10]="ABORTED",Ir[Ir.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ir[Ir.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ir[Ir.INTERNAL=13]="INTERNAL",Ir[Ir.UNAVAILABLE=14]="UNAVAILABLE",Ir[Ir.DATA_LOSS=15]="DATA_LOSS";class H6{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Z2}static getOrCreateInstance(){return null===Z2&&(Z2=new H6),Z2}onExistenceFilterMismatch(t){const e=Symbol();return this.onExistenceFilterMismatchCallbacks.set(e,t),()=>this.onExistenceFilterMismatchCallbacks.delete(e)}notifyOnExistenceFilterMismatch(t){this.onExistenceFilterMismatchCallbacks.forEach(e=>e(t))}}let Z2=null;function bte(){return new TextEncoder}const aCe=new qx([4294967295,4294967295],0);function wte(n){const t=bte().encode(n),e=new ewe;return e.update(t),new Uint8Array(e.digest())}function Cte(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new qx([e,r],0),new qx([i,s],0)]}class G6{constructor(t,e,r){if(this.bitmap=t,this.padding=e,this.hashCount=r,e<0||e>=8)throw new TA(`Invalid padding: ${e}`);if(r<0)throw new TA(`Invalid hash count: ${r}`);if(t.length>0&&0===this.hashCount)throw new TA(`Invalid hash count: ${r}`);if(0===t.length&&0!==e)throw new TA(`Invalid padding when bitmap length is 0: ${e}`);this.It=8*t.length-e,this.Tt=qx.fromNumber(this.It)}Et(t,e,r){let i=t.add(e.multiply(qx.fromNumber(r)));return 1===i.compare(aCe)&&(i=new qx([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}vt(t){if(0===this.It)return!1;const e=wte(t),[r,i]=Cte(e);for(let s=0;s<this.hashCount;s++){const o=this.Et(r,i,s);if(!this.At(o))return!1}return!0}static create(t,e,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new G6(s,i,e);return r.forEach(l=>o.insert(l)),o}insert(t){if(0===this.It)return;const e=wte(t),[r,i]=Cte(e);for(let s=0;s<this.hashCount;s++){const o=this.Et(r,i,s);this.Rt(o)}}Rt(t){const e=Math.floor(t/8);this.bitmap[e]|=1<<t%8}}class TA extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class SA{constructor(t,e,r,i,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const i=new Map;return i.set(t,EA.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new SA(hn.min(),i,new di(Pn),xl(),jn())}}class EA{constructor(t,e,r,i,s){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new EA(r,e,jn(),jn(),jn())}}class Y2{constructor(t,e,r,i){this.Pt=t,this.removedTargetIds=e,this.key=r,this.bt=i}}class xte{constructor(t,e){this.targetId=t,this.Vt=e}}class Ite{constructor(t,e,r=Gs.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=i}}class Tte{constructor(){this.St=0,this.Dt=Ete(),this.Ct=Gs.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(t){t.approximateByteSize()>0&&(this.Nt=!0,this.Ct=t)}Ot(){let t=jn(),e=jn(),r=jn();return this.Dt.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:r=r.add(i);break;default:Jt()}}),new EA(this.Ct,this.xt,t,e,r)}Ft(){this.Nt=!1,this.Dt=Ete()}Bt(t,e){this.Nt=!0,this.Dt=this.Dt.insert(t,e)}Lt(t){this.Nt=!0,this.Dt=this.Dt.remove(t)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class lCe{constructor(t){this.Gt=t,this.Qt=new Map,this.jt=xl(),this.zt=Ste(),this.Wt=new di(Pn)}Ht(t){for(const e of t.Pt)t.bt&&t.bt.isFoundDocument()?this.Jt(e,t.bt):this.Yt(e,t.key,t.bt);for(const e of t.removedTargetIds)this.Yt(e,t.key,t.bt)}Xt(t){this.forEachTarget(t,e=>{const r=this.Zt(e);switch(t.state){case 0:this.te(e)&&r.$t(t.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(t.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(e);break;case 3:this.te(e)&&(r.Kt(),r.$t(t.resumeToken));break;case 4:this.te(e)&&(this.ee(e),r.$t(t.resumeToken));break;default:Jt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Qt.forEach((r,i)=>{this.te(i)&&e(i)})}ne(t){var e;const r=t.targetId,i=t.Vt.count,s=this.se(r);if(s){const o=s.target;if(U2(o))if(0===i){const l=new $t(o.path);this.Yt(r,l,Ii.newNoDocument(l,hn.min()))}else dn(1===i);else{const l=this.ie(r);if(l!==i){const c=this.re(t,l);0!==c&&(this.ee(r),this.Wt=this.Wt.insert(r,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(e=H6.instance)||void 0===e||e.notifyOnExistenceFilterMismatch(function(u,f,m){var _,y,w,T,I,E;const A={localCacheCount:f,existenceFilterCount:m.count},M=m.unchangedNames;return M&&(A.bloomFilter={applied:0===u,hashCount:null!==(_=M?.hashCount)&&void 0!==_?_:0,bitmapLength:null!==(T=null===(w=null===(y=M?.bits)||void 0===y?void 0:y.bitmap)||void 0===w?void 0:w.length)&&void 0!==T?T:0,padding:null!==(E=null===(I=M?.bits)||void 0===I?void 0:I.padding)&&void 0!==E?E:0}),A}(c,l,t.Vt))}}}}re(t,e){const{unchangedNames:r,count:i}=t.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:l=0}=r;let c,u;try{c=Kf(s).toUint8Array()}catch(f){if(f instanceof Ree)return Zc("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw f}try{u=new G6(c,o,l)}catch(f){return Zc(f instanceof TA?"BloomFilter error: ":"Applying bloom filter failed: ",f),1}return 0===u.It?1:i!==e-this.oe(t.targetId,u)?2:0}oe(t,e){const r=this.Gt.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Gt.ue(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.vt(l)||(this.Yt(t,s,null),i++)}),i}ce(t){const e=new Map;this.Qt.forEach((s,o)=>{const l=this.se(o);if(l){if(s.current&&U2(l.target)){const c=new $t(l.target.path);null!==this.jt.get(c)||this.ae(o,c)||this.Yt(o,c,Ii.newNoDocument(c,t))}s.Mt&&(e.set(o,s.Ot()),s.Ft())}});let r=jn();this.zt.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.se(c);return!u||"TargetPurposeLimboResolution"===u.purpose||(l=!1,!1)}),l&&(r=r.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(t));const i=new SA(t,e,this.Wt,this.jt,r);return this.jt=xl(),this.zt=Ste(),this.Wt=new di(Pn),i}Jt(t,e){if(!this.te(t))return;const r=this.ae(t,e.key)?2:0;this.Zt(t).Bt(e.key,r),this.jt=this.jt.insert(e.key,e),this.zt=this.zt.insert(e.key,this.he(e.key).add(t))}Yt(t,e,r){if(!this.te(t))return;const i=this.Zt(t);this.ae(t,e)?i.Bt(e,1):i.Lt(e),this.zt=this.zt.insert(e,this.he(e).delete(t)),r&&(this.jt=this.jt.insert(e,r))}removeTarget(t){this.Qt.delete(t)}ie(t){const e=this.Zt(t).Ot();return this.Gt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}qt(t){this.Zt(t).qt()}Zt(t){let e=this.Qt.get(t);return e||(e=new Tte,this.Qt.set(t,e)),e}he(t){let e=this.zt.get(t);return e||(e=new xi(Pn),this.zt=this.zt.insert(t,e)),e}te(t){const e=null!==this.se(t);return e||Ct("WatchChangeAggregator","Detected inactive target",t),e}se(t){const e=this.Qt.get(t);return e&&e.kt?null:this.Gt.le(t)}ee(t){this.Qt.set(t,new Tte),this.Gt.getRemoteKeysForTarget(t).forEach(e=>{this.Yt(t,e,null)})}ae(t,e){return this.Gt.getRemoteKeysForTarget(t).has(e)}}function Ste(){return new di($t.comparator)}function Ete(){return new di($t.comparator)}const cCe={asc:"ASCENDING",desc:"DESCENDING"},uCe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dCe={and:"AND",or:"OR"};class hCe{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function W6(n,t){return n.useProto3Json||hA(t)?t:{value:t}}function sI(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Dte(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function fCe(n,t){return sI(n,t.toTimestamp())}function fs(n){return dn(!!n),hn.fromTimestamp(function(t){const e=Sg(t);return new Gr(e.seconds,e.nanos)}(n))}function j6(n,t){return(e=n,new xr(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function kte(n){const t=xr.fromString(n);return dn($te(t)),t}function DA(n,t){return j6(n.databaseId,t.path)}function ah(n,t){const e=kte(t);if(e.get(1)!==n.databaseId.projectId)throw new ot(Ze.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new ot(Ze.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new $t(Nte(e))}function q6(n,t){return j6(n.databaseId,t)}function Ate(n){const t=kte(n);return 4===t.length?xr.emptyPath():Nte(t)}function kA(n){return new xr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Nte(n){return dn(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Rte(n,t,e){return{name:DA(n,t),fields:e.value.mapValue.fields}}function Mte(n,t,e){const r=ah(n,t.name),i=fs(t.updateTime),s=t.createTime?fs(t.createTime):hn.min(),o=new jo({mapValue:{fields:t.fields}}),l=Ii.newFoundDocument(r,i,s,o);return e&&l.setHasCommittedMutations(),e?l.setHasCommittedMutations():l}function AA(n,t){let e;if(t instanceof rI)e={update:Rte(n,t.key,t.value)};else if(t instanceof iI)e={delete:DA(n,t.key)};else if(t instanceof Jf)e={update:Rte(n,t.key,t.data),updateMask:wCe(t.fieldMask)};else{if(!(t instanceof B6))return Jt();e={verify:DA(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(i,s){const o=s.transform;if(o instanceof tI)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof lb)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof cb)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof nI)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw Jt()}(0,r))),t.precondition.isNone||(e.currentDocument=void 0!==(i=t.precondition).updateTime?{updateTime:fCe(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:Jt()),e;var i}function Z6(n,t){const e=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?Mi.updateTime(fs(i.updateTime)):void 0!==i.exists?Mi.exists(i.exists):Mi.none():Mi.none(),r=t.updateTransforms?t.updateTransforms.map(i=>function(s,o){let l=null;"setToServerValue"in o?(dn("REQUEST_TIME"===o.setToServerValue),l=new tI):"appendMissingElements"in o?l=new lb(o.appendMissingElements.values||[]):"removeAllFromArray"in o?l=new cb(o.removeAllFromArray.values||[]):"increment"in o?l=new nI(s,o.increment):Jt();const c=Ji.fromServerFormat(o.fieldPath);return new xA(c,l)}(n,i)):[];var i;if(t.update){const i=ah(n,t.update.name),s=new jo({mapValue:{fields:t.update.fields}});if(t.updateMask){const o=new Cl((t.updateMask.fieldPaths||[]).map(u=>Ji.fromServerFormat(u)));return new Jf(i,s,o,e,r)}return new rI(i,s,e,r)}if(t.delete){const i=ah(n,t.delete);return new iI(i,e)}if(t.verify){const i=ah(n,t.verify);return new B6(i,e)}return Jt()}function Ote(n,t){return{documents:[q6(n,t.path)]}}function Y6(n,t){const e={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(e.parent=q6(n,r),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=q6(n,r.popLast()),e.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(c){if(0!==c.length)return Lte(Wr.create(c,"and"))}(t.filters);i&&(e.structuredQuery.where=i);const s=function(c){if(0!==c.length)return c.map(u=>{return{field:Rg((f=u).field),direction:yCe(f.dir)};var f})}(t.orderBy);s&&(e.structuredQuery.orderBy=s);const o=W6(n,t.limit);var l,c;return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(e.structuredQuery.endAt={before:!(c=t.endAt).inclusive,values:c.position}),e}function Fte(n){let t=Ate(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let i=null;if(r>0){dn(1===r);const f=e.from[0];f.allDescendants?i=f.collectionId:t=t.child(f.collectionId)}let s=[];e.where&&(s=function(f){const m=Pte(f);return m instanceof Wr&&N6(m)?m.getFilters():[m]}(e.where));let o=[];e.orderBy&&(o=e.orderBy.map(f=>{return new Xx(oI((m=f).field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let l=null;e.limit&&(l=function(f){let m;return m="object"==typeof f?f.value:f,hA(m)?null:m}(e.limit));let c=null;var f;e.startAt&&(c=new Ng((f=e.startAt).values||[],!!f.before));let u=null;return e.endAt&&(u=function(f){return new Ng(f.values||[],!f.before)}(e.endAt)),Qee(t,i,o,s,l,"F",c,u)}function Pte(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=oI(t.unaryFilter.field);return pr.create(e,"==",{doubleValue:NaN});case"IS_NULL":const r=oI(t.unaryFilter.field);return pr.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=oI(t.unaryFilter.field);return pr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=oI(t.unaryFilter.field);return pr.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Jt()}}(n):void 0!==n.fieldFilter?pr.create(oI((t=n).fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Jt()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return Wr.create(t.compositeFilter.filters.map(e=>Pte(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Jt()}}(t.compositeFilter.op))}(n):Jt();var t}function yCe(n){return cCe[n]}function vCe(n){return uCe[n]}function bCe(n){return dCe[n]}function Rg(n){return{fieldPath:n.canonicalString()}}function oI(n){return Ji.fromServerFormat(n.fieldPath)}function Lte(n){return n instanceof pr?function(t){if("=="===t.op){if(Fee(t.value))return{unaryFilter:{field:Rg(t.field),op:"IS_NAN"}};if(Oee(t.value))return{unaryFilter:{field:Rg(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Fee(t.value))return{unaryFilter:{field:Rg(t.field),op:"IS_NOT_NAN"}};if(Oee(t.value))return{unaryFilter:{field:Rg(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rg(t.field),op:vCe(t.op),value:t.value}}}(n):n instanceof Wr?function(t){const e=t.getFilters().map(r=>Lte(r));return 1===e.length?e[0]:{compositeFilter:{op:bCe(t.op),filters:e}}}(n):Jt()}function wCe(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function $te(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class ep{constructor(t,e,r,i,s=hn.min(),o=hn.min(),l=Gs.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(t){return new ep(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ep(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ep(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ep(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Bte{constructor(t){this.fe=t}}function Vte(n,t){const e=t.key,r={prefixPath:e.getCollectionPath().popLast().toArray(),collectionGroup:e.collectionGroup,documentId:e.path.lastSegment(),readTime:K2(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document={name:DA(i=n.fe,(s=t).key),fields:s.data.value.mapValue.fields,updateTime:sI(i,s.version.toTimestamp()),createTime:sI(i,s.createTime.toTimestamp())};else if(t.isNoDocument())r.noDocument={path:e.path.toArray(),readTime:ub(t.version)};else{if(!t.isUnknownDocument())return Jt();r.unknownDocument={path:e.path.toArray(),version:ub(t.version)}}var i,s;return r}function K2(n){const t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function ub(n){const t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function db(n){const t=new Gr(n.seconds,n.nanoseconds);return hn.fromTimestamp(t)}function hb(n,t){const e=(t.baseMutations||[]).map(s=>Z6(n.fe,s));for(let s=0;s<t.mutations.length-1;++s){const o=t.mutations[s];s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform&&(o.updateTransforms=t.mutations[s+1].transform.fieldTransforms,t.mutations.splice(s+1,1),++s)}const r=t.mutations.map(s=>Z6(n.fe,s)),i=Gr.fromMillis(t.localWriteTimeMs);return new V6(t.batchId,i,e,r)}function NA(n){const t=db(n.readTime),e=void 0!==n.lastLimboFreeSnapshotVersion?db(n.lastLimboFreeSnapshotVersion):hn.min();let r;var i;return void 0!==n.query.documents?(dn(1===(i=n.query).documents.length),r=ja(eI(Ate(i.documents[0])))):r=ja(Fte(n.query)),new ep(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,t,e,Gs.fromBase64String(n.resumeToken))}function Ute(n,t){const e=ub(t.snapshotVersion),r=ub(t.lastLimboFreeSnapshotVersion);let i;i=U2(t.target)?Ote(n.fe,t.target):Y6(n.fe,t.target);const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:ob(t.target),readTime:e,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function K6(n){const t=Fte({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?G2(t,t.limit,"L"):t}function Q6(n,t){return new z6(t.largestBatchId,Z6(n.fe,t.overlayMutation))}function zte(n,t){const e=t.path.lastSegment();return[n,ha(t.path.popLast()),e]}function Hte(n,t,e,r){return{indexId:n,uid:t.uid||"",sequenceNumber:e,readTime:ub(r.readTime),documentKey:ha(r.documentKey.path),largestBatchId:r.largestBatchId}}class xCe{getBundleMetadata(t,e){return Gte(t).get(e).next(r=>{if(r)return{id:(i=r).bundleId,createTime:db(i.createTime),version:i.version};var i})}saveBundleMetadata(t,e){return Gte(t).put({bundleId:(r=e).id,createTime:ub(fs(r.createTime)),version:r.version});var r}getNamedQuery(t,e){return Wte(t).get(e).next(r=>{if(r)return{name:(i=r).name,query:K6(i.bundledQuery),readTime:db(i.readTime)};var i})}saveNamedQuery(t,e){return Wte(t).put({name:(r=e).name,readTime:ub(fs(r.readTime)),bundledQuery:r.bundledQuery});var r}}function Gte(n){return go(n,"bundles")}function Wte(n){return go(n,"namedQueries")}class Q2{constructor(t,e){this.serializer=t,this.userId=e}static de(t,e){return new Q2(t,e.uid||"")}getOverlay(t,e){return RA(t).get(zte(this.userId,e)).next(r=>r?Q6(this.serializer,r):null)}getOverlays(t,e){const r=oh();return Be.forEach(e,i=>this.getOverlay(t,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(t,e,r){const i=[];return r.forEach((s,o)=>{const l=new z6(e,o);i.push(this.we(t,l))}),Be.waitFor(i)}removeOverlaysForBatchId(t,e,r){const i=new Set;e.forEach(o=>i.add(ha(o.getCollectionPath())));const s=[];return i.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(RA(t).J("collectionPathOverlayIndex",l))}),Be.waitFor(s)}getOverlaysForCollection(t,e,r){const i=oh(),s=ha(e),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return RA(t).j("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const u=Q6(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(t,e,r,i){const s=oh();let o;const l=IDBKeyRange.bound([this.userId,e,r],[this.userId,e,Number.POSITIVE_INFINITY],!0);return RA(t).X({index:"collectionGroupOverlayIndex",range:l},(c,u,f)=>{const m=Q6(this.serializer,u);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>s)}we(t,e){return RA(t).put(function(r,i,s){const[o,l,c]=zte(i,s.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:AA(r.fe,s.mutation)}}(this.serializer,this.userId,e))}}function RA(n){return go(n,"documentOverlays")}class fb{constructor(){}_e(t,e){this.me(t,e),e.ge()}me(t,e){if("nullValue"in t)this.ye(e,5);else if("booleanValue"in t)this.ye(e,10),e.pe(t.booleanValue?1:0);else if("integerValue"in t)this.ye(e,15),e.pe(es(t.integerValue));else if("doubleValue"in t){const r=es(t.doubleValue);isNaN(r)?this.ye(e,13):(this.ye(e,15),fA(r)?e.pe(0):e.pe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.ye(e,20),"string"==typeof r?e.Ie(r):(e.Ie(`${r.seconds||""}`),e.pe(r.nanos||0))}else if("stringValue"in t)this.Te(t.stringValue,e),this.Ee(e);else if("bytesValue"in t)this.ye(e,30),e.Ae(Kf(t.bytesValue)),this.Ee(e);else if("referenceValue"in t)this.ve(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.ye(e,45),e.pe(r.latitude||0),e.pe(r.longitude||0)}else"mapValue"in t?Pee(t)?this.ye(e,Number.MAX_SAFE_INTEGER):(this.Re(t.mapValue,e),this.Ee(e)):"arrayValue"in t?(this.Pe(t.arrayValue,e),this.Ee(e)):Jt()}Te(t,e){this.ye(e,25),this.be(t,e)}be(t,e){e.Ie(t)}Re(t,e){const r=t.fields||{};this.ye(e,55);for(const i of Object.keys(r))this.Te(i,e),this.me(r[i],e)}Pe(t,e){const r=t.values||[];this.ye(e,50);for(const i of r)this.me(i,e)}ve(t,e){this.ye(e,37),$t.fromName(t).path.forEach(r=>{this.ye(e,60),this.be(r,e)})}ye(t,e){t.pe(e)}Ee(t){t.pe(2)}}function ICe(n){if(0===n)return 8;let t=0;return n>>4==0&&(t+=4,n<<=4),n>>6==0&&(t+=2,n<<=2),n>>7==0&&(t+=1),t}function jte(n){const t=64-function(e){let r=0;for(let i=0;i<8;++i){const s=ICe(255&e[i]);if(r+=s,8!==s)break}return r}(n);return Math.ceil(t/8)}fb.Ve=new fb;class TCe{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(t){const e=t[Symbol.iterator]();let r=e.next();for(;!r.done;)this.De(r.value),r=e.next();this.Ce()}xe(t){const e=t[Symbol.iterator]();let r=e.next();for(;!r.done;)this.Ne(r.value),r=e.next();this.ke()}Me(t){for(const e of t){const r=e.charCodeAt(0);if(r<128)this.De(r);else if(r<2048)this.De(960|r>>>6),this.De(128|63&r);else if(e<"\ud800"||"\udbff"<e)this.De(480|r>>>12),this.De(128|63&r>>>6),this.De(128|63&r);else{const i=e.codePointAt(0);this.De(240|i>>>18),this.De(128|63&i>>>12),this.De(128|63&i>>>6),this.De(128|63&i)}}this.Ce()}$e(t){for(const e of t){const r=e.charCodeAt(0);if(r<128)this.Ne(r);else if(r<2048)this.Ne(960|r>>>6),this.Ne(128|63&r);else if(e<"\ud800"||"\udbff"<e)this.Ne(480|r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r);else{const i=e.codePointAt(0);this.Ne(240|i>>>18),this.Ne(128|63&i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i)}}this.ke()}Oe(t){const e=this.Fe(t),r=jte(e);this.Be(1+r),this.buffer[this.position++]=255&r;for(let i=e.length-r;i<e.length;++i)this.buffer[this.position++]=255&e[i]}Le(t){const e=this.Fe(t),r=jte(e);this.Be(1+r),this.buffer[this.position++]=~(255&r);for(let i=e.length-r;i<e.length;++i)this.buffer[this.position++]=~(255&e[i])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(t){this.Be(t.length),this.buffer.set(t,this.position),this.position+=t.length}Qe(){return this.buffer.slice(0,this.position)}Fe(t){const e=function(i){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(t),r=0!=(128&e[0]);e[0]^=r?255:128;for(let i=1;i<e.length;++i)e[i]^=r?255:0;return e}De(t){const e=255&t;0===e?(this.Ue(0),this.Ue(255)):255===e?(this.Ue(255),this.Ue(0)):this.Ue(e)}Ne(t){const e=255&t;0===e?(this.Ge(0),this.Ge(255)):255===e?(this.Ge(255),this.Ge(0)):this.Ge(t)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(t){this.Be(1),this.buffer[this.position++]=t}Ge(t){this.Be(1),this.buffer[this.position++]=~t}Be(t){const e=t+this.position;if(e<=this.buffer.length)return;let r=2*this.buffer.length;r<e&&(r=e);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class SCe{constructor(t){this.je=t}Ae(t){this.je.Se(t)}Ie(t){this.je.Me(t)}pe(t){this.je.Oe(t)}ge(){this.je.qe()}}class ECe{constructor(t){this.je=t}Ae(t){this.je.xe(t)}Ie(t){this.je.$e(t)}pe(t){this.je.Le(t)}ge(){this.je.Ke()}}class MA{constructor(){this.je=new TCe,this.ze=new SCe(this.je),this.We=new ECe(this.je)}seed(t){this.je.seed(t)}He(t){return 0===t?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}class pb{constructor(t,e,r,i){this.indexId=t,this.documentKey=e,this.arrayValue=r,this.directionalValue=i}Je(){const t=this.directionalValue.length,e=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(e);return r.set(this.directionalValue,0),e!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new pb(this.indexId,this.documentKey,this.arrayValue,r)}}function Mg(n,t){let e=n.indexId-t.indexId;return 0!==e?e:(e=qte(n.arrayValue,t.arrayValue),0!==e?e:(e=qte(n.directionalValue,t.directionalValue),0!==e?e:$t.comparator(n.documentKey,t.documentKey)))}function qte(n,t){for(let e=0;e<n.length&&e<t.length;++e){const r=n[e]-t[e];if(0!==r)return r}return n.length-t.length}class DCe{constructor(t){this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ye=t.orderBy,this.Xe=[];for(const e of t.filters){const r=e;r.isInequality()?this.Ze=r:this.Xe.push(r)}}tn(t){dn(t.collectionGroup===this.collectionId);const e=x6(t);if(void 0!==e&&!this.en(e))return!1;const r=rb(t);let i=new Set,s=0,o=0;for(;s<r.length&&this.en(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(void 0!==this.Ze){if(!i.has(this.Ze.field.canonicalString())){const l=r[s];if(!this.nn(this.Ze,l)||!this.sn(this.Ye[o++],l))return!1}++s}for(;s<r.length;++s){const l=r[s];if(o>=this.Ye.length||!this.sn(this.Ye[o++],l))return!1}return!0}en(t){for(const e of this.Xe)if(this.nn(e,t))return!0;return!1}nn(t,e){return!(void 0===t||!t.field.isEqual(e.fieldPath))&&2===e.kind==("array-contains"===t.op||"array-contains-any"===t.op)}sn(t,e){return!!t.field.isEqual(e.fieldPath)&&(0===e.kind&&"asc"===t.dir||1===e.kind&&"desc"===t.dir)}}function Zte(n){var t,e;if(dn(n instanceof pr||n instanceof Wr),n instanceof pr){if(n instanceof Zee){const i=(null===(e=null===(t=n.value.arrayValue)||void 0===t?void 0:t.values)||void 0===e?void 0:e.map(s=>pr.create(n.field,"==",s)))||[];return Wr.create(i,"or")}return n}const r=n.filters.map(i=>Zte(i));return Wr.create(r,n.op)}function kCe(n){if(0===n.getFilters().length)return[];const t=eW(Zte(n));return dn(Yte(t)),X6(t)||J6(t)?[t]:t.getFilters()}function X6(n){return n instanceof pr}function J6(n){return n instanceof Wr&&N6(n)}function Yte(n){return X6(n)||J6(n)||function(t){if(t instanceof Wr&&A6(t)){for(const e of t.getFilters())if(!X6(e)&&!J6(e))return!1;return!0}return!1}(n)}function eW(n){if(dn(n instanceof pr||n instanceof Wr),n instanceof pr)return n;if(1===n.filters.length)return eW(n.filters[0]);const t=n.filters.map(r=>eW(r));let e=Wr.create(t,n.op);return e=X2(e),Yte(e)?e:(dn(e instanceof Wr),dn(Jx(e)),dn(e.filters.length>1),e.filters.reduce((r,i)=>tW(r,i)))}function tW(n,t){let e;return dn(n instanceof pr||n instanceof Wr),dn(t instanceof pr||t instanceof Wr),e=n instanceof pr?t instanceof pr?Wr.create([n,t],"and"):Kte(n,t):t instanceof pr?Kte(t,n):function(r,i){if(dn(r.filters.length>0&&i.filters.length>0),Jx(r)&&Jx(i))return Wee(r,i.getFilters());const s=A6(r)?r:i,o=A6(r)?i:r,l=s.filters.map(c=>tW(c,o));return Wr.create(l,"or")}(n,t),X2(e)}function Kte(n,t){if(Jx(t))return Wee(t,n.getFilters());{const e=t.filters.map(r=>tW(n,r));return Wr.create(e,"or")}}function X2(n){if(dn(n instanceof pr||n instanceof Wr),n instanceof pr)return n;const t=n.getFilters();if(1===t.length)return X2(t[0]);if(Hee(n))return n;const e=t.map(i=>X2(i)),r=[];return e.forEach(i=>{i instanceof pr?r.push(i):i instanceof Wr&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:Wr.create(r,n.op)}class ACe{constructor(){this.rn=new nW}addToCollectionParentIndex(t,e){return this.rn.add(e),Be.resolve()}getCollectionParents(t,e){return Be.resolve(this.rn.getEntries(e))}addFieldIndex(t,e){return Be.resolve()}deleteFieldIndex(t,e){return Be.resolve()}getDocumentsMatchingTarget(t,e){return Be.resolve(null)}getIndexType(t,e){return Be.resolve(0)}getFieldIndexes(t,e){return Be.resolve([])}getNextCollectionGroupToUpdate(t){return Be.resolve(null)}getMinOffset(t,e){return Be.resolve(ac.min())}getMinOffsetFromCollectionGroup(t,e){return Be.resolve(ac.min())}updateCollectionGroup(t,e,r){return Be.resolve()}updateIndexEntries(t,e){return Be.resolve()}}class nW{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),i=this.index[e]||new xi(xr.comparator),s=!i.has(r);return this.index[e]=i.add(r),s}has(t){const e=t.lastSegment(),r=t.popLast(),i=this.index[e];return i&&i.has(r)}getEntries(t){return(this.index[t]||new xi(xr.comparator)).toArray()}}const J2=new Uint8Array(0);class NCe{constructor(t,e){this.user=t,this.databaseId=e,this.on=new nW,this.un=new Xf(r=>ob(r),(r,i)=>yA(r,i)),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this.on.has(e)){const r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(()=>{this.on.add(e)});const s={collectionId:r,parent:ha(i)};return Qte(t).put(s)}return Be.resolve()}getCollectionParents(t,e){const r=[],i=IDBKeyRange.bound([e,""],[gee(e),""],!1,!0);return Qte(t).j(i).next(s=>{for(const o of s){if(o.collectionId!==e)break;r.push(ih(o.parent))}return r})}addFieldIndex(t,e){const r=eL(t),i={indexId:(o=e).indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])};var o;delete i.indexId;const s=r.add(i);if(e.indexState){const o=FA(t);return s.next(l=>{o.put(Hte(l,this.user,e.indexState.sequenceNumber,e.indexState.offset))})}return s.next()}deleteFieldIndex(t,e){const r=eL(t),i=FA(t),s=OA(t);return r.delete(e.indexId).next(()=>i.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))}getDocumentsMatchingTarget(t,e){const r=OA(t);let i=!0;const s=new Map;return Be.forEach(this.cn(e),o=>this.an(t,o).next(l=>{i&&(i=!!l),s.set(o,l)})).next(()=>{if(i){let o=jn();const l=[];return Be.forEach(s,(c,u)=>{var f;Ct("IndexedDbIndexManager",`Using index ${f=c,`id=${f.indexId}|cg=${f.collectionGroup}|f=${f.fields.map(M=>`${M.fieldPath}:${M.kind}`).join(",")}`} to execute ${ob(e)}`);const m=function(M,O){const $=x6(O);if(void 0===$)return null;for(const V of z2(M,$.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null}(u,c),_=function(M,O){const $=new Map;for(const V of rb(O))for(const Z of z2(M,V.fieldPath))switch(Z.op){case"==":case"in":$.set(V.fieldPath.canonicalString(),Z.value);break;case"not-in":case"!=":return $.set(V.fieldPath.canonicalString(),Z.value),Array.from($.values())}return null}(u,c),y=function(M,O){const $=[];let V=!0;for(const Z of rb(O)){const Q=0===Z.kind?Yee(M,Z.fieldPath,M.startAt):Kee(M,Z.fieldPath,M.startAt);$.push(Q.value),V&&(V=Q.inclusive)}return new Ng($,V)}(u,c),w=function(M,O){const $=[];let V=!0;for(const Z of rb(O)){const Q=0===Z.kind?Kee(M,Z.fieldPath,M.endAt):Yee(M,Z.fieldPath,M.endAt);$.push(Q.value),V&&(V=Q.inclusive)}return new Ng($,V)}(u,c),T=this.hn(c,u,y),I=this.hn(c,u,w),E=this.ln(c,u,_),A=this.fn(c.indexId,m,T,y.inclusive,I,w.inclusive,E);return Be.forEach(A,M=>r.H(M,e.limit).next(O=>{O.forEach($=>{const V=$t.fromSegments($.documentKey);o.has(V)||(o=o.add(V),l.push(V))})}))}).next(()=>l)}return Be.resolve(null)})}cn(t){let e=this.un.get(t);return e||(e=0===t.filters.length?[t]:kCe(Wr.create(t.filters,"and")).map(r=>M6(t.path,t.collectionGroup,t.orderBy,r.getFilters(),t.limit,t.startAt,t.endAt)),this.un.set(t,e),e)}fn(t,e,r,i,s,o,l){const c=(null!=e?e.length:1)*Math.max(r.length,s.length),u=c/(null!=e?e.length:1),f=[];for(let m=0;m<c;++m){const _=e?this.dn(e[m/u]):J2,y=this.wn(t,_,r[m%u],i),w=this._n(t,_,s[m%u],o),T=l.map(I=>this.wn(t,_,I,!0));f.push(...this.createRange(y,w,T))}return f}wn(t,e,r,i){const s=new pb(t,$t.empty(),e,r);return i?s:s.Je()}_n(t,e,r,i){const s=new pb(t,$t.empty(),e,r);return i?s.Je():s}an(t,e){const r=new DCe(e),i=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,i).next(s=>{let o=null;for(const l of s)r.tn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(t,e){let r=2;const i=this.cn(e);return Be.forEach(i,s=>this.an(t,s).next(o=>{o?0!==r&&o.fields.length<function(l){let c=new xi(Ji.comparator),u=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?u=!0:c=c.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>null!==e.limit&&i.length>1&&2===r?1:r)}mn(t,e){const r=new MA;for(const i of rb(t)){const s=e.data.field(i.fieldPath);if(null==s)return null;const o=r.He(i.kind);fb.Ve._e(s,o)}return r.Qe()}dn(t){const e=new MA;return fb.Ve._e(t,e.He(0)),e.Qe()}gn(t,e){const r=new MA;return fb.Ve._e(sb(this.databaseId,e),r.He(function(i){const s=rb(i);return 0===s.length?0:s[s.length-1].kind}(t))),r.Qe()}ln(t,e,r){if(null===r)return[];let i=[];i.push(new MA);let s=0;for(const o of rb(t)){const l=r[s++];for(const c of i)if(this.yn(e,o.fieldPath)&&gA(l))i=this.pn(i,o,l);else{const u=c.He(o.kind);fb.Ve._e(l,u)}}return this.In(i)}hn(t,e,r){return this.ln(t,e,r.position)}In(t){const e=[];for(let r=0;r<t.length;++r)e[r]=t[r].Qe();return e}pn(t,e,r){const i=[...t],s=[];for(const o of r.arrayValue.values||[])for(const l of i){const c=new MA;c.seed(l.Qe()),fb.Ve._e(o,c.He(e.kind)),s.push(c)}return s}yn(t,e){return!!t.filters.find(r=>r instanceof pr&&r.field.isEqual(e)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(t,e){const r=eL(t),i=FA(t);return(e?r.j("collectionGroupIndex",IDBKeyRange.bound(e,e)):r.j()).next(s=>{const o=[];return Be.forEach(s,l=>i.get([l.indexId,this.uid]).next(c=>{o.push(function(u,f){const m=f?new uA(f.sequenceNumber,new ac(db(f.readTime),new $t(ih(f.documentKey)),f.largestBatchId)):uA.empty(),_=u.fields.map(([y,w])=>new R2(Ji.fromServerFormat(y),w));return new N2(u.indexId,u.collectionGroup,_,m)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next(e=>0===e.length?null:(e.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:Pn(r.collectionGroup,i.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(t,e,r){const i=eL(t),s=FA(t);return this.Tn(t).next(o=>i.j("collectionGroupIndex",IDBKeyRange.bound(e,e)).next(l=>Be.forEach(l,c=>s.put(Hte(c.indexId,this.user,o,r)))))}updateIndexEntries(t,e){const r=new Map;return Be.forEach(e,(i,s)=>{const o=r.get(i.collectionGroup);return(o?Be.resolve(o):this.getFieldIndexes(t,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),Be.forEach(l,c=>this.En(t,i,c).next(u=>{const f=this.An(s,c);return u.isEqual(f)?Be.resolve():this.vn(t,s,c,u,f)}))))})}Rn(t,e,r,i){return OA(t).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,e.key),documentKey:e.key.path.toArray()})}Pn(t,e,r,i){return OA(t).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,e.key),e.key.path.toArray()])}En(t,e,r){const i=OA(t);let s=new xi(Mg);return i.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,e)])},(o,l)=>{s=s.add(new pb(r.indexId,e,l.arrayValue,l.directionalValue))}).next(()=>s)}An(t,e){let r=new xi(Mg);const i=this.mn(e,t);if(null==i)return r;const s=x6(e);if(null!=s){const o=t.data.field(s.fieldPath);if(gA(o))for(const l of o.arrayValue.values||[])r=r.add(new pb(e.indexId,t.key,this.dn(l),i))}else r=r.add(new pb(e.indexId,t.key,J2,i));return r}vn(t,e,r,i,s){Ct("IndexedDbIndexManager","Updating index entries for document '%s'",e.key);const o=[];return function(l,c,u,f,m){const _=l.getIterator(),y=c.getIterator();let w=Kx(_),T=Kx(y);for(;w||T;){let I=!1,E=!1;if(w&&T){const A=u(w,T);A<0?E=!0:A>0&&(I=!0)}else null!=w?E=!0:I=!0;I?(f(T),T=Kx(y)):E?(m(w),w=Kx(_)):(w=Kx(_),T=Kx(y))}}(i,s,Mg,l=>{o.push(this.Rn(t,e,r,l))},l=>{o.push(this.Pn(t,e,r,l))}),Be.waitFor(o)}Tn(t){let e=1;return FA(t).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),e=i.sequenceNumber+1}).next(()=>e)}createRange(t,e,r){r=r.sort((o,l)=>Mg(o,l)).filter((o,l,c)=>!l||0!==Mg(o,c[l-1]));const i=[];i.push(t);for(const o of r){const l=Mg(o,t),c=Mg(o,e);if(0===l)i[0]=t.Je();else if(l>0&&c<0)i.push(o),i.push(o.Je());else if(c>0)break}i.push(e);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,J2,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,J2,[]]))}return s}bn(t,e){return Mg(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(Xte)}getMinOffset(t,e){return Be.mapArray(this.cn(e),r=>this.an(t,r).next(i=>i||Jt())).next(Xte)}}function Qte(n){return go(n,"collectionParents")}function OA(n){return go(n,"indexEntries")}function eL(n){return go(n,"indexConfiguration")}function FA(n){return go(n,"indexState")}function Xte(n){dn(0!==n.length);let t=n[0].indexState.offset,e=t.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;I6(i,t)<0&&(t=i),e<i.largestBatchId&&(e=i.largestBatchId)}return new ac(t.readTime,t.documentKey,e)}const Jte={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class fa{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new fa(t,fa.DEFAULT_COLLECTION_PERCENTILE,fa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function ene(n,t,e){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(e.batchId);let l=0;const c=r.X({range:o},(f,m,_)=>(l++,_.delete()));s.push(c.next(()=>{dn(1===l)}));const u=[];for(const f of e.mutations){const m=Tee(t,f.key.path,e.batchId);s.push(i.delete(m)),u.push(f.key)}return Be.waitFor(s).next(()=>u)}function tL(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw Jt();t=n.noDocument}return JSON.stringify(t).length}fa.DEFAULT_COLLECTION_PERCENTILE=10,fa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fa.DEFAULT=new fa(41943040,fa.DEFAULT_COLLECTION_PERCENTILE,fa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fa.DISABLED=new fa(-1,0,0);class nL{constructor(t,e,r,i){this.userId=t,this.serializer=e,this.indexManager=r,this.referenceDelegate=i,this.Vn={}}static de(t,e,r,i){dn(""!==t.uid);const s=t.isAuthenticated()?t.uid:"";return new nL(s,e,r,i)}checkEmpty(t){let e=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Og(t).X({index:"userMutationsIndex",range:r},(i,s,o)=>{e=!1,o.done()}).next(()=>e)}addMutationBatch(t,e,r,i){const s=aI(t),o=Og(t);return o.add({}).next(l=>{dn("number"==typeof l);const c=new V6(l,e,r,i),u=function(_,y,w){const T=w.baseMutations.map(E=>AA(_.fe,E)),I=w.mutations.map(E=>AA(_.fe,E));return{userId:y,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:T,mutations:I}}(this.serializer,this.userId,c),f=[];let m=new xi((_,y)=>Pn(_.canonicalString(),y.canonicalString()));for(const _ of i){const y=Tee(this.userId,_.key.path,l);m=m.add(_.key.path.popLast()),f.push(o.put(u)),f.push(s.put(y,ywe))}return m.forEach(_=>{f.push(this.indexManager.addToCollectionParentIndex(t,_))}),t.addOnCommittedListener(()=>{this.Vn[l]=c.keys()}),Be.waitFor(f).next(()=>c)})}lookupMutationBatch(t,e){return Og(t).get(e).next(r=>r?(dn(r.userId===this.userId),hb(this.serializer,r)):null)}Sn(t,e){return this.Vn[e]?Be.resolve(this.Vn[e]):this.lookupMutationBatch(t,e).next(r=>{if(r){const i=r.keys();return this.Vn[e]=i,i}return null})}getNextMutationBatchAfterBatchId(t,e){const r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Og(t).X({index:"userMutationsIndex",range:i},(o,l,c)=>{l.userId===this.userId&&(dn(l.batchId>=r),s=hb(this.serializer,l)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Og(t).X({index:"userMutationsIndex",range:e,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(t){const e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Og(t).j("userMutationsIndex",e).next(r=>r.map(i=>hb(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(t,e){const r=O2(this.userId,e.path),i=IDBKeyRange.lowerBound(r),s=[];return aI(t).X({range:i},(o,l,c)=>{const[u,f,m]=o,_=ih(f);if(u===this.userId&&e.path.isEqual(_))return Og(t).get(m).next(y=>{if(!y)throw Jt();dn(y.userId===this.userId),s.push(hb(this.serializer,y))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new xi(Pn);const i=[];return e.forEach(s=>{const o=O2(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=aI(t).X({range:l},(u,f,m)=>{const[_,y,w]=u,T=ih(y);_===this.userId&&s.path.isEqual(T)?r=r.add(w):m.done()});i.push(c)}),Be.waitFor(i).next(()=>this.Dn(t,r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,i=r.length+1,s=O2(this.userId,r),o=IDBKeyRange.lowerBound(s);let l=new xi(Pn);return aI(t).X({range:o},(c,u,f)=>{const[m,_,y]=c,w=ih(_);m===this.userId&&r.isPrefixOf(w)?w.length===i&&(l=l.add(y)):f.done()}).next(()=>this.Dn(t,l))}Dn(t,e){const r=[],i=[];return e.forEach(s=>{i.push(Og(t).get(s).next(o=>{if(null===o)throw Jt();dn(o.userId===this.userId),r.push(hb(this.serializer,o))}))}),Be.waitFor(i).next(()=>r)}removeMutationBatch(t,e){return ene(t.ht,this.userId,e).next(r=>(t.addOnCommittedListener(()=>{this.Cn(e.batchId)}),Be.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(t,i))))}Cn(t){delete this.Vn[t]}performConsistencyCheck(t){return this.checkEmpty(t).next(e=>{if(!e)return Be.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return aI(t).X({range:r},(s,o,l)=>{if(s[0]===this.userId){const c=ih(s[1]);i.push(c)}else l.done()}).next(()=>{dn(0===i.length)})})}containsKey(t,e){return tne(t,this.userId,e)}xn(t){return nne(t).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function tne(n,t,e){const r=O2(t,e.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return aI(n).X({range:s,Y:!0},(l,c,u)=>{const[f,m,_]=l;f===t&&m===i&&(o=!0),u.done()}).next(()=>o)}function Og(n){return go(n,"mutations")}function aI(n){return go(n,"documentMutations")}function nne(n){return go(n,"mutationQueues")}class mb{constructor(t){this.Nn=t}next(){return this.Nn+=2,this.Nn}static kn(){return new mb(0)}static Mn(){return new mb(-1)}}class RCe{constructor(t,e){this.referenceDelegate=t,this.serializer=e}allocateTargetId(t){return this.$n(t).next(e=>{const r=new mb(e.highestTargetId);return e.highestTargetId=r.next(),this.On(t,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(t){return this.$n(t).next(e=>hn.fromTimestamp(new Gr(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(t){return this.$n(t).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(t,e,r){return this.$n(t).next(i=>(i.highestListenSequenceNumber=e,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),this.On(t,i)))}addTargetData(t,e){return this.Fn(t,e).next(()=>this.$n(t).next(r=>(r.targetCount+=1,this.Bn(e,r),this.On(t,r))))}updateTargetData(t,e){return this.Fn(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>lI(t).delete(e.targetId)).next(()=>this.$n(t)).next(r=>(dn(r.targetCount>0),r.targetCount-=1,this.On(t,r)))}removeTargets(t,e,r){let i=0;const s=[];return lI(t).X((o,l)=>{const c=NA(l);c.sequenceNumber<=e&&null===r.get(c.targetId)&&(i++,s.push(this.removeTargetData(t,c)))}).next(()=>Be.waitFor(s)).next(()=>i)}forEachTarget(t,e){return lI(t).X((r,i)=>{const s=NA(i);e(s)})}$n(t){return rne(t).get("targetGlobalKey").next(e=>(dn(null!==e),e))}On(t,e){return rne(t).put("targetGlobalKey",e)}Fn(t,e){return lI(t).put(Ute(this.serializer,e))}Bn(t,e){let r=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,r=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,r=!0),r}getTargetCount(t){return this.$n(t).next(e=>e.targetCount)}getTargetData(t,e){const r=ob(e),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return lI(t).X({range:i,index:"queryTargetsIndex"},(o,l,c)=>{const u=NA(l);yA(e,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(t,e,r){const i=[],s=Fg(t);return e.forEach(o=>{const l=ha(o.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(t,r,o))}),Be.waitFor(i)}removeMatchingKeys(t,e,r){const i=Fg(t);return Be.forEach(e,s=>{const o=ha(s.path);return Be.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(t,r,s)])})}removeMatchingKeysForTargetId(t,e){const r=Fg(t),i=IDBKeyRange.bound([e],[e+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(t,e){const r=IDBKeyRange.bound([e],[e+1],!1,!0),i=Fg(t);let s=jn();return i.X({range:r,Y:!0},(o,l,c)=>{const u=ih(o[1]),f=new $t(u);s=s.add(f)}).next(()=>s)}containsKey(t,e){const r=ha(e.path),i=IDBKeyRange.bound([r],[gee(r)],!1,!0);let s=0;return Fg(t).X({index:"documentTargetsIndex",Y:!0,range:i},([o,l],c,u)=>{0!==o&&(s++,u.done())}).next(()=>s>0)}le(t,e){return lI(t).get(e).next(r=>r?NA(r):null)}}function lI(n){return go(n,"targets")}function rne(n){return go(n,"targetGlobal")}function Fg(n){return go(n,"targetDocuments")}function ine([n,t],[e,r]){const i=Pn(n,e);return 0===i?Pn(t,r):i}class MCe{constructor(t){this.Ln=t,this.buffer=new xi(ine),this.qn=0}Un(){return++this.qn}Kn(t){const e=[t,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(e);else{const r=this.buffer.last();ine(e,r)<0&&(this.buffer=this.buffer.delete(r).add(e))}}get maxValue(){return this.buffer.last()[0]}}class sne{constructor(t,e,r){this.garbageCollector=t,this.asyncQueue=e,this.localStore=r,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(t){var e=this;Ct("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(0,q.Z)(function*(){e.Gn=null;try{yield e.localStore.collectGarbage(e.garbageCollector)}catch(r){Ig(r)?Ct("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield xg(r)}yield e.Qn(3e5)}))}}class OCe{constructor(t,e){this.jn=t,this.params=e}calculateTargetCount(t,e){return this.jn.zn(t).next(r=>Math.floor(e/100*r))}nthSequenceNumber(t,e){if(0===e)return Be.resolve(lc.ct);const r=new MCe(e);return this.jn.forEachTarget(t,i=>r.Kn(i.sequenceNumber)).next(()=>this.jn.Wn(t,i=>r.Kn(i))).next(()=>r.maxValue)}removeTargets(t,e,r){return this.jn.removeTargets(t,e,r)}removeOrphanedDocuments(t,e){return this.jn.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(Ct("LruGarbageCollector","Garbage collection skipped; disabled"),Be.resolve(Jte)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(Ct("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Jte):this.Hn(t,e))}getCacheSize(t){return this.jn.getCacheSize(t)}Hn(t,e){let r,i,s,o,l,c,u;const f=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(Ct("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(t,i))).next(m=>(r=m,l=Date.now(),this.removeTargets(t,r,e))).next(m=>(s=m,c=Date.now(),this.removeOrphanedDocuments(t,r))).next(m=>(u=Date.now(),w6()<=$o.in.DEBUG&&Ct("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-f}ms\n\tDetermined least recently used ${i} in `+(l-o)+`ms\n\tRemoved ${s} targets in `+(c-l)+`ms\n\tRemoved ${m} documents in `+(u-c)+`ms\nTotal Duration: ${u-f}ms`),Be.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}class FCe{constructor(t,e){this.db=t,this.garbageCollector=function one(n,t){return new OCe(n,t)}(this,e)}zn(t){const e=this.Jn(t);return this.db.getTargetCache().getTargetCount(t).next(r=>e.next(i=>r+i))}Jn(t){let e=0;return this.Wn(t,r=>{e++}).next(()=>e)}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}Wn(t,e){return this.Yn(t,(r,i)=>e(i))}addReference(t,e,r){return rL(t,r)}removeReference(t,e,r){return rL(t,r)}removeTargets(t,e,r){return this.db.getTargetCache().removeTargets(t,e,r)}markPotentiallyOrphaned(t,e){return rL(t,e)}Xn(t,e){return function(r,i){let s=!1;return nne(r).Z(o=>tne(r,o,i).next(l=>(l&&(s=!0),Be.resolve(!l)))).next(()=>s)}(t,e)}removeOrphanedDocuments(t,e){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Yn(t,(o,l)=>{if(l<=e){const c=this.Xn(t,o).next(u=>{if(!u)return s++,r.getEntry(t,o).next(()=>(r.removeEntry(o,hn.min()),Fg(t).delete([0,ha(o.path)])))});i.push(c)}}).next(()=>Be.waitFor(i)).next(()=>r.apply(t)).next(()=>s)}removeTarget(t,e){const r=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,r)}updateLimboDocument(t,e){return rL(t,e)}Yn(t,e){const r=Fg(t);let i,s=lc.ct;return r.X({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:u})=>{0===o?(s!==lc.ct&&e(new $t(ih(i)),s),s=u,i=c):s=lc.ct}).next(()=>{s!==lc.ct&&e(new $t(ih(i)),s)})}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function rL(n,t){return Fg(n).put((r=n.currentSequenceNumber,{targetId:0,path:ha(t.path),sequenceNumber:r}));var r}class ane{constructor(){this.changes=new Xf(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ii.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?Be.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class PCe{constructor(t){this.serializer=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,r){return gb(t).put(r)}removeEntry(t,e,r){return gb(t).delete(function(i,s){const o=i.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],K2(s),o[o.length-1]]}(e,r))}updateMetadata(t,e){return this.getMetadata(t).next(r=>(r.byteSize+=e,this.Zn(t,r)))}getEntry(t,e){let r=Ii.newInvalidDocument(e);return gb(t).X({index:"documentKeyIndex",range:IDBKeyRange.only(PA(e))},(i,s)=>{r=this.ts(e,s)}).next(()=>r)}es(t,e){let r={size:0,document:Ii.newInvalidDocument(e)};return gb(t).X({index:"documentKeyIndex",range:IDBKeyRange.only(PA(e))},(i,s)=>{r={document:this.ts(e,s),size:tL(s)}}).next(()=>r)}getEntries(t,e){let r=xl();return this.ns(t,e,(i,s)=>{const o=this.ts(i,s);r=r.insert(i,o)}).next(()=>r)}ss(t,e){let r=xl(),i=new di($t.comparator);return this.ns(t,e,(s,o)=>{const l=this.ts(s,o);r=r.insert(s,l),i=i.insert(s,tL(o))}).next(()=>({documents:r,rs:i}))}ns(t,e,r){if(e.isEmpty())return Be.resolve();let i=new xi(dne);e.forEach(c=>i=i.add(c));const s=IDBKeyRange.bound(PA(i.first()),PA(i.last())),o=i.getIterator();let l=o.getNext();return gb(t).X({index:"documentKeyIndex",range:s},(c,u,f)=>{const m=$t.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&dne(l,m)<0;)r(l,null),l=o.getNext();l&&l.isEqual(m)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?f.G(PA(l)):f.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(t,e,r,i){const s=e.path,o=[s.popLast().toArray(),s.lastSegment(),K2(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gb(t).j(IDBKeyRange.bound(o,l,!0)).next(c=>{let u=xl();for(const f of c){const m=this.ts($t.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(bA(e,m)||i.has(m.key))&&(u=u.insert(m.key,m))}return u})}getAllFromCollectionGroup(t,e,r,i){let s=xl();const o=une(e,r),l=une(e,ac.max());return gb(t).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,u,f)=>{const m=this.ts($t.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(m.key,m),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(t){return new LCe(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next(e=>e.byteSize)}getMetadata(t){return cne(t).get("remoteDocumentGlobalKey").next(e=>(dn(!!e),e))}Zn(t,e){return cne(t).put("remoteDocumentGlobalKey",e)}ts(t,e){if(e){const r=function CCe(n,t){let e;if(t.document)e=Mte(n.fe,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const r=$t.fromSegments(t.noDocument.path),i=db(t.noDocument.readTime);e=Ii.newNoDocument(r,i),t.hasCommittedMutations&&e.setHasCommittedMutations()}else{if(!t.unknownDocument)return Jt();{const r=$t.fromSegments(t.unknownDocument.path),i=db(t.unknownDocument.version);e=Ii.newUnknownDocument(r,i)}}return t.readTime&&e.setReadTime(function(r){const i=new Gr(r[0],r[1]);return hn.fromTimestamp(i)}(t.readTime)),e}(this.serializer,e);if(!r.isNoDocument()||!r.version.isEqual(hn.min()))return r}return Ii.newInvalidDocument(t)}}function lne(n){return new PCe(n)}class LCe extends ane{constructor(t,e){super(),this.os=t,this.trackRemovals=e,this.us=new Xf(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(t){const e=[];let r=0,i=new xi((s,o)=>Pn(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.us.get(s);if(e.push(this.os.removeEntry(t,s,l.readTime)),o.isValidDocument()){const c=Vte(this.os.serializer,o);i=i.add(s.path.popLast()),r+=tL(c)-l.size,e.push(this.os.addEntry(t,s,c))}else if(r-=l.size,this.trackRemovals){const c=Vte(this.os.serializer,o.convertToNoDocument(hn.min()));e.push(this.os.addEntry(t,s,c))}}),i.forEach(s=>{e.push(this.os.indexManager.addToCollectionParentIndex(t,s))}),e.push(this.os.updateMetadata(t,r)),Be.waitFor(e)}getFromCache(t,e){return this.os.es(t,e).next(r=>(this.us.set(e,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(t,e){return this.os.ss(t,e).next(({documents:r,rs:i})=>(i.forEach((s,o)=>{this.us.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function cne(n){return go(n,"remoteDocumentGlobal")}function gb(n){return go(n,"remoteDocumentsV14")}function PA(n){const t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function une(n,t){const e=t.documentKey.path.toArray();return[n,K2(t.readTime),e.slice(0,e.length-2),e.length>0?e[e.length-1]:""]}function dne(n,t){const e=n.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<e.length-2&&s<r.length-2;++s)if(i=Pn(e[s],r[s]),i)return i;return i=Pn(e.length,r.length),i||(i=Pn(e[e.length-2],r[r.length-2]),i||Pn(e[e.length-1],r[r.length-1]))}class $Ce{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class hne{constructor(t,e,r,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,e))).next(i=>(null!==r&&IA(r.mutation,i,Cl.empty(),Gr.now()),i))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,jn()).next(()=>r))}getLocalViewOfDocuments(t,e,r=jn()){const i=oh();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,r).next(s=>{let o=wA();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=oh();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,jn()))}populateOverlays(t,e,r){const i=[];return r.forEach(s=>{e.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,l)=>{e.set(o,l)})})}computeViews(t,e,r,i){let s=xl();const o=CA(),l=CA();return e.forEach((c,u)=>{const f=r.get(u.key);i.has(u.key)&&(void 0===f||f.mutation instanceof Jf)?s=s.insert(u.key,u):void 0!==f?(o.set(u.key,f.mutation.getFieldMask()),IA(f.mutation,u,f.mutation.getFieldMask(),Gr.now())):o.set(u.key,Cl.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((u,f)=>o.set(u,f)),e.forEach((u,f)=>{var m;return l.set(u,new $Ce(f,null!==(m=o.get(u))&&void 0!==m?m:null))}),l))}recalculateAndSaveOverlays(t,e){const r=CA();let i=new di((o,l)=>o-l),s=jn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=e.get(c);if(null===u)return;let f=r.get(c)||Cl.empty();f=l.applyToLocalView(u,f),r.set(c,f);const m=(i.get(l.batchId)||jn()).add(c);i=i.insert(l.batchId,m)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,m=ite();f.forEach(_=>{if(!s.has(_)){const y=fte(e.get(_),r.get(_));null!==y&&m.set(_,y),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(t,u,m))}return Be.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r){return $t.isDocumentKey((i=e).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):F6(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r);var i}getNextDocuments(t,e,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,i-s.size):Be.resolve(oh());let l=-1,c=s;return o.next(u=>Be.forEach(u,(f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(f)?Be.resolve():this.remoteDocumentCache.getEntry(t,f).next(_=>{c=c.insert(f,_)}))).next(()=>this.populateOverlays(t,u,s)).next(()=>this.computeViews(t,c,u,jn())).next(f=>({batchId:l,changes:rte(f)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new $t(e)).next(r=>{let i=wA();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,e,r){const i=e.collectionGroup;let s=wA();return this.indexManager.getCollectionParents(t,i).next(o=>Be.forEach(o,l=>{const c=(u=e,f=l.child(i),new Qf(f,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt));var u,f;return this.getDocumentsMatchingCollectionQuery(t,c,r).next(u=>{u.forEach((f,m)=>{s=s.insert(f,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(t,e,r){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,r,i))).next(s=>{i.forEach((l,c)=>{const u=c.getKey();null===s.get(u)&&(s=s.insert(u,Ii.newInvalidDocument(u)))});let o=wA();return s.forEach((l,c)=>{const u=i.get(l);void 0!==u&&IA(u.mutation,c,Cl.empty(),Gr.now()),bA(e,c)&&(o=o.insert(l,c))}),o})}}class BCe{constructor(t){this.serializer=t,this.cs=new Map,this.hs=new Map}getBundleMetadata(t,e){return Be.resolve(this.cs.get(e))}saveBundleMetadata(t,e){var r;return this.cs.set(e.id,{id:(r=e).id,version:r.version,createTime:fs(r.createTime)}),Be.resolve()}getNamedQuery(t,e){return Be.resolve(this.hs.get(e))}saveNamedQuery(t,e){return this.hs.set(e.name,{name:(r=e).name,query:K6(r.bundledQuery),readTime:fs(r.readTime)}),Be.resolve();var r}}class VCe{constructor(){this.overlays=new di($t.comparator),this.ls=new Map}getOverlay(t,e){return Be.resolve(this.overlays.get(e))}getOverlays(t,e){const r=oh();return Be.forEach(e,i=>this.getOverlay(t,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((i,s)=>{this.we(t,e,s)}),Be.resolve()}removeOverlaysForBatchId(t,e,r){const i=this.ls.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(r)),Be.resolve()}getOverlaysForCollection(t,e,r){const i=oh(),s=e.length+1,o=new $t(e.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!e.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return Be.resolve(i)}getOverlaysForCollectionGroup(t,e,r,i){let s=new di((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===e&&u.largestBatchId>r){let f=s.get(u.largestBatchId);null===f&&(f=oh(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=oh(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=i)););return Be.resolve(l)}we(t,e,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.ls.get(i.largestBatchId).delete(r.key);this.ls.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new z6(e,r));let s=this.ls.get(e);void 0===s&&(s=jn(),this.ls.set(e,s)),this.ls.set(e,s.add(r.key))}}class rW{constructor(){this.fs=new xi(_o.ds),this.ws=new xi(_o._s)}isEmpty(){return this.fs.isEmpty()}addReference(t,e){const r=new _o(t,e);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.ys(new _o(t,e))}ps(t,e){t.forEach(r=>this.removeReference(r,e))}Is(t){const e=new $t(new xr([])),r=new _o(e,t),i=new _o(e,t+1),s=[];return this.ws.forEachInRange([r,i],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(t=>this.ys(t))}ys(t){this.fs=this.fs.delete(t),this.ws=this.ws.delete(t)}Es(t){const e=new $t(new xr([])),r=new _o(e,t),i=new _o(e,t+1);let s=jn();return this.ws.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(t){const e=new _o(t,0),r=this.fs.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class _o{constructor(t,e){this.key=t,this.As=e}static ds(t,e){return $t.comparator(t.key,e.key)||Pn(t.As,e.As)}static _s(t,e){return Pn(t.As,e.As)||$t.comparator(t.key,e.key)}}class UCe{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.vs=1,this.Rs=new xi(_o.ds)}checkEmpty(t){return Be.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,i){const s=this.vs;this.vs++;const o=new V6(s,e,r,i);this.mutationQueue.push(o);for(const l of i)this.Rs=this.Rs.add(new _o(l.key,s)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return Be.resolve(o)}lookupMutationBatch(t,e){return Be.resolve(this.Ps(e))}getNextMutationBatchAfterBatchId(t,e){const i=this.bs(e+1),s=i<0?0:i;return Be.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Be.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(t){return Be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new _o(e,0),i=new _o(e,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([r,i],o=>{const l=this.Ps(o.As);s.push(l)}),Be.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new xi(Pn);return e.forEach(i=>{const s=new _o(i,0),o=new _o(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],l=>{r=r.add(l.As)})}),Be.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,i=r.length+1;let s=r;$t.isDocumentKey(s)||(s=s.child(""));const o=new _o(new $t(s),0);let l=new xi(Pn);return this.Rs.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.As)),!0)},o),Be.resolve(this.Vs(l))}Vs(t){const e=[];return t.forEach(r=>{const i=this.Ps(r);null!==i&&e.push(i)}),e}removeMutationBatch(t,e){dn(0===this.Ss(e.batchId,"removed")),this.mutationQueue.shift();let r=this.Rs;return Be.forEach(e.mutations,i=>{const s=new _o(i.key,e.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Rs=r})}Cn(t){}containsKey(t,e){const r=new _o(e,0),i=this.Rs.firstAfterOrEqual(r);return Be.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return Be.resolve()}Ss(t,e){return this.bs(t)}bs(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Ps(t){const e=this.bs(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class zCe{constructor(t){this.Ds=t,this.docs=new di($t.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,i=this.docs.get(r),s=i?i.size:0,o=this.Ds(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return Be.resolve(r?r.document.mutableCopy():Ii.newInvalidDocument(e))}getEntries(t,e){let r=xl();return e.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ii.newInvalidDocument(i))}),Be.resolve(r)}getDocumentsMatchingQuery(t,e,r,i){let s=xl();const o=e.path,l=new $t(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||I6(yee(f),r)<=0||(i.has(f.key)||bA(e,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Be.resolve(s)}getAllFromCollectionGroup(t,e,r,i){Jt()}Cs(t,e){return Be.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new HCe(this)}getSize(t){return Be.resolve(this.size)}}class HCe extends ane{constructor(t){super(),this.os=t}applyChanges(t){const e=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?e.push(this.os.addEntry(t,i)):this.os.removeEntry(r)}),Be.waitFor(e)}getFromCache(t,e){return this.os.getEntry(t,e)}getAllFromCache(t,e){return this.os.getEntries(t,e)}}class GCe{constructor(t){this.persistence=t,this.xs=new Xf(e=>ob(e),yA),this.lastRemoteSnapshotVersion=hn.min(),this.highestTargetId=0,this.Ns=0,this.ks=new rW,this.targetCount=0,this.Ms=mb.kn()}forEachTarget(t,e){return this.xs.forEach((r,i)=>e(i)),Be.resolve()}getLastRemoteSnapshotVersion(t){return Be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Be.resolve(this.Ns)}allocateTargetId(t){return this.highestTargetId=this.Ms.next(),Be.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.Ns&&(this.Ns=e),Be.resolve()}Fn(t){this.xs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Ms=new mb(e),this.highestTargetId=e),t.sequenceNumber>this.Ns&&(this.Ns=t.sequenceNumber)}addTargetData(t,e){return this.Fn(e),this.targetCount+=1,Be.resolve()}updateTargetData(t,e){return this.Fn(e),Be.resolve()}removeTargetData(t,e){return this.xs.delete(e.target),this.ks.Is(e.targetId),this.targetCount-=1,Be.resolve()}removeTargets(t,e,r){let i=0;const s=[];return this.xs.forEach((o,l)=>{l.sequenceNumber<=e&&null===r.get(l.targetId)&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(t,l.targetId)),i++)}),Be.waitFor(s).next(()=>i)}getTargetCount(t){return Be.resolve(this.targetCount)}getTargetData(t,e){const r=this.xs.get(e)||null;return Be.resolve(r)}addMatchingKeys(t,e,r){return this.ks.gs(e,r),Be.resolve()}removeMatchingKeys(t,e,r){this.ks.ps(e,r);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),Be.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.ks.Is(e),Be.resolve()}getMatchingKeysForTargetId(t,e){const r=this.ks.Es(e);return Be.resolve(r)}containsKey(t,e){return Be.resolve(this.ks.containsKey(e))}}class iW{constructor(t,e){this.$s={},this.overlays={},this.Os=new lc(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=t(this),this.Bs=new GCe(this),this.indexManager=new ACe,this.remoteDocumentCache=new zCe(r=>this.referenceDelegate.Ls(r)),this.serializer=new Bte(e),this.qs=new BCe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new VCe,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.$s[t.toKey()];return r||(r=new UCe(e,this.referenceDelegate),this.$s[t.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(t,e,r){Ct("MemoryPersistence","Starting transaction:",t);const i=new WCe(this.Os.next());return this.referenceDelegate.Us(),r(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(t,e){return Be.or(Object.values(this.$s).map(r=>()=>r.containsKey(t,e)))}}class WCe extends bee{constructor(t){super(),this.currentSequenceNumber=t}}class iL{constructor(t){this.persistence=t,this.Qs=new rW,this.js=null}static zs(t){return new iL(t)}get Ws(){if(this.js)return this.js;throw Jt()}addReference(t,e,r){return this.Qs.addReference(r,e),this.Ws.delete(r.toString()),Be.resolve()}removeReference(t,e,r){return this.Qs.removeReference(r,e),this.Ws.add(r.toString()),Be.resolve()}markPotentiallyOrphaned(t,e){return this.Ws.add(e.toString()),Be.resolve()}removeTarget(t,e){this.Qs.Is(e.targetId).forEach(i=>this.Ws.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>r.removeTargetData(t,e))}Us(){this.js=new Set}Ks(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Be.forEach(this.Ws,r=>{const i=$t.fromPath(r);return this.Hs(t,i).next(s=>{s||e.removeEntry(i,hn.min())})}).next(()=>(this.js=null,e.apply(t)))}updateLimboDocument(t,e){return this.Hs(t,e).next(r=>{r?this.Ws.delete(e.toString()):this.Ws.add(e.toString())})}Ls(t){return 0}Hs(t,e){return Be.or([()=>Be.resolve(this.Qs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gs(t,e)])}}class jCe{constructor(t){this.serializer=t}O(t,e,r,i){const s=new M2("createOrUpgrade",e);var l;r<1&&i>=1&&(t.createObjectStore("owner"),(l=t).createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Iee,{unique:!0}),l.createObjectStore("documentMutations"),fne(t),function(l){l.createObjectStore("remoteDocuments")}(t));let o=Be.resolve();return r<3&&i>=3&&(0!==r&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(t),fne(t)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:hn.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(l,c){return c.store("mutations").j().next(u=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Iee,{unique:!0});const f=c.store("mutations"),m=u.map(_=>f.put(_));return Be.waitFor(m)})}(t,s))),o=o.next(()=>{!function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})}(t)})),r<5&&i>=5&&(o=o.next(()=>this.Ys(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(t),this.Xs(s)))),r<7&&i>=7&&(o=o.next(()=>this.Zs(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(t,s))),r<9&&i>=9&&(o=o.next(()=>{!function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")}(t)})),r<10&&i>=10&&(o=o.next(()=>this.ei(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(t),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(t)})),r<12&&i>=12&&(o=o.next(()=>{!function(l){const c=l.createObjectStore("documentOverlays",{keyPath:Awe});c.createIndex("collectionPathOverlayIndex",Nwe,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",Rwe,{unique:!1})}(t)})),r<13&&i>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:vwe});c.createIndex("documentKeyIndex",bwe),c.createIndex("collectionGroupIndex",wwe)}(t)).next(()=>this.ni(t,s)).next(()=>t.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(t,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:Swe}).createIndex("sequenceNumberIndex",Ewe,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:Dwe}).createIndex("documentKeyIndex",kwe,{unique:!1})}(t))),o}Xs(t){let e=0;return t.store("remoteDocuments").X((r,i)=>{e+=tL(i)}).next(()=>{const r={byteSize:e};return t.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Ys(t){const e=t.store("mutationQueues"),r=t.store("mutations");return e.j().next(i=>Be.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",o).next(l=>Be.forEach(l,c=>{dn(c.userId===s.userId);const u=hb(this.serializer,c);return ene(t,s.userId,u).next(()=>{})}))}))}Zs(t){const e=t.store("targetDocuments"),r=t.store("remoteDocuments");return t.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.X((o,l)=>{const c=new xr(o),u=[0,ha(c)];s.push(e.get(u).next(f=>f?Be.resolve():e.put({targetId:0,path:ha(c),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>Be.waitFor(s))})}ti(t,e){t.createObjectStore("collectionParents",{keyPath:Twe});const r=e.store("collectionParents"),i=new nW,s=o=>{if(i.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:ha(c)})}};return e.store("remoteDocuments").X({Y:!0},(o,l)=>{const c=new xr(o);return s(c.popLast())}).next(()=>e.store("documentMutations").X({Y:!0},([o,l,c],u)=>{const f=ih(l);return s(f.popLast())}))}ei(t){const e=t.store("targets");return e.X((r,i)=>{const s=NA(i),o=Ute(this.serializer,s);return e.put(o)})}ni(t,e){const r=e.store("remoteDocuments"),i=[];return r.X((s,o)=>{const l=e.store("remoteDocumentsV14"),c=(u=o,u.document?new $t(xr.fromString(u.document.name).popFirst(5)):u.noDocument?$t.fromSegments(u.noDocument.path):u.unknownDocument?$t.fromSegments(u.unknownDocument.path):Jt()).path.toArray();var u;const f={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(f))}).next(()=>Be.waitFor(i))}si(t,e){const r=e.store("mutations"),i=lne(this.serializer),s=new iW(iL.zs,this.serializer.fe);return r.j().next(o=>{const l=new Map;return o.forEach(c=>{var u;let f=null!==(u=l.get(c.userId))&&void 0!==u?u:jn();hb(this.serializer,c).keys().forEach(m=>f=f.add(m)),l.set(c.userId,f)}),Be.forEach(l,(c,u)=>{const f=new mo(u),m=Q2.de(this.serializer,f),_=s.getIndexManager(f),y=nL.de(f,this.serializer,_,s.referenceDelegate);return new hne(i,y,m,_).recalculateAndSaveOverlaysForDocumentKeys(new E6(e,lc.ct),c).next()})})}}function fne(n){n.createObjectStore("targetDocuments",{keyPath:xwe}).createIndex("documentTargetsIndex",Iwe,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Cwe,{unique:!0}),n.createObjectStore("targetGlobal")}const sW="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class oW{constructor(t,e,r,i,s,o,l,c,u,f,m=15){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=r,this.ii=s,this.window=o,this.document=l,this.ri=u,this.oi=f,this.ui=m,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=_=>Promise.resolve(),!oW.D())throw new ot(Ze.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new FCe(this,i),this.di=e+"main",this.serializer=new Bte(c),this.wi=new Xu(this.di,this.ui,new jCe(this.serializer)),this.Bs=new RCe(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lne(this.serializer),this.qs=new xCe,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===f&&hs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ot(Ze.FAILED_PRECONDITION,sW);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.Bs.getHighestSequenceNumber(t))}).then(t=>{this.Os=new lc(t,this.ri)}).then(()=>{this.Fs=!0}).catch(t=>(this.wi&&this.wi.close(),Promise.reject(t)))}Ii(t){var e=this;return this.fi=function(){var r=(0,q.Z)(function*(i){if(e.started)return t(i)});return function(i){return r.apply(this,arguments)}}(),t(this.isPrimary)}setDatabaseDeletedListener(t){this.wi.B(function(){var e=(0,q.Z)(function*(r){null===r.newVersion&&(yield t())});return function(r){return e.apply(this,arguments)}}())}setNetworkEnabled(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ii.enqueueAndForget((0,q.Z)(function*(){e.started&&(yield e.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>oL(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(t).next(e=>{e||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(t)).next(e=>this.isPrimary&&!e?this.Ai(t).next(()=>!1):!!e&&this.vi(t).next(()=>!0))).catch(t=>{if(Ig(t))return Ct("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return Ct("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.ii.enqueueRetryable(()=>this.fi(t)),this.isPrimary=t})}Ti(t){return LA(t).get("owner").next(e=>Be.resolve(this.Ri(e)))}Pi(t){return oL(t).delete(this.clientId)}bi(){var t=this;return(0,q.Z)(function*(){if(t.isPrimary&&!t.Vi(t.li,18e5)){t.li=Date.now();const e=yield t.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=go(r,"clientMetadata");return i.j().next(s=>{const o=t.Si(s,18e5),l=s.filter(c=>-1===o.indexOf(c));return Be.forEach(l,c=>i.delete(c.clientId)).next(()=>l)})}).catch(()=>[]);if(t._i)for(const r of e)t._i.removeItem(t.Di(r.clientId))}})()}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(t){return!!t&&t.ownerId===this.clientId}Ei(t){return this.oi?Be.resolve(!0):LA(t).get("owner").next(e=>{if(null!==e&&this.Vi(e.leaseTimestampMs,5e3)&&!this.Ci(e.ownerId)){if(this.Ri(e)&&this.networkEnabled)return!0;if(!this.Ri(e)){if(!e.allowTabSynchronization)throw new ot(Ze.FAILED_PRECONDITION,sW);return!1}}return!(!this.networkEnabled||!this.inForeground)||oL(t).j().next(r=>void 0===this.Si(r,5e3).find(i=>{if(this.clientId!==i.clientId){const o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||o&&l)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&Ct("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}shutdown(){var t=this;return(0,q.Z)(function*(){t.Fs=!1,t.xi(),t.hi&&(t.hi.cancel(),t.hi=null),t.Ni(),t.ki(),yield t.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new E6(e,lc.ct);return t.Ai(r).next(()=>t.Pi(r))}),t.wi.close(),t.Mi()})()}Si(t,e){return t.filter(r=>this.Vi(r.updateTimeMs,e)&&!this.Ci(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",t=>oL(t).j().next(e=>this.Si(e,18e5).map(r=>r.clientId)))}get started(){return this.Fs}getMutationQueue(t,e){return nL.de(t,this.serializer,e,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new NCe(t,this.serializer.fe.databaseId)}getDocumentOverlayCache(t){return Q2.de(this.serializer,t)}getBundleCache(){return this.qs}runTransaction(t,e,r){Ct("IndexedDbPersistence","Starting transaction:",t);const i="readonly"===e?"readonly":"readwrite",s=15===(o=this.ui)?Owe:14===o?Dee:13===o?Eee:12===o?Mwe:11===o?See:void Jt();var o;let l;return this.wi.runTransaction(t,i,s,c=>(l=new E6(c,this.Os?this.Os.next():lc.ct),"readwrite-primary"===e?this.Ti(l).next(u=>!!u||this.Ei(l)).next(u=>{if(!u)throw hs(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new ot(Ze.FAILED_PRECONDITION,vee);return r(l)}).next(u=>this.vi(l).next(()=>u)):this.Oi(l).next(()=>r(l)))).then(c=>(l.raiseOnCommittedEvent(),c))}Oi(t){return LA(t).get("owner").next(e=>{if(null!==e&&this.Vi(e.leaseTimestampMs,5e3)&&!this.Ci(e.ownerId)&&!this.Ri(e)&&!(this.oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new ot(Ze.FAILED_PRECONDITION,sW)})}vi(t){const e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return LA(t).put("owner",e)}static D(){return Xu.D()}Ai(t){const e=LA(t);return e.get("owner").next(r=>this.Ri(r)?(Ct("IndexedDbPersistence","Releasing primary lease."),e.delete("owner")):Be.resolve())}Vi(t,e){const r=Date.now();return!(t<r-e||t>r&&(hs(`Detected an update time that is in the future: ${t} > ${r}`),1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var t;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ci=()=>{this.xi();const e=/(?:Version|Mobile)\/1[456]/;(0,W.G6)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(t){var e;try{const r=null!==(null===(e=this._i)||void 0===e?void 0:e.getItem(this.Di(t)));return Ct("IndexedDbPersistence",`Client '${t}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return hs("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(t){hs("Failed to set zombie client id.",t)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function LA(n){return go(n,"owner")}function oL(n){return go(n,"clientMetadata")}function aW(n,t){let e=n.projectId;return n.isDefaultDatabase||(e+="."+n.database),"firestore/"+t+"/"+e+"/"}class lW{constructor(t,e,r,i){this.targetId=t,this.fromCache=e,this.Fi=r,this.Bi=i}static Li(t,e){let r=jn(),i=jn();for(const s of e.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new lW(t,e.fromCache,r,i)}}class pne{constructor(){this.qi=!1}initialize(t,e){this.Ui=t,this.indexManager=e,this.qi=!0}getDocumentsMatchingQuery(t,e,r,i){return this.Ki(t,e).next(s=>s||this.Gi(t,e,i,r)).next(s=>s||this.Qi(t,e))}Ki(t,e){if(Xee(e))return Be.resolve(null);let r=ja(e);return this.indexManager.getIndexType(t,r).next(i=>0===i?null:(null!==e.limit&&1===i&&(e=G2(e,null,"F"),r=ja(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{const o=jn(...s);return this.Ui.getDocuments(t,o).next(l=>this.indexManager.getMinOffset(t,r).next(c=>{const u=this.ji(e,l);return this.zi(e,u,o,c.readTime)?this.Ki(t,G2(e,null,"F")):this.Wi(t,u,e,c)}))})))}Gi(t,e,r,i){return Xee(e)||i.isEqual(hn.min())?this.Qi(t,e):this.Ui.getDocuments(t,r).next(s=>{const o=this.ji(e,s);return this.zi(e,o,r,i)?this.Qi(t,e):(w6()<=$o.in.DEBUG&&Ct("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),L6(e)),this.Wi(t,o,e,_ee(i,-1)))})}ji(t,e){let r=new xi(tte(t));return e.forEach((i,s)=>{bA(t,s)&&(r=r.add(s))}),r}zi(t,e,r,i){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(t,e){return w6()<=$o.in.DEBUG&&Ct("QueryEngine","Using full collection scan to execute query:",L6(e)),this.Ui.getDocumentsMatchingQuery(t,e,ac.min())}Wi(t,e,r,i){return this.Ui.getDocumentsMatchingQuery(t,r,i).next(s=>(e.forEach(o=>{s=s.insert(o.key,o)}),s))}}class qCe{constructor(t,e,r,i){this.persistence=t,this.Hi=e,this.serializer=i,this.Ji=new di(Pn),this.Yi=new Xf(s=>ob(s),yA),this.Xi=new Map,this.Zi=t.getRemoteDocumentCache(),this.Bs=t.getTargetCache(),this.qs=t.getBundleCache(),this.tr(r)}tr(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new hne(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ji))}}function mne(n,t,e,r){return new qCe(n,t,e,r)}function gne(n,t){return cW.apply(this,arguments)}function cW(){return cW=(0,q.Z)(function*(n,t){const e=Vt(n);return yield e.persistence.runTransaction("Handle user change","readonly",r=>{let i;return e.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,e.tr(t),e.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let c=jn();for(const u of i){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of s){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return e.localDocuments.getDocuments(r,c).next(u=>({er:u,removedBatchIds:o,addedBatchIds:l}))})})}),cW.apply(this,arguments)}function ZCe(n,t){const e=Vt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),s=e.Zi.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const f=c.batch,m=f.keys();let _=Be.resolve();return m.forEach(y=>{_=_.next(()=>u.getEntry(l,y)).next(w=>{const T=c.docVersions.get(y);dn(null!==T),w.version.compareTo(T)<0&&(f.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),u.addEntry(w)))})}),_.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(e,r,t,s).next(()=>s.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let l=jn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>e.localDocuments.getDocuments(r,i))})}function _ne(n){const t=Vt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Bs.getLastRemoteSnapshotVersion(e))}function YCe(n,t){const e=Vt(n),r=t.snapshotVersion;let i=e.Ji;return e.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=e.Zi.newChangeBuffer({trackRemovals:!0});i=e.Ji;const l=[];t.targetChanges.forEach((f,m)=>{const _=i.get(m);if(!_)return;l.push(e.Bs.removeMatchingKeys(s,f.removedDocuments,m).next(()=>e.Bs.addMatchingKeys(s,f.addedDocuments,m)));let y=_.withSequenceNumber(s.currentSequenceNumber);var w,T,I;null!==t.targetMismatches.get(m)?y=y.withResumeToken(Gs.EMPTY_BYTE_STRING,hn.min()).withLastLimboFreeSnapshotVersion(hn.min()):f.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(f.resumeToken,r)),i=i.insert(m,y),T=y,I=f,(0===(w=_).resumeToken.approximateByteSize()||T.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8||I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0)&&l.push(e.Bs.updateTargetData(s,y))});let c=xl(),u=jn();if(t.documentUpdates.forEach(f=>{t.resolvedLimboDocuments.has(f)&&l.push(e.persistence.referenceDelegate.updateLimboDocument(s,f))}),l.push(yne(s,o,t.documentUpdates).next(f=>{c=f.nr,u=f.sr})),!r.isEqual(hn.min())){const f=e.Bs.getLastRemoteSnapshotVersion(s).next(m=>e.Bs.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(f)}return Be.waitFor(l).next(()=>o.apply(s)).next(()=>e.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(e.Ji=i,s))}function yne(n,t,e){let r=jn(),i=jn();return e.forEach(s=>r=r.add(s)),t.getEntries(n,r).next(s=>{let o=xl();return e.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(hn.min())?(t.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||0===c.version.compareTo(u.version)&&u.hasPendingWrites?(t.addEntry(c),o=o.insert(l,c)):Ct("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{nr:o,sr:i}})}function KCe(n,t){const e=Vt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function cI(n,t){const e=Vt(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return e.Bs.getTargetData(r,t).next(s=>s?(i=s,Be.resolve(i)):e.Bs.allocateTargetId(r).next(o=>(i=new ep(t,o,"TargetPurposeListen",r.currentSequenceNumber),e.Bs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=e.Ji.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Ji=e.Ji.insert(r.targetId,r),e.Yi.set(t,r.targetId)),r})}function uI(n,t,e){return uW.apply(this,arguments)}function uW(){return uW=(0,q.Z)(function*(n,t,e){const r=Vt(n),i=r.Ji.get(t),s=e?"readwrite":"readwrite-primary";try{e||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ig(o))throw o;Ct("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ji=r.Ji.remove(t),r.Yi.delete(i.target)}),uW.apply(this,arguments)}function aL(n,t,e){const r=Vt(n);let i=hn.min(),s=jn();return r.persistence.runTransaction("Execute query","readonly",o=>function(l,c,u){const f=Vt(l),m=f.Yi.get(u);return void 0!==m?Be.resolve(f.Ji.get(m)):f.Bs.getTargetData(c,u)}(r,o,ja(t)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,t,e?i:hn.min(),e?s:jn())).next(l=>(wne(r,ete(t),l),{documents:l,ir:s})))}function vne(n,t){const e=Vt(n),r=Vt(e.Bs),i=e.Ji.get(t);return i?Promise.resolve(i.target):e.persistence.runTransaction("Get target data","readonly",s=>r.le(s,t).next(o=>o?o.target:null))}function bne(n,t){const e=Vt(n),r=e.Xi.get(t)||hn.min();return e.persistence.runTransaction("Get new document changes","readonly",i=>e.Zi.getAllFromCollectionGroup(i,t,_ee(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(wne(e,t,i),i))}function wne(n,t,e){let r=n.Xi.get(t)||hn.min();e.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Xi.set(t,r)}function dW(){return dW=(0,q.Z)(function*(n,t,e,r){const i=Vt(n);let s=jn(),o=xl();for(const u of e){const f=t.rr(u.metadata.name);u.document&&(s=s.add(f));const m=t.ur(u);m.setReadTime(t.cr(u.metadata.readTime)),o=o.insert(f,m)}const l=i.Zi.newChangeBuffer({trackRemovals:!0}),c=yield cI(i,(u=r,ja(eI(xr.fromString(`__bundle__/docs/${u}`)))));var u;return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>yne(u,l,o).next(f=>(l.apply(u),f)).next(f=>i.Bs.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Bs.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,f.nr,f.sr)).next(()=>f.nr)))}),dW.apply(this,arguments)}function XCe(n,t){return hW.apply(this,arguments)}function hW(){return hW=(0,q.Z)(function*(n,t,e=jn()){const r=yield cI(n,ja(K6(t.bundledQuery))),i=Vt(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=fs(t.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.qs.saveNamedQuery(s,t);const l=r.withResumeToken(Gs.EMPTY_BYTE_STRING,o);return i.Ji=i.Ji.insert(l.targetId,l),i.Bs.updateTargetData(s,l).next(()=>i.Bs.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Bs.addMatchingKeys(s,e,r.targetId)).next(()=>i.qs.saveNamedQuery(s,t))})}),hW.apply(this,arguments)}function Cne(n,t){return`firestore_clients_${n}_${t}`}function xne(n,t,e){let r=`firestore_mutations_${n}_${e}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function fW(n,t){return`firestore_targets_${n}_${t}`}class lL{constructor(t,e,r,i){this.user=t,this.batchId=e,this.state=r,this.error=i}static ar(t,e,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new ot(i.error.code,i.error.message))),o?new lL(t,e,i.state,s):(hs("SharedClientState",`Failed to parse mutation state for ID '${e}': ${r}`),null)}hr(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class $A{constructor(t,e,r){this.targetId=t,this.state=e,this.error=r}static ar(t,e){const r=JSON.parse(e);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new ot(r.error.code,r.error.message))),s?new $A(t,r.state,i):(hs("SharedClientState",`Failed to parse target state for ID '${t}': ${e}`),null)}hr(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class cL{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static ar(t,e){const r=JSON.parse(e);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=$6();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=Cee(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new cL(t,s):(hs("SharedClientState",`Failed to parse client data for instance '${t}': ${e}`),null)}}class pW{constructor(t,e){this.clientId=t,this.onlineState=e}static ar(t){const e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new pW(e.clientId,e.onlineState):(hs("SharedClientState",`Failed to parse online state: ${t}`),null)}}class mW{constructor(){this.activeTargetIds=$6()}lr(t){this.activeTargetIds=this.activeTargetIds.add(t)}dr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}hr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class gW{constructor(t,e,r,i,s){this.window=t,this.ii=e,this.persistenceKey=r,this.wr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new di(Pn),this.started=!1,this.yr=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=Cne(this.persistenceKey,this.wr),this.Ir=`firestore_sequence_number_${this.persistenceKey}`,this.gr=this.gr.insert(this.wr,new mW),this.Tr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vr=`firestore_online_state_${this.persistenceKey}`,this.Rr=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(t){return!(!t||!t.localStorage)}start(){var t=this;return(0,q.Z)(function*(){const e=yield t.syncEngine.$i();for(const i of e){if(i===t.wr)continue;const s=t.getItem(Cne(t.persistenceKey,i));if(s){const o=cL.ar(i,s);o&&(t.gr=t.gr.insert(o.clientId,o))}}t.Pr();const r=t.storage.getItem(t.vr);if(r){const i=t.br(r);i&&t.Vr(i)}for(const i of t.yr)t.mr(i);t.yr=[],t.window.addEventListener("pagehide",()=>t.shutdown()),t.started=!0})()}writeSequenceNumber(t){this.setItem(this.Ir,JSON.stringify(t))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(t){let e=!1;return this.gr.forEach((r,i)=>{i.activeTargetIds.has(t)&&(e=!0)}),e}addPendingMutation(t){this.Dr(t,"pending")}updateMutationState(t,e,r){this.Dr(t,e,r),this.Cr(t)}addLocalQueryTarget(t){let e="not-current";if(this.isActiveQueryTarget(t)){const r=this.storage.getItem(fW(this.persistenceKey,t));if(r){const i=$A.ar(t,r);i&&(e=i.state)}}return this.Nr.lr(t),this.Pr(),e}removeLocalQueryTarget(t){this.Nr.dr(t),this.Pr()}isLocalQueryTarget(t){return this.Nr.activeTargetIds.has(t)}clearQueryState(t){this.removeItem(fW(this.persistenceKey,t))}updateQueryState(t,e,r){this.kr(t,e,r)}handleUserChange(t,e,r){e.forEach(i=>{this.Cr(i)}),this.currentUser=t,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(t){this.Mr(t)}notifyBundleLoaded(t){this.$r(t)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(t){const e=this.storage.getItem(t);return Ct("SharedClientState","READ",t,e),e}setItem(t,e){Ct("SharedClientState","SET",t,e),this.storage.setItem(t,e)}removeItem(t){Ct("SharedClientState","REMOVE",t),this.storage.removeItem(t)}mr(t){var e=this;const r=t;if(r.storageArea===this.storage){if(Ct("SharedClientState","EVENT",r.key,r.newValue),r.key===this.pr)return void hs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((0,q.Z)(function*(){if(e.started){if(null!==r.key)if(e.Tr.test(r.key)){if(null==r.newValue){const i=e.Or(r.key);return e.Fr(i,null)}{const i=e.Br(r.key,r.newValue);if(i)return e.Fr(i.clientId,i)}}else if(e.Er.test(r.key)){if(null!==r.newValue){const i=e.Lr(r.key,r.newValue);if(i)return e.qr(i)}}else if(e.Ar.test(r.key)){if(null!==r.newValue){const i=e.Ur(r.key,r.newValue);if(i)return e.Kr(i)}}else if(r.key===e.vr){if(null!==r.newValue){const i=e.br(r.newValue);if(i)return e.Vr(i)}}else if(r.key===e.Ir){const i=function(s){let o=lc.ct;if(null!=s)try{const l=JSON.parse(s);dn("number"==typeof l),o=l}catch(l){hs("SharedClientState","Failed to read sequence number from WebStorage",l)}return o}(r.newValue);i!==lc.ct&&e.sequenceNumberHandler(i)}else if(r.key===e.Rr){const i=e.Gr(r.newValue);yield Promise.all(i.map(s=>e.syncEngine.Qr(s)))}}else e.yr.push(r)}))}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(t,e,r){const i=new lL(this.currentUser,t,e,r),s=xne(this.persistenceKey,this.currentUser,t);this.setItem(s,i.hr())}Cr(t){const e=xne(this.persistenceKey,this.currentUser,t);this.removeItem(e)}Mr(t){this.storage.setItem(this.vr,JSON.stringify({clientId:this.wr,onlineState:t}))}kr(t,e,r){const i=fW(this.persistenceKey,t),s=new $A(t,e,r);this.setItem(i,s.hr())}$r(t){const e=JSON.stringify(Array.from(t));this.setItem(this.Rr,e)}Or(t){const e=this.Tr.exec(t);return e?e[1]:null}Br(t,e){const r=this.Or(t);return cL.ar(r,e)}Lr(t,e){const r=this.Er.exec(t),i=Number(r[1]);return lL.ar(new mo(void 0!==r[2]?r[2]:null),i,e)}Ur(t,e){const r=this.Ar.exec(t),i=Number(r[1]);return $A.ar(i,e)}br(t){return pW.ar(t)}Gr(t){return JSON.parse(t)}qr(t){var e=this;return(0,q.Z)(function*(){if(t.user.uid===e.currentUser.uid)return e.syncEngine.jr(t.batchId,t.state,t.error);Ct("SharedClientState",`Ignoring mutation for non-active user ${t.user.uid}`)})()}Kr(t){return this.syncEngine.zr(t.targetId,t.state,t.error)}Fr(t,e){const r=e?this.gr.insert(t,e):this.gr.remove(t),i=this.Sr(this.gr),s=this.Sr(r),o=[],l=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||l.push(c)}),this.syncEngine.Wr(o,l).then(()=>{this.gr=r})}Vr(t){this.gr.get(t.clientId)&&this.onlineStateHandler(t.onlineState)}Sr(t){let e=$6();return t.forEach((r,i)=>{e=e.unionWith(i.activeTargetIds)}),e}}class Ine{constructor(){this.Hr=new mW,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Hr.lr(t),this.Jr[t]||"not-current"}updateQueryState(t,e,r){this.Jr[t]=e}removeLocalQueryTarget(t){this.Hr.dr(t)}isLocalQueryTarget(t){return this.Hr.activeTargetIds.has(t)}clearQueryState(t){delete this.Jr[t]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(t){return this.Hr.activeTargetIds.has(t)}start(){return this.Hr=new mW,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class JCe{Yr(t){}shutdown(){}}class Tne{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(t){this.so.push(t)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Ct("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.so)t(0)}no(){Ct("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.so)t(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let uL=null;function _W(){return null===uL?uL=268435456+Math.round(2147483648*Math.random()):uL++,"0x"+uL.toString(16)}const exe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class txe{constructor(t){this.ro=t.ro,this.oo=t.oo}uo(t){this.co=t}ao(t){this.ho=t}onMessage(t){this.lo=t}close(){this.oo()}send(t){this.ro(t)}fo(){this.co()}wo(t){this.ho(t)}_o(t){this.lo(t)}}const pa="WebChannelConnection";class nxe extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.mo=(t.ssl?"https":"http")+"://"+t.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(t,e,r,i,s){const o=_W(),l=this.To(t,e);Ct("RestConnection",`Sending RPC '${t}' ${o}:`,l,r);const c={};return this.Eo(c,i,s),this.Ao(t,l,c,r).then(u=>(Ct("RestConnection",`Received RPC '${t}' ${o}: `,u),u),u=>{throw Zc("RestConnection",`RPC '${t}' ${o} failed with error: `,u,"url: ",l,"request:",r),u})}vo(t,e,r,i,s,o){return this.Io(t,e,r,i,s)}Eo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+Zx,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((i,s)=>t[s]=i),r&&r.headers.forEach((i,s)=>t[s]=i)}To(t,e){return`${this.mo}/v1/${e}:${exe[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Ao(t,e,r,i){const s=_W();return new Promise((o,l)=>{const c=new J0e;c.setWithCredentials(!0),c.listenOnce(K0e.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case b6.NO_ERROR:const f=c.getResponseJson();Ct(pa,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(f)),o(f);break;case b6.TIMEOUT:Ct(pa,`RPC '${t}' ${s} timed out`),l(new ot(Ze.DEADLINE_EXCEEDED,"Request time out"));break;case b6.HTTP_ERROR:const m=c.getStatus();if(Ct(pa,`RPC '${t}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let _=c.getResponseJson();Array.isArray(_)&&(_=_[0]);const y=_?.error;if(y&&y.status&&y.message){const w=function(T){const I=T.toLowerCase().replace(/_/g,"-");return Object.values(Ze).indexOf(I)>=0?I:Ze.UNKNOWN}(y.status);l(new ot(w,y.message))}else l(new ot(Ze.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ot(Ze.UNAVAILABLE,"Connection failed."));break;default:Jt()}}finally{Ct(pa,`RPC '${t}' ${s} completed.`)}});const u=JSON.stringify(i);Ct(pa,`RPC '${t}' ${s} sending request:`,i),c.send(e,"POST",u,r,15)})}Ro(t,e,r){const i=_W(),s=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Z0e(),l=Y0e(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new X0e({})),this.Eo(c.initMessageHeaders,e,r),c.encodeInitMessageHeaders=!0;const f=s.join("");Ct(pa,`Creating RPC '${t}' stream ${i}: ${f}`,c);const m=o.createWebChannel(f,c);let _=!1,y=!1;const w=new txe({ro:I=>{y?Ct(pa,`Not sending because RPC '${t}' stream ${i} is closed:`,I):(_||(Ct(pa,`Opening RPC '${t}' stream ${i} transport.`),m.open(),_=!0),Ct(pa,`RPC '${t}' stream ${i} sending:`,I),m.send(I))},oo:()=>m.close()}),T=(I,E,A)=>{I.listen(E,M=>{try{A(M)}catch(O){setTimeout(()=>{throw O},0)}})};return T(m,A2.EventType.OPEN,()=>{y||Ct(pa,`RPC '${t}' stream ${i} transport opened.`)}),T(m,A2.EventType.CLOSE,()=>{y||(y=!0,Ct(pa,`RPC '${t}' stream ${i} transport closed`),w.wo())}),T(m,A2.EventType.ERROR,I=>{y||(y=!0,Zc(pa,`RPC '${t}' stream ${i} transport errored:`,I),w.wo(new ot(Ze.UNAVAILABLE,"The operation could not be completed")))}),T(m,A2.EventType.MESSAGE,I=>{var E;if(!y){const A=I.data[0];dn(!!A);const M=A,O=M.error||(null===(E=M[0])||void 0===E?void 0:E.error);if(O){Ct(pa,`RPC '${t}' stream ${i} received error:`,O);const $=O.status;let V=function(Q){const re=Ss[Q];if(void 0!==re)return vte(re)}($),Z=O.message;void 0===V&&(V=Ze.INTERNAL,Z="Unknown error status: "+$+" with message "+O.message),y=!0,w.wo(new ot(V,Z)),m.close()}else Ct(pa,`RPC '${t}' stream ${i} received:`,A),w._o(A)}}),T(l,Q0e.STAT_EVENT,I=>{I.stat===dee.PROXY?Ct(pa,`RPC '${t}' stream ${i} detected buffering proxy`):I.stat===dee.NOPROXY&&Ct(pa,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}}function Sne(){return typeof window<"u"?window:null}function dL(){return typeof document<"u"?document:null}function BA(n){return new hCe(n,!0)}class yW{constructor(t,e,r=1e3,i=1.5,s=6e4){this.ii=t,this.timerId=e,this.Po=r,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(t){this.cancel();const e=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),i=Math.max(0,e-r);i>0&&Ct("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),t())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class Ene{constructor(t,e,r,i,s,o,l,c){this.ii=t,this.$o=r,this.Oo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new yW(t,e)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var t=this;return(0,q.Z)(function*(){t.Uo()&&(yield t.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(t){this.Ho(),this.stream.send(t)}zo(){var t=this;return(0,q.Z)(function*(){if(t.Ko())return t.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(t,e){var r=this;return(0,q.Z)(function*(){r.Ho(),r.Jo(),r.qo.cancel(),r.Fo++,4!==t?r.qo.reset():e&&e.code===Ze.RESOURCE_EXHAUSTED?(hs(e.toString()),hs("Using maximum backoff delay to prevent overloading the backend."),r.qo.xo()):e&&e.code===Ze.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Yo(),r.stream.close(),r.stream=null),r.state=t,yield r.listener.ao(e)})()}Yo(){}auth(){this.state=1;const t=this.Xo(this.Fo),e=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Fo===e&&this.Zo(r,i)},r=>{t(()=>{const i=new ot(Ze.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(i)})})}Zo(t,e){const r=this.Xo(this.Fo);this.stream=this.eu(t,e),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{r(()=>this.tu(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Go(){var t=this;this.state=5,this.qo.No((0,q.Z)(function*(){t.state=0,t.start()}))}tu(t){return Ct("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Xo(t){return e=>{this.ii.enqueueAndForget(()=>this.Fo===t?e():(Ct("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rxe extends Ene{constructor(t,e,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,i,o),this.serializer=s}eu(t,e){return this.connection.Ro("Listen",t,e)}onMessage(t){this.qo.reset();const e=function mCe(n,t){let e;if("targetChange"in t){const r="NO_CHANGE"===(c=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:Jt(),i=t.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(dn(void 0===u||"string"==typeof u),Gs.fromBase64String(u||"")):(dn(void 0===u||u instanceof Uint8Array),Gs.fromUint8Array(u||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(c){const u=void 0===c.code?Ze.UNKNOWN:vte(c.code);return new ot(u,c.message||"")}(o);e=new Ite(r,i,s,l||null)}else if("documentChange"in t){const r=t.documentChange,i=ah(n,r.document.name),s=fs(r.document.updateTime),o=r.document.createTime?fs(r.document.createTime):hn.min(),l=new jo({mapValue:{fields:r.document.fields}}),c=Ii.newFoundDocument(i,s,o,l);e=new Y2(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,i=ah(n,r.document),s=r.readTime?fs(r.readTime):hn.min(),o=Ii.newNoDocument(i,s);e=new Y2([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,i=ah(n,r.document);e=new Y2([],r.removedTargetIds||[],i,null)}else{if(!("filter"in t))return Jt();{const r=t.filter,{count:i=0,unchangedNames:s}=r,o=new oCe(i,s);e=new xte(r.targetId,o)}}var c;return e}(this.serializer,t),r=function(i){if(!("targetChange"in i))return hn.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?hn.min():s.readTime?fs(s.readTime):hn.min()}(t);return this.listener.nu(e,r)}su(t){const e={};e.database=kA(this.serializer),e.addTarget=function(i,s){let o;const l=s.target;if(o=U2(l)?{documents:Ote(i,l)}:{query:Y6(i,l)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=Dte(i,s.resumeToken);const c=W6(i,s.expectedCount);null!==c&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(hn.min())>0){o.readTime=sI(i,s.snapshotVersion.toTimestamp());const c=W6(i,s.expectedCount);null!==c&&(o.expectedCount=c)}return o}(this.serializer,t);const r=function _Ce(n,t){const e=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Jt()}}(t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);r&&(e.labels=r),this.Wo(e)}iu(t){const e={};e.database=kA(this.serializer),e.removeTarget=t,this.Wo(e)}}class ixe extends Ene{constructor(t,e,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,i,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(t,e){return this.connection.Ro("Write",t,e)}onMessage(t){if(dn(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ru){this.qo.reset();const e=function gCe(n,t){return n&&n.length>0?(dn(void 0!==t),n.map(e=>function(r,i){let s=fs(r.updateTime?r.updateTime:i);return s.isEqual(hn.min())&&(s=fs(i)),new nCe(s,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),r=fs(t.commitTime);return this.listener.cu(r,e)}return dn(!t.writeResults||0===t.writeResults.length),this.ru=!0,this.listener.au()}hu(){const t={};t.database=kA(this.serializer),this.Wo(t)}uu(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>AA(this.serializer,r))};this.Wo(e)}}class sxe extends class{}{constructor(t,e,r,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new ot(Ze.FAILED_PRECONDITION,"The client has already been terminated.")}Io(t,e,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(t,e,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===Ze.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ot(Ze.UNKNOWN,i.toString())})}vo(t,e,r,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(t,e,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Ze.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ot(Ze.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class axe{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(t){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.yu("Offline")))}set(t){this.Tu(),this.wu=0,"Online"===t&&(this.mu=!1),this.yu(t)}yu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}pu(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(hs(e),this.mu=!1):Ct("OnlineStateTracker",e)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class lxe{constructor(t,e,r,i,s){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(l=>{r.enqueueAndForget((0,q.Z)(function*(){var c;Pg(o)&&(Ct("RemoteStore","Restarting streams for network reachability change."),yield(c=(0,q.Z)(function*(u){const f=Vt(u);f.vu.add(4),yield dI(f),f.bu.set("Unknown"),f.vu.delete(4),yield VA(f)}),function(u){return c.apply(this,arguments)})(o))}))}),this.bu=new axe(r,i)}}function VA(n){return bW.apply(this,arguments)}function bW(){return bW=(0,q.Z)(function*(n){if(Pg(n))for(const t of n.Ru)yield t(!0)}),bW.apply(this,arguments)}function dI(n){return wW.apply(this,arguments)}function wW(){return wW=(0,q.Z)(function*(n){for(const t of n.Ru)yield t(!1)}),wW.apply(this,arguments)}function hL(n,t){const e=Vt(n);e.Au.has(t.targetId)||(e.Au.set(t.targetId,t),IW(e)?xW(e):fI(e).Ko()&&CW(e,t))}function UA(n,t){const e=Vt(n),r=fI(e);e.Au.delete(t),r.Ko()&&Dne(e,t),0===e.Au.size&&(r.Ko()?r.jo():Pg(e)&&e.bu.set("Unknown"))}function CW(n,t){if(n.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(hn.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}fI(n).su(t)}function Dne(n,t){n.Vu.qt(t),fI(n).iu(t)}function xW(n){n.Vu=new lCe({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),le:t=>n.Au.get(t)||null,ue:()=>n.datastore.serializer.databaseId}),fI(n).start(),n.bu.gu()}function IW(n){return Pg(n)&&!fI(n).Uo()&&n.Au.size>0}function Pg(n){return 0===Vt(n).vu.size}function kne(n){n.Vu=void 0}function cxe(n){return TW.apply(this,arguments)}function TW(){return TW=(0,q.Z)(function*(n){n.Au.forEach((t,e)=>{CW(n,t)})}),TW.apply(this,arguments)}function uxe(n,t){return SW.apply(this,arguments)}function SW(){return SW=(0,q.Z)(function*(n,t){kne(n),IW(n)?(n.bu.Iu(t),xW(n)):n.bu.set("Unknown")}),SW.apply(this,arguments)}function dxe(n,t,e){return EW.apply(this,arguments)}function EW(){return EW=(0,q.Z)(function*(n,t,e){if(n.bu.set("Online"),t instanceof Ite&&2===t.state&&t.cause)try{yield(r=(0,q.Z)(function*(i,s){const o=s.cause;for(const l of s.targetIds)i.Au.has(l)&&(yield i.remoteSyncer.rejectListen(l,o),i.Au.delete(l),i.Vu.removeTarget(l))}),function(i,s){return r.apply(this,arguments)})(n,t)}catch(r){Ct("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield fL(n,r)}else if(t instanceof Y2?n.Vu.Ht(t):t instanceof xte?n.Vu.ne(t):n.Vu.Xt(t),!e.isEqual(hn.min()))try{const r=yield _ne(n.localStore);e.compareTo(r)>=0&&(yield function(i,s){const o=i.Vu.ce(s);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Au.get(c);u&&i.Au.set(c,u.withResumeToken(l.resumeToken,s))}}),o.targetMismatches.forEach((l,c)=>{const u=i.Au.get(l);if(!u)return;i.Au.set(l,u.withResumeToken(Gs.EMPTY_BYTE_STRING,u.snapshotVersion)),Dne(i,l);const f=new ep(u.target,l,c,u.sequenceNumber);CW(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(n,e))}catch(r){Ct("RemoteStore","Failed to raise snapshot:",r),yield fL(n,r)}var r}),EW.apply(this,arguments)}function fL(n,t,e){return DW.apply(this,arguments)}function DW(){return DW=(0,q.Z)(function*(n,t,e){if(!Ig(t))throw t;n.vu.add(1),yield dI(n),n.bu.set("Offline"),e||(e=()=>_ne(n.localStore)),n.asyncQueue.enqueueRetryable((0,q.Z)(function*(){Ct("RemoteStore","Retrying IndexedDB access"),yield e(),n.vu.delete(1),yield VA(n)}))}),DW.apply(this,arguments)}function Ane(n,t){return t().catch(e=>fL(n,e,t))}function hI(n){return kW.apply(this,arguments)}function kW(){return kW=(0,q.Z)(function*(n){const t=Vt(n),e=Lg(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;hxe(t);)try{const i=yield KCe(t.localStore,r);if(null===i){0===t.Eu.length&&e.jo();break}r=i.batchId,fxe(t,i)}catch(i){yield fL(t,i)}Nne(t)&&Rne(t)}),kW.apply(this,arguments)}function hxe(n){return Pg(n)&&n.Eu.length<10}function fxe(n,t){n.Eu.push(t);const e=Lg(n);e.Ko()&&e.ou&&e.uu(t.mutations)}function Nne(n){return Pg(n)&&!Lg(n).Uo()&&n.Eu.length>0}function Rne(n){Lg(n).start()}function pxe(n){return AW.apply(this,arguments)}function AW(){return AW=(0,q.Z)(function*(n){Lg(n).hu()}),AW.apply(this,arguments)}function mxe(n){return NW.apply(this,arguments)}function NW(){return NW=(0,q.Z)(function*(n){const t=Lg(n);for(const e of n.Eu)t.uu(e.mutations)}),NW.apply(this,arguments)}function gxe(n,t,e){return RW.apply(this,arguments)}function RW(){return RW=(0,q.Z)(function*(n,t,e){const r=n.Eu.shift(),i=U6.from(r,t,e);yield Ane(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield hI(n)}),RW.apply(this,arguments)}function _xe(n,t){return MW.apply(this,arguments)}function MW(){return MW=(0,q.Z)(function*(n,t){var e;t&&Lg(n).ou&&(yield(e=(0,q.Z)(function*(r,i){if(yte(s=i.code)&&s!==Ze.ABORTED){const o=r.Eu.shift();Lg(r).Qo(),yield Ane(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield hI(r)}var s}),function(r,i){return e.apply(this,arguments)})(n,t)),Nne(n)&&Rne(n)}),MW.apply(this,arguments)}function Mne(n,t){return OW.apply(this,arguments)}function OW(){return OW=(0,q.Z)(function*(n,t){const e=Vt(n);e.asyncQueue.verifyOperationInProgress(),Ct("RemoteStore","RemoteStore received new credentials");const r=Pg(e);e.vu.add(3),yield dI(e),r&&e.bu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e.vu.delete(3),yield VA(e)}),OW.apply(this,arguments)}function FW(n,t){return PW.apply(this,arguments)}function PW(){return PW=(0,q.Z)(function*(n,t){const e=Vt(n);t?(e.vu.delete(2),yield VA(e)):t||(e.vu.add(2),yield dI(e),e.bu.set("Unknown"))}),PW.apply(this,arguments)}function fI(n){return n.Su||(n.Su=function(t,e,r){const i=Vt(t);return i.fu(),new rxe(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:cxe.bind(null,n),ao:uxe.bind(null,n),nu:dxe.bind(null,n)}),n.Ru.push(function(){var t=(0,q.Z)(function*(e){e?(n.Su.Qo(),IW(n)?xW(n):n.bu.set("Unknown")):(yield n.Su.stop(),kne(n))});return function(e){return t.apply(this,arguments)}}())),n.Su}function Lg(n){return n.Du||(n.Du=function(t,e,r){const i=Vt(t);return i.fu(),new ixe(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:pxe.bind(null,n),ao:_xe.bind(null,n),au:mxe.bind(null,n),cu:gxe.bind(null,n)}),n.Ru.push(function(){var t=(0,q.Z)(function*(e){e?(n.Du.Qo(),yield hI(n)):(yield n.Du.stop(),n.Eu.length>0&&(Ct("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Du}class LW{constructor(t,e,r,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Hs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,e,r,i,s){const o=Date.now()+r,l=new LW(t,e,o,i,s);return l.start(r),l}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ot(Ze.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pI(n,t){if(hs("AsyncQueue",`${t}: ${n}`),Ig(n))return new ot(Ze.UNAVAILABLE,`${t}: ${n}`);throw n}class mI{constructor(t){this.comparator=t?(e,r)=>t(e,r)||$t.comparator(e.key,r.key):(e,r)=>$t.comparator(e.key,r.key),this.keyedMap=wA(),this.sortedSet=new di(this.comparator)}static emptySet(t){return new mI(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof mI)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new mI;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class One{constructor(){this.Cu=new di($t.comparator)}track(t){const e=t.doc.key,r=this.Cu.get(e);r?0!==t.type&&3===r.type?this.Cu=this.Cu.insert(e,t):3===t.type&&1!==r.type?this.Cu=this.Cu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Cu=this.Cu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Cu=this.Cu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Cu=this.Cu.remove(e):1===t.type&&2===r.type?this.Cu=this.Cu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Cu=this.Cu.insert(e,{type:2,doc:t.doc}):Jt():this.Cu=this.Cu.insert(e,t)}xu(){const t=[];return this.Cu.inorderTraversal((e,r)=>{t.push(r)}),t}}class gI{constructor(t,e,r,i,s,o,l,c,u){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(t,e,r,i,s){const o=[];return e.forEach(l=>{o.push({type:0,doc:l})}),new gI(t,e,mI.emptySet(e),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&vA(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==r[i].type||!e[i].doc.isEqual(r[i].doc))return!1;return!0}}class yxe{constructor(){this.Nu=void 0,this.listeners=[]}}class vxe{constructor(){this.queries=new Xf(t=>Jee(t),vA),this.onlineState="Unknown",this.ku=new Set}}function $W(n,t){return BW.apply(this,arguments)}function BW(){return BW=(0,q.Z)(function*(n,t){const e=Vt(n),r=t.query;let i=!1,s=e.queries.get(r);if(s||(i=!0,s=new yxe),i)try{s.Nu=yield e.onListen(r)}catch(o){const l=pI(o,`Initialization of query '${L6(t.query)}' failed`);return void t.onError(l)}e.queries.set(r,s),s.listeners.push(t),t.Mu(e.onlineState),s.Nu&&t.$u(s.Nu)&&zW(e)}),BW.apply(this,arguments)}function VW(n,t){return UW.apply(this,arguments)}function UW(){return UW=(0,q.Z)(function*(n,t){const e=Vt(n),r=t.query;let i=!1;const s=e.queries.get(r);if(s){const o=s.listeners.indexOf(t);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return e.queries.delete(r),e.onUnlisten(r)}),UW.apply(this,arguments)}function bxe(n,t){const e=Vt(n);let r=!1;for(const i of t){const o=e.queries.get(i.query);if(o){for(const l of o.listeners)l.$u(i)&&(r=!0);o.Nu=i}}r&&zW(e)}function wxe(n,t,e){const r=Vt(n),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(e);r.queries.delete(t)}function zW(n){n.ku.forEach(t=>{t.next()})}class HW{constructor(t,e,r){this.query=t,this.Ou=e,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)3!==i.type&&r.push(i);t=new gI(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Fu?this.Lu(t)&&(this.Ou.next(t),e=!0):this.qu(t,this.onlineState)&&(this.Uu(t),e=!0),this.Bu=t,e}onError(t){this.Ou.error(t)}Mu(t){this.onlineState=t;let e=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,t)&&(this.Uu(this.Bu),e=!0),e}qu(t,e){return!t.fromCache||(!this.options.Ku||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Lu(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(t){t=gI.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Fu=!0,this.Ou.next(t)}}class Cxe{constructor(t,e){this.Gu=t,this.byteLength=e}Qu(){return"metadata"in this.Gu}}class Fne{constructor(t){this.serializer=t}rr(t){return ah(this.serializer,t)}ur(t){return t.metadata.exists?Mte(this.serializer,t.document,!1):Ii.newNoDocument(this.rr(t.metadata.name),this.cr(t.metadata.readTime))}cr(t){return fs(t)}}class xxe{constructor(t,e,r){this.ju=t,this.localStore=e,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Pne(t)}zu(t){this.progress.bytesLoaded+=t.byteLength;let e=this.progress.documentsLoaded;if(t.Gu.namedQuery)this.queries.push(t.Gu.namedQuery);else if(t.Gu.documentMetadata){this.documents.push({metadata:t.Gu.documentMetadata}),t.Gu.documentMetadata.exists||++e;const r=xr.fromString(t.Gu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else t.Gu.document&&(this.documents[this.documents.length-1].document=t.Gu.document,++e);return e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null}Wu(t){const e=new Map,r=new Fne(this.serializer);for(const i of t)if(i.metadata.queries){const s=r.rr(i.metadata.name);for(const o of i.metadata.queries){const l=(e.get(o)||jn()).add(s);e.set(o,l)}}return e}complete(){var t=this;return(0,q.Z)(function*(){const e=yield function QCe(n,t,e,r){return dW.apply(this,arguments)}(t.localStore,new Fne(t.serializer),t.documents,t.ju.id),r=t.Wu(t.documents);for(const i of t.queries)yield XCe(t.localStore,i,r.get(i.name));return t.progress.taskState="Success",{progress:t.progress,Hu:t.collectionGroups,Ju:e}})()}}function Pne(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class Lne{constructor(t){this.key=t}}class $ne{constructor(t){this.key=t}}class Bne{constructor(t,e){this.query=t,this.Yu=e,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=jn(),this.mutatedKeys=jn(),this.tc=tte(t),this.ec=new mI(this.tc)}get nc(){return this.Yu}sc(t,e){const r=e?e.ic:new One,i=e?e.ec:this.ec;let s=e?e.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,u="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((f,m)=>{const _=i.get(f),y=bA(this.query,m)?m:null,w=!!_&&this.mutatedKeys.has(_.key),T=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let I=!1;_&&y?_.data.isEqual(y.data)?w!==T&&(r.track({type:3,doc:y}),I=!0):this.rc(_,y)||(r.track({type:2,doc:y}),I=!0,(c&&this.tc(y,c)>0||u&&this.tc(y,u)<0)&&(l=!0)):!_&&y?(r.track({type:0,doc:y}),I=!0):_&&!y&&(r.track({type:1,doc:_}),I=!0,(c||u)&&(l=!0)),I&&(y?(o=o.add(y),s=T?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const f="F"===this.query.limitType?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{ec:o,ic:r,zi:l,mutatedKeys:s}}rc(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const i=this.ec;this.ec=t.ec,this.mutatedKeys=t.mutatedKeys;const s=t.ic.xu();s.sort((u,f)=>function(m,_){const y=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Jt()}};return y(m)-y(_)}(u.type,f.type)||this.tc(u.doc,f.doc)),this.oc(r);const o=e?this.uc():[],l=0===this.Zu.size&&this.current?1:0,c=l!==this.Xu;return this.Xu=l,0!==s.length||c?{snapshot:new gI(this.query,t.ec,i,s,t.mutatedKeys,0===l,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ec:this.ec,ic:new One,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(t){return!this.Yu.has(t)&&!!this.ec.has(t)&&!this.ec.get(t).hasLocalMutations}oc(t){t&&(t.addedDocuments.forEach(e=>this.Yu=this.Yu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Yu=this.Yu.delete(e)),this.current=t.current)}uc(){if(!this.current)return[];const t=this.Zu;this.Zu=jn(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const e=[];return t.forEach(r=>{this.Zu.has(r)||e.push(new $ne(r))}),this.Zu.forEach(r=>{t.has(r)||e.push(new Lne(r))}),e}hc(t){this.Yu=t.ir,this.Zu=jn();const e=this.sc(t.documents);return this.applyChanges(e,!0)}lc(){return gI.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Ixe{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class Txe{constructor(t){this.key=t,this.fc=!1}}class Sxe{constructor(t,e,r,i,s,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new Xf(l=>Jee(l),vA),this._c=new Map,this.mc=new Set,this.gc=new di($t.comparator),this.yc=new Map,this.Ic=new rW,this.Tc={},this.Ec=new Map,this.Ac=mb.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function Exe(n,t){return GW.apply(this,arguments)}function GW(){return GW=(0,q.Z)(function*(n,t){const e=fj(n);let r,i;const s=e.wc.get(t);if(s)r=s.targetId,e.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{const o=yield cI(e.localStore,ja(t)),l=e.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield WW(e,t,r,"current"===l,o.resumeToken),e.isPrimaryClient&&hL(e.remoteStore,o)}return i}),GW.apply(this,arguments)}function WW(n,t,e,r,i){return jW.apply(this,arguments)}function jW(){return jW=(0,q.Z)(function*(n,t,e,r,i){n.Rc=(m,_,y)=>{return(w=(0,q.Z)(function*(T,I,E,A){let M=I.view.sc(E);M.zi&&(M=yield aL(T.localStore,I.query,!1).then(({documents:V})=>I.view.sc(V,M)));const O=A&&A.targetChanges.get(I.targetId),$=I.view.applyChanges(M,T.isPrimaryClient,O);return nj(T,I.targetId,$.cc),$.snapshot}),function(T,I,E,A){return w.apply(this,arguments)})(n,m,_,y);var w};const s=yield aL(n.localStore,t,!0),o=new Bne(t,s.ir),l=o.sc(s.documents),c=EA.createSynthesizedTargetChangeForCurrentChange(e,r&&"Offline"!==n.onlineState,i),u=o.applyChanges(l,n.isPrimaryClient,c);nj(n,e,u.cc);const f=new Ixe(t,e,o);return n.wc.set(t,f),n._c.has(e)?n._c.get(e).push(t):n._c.set(e,[t]),u.snapshot}),jW.apply(this,arguments)}function Dxe(n,t){return qW.apply(this,arguments)}function qW(){return qW=(0,q.Z)(function*(n,t){const e=Vt(n),r=e.wc.get(t),i=e._c.get(r.targetId);if(i.length>1)return e._c.set(r.targetId,i.filter(s=>!vA(s,t))),void e.wc.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(r.targetId),e.sharedClientState.isActiveQueryTarget(r.targetId)||(yield uI(e.localStore,r.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(r.targetId),UA(e.remoteStore,r.targetId),_I(e,r.targetId)}).catch(xg))):(_I(e,r.targetId),yield uI(e.localStore,r.targetId,!0))}),qW.apply(this,arguments)}function ZW(){return ZW=(0,q.Z)(function*(n,t,e){const r=pj(n);try{const i=yield function(s,o){const l=Vt(s),c=Gr.now(),u=o.reduce((_,y)=>_.add(y.key),jn());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let y=xl(),w=jn();return l.Zi.getEntries(_,u).next(T=>{y=T,y.forEach((I,E)=>{E.isValidDocument()||(w=w.add(I))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,y)).next(T=>{f=T;const I=[];for(const E of o){const A=iCe(E,f.get(E.key).overlayedDocument);null!=A&&I.push(new Jf(E.key,A,Bee(A.value.mapValue),Mi.exists(!0)))}return l.mutationQueue.addMutationBatch(_,c,I,o)}).next(T=>{m=T;const I=T.applyToLocalDocumentSet(f,w);return l.documentOverlayCache.saveOverlays(_,T.batchId,I)})}).then(()=>({batchId:m.batchId,changes:rte(f)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(s,o,l){let c=s.Tc[s.currentUser.toKey()];c||(c=new di(Pn)),c=c.insert(o,l),s.Tc[s.currentUser.toKey()]=c}(r,i.batchId,e),yield tp(r,i.changes),yield hI(r.remoteStore)}catch(i){const s=pI(i,"Failed to persist write");e.reject(s)}}),ZW.apply(this,arguments)}function Vne(n,t){return YW.apply(this,arguments)}function YW(){return YW=(0,q.Z)(function*(n,t){const e=Vt(n);try{const r=yield YCe(e.localStore,t);t.targetChanges.forEach((i,s)=>{const o=e.yc.get(s);o&&(dn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.fc=!0:i.modifiedDocuments.size>0?dn(o.fc):i.removedDocuments.size>0&&(dn(o.fc),o.fc=!1))}),yield tp(e,r,t)}catch(r){yield xg(r)}}),YW.apply(this,arguments)}function Une(n,t,e){const r=Vt(n);if(r.isPrimaryClient&&0===e||!r.isPrimaryClient&&1===e){const i=[];r.wc.forEach((s,o)=>{const l=o.view.Mu(t);l.snapshot&&i.push(l.snapshot)}),function(s,o){const l=Vt(s);l.onlineState=o;let c=!1;l.queries.forEach((u,f)=>{for(const m of f.listeners)m.Mu(o)&&(c=!0)}),c&&zW(l)}(r.eventManager,t),i.length&&r.dc.nu(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Axe(n,t,e){return KW.apply(this,arguments)}function KW(){return KW=(0,q.Z)(function*(n,t,e){const r=Vt(n);r.sharedClientState.updateQueryState(t,"rejected",e);const i=r.yc.get(t),s=i&&i.key;if(s){let o=new di($t.comparator);o=o.insert(s,Ii.newNoDocument(s,hn.min()));const l=jn().add(s),c=new SA(hn.min(),new Map,new di(Pn),o,l);yield Vne(r,c),r.gc=r.gc.remove(s),r.yc.delete(t),rj(r)}else yield uI(r.localStore,t,!1).then(()=>_I(r,t,e)).catch(xg)}),KW.apply(this,arguments)}function Nxe(n,t){return QW.apply(this,arguments)}function QW(){return QW=(0,q.Z)(function*(n,t){const e=Vt(n),r=t.batch.batchId;try{const i=yield ZCe(e.localStore,t);tj(e,r,null),ej(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),yield tp(e,i)}catch(i){yield xg(i)}}),QW.apply(this,arguments)}function Rxe(n,t,e){return XW.apply(this,arguments)}function XW(){return XW=(0,q.Z)(function*(n,t,e){const r=Vt(n);try{const i=yield function(s,o){const l=Vt(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(f=>(dn(null!==f),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,t);tj(r,t,e),ej(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),yield tp(r,i)}catch(i){yield xg(i)}}),XW.apply(this,arguments)}function JW(){return JW=(0,q.Z)(function*(n,t){const e=Vt(n);Pg(e.remoteStore)||Ct("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(s){const o=Vt(s);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>o.mutationQueue.getHighestUnacknowledgedBatchId(l))}(e.localStore);if(-1===r)return void t.resolve();const i=e.Ec.get(r)||[];i.push(t),e.Ec.set(r,i)}catch(r){const i=pI(r,"Initialization of waitForPendingWrites() operation failed");t.reject(i)}}),JW.apply(this,arguments)}function ej(n,t){(n.Ec.get(t)||[]).forEach(e=>{e.resolve()}),n.Ec.delete(t)}function tj(n,t,e){const r=Vt(n);let i=r.Tc[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(e?s.reject(e):s.resolve(),i=i.remove(t)),r.Tc[r.currentUser.toKey()]=i}}function _I(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n._c.get(t))n.wc.delete(r),e&&n.dc.Pc(r,e);n._c.delete(t),n.isPrimaryClient&&n.Ic.Is(t).forEach(r=>{n.Ic.containsKey(r)||zne(n,r)})}function zne(n,t){n.mc.delete(t.path.canonicalString());const e=n.gc.get(t);null!==e&&(UA(n.remoteStore,e),n.gc=n.gc.remove(t),n.yc.delete(e),rj(n))}function nj(n,t,e){for(const r of e)r instanceof Lne?(n.Ic.addReference(r.key,t),Oxe(n,r)):r instanceof $ne?(Ct("SyncEngine","Document no longer in limbo: "+r.key),n.Ic.removeReference(r.key,t),n.Ic.containsKey(r.key)||zne(n,r.key)):Jt()}function Oxe(n,t){const e=t.key,r=e.path.canonicalString();n.gc.get(e)||n.mc.has(r)||(Ct("SyncEngine","New document in limbo: "+e),n.mc.add(r),rj(n))}function rj(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){const t=n.mc.values().next().value;n.mc.delete(t);const e=new $t(xr.fromString(t)),r=n.Ac.next();n.yc.set(r,new Txe(e)),n.gc=n.gc.insert(e,r),hL(n.remoteStore,new ep(ja(eI(e.path)),r,"TargetPurposeLimboResolution",lc.ct))}}function tp(n,t,e){return ij.apply(this,arguments)}function ij(){return ij=(0,q.Z)(function*(n,t,e){const r=Vt(n),i=[],s=[],o=[];var l;r.wc.isEmpty()||(r.wc.forEach((l,c)=>{o.push(r.Rc(c,t,e).then(u=>{if((u||e)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);const f=lW.Li(c.targetId,u);s.push(f)}}))}),yield Promise.all(o),r.dc.nu(i),yield(l=(0,q.Z)(function*(c,u){const f=Vt(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Be.forEach(u,_=>Be.forEach(_.Fi,y=>f.persistence.referenceDelegate.addReference(m,_.targetId,y)).next(()=>Be.forEach(_.Bi,y=>f.persistence.referenceDelegate.removeReference(m,_.targetId,y)))))}catch(m){if(!Ig(m))throw m;Ct("LocalStore","Failed to update sequence numbers: "+m)}for(const m of u){const _=m.targetId;if(!m.fromCache){const y=f.Ji.get(_),T=y.withLastLimboFreeSnapshotVersion(y.snapshotVersion);f.Ji=f.Ji.insert(_,T)}}}),function(c,u){return l.apply(this,arguments)})(r.localStore,s))}),ij.apply(this,arguments)}function Fxe(n,t){return sj.apply(this,arguments)}function sj(){return sj=(0,q.Z)(function*(n,t){const e=Vt(n);if(!e.currentUser.isEqual(t)){Ct("SyncEngine","User change. New user:",t.toKey());const r=yield gne(e.localStore,t);e.currentUser=t,(i=e).Ec.forEach(o=>{o.forEach(l=>{l.reject(new ot(Ze.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield tp(e,r.er)}var i}),sj.apply(this,arguments)}function Pxe(n,t){const e=Vt(n),r=e.yc.get(t);if(r&&r.fc)return jn().add(r.key);{let i=jn();const s=e._c.get(t);if(!s)return i;for(const o of s){const l=e.wc.get(o);i=i.unionWith(l.view.nc)}return i}}function Lxe(n,t){return oj.apply(this,arguments)}function oj(){return oj=(0,q.Z)(function*(n,t){const e=Vt(n),r=yield aL(e.localStore,t.query,!0),i=t.view.hc(r);return e.isPrimaryClient&&nj(e,t.targetId,i.cc),i}),oj.apply(this,arguments)}function $xe(n,t){return aj.apply(this,arguments)}function aj(){return aj=(0,q.Z)(function*(n,t){const e=Vt(n);return bne(e.localStore,t).then(r=>tp(e,r))}),aj.apply(this,arguments)}function Bxe(n,t,e,r){return lj.apply(this,arguments)}function lj(){return lj=(0,q.Z)(function*(n,t,e,r){const i=Vt(n),s=yield function(o,l){const c=Vt(o),u=Vt(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",f=>u.Sn(f,l).next(m=>m?c.localDocuments.getDocuments(f,m):Be.resolve(null)))}(i.localStore,t);var l;null!==s?("pending"===e?yield hI(i.remoteStore):"acknowledged"===e||"rejected"===e?(tj(i,t,r||null),ej(i,t),l=t,Vt(Vt(i.localStore).mutationQueue).Cn(l)):Jt(),yield tp(i,s)):Ct("SyncEngine","Cannot apply mutation batch with id: "+t)}),lj.apply(this,arguments)}function cj(){return cj=(0,q.Z)(function*(n,t){const e=Vt(n);if(fj(e),pj(e),!0===t&&!0!==e.vc){const r=e.sharedClientState.getAllActiveQueryTargets(),i=yield Hne(e,r.toArray());e.vc=!0,yield FW(e.remoteStore,!0);for(const s of i)hL(e.remoteStore,s)}else if(!1===t&&!1!==e.vc){const r=[];let i=Promise.resolve();e._c.forEach((s,o)=>{e.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(_I(e,o),uI(e.localStore,o,!0))),UA(e.remoteStore,o)}),yield i,yield Hne(e,r),function(s){const o=Vt(s);o.yc.forEach((l,c)=>{UA(o.remoteStore,c)}),o.Ic.Ts(),o.yc=new Map,o.gc=new di($t.comparator)}(e),e.vc=!1,yield FW(e.remoteStore,!1)}}),cj.apply(this,arguments)}function Hne(n,t,e){return uj.apply(this,arguments)}function uj(){return uj=(0,q.Z)(function*(n,t,e){const r=Vt(n),i=[],s=[];for(const o of t){let l;const c=r._c.get(o);if(c&&0!==c.length){l=yield cI(r.localStore,ja(c[0]));for(const u of c){const f=r.wc.get(u),m=yield Lxe(r,f);m.snapshot&&s.push(m.snapshot)}}else{const u=yield vne(r.localStore,o);l=yield cI(r.localStore,u),yield WW(r,Gne(u),o,!1,l.resumeToken)}i.push(l)}return r.dc.nu(s),i}),uj.apply(this,arguments)}function Gne(n){return Qee(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Uxe(n){const t=Vt(n);return Vt(Vt(t.localStore).persistence).$i()}function zxe(n,t,e,r){return dj.apply(this,arguments)}function dj(){return dj=(0,q.Z)(function*(n,t,e,r){const i=Vt(n);if(i.vc)return void Ct("SyncEngine","Ignoring unexpected query state notification.");const s=i._c.get(t);if(s&&s.length>0)switch(e){case"current":case"not-current":{const o=yield bne(i.localStore,ete(s[0])),l=SA.createSynthesizedRemoteEventForCurrentChange(t,"current"===e,Gs.EMPTY_BYTE_STRING);yield tp(i,o,l);break}case"rejected":yield uI(i.localStore,t,!0),_I(i,t,r);break;default:Jt()}}),dj.apply(this,arguments)}function Hxe(n,t,e){return hj.apply(this,arguments)}function hj(){return hj=(0,q.Z)(function*(n,t,e){const r=fj(n);if(r.vc){for(const i of t){if(r._c.has(i)){Ct("SyncEngine","Adding an already active target "+i);continue}const s=yield vne(r.localStore,i),o=yield cI(r.localStore,s);yield WW(r,Gne(s),o.targetId,!1,o.resumeToken),hL(r.remoteStore,o)}for(const i of e)r._c.has(i)&&(yield uI(r.localStore,i,!1).then(()=>{UA(r.remoteStore,i),_I(r,i)}).catch(xg))}}),hj.apply(this,arguments)}function fj(n){const t=Vt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=Vne.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Pxe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Axe.bind(null,t),t.dc.nu=bxe.bind(null,t.eventManager),t.dc.Pc=wxe.bind(null,t.eventManager),t}function pj(n){const t=Vt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Nxe.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Rxe.bind(null,t),t}class zA{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return(0,q.Z)(function*(){e.serializer=BA(t.databaseInfo.databaseId),e.sharedClientState=e.createSharedClientState(t),e.persistence=e.createPersistence(t),yield e.persistence.start(),e.localStore=e.createLocalStore(t),e.gcScheduler=e.createGarbageCollectionScheduler(t,e.localStore),e.indexBackfillerScheduler=e.createIndexBackfillerScheduler(t,e.localStore)})()}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return mne(this.persistence,new pne,t.initialUser,this.serializer)}createPersistence(t){return new iW(iL.zs,this.serializer)}createSharedClientState(t){return new Ine}terminate(){var t=this;return(0,q.Z)(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class mj extends zA{constructor(t,e,r){super(),this.Vc=t,this.cacheSizeBytes=e,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(t){var e=()=>super.initialize,r=this;return(0,q.Z)(function*(){yield e().call(r,t),yield r.Vc.initialize(r,t),yield pj(r.Vc.syncEngine),yield hI(r.Vc.remoteStore),yield r.persistence.Ii(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(t){return mne(this.persistence,new pne,t.initialUser,this.serializer)}createGarbageCollectionScheduler(t,e){return new sne(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue,e)}createIndexBackfillerScheduler(t,e){const r=new gwe(e,this.persistence);return new mwe(t.asyncQueue,r)}createPersistence(t){const e=aW(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?fa.withCacheSize(this.cacheSizeBytes):fa.DEFAULT;return new oW(this.synchronizeTabs,e,t.clientId,r,t.asyncQueue,Sne(),dL(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(t){return new Ine}}class Wne extends mj{constructor(t,e){super(t,e,!1),this.Vc=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}initialize(t){var e=()=>super.initialize,r=this;return(0,q.Z)(function*(){yield e().call(r,t);const i=r.Vc.syncEngine;r.sharedClientState instanceof gW&&(r.sharedClientState.syncEngine={jr:Bxe.bind(null,i),zr:zxe.bind(null,i),Wr:Hxe.bind(null,i),$i:Uxe.bind(null,i),Qr:$xe.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.Ii(function(){var s=(0,q.Z)(function*(o){yield function Vxe(n,t){return cj.apply(this,arguments)}(r.Vc.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(t){const e=Sne();if(!gW.D(e))throw new ot(Ze.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=aW(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new gW(e,t.asyncQueue,r,t.clientId,t.initialUser)}}class yI{initialize(t,e){var r=this;return(0,q.Z)(function*(){r.localStore||(r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(e),r.remoteStore=r.createRemoteStore(e),r.eventManager=r.createEventManager(e),r.syncEngine=r.createSyncEngine(e,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Une(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Fxe.bind(null,r.syncEngine),yield FW(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(t){return new vxe}createDatastore(t){const e=BA(t.databaseInfo.databaseId),r=new nxe(t.databaseInfo);return new sxe(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,i=t.asyncQueue,s=l=>Une(this.syncEngine,l,0),o=Tne.D()?new Tne:new JCe,new lxe(e,r,i,s,o);var e,r,i,s,o}createSyncEngine(t,e){return function(r,i,s,o,l,c,u){const f=new Sxe(r,i,s,o,l,c);return u&&(f.vc=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=(0,q.Z)(function*(e){const r=Vt(e);Ct("RemoteStore","RemoteStore shutting down."),r.vu.add(5),yield dI(r),r.Pu.shutdown(),r.bu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function jne(n,t=10240){let e=0;return{read:()=>(0,q.Z)(function*(){if(e<n.byteLength){const r={value:n.slice(e,e+t),done:!1};return e+=t,r}return{done:!0}})(),cancel:()=>(0,q.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class pL{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Sc(this.observer.next,t)}error(t){this.observer.error?this.Sc(this.observer.error,t):hs("Uncaught Error in snapshot listener:",t.toString())}Dc(){this.muted=!0}Sc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class jxe{constructor(t,e){this.Cc=t,this.serializer=e,this.metadata=new Hs,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(r=>{r&&r.Qu()?this.metadata.resolve(r.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Gu)}`))},r=>this.metadata.reject(r))}close(){return this.Cc.cancel()}getMetadata(){var t=this;return(0,q.Z)(function*(){return t.metadata.promise})()}bc(){var t=this;return(0,q.Z)(function*(){return yield t.getMetadata(),t.Nc()})()}Nc(){var t=this;return(0,q.Z)(function*(){const e=yield t.kc();if(null===e)return null;const r=t.xc.decode(e),i=Number(r);isNaN(i)&&t.Mc(`length string (${r}) is not valid number`);const s=yield t.$c(i);return new Cxe(JSON.parse(s),e.length+i)})()}Oc(){return this.buffer.findIndex(t=>t==="{".charCodeAt(0))}kc(){var t=this;return(0,q.Z)(function*(){for(;t.Oc()<0&&!(yield t.Fc()););if(0===t.buffer.length)return null;const e=t.Oc();e<0&&t.Mc("Reached the end of bundle when a length string is expected.");const r=t.buffer.slice(0,e);return t.buffer=t.buffer.slice(e),r})()}$c(t){var e=this;return(0,q.Z)(function*(){for(;e.buffer.length<t;)(yield e.Fc())&&e.Mc("Reached the end of bundle when more is expected.");const r=e.xc.decode(e.buffer.slice(0,t));return e.buffer=e.buffer.slice(t),r})()}Mc(t){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${t}`)}Fc(){var t=this;return(0,q.Z)(function*(){const e=yield t.Cc.read();if(!e.done){const r=new Uint8Array(t.buffer.length+e.value.length);r.set(t.buffer),r.set(e.value,t.buffer.length),t.buffer=r}return e.done})()}}class qxe{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(t){var e=this;return(0,q.Z)(function*(){if(e.ensureCommitNotCalled(),e.mutations.length>0)throw new ot(Ze.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,q.Z)(function*(s,o){const l=Vt(s),c=kA(l.serializer)+"/documents",u={documents:o.map(y=>DA(l.serializer,y))},f=yield l.vo("BatchGetDocuments",c,u,o.length),m=new Map;f.forEach(y=>{const w=function pCe(n,t){return"found"in t?function(e,r){dn(!!r.found);const i=ah(e,r.found.name),s=fs(r.found.updateTime),o=r.found.createTime?fs(r.found.createTime):hn.min(),l=new jo({mapValue:{fields:r.found.fields}});return Ii.newFoundDocument(i,s,o,l)}(n,t):"missing"in t?function(e,r){dn(!!r.missing),dn(!!r.readTime);const i=ah(e,r.missing),s=fs(r.readTime);return Ii.newNoDocument(i,s)}(n,t):Jt()}(l.serializer,y);m.set(w.key.toString(),w)});const _=[];return o.forEach(y=>{const w=m.get(y.toString());dn(!!w),_.push(w)}),_}),function(s,o){return i.apply(this,arguments)})(e.datastore,t);var i;return r.forEach(i=>e.recordVersion(i)),r})()}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(t.toString())}delete(t){this.write(new iI(t,this.precondition(t))),this.writtenDocs.add(t.toString())}commit(){var t=this;return(0,q.Z)(function*(){if(t.ensureCommitNotCalled(),t.lastWriteError)throw t.lastWriteError;const e=t.readVersions;var r;t.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,i)=>{const s=$t.fromPath(i);t.mutations.push(new B6(s,t.precondition(s)))}),yield(r=(0,q.Z)(function*(i,s){const o=Vt(i),l=kA(o.serializer)+"/documents",c={writes:s.map(u=>AA(o.serializer,u))};yield o.Io("Commit",l,c)}),function(i,s){return r.apply(this,arguments)})(t.datastore,t.mutations),t.committed=!0})()}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Jt();e=hn.min()}const r=this.readVersions.get(t.key.toString());if(r){if(!e.isEqual(r))throw new ot(Ze.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(hn.min())?Mi.exists(!1):Mi.updateTime(e):Mi.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(hn.min()))throw new ot(Ze.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Mi.updateTime(e)}return Mi.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}class Zxe{constructor(t,e,r,i,s){this.asyncQueue=t,this.datastore=e,this.options=r,this.updateFunction=i,this.deferred=s,this.Bc=r.maxAttempts,this.qo=new yW(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){var t=this;this.qo.No((0,q.Z)(function*(){const e=new qxe(t.datastore),r=t.qc(e);r&&r.then(i=>{t.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{t.deferred.resolve(i)}).catch(s=>{t.Uc(s)}))}).catch(i=>{t.Uc(i)})}))}qc(t){try{const e=this.updateFunction(t);return!hA(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Uc(t){this.Bc>0&&this.Kc(t)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(t)}Kc(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||"already-exists"===e||!yte(e)}return!1}}class Yxe{constructor(t,e,r,i){var s=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=i,this.user=mo.UNAUTHENTICATED,this.clientId=mee.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,q.Z)(function*(l){Ct("FirestoreClient","Received user=",l.uid),yield s.authCredentialListener(l),s.user=l});return function(l){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(Ct("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var t=this;return(0,q.Z)(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ot(Ze.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new Hs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,q.Z)(function*(){try{t._onlineComponents&&(yield t._onlineComponents.terminate()),t._offlineComponents&&(yield t._offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(r){const i=pI(r,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function mL(n,t){return gj.apply(this,arguments)}function gj(){return gj=(0,q.Z)(function*(n,t){n.asyncQueue.verifyOperationInProgress(),Ct("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(function(){var i=(0,q.Z)(function*(s){r.isEqual(s)||(yield gne(t.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}),gj.apply(this,arguments)}function _j(n,t){return yj.apply(this,arguments)}function yj(){return yj=(0,q.Z)(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield vj(n);Ct("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield t.initialize(e,r),n.setCredentialChangeListener(i=>Mne(t.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>Mne(t.remoteStore,s)),n._onlineComponents=t}),yj.apply(this,arguments)}function qne(n){return"FirebaseError"===n.name?n.code===Ze.FAILED_PRECONDITION||n.code===Ze.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function vj(n){return bj.apply(this,arguments)}function bj(){return bj=(0,q.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ct("FirestoreClient","Using user provided OfflineComponentProvider");try{yield mL(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!qne(e))throw e;Zc("Error using user provided cache. Falling back to memory cache: "+e),yield mL(n,new zA)}}else Ct("FirestoreClient","Using default OfflineComponentProvider"),yield mL(n,new zA);return n._offlineComponents}),bj.apply(this,arguments)}function gL(n){return wj.apply(this,arguments)}function wj(){return wj=(0,q.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ct("FirestoreClient","Using user provided OnlineComponentProvider"),yield _j(n,n._uninitializedComponentsProvider._online)):(Ct("FirestoreClient","Using default OnlineComponentProvider"),yield _j(n,new yI))),n._onlineComponents}),wj.apply(this,arguments)}function Zne(n){return vj(n).then(t=>t.persistence)}function _L(n){return vj(n).then(t=>t.localStore)}function Yne(n){return gL(n).then(t=>t.remoteStore)}function Cj(n){return gL(n).then(t=>t.syncEngine)}function vI(n){return xj.apply(this,arguments)}function xj(){return xj=(0,q.Z)(function*(n){const t=yield gL(n),e=t.eventManager;return e.onListen=Exe.bind(null,t.syncEngine),e.onUnlisten=Dxe.bind(null,t.syncEngine),e}),xj.apply(this,arguments)}function Qne(n,t,e={}){const r=new Hs;return n.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return function(i,s,o,l,c){const u=new pL({next:m=>{s.enqueueAndForget(()=>VW(i,f));const _=m.docs.has(o);!_&&m.fromCache?c.reject(new ot(Ze.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&l&&"server"===l.source?c.reject(new ot(Ze.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new HW(eI(o.path),u,{includeMetadataChanges:!0,Ku:!0});return $W(i,f)}(yield vI(n),n.asyncQueue,t,e,r)})),r.promise}function Xne(n,t,e={}){const r=new Hs;return n.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return function(i,s,o,l,c){const u=new pL({next:m=>{s.enqueueAndForget(()=>VW(i,f)),m.fromCache&&"server"===l.source?c.reject(new ot(Ze.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new HW(o,u,{includeMetadataChanges:!0,Ku:!0});return $W(i,f)}(yield vI(n),n.asyncQueue,t,e,r)})),r.promise}function Jne(n){const t={};return void 0!==n.timeoutSeconds&&(t.timeoutSeconds=n.timeoutSeconds),t}const ere=new Map;function Ij(n,t,e){if(!e)throw new ot(Ze.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function tre(n,t,e,r){if(!0===t&&!0===r)throw new ot(Ze.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function nre(n){if(!$t.isDocumentKey(n))throw new ot(Ze.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rre(n){if($t.isDocumentKey(n))throw new ot(Ze.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function yL(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":Jt()}function mr(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new ot(Ze.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=yL(n);throw new ot(Ze.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function ire(n,t){if(t<=0)throw new ot(Ze.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}class sre{constructor(t){var e,r;if(void 0===t.host){if(void 0!==t.ssl)throw new ot(Ze.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.cache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ot(Ze.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}tre("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==t.experimentalAutoDetectLongPolling&&!t.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Jne(null!==(r=t.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new ot(Ze.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ot(Ze.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ot(Ze.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===t.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class HA{constructor(t,e,r,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sre({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ot(Ze.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new ot(Ze.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sre(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new rwe;switch(e.type){case"firstParty":return new awe(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ot(Ze.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=ere.get(t);e&&(Ct("ComponentProvider","Removing Datastore"),ere.delete(t),e.terminate())}(this),Promise.resolve()}}class Ti{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lh(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ti(this.firestore,t,this._key)}}class qo{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new qo(this.firestore,t,this._query)}}class lh extends qo{constructor(t,e,r){super(t,e,eI(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ti(this.firestore,null,new $t(t))}withConverter(t){return new lh(this.firestore,t,this._path)}}function are(n,t,...e){if(n=(0,W.m9)(n),Ij("collection","path",t),n instanceof HA){const r=xr.fromString(t,...e);return rre(r),new lh(n,null,r)}{if(!(n instanceof Ti||n instanceof lh))throw new ot(Ze.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(xr.fromString(t,...e));return rre(r),new lh(n.firestore,null,r)}}function vL(n,t,...e){if(n=(0,W.m9)(n),1===arguments.length&&(t=mee.A()),Ij("doc","path",t),n instanceof HA){const r=xr.fromString(t,...e);return nre(r),new Ti(n,null,new $t(r))}{if(!(n instanceof Ti||n instanceof lh))throw new ot(Ze.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(xr.fromString(t,...e));return nre(r),new Ti(n.firestore,n instanceof lh?n.converter:null,new $t(r))}}function lre(n,t){return n=(0,W.m9)(n),t=(0,W.m9)(t),(n instanceof Ti||n instanceof lh)&&(t instanceof Ti||t instanceof lh)&&n.firestore===t.firestore&&n.path===t.path&&n.converter===t.converter}function Tj(n,t){return n=(0,W.m9)(n),t=(0,W.m9)(t),n instanceof qo&&t instanceof qo&&n.firestore===t.firestore&&vA(n._query,t._query)&&n.converter===t.converter}class sIe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new yW(this,"async_queue_retry"),this.Xc=()=>{const e=dL();e&&Ct("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const t=dL();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Zc(),this.ta(t)}enterRestrictedMode(t){if(!this.jc){this.jc=!0,this.Jc=t||!1;const e=dL();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Xc)}}enqueue(t){if(this.Zc(),this.jc)return new Promise(()=>{});const e=new Hs;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Qc.push(t),this.ea()))}ea(){var t=this;return(0,q.Z)(function*(){if(0!==t.Qc.length){try{yield t.Qc[0](),t.Qc.shift(),t.qo.reset()}catch(e){if(!Ig(e))throw e;Ct("AsyncQueue","Operation failed with retryable error: "+e)}t.Qc.length>0&&t.qo.No(()=>t.ea())}})()}ta(t){const e=this.Gc.then(()=>(this.Hc=!0,t().catch(r=>{throw this.Wc=r,this.Hc=!1,hs("INTERNAL UNHANDLED ERROR: ",function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(r)),r}).then(r=>(this.Hc=!1,r))));return this.Gc=e,e}enqueueAfterDelay(t,e,r){this.Zc(),this.Yc.indexOf(t)>-1&&(e=0);const i=LW.createAndSchedule(this,t,e,r,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&Jt()}verifyOperationInProgress(){}sa(){var t=this;return(0,q.Z)(function*(){let e;do{e=t.Gc,yield e}while(e!==t.Gc)})()}ia(t){for(const e of this.zc)if(e.timerId===t)return!0;return!1}ra(t){return this.sa().then(()=>{this.zc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.zc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.sa()})}oa(t){this.Yc.push(t)}na(t){const e=this.zc.indexOf(t);this.zc.splice(e,1)}}function Sj(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class oIe{constructor(){this._progressObserver={},this._taskCompletionResolver=new Hs,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(t,e,r){this._progressObserver={next:t,error:e,complete:r}}catch(t){return this._taskCompletionResolver.promise.catch(t)}then(t,e){return this._taskCompletionResolver.promise.then(t,e)}_completeWith(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)}_failWith(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)}_updateProgress(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}class Si extends HA{constructor(t,e,r,i){super(t,e,r,i),this.type="firestore",this._queue=new sIe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||cre(this),this._firestoreClient.terminate()}}function ps(n){return n._firestoreClient||cre(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function cre(n){var t,e,r;const i=n._freezeSettings(),s=(l=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new Lwe(n._databaseId,l,n._persistenceKey,(u=i).host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,Jne(u.experimentalLongPollingOptions),u.useFetchStreams));var l,u;n._firestoreClient=new Yxe(n._authCredentials,n._appCheckCredentials,n._queue,s),(null===(e=i.cache)||void 0===e?void 0:e._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function ure(n,t,e){const r=new Hs;return n.asyncQueue.enqueue((0,q.Z)(function*(){try{yield mL(n,e),yield _j(n,t),r.resolve()}catch(i){const s=i;if(!qne(s))throw s;Zc("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function dre(n){if(n._initialized||n._terminated)throw new ot(Ze.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class ch{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ch(Gs.fromBase64String(t))}catch(e){throw new ot(Ze.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new ch(Gs.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class np{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new ot(Ze.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ji(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class _b{constructor(t){this._methodName=t}}class bL{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new ot(Ze.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ot(Ze.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Pn(this._lat,t._lat)||Pn(this._long,t._long)}}const _Ie=/^__.*__$/;class yIe{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new Jf(t,this.data,this.fieldMask,e,this.fieldTransforms):new rI(t,this.data,e,this.fieldTransforms)}}class hre{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new Jf(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function fre(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Jt()}}class wL{constructor(t,e,r,i,s,o){this.settings=t,this.databaseId=e,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(t){return new wL(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.aa({path:r,la:!1});return i.fa(t),i}da(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.aa({path:r,la:!1});return i.ua(),i}wa(t){return this.aa({path:void 0,la:!0})}_a(t){return IL(t,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}ua(){if(this.path)for(let t=0;t<this.path.length;t++)this.fa(this.path.get(t))}fa(t){if(0===t.length)throw this._a("Document fields must not be empty");if(fre(this.ca)&&_Ie.test(t))throw this._a('Document fields cannot begin and end with "__"')}}class vIe{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=r||BA(t)}ya(t,e,r,i=!1){return new wL({ca:t,methodName:e,ga:r,path:Ji.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yb(n){const t=n._freezeSettings(),e=BA(n._databaseId);return new vIe(n._databaseId,!!t.ignoreUndefinedProperties,e)}function CL(n,t,e,r,i,s={}){const o=n.ya(s.merge||s.mergeFields?2:0,t,e,i);Aj("Data must be an object, but it was:",o,r);const l=gre(r,o);let c,u;if(s.merge)c=new Cl(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const _=jA(t,m,e);if(!o.contains(_))throw new ot(Ze.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);yre(f,_)||f.push(_)}c=new Cl(f),u=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=o.fieldTransforms;return new yIe(new jo(l),c,u)}class WA extends _b{_toFieldTransform(t){if(2!==t.ca)throw t._a(1===t.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof WA}}function pre(n,t,e){return new wL({ca:3,ga:t.settings.ga,methodName:n._methodName,la:e},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Ej extends _b{_toFieldTransform(t){return new xA(t.path,new tI)}isEqual(t){return t instanceof Ej}}class bIe extends _b{constructor(t,e){super(t),this.pa=e}_toFieldTransform(t){const e=pre(this,t,!0),r=this.pa.map(s=>vb(s,e)),i=new lb(r);return new xA(t.path,i)}isEqual(t){return this===t}}class wIe extends _b{constructor(t,e){super(t),this.pa=e}_toFieldTransform(t){const e=pre(this,t,!0),r=this.pa.map(s=>vb(s,e)),i=new cb(r);return new xA(t.path,i)}isEqual(t){return this===t}}class CIe extends _b{constructor(t,e){super(t),this.Ia=e}_toFieldTransform(t){const e=new nI(t.serializer,ate(t.serializer,this.Ia));return new xA(t.path,e)}isEqual(t){return this===t}}function Dj(n,t,e,r){const i=n.ya(1,t,e);Aj("Data must be an object, but it was:",i,r);const s=[],o=jo.empty();Tg(r,(c,u)=>{const f=xL(t,c,e);u=(0,W.m9)(u);const m=i.da(f);if(u instanceof WA)s.push(f);else{const _=vb(u,m);null!=_&&(s.push(f),o.set(f,_))}});const l=new Cl(s);return new hre(o,l,i.fieldTransforms)}function kj(n,t,e,r,i,s){const o=n.ya(1,t,e),l=[jA(t,r,e)],c=[i];if(s.length%2!=0)throw new ot(Ze.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)l.push(jA(t,s[_])),c.push(s[_+1]);const u=[],f=jo.empty();for(let _=l.length-1;_>=0;--_)if(!yre(u,l[_])){const y=l[_];let w=c[_];w=(0,W.m9)(w);const T=o.da(y);if(w instanceof WA)u.push(y);else{const I=vb(w,T);null!=I&&(u.push(y),f.set(y,I))}}const m=new Cl(u);return new hre(f,m,o.fieldTransforms)}function mre(n,t,e,r=!1){return vb(e,n.ya(r?4:3,t))}function vb(n,t){if(_re(n=(0,W.m9)(n)))return Aj("Unsupported field value:",t,n),gre(n,t);if(n instanceof _b)return function(e,r){if(!fre(r.ca))throw r._a(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${e._methodName}() is not currently supported inside arrays`);const i=e._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,r){const i=[];let s=0;for(const o of e){let l=vb(o,r.wa(s));null==l&&(l={nullValue:"NULL_VALUE"}),i.push(l),s++}return{arrayValue:{values:i}}}(n,t)}return function(e,r){if(null===(e=(0,W.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ate(r.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const i=Gr.fromDate(e);return{timestampValue:sI(r.serializer,i)}}if(e instanceof Gr){const i=new Gr(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:sI(r.serializer,i)}}if(e instanceof bL)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof ch)return{bytesValue:Dte(r.serializer,e._byteString)};if(e instanceof Ti){const i=r.databaseId,s=e.firestore._databaseId;if(!s.isEqual(i))throw r._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:j6(e.firestore._databaseId||r.databaseId,e._key.path)}}throw r._a(`Unsupported field value: ${yL(e)}`)}(n,t)}function gre(n,t){const e={};return Aee(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Tg(n,(r,i)=>{const s=vb(i,t.ha(r));null!=s&&(e[r]=s)}),{mapValue:{fields:e}}}function _re(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Gr||n instanceof bL||n instanceof ch||n instanceof Ti||n instanceof _b)}function Aj(n,t,e){if(!_re(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=yL(e);throw t._a("an object"===r?n+" a custom object":n+" "+r)}var r}function jA(n,t,e){if((t=(0,W.m9)(t))instanceof np)return t._internalPath;if("string"==typeof t)return xL(n,t);throw IL("Field path arguments must be of type string or ",n,!1,void 0,e)}const xIe=new RegExp("[~\\*/\\[\\]]");function xL(n,t,e){if(t.search(xIe)>=0)throw IL(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new np(...t.split("."))._internalPath}catch{throw IL(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function IL(n,t,e,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let l=`Function ${t}() called with invalid data`;e&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new ot(Ze.INVALID_ARGUMENT,l+n+c)}function yre(n,t){return n.some(e=>e.isEqual(t))}class qA{constructor(t,e,r,i,s){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ti(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new IIe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(TL("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class IIe extends qA{data(){return super.data()}}function TL(n,t){return"string"==typeof t?xL(n,t):t instanceof np?t._internalPath:t._delegate._internalPath}function vre(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new ot(Ze.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Nj{}class ZA extends Nj{}function $g(n,t,...e){let r=[];t instanceof Nj&&r.push(t),r=r.concat(e),function(i){const s=i.filter(l=>l instanceof bI).length,o=i.filter(l=>l instanceof YA).length;if(s>1||s>0&&o>0)throw new ot(Ze.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class YA extends ZA{constructor(t,e,r){super(),this._field=t,this._op=e,this._value=r,this.type="where"}static _create(t,e,r){return new YA(t,e,r)}_apply(t){const e=this._parse(t);return xre(t._query,e),new qo(t.firestore,t.converter,P6(t._query,e))}_parse(t){const e=yb(t.firestore);return function(i,s,o,l,c,u,f){let m;if(c.isKeyField()){if("array-contains"===u||"array-contains-any"===u)throw new ot(Ze.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if("in"===u||"not-in"===u){Cre(f,u);const _=[];for(const y of f)_.push(wre(l,i,y));m={arrayValue:{values:_}}}else m=wre(l,i,f)}else"in"!==u&&"not-in"!==u&&"array-contains-any"!==u||Cre(f,u),m=mre(o,"where",f,"in"===u||"not-in"===u);return pr.create(c,u,m)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value)}}class bI extends Nj{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new bI(t,e)}_parse(t){const e=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return 1===e.length?e[0]:Wr.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(r,i){let s=r;const o=i.getFlattenedFilters();for(const l of o)xre(s,l),s=P6(s,l)}(t._query,e),new qo(t.firestore,t.converter,P6(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Rj extends ZA{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new Rj(t,e)}_apply(t){const e=function(r,i,s){if(null!==r.startAt)throw new ot(Ze.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new ot(Ze.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Xx(i,s);return function(l,c){if(null===O6(l)){const u=H2(l);null!==u&&Ire(0,u,c.field)}}(r,o),o}(t._query,this._field,this._direction);return new qo(t.firestore,t.converter,function(r,i){const s=r.explicitOrderBy.concat([i]);return new Qf(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}class SL extends ZA{constructor(t,e,r){super(),this.type=t,this._limit=e,this._limitType=r}static _create(t,e,r){return new SL(t,e,r)}_apply(t){return new qo(t.firestore,t.converter,G2(t._query,this._limit,this._limitType))}}class EL extends ZA{constructor(t,e,r){super(),this.type=t,this._docOrFields=e,this._inclusive=r}static _create(t,e,r){return new EL(t,e,r)}_apply(t){const e=bre(t,this.type,this._docOrFields,this._inclusive);return new qo(t.firestore,t.converter,(i=e,new Qf((r=t._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class DL extends ZA{constructor(t,e,r){super(),this.type=t,this._docOrFields=e,this._inclusive=r}static _create(t,e,r){return new DL(t,e,r)}_apply(t){const e=bre(t,this.type,this._docOrFields,this._inclusive);return new qo(t.firestore,t.converter,(i=e,new Qf((r=t._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function bre(n,t,e,r){if(e[0]=(0,W.m9)(e[0]),e[0]instanceof qA)return function(i,s,o,l,c){if(!l)throw new ot(Ze.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const f of ab(i))if(f.field.isKeyField())u.push(sb(s,l.key));else{const m=l.data.field(f.field);if(P2(m))throw new ot(Ze.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const _=f.field.canonicalString();throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}u.push(m)}return new Ng(u,c)}(n._query,n.firestore._databaseId,t,e[0]._document,r);{const i=yb(n.firestore);return function(s,o,l,c,u,f){const m=s.explicitOrderBy;if(u.length>m.length)throw new ot(Ze.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let y=0;y<u.length;y++){const w=u[y];if(m[y].field.isKeyField()){if("string"!=typeof w)throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof w}`);if(!F6(s)&&-1!==w.indexOf("/"))throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${w}' contains a slash.`);const T=s.path.child(xr.fromString(w));if(!$t.isDocumentKey(T))throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const I=new $t(T);_.push(sb(o,I))}else{const T=mre(l,c,w);_.push(T)}}return new Ng(_,f)}(n._query,n.firestore._databaseId,i,t,e,r)}}function wre(n,t,e){if("string"==typeof(e=(0,W.m9)(e))){if(""===e)throw new ot(Ze.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!F6(t)&&-1!==e.indexOf("/"))throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(xr.fromString(e));if(!$t.isDocumentKey(r))throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return sb(n,new $t(r))}if(e instanceof Ti)return sb(n,e._key);throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yL(e)}.`)}function Cre(n,t){if(!Array.isArray(n)||0===n.length)throw new ot(Ze.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function xre(n,t){if(t.isInequality()){const r=H2(n),i=t.field;if(null!==r&&!r.isEqual(i))throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=O6(n);null!==s&&Ire(0,i,s)}const e=function(r,i){for(const s of r)for(const o of s.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==e)throw new ot(Ze.INVALID_ARGUMENT,e===t.op?`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`:`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}function Ire(n,t,e){if(!e.isEqual(t))throw new ot(Ze.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}class Mj{convertValue(t,e="none"){switch(kg(t)){case 0:return null;case 1:return t.booleanValue;case 2:return es(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Kf(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Jt()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const r={};return Tg(t,(i,s)=>{r[i]=this.convertValue(s,e)}),r}convertGeoPoint(t){return new bL(es(t.latitude),es(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=L2(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(pA(t));default:return null}}convertTimestamp(t){const e=Sg(t);return new Gr(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=xr.fromString(t);dn($te(r));const i=new Eg(r.get(1),r.get(3)),s=new $t(r.popFirst(5));return i.isEqual(e)||hs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}function kL(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class MIe extends Mj{constructor(t){super(),this.firestore=t}convertBytes(t){return new ch(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ti(this.firestore,null,e)}}class bb{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class rp extends qA{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new KA(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(TL("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class KA extends rp{data(t={}){return super.data(t)}}class Bg{constructor(t,e,r,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new bb(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new KA(this._firestore,this._userDataWriter,r.key,r,new bb(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ot(Ze.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new KA(r._firestore,r._userDataWriter,o.doc.key,o.doc,new bb(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}))}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>i||3!==o.type).map(o=>{const l=new KA(r._firestore,r._userDataWriter,o.doc.key,o.doc,new bb(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,u=-1;return 0!==o.type&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:FIe(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function FIe(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Jt()}}function Sre(n,t){return n instanceof rp&&t instanceof rp?n._firestore===t._firestore&&n._key.isEqual(t._key)&&(null===n._document?null===t._document:n._document.isEqual(t._document))&&n._converter===t._converter:n instanceof Bg&&t instanceof Bg&&n._firestore===t._firestore&&Tj(n.query,t.query)&&n.metadata.isEqual(t.metadata)&&n._snapshot.isEqual(t._snapshot)}class Vg extends Mj{constructor(t){super(),this.firestore=t}convertBytes(t){return new ch(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ti(this.firestore,null,e)}}function Ere(n,t,e){n=mr(n,Ti);const r=mr(n.firestore,Si),i=kL(n.converter,t,e);return wI(r,[CL(yb(r),"setDoc",n._key,i,null!==n.converter,e).toMutation(n._key,Mi.none())])}function Dre(n,t,e,...r){n=mr(n,Ti);const i=mr(n.firestore,Si),s=yb(i);let o;return o="string"==typeof(t=(0,W.m9)(t))||t instanceof np?kj(s,"updateDoc",n._key,t,e,r):Dj(s,"updateDoc",n._key,t),wI(i,[o.toMutation(n._key,Mi.exists(!0))])}function kre(n,...t){var e,r,i;n=(0,W.m9)(n);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Sj(t[o])||(s=t[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges};if(Sj(t[o])){const m=t[o];t[o]=null===(e=m.next)||void 0===e?void 0:e.bind(m),t[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),t[o+2]=null===(i=m.complete)||void 0===i?void 0:i.bind(m)}let c,u,f;if(n instanceof Ti)u=mr(n.firestore,Si),f=eI(n._key.path),c={next:m=>{t[o]&&t[o](Oj(u,n,m))},error:t[o+1],complete:t[o+2]};else{const m=mr(n,qo);u=mr(m.firestore,Si),f=m._query;const _=new Vg(u);c={next:y=>{t[o]&&t[o](new Bg(u,_,m,y))},error:t[o+1],complete:t[o+2]},vre(n._query)}return function(m,_,y,w){const T=new pL(w),I=new HW(_,T,y);return m.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return $W(yield vI(m),I)})),()=>{T.Dc(),m.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return VW(yield vI(m),I)}))}}(ps(u),f,l,c)}function wI(n,t){return function(e,r){const i=new Hs;return e.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return function kxe(n,t,e){return ZW.apply(this,arguments)}(yield Cj(e),r,i)})),i.promise}(ps(n),t)}function Oj(n,t,e){const r=e.docs.get(t._key),i=new Vg(n);return new rp(n,i,t._key,r,new bb(e.hasPendingWrites,e.fromCache),t.converter)}const JIe={maxAttempts:5};class Are{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=yb(t)}set(t,e,r){this._verifyNotCommitted();const i=Ug(t,this._firestore),s=kL(i.converter,e,r),o=CL(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,Mi.none())),this}update(t,e,r,...i){this._verifyNotCommitted();const s=Ug(t,this._firestore);let o;return o="string"==typeof(e=(0,W.m9)(e))||e instanceof np?kj(this._dataReader,"WriteBatch.update",s._key,e,r,i):Dj(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Mi.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=Ug(t,this._firestore);return this._mutations=this._mutations.concat(new iI(e._key,Mi.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ot(Ze.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ug(n,t){if((n=(0,W.m9)(n)).firestore!==t)throw new ot(Ze.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class eTe extends class{constructor(t,e){this._firestore=t,this._transaction=e,this._dataReader=yb(t)}get(t){const e=Ug(t,this._firestore),r=new MIe(this._firestore);return this._transaction.lookup([e._key]).then(i=>{if(!i||1!==i.length)return Jt();const s=i[0];if(s.isFoundDocument())return new qA(this._firestore,r,s.key,s,e.converter);if(s.isNoDocument())return new qA(this._firestore,r,e._key,null,e.converter);throw Jt()})}set(t,e,r){const i=Ug(t,this._firestore),s=kL(i.converter,e,r),o=CL(this._dataReader,"Transaction.set",i._key,s,null!==i.converter,r);return this._transaction.set(i._key,o),this}update(t,e,r,...i){const s=Ug(t,this._firestore);let o;return o="string"==typeof(e=(0,W.m9)(e))||e instanceof np?kj(this._dataReader,"Transaction.update",s._key,e,r,i):Dj(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this}delete(t){const e=Ug(t,this._firestore);return this._transaction.delete(e._key),this}}{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=Ug(t,this._firestore),r=new Vg(this._firestore);return super.get(t).then(i=>new rp(this._firestore,r,e._key,i._document,new bb(!1,!1),e.converter))}}function Fj(n,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new ot("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return t}function Rre(){if(typeof Uint8Array>"u")throw new ot("unimplemented","Uint8Arrays are not available in this environment.")}function Mre(){if(!function Fwe(){return typeof atob<"u"}())throw new ot("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,t=!0){Zx=An.SDK_VERSION,(0,An._registerComponent)(new us.wA("firestore",(e,{instanceIdentifier:r,options:i})=>{const s=e.getProvider("app").getImmediate(),o=new Si(new swe(e.getProvider("auth-internal")),new lwe(e.getProvider("app-check-internal")),function(l,c){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new ot(Ze.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eg(l.options.projectId,c)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),(0,An.registerVersion)(hee,"3.13.0",n),(0,An.registerVersion)(hee,"3.13.0","esm2017")}();class QA{constructor(t){this._delegate=t}static fromBase64String(t){return Mre(),new QA(ch.fromBase64String(t))}static fromUint8Array(t){return Rre(),new QA(ch.fromUint8Array(t))}toBase64(){return Mre(),this._delegate.toBase64()}toUint8Array(){return Rre(),this._delegate.toUint8Array()}isEqual(t){return this._delegate.isEqual(t._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Pj(n){return function cTe(n,t){if("object"!=typeof n||null===n)return!1;const e=n;for(const r of t)if(r in e&&"function"==typeof e[r])return!0;return!1}(n,["next","error","complete"])}class uTe{enableIndexedDbPersistence(t,e){return function lIe(n,t){dre(n=mr(n,Si));const e=ps(n);if(e._uninitializedComponentsProvider)throw new ot(Ze.FAILED_PRECONDITION,"SDK cache is already specified.");Zc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new yI;return ure(e,i,new mj(i,r.cacheSizeBytes,t?.forceOwnership))}(t._delegate,{forceOwnership:e})}enableMultiTabIndexedDbPersistence(t){return function cIe(n){dre(n=mr(n,Si));const t=ps(n);if(t._uninitializedComponentsProvider)throw new ot(Ze.FAILED_PRECONDITION,"SDK cache is already specified.");Zc("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings(),r=new yI;return ure(t,r,new Wne(r,e.cacheSizeBytes))}(t._delegate)}clearIndexedDbPersistence(t){return function uIe(n){if(n._initialized&&!n._terminated)throw new ot(Ze.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new Hs;return n._queue.enqueueAndForgetEvenWhileRestricted((0,q.Z)(function*(){try{yield(e=(0,q.Z)(function*(r){if(!Xu.D())return Promise.resolve();const i=r+"main";yield Xu.delete(i)}),function(r){return e.apply(this,arguments)})(aW(n._databaseId,n._persistenceKey)),t.resolve()}catch(e){t.reject(e)}var e})),t.promise}(t._delegate)}}class Ore{constructor(t,e,r){this._delegate=e,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},t instanceof Eg||(this._appCompat=t)}get _databaseId(){return this._delegate._databaseId}settings(t){const e=this._delegate._getSettings();!t.merge&&e.host!==t.host&&Zc("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)}useEmulator(t,e,r={}){!function ore(n,t,e,r={}){var i;const s=(n=mr(n,HA))._getSettings(),o=`${t}:${e}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Zc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,c;if("string"==typeof r.mockUserToken)l=r.mockUserToken,c=mo.MOCK_USER;else{l=(0,W.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new ot(Ze.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new mo(u)}n._authCredentials=new iwe(new fee(l,c))}}(this._delegate,t,e,r)}enableNetwork(){return function hIe(n){return function Kxe(n){return n.asyncQueue.enqueue((0,q.Z)(function*(){const t=yield Zne(n),e=yield Yne(n);return t.setNetworkEnabled(!0),function(r){const i=Vt(r);return i.vu.delete(0),VA(i)}(e)}))}(ps(n=mr(n,Si)))}(this._delegate)}disableNetwork(){return function fIe(n){return function Qxe(n){return n.asyncQueue.enqueue((0,q.Z)(function*(){const t=yield Zne(n),e=yield Yne(n);return t.setNetworkEnabled(!1),(r=(0,q.Z)(function*(i){const s=Vt(i);s.vu.add(0),yield dI(s),s.bu.set("Offline")}),function(i){return r.apply(this,arguments)})(e);var r}))}(ps(n=mr(n,Si)))}(this._delegate)}enablePersistence(t){let e=!1,r=!1;return t&&(e=!!t.synchronizeTabs,r=!!t.experimentalForceOwningTab,tre("synchronizeTabs",e,"experimentalForceOwningTab",r)),e?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function dIe(n){return function(t){const e=new Hs;return t.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return function Mxe(n,t){return JW.apply(this,arguments)}(yield Cj(t),e)})),e.promise}(ps(n=mr(n,Si)))}(this._delegate)}onSnapshotsInSync(t){return function GIe(n,t){return function eIe(n,t){const e=new pL(t);return n.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return r=yield vI(n),i=e,Vt(r).ku.add(i),void i.next();var r,i})),()=>{e.Dc(),n.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return r=yield vI(n),i=e,void Vt(r).ku.delete(i);var r,i}))}}(ps(n=mr(n,Si)),Sj(t)?t:{next:t})}(this._delegate,t)}get app(){if(!this._appCompat)throw new ot("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(t){try{return new CI(this,are(this._delegate,t))}catch(e){throw qa(e,"collection()","Firestore.collection()")}}doc(t){try{return new Yc(this,vL(this._delegate,t))}catch(e){throw qa(e,"doc()","Firestore.doc()")}}collectionGroup(t){try{return new Za(this,function iIe(n,t){if(n=mr(n,HA),Ij("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new ot(Ze.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new qo(n,null,(e=t,new Qf(xr.emptyPath(),e)));var e}(this._delegate,t))}catch(e){throw qa(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return function tTe(n,t,e){n=mr(n,Si);const r=Object.assign(Object.assign({},JIe),e);return function(i){if(i.maxAttempts<1)throw new ot(Ze.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,s,o){const l=new Hs;return i.asyncQueue.enqueueAndForget((0,q.Z)(function*(){const c=yield function Kne(n){return gL(n).then(t=>t.datastore)}(i);new Zxe(i.asyncQueue,c,o,s,l).run()})),l.promise}(ps(n),i=>t(new eTe(n,i)),r)}(this._delegate,e=>t(new Fre(this,e)))}batch(){return ps(this._delegate),new Pre(new Are(this._delegate,t=>wI(this._delegate,t)))}loadBundle(t){return function pIe(n,t){const e=ps(n=mr(n,Si)),r=new oIe;return function tIe(n,t,e,r){const i=function(s,o){let l;return l="string"==typeof s?bte().encode(s):s,c=function(c,u){if(c instanceof Uint8Array)return jne(c,u);if(c instanceof ArrayBuffer)return jne(new Uint8Array(c),u);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),new jxe(c,o);var c}(e,BA(t));n.asyncQueue.enqueueAndForget((0,q.Z)(function*(){!function Gxe(n,t,e){const r=Vt(n);var i;(i=(0,q.Z)(function*(s,o,l){try{const c=yield o.getMetadata();if(yield function(_,y){const w=Vt(_),T=fs(y.createTime);return w.persistence.runTransaction("hasNewerBundle","readonly",I=>w.qs.getBundleMetadata(I,y.id)).then(I=>!!I&&I.createTime.compareTo(T)>=0)}(s.localStore,c))return yield o.close(),l._completeWith({taskState:"Success",documentsLoaded:(_=c).totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}),Promise.resolve(new Set);l._updateProgress(Pne(c));const u=new xxe(c,s.localStore,o.serializer);let f=yield o.bc();for(;f;){const _=yield u.zu(f);_&&l._updateProgress(_),f=yield o.bc()}const m=yield u.complete();return yield tp(s,m.Ju,void 0),yield function(_,y){const w=Vt(_);return w.persistence.runTransaction("Save bundle","readwrite",T=>w.qs.saveBundleMetadata(T,y))}(s.localStore,c),l._completeWith(m.progress),Promise.resolve(m.Hu)}catch(c){return Zc("SyncEngine",`Loading bundle failed with ${c}`),l._failWith(c),Promise.resolve(new Set)}var _}),function(s,o,l){return i.apply(this,arguments)})(r,t,e).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield Cj(n),i,r)}))}(e,n._databaseId,t,r),r}(this._delegate,t)}namedQuery(t){return function mIe(n,t){return function nIe(n,t){return n.asyncQueue.enqueue((0,q.Z)(function*(){return function(e,r){const i=Vt(e);return i.persistence.runTransaction("Get named query","readonly",s=>i.qs.getNamedQuery(s,r))}(yield _L(n),t)}))}(ps(n=mr(n,Si)),t).then(e=>e?new qo(n,null,e.query):null)}(this._delegate,t).then(e=>e?new Za(this,e):null)}}class AL extends Mj{constructor(t){super(),this.firestore=t}convertBytes(t){return new QA(new ch(t))}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return Yc.forKey(e,this.firestore,null)}}class Fre{constructor(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new AL(t)}get(t){const e=Cb(t);return this._delegate.get(e).then(r=>new XA(this._firestore,new rp(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,e.converter)))}set(t,e,r){const i=Cb(t);return r?(Fj("Transaction.set",r),this._delegate.set(i,e,r)):this._delegate.set(i,e),this}update(t,e,r,...i){const s=Cb(t);return 2===arguments.length?this._delegate.update(s,e):this._delegate.update(s,e,r,...i),this}delete(t){const e=Cb(t);return this._delegate.delete(e),this}}class Pre{constructor(t){this._delegate=t}set(t,e,r){const i=Cb(t);return r?(Fj("WriteBatch.set",r),this._delegate.set(i,e,r)):this._delegate.set(i,e),this}update(t,e,r,...i){const s=Cb(t);return 2===arguments.length?this._delegate.update(s,e):this._delegate.update(s,e,r,...i),this}delete(t){const e=Cb(t);return this._delegate.delete(e),this}commit(){return this._delegate.commit()}}class wb{constructor(t,e,r){this._firestore=t,this._userDataWriter=e,this._delegate=r}fromFirestore(t,e){const r=new KA(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new JA(this._firestore,r),e??{})}toFirestore(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)}static getInstance(t,e){const r=wb.INSTANCES;let i=r.get(t);i||(i=new WeakMap,r.set(t,i));let s=i.get(e);return s||(s=new wb(t,new AL(t),e),i.set(e,s)),s}}wb.INSTANCES=new WeakMap;class Yc{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new AL(t)}static forPath(t,e,r){if(t.length%2!=0)throw new ot("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${t.canonicalString()} has ${t.length}`);return new Yc(e,new Ti(e._delegate,r,new $t(t)))}static forKey(t,e,r){return new Yc(e,new Ti(e._delegate,r,t))}get id(){return this._delegate.id}get parent(){return new CI(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(t){try{return new CI(this.firestore,are(this._delegate,t))}catch(e){throw qa(e,"collection()","DocumentReference.collection()")}}isEqual(t){return(t=(0,W.m9)(t))instanceof Ti&&lre(this._delegate,t)}set(t,e){e=Fj("DocumentReference.set",e);try{return e?Ere(this._delegate,t,e):Ere(this._delegate,t)}catch(r){throw qa(r,"setDoc()","DocumentReference.set()")}}update(t,e,...r){try{return 1===arguments.length?Dre(this._delegate,t):Dre(this._delegate,t,e,...r)}catch(i){throw qa(i,"updateDoc()","DocumentReference.update()")}}delete(){return function zIe(n){return wI(mr(n.firestore,Si),[new iI(n._key,Mi.none())])}(this._delegate)}onSnapshot(...t){const e=Lre(t),r=$re(t,i=>new XA(this.firestore,new rp(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return kre(this._delegate,e,r)}get(t){let e;return e="cache"===t?.source?function LIe(n){n=mr(n,Ti);const t=mr(n.firestore,Si),e=ps(t),r=new Vg(t);return function Xxe(n,t){const e=new Hs;return n.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return(r=(0,q.Z)(function*(i,s,o){try{const l=yield function(c,u){const f=Vt(c);return f.persistence.runTransaction("read document","readonly",m=>f.localDocuments.getDocument(m,u))}(i,s);l.isFoundDocument()?o.resolve(l):l.isNoDocument()?o.resolve(null):o.reject(new ot(Ze.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const c=pI(l,`Failed to get document '${s} from cache`);o.reject(c)}}),function(i,s,o){return r.apply(this,arguments)})(yield _L(n),t,e);var r})),e.promise}(e,n._key).then(i=>new rp(t,r,n._key,i,new bb(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===t?.source?function $Ie(n){n=mr(n,Ti);const t=mr(n.firestore,Si);return Qne(ps(t),n._key,{source:"server"}).then(e=>Oj(t,n,e))}(this._delegate):function PIe(n){n=mr(n,Ti);const t=mr(n.firestore,Si);return Qne(ps(t),n._key).then(e=>Oj(t,n,e))}(this._delegate),e.then(r=>new XA(this.firestore,new rp(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(t){return new Yc(this.firestore,this._delegate.withConverter(t?wb.getInstance(this.firestore,t):null))}}function qa(n,t,e){return n.message=n.message.replace(t,e),n}function Lre(n){for(const t of n)if("object"==typeof t&&!Pj(t))return t;return{}}function $re(n,t){var e,r;let i;return i=Pj(n[0])?n[0]:Pj(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(t(s))},error:null===(e=i.error)||void 0===e?void 0:e.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class XA{constructor(t,e){this._firestore=t,this._delegate=e}get ref(){return new Yc(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(t){return this._delegate.data(t)}get(t,e){return this._delegate.get(t,e)}isEqual(t){return Sre(this._delegate,t._delegate)}}class JA extends XA{data(t){const e=this._delegate.data(t);return function nwe(n,t){n||Jt()}(void 0!==e),e}}class Za{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new AL(t)}where(t,e,r){try{return new Za(this.firestore,$g(this._delegate,function TIe(n,t,e){const r=t,i=TL("where",n);return YA._create(i,r,e)}(t,e,r)))}catch(i){throw qa(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(t,e){try{return new Za(this.firestore,$g(this._delegate,function SIe(n,t="asc"){const e=t,r=TL("orderBy",n);return Rj._create(r,e)}(t,e)))}catch(r){throw qa(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(t){try{return new Za(this.firestore,$g(this._delegate,function EIe(n){return ire("limit",n),SL._create("limit",n,"F")}(t)))}catch(e){throw qa(e,"limit()","Query.limit()")}}limitToLast(t){try{return new Za(this.firestore,$g(this._delegate,function DIe(n){return ire("limitToLast",n),SL._create("limitToLast",n,"L")}(t)))}catch(e){throw qa(e,"limitToLast()","Query.limitToLast()")}}startAt(...t){try{return new Za(this.firestore,$g(this._delegate,function kIe(...n){return EL._create("startAt",n,!0)}(...t)))}catch(e){throw qa(e,"startAt()","Query.startAt()")}}startAfter(...t){try{return new Za(this.firestore,$g(this._delegate,function AIe(...n){return EL._create("startAfter",n,!1)}(...t)))}catch(e){throw qa(e,"startAfter()","Query.startAfter()")}}endBefore(...t){try{return new Za(this.firestore,$g(this._delegate,function NIe(...n){return DL._create("endBefore",n,!1)}(...t)))}catch(e){throw qa(e,"endBefore()","Query.endBefore()")}}endAt(...t){try{return new Za(this.firestore,$g(this._delegate,function RIe(...n){return DL._create("endAt",n,!0)}(...t)))}catch(e){throw qa(e,"endAt()","Query.endAt()")}}isEqual(t){return Tj(this._delegate,t._delegate)}get(t){let e;return e="cache"===t?.source?function VIe(n){n=mr(n,qo);const t=mr(n.firestore,Si),e=ps(t),r=new Vg(t);return function Jxe(n,t){const e=new Hs;return n.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return(r=(0,q.Z)(function*(i,s,o){try{const l=yield aL(i,s,!0),c=new Bne(s,l.ir),u=c.sc(l.documents),f=c.applyChanges(u,!1);o.resolve(f.snapshot)}catch(l){const c=pI(l,`Failed to execute query '${s} against cache`);o.reject(c)}}),function(i,s,o){return r.apply(this,arguments)})(yield _L(n),t,e);var r})),e.promise}(e,n._query).then(i=>new Bg(t,r,n,i))}(this._delegate):"server"===t?.source?function UIe(n){n=mr(n,qo);const t=mr(n.firestore,Si),e=ps(t),r=new Vg(t);return Xne(e,n._query,{source:"server"}).then(i=>new Bg(t,r,n,i))}(this._delegate):function BIe(n){n=mr(n,qo);const t=mr(n.firestore,Si),e=ps(t),r=new Vg(t);return vre(n._query),Xne(e,n._query).then(i=>new Bg(t,r,n,i))}(this._delegate),e.then(r=>new Lj(this.firestore,new Bg(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...t){const e=Lre(t),r=$re(t,i=>new Lj(this.firestore,new Bg(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return kre(this._delegate,e,r)}withConverter(t){return new Za(this.firestore,this._delegate.withConverter(t?wb.getInstance(this.firestore,t):null))}}class hTe{constructor(t,e){this._firestore=t,this._delegate=e}get type(){return this._delegate.type}get doc(){return new JA(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Lj{constructor(t,e){this._firestore=t,this._delegate=e}get query(){return new Za(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(t=>new JA(this._firestore,t))}docChanges(t){return this._delegate.docChanges(t).map(e=>new hTe(this._firestore,e))}forEach(t,e){this._delegate.forEach(r=>{t.call(e,new JA(this._firestore,r))})}isEqual(t){return Sre(this._delegate,t._delegate)}}class CI extends Za{constructor(t,e){super(t,e),this.firestore=t,this._delegate=e}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const t=this._delegate.parent;return t?new Yc(this.firestore,t):null}doc(t){try{return new Yc(this.firestore,void 0===t?vL(this._delegate):vL(this._delegate,t))}catch(e){throw qa(e,"doc()","CollectionReference.doc()")}}add(t){return function HIe(n,t){const e=mr(n.firestore,Si),r=vL(n),i=kL(n.converter,t);return wI(e,[CL(yb(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Mi.exists(!1))]).then(()=>r)}(this._delegate,t).then(e=>new Yc(this.firestore,e))}isEqual(t){return lre(this._delegate,t._delegate)}withConverter(t){return new CI(this.firestore,this._delegate.withConverter(t?wb.getInstance(this.firestore,t):null))}}function Cb(n){return mr(n,Ti)}class $j{constructor(...t){this._delegate=new np(...t)}static documentId(){return new $j(Ji.keyField().canonicalString())}isEqual(t){return(t=(0,W.m9)(t))instanceof np&&this._delegate._internalPath.isEqual(t._internalPath)}}class xb{constructor(t){this._delegate=t}static serverTimestamp(){const t=function rTe(){return new Ej("serverTimestamp")}();return t._methodName="FieldValue.serverTimestamp",new xb(t)}static delete(){const t=function nTe(){return new WA("deleteField")}();return t._methodName="FieldValue.delete",new xb(t)}static arrayUnion(...t){const e=function iTe(...n){return new bIe("arrayUnion",n)}(...t);return e._methodName="FieldValue.arrayUnion",new xb(e)}static arrayRemove(...t){const e=function sTe(...n){return new wIe("arrayRemove",n)}(...t);return e._methodName="FieldValue.arrayRemove",new xb(e)}static increment(t){const e=function oTe(n){return new CIe("increment",n)}(t);return e._methodName="FieldValue.increment",new xb(e)}isEqual(t){return this._delegate.isEqual(t._delegate)}}const fTe={Firestore:Ore,GeoPoint:bL,Timestamp:Gr,Blob:QA,Transaction:Fre,WriteBatch:Pre,DocumentReference:Yc,DocumentSnapshot:XA,Query:Za,QueryDocumentSnapshot:JA,QuerySnapshot:Lj,CollectionReference:CI,FieldPath:$j,FieldValue:xb,setLogLevel:function dTe(n){!function twe(n){Cg.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function Bre(n,t){return function gTe(n,t=Fc){return new Cr.y(e=>{let r;return null!=t?t.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},e)}):r=n.onSnapshot({includeMetadataChanges:!0},e),()=>{r?.()}})}(n,t)}function Bj(n,t){return Bre(n,t).pipe((0,Ot.U)(e=>({payload:e,type:"query"})))}function NL(n,t){return Bj(n,t).pipe(Ui(void 0),RG(),(0,Ot.U)(([e,r])=>{const i=r.payload.docChanges(),s=i.map(o=>({type:o.type,payload:o}));return e&&JSON.stringify(e.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((o,l)=>{const c=i.find(f=>f.doc.ref.isEqual(o.ref)),u=e?.payload.docs.find(f=>f.ref.isEqual(o.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(o.metadata)||!c&&u&&JSON.stringify(u.metadata)===JSON.stringify(o.metadata)||s.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:o}})}),s}))}function Vre(n,t,e){return NL(n,e).pipe(Ff((r,i)=>function yTe(n,t,e){return t.forEach(r=>{e.indexOf(r.type)>-1&&(n=function vTe(n,t){switch(t.type){case"added":if(!n[t.newIndex]||!n[t.newIndex].doc.ref.isEqual(t.doc.ref))return Vj(n,t.newIndex,0,t);break;case"modified":if(null==n[t.oldIndex]||n[t.oldIndex].doc.ref.isEqual(t.doc.ref)){if(t.oldIndex!==t.newIndex){const e=n.slice();return e.splice(t.oldIndex,1),e.splice(t.newIndex,0,t),e}return Vj(n,t.newIndex,1,t)}break;case"removed":if(n[t.oldIndex]&&n[t.oldIndex].doc.ref.isEqual(t.doc.ref))return Vj(n,t.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),t),[]),$u(),(0,Ot.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function Vj(n,t,e,...r){const i=n.slice();return i.splice(t,e,...r),i}function Ure(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function mTe(n){(function pTe(n,t){n.INTERNAL.registerComponent(new us.wA("firestore-compat",e=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("firestore").getImmediate();return t(r,i)},"PUBLIC").setServiceProps(Object.assign({},fTe)))})(n,(t,e)=>new Ore(t,e,new uTe)),n.registerVersion("@firebase/firestore-compat","0.3.12")}(ZD.Z);class zre{constructor(t,e,r){this.ref=t,this.query=e,this.afs=r}stateChanges(t){let e=NL(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe((0,Ot.U)(r=>r.filter(i=>t.indexOf(i.type)>-1)))),e.pipe(Ui(void 0),RG(),cr(([r,i])=>i.length>0||!r),(0,Ot.U)(([r,i])=>i),wi)}auditTrail(t){return this.stateChanges(t).pipe(Ff((e,r)=>[...e,...r],[]))}snapshotChanges(t){const e=Ure(t);return Vre(this.query,e,this.afs.schedulers.outsideAngular).pipe(wi)}valueChanges(t={}){return Bj(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ot.U)(e=>e.payload.docs.map(r=>t.idField?Object.assign(Object.assign({},r.data()),{[t.idField]:r.id}):r.data())),wi)}get(t){return(0,Dn.D)(this.query.get(t)).pipe(wi)}add(t){return this.ref.add(t)}doc(t){return new Hre(this.ref.doc(t),this.afs)}}class Hre{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const r=this.ref.collection(t),{ref:i,query:s}=jre(r,e);return new zre(i,s,this.afs)}snapshotChanges(){return function _Te(n,t){return Bre(n,t).pipe(Ui(void 0),RG(),(0,Ot.U)(([e,r])=>r.exists?e?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(wi)}valueChanges(t={}){return this.snapshotChanges().pipe((0,Ot.U)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return(0,Dn.D)(this.ref.get(t)).pipe(wi)}}class bTe{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?NL(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ot.U)(e=>e.filter(r=>t.indexOf(r.type)>-1)),cr(e=>e.length>0),wi):NL(this.query,this.afs.schedulers.outsideAngular).pipe(wi)}auditTrail(t){return this.stateChanges(t).pipe(Ff((e,r)=>[...e,...r],[]))}snapshotChanges(t){const e=Ure(t);return Vre(this.query,e,this.afs.schedulers.outsideAngular).pipe(wi)}valueChanges(t={}){return Bj(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ot.U)(r=>r.payload.docs.map(i=>t.idField?Object.assign({[t.idField]:i.id},i.data()):i.data())),wi)}get(t){return(0,Dn.D)(this.query.get(t)).pipe(wi)}}const Gre=new a.OlP("angularfire2.enableFirestorePersistence"),Wre=new a.OlP("angularfire2.firestore.persistenceSettings"),wTe=new a.OlP("angularfire2.firestore.settings"),CTe=new a.OlP("angularfire2.firestore.use-emulator");function jre(n,t=(e=>e)){return{query:t(n),ref:n}}let xI=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f,m,_,y,w,T,I,E,A){this.schedulers=c;const M=(0,Ki.on)(e,l,r),O=f;m&&NG(M,l,_,w,T,I,y,E),[this.firestore,this.persistenceEnabled$]=(0,Ki.cc)(`${M.name}.firestore`,"AngularFirestore",M.name,()=>{const $=l.runOutsideAngular(()=>M.firestore());if(s&&$.settings(s),O&&$.useEmulator(...O),i&&!Lh(o)){const V=()=>{try{return(0,Dn.D)($.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(Z){return typeof console<"u"&&console.warn(Z),St(!1)}};return[$,l.runOutsideAngular(V)]}return[$,St(!1)]},[s,O,i])}collection(e,r){let i;i="string"==typeof e?this.firestore.collection(e):e;const{ref:s,query:o}=jre(i,r),l=this.schedulers.ngZone.run(()=>s);return new zre(l,o,this)}collectionGroup(e,r){const i=r||(o=>o),s=this.firestore.collectionGroup(e);return new bTe(i(s),this)}doc(e){let r;r="string"==typeof e?this.firestore.doc(e):e;const i=this.schedulers.ngZone.run(()=>r);return new Hre(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Ki.Dh),a.LFG(Ki.xv,8),a.LFG(Gre,8),a.LFG(wTe,8),a.LFG(a.Lbi),a.LFG(a.R0b),a.LFG(ig),a.LFG(Wre,8),a.LFG(CTe,8),a.LFG(n2,8),a.LFG(TG,8),a.LFG(SG,8),a.LFG(EG,8),a.LFG(DG,8),a.LFG(kG,8),a.LFG(AG,8),a.LFG(Lk,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),xTe=(()=>{class n{constructor(){IG.Z.registerVersion("angularfire",zf.full,"fst-compat")}static enablePersistence(e){return{ngModule:n,providers:[{provide:Gre,useValue:!0},{provide:Wre,useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[xI]}),n})();function RL(n,t=Fc){return(0,ti.e)((e,r)=>{let i=null,s=null,o=null;const l=()=>{if(i){i.unsubscribe(),i=null;const u=s;s=null,r.next(u)}};function c(){const u=o+n,f=t.now();if(f<u)return i=this.schedule(void 0,u-f),void r.add(i);l()}e.subscribe((0,zr.x)(r,u=>{s=u,o=t.now(),i||(i=t.schedule(c,n),r.add(i))},()=>{l(),r.complete()},void 0,()=>{s=i=null}))})}const qre="firebasestorage.googleapis.com",Zre="storageBucket";class zi extends W.ZR{constructor(t,e,r=0){super(Uj(t),`Firebase Storage: ${e} (${Uj(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,zi.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Uj(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var hi=(()=>(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(hi||(hi={})),hi))();function Uj(n){return"storage/"+n}function zj(){return new zi(hi.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Yre(){return new zi(hi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Kre(){return new zi(hi.CANCELED,"User canceled the upload/download.")}function Qre(){return new zi(hi.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function II(n){return new zi(hi.INVALID_ARGUMENT,n)}function Xre(){return new zi(hi.APP_DELETED,"The Firebase app was deleted.")}function Jre(n){return new zi(hi.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function e1(n,t){return new zi(hi.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function t1(n){throw new zi(hi.INTERNAL_ERROR,"Internal error: "+n)}class ma{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let r;try{r=ma.makeFromUrl(t,e)}catch{return new ma(t,"")}if(""===r.path)return r;throw function MTe(n){return new zi(hi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(t)}static makeFromUrl(t,e){let r=null;const i="([A-Za-z0-9.\\-_]+)",l=new RegExp("^gs://"+i+"(/(.*))?$","i");function u(O){O.path_=decodeURIComponent(O.path)}const m=e.replace(/[.]/g,"\\."),M=[{regex:l,indices:{bucket:1,path:3},postModify:function s(O){"/"===O.path.charAt(O.path.length-1)&&(O.path_=O.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${m}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:u},{regex:new RegExp(`^https?://${e===qre?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:u}];for(let O=0;O<M.length;O++){const $=M[O],V=$.regex.exec(t);if(V){let Q=V[$.indices.path];Q||(Q=""),r=new ma(V[$.indices.bucket],Q),$.postModify(r);break}}if(null==r)throw function RTe(n){return new zi(hi.INVALID_URL,"Invalid URL '"+n+"'.")}(t);return r}}class $Te{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function ML(n){return"string"==typeof n||n instanceof String}function eie(n){return Hj()&&n instanceof Blob}function Hj(){return typeof Blob<"u"&&!(0,W.UG)()}function Gj(n,t,e,r){if(r<t)throw II(`Invalid value for '${n}'. Expected ${t} or greater.`);if(r>e)throw II(`Invalid value for '${n}'. Expected ${e} or less.`)}function ip(n,t,e){let r=t;return null==e&&(r=`https://${t}`),`${e}://${r}/v0${n}`}function tie(n){const t=encodeURIComponent;let e="?";for(const r in n)n.hasOwnProperty(r)&&(e=e+(t(r)+"=")+t(n[r])+"&");return e=e.slice(0,-1),e}var zg=(()=>(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"}(zg||(zg={})),zg))();function nie(n,t){const e=n>=500&&n<600,i=-1!==[408,429].indexOf(n),s=-1!==t.indexOf(n);return e||i||s}class GTe{constructor(t,e,r,i,s,o,l,c,u,f,m,_=!0){this.url_=t,this.method_=e,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=m,this.retry=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,w)=>{this.resolve_=y,this.reject_=w,this.start_()})}start_(){const e=(r,i)=>{const s=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());!function UTe(n){return void 0!==n}(c)?s():s(c)}catch(c){o(c)}else if(null!==l){const c=zj();c.serverResponse=l.getErrorText(),o(this.errorCallback_?this.errorCallback_(l,c):c)}else o(i.canceled?this.appDelete_?Xre():Kre():Yre())};this.canceled_?e(0,new OL(!1,null,!0)):this.backoffId_=function BTe(n,t,e){let r=1,i=null,s=null,o=!1,l=0;function c(){return 2===l}let u=!1;function f(...I){u||(u=!0,t.apply(null,I))}function m(I){i=setTimeout(()=>{i=null,n(y,c())},I)}function _(){s&&clearTimeout(s)}function y(I,...E){if(u)return void _();if(I)return _(),void f.call(null,I,...E);if(c()||o)return _(),void f.call(null,I,...E);let M;r<64&&(r*=2),1===l?(l=2,M=0):M=1e3*(r+Math.random()),m(M)}let w=!1;function T(I){w||(w=!0,_(),!u&&(null!==i?(I||(l=2),clearTimeout(i),m(0)):I||(l=1)))}return m(0),s=setTimeout(()=>{o=!0,T(!0)},e),T}((r,i)=>{if(i)return void r(!1,new OL(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{null!==this.progressCallback_&&this.progressCallback_(l.loaded,l.lengthComputable?l.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===zg.NO_ERROR,c=s.getStatus();if(!l||nie(c,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===zg.ABORT;return void r(!1,new OL(!1,null,f))}const u=-1!==this.successCodes_.indexOf(c);r(!0,new OL(u,s))})},e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function VTe(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class OL{constructor(t,e,r){this.wasSuccessCode=t,this.connection=e,this.canceled=!!r}}function QTe(...n){const t=function KTe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==t){const e=new t;for(let r=0;r<n.length;r++)e.append(n[r]);return e.getBlob()}if(Hj())return new Blob(n);throw new zi(hi.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const cc={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Wj{constructor(t,e){this.data=t,this.contentType=e||null}}function jj(n,t){switch(n){case cc.RAW:return new Wj(rie(t));case cc.BASE64:case cc.BASE64URL:return new Wj(iie(n,t));case cc.DATA_URL:return new Wj(function tSe(n){const t=new sie(n);return t.base64?iie(cc.BASE64,t.rest):function eSe(n){let t;try{t=decodeURIComponent(n)}catch{throw e1(cc.DATA_URL,"Malformed data URL.")}return rie(t)}(t.rest)}(t),function nSe(n){return new sie(n).contentType}(t))}throw zj()}function rie(n){const t=[];for(let e=0;e<n.length;e++){let r=n.charCodeAt(e);r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|63&r):55296==(64512&r)?e<n.length-1&&56320==(64512&n.charCodeAt(e+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++e),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):t.push(239,191,189):56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function iie(n,t){switch(n){case cc.BASE64:{const i=-1!==t.indexOf("-"),s=-1!==t.indexOf("_");if(i||s)throw e1(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case cc.BASE64URL:{const i=-1!==t.indexOf("+"),s=-1!==t.indexOf("/");if(i||s)throw e1(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=function JTe(n){if(typeof atob>"u")throw function LTe(n){return new zi(hi.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(t)}catch(i){throw i.message.includes("polyfill")?i:e1(n,"Invalid character found")}const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r}class sie{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(null===e)throw e1(cc.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=e[1]||null;null!=r&&(this.base64=function rSe(n,t){return n.length>=t.length&&n.substring(n.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}}class uh{constructor(t,e){let r=0,i="";eie(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(eie(this.data_)){const i=function XTe(n,t,e){return n.webkitSlice?n.webkitSlice(t,e):n.mozSlice?n.mozSlice(t,e):n.slice?n.slice(t,e):null}(this.data_,t,e);return null===i?null:new uh(i)}{const r=new Uint8Array(this.data_.buffer,t,e-t);return new uh(r,!0)}}static getBlob(...t){if(Hj()){const e=t.map(r=>r instanceof uh?r.data_:r);return new uh(QTe.apply(null,e))}{const e=t.map(o=>ML(o)?jj(cc.RAW,o).data:o.data_);let r=0;e.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return e.forEach(o=>{for(let l=0;l<o.length;l++)i[s++]=o[l]}),new uh(i,!0)}}uploadData(){return this.data_}}function qj(n){let t;try{t=JSON.parse(n)}catch{return null}return function HTe(n){return"object"==typeof n&&!Array.isArray(n)}(t)?t:null}function oie(n){const t=n.lastIndexOf("/",n.length-2);return-1===t?n:n.slice(t+1)}function oSe(n,t){return t}class Ya{constructor(t,e,r,i){this.server=t,this.local=e||t,this.writable=!!r,this.xform=i||oSe}}let FL=null;function n1(){if(FL)return FL;const n=[];n.push(new Ya("bucket")),n.push(new Ya("generation")),n.push(new Ya("metageneration")),n.push(new Ya("name","fullPath",!0));const e=new Ya("name");e.xform=function t(s,o){return function aSe(n){return!ML(n)||n.length<2?n:oie(n)}(o)},n.push(e);const i=new Ya("size");return i.xform=function r(s,o){return void 0!==o?Number(o):o},n.push(i),n.push(new Ya("timeCreated")),n.push(new Ya("updated")),n.push(new Ya("md5Hash",null,!0)),n.push(new Ya("cacheControl",null,!0)),n.push(new Ya("contentDisposition",null,!0)),n.push(new Ya("contentEncoding",null,!0)),n.push(new Ya("contentLanguage",null,!0)),n.push(new Ya("contentType",null,!0)),n.push(new Ya("metadata","customMetadata",!0)),FL=n,FL}function aie(n,t,e){const r=qj(t);return null===r?null:function cSe(n,t,e){const r={type:"file"},i=e.length;for(let s=0;s<i;s++){const o=e[s];r[o.local]=o.xform(r,t[o.server])}return function lSe(n,t){Object.defineProperty(n,"ref",{get:function e(){const s=new ma(n.bucket,n.fullPath);return t._makeStorageReference(s)}})}(r,n),r}(n,r,e)}function Zj(n,t){const e={},r=t.length;for(let i=0;i<r;i++){const s=t[i];s.writable&&(e[s.server]=n[s.local])}return JSON.stringify(e)}class dh{constructor(t,e,r,i){this.url=t,this.method=e,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function hh(n){if(!n)throw zj()}function PL(n,t){return function e(r,i){const s=aie(n,i,t);return hh(null!==s),s}}function TI(n){return function t(e,r){let i;return i=401===e.getStatus()?e.getErrorText().includes("Firebase App Check token is invalid")?function ATe(){return new zi(hi.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function kTe(){return new zi(hi.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===e.getStatus()?function DTe(n){return new zi(hi.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===e.getStatus()?function NTe(n){return new zi(hi.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):r,i.status=e.getStatus(),i.serverResponse=r.serverResponse,i}}function r1(n){const t=TI(n);return function e(r,i){let s=t(r,i);return 404===r.getStatus()&&(s=function ETe(n){return new zi(hi.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),s.serverResponse=i.serverResponse,s}}function uie(n,t,e){const i=ip(t.fullServerUrl(),n.host,n._protocol),o=n.maxOperationRetryTime,l=new dh(i,"GET",PL(n,e),o);return l.errorHandler=r1(t),l}function mSe(n,t,e,r,i){const s={};s.prefix=t.isRoot?"":t.path+"/",e&&e.length>0&&(s.delimiter=e),r&&(s.pageToken=r),i&&(s.maxResults=i);const l=ip(t.bucketOnlyServerUrl(),n.host,n._protocol),u=n.maxOperationRetryTime,f=new dh(l,"GET",function fSe(n,t){return function e(r,i){const s=function hSe(n,t,e){const r=qj(e);return null===r?null:function dSe(n,t,e){const r={prefixes:[],items:[],nextPageToken:e.nextPageToken};if(e.prefixes)for(const i of e.prefixes){const s=i.replace(/\/$/,""),o=n._makeStorageReference(new ma(t,s));r.prefixes.push(o)}if(e.items)for(const i of e.items){const s=n._makeStorageReference(new ma(t,i.name));r.items.push(s)}return r}(n,t,r)}(n,t,i);return hh(null!==s),s}}(n,t.bucket),u);return f.urlParams=s,f.errorHandler=TI(t),f}function hie(n,t,e){const r=Object.assign({},e);return r.fullPath=n.path,r.size=t.size(),r.contentType||(r.contentType=function vSe(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}class LL{constructor(t,e,r,i){this.current=t,this.total=e,this.finalized=!!r,this.metadata=i||null}}function Yj(n,t){let e=null;try{e=n.getResponseHeader("X-Goog-Upload-Status")}catch{hh(!1)}return hh(!!e&&-1!==(t||["active"]).indexOf(e)),e}const xSe={STATE_CHANGED:"state_changed"},Ka={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Kj(n){switch(n){case"running":case"pausing":case"canceling":return Ka.RUNNING;case"paused":return Ka.PAUSED;case"success":return Ka.SUCCESS;case"canceled":return Ka.CANCELED;default:return Ka.ERROR}}class ISe{constructor(t,e,r){if(function zTe(n){return"function"==typeof n}(t)||null!=e||null!=r)this.next=t,this.error=e??void 0,this.complete=r??void 0;else{const s=t;this.next=s.next,this.error=s.error,this.complete=s.complete}}}function SI(n){return(...t)=>{Promise.resolve().then(()=>n(...t))}}class SSe extends class TSe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zg.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zg.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zg.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,e,r,i){if(this.sent_)throw t1("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==i)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw t1("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw t1("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw t1("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw t1("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}{initXhr(){this.xhr_.responseType="text"}}function Ju(){return new SSe}class gie{constructor(t,e,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=r,this._mappings=n1(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(hi.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(nie(i.status,[])){if(!s)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=Yre()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(hi.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return e=>this._updateProgress(t+e)}_shouldDoResumable(t){return t.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([e,r])=>{switch(this._state){case"running":t(e,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((t,e)=>{const r=function bSe(n,t,e,r,i){const s=t.bucketOnlyServerUrl(),o=hie(t,r,i),l={name:o.fullPath},c=ip(s,n.host,n._protocol),f={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},m=Zj(o,e),w=new dh(c,"POST",function y(T){let I;Yj(T);try{I=T.getResponseHeader("X-Goog-Upload-URL")}catch{hh(!1)}return hh(ML(I)),I},n.maxUploadRetryTime);return w.urlParams=l,w.headers=f,w.body=m,w.errorHandler=TI(t),w}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ju,t,e);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((e,r)=>{const i=function wSe(n,t,e,r){const c=new dh(e,"POST",function s(u){const f=Yj(u,["active","final"]);let m=null;try{m=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{hh(!1)}m||hh(!1);const _=Number(m);return hh(!isNaN(_)),new LL(_,r.size(),"final"===f)},n.maxUploadRetryTime);return c.headers={"X-Goog-Upload-Command":"query"},c.errorHandler=TI(t),c}(this._ref.storage,this._ref._location,t,this._blob),s=this._ref.storage._makeRequest(i,Ju,e,r);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=262144*this._chunkMultiplier,e=new LL(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=function CSe(n,t,e,r,i,s,o,l){const c=new LL(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw function FTe(){return new zi(hi.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const u=c.total-c.current;let f=u;i>0&&(f=Math.min(f,i));const m=c.current;let y="";y=0===f?"finalize":u===f?"upload, finalize":"upload";const w={"X-Goog-Upload-Command":y,"X-Goog-Upload-Offset":`${c.current}`},T=r.slice(m,m+f);if(null===T)throw Qre();const M=new dh(e,"POST",function I(O,$){const V=Yj(O,["active","final"]),Z=c.current+f,Q=r.size();let re;return re="final"===V?PL(t,s)(O,$):null,new LL(Z,Q,"final"===V,re)},t.maxUploadRetryTime);return M.headers=w,M.body=T.uploadData(),M.progressCallback=l||null,M.errorHandler=TI(n),M}(this._ref._location,this._ref.storage,r,this._blob,t,this._mappings,e,this._makeProgressCallback())}catch(c){return this._error=c,void this._transition("error")}const l=this._ref.storage._makeRequest(o,Ju,i,s,!1);this._request=l,l.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,e)=>{const r=uie(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ju,t,e);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,e)=>{const r=function fie(n,t,e,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},c=function l(){let M="";for(let O=0;O<2;O++)M+=Math.random().toString().slice(2);return M}();o["Content-Type"]="multipart/related; boundary="+c;const u=hie(t,r,i),f=Zj(u,e),y=uh.getBlob("--"+c+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+f+"\r\n--"+c+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",r,"\r\n--"+c+"--");if(null===y)throw Qre();const w={name:u.fullPath},T=ip(s,n.host,n._protocol),E=n.maxUploadRetryTime,A=new dh(T,"POST",PL(n,e),E);return A.urlParams=w,A.headers=o,A.body=y.uploadData(),A.errorHandler=TI(t),A}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ju,t,e);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=Kre(),this._state=t,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const t=Kj(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,e,r,i){const s=new ISe(e||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(t,e){return this._promise.then(t,e)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(e=>{this._notifyObserver(e)})}_finishPromise(){if(void 0!==this._resolve){let t=!0;switch(Kj(this._state)){case Ka.SUCCESS:SI(this._resolve.bind(null,this.snapshot))();break;case Ka.CANCELED:case Ka.ERROR:SI(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(Kj(this._state)){case Ka.RUNNING:case Ka.PAUSED:t.next&&SI(t.next.bind(t,this.snapshot))();break;case Ka.SUCCESS:t.complete&&SI(t.complete.bind(t))();break;default:t.error&&SI(t.error.bind(t,this._error))()}}resume(){const t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t}pause(){const t="running"===this._state;return t&&this._transition("pausing"),t}cancel(){const t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t}}class Ib{constructor(t,e){this._service=t,this._location=e instanceof ma?e:ma.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Ib(t,e)}get root(){const t=new ma(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return oie(this._location.path)}get storage(){return this._service}get parent(){const t=function iSe(n){if(0===n.length)return null;const t=n.lastIndexOf("/");return-1===t?"":n.slice(0,t)}(this._location.path);if(null===t)return null;const e=new ma(this._location.bucket,t);return new Ib(this._service,e)}_throwIfRoot(t){if(""===this._location.path)throw Jre(t)}}function yie(n,t,e){return Qj.apply(this,arguments)}function Qj(){return Qj=(0,q.Z)(function*(n,t,e){const i=yield vie(n,{pageToken:e});t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&(yield yie(n,t,i.nextPageToken))}),Qj.apply(this,arguments)}function vie(n,t){null!=t&&"number"==typeof t.maxResults&&Gj("options.maxResults",1,1e3,t.maxResults);const e=t||{},r=mSe(n.storage,n._location,"/",e.pageToken,e.maxResults);return n.storage.makeRequestWithTokens(r,Ju)}function $Se(n){n._throwIfRoot("getDownloadURL");const t=function gSe(n,t,e){const i=ip(t.fullServerUrl(),n.host,n._protocol),o=n.maxOperationRetryTime,l=new dh(i,"GET",function pSe(n,t){return function e(r,i){const s=aie(n,i,t);return hh(null!==s),function uSe(n,t,e,r){const i=qj(t);if(null===i||!ML(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(u=>{const m=n.fullPath;return ip("/b/"+o(n.bucket)+"/o/"+o(m),e,r)+tie({alt:"media",token:u})})[0]}(s,i,n.host,n._protocol)}}(n,e),o);return l.errorHandler=r1(t),l}(n.storage,n._location,n1());return n.storage.makeRequestWithTokens(t,Ju).then(e=>{if(null===e)throw function PTe(){return new zi(hi.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return e})}function bie(n,t){const e=function sSe(n,t){const e=t.split("/").filter(r=>r.length>0).join("/");return 0===n.length?e:n+"/"+e}(n._location.path,t),r=new ma(n._location.bucket,e);return new Ib(n.storage,r)}function wie(n,t){if(n instanceof Xj){const e=n;if(null==e._bucket)throw function OTe(){return new zi(hi.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Zre+"' property when initializing the app?")}();const r=new Ib(e,e._bucket);return null!=t?wie(r,t):r}return void 0!==t?bie(n,t):n}function zSe(n,t){if(t&&function VSe(n){return/^[A-Za-z]+:\/\//.test(n)}(t)){if(n instanceof Xj)return function USe(n,t){return new Ib(n,t)}(n,t);throw II("To use ref(service, url), the first argument must be a Storage instance.")}return wie(n,t)}function Cie(n,t){const e=t?.[Zre];return null==e?null:ma.makeFromBucketSpec(e,n)}class Xj{constructor(t,e,r,i,s){this.app=t,this._authProvider=e,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=qre,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ma.makeFromBucketSpec(i,this._host):Cie(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._bucket=null!=this._url?ma.makeFromBucketSpec(this._url,t):Cie(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Gj("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Gj("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){var t=this;return(0,q.Z)(function*(){if(t._overrideAuthToken)return t._overrideAuthToken;const e=t._authProvider.getImmediate({optional:!0});if(e){const r=yield e.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var t=this;return(0,q.Z)(function*(){const e=t._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Ib(this,t)}_makeRequest(t,e,r,i,s=!0){if(this._deleted)return new $Te(Xre());{const o=function YTe(n,t,e,r,i,s,o=!0){const l=tie(n.urlParams),c=n.url+l,u=Object.assign({},n.headers);return function qTe(n,t){t&&(n["X-Firebase-GMPID"]=t)}(u,t),function WTe(n,t){null!==t&&t.length>0&&(n.Authorization="Firebase "+t)}(u,e),function jTe(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(u,s),function ZTe(n,t){null!==t&&(n["X-Firebase-AppCheck"]=t)}(u,r),new GTe(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}(t,this._appId,r,i,e,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(t,e){var r=this;return(0,q.Z)(function*(){const[i,s]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(t,e,i,s).getPromise()})()}}const xie="@firebase/storage";function Sie(n,t){return zSe(n=(0,W.m9)(n),t)}function XSe(n,{instanceIdentifier:t}){const e=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Xj(e,r,i,t,An.SDK_VERSION)}!function JSe(){(0,An._registerComponent)(new us.wA("storage",XSe,"PUBLIC").setMultipleInstances(!0)),(0,An.registerVersion)(xie,"0.11.2",""),(0,An.registerVersion)(xie,"0.11.2","esm2017")}();class $L{constructor(t,e,r){this._delegate=t,this.task=e,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class Die{constructor(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new $L(this._delegate.snapshot,this,this._ref)}then(t,e){return this._delegate.then(r=>{if(t)return t(new $L(r,this,this._ref))},e)}on(t,e,r,i){let s;return e&&(s="function"==typeof e?o=>e(new $L(o,this,this._ref)):{next:e.next?o=>e.next(new $L(o,this,this._ref)):void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,s,r||void 0,i||void 0)}}class kie{constructor(t,e){this._delegate=t,this._service=e}get prefixes(){return this._delegate.prefixes.map(t=>new sp(t,this._service))}get items(){return this._delegate.items.map(t=>new sp(t,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class sp{constructor(t,e){this._delegate=t,this.storage=e}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(t){const e=function QSe(n,t){return bie(n,t)}(this._delegate,t);return new sp(e,this.storage)}get root(){return new sp(this._delegate.root,this.storage)}get parent(){const t=this._delegate.parent;return null==t?null:new sp(t,this.storage)}put(t,e){return this._throwIfRoot("put"),new Die(function GSe(n,t,e){return function MSe(n,t,e){return n._throwIfRoot("uploadBytesResumable"),new gie(n,new uh(t),e)}(n=(0,W.m9)(n),t,e)}(this._delegate,t,e),this)}putString(t,e=cc.RAW,r){this._throwIfRoot("putString");const i=jj(e,t),s=Object.assign({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),new Die(new gie(this._delegate,new uh(i.data,!0),s),this)}listAll(){return function ZSe(n){return function FSe(n){const t={prefixes:[],items:[]};return yie(n,t).then(()=>t)}(n=(0,W.m9)(n))}(this._delegate).then(t=>new kie(t,this.storage))}list(t){return function qSe(n,t){return vie(n=(0,W.m9)(n),t)}(this._delegate,t||void 0).then(e=>new kie(e,this.storage))}getMetadata(){return function WSe(n){return function PSe(n){n._throwIfRoot("getMetadata");const t=uie(n.storage,n._location,n1());return n.storage.makeRequestWithTokens(t,Ju)}(n=(0,W.m9)(n))}(this._delegate)}updateMetadata(t){return function jSe(n,t){return function LSe(n,t){n._throwIfRoot("updateMetadata");const e=function _Se(n,t,e,r){const s=ip(t.fullServerUrl(),n.host,n._protocol),l=Zj(e,r),u=n.maxOperationRetryTime,f=new dh(s,"PATCH",PL(n,r),u);return f.headers={"Content-Type":"application/json; charset=utf-8"},f.body=l,f.errorHandler=r1(t),f}(n.storage,n._location,t,n1());return n.storage.makeRequestWithTokens(e,Ju)}(n=(0,W.m9)(n),t)}(this._delegate,t)}getDownloadURL(){return function YSe(n){return $Se(n=(0,W.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function KSe(n){return function BSe(n){n._throwIfRoot("deleteObject");const t=function ySe(n,t){const r=ip(t.fullServerUrl(),n.host,n._protocol),l=new dh(r,"DELETE",function o(c,u){},n.maxOperationRetryTime);return l.successCodes=[200,204],l.errorHandler=r1(t),l}(n.storage,n._location);return n.storage.makeRequestWithTokens(t,Ju)}(n=(0,W.m9)(n))}(this._delegate)}_throwIfRoot(t){if(""===this._delegate._location.path)throw Jre(t)}}class Aie{constructor(t,e){this.app=t,this._delegate=e}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(t){if(Nie(t))throw II("ref() expected a child path but got a URL, use refFromURL instead.");return new sp(Sie(this._delegate,t),this)}refFromURL(t){if(!Nie(t))throw II("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ma.makeFromUrl(t,this._delegate.host)}catch{throw II("refFromUrl() expected a valid full URL but got an invalid one.")}return new sp(Sie(this._delegate,t),this)}setMaxUploadRetryTime(t){this._delegate.maxUploadRetryTime=t}setMaxOperationRetryTime(t){this._delegate.maxOperationRetryTime=t}useEmulator(t,e,r={}){!function Eie(n,t,e,r={}){!function HSe(n,t,e,r={}){n.host=`${t}:${e}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,W.Sg)(i,n.app.options.projectId))}(n,t,e,r)}(this._delegate,t,e,r)}}function Nie(n){return/^[A-Za-z]+:\/\//.test(n)}function rEe(n,{instanceIdentifier:t}){const e=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:t});return new Aie(e,r)}function Rie(n){const t=function sEe(n){return new Cr.y(t=>{const e=o=>t.next(o);e(n.snapshot);const s=n.on("state_changed",e);return n.then(o=>{e(o),t.complete()},o=>{e(n.snapshot),(o=>{t.error(o)})(o)}),function(){s()}}).pipe(RL(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>t,percentageChanges:()=>t.pipe((0,Ot.U)(e=>e.bytesTransferred/e.totalBytes*100))}}function BL(n){return{getDownloadURL:()=>St(void 0).pipe(yl,wn(()=>n.getDownloadURL()),wi),getMetadata:()=>St(void 0).pipe(yl,wn(()=>n.getMetadata()),wi),delete:()=>(0,Dn.D)(n.delete()),child:t=>BL(n.child(t)),updateMetadata:t=>(0,Dn.D)(n.updateMetadata(t)),put:(t,e)=>Rie(n.put(t,e)),putString:(t,e,r)=>Rie(n.putString(t,e,r)),list:t=>(0,Dn.D)(n.list(t)),listAll:()=>(0,Dn.D)(n.listAll())}}!function iEe(n){const t={TaskState:Ka,TaskEvent:xSe,StringFormat:cc,Storage:Aie,Reference:sp};n.INTERNAL.registerComponent(new us.wA("storage-compat",rEe,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.2")}(ZD.Z);const oEe=new a.OlP("angularfire2.storageBucket"),aEe=new a.OlP("angularfire2.storage.maxUploadRetryTime"),lEe=new a.OlP("angularfire2.storage.maxOperationRetryTime"),cEe=new a.OlP("angularfire2.storage.use-emulator");let Jj=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f,m){const _=(0,Ki.on)(e,o,r);this.storage=(0,Ki.cc)(`${_.name}.storage.${i}`,"AngularFireStorage",_.name,()=>{const y=o.runOutsideAngular(()=>_.storage(i||void 0)),w=f;return w&&y.useEmulator(...w),c&&y.setMaxUploadRetryTime(c),u&&y.setMaxOperationRetryTime(u),y},[c,u])}ref(e){return BL(this.storage.ref(e))}refFromURL(e){return BL(this.storage.refFromURL(e))}upload(e,r,i){return BL(this.storage.ref(e)).put(r,i)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Ki.Dh),a.LFG(Ki.xv,8),a.LFG(oEe,8),a.LFG(a.Lbi),a.LFG(a.R0b),a.LFG(ig),a.LFG(aEe,8),a.LFG(lEe,8),a.LFG(cEe,8),a.LFG(Lk,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),uEe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})(),dEe=(()=>{class n{constructor(){IG.Z.registerVersion("angularfire",zf.full,"gcs-compat")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[Jj],imports:[uEe]}),n})();const VL={production:!0,firebase:{apiKey:"AIzaSyDE8NW8L3l2Rtf0chpZqlUWZVwBPxSm18I",authDomain:"licenta-fb443.firebaseapp.com",databaseURL:"https://licenta-fb443-default-rtdb.europe-west1.firebasedatabase.app",projectId:"licenta-fb443",storageBucket:"licenta-fb443.appspot.com",messagingSenderId:"23841865369",appId:"1:23841865369:web:35ac26aa4ae248a8070208",measurementId:"G-DL565TRXP3"},recaptchaV3SiteKey:"6Lf7MxEqAAAAAE0vR7jYA6ubCfcRb4f5jTvRCsGX"};let eq;try{eq=typeof Intl<"u"&&Intl.v8BreakIterator}catch{eq=!1}let EI,Oi=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function q_(n){return n===Ph}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!eq)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.Lbi))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Mie=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Oie(){if(EI)return EI;if("object"!=typeof document||!document)return EI=new Set(Mie),EI;let n=document.createElement("input");return EI=new Set(Mie.filter(t=>(n.setAttribute("type",t),n.type===t))),EI}let s1,Sb,tq;function Tb(n){return function hEe(){if(null==s1&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>s1=!0}))}finally{s1=s1||!1}return s1}()?n:!!n.capture}function fEe(){if(null==Sb){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Sb=!1,Sb;if("scrollBehavior"in document.documentElement.style)Sb=!0;else{const n=Element.prototype.scrollTo;Sb=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Sb}function Fie(n){if(function pEe(){if(null==tq){const n=typeof document<"u"?document.head:null;tq=!(!n||!n.createShadowRoot&&!n.attachShadow)}return tq}()){const t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function o1(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const t=n.shadowRoot.activeElement;if(t===n)break;n=t}return n}function Eb(n){return n.composedPath?n.composedPath()[0]:n.target}function nq(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}class Zo extends Xt.x{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}function Il(n,...t){return t.length?t.some(e=>n[e]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function rq(n){return cr((t,e)=>n<=e)}function ur(n){return(0,ti.e)((t,e)=>{(0,Ru.Xf)(n).subscribe((0,zr.x)(e,()=>e.complete(),vC.Z)),!e.closed&&t.subscribe(e)})}function xn(n){return null!=n&&"false"!=`${n}`}function ga(n,t=0){return function IEe(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):t}function jL(n){return Array.isArray(n)?n:[n]}function Es(n){return null==n?"":"string"==typeof n?n:`${n}px`}function lp(n){return n instanceof a.SBq?n.nativeElement:n}let Lie=(()=>{class n{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),SEe=(()=>{class n{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,r)=>this._cleanupObserver(r))}observe(e){const r=lp(e);return new Cr.y(i=>{const o=this._observeElement(r).subscribe(i);return()=>{o.unsubscribe(),this._unobserveElement(r)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const r=new Xt.x,i=this._mutationObserverFactory.create(s=>r.next(s));i&&i.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:i,stream:r,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:r,stream:i}=this._observedElements.get(e);r&&r.disconnect(),i.complete(),this._observedElements.delete(e)}}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Lie))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),iq=(()=>{class n{constructor(e,r,i){this._contentObserver=e,this._elementRef=r,this._ngZone=i,this.event=new a.vpe,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(e){this._disabled=xn(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=ga(e),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(RL(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(SEe),a.Y36(a.SBq),a.Y36(a.R0b))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),qL=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[Lie]}),n})();var EEe=z(9672);function DI(...n){const t=(0,Mu.yG)(n),e=(0,Mu.jO)(n),{args:r,keys:i}=_M(n);if(0===r.length)return(0,Dn.D)([],t);const s=new Cr.y(function DEe(n,t,e=Pc.y){return r=>{$ie(t,()=>{const{length:i}=n,s=new Array(i);let o=i,l=i;for(let c=0;c<i;c++)$ie(t,()=>{const u=(0,Dn.D)(n[c],t);let f=!1;u.subscribe((0,zr.x)(r,m=>{s[c]=m,f||(f=!0,l--),l||r.next(e(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,i?o=>vM(i,o):Pc.y));return e?s.pipe(LS(e)):s}function $ie(n,t,e){n?(0,EEe.f)(e,n,t):t()}const Bie=new Set;let kI,kEe=(()=>{class n{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):NEe}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function AEe(n){if(!Bie.has(n))try{kI||(kI=document.createElement("style"),kI.setAttribute("type","text/css"),document.head.appendChild(kI)),kI.sheet&&(kI.sheet.insertRule(`@media ${n} {body{ }}`,0),Bie.add(n))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Oi))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function NEe(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let ZL=(()=>{class n{constructor(e,r){this._mediaMatcher=e,this._zone=r,this._queries=new Map,this._destroySubject=new Xt.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return Vie(jL(e)).some(i=>this._registerQuery(i).mql.matches)}observe(e){let s=DI(Vie(jL(e)).map(o=>this._registerQuery(o).observable));return s=Vk(s.pipe(nr(1)),s.pipe(rq(1),RL(0))),s.pipe((0,Ot.U)(o=>{const l={matches:!1,breakpoints:{}};return o.forEach(({matches:c,query:u})=>{l.matches=l.matches||c,l.breakpoints[u]=c}),l}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const r=this._mediaMatcher.matchMedia(e),s={observable:new Cr.y(o=>{const l=c=>this._zone.run(()=>o.next(c));return r.addListener(l),()=>{r.removeListener(l)}}).pipe(Ui(r),(0,Ot.U)(({matches:o})=>({query:e,matches:o})),ur(this._destroySubject)),mql:r};return this._queries.set(e,s),s}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(kEe),a.LFG(a.R0b))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Vie(n){return n.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}function YL(n,t){return(n.getAttribute(t)||"").match(/\S+/g)||[]}const Hie="cdk-describedby-message",KL="cdk-describedby-host";let sq=0,OEe=(()=>{class n{constructor(e,r){this._platform=r,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+sq++,this._document=e,this._id=(0,a.f3M)(a.AFp)+"-"+sq++}describe(e,r,i){if(!this._canBeDescribed(e,r))return;const s=oq(r,i);"string"!=typeof r?(Gie(r,this._id),this._messageRegistry.set(s,{messageElement:r,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(r,i),this._isElementDescribedByMessage(e,s)||this._addMessageReference(e,s)}removeDescription(e,r,i){if(!r||!this._isElementNode(e))return;const s=oq(r,i);if(this._isElementDescribedByMessage(e,s)&&this._removeMessageReference(e,s),"string"==typeof r){const o=this._messageRegistry.get(s);o&&0===o.referenceCount&&this._deleteMessageElement(s)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const e=this._document.querySelectorAll(`[${KL}="${this._id}"]`);for(let r=0;r<e.length;r++)this._removeCdkDescribedByReferenceIds(e[r]),e[r].removeAttribute(KL);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(e,r){const i=this._document.createElement("div");Gie(i,this._id),i.textContent=e,r&&i.setAttribute("role",r),this._createMessagesContainer(),this._messagesContainer.appendChild(i),this._messageRegistry.set(oq(e,r),{messageElement:i,referenceCount:0})}_deleteMessageElement(e){this._messageRegistry.get(e)?.messageElement?.remove(),this._messageRegistry.delete(e)}_createMessagesContainer(){if(this._messagesContainer)return;const e="cdk-describedby-message-container",r=this._document.querySelectorAll(`.${e}[platform="server"]`);for(let s=0;s<r.length;s++)r[s].remove();const i=this._document.createElement("div");i.style.visibility="hidden",i.classList.add(e),i.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&i.setAttribute("platform","server"),this._document.body.appendChild(i),this._messagesContainer=i}_removeCdkDescribedByReferenceIds(e){const r=YL(e,"aria-describedby").filter(i=>0!=i.indexOf(Hie));e.setAttribute("aria-describedby",r.join(" "))}_addMessageReference(e,r){const i=this._messageRegistry.get(r);(function REe(n,t,e){const r=YL(n,t);r.some(i=>i.trim()==e.trim())||(r.push(e.trim()),n.setAttribute(t,r.join(" ")))})(e,"aria-describedby",i.messageElement.id),e.setAttribute(KL,this._id),i.referenceCount++}_removeMessageReference(e,r){const i=this._messageRegistry.get(r);i.referenceCount--,function MEe(n,t,e){const i=YL(n,t).filter(s=>s!=e.trim());i.length?n.setAttribute(t,i.join(" ")):n.removeAttribute(t)}(e,"aria-describedby",i.messageElement.id),e.removeAttribute(KL)}_isElementDescribedByMessage(e,r){const i=YL(e,"aria-describedby"),s=this._messageRegistry.get(r),o=s&&s.messageElement.id;return!!o&&-1!=i.indexOf(o)}_canBeDescribed(e,r){if(!this._isElementNode(e))return!1;if(r&&"object"==typeof r)return!0;const i=null==r?"":`${r}`.trim(),s=e.getAttribute("aria-label");return!(!i||s&&s.trim()===i)}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt),a.LFG(Oi))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function oq(n,t){return"string"==typeof n?`${t||""}/${n}`:n}function Gie(n,t){n.id||(n.id=`${Hie}-${t}-${sq++}`)}class Wie{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Xt.x,this._typeaheadSubscription=kn.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=e=>e.disabled,this._pressedLetters=[],this.tabOut=new Xt.x,this.change=new Xt.x,t instanceof a.n_E&&t.changes.subscribe(e=>{if(this._activeItem){const i=e.toArray().indexOf(this._activeItem);i>-1&&i!==this._activeItemIndex&&(this._activeItemIndex=i)}})}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Qr(e=>this._pressedLetters.push(e)),RL(t),cr(()=>this._pressedLetters.length>0),(0,Ot.U)(()=>this._pressedLetters.join(""))).subscribe(e=>{const r=this._getItemsArray();for(let i=1;i<r.length+1;i++){const s=(this._activeItemIndex+i)%r.length,o=r[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}setActiveItem(t){const e=this._activeItem;this.updateActiveItem(t),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,i=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!t[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&i){this.setNextItemActive();break}return;case 38:if(this._vertical&&i){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&i){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&i){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&i){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&i){this.setLastItemActive();break}return;default:return void((i||Il(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),r="number"==typeof t?t:e.indexOf(t);this._activeItem=e[r]??null,this._activeItemIndex=r}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let r=1;r<=e.length;r++){const i=(this._activeItemIndex+t*r+e.length)%e.length;if(!this._skipPredicateFn(e[i]))return void this.setActiveItem(i)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const r=this._getItemsArray();if(r[t]){for(;this._skipPredicateFn(r[t]);)if(!r[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof a.n_E?this._items.toArray():this._items}}class FEe extends Wie{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}class aq extends Wie{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}}let QL=(()=>{class n{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function LEe(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const r=function PEe(n){try{return n.frameElement}catch{return null}}(function WEe(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(e));if(r&&(-1===qie(r)||!this.isVisible(r)))return!1;let i=e.nodeName.toLowerCase(),s=qie(e);return e.hasAttribute("contenteditable")?-1!==s:!("iframe"===i||"object"===i||this._platform.WEBKIT&&this._platform.IOS&&!function HEe(n){let t=n.nodeName.toLowerCase(),e="input"===t&&n.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===i?!!e.hasAttribute("controls")&&-1!==s:"video"===i?-1!==s&&(null!==s||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,r){return function GEe(n){return!function BEe(n){return function UEe(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function $Ee(n){let t=n.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(n)||function VEe(n){return function zEe(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||jie(n))}(e)&&!this.isDisabled(e)&&(r?.ignoreVisibility||this.isVisible(e))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Oi))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function jie(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let t=n.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function qie(n){if(!jie(n))return null;const t=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class jEe{constructor(t,e,r,i,s=!1){this._element=t,this._checker=e,this._ngZone=r,this._document=i,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const r=this._getFirstTabbableElement(e);return r?.focus(t),!!r}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let r=0;r<e.length;r++){const i=e[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[r]):null;if(i)return i}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let r=e.length-1;r>=0;r--){const i=e[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[r]):null;if(i)return i}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(nr(1)).subscribe(t)}}let XL=(()=>{class n{constructor(e,r,i){this._checker=e,this._ngZone=r,this._document=i}create(e,r=!1){return new jEe(e,this._checker,this._ngZone,this._document,r)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(QL),a.LFG(a.R0b),a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qEe=(()=>{class n{constructor(e,r,i){this._elementRef=e,this._focusTrapFactory=r,this._previouslyFocusedElement=null,this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0)}get enabled(){return this.focusTrap.enabled}set enabled(e){this.focusTrap.enabled=xn(e)}get autoCapture(){return this._autoCapture}set autoCapture(e){this._autoCapture=xn(e)}ngOnDestroy(){this.focusTrap.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap.hasAttached()||this.focusTrap.attachAnchors()}ngOnChanges(e){const r=e.autoCapture;r&&!r.firstChange&&this.autoCapture&&this.focusTrap.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=o1(),this.focusTrap.focusInitialElementWhenReady()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(XL),a.Y36(Nt))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:["cdkTrapFocus","enabled"],autoCapture:["cdkTrapFocusAutoCapture","autoCapture"]},exportAs:["cdkTrapFocus"],features:[a.TTD]}),n})();function lq(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function cq(n){const t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const ZEe=new a.OlP("cdk-input-modality-detector-options"),YEe={ignoreKeys:[18,17,224,91,16]},AI=Tb({passive:!0,capture:!0});let KEe=(()=>{class n{constructor(e,r,i,s){this._platform=e,this._mostRecentTarget=null,this._modality=new Zo(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(l=>l===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Eb(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(lq(o)?"keyboard":"mouse"),this._mostRecentTarget=Eb(o))},this._onTouchstart=o=>{cq(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Eb(o))},this._options={...YEe,...s},this.modalityDetected=this._modality.pipe(rq(1)),this.modalityChanged=this.modalityDetected.pipe($u()),e.isBrowser&&r.runOutsideAngular(()=>{i.addEventListener("keydown",this._onKeydown,AI),i.addEventListener("mousedown",this._onMousedown,AI),i.addEventListener("touchstart",this._onTouchstart,AI)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,AI),document.removeEventListener("mousedown",this._onMousedown,AI),document.removeEventListener("touchstart",this._onTouchstart,AI))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Oi),a.LFG(a.R0b),a.LFG(Nt),a.LFG(ZEe,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const QEe=new a.OlP("liveAnnouncerElement",{providedIn:"root",factory:function XEe(){return null}}),JEe=new a.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let uq=(()=>{class n{constructor(e,r,i,s){this._ngZone=r,this._defaultOptions=s,this._document=i,this._liveElement=e||this._createLiveElement()}announce(e,...r){const i=this._defaultOptions;let s,o;return 1===r.length&&"number"==typeof r[0]?o=r[0]:[s,o]=r,this.clear(),clearTimeout(this._previousTimeout),s||(s=i&&i.politeness?i.politeness:"polite"),null==o&&i&&(o=i.duration),this._liveElement.setAttribute("aria-live",s),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(l=>this._currentResolve=l)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,"number"==typeof o&&(this._previousTimeout=setTimeout(()=>this.clear(),o)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",r=this._document.getElementsByClassName(e),i=this._document.createElement("div");for(let s=0;s<r.length;s++)r[s].remove();return i.classList.add(e),i.classList.add("cdk-visually-hidden"),i.setAttribute("aria-atomic","true"),i.setAttribute("aria-live","polite"),this._document.body.appendChild(i),i}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(QEe,8),a.LFG(a.R0b),a.LFG(Nt),a.LFG(JEe,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const eDe=new a.OlP("cdk-focus-monitor-default-options"),JL=Tb({passive:!0,capture:!0});let Xc=(()=>{class n{constructor(e,r,i,s,o){this._ngZone=e,this._platform=r,this._inputModalityDetector=i,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Xt.x,this._rootNodeFocusAndBlurListener=l=>{for(let u=Eb(l);u;u=u.parentElement)"focus"===l.type?this._onFocus(l,u):this._onBlur(l,u)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(e,r=!1){const i=lp(e);if(!this._platform.isBrowser||1!==i.nodeType)return St(null);const s=Fie(i)||this._getDocument(),o=this._elementInfo.get(i);if(o)return r&&(o.checkChildren=!0),o.subject;const l={checkChildren:r,subject:new Xt.x,rootNode:s};return this._elementInfo.set(i,l),this._registerGlobalListeners(l),l.subject}stopMonitoring(e){const r=lp(e),i=this._elementInfo.get(r);i&&(i.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(i))}focusVia(e,r,i){const s=lp(e);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([l,c])=>this._originChanged(l,r,c)):(this._setOrigin(r),"function"==typeof s.focus&&s.focus(i))}ngOnDestroy(){this._elementInfo.forEach((e,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,r){e.classList.toggle("cdk-focused",!!r),e.classList.toggle("cdk-touch-focused","touch"===r),e.classList.toggle("cdk-keyboard-focused","keyboard"===r),e.classList.toggle("cdk-mouse-focused","mouse"===r),e.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(e,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&r,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,r){const i=this._elementInfo.get(r),s=Eb(e);!i||!i.checkChildren&&r!==s||this._originChanged(r,this._getFocusOrigin(s),i)}_onBlur(e,r){const i=this._elementInfo.get(r);!i||i.checkChildren&&e.relatedTarget instanceof Node&&r.contains(e.relatedTarget)||(this._setClasses(r),this._emitOrigin(i,null))}_emitOrigin(e,r){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(r))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const r=e.rootNode,i=this._rootNodeFocusListenerCount.get(r)||0;i||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,JL),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,JL)}),this._rootNodeFocusListenerCount.set(r,i+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ur(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(e){const r=e.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const i=this._rootNodeFocusListenerCount.get(r);i>1?this._rootNodeFocusListenerCount.set(r,i-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,JL),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,JL),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,r,i){this._setClasses(e,r),this._emitOrigin(i,r),this._lastFocusOrigin=r}_getClosestElementsInfo(e){const r=[];return this._elementInfo.forEach((i,s)=>{(s===e||i.checkChildren&&s.contains(e))&&r.push([s,i])}),r}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:r,mostRecentModality:i}=this._inputModalityDetector;if("mouse"!==i||!r||r===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const s=e.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(r))return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.R0b),a.LFG(Oi),a.LFG(KEe),a.LFG(Nt,8),a.LFG(eDe,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Yie=(()=>{class n{constructor(e,r){this._elementRef=e,this._focusMonitor=r,this._focusOrigin=null,this.cdkFocusChange=new a.vpe}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,1===e.nodeType&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(r=>{this._focusOrigin=r,this.cdkFocusChange.emit(r)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Xc))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]}),n})();const Kie="cdk-high-contrast-black-on-white",Qie="cdk-high-contrast-white-on-black",dq="cdk-high-contrast-active";let Xie=(()=>{class n{constructor(e,r){this._platform=e,this._document=r,this._breakpointSubscription=(0,a.f3M)(ZL).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(e):null,s=(i&&i.backgroundColor||"").replace(/ /g,"");switch(e.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(dq,Kie,Qie),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?e.add(dq,Kie):2===r&&e.add(dq,Qie)}}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Oi),a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),e$=(()=>{class n{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Xie))},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[qL]}),n})();const tDe=new a.OlP("cdk-dir-doc",{providedIn:"root",factory:function nDe(){return(0,a.f3M)(Nt)}}),rDe=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Ws=(()=>{class n{constructor(e){if(this.value="ltr",this.change=new a.vpe,e){const i=e.documentElement?e.documentElement.dir:null;this.value=function iDe(n){const t=n?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?rDe.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||i||"ltr")}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(tDe,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),a1=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})();function sDe(n,t){if(1&n&&a._UZ(0,"mat-pseudo-checkbox",4),2&n){const e=a.oxw();a.Q6J("state",e.selected?"checked":"unchecked")("disabled",e.disabled)}}function oDe(n,t){if(1&n&&(a.TgZ(0,"span",5),a._uU(1),a.qZA()),2&n){const e=a.oxw();a.xp6(1),a.hij("(",e.group.label,")")}}const aDe=["*"],cDe=new a.OlP("mat-sanity-checks",{providedIn:"root",factory:function lDe(){return!0}});let $n=(()=>{class n{constructor(e,r,i){this._sanityChecks=r,this._document=i,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!nq()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Xie),a.LFG(cDe,8),a.LFG(Nt))},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[a1,a1]}),n})();function NI(n){return class extends n{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=xn(t)}}}function cp(n,t){return class extends n{constructor(...e){super(...e),this.defaultColor=t,this.color=t}get color(){return this._color}set color(e){const r=e||this.defaultColor;r!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),r&&this._elementRef.nativeElement.classList.add(`mat-${r}`),this._color=r)}}}function RI(n){return class extends n{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=xn(t)}}}function t$(n,t=0){return class extends n{constructor(...e){super(...e),this._tabIndex=t,this.defaultTabIndex=t}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?ga(e):this.defaultTabIndex}}}function tse(n){return class extends n{constructor(...t){super(...t),this.errorState=!1}updateErrorState(){const t=this.errorState,s=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);s!==t&&(this.errorState=s,this.stateChanges.next())}}}const nse=new a.OlP("MAT_DATE_LOCALE",{providedIn:"root",factory:function uDe(){return(0,a.f3M)(a.soG)}});class Yo{constructor(){this._localeChanges=new Xt.x,this.localeChanges=this._localeChanges}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let r=this.isValid(t),i=this.isValid(e);return r&&i?!this.compareDate(t,e):r==i}return t==e}clampDate(t,e,r){return e&&this.compareDate(t,e)<0?e:r&&this.compareDate(t,r)>0?r:t}}const kb=new a.OlP("mat-date-formats"),dDe=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function hq(n,t){const e=Array(n);for(let r=0;r<n;r++)e[r]=t(r);return e}let hDe=(()=>{class n extends Yo{constructor(e,r){super(),this.useUtcForDisplay=!1,super.setLocale(e)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){const r=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return hq(12,i=>this._format(r,new Date(2017,i,1)))}getDateNames(){const e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return hq(31,r=>this._format(e,new Date(2017,0,r+1)))}getDayOfWeekNames(e){const r=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return hq(7,i=>this._format(r,new Date(2017,0,i+1)))}getYearName(e){const r=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(r,e)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,r,i){let s=this._createDateWithOverflow(e,r,i);return s.getMonth(),s}today(){return new Date}parse(e,r){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}format(e,r){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");const i=new Intl.DateTimeFormat(this.locale,{...r,timeZone:"utc"});return this._format(i,e)}addCalendarYears(e,r){return this.addCalendarMonths(e,12*r)}addCalendarMonths(e,r){let i=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+r,this.getDate(e));return this.getMonth(i)!=((this.getMonth(e)+r)%12+12)%12&&(i=this._createDateWithOverflow(this.getYear(i),this.getMonth(i),0)),i}addCalendarDays(e,r){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+r)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if("string"==typeof e){if(!e)return null;if(dDe.test(e)){let r=new Date(e);if(this.isValid(r))return r}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(e,r,i){const s=new Date;return s.setFullYear(e,r,i),s.setHours(0,0,0,0),s}_2digit(e){return("00"+e).slice(-2)}_format(e,r){const i=new Date;return i.setUTCFullYear(r.getFullYear(),r.getMonth(),r.getDate()),i.setUTCHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),e.format(i)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(nse,8),a.LFG(Oi))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const fDe={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let pDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[{provide:Yo,useClass:hDe}]}),n})(),mDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[{provide:kb,useValue:fDe}],imports:[pDe]}),n})(),gDe=(()=>{class n{isErrorState(e,r){return!!(e&&e.invalid&&(e.dirty||r&&r.submitted))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),n$=(()=>{class n{isErrorState(e,r){return!!(e&&e.invalid&&(e.touched||r&&r.submitted))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rse=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[$n,$n]}),n})();class _De{constructor(t,e,r,i=!1){this._renderer=t,this.element=e,this.config=r,this._animationForciblyDisabledThroughCss=i,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const ise={enterDuration:225,exitDuration:150},fq=Tb({passive:!0}),sse=["mousedown","touchstart"],ose=["mouseup","mouseleave","touchend","touchcancel"];class vDe{constructor(t,e,r,i){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=lp(r))}fadeInRipple(t,e,r={}){const i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...ise,...r.animation};r.centered&&(t=i.left+i.width/2,e=i.top+i.height/2);const o=r.radius||function bDe(n,t,e){const r=Math.max(Math.abs(n-e.left),Math.abs(n-e.right)),i=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(r*r+i*i)}(t,e,i),l=t-i.left,c=e-i.top,u=s.enterDuration,f=document.createElement("div");f.classList.add("mat-ripple-element"),f.style.left=l-o+"px",f.style.top=c-o+"px",f.style.height=2*o+"px",f.style.width=2*o+"px",null!=r.color&&(f.style.backgroundColor=r.color),f.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(f);const m=window.getComputedStyle(f),y=m.transitionDuration,w="none"===m.transitionProperty||"0s"===y||"0s, 0s"===y,T=new _De(this,f,r,w);f.style.transform="scale3d(1, 1, 1)",T.state=0,r.persistent||(this._mostRecentTransientRipple=T);let I=null;return!w&&(u||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const E=()=>this._finishRippleTransition(T),A=()=>this._destroyRipple(T);f.addEventListener("transitionend",E),f.addEventListener("transitioncancel",A),I={onTransitionEnd:E,onTransitionCancel:A}}),this._activeRipples.set(T,I),(w||!u)&&this._finishRippleTransition(T),T}fadeOutRipple(t){if(2===t.state||3===t.state)return;const e=t.element,r={...ise,...t.config.animation};e.style.transitionDuration=`${r.exitDuration}ms`,e.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=lp(t);!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(sse))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(ose),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:r}=t.config;t.state=1,!r&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=lq(t),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!r&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!cq(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let r=0;r<e.length;r++)this.fadeInRipple(e[r].clientX,e[r].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(e=>{this._triggerElement.addEventListener(e,this,fq)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(sse.forEach(t=>{this._triggerElement.removeEventListener(t,this,fq)}),this._pointerUpEventsRegistered&&ose.forEach(t=>{this._triggerElement.removeEventListener(t,this,fq)}))}}const wDe=new a.OlP("mat-ripple-global-options");let fh=(()=>{class n{constructor(e,r,i,s,o){this._elementRef=e,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new vDe(this,r,e,i)}get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,r=0,i){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,r,{...this.rippleConfig,...i}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(Oi),a.Y36(wDe,8),a.Y36(a.QbO,8))},n.\u0275dir=a.lG2({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,r){2&e&&a.ekj("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),MI=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[$n,$n]}),n})(),CDe=(()=>{class n{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.QbO,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(e,r){2&e&&a.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===r.state)("mat-pseudo-checkbox-checked","checked"===r.state)("mat-pseudo-checkbox-disabled",r.disabled)("_mat-animation-noopable","NoopAnimations"===r._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(e,r){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}'],encapsulation:2,changeDetection:0}),n})(),xDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[$n]}),n})();const ase=new a.OlP("MAT_OPTION_PARENT_COMPONENT"),lse=new a.OlP("MatOptgroup");let IDe=0;class TDe{constructor(t,e=!1){this.source=t,this.isUserInput=e}}let SDe=(()=>{class n{constructor(e,r,i,s){this._element=e,this._changeDetectorRef=r,this._parent=i,this.group=s,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+IDe++,this.onSelectionChange=new a.vpe,this._stateChanges=new Xt.x}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=xn(e)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(e,r){const i=this._getHostElement();"function"==typeof i.focus&&i.focus(r)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!Il(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue=e,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new TDe(this,e))}}return n.\u0275fac=function(e){a.$Z()},n.\u0275dir=a.lG2({type:n,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),n})(),r$=(()=>{class n extends SDe{constructor(e,r,i,s){super(e,r,i,s)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(ase,8),a.Y36(lse,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(e,r){1&e&&a.NdJ("click",function(){return r._selectViaInteraction()})("keydown",function(s){return r._handleKeydown(s)}),2&e&&(a.Ikx("id",r.id),a.uIk("tabindex",r._getTabIndex())("aria-selected",r._getAriaSelected())("aria-disabled",r.disabled.toString()),a.ekj("mat-selected",r.selected)("mat-option-multiple",r.multiple)("mat-active",r.active)("mat-option-disabled",r.disabled))},exportAs:["matOption"],features:[a.qOj],ngContentSelectors:aDe,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(e,r){1&e&&(a.F$t(),a.YNc(0,sDe,1,2,"mat-pseudo-checkbox",0),a.TgZ(1,"span",1),a.Hsn(2),a.qZA(),a.YNc(3,oDe,2,1,"span",2),a._UZ(4,"div",3)),2&e&&(a.Q6J("ngIf",r.multiple),a.xp6(3),a.Q6J("ngIf",r.group&&r.group._inert),a.xp6(1),a.Q6J("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disabled||r.disableRipple))},dependencies:[fh,Ur,CDe],styles:['.mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.mat-option.mat-active::before{content:""}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{right:auto;left:16px}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}'],encapsulation:2,changeDetection:0}),n})();function cse(n,t,e){if(e.length){let r=t.toArray(),i=e.toArray(),s=0;for(let o=0;o<n+1;o++)r[o].group&&r[o].group===i[s]&&s++;return s}return 0}let use=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[MI,No,$n,xDe]}),n})();const dse=["mat-button",""],hse=["*"],ADe=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],NDe=cp(NI(RI(class{constructor(n){this._elementRef=n}})));let js=(()=>{class n extends NDe{constructor(e,r,i){super(e),this._focusMonitor=r,this._animationMode=i,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of ADe)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);e.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,r){e?this._focusMonitor.focusVia(this._getHostElement(),e,r):this._getHostElement().focus(r)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...e){return e.some(r=>this._getHostElement().hasAttribute(r))}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Xc),a.Y36(a.QbO,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(e,r){if(1&e&&a.Gf(fh,5),2&e){let i;a.iGM(i=a.CRH())&&(r.ripple=i.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(e,r){2&e&&(a.uIk("disabled",r.disabled||null),a.ekj("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-button-disabled",r.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[a.qOj],attrs:dse,ngContentSelectors:hse,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,r){1&e&&(a.F$t(),a.TgZ(0,"span",0),a.Hsn(1),a.qZA(),a._UZ(2,"span",1)(3,"span",2)),2&e&&(a.xp6(2),a.ekj("mat-button-ripple-round",r.isRoundButton||r.isIconButton),a.Q6J("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",r.isIconButton)("matRippleTrigger",r._getHostElement()))},dependencies:[fh],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),fse=(()=>{class n extends js{constructor(e,r,i,s){super(r,e,i),this._ngZone=s,this._haltDisabledEvents=o=>{this.disabled&&(o.preventDefault(),o.stopImmediatePropagation())}}ngAfterViewInit(){super.ngAfterViewInit(),this._ngZone?this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)}):this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)}ngOnDestroy(){super.ngOnDestroy(),this._elementRef.nativeElement.removeEventListener("click",this._haltDisabledEvents)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(Xc),a.Y36(a.SBq),a.Y36(a.QbO,8),a.Y36(a.R0b,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-icon-button",""],["a","mat-fab",""],["a","mat-mini-fab",""],["a","mat-stroked-button",""],["a","mat-flat-button",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:7,hostBindings:function(e,r){2&e&&(a.uIk("tabindex",r.disabled?-1:r.tabIndex)("disabled",r.disabled||null)("aria-disabled",r.disabled.toString()),a.ekj("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-button-disabled",r.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[a.qOj],attrs:dse,ngContentSelectors:hse,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,r){1&e&&(a.F$t(),a.TgZ(0,"span",0),a.Hsn(1),a.qZA(),a._UZ(2,"span",1)(3,"span",2)),2&e&&(a.xp6(2),a.ekj("mat-button-ripple-round",r.isRoundButton||r.isIconButton),a.Q6J("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",r.isIconButton)("matRippleTrigger",r._getHostElement()))},dependencies:[fh],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),pq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[MI,$n,$n]}),n})();const RDe=["*",[["mat-card-footer"]]],MDe=["*","mat-card-footer"],ODe=[[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],[["img"]],"*"],FDe=["mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","img","*"];let PDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-card-content"],["","mat-card-content",""],["","matCardContent",""]],hostAttrs:[1,"mat-card-content"]}),n})(),LDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-card-title"]}),n})(),$De=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-card-subtitle"]}),n})(),BDe=(()=>{class n{constructor(){this.align="start"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-card-actions"],hostVars:2,hostBindings:function(e,r){2&e&&a.ekj("mat-card-actions-align-end","end"===r.align)},inputs:{align:"align"},exportAs:["matCardActions"]}),n})(),VDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["","mat-card-lg-image",""],["","matCardImageLarge",""]],hostAttrs:[1,"mat-card-lg-image"]}),n})(),UDe=(()=>{class n{constructor(e){this._animationMode=e}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.QbO,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(e,r){2&e&&a.ekj("_mat-animation-noopable","NoopAnimations"===r._animationMode)},exportAs:["matCard"],ngContentSelectors:MDe,decls:2,vars:0,template:function(e,r){1&e&&(a.F$t(RDe),a.Hsn(0),a.Hsn(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}.mat-card._mat-animation-noopable{transition:none !important;animation:none !important}.mat-card>.mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card>.mat-divider-horizontal{left:auto;right:0}.mat-card>.mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card>.mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px;display:block;overflow:hidden}.mat-card-image img{width:100%}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],encapsulation:2,changeDetection:0}),n})(),zDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-card-title-group"]],hostAttrs:[1,"mat-card-title-group"],ngContentSelectors:FDe,decls:4,vars:0,template:function(e,r){1&e&&(a.F$t(ODe),a.TgZ(0,"div"),a.Hsn(1),a.qZA(),a.Hsn(2,1),a.Hsn(3,2))},encapsulation:2,changeDetection:0}),n})(),HDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[$n,$n]}),n})();const GDe=["input"],WDe=["label"],jDe=function(n){return{enterDuration:n}},qDe=["*"],ZDe=new a.OlP("mat-checkbox-default-options",{providedIn:"root",factory:pse});function pse(){return{color:"accent",clickAction:"check-indeterminate"}}let YDe=0;const mse=pse(),KDe={provide:Ha,useExisting:(0,a.Gpc)(()=>gse),multi:!0};class QDe{}const XDe=t$(cp(RI(NI(class{constructor(n){this._elementRef=n}}))));let JDe=(()=>{class n extends XDe{constructor(e,r,i,s,o,l,c){super(r),this._changeDetectorRef=i,this._ngZone=s,this._animationMode=l,this._options=c,this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new a.vpe,this.indeterminateChange=new a.vpe,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=0,this._controlValueAccessorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||mse,this.color=this.defaultColor=this._options.color||mse.color,this.tabIndex=parseInt(o)||0,this.id=this._uniqueId=`${e}${++YDe}`}get inputId(){return`${this.id||this._uniqueId}-input`}get required(){return this._required}set required(e){this._required=xn(e)}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(e){const r=xn(e);r!=this.checked&&(this._checked=r,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(e){const r=xn(e);r!==this.disabled&&(this._disabled=r,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(e){const r=e!=this._indeterminate;this._indeterminate=xn(e),r&&(this._transitionCheckState(this._indeterminate?3:this.checked?1:2),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(e){this.checked=!!e}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_getAriaChecked(){return this.checked?"true":this.indeterminate?"mixed":"false"}_transitionCheckState(e){let r=this._currentCheckState,i=this._getAnimationTargetElement();if(r!==e&&i&&(this._currentAnimationClass&&i.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(r,e),this._currentCheckState=e,this._currentAnimationClass.length>0)){i.classList.add(this._currentAnimationClass);const s=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{i.classList.remove(s)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const e=this._options?.clickAction;this.disabled||"noop"===e?!this.disabled&&"noop"===e&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==e&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?1:2),this._emitChangeEvent())}_onInteractionEvent(e){e.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(e,r){if("NoopAnimations"===this._animationMode)return"";switch(e){case 0:if(1===r)return this._animationClasses.uncheckedToChecked;if(3==r)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case 2:return 1===r?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case 1:return 2===r?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case 3:return 1===r?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(e){const r=this._inputElement;r&&(r.nativeElement.indeterminate=e)}}return n.\u0275fac=function(e){a.$Z()},n.\u0275dir=a.lG2({type:n,viewQuery:function(e,r){if(1&e&&(a.Gf(GDe,5),a.Gf(WDe,5),a.Gf(fh,5)),2&e){let i;a.iGM(i=a.CRH())&&(r._inputElement=i.first),a.iGM(i=a.CRH())&&(r._labelElement=i.first),a.iGM(i=a.CRH())&&(r.ripple=i.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],id:"id",required:"required",labelPosition:"labelPosition",name:"name",value:"value",checked:"checked",disabled:"disabled",indeterminate:"indeterminate"},outputs:{change:"change",indeterminateChange:"indeterminateChange"},features:[a.qOj]}),n})(),gse=(()=>{class n extends JDe{constructor(e,r,i,s,o,l,c){super("mat-checkbox-",e,r,s,o,l,c),this._focusMonitor=i,this._animationClasses={uncheckedToChecked:"mat-checkbox-anim-unchecked-checked",uncheckedToIndeterminate:"mat-checkbox-anim-unchecked-indeterminate",checkedToUnchecked:"mat-checkbox-anim-checked-unchecked",checkedToIndeterminate:"mat-checkbox-anim-checked-indeterminate",indeterminateToChecked:"mat-checkbox-anim-indeterminate-checked",indeterminateToUnchecked:"mat-checkbox-anim-indeterminate-unchecked"}}_createChangeEvent(e){const r=new QDe;return r.source=this,r.checked=e,r}_getAnimationTargetElement(){return this._elementRef.nativeElement}ngAfterViewInit(){super.ngAfterViewInit(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{e||this._onBlur()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onInputClick(e){e.stopPropagation(),super._handleInputClick()}focus(e,r){e?this._focusMonitor.focusVia(this._inputElement,e,r):this._inputElement.nativeElement.focus(r)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(Xc),a.Y36(a.R0b),a.$8M("tabindex"),a.Y36(a.QbO,8),a.Y36(ZDe,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-checkbox"]],hostAttrs:[1,"mat-checkbox"],hostVars:14,hostBindings:function(e,r){2&e&&(a.Ikx("id",r.id),a.uIk("tabindex",null)("aria-label",null)("aria-labelledby",null),a.ekj("mat-checkbox-indeterminate",r.indeterminate)("mat-checkbox-checked",r.checked)("mat-checkbox-disabled",r.disabled)("mat-checkbox-label-before","before"==r.labelPosition)("_mat-animation-noopable","NoopAnimations"===r._animationMode))},inputs:{disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matCheckbox"],features:[a._Bn([KDe]),a.qOj],ngContentSelectors:qDe,decls:17,vars:21,consts:[[1,"mat-checkbox-layout"],["label",""],[1,"mat-checkbox-inner-container"],["type","checkbox",1,"mat-checkbox-input","cdk-visually-hidden",3,"id","required","checked","disabled","tabIndex","change","click"],["input",""],["matRipple","",1,"mat-checkbox-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleRadius","matRippleCentered","matRippleAnimation"],[1,"mat-ripple-element","mat-checkbox-persistent-ripple"],[1,"mat-checkbox-frame"],[1,"mat-checkbox-background"],["version","1.1","focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mat-checkbox-checkmark"],["fill","none","stroke","white","d","M4.1,12.7 9,17.6 20.3,6.3",1,"mat-checkbox-checkmark-path"],[1,"mat-checkbox-mixedmark"],[1,"mat-checkbox-label",3,"cdkObserveContent"],["checkboxLabel",""],[2,"display","none"]],template:function(e,r){if(1&e&&(a.F$t(),a.TgZ(0,"label",0,1)(2,"span",2)(3,"input",3,4),a.NdJ("change",function(s){return r._onInteractionEvent(s)})("click",function(s){return r._onInputClick(s)}),a.qZA(),a.TgZ(5,"span",5),a._UZ(6,"span",6),a.qZA(),a._UZ(7,"span",7),a.TgZ(8,"span",8),a.O4$(),a.TgZ(9,"svg",9),a._UZ(10,"path",10),a.qZA(),a.kcU(),a._UZ(11,"span",11),a.qZA()(),a.TgZ(12,"span",12,13),a.NdJ("cdkObserveContent",function(){return r._onLabelTextChange()}),a.TgZ(14,"span",14),a._uU(15,"\xa0"),a.qZA(),a.Hsn(16),a.qZA()()),2&e){const i=a.MAs(1),s=a.MAs(13);a.uIk("for",r.inputId),a.xp6(2),a.ekj("mat-checkbox-inner-container-no-side-margin",!s.textContent||!s.textContent.trim()),a.xp6(1),a.Q6J("id",r.inputId)("required",r.required)("checked",r.checked)("disabled",r.disabled)("tabIndex",r.tabIndex),a.uIk("value",r.value)("name",r.name)("aria-label",r.ariaLabel||null)("aria-labelledby",r.ariaLabelledby)("aria-checked",r._getAriaChecked())("aria-describedby",r.ariaDescribedby),a.xp6(2),a.Q6J("matRippleTrigger",i)("matRippleDisabled",r._isRippleDisabled())("matRippleRadius",20)("matRippleCentered",!0)("matRippleAnimation",a.VKq(19,jDe,"NoopAnimations"===r._animationMode?0:150))}},dependencies:[fh,iq],styles:['@keyframes mat-checkbox-fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes mat-checkbox-fade-out-background{0%,50%{opacity:1}100%{opacity:0}}@keyframes mat-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:22.910259}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1)}100%{stroke-dashoffset:0}}@keyframes mat-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mat-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);stroke-dashoffset:0}to{stroke-dashoffset:-22.910259}}@keyframes mat-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(45deg)}}@keyframes mat-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes mat-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0deg)}}@keyframes mat-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(315deg)}}@keyframes mat-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}32.8%,100%{opacity:0;transform:scaleX(0)}}.mat-checkbox-background,.mat-checkbox-frame{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:2px;box-sizing:border-box;pointer-events:none}.mat-checkbox{display:inline-block;transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative}.mat-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-checkbox .mat-ripple-element:not(.mat-checkbox-persistent-ripple){opacity:.16}.mat-checkbox .mat-checkbox-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-checkbox-layout{-webkit-user-select:none;user-select:none;cursor:inherit;align-items:baseline;vertical-align:middle;display:inline-flex;white-space:nowrap}.mat-checkbox-label{-webkit-user-select:auto;user-select:auto}.mat-checkbox-inner-container{display:inline-block;height:16px;line-height:0;margin:auto;margin-right:8px;order:0;position:relative;vertical-align:middle;white-space:nowrap;width:16px;flex-shrink:0}[dir=rtl] .mat-checkbox-inner-container{margin-left:8px;margin-right:auto}.mat-checkbox-inner-container-no-side-margin{margin-left:0;margin-right:0}.mat-checkbox-frame{background-color:rgba(0,0,0,0);transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1);border-width:2px;border-style:solid}._mat-animation-noopable .mat-checkbox-frame{transition:none}.mat-checkbox-background{align-items:center;display:inline-flex;justify-content:center;transition:background-color 90ms cubic-bezier(0, 0, 0.2, 0.1),opacity 90ms cubic-bezier(0, 0, 0.2, 0.1);-webkit-print-color-adjust:exact;color-adjust:exact}._mat-animation-noopable .mat-checkbox-background{transition:none}.cdk-high-contrast-active .mat-checkbox .mat-checkbox-background{background:none}.mat-checkbox-persistent-ripple{display:block;width:100%;height:100%;transform:none}.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:.04}.mat-checkbox.cdk-keyboard-focused .mat-checkbox-persistent-ripple{opacity:.12}.mat-checkbox-persistent-ripple,.mat-checkbox.mat-checkbox-disabled .mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:0}@media(hover: none){.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{display:none}}.mat-checkbox-checkmark{top:0;left:0;right:0;bottom:0;position:absolute;width:100%}.mat-checkbox-checkmark-path{stroke-dashoffset:22.910259;stroke-dasharray:22.910259;stroke-width:2.1333333333px}.cdk-high-contrast-black-on-white .mat-checkbox-checkmark-path{stroke:#000 !important}.mat-checkbox-mixedmark{width:calc(100% - 6px);height:2px;opacity:0;transform:scaleX(0) rotate(0deg);border-radius:2px}.cdk-high-contrast-active .mat-checkbox-mixedmark{height:0;border-top:solid 2px;margin-top:2px}.mat-checkbox-label-before .mat-checkbox-inner-container{order:1;margin-left:8px;margin-right:auto}[dir=rtl] .mat-checkbox-label-before .mat-checkbox-inner-container{margin-left:auto;margin-right:8px}.mat-checkbox-checked .mat-checkbox-checkmark{opacity:1}.mat-checkbox-checked .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-checked .mat-checkbox-mixedmark{transform:scaleX(1) rotate(-45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark{opacity:0;transform:rotate(45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-indeterminate .mat-checkbox-mixedmark{opacity:1;transform:scaleX(1) rotate(0deg)}.mat-checkbox-unchecked .mat-checkbox-background{background-color:rgba(0,0,0,0)}.mat-checkbox-disabled{cursor:default}.cdk-high-contrast-active .mat-checkbox-disabled{opacity:.5}.mat-checkbox-anim-unchecked-checked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-checked .mat-checkbox-checkmark-path{animation:180ms linear 0ms mat-checkbox-unchecked-checked-checkmark-path}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-unchecked-indeterminate-mixedmark}.mat-checkbox-anim-checked-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-checked-unchecked .mat-checkbox-checkmark-path{animation:90ms linear 0ms mat-checkbox-checked-unchecked-checkmark-path}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-checkmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-checkmark}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-mixedmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-checkmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-checkmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-mixedmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-mixedmark}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-mixedmark{animation:300ms linear 0ms mat-checkbox-indeterminate-unchecked-mixedmark}.mat-checkbox-input{bottom:0;left:50%}.mat-checkbox-input:focus~.mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})(),_se=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})(),nke=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[MI,$n,qL,_se,$n,_se]}),n})();var rke=z(1144);const ike=["addListener","removeListener"],ske=["addEventListener","removeEventListener"],oke=["on","off"];function Wg(n,t,e,r){if((0,Po.m)(e)&&(r=e,e=void 0),r)return Wg(n,t,e).pipe(LS(r));const[i,s]=function cke(n){return(0,Po.m)(n.addEventListener)&&(0,Po.m)(n.removeEventListener)}(n)?ske.map(o=>l=>n[o](t,l,e)):function ake(n){return(0,Po.m)(n.addListener)&&(0,Po.m)(n.removeListener)}(n)?ike.map(yse(n,t)):function lke(n){return(0,Po.m)(n.on)&&(0,Po.m)(n.off)}(n)?oke.map(yse(n,t)):[];if(!i&&(0,rke.z)(n))return(0,Cs.z)(o=>Wg(o,t,e))((0,Ru.Xf)(n));if(!i)throw new TypeError("Invalid event target");return new Cr.y(o=>{const l=(...c)=>o.next(1<c.length?c:c[0]);return i(l),()=>s(l)})}function yse(n,t){return e=>r=>n[e](t,r)}const c1={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:r}=c1;r&&(t=r.requestAnimationFrame,e=r.cancelAnimationFrame);const i=t(s=>{e=void 0,n(s)});return new kn.w0(()=>e?.(i))},requestAnimationFrame(...n){const{delegate:t}=c1;return(t?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=c1;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};new class dke extends bv{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let i;t=t||r.shift();do{if(i=t.execute(t.state,t.delay))break}while((t=r[0])&&t.id===e&&r.shift());if(this._active=!1,i){for(;(t=r[0])&&t.id===e&&r.shift();)t.unsubscribe();throw i}}}(class uke extends _C{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,r=0){return null!==r&&r>0?super.requestAsyncId(t,e,r):(t.actions.push(this),t._scheduled||(t._scheduled=c1.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,r=0){var i;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(t,e,r);const{actions:s}=t;null!=e&&(null===(i=s[s.length-1])||void 0===i?void 0:i.id)!==e&&(c1.cancelAnimationFrame(e),t._scheduled=void 0)}});let mq,fke=1;const i$={};function vse(n){return n in i$&&(delete i$[n],!0)}const pke={setImmediate(n){const t=fke++;return i$[t]=!0,mq||(mq=Promise.resolve()),mq.then(()=>vse(t)&&n()),t},clearImmediate(n){vse(n)}},{setImmediate:mke,clearImmediate:gke}=pke,s$={setImmediate(...n){const{delegate:t}=s$;return(t?.setImmediate||mke)(...n)},clearImmediate(n){const{delegate:t}=s$;return(t?.clearImmediate||gke)(n)},delegate:void 0},gq=new class yke extends bv{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let i;t=t||r.shift();do{if(i=t.execute(t.state,t.delay))break}while((t=r[0])&&t.id===e&&r.shift());if(this._active=!1,i){for(;(t=r[0])&&t.id===e&&r.shift();)t.unsubscribe();throw i}}}(class _ke extends _C{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,r=0){return null!==r&&r>0?super.requestAsyncId(t,e,r):(t.actions.push(this),t._scheduled||(t._scheduled=s$.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,r=0){var i;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(t,e,r);const{actions:s}=t;null!=e&&(null===(i=s[s.length-1])||void 0===i?void 0:i.id)!==e&&(s$.clearImmediate(e),t._scheduled=void 0)}});var bke=z(3532);function o$(n=0,t,e=bE){let r=-1;return null!=t&&((0,bke.K)(t)?e=t:r=t),new Cr.y(i=>{let s=function wke(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;s<0&&(s=0);let o=0;return e.schedule(function(){i.closed||(i.next(o++),0<=r?this.schedule(void 0,r):i.complete())},s)})}function bse(n,t=Fc){return function vke(n){return(0,ti.e)((t,e)=>{let r=!1,i=null,s=null,o=!1;const l=()=>{if(s?.unsubscribe(),s=null,r){r=!1;const u=i;i=null,e.next(u)}o&&e.complete()},c=()=>{s=null,o&&e.complete()};t.subscribe((0,zr.x)(e,u=>{r=!0,i=u,s||(0,Ru.Xf)(n(u)).subscribe(s=(0,zr.x)(e,l,c))},()=>{o=!0,(!r||!s||s.closed)&&e.complete()}))})}(()=>o$(n,t))}let wse=(()=>{class n{constructor(e,r,i){this._ngZone=e,this._platform=r,this._scrolled=new Xt.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const r=this.scrollContainers.get(e);r&&(r.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Cr.y(r=>{this._globalSubscription||this._addGlobalListener();const i=e>0?this._scrolled.pipe(bse(e)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):St()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(e,r){const i=this.getAncestorScrollContainers(e);return this.scrolled(r).pipe(cr(s=>!s||i.indexOf(s)>-1))}getAncestorScrollContainers(e){const r=[];return this.scrollContainers.forEach((i,s)=>{this._scrollableContainsElement(s,e)&&r.push(s)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,r){let i=lp(r),s=e.getElementRef().nativeElement;do{if(i==s)return!0}while(i=i.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Wg(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.R0b),a.LFG(Oi),a.LFG(Nt,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),jg=(()=>{class n{constructor(e,r,i){this._platform=e,this._change=new Xt.x,this._changeListener=s=>{this._change.next(s)},this._document=i,r.runOutsideAngular(()=>{if(e.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,r=this._getWindow(),i=e.documentElement,s=i.getBoundingClientRect();return{top:-s.top||e.body.scrollTop||r.scrollY||i.scrollTop||0,left:-s.left||e.body.scrollLeft||r.scrollX||i.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(bse(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Oi),a.LFG(a.R0b),a.LFG(Nt,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),OI=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})(),_q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[a1,OI,a1,OI]}),n})();class yq{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class qg extends yq{constructor(t,e,r,i){super(),this.component=t,this.viewContainerRef=e,this.injector=r,this.componentFactoryResolver=i}}class Ab extends yq{constructor(t,e,r,i){super(),this.templateRef=t,this.viewContainerRef=e,this.context=r,this.injector=i}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Ike extends yq{constructor(t){super(),this.element=t instanceof a.SBq?t.nativeElement:t}}class a${constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof qg?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof Ab?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Ike?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Tke extends a${constructor(t,e,r,i,s){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=r,this._defaultInjector=i,this.attachDomPortal=o=>{const l=o.element,c=this._document.createComment("dom-portal");l.parentNode.insertBefore(c,l),this.outletElement.appendChild(l),this._attachedPortal=o,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(l,c)})},this._document=s}attachComponentPortal(t){const r=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let i;return t.viewContainerRef?(i=t.viewContainerRef.createComponent(r,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>i.destroy())):(i=r.create(t.injector||this._defaultInjector||a.zs3.NULL),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(i.hostView),i.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=t,i}attachTemplatePortal(t){let e=t.viewContainerRef,r=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=e.indexOf(r);-1!==i&&e.remove(i)}),this._attachedPortal=t,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let ed=(()=>{class n extends a${constructor(e,r,i){super(),this._componentFactoryResolver=e,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new a.vpe,this.attachDomPortal=s=>{const o=s.element,l=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(l,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(o,l)})},this._document=i}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(e){e.setAttachedHost(this);const r=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,s=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),o=r.createComponent(s,r.length,e.injector||r.injector);return r!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=e,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(e){e.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a._Vd),a.Y36(a.s_b),a.Y36(Nt))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[a.qOj]}),n})(),Zg=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})();function Cse(n,t=!1){return(0,ti.e)((e,r)=>{let i=0;e.subscribe((0,zr.x)(r,s=>{const o=n(s,i++);(o||t)&&r.next(s),!o&&r.complete()}))})}const xse=fEe();class Ske{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Es(-this._previousScrollPosition.left),t.style.top=Es(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,r=t.style,i=this._document.body.style,s=r.scrollBehavior||"",o=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),xse&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),xse&&(r.scrollBehavior=s,i.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,r=this._viewportRuler.getViewportSize();return e.scrollHeight>r.height||e.scrollWidth>r.width}}class Eke{constructor(t,e,r,i){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=r,this._config=i,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Ise{enable(){}disable(){}attach(){}}function vq(n,t){return t.some(e=>n.bottom<e.top||n.top>e.bottom||n.right<e.left||n.left>e.right)}function Tse(n,t){return t.some(e=>n.top<e.top||n.bottom>e.bottom||n.left<e.left||n.right>e.right)}class Dke{constructor(t,e,r,i){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=r,this._config=i,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();vq(e,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let kke=(()=>{class n{constructor(e,r,i,s){this._scrollDispatcher=e,this._viewportRuler=r,this._ngZone=i,this.noop=()=>new Ise,this.close=o=>new Eke(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new Ske(this._viewportRuler,this._document),this.reposition=o=>new Dke(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(wse),a.LFG(jg),a.LFG(a.R0b),a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class FI{constructor(t){if(this.scrollStrategy=new Ise,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const r of e)void 0!==t[r]&&(this[r]=t[r])}}}class Ake{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let Sse=(()=>{class n{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const r=this._attachedOverlays.indexOf(e);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Nke=(()=>{class n extends Sse{constructor(e,r){super(e),this._ngZone=r,this._keydownListener=i=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const l=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>l.next(i)):l.next(i);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt),a.LFG(a.R0b,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Rke=(()=>{class n extends Sse{constructor(e,r,i){super(e),this._platform=r,this._ngZone=i,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Eb(s)},this._clickListener=s=>{const o=Eb(s),l="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const c=this._attachedOverlays.slice();for(let u=c.length-1;u>-1;u--){const f=c[u];if(f._outsidePointerEvents.observers.length<1||!f.hasAttached())continue;if(f.overlayElement.contains(o)||f.overlayElement.contains(l))break;const m=f._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>m.next(s)):m.next(s)}}}add(e){if(super.add(e),!this._isAttached){const r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt),a.LFG(Oi),a.LFG(a.R0b,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),l$=(()=>{class n{constructor(e,r){this._platform=r,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||nq()){const i=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let s=0;s<i.length;s++)i[s].remove()}const r=this._document.createElement("div");r.classList.add(e),nq()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Nt),a.LFG(Oi))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class u1{constructor(t,e,r,i,s,o,l,c,u,f=!1){this._portalOutlet=t,this._host=e,this._pane=r,this._config=i,this._ngZone=s,this._keyboardDispatcher=o,this._document=l,this._location=c,this._outsideClickDispatcher=u,this._animationsDisabled=f,this._backdropElement=null,this._backdropClick=new Xt.x,this._attachments=new Xt.x,this._detachments=new Xt.x,this._locationChanges=kn.w0.EMPTY,this._backdropClickHandler=m=>this._backdropClick.next(m),this._backdropTransitionendHandler=m=>{this._disposeBackdrop(m.target)},this._keydownEvents=new Xt.x,this._outsidePointerEvents=new Xt.x,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(nr(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=Es(this._config.width),t.height=Es(this._config.height),t.minWidth=Es(this._config.minWidth),t.minHeight=Es(this._config.minHeight),t.maxWidth=Es(this._config.maxWidth),t.maxHeight=Es(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,e,r){const i=jL(e||[]).filter(s=>!!s);i.length&&(r?t.classList.add(...i):t.classList.remove(...i))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(ur((0,cs.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Ese="cdk-overlay-connected-position-bounding-box",Mke=/([A-Za-z%]+)$/;class Dse{constructor(t,e,r,i,s){this._viewportRuler=e,this._document=r,this._platform=i,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Xt.x,this._resizeSubscription=kn.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){this._validatePositions(),t.hostElement.classList.add(Ese),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,r=this._viewportRect,i=this._containerRect,s=[];let o;for(let l of this._preferredPositions){let c=this._getOriginPoint(t,i,l),u=this._getOverlayPoint(c,e,l),f=this._getOverlayFit(u,e,r,l);if(f.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(l,c);this._canFitWithFlexibleDimensions(f,u,r)?s.push({position:l,origin:c,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(c,l)}):(!o||o.overlayFit.visibleArea<f.visibleArea)&&(o={overlayFit:f,overlayPoint:u,originPoint:c,position:l,overlayRect:e})}if(s.length){let l=null,c=-1;for(const u of s){const f=u.boundingBoxRect.width*u.boundingBoxRect.height*(u.position.weight||1);f>c&&(c=f,l=u)}return this._isPushed=!1,void this._applyPosition(l.position,l.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Nb(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Ese),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,r){let i,s;if("center"==r.originX)i=t.left+t.width/2;else{const o=this._isRtl()?t.right:t.left,l=this._isRtl()?t.left:t.right;i="start"==r.originX?o:l}return e.left<0&&(i-=e.left),s="center"==r.originY?t.top+t.height/2:"top"==r.originY?t.top:t.bottom,e.top<0&&(s-=e.top),{x:i,y:s}}_getOverlayPoint(t,e,r){let i,s;return i="center"==r.overlayX?-e.width/2:"start"===r.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,s="center"==r.overlayY?-e.height/2:"top"==r.overlayY?0:-e.height,{x:t.x+i,y:t.y+s}}_getOverlayFit(t,e,r,i){const s=Ase(e);let{x:o,y:l}=t,c=this._getOffset(i,"x"),u=this._getOffset(i,"y");c&&(o+=c),u&&(l+=u);let _=0-l,y=l+s.height-r.height,w=this._subtractOverflows(s.width,0-o,o+s.width-r.width),T=this._subtractOverflows(s.height,_,y),I=w*T;return{visibleArea:I,isCompletelyWithinViewport:s.width*s.height===I,fitsInViewportVertically:T===s.height,fitsInViewportHorizontally:w==s.width}}_canFitWithFlexibleDimensions(t,e,r){if(this._hasFlexibleDimensions){const i=r.bottom-e.y,s=r.right-e.x,o=kse(this._overlayRef.getConfig().minHeight),l=kse(this._overlayRef.getConfig().minWidth),u=t.fitsInViewportHorizontally||null!=l&&l<=s;return(t.fitsInViewportVertically||null!=o&&o<=i)&&u}return!1}_pushOverlayOnScreen(t,e,r){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const i=Ase(e),s=this._viewportRect,o=Math.max(t.x+i.width-s.width,0),l=Math.max(t.y+i.height-s.height,0),c=Math.max(s.top-r.top-t.y,0),u=Math.max(s.left-r.left-t.x,0);let f=0,m=0;return f=i.width<=s.width?u||-o:t.x<this._viewportMargin?s.left-r.left-t.x:0,m=i.height<=s.height?c||-l:t.y<this._viewportMargin?s.top-r.top-t.y:0,this._previousPushAmount={x:f,y:m},{x:t.x+f,y:t.y+m}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const r=this._getScrollVisibility(),i=new Ake(t,r);this._positionChanges.next(i)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,i=t.overlayY;r="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let s=0;s<e.length;s++)e[s].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(t,e){const r=this._viewportRect,i=this._isRtl();let s,o,l,f,m,_;if("top"===e.overlayY)o=t.y,s=r.height-o+this._viewportMargin;else if("bottom"===e.overlayY)l=r.height-t.y+2*this._viewportMargin,s=r.height-l+this._viewportMargin;else{const y=Math.min(r.bottom-t.y+r.top,t.y),w=this._lastBoundingBoxSize.height;s=2*y,o=t.y-y,s>w&&!this._isInitialRender&&!this._growAfterOpen&&(o=t.y-w/2)}if("end"===e.overlayX&&!i||"start"===e.overlayX&&i)_=r.width-t.x+this._viewportMargin,f=t.x-this._viewportMargin;else if("start"===e.overlayX&&!i||"end"===e.overlayX&&i)m=t.x,f=r.right-t.x;else{const y=Math.min(r.right-t.x+r.left,t.x),w=this._lastBoundingBoxSize.width;f=2*y,m=t.x-y,f>w&&!this._isInitialRender&&!this._growAfterOpen&&(m=t.x-w/2)}return{top:o,left:m,bottom:l,right:_,width:f,height:s}}_setBoundingBoxStyles(t,e){const r=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right=i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;i.height=Es(r.height),i.top=Es(r.top),i.bottom=Es(r.bottom),i.width=Es(r.width),i.left=Es(r.left),i.right=Es(r.right),i.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",i.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",s&&(i.maxHeight=Es(s)),o&&(i.maxWidth=Es(o))}this._lastBoundingBoxSize=r,Nb(this._boundingBox.style,i)}_resetBoundingBoxStyles(){Nb(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Nb(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const r={},i=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(i){const f=this._viewportRuler.getViewportScrollPosition();Nb(r,this._getExactOverlayY(e,t,f)),Nb(r,this._getExactOverlayX(e,t,f))}else r.position="static";let l="",c=this._getOffset(e,"x"),u=this._getOffset(e,"y");c&&(l+=`translateX(${c}px) `),u&&(l+=`translateY(${u}px)`),r.transform=l.trim(),o.maxHeight&&(i?r.maxHeight=Es(o.maxHeight):s&&(r.maxHeight="")),o.maxWidth&&(i?r.maxWidth=Es(o.maxWidth):s&&(r.maxWidth="")),Nb(this._pane.style,r)}_getExactOverlayY(t,e,r){let i={top:"",bottom:""},s=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,r)),"bottom"===t.overlayY?i.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":i.top=Es(s.y),i}_getExactOverlayX(t,e,r){let o,i={left:"",right:""},s=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,r)),o=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===o?i.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":i.left=Es(s.x),i}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Tse(t,r),isOriginOutsideView:vq(t,r),isOverlayClipped:Tse(e,r),isOverlayOutsideView:vq(e,r)}}_subtractOverflows(t,...e){return e.reduce((r,i)=>r-Math.max(i,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+t-this._viewportMargin,bottom:r.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?t.offsetX??this._offsetX:t.offsetY??this._offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&jL(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof a.SBq)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,r=t.height||0;return{top:t.y,bottom:t.y+r,left:t.x,right:t.x+e,height:r,width:e}}}function Nb(n,t){for(let e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function kse(n){if("number"!=typeof n&&null!=n){const[t,e]=n.split(Mke);return e&&"px"!==e?null:parseFloat(t)}return n||null}function Ase(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const Nse="cdk-global-overlay-wrapper";class Oke{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(Nse),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:s,maxWidth:o,maxHeight:l}=r,c=!("100%"!==i&&"100vw"!==i||o&&"100%"!==o&&"100vw"!==o),u=!("100%"!==s&&"100vh"!==s||l&&"100%"!==l&&"100vh"!==l),f=this._xPosition,m=this._xOffset,_="rtl"===this._overlayRef.getConfig().direction;let y="",w="",T="";c?T="flex-start":"center"===f?(T="center",_?w=m:y=m):_?"left"===f||"end"===f?(T="flex-end",y=m):("right"===f||"start"===f)&&(T="flex-start",w=m):"left"===f||"start"===f?(T="flex-start",y=m):("right"===f||"end"===f)&&(T="flex-end",w=m),t.position=this._cssPosition,t.marginLeft=c?"0":y,t.marginTop=u?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=c?"0":w,e.justifyContent=T,e.alignItems=u?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,r=e.style;e.classList.remove(Nse),r.justifyContent=r.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let Fke=(()=>{class n{constructor(e,r,i,s){this._viewportRuler=e,this._document=r,this._platform=i,this._overlayContainer=s}global(){return new Oke}flexibleConnectedTo(e){return new Dse(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(jg),a.LFG(Nt),a.LFG(Oi),a.LFG(l$))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Pke=0,_a=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f,m,_,y){this.scrollStrategies=e,this._overlayContainer=r,this._componentFactoryResolver=i,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=l,this._ngZone=c,this._document=u,this._directionality=f,this._location=m,this._outsideClickDispatcher=_,this._animationsModuleType=y}create(e){const r=this._createHostElement(),i=this._createPaneElement(r),s=this._createPortalOutlet(i),o=new FI(e);return o.direction=o.direction||this._directionality.value,new u1(s,r,i,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(e){const r=this._document.createElement("div");return r.id="cdk-overlay-"+Pke++,r.classList.add("cdk-overlay-pane"),e.appendChild(r),r}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(a.z2F)),new Tke(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(kke),a.LFG(l$),a.LFG(a._Vd),a.LFG(Fke),a.LFG(Nke),a.LFG(a.zs3),a.LFG(a.R0b),a.LFG(Nt),a.LFG(Ws),a.LFG(_n),a.LFG(Rke),a.LFG(a.QbO,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const Lke=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],Rse=new a.OlP("cdk-connected-overlay-scroll-strategy");let Mse=(()=>{class n{constructor(e){this.elementRef=e}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),n})(),Ose=(()=>{class n{constructor(e,r,i,s,o){this._overlay=e,this._dir=o,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=kn.w0.EMPTY,this._attachSubscription=kn.w0.EMPTY,this._detachSubscription=kn.w0.EMPTY,this._positionSubscription=kn.w0.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new a.vpe,this.positionChange=new a.vpe,this.attach=new a.vpe,this.detach=new a.vpe,this.overlayKeydown=new a.vpe,this.overlayOutsideClick=new a.vpe,this._templatePortal=new Ab(r,i),this._scrollStrategyFactory=s,this.scrollStrategy=this._scrollStrategyFactory()}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=xn(e)}get lockPosition(){return this._lockPosition}set lockPosition(e){this._lockPosition=xn(e)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(e){this._flexibleDimensions=xn(e)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(e){this._growAfterOpen=xn(e)}get push(){return this._push}set push(e){this._push=xn(e)}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=Lke);const e=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=e.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=e.detachments().subscribe(()=>this.detach.emit()),e.keydownEvents().subscribe(r=>{this.overlayKeydown.next(r),27===r.keyCode&&!this.disableClose&&!Il(r)&&(r.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(r=>{this.overlayOutsideClick.next(r)})}_buildConfig(){const e=this._position=this.positionStrategy||this._createPositionStrategy(),r=new FI({direction:this._dir,positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(r.width=this.width),(this.height||0===this.height)&&(r.height=this.height),(this.minWidth||0===this.minWidth)&&(r.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(r.minHeight=this.minHeight),this.backdropClass&&(r.backdropClass=this.backdropClass),this.panelClass&&(r.panelClass=this.panelClass),r}_updatePositionStrategy(e){const r=this.positions.map(i=>({originX:i.originX,originY:i.originY,overlayX:i.overlayX,overlayY:i.overlayY,offsetX:i.offsetX||this.offsetX,offsetY:i.offsetY||this.offsetY,panelClass:i.panelClass||void 0}));return e.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(r).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const e=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(e),e}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof Mse?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(Cse(()=>this.positionChange.observers.length>0)).subscribe(e=>{this.positionChange.emit(e),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(_a),a.Y36(a.Rgc),a.Y36(a.s_b),a.Y36(Rse),a.Y36(Ws,8))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[a.TTD]}),n})();const Bke={provide:Rse,deps:[_a],useFactory:function $ke(n){return()=>n.scrollStrategies.reposition()}};let Rb=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[_a,Bke],imports:[a1,Zg,_q,_q]}),n})();const Vke=["connectionContainer"],Uke=["inputContainer"],zke=["label"];function Hke(n,t){1&n&&(a.ynx(0),a.TgZ(1,"div",14),a._UZ(2,"div",15)(3,"div",16)(4,"div",17),a.qZA(),a.TgZ(5,"div",18),a._UZ(6,"div",15)(7,"div",16)(8,"div",17),a.qZA(),a.BQk())}function Gke(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",19),a.NdJ("cdkObserveContent",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.updateOutlineGap())}),a.Hsn(1,1),a.qZA()}if(2&n){const e=a.oxw();a.Q6J("cdkObserveContentDisabled","outline"!=e.appearance)}}function Wke(n,t){if(1&n&&(a.ynx(0),a.Hsn(1,2),a.TgZ(2,"span"),a._uU(3),a.qZA(),a.BQk()),2&n){const e=a.oxw(2);a.xp6(3),a.Oqu(e._control.placeholder)}}function jke(n,t){1&n&&a.Hsn(0,3,["*ngSwitchCase","true"])}function qke(n,t){1&n&&(a.TgZ(0,"span",23),a._uU(1," *"),a.qZA())}function Zke(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"label",20,21),a.NdJ("cdkObserveContent",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.updateOutlineGap())}),a.YNc(2,Wke,4,1,"ng-container",12),a.YNc(3,jke,1,0,"ng-content",12),a.YNc(4,qke,2,0,"span",22),a.qZA()}if(2&n){const e=a.oxw();a.ekj("mat-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-form-field-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-accent","accent"==e.color)("mat-warn","warn"==e.color),a.Q6J("cdkObserveContentDisabled","outline"!=e.appearance)("id",e._labelId)("ngSwitch",e._hasLabel()),a.uIk("for",e._control.id)("aria-owns",e._control.id),a.xp6(2),a.Q6J("ngSwitchCase",!1),a.xp6(1),a.Q6J("ngSwitchCase",!0),a.xp6(1),a.Q6J("ngIf",!e.hideRequiredMarker&&e._control.required&&!e._control.disabled)}}function Yke(n,t){1&n&&(a.TgZ(0,"div",24),a.Hsn(1,4),a.qZA())}function Kke(n,t){if(1&n&&(a.TgZ(0,"div",25),a._UZ(1,"span",26),a.qZA()),2&n){const e=a.oxw();a.xp6(1),a.ekj("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)}}function Qke(n,t){if(1&n&&(a.TgZ(0,"div"),a.Hsn(1,5),a.qZA()),2&n){const e=a.oxw();a.Q6J("@transitionMessages",e._subscriptAnimationState)}}function Xke(n,t){if(1&n&&(a.TgZ(0,"div",30),a._uU(1),a.qZA()),2&n){const e=a.oxw(2);a.Q6J("id",e._hintLabelId),a.xp6(1),a.Oqu(e.hintLabel)}}function Jke(n,t){if(1&n&&(a.TgZ(0,"div",27),a.YNc(1,Xke,2,2,"div",28),a.Hsn(2,6),a._UZ(3,"div",29),a.Hsn(4,7),a.qZA()),2&n){const e=a.oxw();a.Q6J("@transitionMessages",e._subscriptAnimationState),a.xp6(1),a.Q6J("ngIf",e.hintLabel)}}const eAe=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],tAe=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"];let nAe=0;const Fse=new a.OlP("MatError");let d1=(()=>{class n{constructor(e,r){this.id="mat-error-"+nAe++,e||r.nativeElement.setAttribute("aria-live","polite")}}return n.\u0275fac=function(e){return new(e||n)(a.$8M("aria-live"),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["mat-error"]],hostAttrs:["aria-atomic","true",1,"mat-error"],hostVars:1,hostBindings:function(e,r){2&e&&a.uIk("id",r.id)},inputs:{id:"id"},features:[a._Bn([{provide:Fse,useExisting:n}])]}),n})();const rAe={transitionMessages:Bs("transitionMessages",[yi("enter",Sn({opacity:1,transform:"translateY(0%)"})),ei("void => enter",[Sn({opacity:0,transform:"translateY(-5px)"}),_i("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let c$=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n}),n})(),iAe=0;const Pse=new a.OlP("MatHint");let u$=(()=>{class n{constructor(){this.align="start",this.id="mat-hint-"+iAe++}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-hint"],hostVars:4,hostBindings:function(e,r){2&e&&(a.uIk("id",r.id)("align",null),a.ekj("mat-form-field-hint-end","end"===r.align))},inputs:{align:"align",id:"id"},features:[a._Bn([{provide:Pse,useExisting:n}])]}),n})(),Mb=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-label"]]}),n})(),sAe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-placeholder"]]}),n})();const Lse=new a.OlP("MatPrefix");let bq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["","matPrefix",""]],features:[a._Bn([{provide:Lse,useExisting:n}])]}),n})();const $se=new a.OlP("MatSuffix");let wq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["","matSuffix",""]],features:[a._Bn([{provide:$se,useExisting:n}])]}),n})(),Bse=0;const aAe=cp(class{constructor(n){this._elementRef=n}},"primary"),lAe=new a.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS"),d$=new a.OlP("MatFormField");let h1=(()=>{class n extends aAe{constructor(e,r,i,s,o,l,c){super(e),this._changeDetectorRef=r,this._dir=i,this._defaults=s,this._platform=o,this._ngZone=l,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new Xt.x,this._hideRequiredMarker=!1,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+Bse++,this._labelId="mat-form-field-label-"+Bse++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==c,this.appearance=s?.appearance||"legacy",s&&(this._hideRequiredMarker=Boolean(s.hideRequiredMarker),s.color&&(this.color=this.defaultColor=s.color))}get appearance(){return this._appearance}set appearance(e){const r=this._appearance;this._appearance=e||this._defaults?.appearance||"legacy","outline"===this._appearance&&r!==e&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=xn(e)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(e){this._explicitFormFieldControl=e}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${e.controlType}`),e.stateChanges.pipe(Ui(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(ur(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(ur(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),(0,cs.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(Ui(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(Ui(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(ur(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(e){const r=this._control?this._control.ngControl:null;return r&&r[e]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,Wg(this._label.nativeElement,"transitionend").pipe(nr(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const r=this._hintChildren?this._hintChildren.find(s=>"start"===s.align):null,i=this._hintChildren?this._hintChildren.find(s=>"end"===s.align):null;r?e.push(r.id):this._hintLabel&&e.push(this._hintLabelId),i&&e.push(i.id)}else this._errorChildren&&e.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(e)}}_validateControlChild(){}updateOutlineGap(){const e=this._label?this._label.nativeElement:null,r=this._connectionContainerRef.nativeElement,i=".mat-form-field-outline-start",s=".mat-form-field-outline-gap";if("outline"!==this.appearance||!this._platform.isBrowser)return;if(!e||!e.children.length||!e.textContent.trim()){const f=r.querySelectorAll(`${i}, ${s}`);for(let m=0;m<f.length;m++)f[m].style.width="0";return}if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let o=0,l=0;const c=r.querySelectorAll(i),u=r.querySelectorAll(s);if(this._label&&this._label.nativeElement.children.length){const f=r.getBoundingClientRect();if(0===f.width&&0===f.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const m=this._getStartEnd(f),_=e.children,y=this._getStartEnd(_[0].getBoundingClientRect());let w=0;for(let T=0;T<_.length;T++)w+=_[T].offsetWidth;o=Math.abs(y-m)-5,l=w>0?.75*w+10:0}for(let f=0;f<c.length;f++)c[f].style.width=`${o}px`;for(let f=0;f<u.length;f++)u[f].style.width=`${l}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(e){return this._dir&&"rtl"===this._dir.value?e.right:e.left}_isAttachedToDOM(){const e=this._elementRef.nativeElement;if(e.getRootNode){const r=e.getRootNode();return r&&r!==e}return document.documentElement.contains(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(Ws,8),a.Y36(lAe,8),a.Y36(Oi),a.Y36(a.R0b),a.Y36(a.QbO,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-form-field"]],contentQueries:function(e,r,i){if(1&e&&(a.Suo(i,c$,5),a.Suo(i,c$,7),a.Suo(i,Mb,5),a.Suo(i,Mb,7),a.Suo(i,sAe,5),a.Suo(i,Fse,5),a.Suo(i,Pse,5),a.Suo(i,Lse,5),a.Suo(i,$se,5)),2&e){let s;a.iGM(s=a.CRH())&&(r._controlNonStatic=s.first),a.iGM(s=a.CRH())&&(r._controlStatic=s.first),a.iGM(s=a.CRH())&&(r._labelChildNonStatic=s.first),a.iGM(s=a.CRH())&&(r._labelChildStatic=s.first),a.iGM(s=a.CRH())&&(r._placeholderChild=s.first),a.iGM(s=a.CRH())&&(r._errorChildren=s),a.iGM(s=a.CRH())&&(r._hintChildren=s),a.iGM(s=a.CRH())&&(r._prefixChildren=s),a.iGM(s=a.CRH())&&(r._suffixChildren=s)}},viewQuery:function(e,r){if(1&e&&(a.Gf(Vke,7),a.Gf(Uke,5),a.Gf(zke,5)),2&e){let i;a.iGM(i=a.CRH())&&(r._connectionContainerRef=i.first),a.iGM(i=a.CRH())&&(r._inputContainerRef=i.first),a.iGM(i=a.CRH())&&(r._label=i.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(e,r){2&e&&a.ekj("mat-form-field-appearance-standard","standard"==r.appearance)("mat-form-field-appearance-fill","fill"==r.appearance)("mat-form-field-appearance-outline","outline"==r.appearance)("mat-form-field-appearance-legacy","legacy"==r.appearance)("mat-form-field-invalid",r._control.errorState)("mat-form-field-can-float",r._canLabelFloat())("mat-form-field-should-float",r._shouldLabelFloat())("mat-form-field-has-label",r._hasFloatingLabel())("mat-form-field-hide-placeholder",r._hideControlPlaceholder())("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-focused",r._control.focused)("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))("_mat-animation-noopable",!r._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[a._Bn([{provide:d$,useExisting:n}]),a.qOj],ngContentSelectors:tAe,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(e,r){1&e&&(a.F$t(eAe),a.TgZ(0,"div",0)(1,"div",1,2),a.NdJ("click",function(s){return r._control.onContainerClick&&r._control.onContainerClick(s)}),a.YNc(3,Hke,9,0,"ng-container",3),a.YNc(4,Gke,2,1,"div",4),a.TgZ(5,"div",5,6),a.Hsn(7),a.TgZ(8,"span",7),a.YNc(9,Zke,5,16,"label",8),a.qZA()(),a.YNc(10,Yke,2,0,"div",9),a.qZA(),a.YNc(11,Kke,2,4,"div",10),a.TgZ(12,"div",11),a.YNc(13,Qke,2,1,"div",12),a.YNc(14,Jke,5,2,"div",13),a.qZA()()),2&e&&(a.xp6(3),a.Q6J("ngIf","outline"==r.appearance),a.xp6(1),a.Q6J("ngIf",r._prefixChildren.length),a.xp6(5),a.Q6J("ngIf",r._hasFloatingLabel()),a.xp6(1),a.Q6J("ngIf",r._suffixChildren.length),a.xp6(1),a.Q6J("ngIf","outline"!=r.appearance),a.xp6(1),a.Q6J("ngSwitch",r._getDisplayedMessages()),a.xp6(1),a.Q6J("ngSwitchCase","error"),a.xp6(1),a.Q6J("ngSwitchCase","hint"))},dependencies:[Ur,no,ko,iq],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.cdk-high-contrast-active .mat-form-field-disabled .mat-form-field-label{color:GrayText}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-form-field-flex{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}','.mat-input-element{font:inherit;background:rgba(0,0,0,0);color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}._mat-animation-noopable .mat-input-element::placeholder{transition:none}._mat-animation-noopable .mat-input-element::-moz-placeholder{transition:none}._mat-animation-noopable .mat-input-element::-webkit-input-placeholder{transition:none}._mat-animation-noopable .mat-input-element:-ms-input-placeholder{transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px;border-top-color:GrayText}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:rgba(0,0,0,0)}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-form-field-disabled .mat-form-field-outline{color:GrayText}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}"],encapsulation:2,data:{animation:[rAe.transitionMessages]},changeDetection:0}),n})(),h$=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[No,$n,qL,$n]}),n})();const Use=Tb({passive:!0});let cAe=(()=>{class n{constructor(e,r){this._platform=e,this._ngZone=r,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return Ga.E;const r=lp(e),i=this._monitoredElements.get(r);if(i)return i.subject;const s=new Xt.x,o="cdk-text-field-autofilled",l=c=>{"cdk-text-field-autofill-start"!==c.animationName||r.classList.contains(o)?"cdk-text-field-autofill-end"===c.animationName&&r.classList.contains(o)&&(r.classList.remove(o),this._ngZone.run(()=>s.next({target:c.target,isAutofilled:!1}))):(r.classList.add(o),this._ngZone.run(()=>s.next({target:c.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{r.addEventListener("animationstart",l,Use),r.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(r,{subject:s,unlisten:()=>{r.removeEventListener("animationstart",l,Use)}}),s}stopMonitoring(e){const r=lp(e),i=this._monitoredElements.get(r);i&&(i.unlisten(),i.subject.complete(),r.classList.remove("cdk-text-field-autofill-monitored"),r.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(r))}ngOnDestroy(){this._monitoredElements.forEach((e,r)=>this.stopMonitoring(r))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Oi),a.LFG(a.R0b))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),zse=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})();const Hse=new a.OlP("MAT_INPUT_VALUE_ACCESSOR"),uAe=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let dAe=0;const hAe=tse(class{constructor(n,t,e,r){this._defaultErrorStateMatcher=n,this._parentForm=t,this._parentFormGroup=e,this.ngControl=r,this.stateChanges=new Xt.x}});let f1=(()=>{class n extends hAe{constructor(e,r,i,s,o,l,c,u,f,m){super(l,s,o,i),this._elementRef=e,this._platform=r,this._autofillMonitor=u,this._formField=m,this._uid="mat-input-"+dAe++,this.focused=!1,this.stateChanges=new Xt.x,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(w=>Oie().has(w)),this._iOSKeyupListener=w=>{const T=w.target;!T.value&&0===T.selectionStart&&0===T.selectionEnd&&(T.setSelectionRange(1,1),T.setSelectionRange(0,0))};const _=this._elementRef.nativeElement,y=_.nodeName.toLowerCase();this._inputValueAccessor=c||_,this._previousNativeValue=this.value,this.id=this.id,r.IOS&&f.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===y,this._isTextarea="textarea"===y,this._isInFormField=!!m,this._isNativeSelect&&(this.controlType=_.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(e){this._disabled=xn(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(cn.required)??!1}set required(e){this._required=xn(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&Oie().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=xn(e)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){const e=this._formField,r=e&&"legacy"===e.appearance&&!e._hasLabel?.()?null:this.placeholder;if(r!==this._previousPlaceholder){const i=this._elementRef.nativeElement;this._previousPlaceholder=r,r?i.setAttribute("placeholder",r):i.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_validateType(){uAe.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,r=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&r&&r.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Oi),a.Y36(co,10),a.Y36(tC,8),a.Y36(Jl,8),a.Y36(n$),a.Y36(Hse,10),a.Y36(cAe),a.Y36(a.R0b),a.Y36(d$,8))},n.\u0275dir=a.lG2({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:12,hostBindings:function(e,r){1&e&&a.NdJ("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),2&e&&(a.Ikx("disabled",r.disabled)("required",r.required),a.uIk("id",r.id)("data-placeholder",r.placeholder)("name",r.name||null)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required),a.ekj("mat-input-server",r._isServer)("mat-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[a._Bn([{provide:c$,useExisting:n}]),a.qOj,a.TTD]}),n})(),fAe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[n$],imports:[zse,h$,$n,zse,h$]}),n})();const pAe=["mat-calendar-body",""];function mAe(n,t){if(1&n&&(a.TgZ(0,"tr",2)(1,"td",3),a._uU(2),a.qZA()()),2&n){const e=a.oxw();a.xp6(1),a.Udp("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),a.uIk("colspan",e.numCols),a.xp6(1),a.hij(" ",e.label," ")}}function gAe(n,t){if(1&n&&(a.TgZ(0,"td",3),a._uU(1),a.qZA()),2&n){const e=a.oxw(2);a.Udp("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),a.uIk("colspan",e._firstRowOffset),a.xp6(1),a.hij(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function _Ae(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"td",7)(1,"button",8),a.NdJ("click",function(i){const o=a.CHM(e).$implicit,l=a.oxw(2);return a.KtG(l._cellClicked(o,i))})("focus",function(i){const o=a.CHM(e).$implicit,l=a.oxw(2);return a.KtG(l._emitActiveDateChange(o,i))}),a.TgZ(2,"div",9),a._uU(3),a.qZA(),a._UZ(4,"div",10),a.qZA()()}if(2&n){const e=t.$implicit,r=t.index,i=a.oxw().index,s=a.oxw();a.Udp("width",s._cellWidth)("padding-top",s._cellPadding)("padding-bottom",s._cellPadding),a.uIk("data-mat-row",i)("data-mat-col",r),a.xp6(1),a.ekj("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",s._isActiveCell(i,r))("mat-calendar-body-range-start",s._isRangeStart(e.compareValue))("mat-calendar-body-range-end",s._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",s._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",s._isComparisonBridgeStart(e.compareValue,i,r))("mat-calendar-body-comparison-bridge-end",s._isComparisonBridgeEnd(e.compareValue,i,r))("mat-calendar-body-comparison-start",s._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",s._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",s._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",s._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",s._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",s._isInPreview(e.compareValue)),a.Q6J("ngClass",e.cssClasses)("tabindex",s._isActiveCell(i,r)?0:-1),a.uIk("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",s._isSelected(e.compareValue))("aria-current",s.todayValue===e.compareValue?"date":null),a.xp6(1),a.ekj("mat-calendar-body-selected",s._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",s._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",s.todayValue===e.compareValue),a.xp6(1),a.hij(" ",e.displayValue," ")}}function yAe(n,t){if(1&n&&(a.TgZ(0,"tr",4),a.YNc(1,gAe,2,6,"td",5),a.YNc(2,_Ae,5,47,"td",6),a.qZA()),2&n){const e=t.$implicit,r=t.index,i=a.oxw();a.xp6(1),a.Q6J("ngIf",0===r&&i._firstRowOffset),a.xp6(1),a.Q6J("ngForOf",e)}}function vAe(n,t){if(1&n&&(a.TgZ(0,"th",5)(1,"span",6),a._uU(2),a.qZA(),a.TgZ(3,"span",7),a._uU(4),a.qZA()()),2&n){const e=t.$implicit;a.xp6(2),a.Oqu(e.long),a.xp6(2),a.Oqu(e.narrow)}}const bAe=["*"];function wAe(n,t){}function CAe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"mat-month-view",5),a.NdJ("activeDateChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.activeDate=i)})("_userSelection",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._dateSelected(i))}),a.qZA()}if(2&n){const e=a.oxw();a.Q6J("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)}}function xAe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"mat-year-view",6),a.NdJ("activeDateChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.activeDate=i)})("monthSelected",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._monthSelectedInYearView(i))})("selectedChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._goToDateInView(i,"month"))}),a.qZA()}if(2&n){const e=a.oxw();a.Q6J("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function IAe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"mat-multi-year-view",7),a.NdJ("activeDateChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.activeDate=i)})("yearSelected",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._yearSelectedInMultiYearView(i))})("selectedChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._goToDateInView(i,"year"))}),a.qZA()}if(2&n){const e=a.oxw();a.Q6J("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function TAe(n,t){}const SAe=["button"];function EAe(n,t){1&n&&(a.O4$(),a.TgZ(0,"svg",3),a._UZ(1,"path",4),a.qZA())}const DAe=[[["","matDatepickerToggleIcon",""]]],kAe=["[matDatepickerToggleIcon]"];let p1=(()=>{class n{constructor(){this.changes=new Xt.x,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(e,r){return`${e} \u2013 ${r}`}formatYearRangeLabel(e,r){return`${e} to ${r}`}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Cq{constructor(t,e,r,i,s={},o=t,l){this.value=t,this.displayValue=e,this.ariaLabel=r,this.enabled=i,this.cssClasses=s,this.compareValue=o,this.rawValue=l}}let PI=(()=>{class n{constructor(e,r){this._elementRef=e,this._ngZone=r,this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new a.vpe,this.previewChange=new a.vpe,this.activeDateChange=new a.vpe,this._enterHandler=i=>{if(this._skipNextFocus&&"focus"===i.type)this._skipNextFocus=!1;else if(i.target&&this.isRange){const s=this._getCellFromElement(i.target);s&&this._ngZone.run(()=>this.previewChange.emit({value:s.enabled?s:null,event:i}))}},this._leaveHandler=i=>{null!==this.previewEnd&&this.isRange&&i.target&&this._getCellFromElement(i.target)&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:i}))},r.runOutsideAngular(()=>{const i=e.nativeElement;i.addEventListener("mouseenter",this._enterHandler,!0),i.addEventListener("focus",this._enterHandler,!0),i.addEventListener("mouseleave",this._leaveHandler,!0),i.addEventListener("blur",this._leaveHandler,!0)})}ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}_cellClicked(e,r){e.enabled&&this.selectedValueChange.emit({value:e.value,event:r})}_emitActiveDateChange(e,r){e.enabled&&this.activeDateChange.emit({value:e.value,event:r})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){const r=e.numCols,{rows:i,numCols:s}=this;(e.rows||r)&&(this._firstRowOffset=i&&i.length&&i[0].length?s-i[0].length:0),(e.cellAspectRatio||r||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/s+"%"),(r||!this._cellWidth)&&(this._cellWidth=100/s+"%")}ngOnDestroy(){const e=this._elementRef.nativeElement;e.removeEventListener("mouseenter",this._enterHandler,!0),e.removeEventListener("focus",this._enterHandler,!0),e.removeEventListener("mouseleave",this._leaveHandler,!0),e.removeEventListener("blur",this._leaveHandler,!0)}_isActiveCell(e,r){let i=e*this.numCols+r;return e&&(i-=this._firstRowOffset),i==this.activeCell}_focusActiveCell(e=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(nr(1)).subscribe(()=>{setTimeout(()=>{const r=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");r&&(e||(this._skipNextFocus=!0),r.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return xq(e,this.startValue,this.endValue)}_isRangeEnd(e){return Iq(e,this.startValue,this.endValue)}_isInRange(e){return Tq(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return xq(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,r,i){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let s=this.rows[r][i-1];if(!s){const o=this.rows[r-1];s=o&&o[o.length-1]}return s&&!this._isRangeEnd(s.compareValue)}_isComparisonBridgeEnd(e,r,i){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let s=this.rows[r][i+1];if(!s){const o=this.rows[r+1];s=o&&o[0]}return s&&!this._isRangeStart(s.compareValue)}_isComparisonEnd(e){return Iq(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return Tq(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return xq(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return Iq(e,this.previewStart,this.previewEnd)}_isInPreview(e){return Tq(e,this.previewStart,this.previewEnd,this.isRange)}_getCellFromElement(e){let r;if(Gse(e)?r=e:Gse(e.parentNode)&&(r=e.parentNode),r){const i=r.getAttribute("data-mat-row"),s=r.getAttribute("data-mat-col");if(i&&s)return this.rows[parseInt(i)][parseInt(s)]}return null}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.R0b))},n.\u0275cmp=a.Xpm({type:n,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange"},exportAs:["matCalendarBody"],features:[a.TTD],attrs:pAe,decls:2,vars:2,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click","focus"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(e,r){1&e&&(a.YNc(0,mAe,3,6,"tr",0),a.YNc(1,yAe,3,2,"tr",1)),2&e&&(a.Q6J("ngIf",r._firstRowOffset<r.labelMinRequiredCells),a.xp6(1),a.Q6J("ngForOf",r.rows))},dependencies:[Aa,Na,Ur],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}'],encapsulation:2,changeDetection:0}),n})();function Gse(n){return"TD"===n.nodeName}function xq(n,t,e){return null!==e&&t!==e&&n<e&&n===t}function Iq(n,t,e){return null!==t&&t!==e&&n>=t&&n===e}function Tq(n,t,e,r){return r&&null!==t&&null!==e&&t!==e&&n>=t&&n<=e}class Tl{constructor(t,e){this.start=t,this.end=e}}let Yg=(()=>{class n{constructor(e,r){this.selection=e,this._adapter=r,this._selectionChanged=new Xt.x,this.selectionChanged=this._selectionChanged,this.selection=e}updateSelection(e,r){const i=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:r,oldValue:i})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}}return n.\u0275fac=function(e){a.$Z()},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),AAe=(()=>{class n extends Yg{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const e=new n(this._adapter);return e.updateSelection(this.selection,this),e}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Yo))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();const Wse={provide:Yg,deps:[[new a.FiY,new a.tp0,Yg],Yo],useFactory:function RAe(n,t){return n||new AAe(t)}},f$=new a.OlP("MAT_DATE_RANGE_SELECTION_STRATEGY");let jse=(()=>{class n{constructor(e,r,i,s,o){this._changeDetectorRef=e,this._dateFormats=r,this._dateAdapter=i,this._dir=s,this._rangeStrategy=o,this._rerenderSubscription=kn.w0.EMPTY,this.selectedChange=new a.vpe,this._userSelection=new a.vpe,this.activeDateChange=new a.vpe,this._activeDate=this._dateAdapter.today()}get activeDate(){return this._activeDate}set activeDate(e){const r=this._activeDate,i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(i,this.minDate,this.maxDate),this._hasSameMonthAndYear(r,this._activeDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof Tl?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ui(null)).subscribe(()=>this._init())}ngOnChanges(e){const r=e.comparisonStart||e.comparisonEnd;r&&!r.firstChange&&this._setRanges(this.selected)}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){const r=e.value,i=this._getDateFromDayOfMonth(r);let s,o;this._selected instanceof Tl?(s=this._getDateInCurrentMonth(this._selected.start),o=this._getDateInCurrentMonth(this._selected.end)):s=o=this._getDateInCurrentMonth(this._selected),(s!==r||o!==r)&&this.selectedChange.emit(i),this._userSelection.emit({value:i,event:e.event}),this._previewStart=this._previewEnd=null,this._changeDetectorRef.markForCheck()}_updateActiveDate(e){const i=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(e.value),this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){const r=this._activeDate,i=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,i?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,i?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&e.preventDefault());case 27:return void(null!=this._previewEnd&&!Il(e)&&(this._previewStart=this._previewEnd=null,this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e}),e.preventDefault(),e.stopPropagation()));default:return}this._dateAdapter.compareDate(r,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:r}){if(this._rangeStrategy){const s=this._rangeStrategy.createPreview(r?r.rawValue:null,this.selected,e);this._previewStart=this._getCellCompareValue(s.start),this._previewEnd=this._getCellCompareValue(s.end),this._changeDetectorRef.detectChanges()}}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){const e=this._dateAdapter.getFirstDayOfWeek(),r=this._dateAdapter.getDayOfWeekNames("narrow");let s=this._dateAdapter.getDayOfWeekNames("long").map((o,l)=>({long:o,narrow:r[l]}));this._weekdays=s.slice(e).concat(s.slice(0,e))}_createWeekCells(){const e=this._dateAdapter.getNumDaysInMonth(this.activeDate),r=this._dateAdapter.getDateNames();this._weeks=[[]];for(let i=0,s=this._firstWeekOffset;i<e;i++,s++){7==s&&(this._weeks.push([]),s=0);const o=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),i+1),l=this._shouldEnableDate(o),c=this._dateAdapter.format(o,this._dateFormats.display.dateA11yLabel),u=this.dateClass?this.dateClass(o,"month"):void 0;this._weeks[this._weeks.length-1].push(new Cq(i+1,r[i],c,l,u,this._getCellCompareValue(o),o))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,r){return!(!e||!r||this._dateAdapter.getMonth(e)!=this._dateAdapter.getMonth(r)||this._dateAdapter.getYear(e)!=this._dateAdapter.getYear(r))}_getCellCompareValue(e){if(e){const r=this._dateAdapter.getYear(e),i=this._dateAdapter.getMonth(e),s=this._dateAdapter.getDate(e);return new Date(r,i,s).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(e){e instanceof Tl?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.sBO),a.Y36(kb,8),a.Y36(Yo,8),a.Y36(Ws,8),a.Y36(f$,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-month-view"]],viewQuery:function(e,r){if(1&e&&a.Gf(PI,5),2&e){let i;a.iGM(i=a.CRH())&&(r._matCalendarBody=i.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[a.TTD],decls:7,vars:13,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","selectedValueChange","activeDateChange","previewChange","keyup","keydown"],["scope","col"],[1,"cdk-visually-hidden"],["aria-hidden","true"]],template:function(e,r){1&e&&(a.TgZ(0,"table",0)(1,"thead",1)(2,"tr"),a.YNc(3,vAe,5,2,"th",2),a.qZA(),a.TgZ(4,"tr"),a._UZ(5,"th",3),a.qZA()(),a.TgZ(6,"tbody",4),a.NdJ("selectedValueChange",function(s){return r._dateSelected(s)})("activeDateChange",function(s){return r._updateActiveDate(s)})("previewChange",function(s){return r._previewChanged(s)})("keyup",function(s){return r._handleCalendarBodyKeyup(s)})("keydown",function(s){return r._handleCalendarBodyKeydown(s)}),a.qZA()()),2&e&&(a.xp6(3),a.Q6J("ngForOf",r._weekdays),a.xp6(3),a.Q6J("label",r._monthLabel)("rows",r._weeks)("todayValue",r._todayDate)("startValue",r._rangeStart)("endValue",r._rangeEnd)("comparisonStart",r._comparisonRangeStart)("comparisonEnd",r._comparisonRangeEnd)("previewStart",r._previewStart)("previewEnd",r._previewEnd)("isRange",r._isRange)("labelMinRequiredCells",3)("activeCell",r._dateAdapter.getDate(r.activeDate)-1))},dependencies:[Na,PI],encapsulation:2,changeDetection:0}),n})(),qse=(()=>{class n{constructor(e,r,i){this._changeDetectorRef=e,this._dateAdapter=r,this._dir=i,this._rerenderSubscription=kn.w0.EMPTY,this.selectedChange=new a.vpe,this.yearSelected=new a.vpe,this.activeDateChange=new a.vpe,this._activeDate=this._dateAdapter.today()}get activeDate(){return this._activeDate}set activeDate(e){let r=this._activeDate;const i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(i,this.minDate,this.maxDate),Zse(this._dateAdapter,r,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof Tl?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ui(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const r=this._dateAdapter.getYear(this._activeDate)-m1(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let i=0,s=[];i<24;i++)s.push(r+i),4==s.length&&(this._years.push(s.map(o=>this._createCellForYear(o))),s=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){const r=e.value,i=this._dateAdapter.createDate(r,0,1),s=this._getDateFromYear(r);this.yearSelected.emit(i),this.selectedChange.emit(s)}_updateActiveDate(e){const i=this._activeDate;this.activeDate=this._getDateFromYear(e.value),this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const r=this._activeDate,i=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,i?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,i?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-m1(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,24-m1(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-240:-24);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?240:24);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return m1(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){const r=this._dateAdapter.getMonth(this.activeDate),i=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,r,1));return this._dateAdapter.createDate(e,r,Math.min(this._dateAdapter.getDate(this.activeDate),i))}_createCellForYear(e){const r=this._dateAdapter.createDate(e,0,1),i=this._dateAdapter.getYearName(r),s=this.dateClass?this.dateClass(r,"multi-year"):void 0;return new Cq(e,i,i,this._shouldEnableYear(e),s)}_shouldEnableYear(e){if(null==e||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let i=this._dateAdapter.createDate(e,0,1);this._dateAdapter.getYear(i)==e;i=this._dateAdapter.addCalendarDays(i,1))if(this.dateFilter(i))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(e){if(this._selectedYear=null,e instanceof Tl){const r=e.start||e.end;r&&(this._selectedYear=this._dateAdapter.getYear(r))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.sBO),a.Y36(Yo,8),a.Y36(Ws,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-multi-year-view"]],viewQuery:function(e,r){if(1&e&&a.Gf(PI,5),2&e){let i;a.iGM(i=a.CRH())&&(r._matCalendarBody=i.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(e,r){1&e&&(a.TgZ(0,"table",0)(1,"thead",1)(2,"tr"),a._UZ(3,"th",2),a.qZA()(),a.TgZ(4,"tbody",3),a.NdJ("selectedValueChange",function(s){return r._yearSelected(s)})("activeDateChange",function(s){return r._updateActiveDate(s)})("keyup",function(s){return r._handleCalendarBodyKeyup(s)})("keydown",function(s){return r._handleCalendarBodyKeydown(s)}),a.qZA()()),2&e&&(a.xp6(4),a.Q6J("rows",r._years)("todayValue",r._todayYear)("startValue",r._selectedYear)("endValue",r._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",r._getActiveCell()))},dependencies:[PI],encapsulation:2,changeDetection:0}),n})();function Zse(n,t,e,r,i){const s=n.getYear(t),o=n.getYear(e),l=Yse(n,r,i);return Math.floor((s-l)/24)===Math.floor((o-l)/24)}function m1(n,t,e,r){return function PAe(n,t){return(n%t+t)%t}(n.getYear(t)-Yse(n,e,r),24)}function Yse(n,t,e){let r=0;return e?r=n.getYear(e)-24+1:t&&(r=n.getYear(t)),r}let Kse=(()=>{class n{constructor(e,r,i,s){this._changeDetectorRef=e,this._dateFormats=r,this._dateAdapter=i,this._dir=s,this._rerenderSubscription=kn.w0.EMPTY,this.selectedChange=new a.vpe,this.monthSelected=new a.vpe,this.activeDateChange=new a.vpe,this._activeDate=this._dateAdapter.today()}get activeDate(){return this._activeDate}set activeDate(e){let r=this._activeDate;const i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(i,this.minDate,this.maxDate),this._dateAdapter.getYear(r)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof Tl?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ui(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){const r=e.value,i=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),r,1);this.monthSelected.emit(i);const s=this._getDateFromMonth(r);this.selectedChange.emit(s)}_updateActiveDate(e){const i=this._activeDate;this.activeDate=this._getDateFromMonth(e.value),this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const r=this._activeDate,i=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,i?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,i?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(r,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(r=>r.map(i=>this._createCellForMonth(i,e[i]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){const r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),i=this._dateAdapter.getNumDaysInMonth(r);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),i))}_createCellForMonth(e,r){const i=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),s=this._dateAdapter.format(i,this._dateFormats.display.monthYearA11yLabel),o=this.dateClass?this.dateClass(i,"year"):void 0;return new Cq(e,r.toLocaleUpperCase(),s,this._shouldEnableMonth(e),o)}_shouldEnableMonth(e){const r=this._dateAdapter.getYear(this.activeDate);if(null==e||this._isYearAndMonthAfterMaxDate(r,e)||this._isYearAndMonthBeforeMinDate(r,e))return!1;if(!this.dateFilter)return!0;for(let s=this._dateAdapter.createDate(r,e,1);this._dateAdapter.getMonth(s)==e;s=this._dateAdapter.addCalendarDays(s,1))if(this.dateFilter(s))return!0;return!1}_isYearAndMonthAfterMaxDate(e,r){if(this.maxDate){const i=this._dateAdapter.getYear(this.maxDate),s=this._dateAdapter.getMonth(this.maxDate);return e>i||e===i&&r>s}return!1}_isYearAndMonthBeforeMinDate(e,r){if(this.minDate){const i=this._dateAdapter.getYear(this.minDate),s=this._dateAdapter.getMonth(this.minDate);return e<i||e===i&&r<s}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(e){this._selectedMonth=e instanceof Tl?this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._getMonthInCurrentYear(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.sBO),a.Y36(kb,8),a.Y36(Yo,8),a.Y36(Ws,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-year-view"]],viewQuery:function(e,r){if(1&e&&a.Gf(PI,5),2&e){let i;a.iGM(i=a.CRH())&&(r._matCalendarBody=i.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(e,r){1&e&&(a.TgZ(0,"table",0)(1,"thead",1)(2,"tr"),a._UZ(3,"th",2),a.qZA()(),a.TgZ(4,"tbody",3),a.NdJ("selectedValueChange",function(s){return r._monthSelected(s)})("activeDateChange",function(s){return r._updateActiveDate(s)})("keyup",function(s){return r._handleCalendarBodyKeyup(s)})("keydown",function(s){return r._handleCalendarBodyKeydown(s)}),a.qZA()()),2&e&&(a.xp6(4),a.Q6J("label",r._yearLabel)("rows",r._months)("todayValue",r._todayMonth)("startValue",r._selectedMonth)("endValue",r._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",r._dateAdapter.getMonth(r.activeDate)))},dependencies:[PI],encapsulation:2,changeDetection:0}),n})(),LAe=0,$Ae=(()=>{class n{constructor(e,r,i,s,o){this._intl=e,this.calendar=r,this._dateAdapter=i,this._dateFormats=s,this._buttonDescriptionId="mat-calendar-button-"+LAe++,this.calendar.stateChanges.subscribe(()=>o.markForCheck())}get periodButtonText(){if("month"==this.calendar.currentView)return this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase();if("year"==this.calendar.currentView)return this._dateAdapter.getYearName(this.calendar.activeDate);const r=this._dateAdapter.getYear(this.calendar.activeDate)-m1(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),i=r+24-1,s=this._dateAdapter.getYearName(this._dateAdapter.createDate(r,0,1)),o=this._dateAdapter.getYearName(this._dateAdapter.createDate(i,0,1));return this._intl.formatYearRange(s,o)}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-24)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:24)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,r){return"month"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(r)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(r):"year"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(r):Zse(this._dateAdapter,e,r,this.calendar.minDate,this.calendar.maxDate)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(p1),a.Y36((0,a.Gpc)(()=>Dq)),a.Y36(Yo,8),a.Y36(kb,8),a.Y36(a.sBO))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:bAe,decls:11,vars:10,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["viewBox","0 0 10 5","focusable","false",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"]],template:function(e,r){1&e&&(a.F$t(),a.TgZ(0,"div",0)(1,"div",1)(2,"button",2),a.NdJ("click",function(){return r.currentPeriodClicked()}),a.TgZ(3,"span"),a._uU(4),a.qZA(),a.O4$(),a.TgZ(5,"svg",3),a._UZ(6,"polygon",4),a.qZA()(),a.kcU(),a._UZ(7,"div",5),a.Hsn(8),a.TgZ(9,"button",6),a.NdJ("click",function(){return r.previousClicked()}),a.qZA(),a.TgZ(10,"button",7),a.NdJ("click",function(){return r.nextClicked()}),a.qZA()()()),2&e&&(a.xp6(2),a.uIk("aria-label",r.periodButtonLabel)("aria-describedby",r._buttonDescriptionId),a.xp6(1),a.uIk("id",r._buttonDescriptionId),a.xp6(1),a.Oqu(r.periodButtonText),a.xp6(1),a.ekj("mat-calendar-invert","month"!==r.calendar.currentView),a.xp6(4),a.Q6J("disabled",!r.previousEnabled()),a.uIk("aria-label",r.prevButtonLabel),a.xp6(1),a.Q6J("disabled",!r.nextEnabled()),a.uIk("aria-label",r.nextButtonLabel))},dependencies:[js],encapsulation:2,changeDetection:0}),n})(),Dq=(()=>{class n{constructor(e,r,i,s){this._dateAdapter=r,this._dateFormats=i,this._changeDetectorRef=s,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new a.vpe,this.yearSelected=new a.vpe,this.monthSelected=new a.vpe,this.viewChanged=new a.vpe(!0),this._userSelection=new a.vpe,this.stateChanges=new Xt.x,this._intlChanges=e.changes.subscribe(()=>{s.markForCheck(),this.stateChanges.next()})}get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get selected(){return this._selected}set selected(e){this._selected=e instanceof Tl?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(e){const r=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),r&&this.viewChanged.emit(r)}ngAfterContentInit(){this._calendarHeaderPortal=new qg(this.headerComponent||$Ae),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){const r=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,i=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,s=r||i||e.dateFilter;if(s&&!s.firstChange){const o=this._getCurrentViewComponent();o&&(this._changeDetectorRef.detectChanges(),o._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){const r=e.value;(this.selected instanceof Tl||r&&!this._dateAdapter.sameDate(r,this.selected))&&this.selectedChange.emit(r),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,r){this.activeDate=e,this.currentView=r}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(p1),a.Y36(Yo,8),a.Y36(kb,8),a.Y36(a.sBO))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-calendar"]],viewQuery:function(e,r){if(1&e&&(a.Gf(jse,5),a.Gf(Kse,5),a.Gf(qse,5)),2&e){let i;a.iGM(i=a.CRH())&&(r.monthView=i.first),a.iGM(i=a.CRH())&&(r.yearView=i.first),a.iGM(i=a.CRH())&&(r.multiYearView=i.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection"},exportAs:["matCalendar"],features:[a._Bn([Wse]),a.TTD],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","activeDateChange","_userSelection",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","activeDateChange","_userSelection"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(e,r){1&e&&(a.YNc(0,wAe,0,0,"ng-template",0),a.TgZ(1,"div",1),a.YNc(2,CAe,1,8,"mat-month-view",2),a.YNc(3,xAe,1,6,"mat-year-view",3),a.YNc(4,IAe,1,6,"mat-multi-year-view",4),a.qZA()),2&e&&(a.Q6J("cdkPortalOutlet",r._calendarHeaderPortal),a.xp6(1),a.Q6J("ngSwitch",r.currentView),a.xp6(1),a.Q6J("ngSwitchCase","month"),a.xp6(1),a.Q6J("ngSwitchCase","year"),a.xp6(1),a.Q6J("ngSwitchCase","multi-year"))},dependencies:[no,ko,Yie,ed,jse,Kse,qse],styles:['.mat-calendar{display:block}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-controls .mat-icon-button:hover .mat-button-focus-overlay{opacity:.04}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})();const Qse={transformPanel:Bs("transformPanel",[ei("void => enter-dropdown",_i("120ms cubic-bezier(0, 0, 0.2, 1)",lm([Sn({opacity:0,transform:"scale(1, 0.8)"}),Sn({opacity:1,transform:"scale(1, 1)"})]))),ei("void => enter-dialog",_i("150ms cubic-bezier(0, 0, 0.2, 1)",lm([Sn({opacity:0,transform:"scale(0.7)"}),Sn({transform:"none",opacity:1})]))),ei("* => void",_i("100ms linear",Sn({opacity:0})))]),fadeInCalendar:Bs("fadeInCalendar",[yi("void",Sn({opacity:0})),yi("enter",Sn({opacity:1})),ei("void => *",_i("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let BAe=0;const Xse=new a.OlP("mat-datepicker-scroll-strategy"),UAe={provide:Xse,deps:[_a],useFactory:function VAe(n){return()=>n.scrollStrategies.reposition()}},zAe=cp(class{constructor(n){this._elementRef=n}});let HAe=(()=>{class n extends zAe{constructor(e,r,i,s,o,l){super(e),this._changeDetectorRef=r,this._globalModel=i,this._dateAdapter=s,this._rangeSelectionStrategy=o,this._subscriptions=new kn.w0,this._animationDone=new Xt.x,this._actionsPortal=null,this._closeButtonText=l.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){const r=this._model.selection,i=e.value,s=r instanceof Tl;if(s&&this._rangeSelectionStrategy){const o=this._rangeSelectionStrategy.selectionFinished(i,r,e.event);this._model.updateSelection(o,this)}else i&&(s||!this._dateAdapter.sameDate(i,r))&&this._model.add(i);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,r){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,r&&this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(Yg),a.Y36(Yo),a.Y36(f$,8),a.Y36(p1))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-datepicker-content"]],viewQuery:function(e,r){if(1&e&&a.Gf(Dq,5),2&e){let i;a.iGM(i=a.CRH())&&(r._calendar=i.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(e,r){1&e&&a.WFA("@transformPanel.done",function(){return r._animationDone.next()}),2&e&&(a.d8E("@transformPanel",r._animationState),a.ekj("mat-datepicker-content-touch",r.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[a.qOj],decls:5,vars:24,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","yearSelected","monthSelected","viewChanged","_userSelection"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(e,r){if(1&e&&(a.TgZ(0,"div",0)(1,"mat-calendar",1),a.NdJ("yearSelected",function(s){return r.datepicker._selectYear(s)})("monthSelected",function(s){return r.datepicker._selectMonth(s)})("viewChanged",function(s){return r.datepicker._viewChanged(s)})("_userSelection",function(s){return r._handleUserSelection(s)}),a.qZA(),a.YNc(2,TAe,0,0,"ng-template",2),a.TgZ(3,"button",3),a.NdJ("focus",function(){return r._closeButtonFocused=!0})("blur",function(){return r._closeButtonFocused=!1})("click",function(){return r.datepicker.close()}),a._uU(4),a.qZA()()),2&e){let i;a.ekj("mat-datepicker-content-container-with-custom-header",r.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",r._actionsPortal),a.uIk("aria-modal",!0)("aria-labelledby",null!==(i=r._dialogLabelId)&&void 0!==i?i:void 0),a.xp6(1),a.Q6J("id",r.datepicker.id)("ngClass",r.datepicker.panelClass)("startAt",r.datepicker.startAt)("startView",r.datepicker.startView)("minDate",r.datepicker._getMinDate())("maxDate",r.datepicker._getMaxDate())("dateFilter",r.datepicker._getDateFilter())("headerComponent",r.datepicker.calendarHeaderComponent)("selected",r._getSelected())("dateClass",r.datepicker.dateClass)("comparisonStart",r.comparisonStart)("comparisonEnd",r.comparisonEnd)("@fadeInCalendar","enter"),a.xp6(1),a.Q6J("cdkPortalOutlet",r._actionsPortal),a.xp6(1),a.ekj("cdk-visually-hidden",!r._closeButtonFocused),a.Q6J("color",r.color||"primary"),a.xp6(1),a.Oqu(r._closeButtonText)}},dependencies:[Aa,js,qEe,ed,Dq],styles:[".mat-datepicker-content{display:block;border-radius:4px}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[Qse.transformPanel,Qse.fadeInCalendar]},changeDetection:0}),n})(),Jse=(()=>{class n{constructor(e,r,i,s,o,l,c){this._overlay=e,this._ngZone=r,this._viewContainerRef=i,this._dateAdapter=o,this._dir=l,this._model=c,this._inputStateChanges=kn.w0.EMPTY,this._document=(0,a.f3M)(Nt),this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new a.vpe,this.monthSelected=new a.vpe,this.viewChanged=new a.vpe(!0),this.openedStream=new a.vpe,this.closedStream=new a.vpe,this._opened=!1,this.id="mat-datepicker-"+BAe++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new Xt.x,this._scrollStrategy=s}get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(e){this._color=e}get touchUi(){return this._touchUi}set touchUi(e){this._touchUi=xn(e)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(e){const r=xn(e);r!==this._disabled&&(this._disabled=r,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(e){this._restoreFocus=xn(e)}get panelClass(){return this._panelClass}set panelClass(e){this._panelClass=function TEe(n,t=/\s+/){const e=[];if(null!=n){const r=Array.isArray(n)?n:`${n}`.split(t);for(const i of r){const s=`${i}`.trim();s&&e.push(s)}}return e}(e)}get opened(){return this._opened}set opened(e){xn(e)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}ngOnChanges(e){const r=e.xPosition||e.yPosition;if(r&&!r.firstChange&&this._overlayRef){const i=this._overlayRef.getConfig().positionStrategy;i instanceof Dse&&(this._setConnectedPositions(i),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(e){this._model.add(e)}_selectYear(e){this.yearSelected.emit(e)}_selectMonth(e){this.monthSelected.emit(e)}_viewChanged(e){this.viewChanged.emit(e)}registerInput(e){return this._inputStateChanges.unsubscribe(),this.datepickerInput=e,this._inputStateChanges=e.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(e){this._actionsPortal=e,this._componentRef?.instance._assignActions(e,!0)}removeActions(e){e===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||(this._focusedElementBeforeOpen=o1(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened)return;const e=this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus,r=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){const{instance:i,location:s}=this._componentRef;i._startExitAnimation(),i._animationDone.pipe(nr(1)).subscribe(()=>{const o=this._document.activeElement;e&&(!o||o===this._document.activeElement||s.nativeElement.contains(o))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}e?setTimeout(r):r()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(e){e.datepicker=this,e.color=this.color,e._dialogLabelId=this.datepickerInput.getOverlayLabelId(),e._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();const e=this.touchUi,r=new qg(HAe,this._viewContainerRef),i=this._overlayRef=this._overlay.create(new FI({positionStrategy:e?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[e?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:e?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(e?"dialog":"popup")}));this._getCloseStream(i).subscribe(s=>{s&&s.preventDefault(),this.close()}),i.keydownEvents().subscribe(s=>{const o=s.keyCode;(38===o||40===o||37===o||39===o||33===o||34===o)&&s.preventDefault()}),this._componentRef=i.attach(r),this._forwardContentValues(this._componentRef.instance),e||this._ngZone.onStable.pipe(nr(1)).subscribe(()=>i.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const e=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){const r="end"===this.xPosition?"end":"start",i="start"===r?"end":"start",s="above"===this.yPosition?"bottom":"top",o="top"===s?"bottom":"top";return e.withPositions([{originX:r,originY:o,overlayX:r,overlayY:s},{originX:r,originY:s,overlayX:r,overlayY:o},{originX:i,originY:o,overlayX:i,overlayY:s},{originX:i,originY:s,overlayX:i,overlayY:o}])}_getCloseStream(e){return(0,cs.T)(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(cr(r=>27===r.keyCode&&!Il(r)||this.datepickerInput&&Il(r,"altKey")&&38===r.keyCode)))}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(_a),a.Y36(a.R0b),a.Y36(a.s_b),a.Y36(Xse),a.Y36(Yo,8),a.Y36(Ws,8),a.Y36(Yg))},n.\u0275dir=a.lG2({type:n,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[a.TTD]}),n})(),kq=(()=>{class n extends Jse{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[a._Bn([Wse,{provide:Jse,useExisting:n}]),a.qOj],decls:0,vars:0,template:function(e,r){},encapsulation:2,changeDetection:0}),n})();class p${constructor(t,e){this.target=t,this.targetElement=e,this.value=this.target.value}}let GAe=(()=>{class n{constructor(e,r,i){this._elementRef=e,this._dateAdapter=r,this._dateFormats=i,this.dateChange=new a.vpe,this.dateInput=new a.vpe,this.stateChanges=new Xt.x,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=kn.w0.EMPTY,this._localeSubscription=kn.w0.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=s=>{const o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value));return!o||this._matchesFilter(o)?null:{matDatepickerFilter:!0}},this._minValidator=s=>{const o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value)),l=this._getMinDate();return!l||!o||this._dateAdapter.compareDate(l,o)<=0?null:{matDatepickerMin:{min:l,actual:o}}},this._maxValidator=s=>{const o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value)),l=this._getMaxDate();return!l||!o||this._dateAdapter.compareDate(l,o)>=0?null:{matDatepickerMax:{max:l,actual:o}}},this._lastValueValid=!1,this._localeSubscription=r.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(e){this._assignValueProgrammatically(e)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(e){const r=xn(e),i=this._elementRef.nativeElement;this._disabled!==r&&(this._disabled=r,this.stateChanges.next(void 0)),r&&this._isInitialized&&i.blur&&i.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(e){this._model=e,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(r=>{if(this._shouldHandleChangeEvent(r)){const i=this._getValueFromModel(r.selection);this._lastValueValid=this._isValidValue(i),this._cvaOnChange(i),this._onTouched(),this._formatValue(i),this.dateInput.emit(new p$(this,this._elementRef.nativeElement)),this.dateChange.emit(new p$(this,this._elementRef.nativeElement))}})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(e){(function WAe(n,t){const e=Object.keys(n);for(let r of e){const{previousValue:i,currentValue:s}=n[r];if(!t.isDateInstance(i)||!t.isDateInstance(s))return!0;if(!t.sameDate(i,s))return!0}return!1})(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}writeValue(e){this._assignValueProgrammatically(e)}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){e.altKey&&40===e.keyCode&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),e.preventDefault())}_onInput(e){const r=this._lastValueValid;let i=this._dateAdapter.parse(e,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(i),i=this._dateAdapter.getValidDateOrNull(i);const s=!this._dateAdapter.sameDate(i,this.value);!i||s?this._cvaOnChange(i):(e&&!this.value&&this._cvaOnChange(i),r!==this._lastValueValid&&this._validatorOnChange()),s&&(this._assignValue(i),this.dateInput.emit(new p$(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new p$(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(e){this._elementRef.nativeElement.value=null!=e?this._dateAdapter.format(e,this._dateFormats.display.dateInput):""}_assignValue(e){this._model?(this._assignValueToModel(e),this._pendingValue=null):this._pendingValue=e}_isValidValue(e){return!e||this._dateAdapter.isValid(e)}_parentDisabled(){return!1}_assignValueProgrammatically(e){e=this._dateAdapter.deserialize(e),this._lastValueValid=this._isValidValue(e),e=this._dateAdapter.getValidDateOrNull(e),this._assignValue(e),this._formatValue(e)}_matchesFilter(e){const r=this._getDateFilter();return!r||r(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Yo,8),a.Y36(kb,8))},n.\u0275dir=a.lG2({type:n,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[a.TTD]}),n})();const jAe={provide:Ha,useExisting:(0,a.Gpc)(()=>g1),multi:!0},qAe={provide:ls,useExisting:(0,a.Gpc)(()=>g1),multi:!0};let g1=(()=>{class n extends GAe{constructor(e,r,i,s){super(e,r,i),this._formField=s,this._closedSubscription=kn.w0.EMPTY,this._validator=cn.compose(super._getValidators())}set matDatepicker(e){e&&(this._datepicker=e,this._closedSubscription=e.closedStream.subscribe(()=>this._onTouched()),this._registerModel(e.registerInput(this)))}get min(){return this._min}set min(e){const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(r,this._min)||(this._min=r,this._validatorOnChange())}get max(){return this._max}set max(e){const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(r,this._max)||(this._max=r,this._validatorOnChange())}get dateFilter(){return this._dateFilter}set dateFilter(e){const r=this._matchesFilter(this.value);this._dateFilter=e,this._matchesFilter(this.value)!==r&&this._validatorOnChange()}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(e){return e}_assignValueToModel(e){this._model&&this._model.updateSelection(e,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(e){return e.source!==this}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Yo,8),a.Y36(kb,8),a.Y36(d$,8))},n.\u0275dir=a.lG2({type:n,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(e,r){1&e&&a.NdJ("input",function(s){return r._onInput(s.target.value)})("change",function(){return r._onChange()})("blur",function(){return r._onBlur()})("keydown",function(s){return r._onKeydown(s)}),2&e&&(a.Ikx("disabled",r.disabled),a.uIk("aria-haspopup",r._datepicker?"dialog":null)("aria-owns",(null==r._datepicker?null:r._datepicker.opened)&&r._datepicker.id||null)("min",r.min?r._dateAdapter.toIso8601(r.min):null)("max",r.max?r._dateAdapter.toIso8601(r.max):null)("data-mat-calendar",r._datepicker?r._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:["matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[a._Bn([jAe,qAe,{provide:Hse,useExisting:n}]),a.qOj]}),n})(),ZAe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["","matDatepickerToggleIcon",""]]}),n})(),eoe=(()=>{class n{constructor(e,r,i){this._intl=e,this._changeDetectorRef=r,this._stateChanges=kn.w0.EMPTY;const s=Number(i);this.tabIndex=s||0===s?s:null}get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=xn(e)}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){const e=this.datepicker?this.datepicker.stateChanges:St(),r=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:St(),i=this.datepicker?(0,cs.T)(this.datepicker.openedStream,this.datepicker.closedStream):St();this._stateChanges.unsubscribe(),this._stateChanges=(0,cs.T)(this._intl.changes,e,r,i).subscribe(()=>this._changeDetectorRef.markForCheck())}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(p1),a.Y36(a.sBO),a.$8M("tabindex"))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-datepicker-toggle"]],contentQueries:function(e,r,i){if(1&e&&a.Suo(i,ZAe,5),2&e){let s;a.iGM(s=a.CRH())&&(r._customIcon=s.first)}},viewQuery:function(e,r){if(1&e&&a.Gf(SAe,5),2&e){let i;a.iGM(i=a.CRH())&&(r._button=i.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(e,r){1&e&&a.NdJ("click",function(s){return r._open(s)}),2&e&&(a.uIk("tabindex",null)("data-mat-calendar",r.datepicker?r.datepicker.id:null),a.ekj("mat-datepicker-toggle-active",r.datepicker&&r.datepicker.opened)("mat-accent",r.datepicker&&"accent"===r.datepicker.color)("mat-warn",r.datepicker&&"warn"===r.datepicker.color))},inputs:{datepicker:["for","datepicker"],tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],disabled:"disabled",disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[a.TTD],ngContentSelectors:kAe,decls:4,vars:6,consts:[["mat-icon-button","","type","button",3,"disabled","disableRipple"],["button",""],["class","mat-datepicker-toggle-default-icon","viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",4,"ngIf"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(e,r){1&e&&(a.F$t(DAe),a.TgZ(0,"button",0,1),a.YNc(2,EAe,2,0,"svg",2),a.Hsn(3),a.qZA()),2&e&&(a.Q6J("disabled",r.disabled)("disableRipple",r.disableRipple),a.uIk("aria-haspopup",r.datepicker?"dialog":null)("aria-label",r.ariaLabel||r._intl.openCalendarLabel)("tabindex",r.disabled?-1:r.tabIndex),a.xp6(2),a.Q6J("ngIf",!r._customIcon))},dependencies:[Ur,js],styles:[".mat-form-field-appearance-legacy .mat-form-field-prefix .mat-datepicker-toggle-default-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-datepicker-toggle-default-icon{width:1em}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-datepicker-toggle-default-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-datepicker-toggle-default-icon{display:block;width:1.5em;height:1.5em}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-datepicker-toggle-default-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-datepicker-toggle-default-icon{margin:auto}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0}),n})(),YAe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[p1,UAe],imports:[No,pq,Rb,e$,Zg,$n,OI]}),n})();function _1(n){return new Cr.y(t=>{(0,Ru.Xf)(n()).subscribe(t)})}function KAe(n,t){}class m${constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0}}let toe=(()=>{class n extends a${constructor(e,r,i,s,o,l,c,u){super(),this._elementRef=e,this._focusTrapFactory=r,this._config=s,this._interactivityChecker=o,this._ngZone=l,this._overlayRef=c,this._focusMonitor=u,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=f=>{this._portalOutlet.hasAttached();const m=this._portalOutlet.attachDomPortal(f);return this._contentAttached(),m},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=i}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),r}attachTemplatePortal(e){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),r}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,r){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const i=()=>{e.removeEventListener("blur",i),e.removeEventListener("mousedown",i),e.removeAttribute("tabindex")};e.addEventListener("blur",i),e.addEventListener("mousedown",i)})),e.focus(r)}_focusByCssSelector(e,r){let i=this._elementRef.nativeElement.querySelector(e);i&&this._forceFocus(i,r)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{r||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const e=this._config.restoreFocus;let r=null;if("string"==typeof e?r=this._document.querySelector(e):"boolean"==typeof e?r=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(r=e),this._config.restoreFocus&&r&&"function"==typeof r.focus){const i=o1(),s=this._elementRef.nativeElement;(!i||i===this._document.body||i===s||s.contains(i))&&(this._focusMonitor?(this._focusMonitor.focusVia(r,this._closeInteractionType),this._closeInteractionType=null):r.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const e=this._elementRef.nativeElement,r=o1();return e===r||e.contains(r)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=o1())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(XL),a.Y36(Nt,8),a.Y36(m$),a.Y36(QL),a.Y36(a.R0b),a.Y36(u1),a.Y36(Xc))},n.\u0275cmp=a.Xpm({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(e,r){if(1&e&&a.Gf(ed,7),2&e){let i;a.iGM(i=a.CRH())&&(r._portalOutlet=i.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(e,r){2&e&&a.uIk("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledBy)("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},features:[a.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,r){1&e&&a.YNc(0,KAe,0,0,"ng-template",0)},dependencies:[ed],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),n})();class Aq{constructor(t,e){this.overlayRef=t,this.config=e,this.closed=new Xt.x,this.disableClose=e.disableClose,this.backdropClick=t.backdropClick(),this.keydownEvents=t.keydownEvents(),this.outsidePointerEvents=t.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(r=>{27===r.keyCode&&!this.disableClose&&!Il(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})})}close(t,e){if(this.containerInstance){const r=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this.overlayRef.dispose(),r.next(t),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(t="",e=""){return this.overlayRef.updateSize({width:t,height:e}),this}addPanelClass(t){return this.overlayRef.addPanelClass(t),this}removePanelClass(t){return this.overlayRef.removePanelClass(t),this}}const noe=new a.OlP("DialogScrollStrategy"),QAe=new a.OlP("DialogData"),XAe=new a.OlP("DefaultDialogConfig"),e1e={provide:noe,deps:[_a],useFactory:function JAe(n){return()=>n.scrollStrategies.block()}};let t1e=0,roe=(()=>{class n{constructor(e,r,i,s,o,l){this._overlay=e,this._injector=r,this._defaultOptions=i,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Xt.x,this._afterOpenedAtThisLevel=new Xt.x,this._ariaHiddenElements=new Map,this.afterAllClosed=_1(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ui(void 0))),this._scrollStrategy=l}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}open(e,r){(r={...this._defaultOptions||new m$,...r}).id=r.id||"cdk-dialog-"+t1e++,r.id&&this.getDialogById(r.id);const s=this._getOverlayConfig(r),o=this._overlay.create(s),l=new Aq(o,r),c=this._attachContainer(o,l,r);return l.containerInstance=c,this._attachDialogContent(e,l,c,r),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(l),l.closed.subscribe(()=>this._removeOpenDialog(l,!0)),this.afterOpened.next(l),l}closeAll(){Nq(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){Nq(this._openDialogsAtThisLevel,e=>{!1===e.config.closeOnDestroy&&this._removeOpenDialog(e,!1)}),Nq(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){const r=new FI({positionStrategy:e.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(r.backdropClass=e.backdropClass),r}_attachContainer(e,r,i){const s=i.injector||i.viewContainerRef?.injector,o=[{provide:m$,useValue:i},{provide:Aq,useValue:r},{provide:u1,useValue:e}];let l;i.container?"function"==typeof i.container?l=i.container:(l=i.container.type,o.push(...i.container.providers(i))):l=toe;const c=new qg(l,i.viewContainerRef,a.zs3.create({parent:s||this._injector,providers:o}),i.componentFactoryResolver);return e.attach(c).instance}_attachDialogContent(e,r,i,s){if(e instanceof a.Rgc){const o=this._createInjector(s,r,i,void 0);let l={$implicit:s.data,dialogRef:r};s.templateContext&&(l={...l,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),i.attachTemplatePortal(new Ab(e,null,l,o))}else{const o=this._createInjector(s,r,i,this._injector),l=i.attachComponentPortal(new qg(e,s.viewContainerRef,o,s.componentFactoryResolver));r.componentInstance=l.instance}}_createInjector(e,r,i,s){const o=e.injector||e.viewContainerRef?.injector,l=[{provide:QAe,useValue:e.data},{provide:Aq,useValue:r}];return e.providers&&("function"==typeof e.providers?l.push(...e.providers(r,e,i)):l.push(...e.providers)),e.direction&&(!o||!o.get(Ws,null,a.XFs.Optional))&&l.push({provide:Ws,useValue:{value:e.direction,change:St()}}),a.zs3.create({parent:o||s,providers:l})}_removeOpenDialog(e,r){const i=this.openDialogs.indexOf(e);i>-1&&(this.openDialogs.splice(i,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),r&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const r=e.parentElement.children;for(let i=r.length-1;i>-1;i--){const s=r[i];s!==e&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(_a),a.LFG(a.zs3),a.LFG(XAe,8),a.LFG(n,12),a.LFG(l$),a.LFG(noe))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();function Nq(n,t){let e=n.length;for(;e--;)t(n[e])}let n1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[roe,e1e],imports:[Rb,Zg,e$,Zg]}),n})();function r1e(n,t){}const LI={params:{enterAnimationDuration:"150ms",exitAnimationDuration:"75ms"}},i1e={dialogContainer:Bs("dialogContainer",[yi("void, exit",Sn({opacity:0,transform:"scale(0.7)"})),yi("enter",Sn({transform:"none"})),ei("* => enter",sw([_i("{{enterAnimationDuration}} cubic-bezier(0, 0, 0.2, 1)",Sn({transform:"none",opacity:1})),Xh("@*",cm(),{optional:!0})]),LI),ei("* => void, * => exit",sw([_i("{{exitAnimationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)",Sn({opacity:0})),Xh("@*",cm(),{optional:!0})]),LI)])};class g${constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0,this.enterAnimationDuration=LI.params.enterAnimationDuration,this.exitAnimationDuration=LI.params.exitAnimationDuration}}let s1e=(()=>{class n extends toe{constructor(e,r,i,s,o,l,c,u){super(e,r,i,s,o,l,c,u),this._animationStateChanged=new a.vpe}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(XL),a.Y36(Nt,8),a.Y36(g$),a.Y36(QL),a.Y36(a.R0b),a.Y36(u1),a.Y36(Xc))},n.\u0275cmp=a.Xpm({type:n,selectors:[["ng-component"]],features:[a.qOj],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),o1e=(()=>{class n extends s1e{constructor(e,r,i,s,o,l,c,u,f){super(e,r,i,s,o,l,c,f),this._changeDetectorRef=u,this._state="enter"}_onAnimationDone({toState:e,totalTime:r}){"enter"===e?this._openAnimationDone(r):"exit"===e&&this._animationStateChanged.next({state:"closed",totalTime:r})}_onAnimationStart({toState:e,totalTime:r}){"enter"===e?this._animationStateChanged.next({state:"opening",totalTime:r}):("exit"===e||"void"===e)&&this._animationStateChanged.next({state:"closing",totalTime:r})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}_getAnimationState(){return{value:this._state,params:{enterAnimationDuration:this._config.enterAnimationDuration||LI.params.enterAnimationDuration,exitAnimationDuration:this._config.exitAnimationDuration||LI.params.exitAnimationDuration}}}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(XL),a.Y36(Nt,8),a.Y36(g$),a.Y36(QL),a.Y36(a.R0b),a.Y36(u1),a.Y36(a.sBO),a.Y36(Xc))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-dialog-container"],hostVars:7,hostBindings:function(e,r){1&e&&a.WFA("@dialogContainer.start",function(s){return r._onAnimationStart(s)})("@dialogContainer.done",function(s){return r._onAnimationDone(s)}),2&e&&(a.Ikx("id",r._config.id),a.uIk("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledBy)("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),a.d8E("@dialogContainer",r._getAnimationState()))},features:[a.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,r){1&e&&a.YNc(0,r1e,0,0,"ng-template",0)},dependencies:[ed],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions.mat-dialog-actions-align-center,.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions.mat-dialog-actions-align-end,.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}"],encapsulation:2,data:{animation:[i1e.dialogContainer]}}),n})();class ioe{constructor(t,e,r){this._ref=t,this._containerInstance=r,this._afterOpened=new Xt.x,this._beforeClosed=new Xt.x,this._state=0,this.disableClose=e.disableClose,this.id=t.id,r._animationStateChanged.pipe(cr(i=>"opened"===i.state),nr(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(cr(i=>"closed"===i.state),nr(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),(0,cs.T)(this.backdropClick(),this.keydownEvents().pipe(cr(i=>27===i.keyCode&&!this.disableClose&&!Il(i)))).subscribe(i=>{this.disableClose||(i.preventDefault(),function a1e(n,t,e){n._closeInteractionType=t,n.close(e)}(this,"keydown"===i.type?"keyboard":"mouse"))})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(cr(e=>"closing"===e.state),nr(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(t){let e=this._ref.config.positionStrategy;return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(t="",e=""){return this._ref.updateSize(t,e),this}addPanelClass(t){return this._ref.addPanelClass(t),this}removePanelClass(t){return this._ref.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const Rq=new a.OlP("MatDialogData"),l1e=new a.OlP("mat-dialog-default-options"),soe=new a.OlP("mat-dialog-scroll-strategy"),u1e={provide:soe,deps:[_a],useFactory:function c1e(n){return()=>n.scrollStrategies.block()}};let d1e=0,h1e=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f,m){this._overlay=e,this._defaultOptions=i,this._parentDialog=s,this._dialogRefConstructor=c,this._dialogContainerType=u,this._dialogDataToken=f,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Xt.x,this._afterOpenedAtThisLevel=new Xt.x,this._idPrefix="mat-dialog-",this.afterAllClosed=_1(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ui(void 0))),this._scrollStrategy=l,this._dialog=r.get(roe)}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(e,r){let i;(r={...this._defaultOptions||new g$,...r}).id=r.id||`${this._idPrefix}${d1e++}`,r.scrollStrategy=r.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(e,{...r,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:g$,useValue:r},{provide:m$,useValue:r}]},templateContext:()=>({dialogRef:i}),providers:(o,l,c)=>(i=new this._dialogRefConstructor(o,r,c),i.updatePosition(r?.position),[{provide:this._dialogContainerType,useValue:c},{provide:this._dialogDataToken,useValue:l.data},{provide:this._dialogRefConstructor,useValue:i}])});return i.componentInstance=s.componentInstance,this.openDialogs.push(i),this.afterOpened.next(i),i.afterClosed().subscribe(()=>{const o=this.openDialogs.indexOf(i);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||this._getAfterAllClosed().next())}),i}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let r=e.length;for(;r--;)e[r].close()}}return n.\u0275fac=function(e){a.$Z()},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),Mq=(()=>{class n extends h1e{constructor(e,r,i,s,o,l,c,u){super(e,r,s,l,c,o,ioe,o1e,Rq,u)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(_a),a.LFG(a.zs3),a.LFG(_n,8),a.LFG(l1e,8),a.LFG(soe),a.LFG(n,12),a.LFG(l$),a.LFG(a.QbO,8))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),f1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-dialog-content"]}),n})(),p1e=(()=>{class n{constructor(){this.align="start"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-dialog-actions"],hostVars:4,hostBindings:function(e,r){2&e&&a.ekj("mat-dialog-actions-align-center","center"===r.align)("mat-dialog-actions-align-end","end"===r.align)},inputs:{align:"align"}}),n})(),m1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[Mq,u1e],imports:[n1e,Rb,Zg,$n,$n]}),n})(),Kg=(()=>{class n{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(e){this._vertical=xn(e)}get inset(){return this._inset}set inset(e){this._inset=xn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(e,r){2&e&&(a.uIk("aria-orientation",r.vertical?"vertical":"horizontal"),a.ekj("mat-divider-vertical",r.vertical)("mat-divider-horizontal",!r.vertical)("mat-divider-inset",r.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(e,r){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0}),n})(),g1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[$n,$n]}),n})();function Oq(){return(0,ti.e)((n,t)=>{let e=null;n._refCount++;const r=(0,zr.x)(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const i=n._connection,s=e;e=null,i&&(!s||i===s)&&i.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class Fq extends Cr.y{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,(0,ti.A)(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new kn.w0;const e=this.getSubject();t.add(this.source.subscribe((0,zr.x)(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=kn.w0.EMPTY)}return t}refCount(){return Oq()(this)}}function Pq(n){return n&&"function"==typeof n.connect&&!(n instanceof Fq)}class ooe{applyChanges(t,e,r,i,s){t.forEachOperation((o,l,c)=>{let u,f;if(null==o.previousIndex){const m=r(o,l,c);u=e.createEmbeddedView(m.templateRef,m.context,m.index),f=1}else null==c?(e.remove(l),f=3):(u=e.get(l),e.move(u,c),f=2);s&&s({context:u?.context,operation:f,record:o})})}detach(){}}class _1e{constructor(t=!1,e,r=!0,i){this._multiple=t,this._emitChanges=r,this.compareWith=i,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new Xt.x,e&&e.length&&(t?e.forEach(s=>this._markSelected(s)):this._markSelected(e[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...t){this._verifyValueAssignment(t),t.forEach(r=>this._markSelected(r));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...t){this._verifyValueAssignment(t),t.forEach(r=>this._unmarkSelected(r));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...t){this._verifyValueAssignment(t);const e=this.selected,r=new Set(t);t.forEach(s=>this._markSelected(s)),e.filter(s=>!r.has(s)).forEach(s=>this._unmarkSelected(s));const i=this._hasQueuedChanges();return this._emitChangeEvent(),i}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();const e=this._hasQueuedChanges();return t&&this._emitChangeEvent(),e}isSelected(t){if(this.compareWith){for(const e of this._selection)if(this.compareWith(e,t))return!0;return!1}return this._selection.has(t)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}}let Lq=(()=>{class n{constructor(){this._listeners=[]}notify(e,r){for(let i of this._listeners)i(e,r)}listen(e){return this._listeners.push(e),()=>{this._listeners=this._listeners.filter(r=>e!==r)}}ngOnDestroy(){this._listeners=[]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const y1=new a.OlP("_ViewRepeater");let y1e=0;const $q=new a.OlP("CdkAccordion");let v1e=(()=>{class n{constructor(){this._stateChanges=new Xt.x,this._openCloseAllActions=new Xt.x,this.id="cdk-accordion-"+y1e++,this._multi=!1}get multi(){return this._multi}set multi(e){this._multi=xn(e)}openAll(){this._multi&&this._openCloseAllActions.next(!0)}closeAll(){this._openCloseAllActions.next(!1)}ngOnChanges(e){this._stateChanges.next(e)}ngOnDestroy(){this._stateChanges.complete(),this._openCloseAllActions.complete()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:"multi"},exportAs:["cdkAccordion"],features:[a._Bn([{provide:$q,useExisting:n}]),a.TTD]}),n})(),b1e=0,w1e=(()=>{class n{constructor(e,r,i){this.accordion=e,this._changeDetectorRef=r,this._expansionDispatcher=i,this._openCloseAllSubscription=kn.w0.EMPTY,this.closed=new a.vpe,this.opened=new a.vpe,this.destroyed=new a.vpe,this.expandedChange=new a.vpe,this.id="cdk-accordion-child-"+b1e++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=i.listen((s,o)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===o&&this.id!==s&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}get expanded(){return this._expanded}set expanded(e){e=xn(e),this._expanded!==e&&(this._expanded=e,this.expandedChange.emit(e),e?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(e){this._disabled=xn(e)}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(e=>{this.disabled||(this.expanded=e)})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36($q,12),a.Y36(a.sBO),a.Y36(Lq))},n.\u0275dir=a.lG2({type:n,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[a._Bn([{provide:$q,useValue:void 0}])]}),n})(),C1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({}),n})();const x1e=["body"];function I1e(n,t){}const T1e=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],S1e=["mat-expansion-panel-header","*","mat-action-row"];function E1e(n,t){if(1&n&&a._UZ(0,"span",2),2&n){const e=a.oxw();a.Q6J("@indicatorRotate",e._getExpandedState())}}const D1e=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],k1e=["mat-panel-title","mat-panel-description","*"],Bq=new a.OlP("MAT_ACCORDION"),loe="225ms cubic-bezier(0.4,0.0,0.2,1)",coe={indicatorRotate:Bs("indicatorRotate",[yi("collapsed, void",Sn({transform:"rotate(0deg)"})),yi("expanded",Sn({transform:"rotate(180deg)"})),ei("expanded <=> collapsed, void => collapsed",_i(loe))]),bodyExpansion:Bs("bodyExpansion",[yi("collapsed, void",Sn({height:"0px",visibility:"hidden"})),yi("expanded",Sn({height:"*",visibility:"visible"})),ei("expanded <=> collapsed, void => collapsed",_i(loe))])},uoe=new a.OlP("MAT_EXPANSION_PANEL");let A1e=(()=>{class n{constructor(e,r){this._template=e,this._expansionPanel=r}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc),a.Y36(uoe,8))},n.\u0275dir=a.lG2({type:n,selectors:[["ng-template","matExpansionPanelContent",""]]}),n})(),N1e=0;const doe=new a.OlP("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let hoe=(()=>{class n extends w1e{constructor(e,r,i,s,o,l,c){super(e,r,i),this._viewContainerRef=s,this._animationMode=l,this._hideToggle=!1,this.afterExpand=new a.vpe,this.afterCollapse=new a.vpe,this._inputChanges=new Xt.x,this._headerId="mat-expansion-panel-header-"+N1e++,this._bodyAnimationDone=new Xt.x,this.accordion=e,this._document=o,this._bodyAnimationDone.pipe($u((u,f)=>u.fromState===f.fromState&&u.toState===f.toState)).subscribe(u=>{"void"!==u.fromState&&("expanded"===u.toState?this.afterExpand.emit():"collapsed"===u.toState&&this.afterCollapse.emit())}),c&&(this.hideToggle=c.hideToggle)}get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(e){this._hideToggle=xn(e)}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(e){this._togglePosition=e}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(Ui(null),cr(()=>this.expanded&&!this._portal),nr(1)).subscribe(()=>{this._portal=new Ab(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(e){this._inputChanges.next(e)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){const e=this._document.activeElement,r=this._body.nativeElement;return e===r||r.contains(e)}return!1}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(Bq,12),a.Y36(a.sBO),a.Y36(Lq),a.Y36(a.s_b),a.Y36(Nt),a.Y36(a.QbO,8),a.Y36(doe,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-expansion-panel"]],contentQueries:function(e,r,i){if(1&e&&a.Suo(i,A1e,5),2&e){let s;a.iGM(s=a.CRH())&&(r._lazyContent=s.first)}},viewQuery:function(e,r){if(1&e&&a.Gf(x1e,5),2&e){let i;a.iGM(i=a.CRH())&&(r._body=i.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(e,r){2&e&&a.ekj("mat-expanded",r.expanded)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-expansion-panel-spacing",r._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[a._Bn([{provide:Bq,useValue:void 0},{provide:uoe,useExisting:n}]),a.qOj,a.TTD],ngContentSelectors:S1e,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(e,r){1&e&&(a.F$t(T1e),a.Hsn(0),a.TgZ(1,"div",0,1),a.NdJ("@bodyExpansion.done",function(s){return r._bodyAnimationDone.next(s)}),a.TgZ(3,"div",2),a.Hsn(4,1),a.YNc(5,I1e,0,0,"ng-template",3),a.qZA(),a.Hsn(6,2),a.qZA()),2&e&&(a.xp6(1),a.Q6J("@bodyExpansion",r._getExpandedState())("id",r.id),a.uIk("aria-labelledby",r._headerId),a.xp6(4),a.Q6J("cdkPortalOutlet",r._portal))},dependencies:[ed],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[coe.bodyExpansion]},changeDetection:0}),n})();class R1e{}const M1e=t$(R1e);let foe=(()=>{class n extends M1e{constructor(e,r,i,s,o,l,c){super(),this.panel=e,this._element=r,this._focusMonitor=i,this._changeDetectorRef=s,this._animationMode=l,this._parentChangeSubscription=kn.w0.EMPTY;const u=e.accordion?e.accordion._stateChanges.pipe(cr(f=>!(!f.hideToggle&&!f.togglePosition))):Ga.E;this.tabIndex=parseInt(c||"")||0,this._parentChangeSubscription=(0,cs.T)(e.opened,e.closed,u,e._inputChanges.pipe(cr(f=>!!(f.hideToggle||f.disabled||f.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),e.closed.pipe(cr(()=>e._containsFocus())).subscribe(()=>i.focusVia(r,"program")),o&&(this.expandedHeight=o.expandedHeight,this.collapsedHeight=o.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const e=this._isExpanded();return e&&this.expandedHeight?this.expandedHeight:!e&&this.collapsedHeight?this.collapsedHeight:null}_keydown(e){switch(e.keyCode){case 32:case 13:Il(e)||(e.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(e))}}focus(e,r){e?this._focusMonitor.focusVia(this._element,e,r):this._element.nativeElement.focus(r)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(e=>{e&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(hoe,1),a.Y36(a.SBq),a.Y36(Xc),a.Y36(a.sBO),a.Y36(doe,8),a.Y36(a.QbO,8),a.$8M("tabindex"))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(e,r){1&e&&a.NdJ("click",function(){return r._toggle()})("keydown",function(s){return r._keydown(s)}),2&e&&(a.uIk("id",r.panel._headerId)("tabindex",r.tabIndex)("aria-controls",r._getPanelId())("aria-expanded",r._isExpanded())("aria-disabled",r.panel.disabled),a.Udp("height",r._getHeaderHeight()),a.ekj("mat-expanded",r._isExpanded())("mat-expansion-toggle-indicator-after","after"===r._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===r._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===r._animationMode))},inputs:{tabIndex:"tabIndex",expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},features:[a.qOj],ngContentSelectors:k1e,decls:5,vars:3,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(e,r){1&e&&(a.F$t(D1e),a.TgZ(0,"span",0),a.Hsn(1),a.Hsn(2,1),a.Hsn(3,2),a.qZA(),a.YNc(4,E1e,1,1,"span",1)),2&e&&(a.ekj("mat-content-hide-toggle",!r._showToggle()),a.xp6(4),a.Q6J("ngIf",r._showToggle()))},dependencies:[Ur],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[coe.indicatorRotate]},changeDetection:0}),n})(),O1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-panel-description"]],hostAttrs:[1,"mat-expansion-panel-header-description"]}),n})(),F1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"]}),n})(),P1e=(()=>{class n extends v1e{constructor(){super(...arguments),this._ownHeaders=new a.n_E,this._hideToggle=!1,this.displayMode="default",this.togglePosition="after"}get hideToggle(){return this._hideToggle}set hideToggle(e){this._hideToggle=xn(e)}ngAfterContentInit(){this._headers.changes.pipe(Ui(this._headers)).subscribe(e=>{this._ownHeaders.reset(e.filter(r=>r.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new aq(this._ownHeaders).withWrap().withHomeAndEnd()}_handleHeaderKeydown(e){this._keyManager.onKeydown(e)}_handleHeaderFocus(e){this._keyManager.updateActiveItem(e)}ngOnDestroy(){super.ngOnDestroy(),this._ownHeaders.destroy()}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["mat-accordion"]],contentQueries:function(e,r,i){if(1&e&&a.Suo(i,foe,5),2&e){let s;a.iGM(s=a.CRH())&&(r._headers=s)}},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(e,r){2&e&&a.ekj("mat-accordion-multi",r.multi)},inputs:{multi:"multi",hideToggle:"hideToggle",displayMode:"displayMode",togglePosition:"togglePosition"},exportAs:["matAccordion"],features:[a._Bn([{provide:Bq,useExisting:n}]),a.qOj]}),n})(),L1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[No,$n,C1e,Zg]}),n})();const poe=["*"];class B1e{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const t=Math.max(...this.tracker);return t>1?this.rowCount+t-1:this.rowCount}update(t,e){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(t),this.tracker.fill(0,0,this.tracker.length),this.positions=e.map(r=>this._trackTile(r))}_trackTile(t){const e=this._findMatchingGap(t.colspan);return this._markTilePosition(e,t),this.columnIndex=e+t.colspan,new V1e(this.rowIndex,e)}_findMatchingGap(t){let e=-1,r=-1;do{this.columnIndex+t>this.tracker.length?(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),r=this._findGapEndIndex(e)):(e=this.tracker.indexOf(0,this.columnIndex),-1!=e?(r=this._findGapEndIndex(e),this.columnIndex=e+1):(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),r=this._findGapEndIndex(e)))}while(r-e<t||0==r);return Math.max(e,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let t=0;t<this.tracker.length;t++)this.tracker[t]=Math.max(0,this.tracker[t]-1)}_findGapEndIndex(t){for(let e=t+1;e<this.tracker.length;e++)if(0!=this.tracker[e])return e;return this.tracker.length}_markTilePosition(t,e){for(let r=0;r<e.colspan;r++)this.tracker[t+r]=e.rowspan}}class V1e{constructor(t,e){this.row=t,this.col=e}}const moe=new a.OlP("MAT_GRID_LIST");let goe=(()=>{class n{constructor(e,r){this._element=e,this._gridList=r,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(e){this._rowspan=Math.round(ga(e))}get colspan(){return this._colspan}set colspan(e){this._colspan=Math.round(ga(e))}_setStyle(e,r){this._element.nativeElement.style[e]=r}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(moe,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(e,r){2&e&&a.uIk("rowspan",r.rowspan)("colspan",r.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:poe,decls:2,vars:0,consts:[[1,"mat-grid-tile-content"]],template:function(e,r){1&e&&(a.F$t(),a.TgZ(0,"div",0),a.Hsn(1),a.qZA())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}"],encapsulation:2,changeDetection:0}),n})();const U1e=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class Vq{constructor(){this._rows=0,this._rowspan=0}init(t,e,r,i){this._gutterSize=_oe(t),this._rows=e.rowCount,this._rowspan=e.rowspan,this._cols=r,this._direction=i}getBaseTileSize(t,e){return`(${t}% - (${this._gutterSize} * ${e}))`}getTilePosition(t,e){return 0===e?"0":Ob(`(${t} + ${this._gutterSize}) * ${e}`)}getTileSize(t,e){return`(${t} * ${e}) + (${e-1} * ${this._gutterSize})`}setStyle(t,e,r){let i=100/this._cols,s=(this._cols-1)/this._cols;this.setColStyles(t,r,i,s),this.setRowStyles(t,e,i,s)}setColStyles(t,e,r,i){let s=this.getBaseTileSize(r,i);t._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(s,e)),t._setStyle("width",Ob(this.getTileSize(s,t.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(t){return`${this._rowspan} * ${this.getTileSize(t,1)}`}getComputedHeight(){return null}}class z1e extends Vq{constructor(t){super(),this.fixedRowHeight=t}init(t,e,r,i){super.init(t,e,r,i),this.fixedRowHeight=_oe(this.fixedRowHeight),U1e.test(this.fixedRowHeight)}setRowStyles(t,e){t._setStyle("top",this.getTilePosition(this.fixedRowHeight,e)),t._setStyle("height",Ob(this.getTileSize(this.fixedRowHeight,t.rowspan)))}getComputedHeight(){return["height",Ob(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["height",null]),t._tiles&&t._tiles.forEach(e=>{e._setStyle("top",null),e._setStyle("height",null)})}}class H1e extends Vq{constructor(t){super(),this._parseRatio(t)}setRowStyles(t,e,r,i){this.baseTileHeight=this.getBaseTileSize(r/this.rowHeightRatio,i),t._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,e)),t._setStyle("paddingTop",Ob(this.getTileSize(this.baseTileHeight,t.rowspan)))}getComputedHeight(){return["paddingBottom",Ob(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["paddingBottom",null]),t._tiles.forEach(e=>{e._setStyle("marginTop",null),e._setStyle("paddingTop",null)})}_parseRatio(t){const e=t.split(":");this.rowHeightRatio=parseFloat(e[0])/parseFloat(e[1])}}class G1e extends Vq{setRowStyles(t,e){let s=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);t._setStyle("top",this.getTilePosition(s,e)),t._setStyle("height",Ob(this.getTileSize(s,t.rowspan)))}reset(t){t._tiles&&t._tiles.forEach(e=>{e._setStyle("top",null),e._setStyle("height",null)})}}function Ob(n){return`calc(${n})`}function _oe(n){return n.match(/([A-Za-z%]+)$/)?n:`${n}px`}let j1e=(()=>{class n{constructor(e,r){this._element=e,this._dir=r,this._gutter="1px"}get cols(){return this._cols}set cols(e){this._cols=Math.max(1,Math.round(ga(e)))}get gutterSize(){return this._gutter}set gutterSize(e){this._gutter=`${e??""}`}get rowHeight(){return this._rowHeight}set rowHeight(e){const r=`${e??""}`;r!==this._rowHeight&&(this._rowHeight=r,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(e){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===e?new G1e:e&&e.indexOf(":")>-1?new H1e(e):new z1e(e)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new B1e);const e=this._tileCoordinator,r=this._tiles.filter(s=>!s._gridList||s._gridList===this),i=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,r),this._tileStyler.init(this.gutterSize,e,this.cols,i),r.forEach((s,o)=>{const l=e.positions[o];this._tileStyler.setStyle(s,l.row,l.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(e){e&&(this._element.nativeElement.style[e[0]]=e[1])}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Ws,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-grid-list"]],contentQueries:function(e,r,i){if(1&e&&a.Suo(i,goe,5),2&e){let s;a.iGM(s=a.CRH())&&(r._tiles=s)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(e,r){2&e&&a.uIk("cols",r.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[a._Bn([{provide:moe,useExisting:n}])],ngContentSelectors:poe,decls:2,vars:0,template:function(e,r){1&e&&(a.F$t(),a.TgZ(0,"div"),a.Hsn(1),a.qZA())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}"],encapsulation:2,changeDetection:0}),n})(),q1e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[rse,$n,rse,$n]}),n})();function yo(n,t){const e=(0,Po.m)(n)?n:()=>n,r=i=>i.error(e());return new Cr.y(t?i=>t.schedule(r,0,i):r)}function ts(n){return(0,ti.e)((t,e)=>{let s,r=null,i=!1;r=t.subscribe((0,zr.x)(e,void 0,void 0,o=>{s=(0,Ru.Xf)(n(o,ts(n)(t))),r?(r.unsubscribe(),r=null,s.subscribe(e)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(e))})}function v1(n){return(0,ti.e)((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const Z1e=["*"];let _$;function b1(n){return function Y1e(){if(void 0===_$&&(_$=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(_$=n.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return _$}()?.createHTML(n)||n}function yoe(n){return Error(`Unable to find icon with the name "${n}"`)}function voe(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function boe(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class Fb{constructor(t,e,r){this.url=t,this.svgText=e,this.options=r}}let y$=(()=>{class n{constructor(e,r,i,s){this._httpClient=e,this._sanitizer=r,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=i}addSvgIcon(e,r,i){return this.addSvgIconInNamespace("",e,r,i)}addSvgIconLiteral(e,r,i){return this.addSvgIconLiteralInNamespace("",e,r,i)}addSvgIconInNamespace(e,r,i,s){return this._addSvgIconConfig(e,r,new Fb(i,null,s))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,r,i,s){const o=this._sanitizer.sanitize(a.q3G.HTML,i);if(!o)throw boe(i);const l=b1(o);return this._addSvgIconConfig(e,r,new Fb("",l,s))}addSvgIconSet(e,r){return this.addSvgIconSetInNamespace("",e,r)}addSvgIconSetLiteral(e,r){return this.addSvgIconSetLiteralInNamespace("",e,r)}addSvgIconSetInNamespace(e,r,i){return this._addSvgIconSetConfig(e,new Fb(r,null,i))}addSvgIconSetLiteralInNamespace(e,r,i){const s=this._sanitizer.sanitize(a.q3G.HTML,r);if(!s)throw boe(r);const o=b1(s);return this._addSvgIconSetConfig(e,new Fb("",o,i))}registerFontClassAlias(e,r=e){return this._fontCssClassesByAlias.set(e,r),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const r=this._sanitizer.sanitize(a.q3G.RESOURCE_URL,e);if(!r)throw voe(e);const i=this._cachedIconsByUrl.get(r);return i?St(v$(i)):this._loadSvgIconFromConfig(new Fb(e,null)).pipe(Qr(s=>this._cachedIconsByUrl.set(r,s)),(0,Ot.U)(s=>v$(s)))}getNamedSvgIcon(e,r=""){const i=woe(r,e);let s=this._svgIconConfigs.get(i);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(r,e),s)return this._svgIconConfigs.set(i,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(r);return o?this._getSvgFromIconSetConfigs(e,o):yo(yoe(i))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?St(v$(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe((0,Ot.U)(r=>v$(r)))}_getSvgFromIconSetConfigs(e,r){const i=this._extractIconWithNameFromAnySet(e,r);return i?St(i):bM(r.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(ts(l=>{const u=`Loading icon set URL: ${this._sanitizer.sanitize(a.q3G.RESOURCE_URL,o.url)} failed: ${l.message}`;return this._errorHandler.handleError(new Error(u)),St(null)})))).pipe((0,Ot.U)(()=>{const o=this._extractIconWithNameFromAnySet(e,r);if(!o)throw yoe(e);return o}))}_extractIconWithNameFromAnySet(e,r){for(let i=r.length-1;i>=0;i--){const s=r[i];if(s.svgText&&s.svgText.toString().indexOf(e)>-1){const o=this._svgElementFromConfig(s),l=this._extractSvgIconFromSet(o,e,s.options);if(l)return l}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Qr(r=>e.svgText=r),(0,Ot.U)(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?St(null):this._fetchIcon(e).pipe(Qr(r=>e.svgText=r))}_extractSvgIconFromSet(e,r,i){const s=e.querySelector(`[id="${r}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,i);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),i);const l=this._svgElementFromString(b1("<svg></svg>"));return l.appendChild(o),this._setSvgAttributes(l,i)}_svgElementFromString(e){const r=this._document.createElement("DIV");r.innerHTML=e;const i=r.querySelector("svg");if(!i)throw Error("<svg> tag not found");return i}_toSvgElement(e){const r=this._svgElementFromString(b1("<svg></svg>")),i=e.attributes;for(let s=0;s<i.length;s++){const{name:o,value:l}=i[s];"id"!==o&&r.setAttribute(o,l)}for(let s=0;s<e.childNodes.length;s++)e.childNodes[s].nodeType===this._document.ELEMENT_NODE&&r.appendChild(e.childNodes[s].cloneNode(!0));return r}_setSvgAttributes(e,r){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),r&&r.viewBox&&e.setAttribute("viewBox",r.viewBox),e}_fetchIcon(e){const{url:r,options:i}=e,s=i?.withCredentials??!1;if(!this._httpClient)throw function K1e(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const o=this._sanitizer.sanitize(a.q3G.RESOURCE_URL,r);if(!o)throw voe(r);const l=this._inProgressUrlFetches.get(o);if(l)return l;const c=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe((0,Ot.U)(u=>b1(u)),v1(()=>this._inProgressUrlFetches.delete(o)),(0,Gm.B)());return this._inProgressUrlFetches.set(o,c),c}_addSvgIconConfig(e,r,i){return this._svgIconConfigs.set(woe(e,r),i),this}_addSvgIconSetConfig(e,r){const i=this._iconSetConfigs.get(e);return i?i.push(r):this._iconSetConfigs.set(e,[r]),this}_svgElementFromConfig(e){if(!e.svgElement){const r=this._svgElementFromString(e.svgText);this._setSvgAttributes(r,e.options),e.svgElement=r}return e.svgElement}_getIconConfigFromResolvers(e,r){for(let i=0;i<this._resolvers.length;i++){const s=this._resolvers[i](r,e);if(s)return X1e(s)?new Fb(s.url,null,s.options):new Fb(s,null)}}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Oc,8),a.LFG(Iu),a.LFG(Nt,8),a.LFG(a.qLn))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function v$(n){return n.cloneNode(!0)}function woe(n,t){return n+":"+t}function X1e(n){return!(!n.url||!n.options)}const J1e=cp(class{constructor(n){this._elementRef=n}}),eNe=new a.OlP("MAT_ICON_DEFAULT_OPTIONS"),tNe=new a.OlP("mat-icon-location",{providedIn:"root",factory:function nNe(){const n=(0,a.f3M)(Nt),t=n?n.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),Coe=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],rNe=Coe.map(n=>`[${n}]`).join(", "),iNe=/^url\(['"]?#(.*?)['"]?\)$/;let td=(()=>{class n extends J1e{constructor(e,r,i,s,o,l){super(e),this._iconRegistry=r,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=kn.w0.EMPTY,l&&(l.color&&(this.color=this.defaultColor=l.color),l.fontSet&&(this.fontSet=l.fontSet)),i||e.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(e){this._inline=xn(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const r=this._cleanupFontValue(e);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const r=this._cleanupFontValue(e);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}_splitIconName(e){if(!e)return["",""];const r=e.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let r=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){const i=e.childNodes[r];(1!==i.nodeType||"svg"===i.nodeName.toLowerCase())&&i.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(i=>i.length>0);this._previousFontSetClass.forEach(i=>e.classList.remove(i)),r.forEach(i=>e.classList.add(i)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const r=this._elementsWithExternalReferences;r&&r.forEach((i,s)=>{i.forEach(o=>{s.setAttribute(o.name,`url('${e}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(e){const r=e.querySelectorAll(rNe),i=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<r.length;s++)Coe.forEach(o=>{const l=r[s],c=l.getAttribute(o),u=c?c.match(iNe):null;if(u){let f=i.get(l);f||(f=[],i.set(l,f)),f.push({name:o,value:u[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[r,i]=this._splitIconName(e);r&&(this._svgNamespace=r),i&&(this._svgName=i),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(i,r).pipe(nr(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${r}:${i}! ${s.message}`))})}}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(y$),a.$8M("aria-hidden"),a.Y36(tNe),a.Y36(a.qLn),a.Y36(eNe,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(e,r){2&e&&(a.uIk("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),a.ekj("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[a.qOj],ngContentSelectors:Z1e,decls:1,vars:0,template:function(e,r){1&e&&(a.F$t(),a.Hsn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),sNe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[$n,$n]}),n})();function xoe(n){return(0,Ot.U)(()=>n)}function Ioe(n,t){return t?e=>Vk(t.pipe(nr(1),function oNe(){return(0,ti.e)((n,t)=>{n.subscribe((0,zr.x)(t,vC.Z))})}()),e.pipe(Ioe(n))):(0,Cs.z)((e,r)=>n(e,r).pipe(nr(1),xoe(e)))}function Toe(n,t=Fc){const e=o$(n,t);return Ioe(()=>e)}const aNe=["mat-menu-item",""];function lNe(n,t){1&n&&(a.O4$(),a.TgZ(0,"svg",2),a._UZ(1,"polygon",3),a.qZA())}const Soe=["*"];function cNe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",0),a.NdJ("keydown",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._handleKeydown(i))})("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.closed.emit("click"))})("@transformMenu.start",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._onAnimationStart(i))})("@transformMenu.done",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._onAnimationDone(i))}),a.TgZ(1,"div",1),a.Hsn(2),a.qZA()()}if(2&n){const e=a.oxw();a.Q6J("id",e.panelId)("ngClass",e._classList)("@transformMenu",e._panelAnimationState),a.uIk("aria-label",e.ariaLabel||null)("aria-labelledby",e.ariaLabelledby||null)("aria-describedby",e.ariaDescribedby||null)}}const b$={transformMenu:Bs("transformMenu",[yi("void",Sn({opacity:0,transform:"scale(0.8)"})),ei("void => enter",_i("120ms cubic-bezier(0, 0, 0.2, 1)",Sn({opacity:1,transform:"scale(1)"}))),ei("* => void",_i("100ms 25ms linear",Sn({opacity:0})))]),fadeInItems:Bs("fadeInItems",[yi("showing",Sn({opacity:1})),ei("void => *",[Sn({opacity:0}),_i("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},uNe=new a.OlP("MatMenuContent"),Uq=new a.OlP("MAT_MENU_PANEL"),dNe=RI(NI(class{}));let w1=(()=>{class n extends dNe{constructor(e,r,i,s,o){super(),this._elementRef=e,this._document=r,this._focusMonitor=i,this._parentMenu=s,this._changeDetectorRef=o,this.role="menuitem",this._hovered=new Xt.x,this._focused=new Xt.x,this._highlighted=!1,this._triggersSubmenu=!1,s?.addItem?.(this)}focus(e,r){this._focusMonitor&&e?this._focusMonitor.focusVia(this._getHostElement(),e,r):this._getHostElement().focus(r),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const e=this._elementRef.nativeElement.cloneNode(!0),r=e.querySelectorAll("mat-icon, .material-icons");for(let i=0;i<r.length;i++)r[i].remove();return e.textContent?.trim()||""}_setHighlighted(e){this._highlighted=e,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Nt),a.Y36(Xc),a.Y36(Uq,8),a.Y36(a.sBO))},n.\u0275cmp=a.Xpm({type:n,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:10,hostBindings:function(e,r){1&e&&a.NdJ("click",function(s){return r._checkDisabled(s)})("mouseenter",function(){return r._handleMouseEnter()}),2&e&&(a.uIk("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled.toString())("disabled",r.disabled||null),a.ekj("mat-menu-item",!0)("mat-menu-item-highlighted",r._highlighted)("mat-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[a.qOj],attrs:aNe,ngContentSelectors:Soe,decls:3,vars:3,consts:[["matRipple","",1,"mat-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-menu-submenu-icon","viewBox","0 0 5 10","focusable","false",4,"ngIf"],["viewBox","0 0 5 10","focusable","false",1,"mat-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(e,r){1&e&&(a.F$t(),a.Hsn(0),a._UZ(1,"div",0),a.YNc(2,lNe,2,0,"svg",1)),2&e&&(a.xp6(1),a.Q6J("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),a.xp6(1),a.Q6J("ngIf",r._triggersSubmenu))},dependencies:[Ur,fh],encapsulation:2,changeDetection:0}),n})();const Eoe=new a.OlP("mat-menu-default-options",{providedIn:"root",factory:function hNe(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let fNe=0,C1=(()=>{class n{constructor(e,r,i,s){this._elementRef=e,this._ngZone=r,this._defaultOptions=i,this._changeDetectorRef=s,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._directDescendantItems=new a.n_E,this._tabSubscription=kn.w0.EMPTY,this._classList={},this._panelAnimationState="void",this._animationDone=new Xt.x,this.overlayPanelClass=this._defaultOptions.overlayPanelClass||"",this.backdropClass=this._defaultOptions.backdropClass,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop,this.closed=new a.vpe,this.close=this.closed,this.panelId="mat-menu-panel-"+fNe++}get xPosition(){return this._xPosition}set xPosition(e){this._xPosition=e,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(e){this._yPosition=e,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(e){this._overlapTrigger=xn(e)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=xn(e)}set panelClass(e){const r=this._previousPanelClass;r&&r.length&&r.split(" ").forEach(i=>{this._classList[i]=!1}),this._previousPanelClass=e,e&&e.length&&(e.split(" ").forEach(i=>{this._classList[i]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(e){this.panelClass=e}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new aq(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._tabSubscription=this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(Ui(this._directDescendantItems),wn(e=>(0,cs.T)(...e.map(r=>r._focused)))).subscribe(e=>this._keyManager.updateActiveItem(e)),this._directDescendantItems.changes.subscribe(e=>{const r=this._keyManager;if("enter"===this._panelAnimationState&&r.activeItem?._hasFocus()){const i=e.toArray(),s=Math.max(0,Math.min(i.length-1,r.activeItemIndex||0));i[s]&&!i[s].disabled?r.setActiveItem(s):r.setNextItemActive()}})}ngOnDestroy(){this._directDescendantItems.destroy(),this._tabSubscription.unsubscribe(),this.closed.complete()}_hovered(){return this._directDescendantItems.changes.pipe(Ui(this._directDescendantItems),wn(r=>(0,cs.T)(...r.map(i=>i._hovered))))}addItem(e){}removeItem(e){}_handleKeydown(e){const r=e.keyCode,i=this._keyManager;switch(r){case 27:Il(e)||(e.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===r||40===r)&&i.setFocusOrigin("keyboard"),void i.onKeydown(e)}e.stopPropagation()}focusFirstItem(e="program"){this._ngZone.onStable.pipe(nr(1)).subscribe(()=>{let r=null;if(this._directDescendantItems.length&&(r=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!r||!r.contains(document.activeElement)){const i=this._keyManager;i.setFocusOrigin(e).setFirstItemActive(),!i.activeItem&&r&&r.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(e){const r=Math.min(this._baseElevation+e,24),i=`${this._elevationPrefix}${r}`,s=Object.keys(this._classList).find(o=>o.startsWith(this._elevationPrefix));(!s||s===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[i]=!0,this._previousElevation=i)}setPositionClasses(e=this.xPosition,r=this.yPosition){const i=this._classList;i["mat-menu-before"]="before"===e,i["mat-menu-after"]="after"===e,i["mat-menu-above"]="above"===r,i["mat-menu-below"]="below"===r,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(e){this._animationDone.next(e),this._isAnimating=!1}_onAnimationStart(e){this._isAnimating=!0,"enter"===e.toState&&0===this._keyManager.activeItemIndex&&(e.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(Ui(this._allItems)).subscribe(e=>{this._directDescendantItems.reset(e.filter(r=>r._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(Eoe),a.Y36(a.sBO))},n.\u0275dir=a.lG2({type:n,contentQueries:function(e,r,i){if(1&e&&(a.Suo(i,uNe,5),a.Suo(i,w1,5),a.Suo(i,w1,4)),2&e){let s;a.iGM(s=a.CRH())&&(r.lazyContent=s.first),a.iGM(s=a.CRH())&&(r._allItems=s),a.iGM(s=a.CRH())&&(r.items=s)}},viewQuery:function(e,r){if(1&e&&a.Gf(a.Rgc,5),2&e){let i;a.iGM(i=a.CRH())&&(r.templateRef=i.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),n})(),Doe=(()=>{class n extends C1{constructor(e,r,i,s){super(e,r,i,s),this._elevationPrefix="mat-elevation-z",this._baseElevation=4}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(Eoe),a.Y36(a.sBO))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-menu"]],hostVars:3,hostBindings:function(e,r){2&e&&a.uIk("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[a._Bn([{provide:Uq,useExisting:n}]),a.qOj],ngContentSelectors:Soe,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-menu-panel",3,"id","ngClass","keydown","click"],[1,"mat-menu-content"]],template:function(e,r){1&e&&(a.F$t(),a.YNc(0,cNe,3,6,"ng-template"))},dependencies:[Aa],styles:['mat-menu{display:none}.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:4px;outline:0;min-height:64px;position:relative}.mat-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-menu-panel{outline:solid 1px}.mat-menu-content:not(:empty){padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative}.mat-menu-item::-moz-focus-inner{border:0}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.cdk-high-contrast-active .mat-menu-item{margin-top:1px}.mat-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-menu-submenu-icon{fill:CanvasText}button.mat-menu-item{width:100%}.mat-menu-item .mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[b$.transformMenu,b$.fadeInItems]},changeDetection:0}),n})();const koe=new a.OlP("mat-menu-scroll-strategy"),mNe={provide:koe,deps:[_a],useFactory:function pNe(n){return()=>n.scrollStrategies.reposition()}},Aoe=Tb({passive:!0});let gNe=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f){this._overlay=e,this._element=r,this._viewContainerRef=i,this._menuItemInstance=l,this._dir=c,this._focusMonitor=u,this._ngZone=f,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=kn.w0.EMPTY,this._hoverSubscription=kn.w0.EMPTY,this._menuCloseSubscription=kn.w0.EMPTY,this._handleTouchStart=m=>{cq(m)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new a.vpe,this.onMenuOpen=this.menuOpened,this.menuClosed=new a.vpe,this.onMenuClose=this.menuClosed,this._scrollStrategy=s,this._parentMaterialMenu=o instanceof C1?o:void 0,r.nativeElement.addEventListener("touchstart",this._handleTouchStart,Aoe),l&&(l._triggersSubmenu=this.triggersSubmenu())}get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(e){this.menu=e}get menu(){return this._menu}set menu(e){e!==this._menu&&(this._menu=e,this._menuCloseSubscription.unsubscribe(),e&&(this._menuCloseSubscription=e.close.subscribe(r=>{this._destroyMenu(r),("click"===r||"tab"===r)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(r)})))}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,Aoe),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!(!this._menuItemInstance||!this._parentMaterialMenu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const e=this.menu;if(this._menuOpen||!e)return;const r=this._createOverlay(e),i=r.getConfig(),s=i.positionStrategy;this._setPosition(e,s),i.hasBackdrop=e.hasBackdrop??!this.triggersSubmenu(),r.attach(this._getPortal(e)),e.lazyContent&&e.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(e),e instanceof C1&&(e._startAnimation(),e._directDescendantItems.changes.pipe(ur(e.close)).subscribe(()=>{s.withLockedPosition(!1).reapplyLastPosition(),s.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(e,r){this._focusMonitor&&e?this._focusMonitor.focusVia(this._element,e,r):this._element.nativeElement.focus(r)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(e){if(!this._overlayRef||!this.menuOpen)return;const r=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===e||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,r instanceof C1?(r._resetAnimation(),r.lazyContent?r._animationDone.pipe(cr(i=>"void"===i.toState),nr(1),ur(r.lazyContent._attached)).subscribe({next:()=>r.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),r?.lazyContent?.detach())}_initMenu(e){e.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,e.direction=this.dir,this._setMenuElevation(e),e.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(e){if(e.setElevation){let r=0,i=e.parentMenu;for(;i;)r++,i=i.parentMenu;e.setElevation(r)}}_setIsMenuOpen(e){this._menuOpen=e,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(e)}_createOverlay(e){if(!this._overlayRef){const r=this._getOverlayConfig(e);this._subscribeToPositions(e,r.positionStrategy),this._overlayRef=this._overlay.create(r),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(e){return new FI({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:e.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:e.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(e,r){e.setPositionClasses&&r.positionChanges.subscribe(i=>{const s="start"===i.connectionPair.overlayX?"after":"before",o="top"===i.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>e.setPositionClasses(s,o)):e.setPositionClasses(s,o)})}_setPosition(e,r){let[i,s]="before"===e.xPosition?["end","start"]:["start","end"],[o,l]="above"===e.yPosition?["bottom","top"]:["top","bottom"],[c,u]=[o,l],[f,m]=[i,s],_=0;if(this.triggersSubmenu()){if(m=i="before"===e.xPosition?"start":"end",s=f="end"===i?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const y=this._parentMaterialMenu.items.first;this._parentInnerPadding=y?y._getHostElement().offsetTop:0}_="bottom"===o?this._parentInnerPadding:-this._parentInnerPadding}}else e.overlapTrigger||(c="top"===o?"bottom":"top",u="top"===l?"bottom":"top");r.withPositions([{originX:i,originY:c,overlayX:f,overlayY:o,offsetY:_},{originX:s,originY:c,overlayX:m,overlayY:o,offsetY:_},{originX:i,originY:u,overlayX:f,overlayY:l,offsetY:-_},{originX:s,originY:u,overlayX:m,overlayY:l,offsetY:-_}])}_menuClosingActions(){const e=this._overlayRef.backdropClick(),r=this._overlayRef.detachments(),i=this._parentMaterialMenu?this._parentMaterialMenu.closed:St(),s=this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(cr(o=>o!==this._menuItemInstance),cr(()=>this._menuOpen)):St();return(0,cs.T)(e,i,s,r)}_handleMousedown(e){lq(e)||(this._openedBy=0===e.button?"mouse":void 0,this.triggersSubmenu()&&e.preventDefault())}_handleKeydown(e){const r=e.keyCode;(13===r||32===r)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===r&&"ltr"===this.dir||37===r&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(e){this.triggersSubmenu()?(e.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(cr(e=>e===this._menuItemInstance&&!e.disabled),Toe(0,gq)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof C1&&this.menu._isAnimating?this.menu._animationDone.pipe(nr(1),Toe(0,gq),ur(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(e){return(!this._portal||this._portal.templateRef!==e.templateRef)&&(this._portal=new Ab(e.templateRef,this._viewContainerRef)),this._portal}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(_a),a.Y36(a.SBq),a.Y36(a.s_b),a.Y36(koe),a.Y36(Uq,8),a.Y36(w1,10),a.Y36(Ws,8),a.Y36(Xc),a.Y36(a.R0b))},n.\u0275dir=a.lG2({type:n,hostVars:3,hostBindings:function(e,r){1&e&&a.NdJ("click",function(s){return r._handleClick(s)})("mousedown",function(s){return r._handleMousedown(s)})("keydown",function(s){return r._handleKeydown(s)}),2&e&&a.uIk("aria-haspopup",r.menu?"menu":null)("aria-expanded",r.menuOpen||null)("aria-controls",r.menuOpen?r.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),n})(),Noe=(()=>{class n extends gNe{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-menu-trigger"],exportAs:["matMenuTrigger"],features:[a.qOj]}),n})(),_Ne=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[mNe],imports:[No,$n,MI,Rb,OI,$n]}),n})();const yNe=["primaryValueBar"],vNe=cp(class{constructor(n){this._elementRef=n}},"primary"),bNe=new a.OlP("mat-progress-bar-location",{providedIn:"root",factory:function wNe(){const n=(0,a.f3M)(Nt),t=n?n.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),CNe=new a.OlP("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");let xNe=0,w$=(()=>{class n extends vNe{constructor(e,r,i,s,o,l){super(e),this._ngZone=r,this._animationMode=i,this._changeDetectorRef=l,this._isNoopAnimation=!1,this._value=0,this._bufferValue=0,this.animationEnd=new a.vpe,this._animationEndSubscription=kn.w0.EMPTY,this.mode="determinate",this.progressbarId="mat-progress-bar-"+xNe++;const c=s?s.getPathname().split("#")[0]:"";this._rectangleFillValue=`url('${c}#${this.progressbarId}')`,this._isNoopAnimation="NoopAnimations"===i,o&&(o.color&&(this.color=this.defaultColor=o.color),this.mode=o.mode||this.mode)}get value(){return this._value}set value(e){this._value=Roe(ga(e)||0),this._changeDetectorRef?.markForCheck()}get bufferValue(){return this._bufferValue}set bufferValue(e){this._bufferValue=Roe(e||0),this._changeDetectorRef?.markForCheck()}_primaryTransform(){return{transform:`scale3d(${this.value/100}, 1, 1)`}}_bufferTransform(){return"buffer"===this.mode?{transform:`scale3d(${this.bufferValue/100}, 1, 1)`}:null}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{const e=this._primaryValueBar.nativeElement;this._animationEndSubscription=Wg(e,"transitionend").pipe(cr(r=>r.target===e)).subscribe(()=>{0!==this.animationEnd.observers.length&&("determinate"===this.mode||"buffer"===this.mode)&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))})})}ngOnDestroy(){this._animationEndSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(a.QbO,8),a.Y36(bNe,8),a.Y36(CNe,8),a.Y36(a.sBO))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-progress-bar"]],viewQuery:function(e,r){if(1&e&&a.Gf(yNe,5),2&e){let i;a.iGM(i=a.CRH())&&(r._primaryValueBar=i.first)}},hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-progress-bar"],hostVars:4,hostBindings:function(e,r){2&e&&(a.uIk("aria-valuenow","indeterminate"===r.mode||"query"===r.mode?null:r.value)("mode",r.mode),a.ekj("_mat-animation-noopable",r._isNoopAnimation))},inputs:{color:"color",value:"value",bufferValue:"bufferValue",mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[a.qOj],decls:10,vars:4,consts:[["aria-hidden","true"],["width","100%","height","4","focusable","false",1,"mat-progress-bar-background","mat-progress-bar-element"],["x","4","y","0","width","8","height","4","patternUnits","userSpaceOnUse",3,"id"],["cx","2","cy","2","r","2"],["width","100%","height","100%"],[1,"mat-progress-bar-buffer","mat-progress-bar-element",3,"ngStyle"],[1,"mat-progress-bar-primary","mat-progress-bar-fill","mat-progress-bar-element",3,"ngStyle"],["primaryValueBar",""],[1,"mat-progress-bar-secondary","mat-progress-bar-fill","mat-progress-bar-element"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0),a.O4$(),a.TgZ(1,"svg",1)(2,"defs")(3,"pattern",2),a._UZ(4,"circle",3),a.qZA()(),a._UZ(5,"rect",4),a.qZA(),a.kcU(),a._UZ(6,"div",5)(7,"div",6,7)(9,"div",8),a.qZA()),2&e&&(a.xp6(3),a.Q6J("id",r.progressbarId),a.xp6(2),a.uIk("fill",r._rectangleFillValue),a.xp6(1),a.Q6J("ngStyle",r._bufferTransform()),a.xp6(1),a.Q6J("ngStyle",r._primaryTransform()))},dependencies:[S0],styles:['.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}.mat-progress-bar._mat-animation-noopable{transition:none !important;animation:none !important}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-background{display:none}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:"";display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2000ms infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2000ms infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background{animation:none;transition-duration:1ms}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}'],encapsulation:2,changeDetection:0}),n})();function Roe(n,t=0,e=100){return Math.max(t,Math.min(e,n))}let INe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[No,$n,$n]}),n})();function TNe(n,t){if(1&n&&(a.O4$(),a._UZ(0,"circle",4)),2&n){const e=a.oxw(),r=a.MAs(1);a.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+e._spinnerAnimationLabel)("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%")("transform-origin",e._getCircleTransformOrigin(r)),a.uIk("r",e._getCircleRadius())}}function SNe(n,t){if(1&n&&(a.O4$(),a._UZ(0,"circle",4)),2&n){const e=a.oxw(),r=a.MAs(1);a.Udp("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%")("transform-origin",e._getCircleTransformOrigin(r)),a.uIk("r",e._getCircleRadius())}}const DNe=cp(class{constructor(n){this._elementRef=n}},"primary"),kNe=new a.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function ANe(){return{diameter:100}}});class Jc extends DNe{constructor(t,e,r,i,s,o,l,c){super(t),this._document=r,this._diameter=100,this._value=0,this._resizeSubscription=kn.w0.EMPTY,this.mode="determinate";const u=Jc._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),u.has(r.head)||u.set(r.head,new Set([100])),this._noopAnimations="NoopAnimations"===i&&!!s&&!s._forceAnimations,"mat-spinner"===t.nativeElement.nodeName.toLowerCase()&&(this.mode="indeterminate"),s&&(s.color&&(this.color=this.defaultColor=s.color),s.diameter&&(this.diameter=s.diameter),s.strokeWidth&&(this.strokeWidth=s.strokeWidth)),e.isBrowser&&e.SAFARI&&l&&o&&c&&(this._resizeSubscription=l.change(150).subscribe(()=>{"indeterminate"===this.mode&&c.run(()=>o.markForCheck())}))}get diameter(){return this._diameter}set diameter(t){this._diameter=ga(t),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(t){this._strokeWidth=ga(t)}get value(){return"determinate"===this.mode?this._value:0}set value(t){this._value=Math.max(0,Math.min(100,ga(t)))}ngOnInit(){const t=this._elementRef.nativeElement;this._styleRoot=Fie(t)||this._document.head,this._attachStyleNode(),t.classList.add("mat-progress-spinner-indeterminate-animation")}ngOnDestroy(){this._resizeSubscription.unsubscribe()}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const t=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${t} ${t}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_getCircleTransformOrigin(t){const e=50*(t.currentScale??1);return`${e}% ${e}%`}_attachStyleNode(){const t=this._styleRoot,e=this._diameter,r=Jc._diameters;let i=r.get(t);if(!i||!i.has(e)){const s=this._document.createElement("style");s.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),s.textContent=this._getAnimationText(),t.appendChild(s),i||(i=new Set,r.set(t,i)),i.add(e)}}_getAnimationText(){const t=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*t).replace(/END_VALUE/g,""+.2*t).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}Jc._diameters=new WeakMap,Jc.\u0275fac=function(t){return new(t||Jc)(a.Y36(a.SBq),a.Y36(Oi),a.Y36(Nt,8),a.Y36(a.QbO,8),a.Y36(kNe),a.Y36(a.sBO),a.Y36(jg),a.Y36(a.R0b))},Jc.\u0275cmp=a.Xpm({type:Jc,selectors:[["mat-progress-spinner"],["mat-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner","mat-spinner"],hostVars:10,hostBindings:function(t,e){2&t&&(a.uIk("aria-valuemin","determinate"===e.mode?0:null)("aria-valuemax","determinate"===e.mode?100:null)("aria-valuenow","determinate"===e.mode?e.value:null)("mode",e.mode),a.Udp("width",e.diameter,"px")("height",e.diameter,"px"),a.ekj("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[a.qOj],decls:4,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["svg",""],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(a.O4$(),a.TgZ(0,"svg",0,1),a.YNc(2,TNe,1,11,"circle",2),a.YNc(3,SNe,1,9,"circle",3),a.qZA()),2&t&&(a.Udp("width",e.diameter,"px")("height",e.diameter,"px"),a.Q6J("ngSwitch","indeterminate"===e.mode),a.uIk("viewBox",e._getViewBox()),a.xp6(2),a.Q6J("ngSwitchCase",!0),a.xp6(1),a.Q6J("ngSwitchCase",!1))},dependencies:[no,ko],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:rgba(0,0,0,0);transition:stroke-dashoffset 225ms linear}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}.mat-progress-spinner[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}.mat-progress-spinner._mat-animation-noopable svg,.mat-progress-spinner._mat-animation-noopable circle{animation:none;transition:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}"],encapsulation:2,changeDetection:0});let RNe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[$n,No,$n]}),n})();const MNe=["input"],ONe=function(n){return{enterDuration:n}},FNe=["*"],PNe=new a.OlP("mat-radio-default-options",{providedIn:"root",factory:function LNe(){return{color:"accent"}}});let Moe=0;const $Ne={provide:Ha,useExisting:(0,a.Gpc)(()=>Poe),multi:!0};class Ooe{constructor(t,e){this.source=t,this.value=e}}const Foe=new a.OlP("MatRadioGroup");let BNe=(()=>{class n{constructor(e){this._changeDetector=e,this._value=null,this._name="mat-radio-group-"+Moe++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new a.vpe}get name(){return this._name}set name(e){this._name=e,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(e){this._labelPosition="before"===e?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(e){this._selected=e,this.value=e?e.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(e){this._disabled=xn(e),this._markRadiosForCheck()}get required(){return this._required}set required(e){this._required=xn(e),this._markRadiosForCheck()}ngAfterContentInit(){this._isInitialized=!0}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(e=>{e.name=this.name,e._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(r=>{r.checked=this.value===r.value,r.checked&&(this._selected=r)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new Ooe(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(e=>e._markForCheck())}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetector.markForCheck()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.sBO))},n.\u0275dir=a.lG2({type:n,inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:"disabled",required:"required"},outputs:{change:"change"}}),n})(),Poe=(()=>{class n extends BNe{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["mat-radio-group"]],contentQueries:function(e,r,i){if(1&e&&a.Suo(i,Loe,5),2&e){let s;a.iGM(s=a.CRH())&&(r._radios=s)}},hostAttrs:["role","radiogroup",1,"mat-radio-group"],exportAs:["matRadioGroup"],features:[a._Bn([$Ne,{provide:Foe,useExisting:n}]),a.qOj]}),n})();class VNe{constructor(t){this._elementRef=t}}const UNe=RI(t$(VNe));let zNe=(()=>{class n extends UNe{constructor(e,r,i,s,o,l,c,u){super(r),this._changeDetector=i,this._focusMonitor=s,this._radioDispatcher=o,this._providerOverride=c,this._uniqueId="mat-radio-"+ ++Moe,this.id=this._uniqueId,this.change=new a.vpe,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this.radioGroup=e,this._noopAnimations="NoopAnimations"===l,u&&(this.tabIndex=ga(u,0)),this._removeUniqueSelectionListener=o.listen((f,m)=>{f!==this.id&&m===this.name&&(this.checked=!1)})}get checked(){return this._checked}set checked(e){const r=xn(e);this._checked!==r&&(this._checked=r,r&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!r&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),r&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(e){this._setDisabled(xn(e))}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){this._required=xn(e)}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(e){this._color=e}get inputId(){return`${this.id||this._uniqueId}-input`}focus(e,r){r?this._focusMonitor.focusVia(this._inputElement,r,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name)}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new Ooe(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(e){e.stopPropagation()}_onInputInteraction(e){if(e.stopPropagation(),!this.checked&&!this.disabled){const r=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),r&&this.radioGroup._emitChangeEvent())}}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}_updateTabIndex(){const e=this.radioGroup;let r;if(r=e&&e.selected&&!this.disabled?e.selected===this?this.tabIndex:-1:this.tabIndex,r!==this._previousTabIndex){const i=this._inputElement?.nativeElement;i&&(i.setAttribute("tabindex",r+""),this._previousTabIndex=r)}}}return n.\u0275fac=function(e){a.$Z()},n.\u0275dir=a.lG2({type:n,viewQuery:function(e,r){if(1&e&&a.Gf(MNe,5),2&e){let i;a.iGM(i=a.CRH())&&(r._inputElement=i.first)}},inputs:{id:"id",name:"name",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],checked:"checked",value:"value",labelPosition:"labelPosition",disabled:"disabled",required:"required",color:"color"},outputs:{change:"change"},features:[a.qOj]}),n})(),Loe=(()=>{class n extends zNe{constructor(e,r,i,s,o,l,c,u){super(e,r,i,s,o,l,c,u)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(Foe,8),a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(Xc),a.Y36(Lq),a.Y36(a.QbO,8),a.Y36(PNe,8),a.$8M("tabindex"))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-radio-button"]],hostAttrs:[1,"mat-radio-button"],hostVars:17,hostBindings:function(e,r){1&e&&a.NdJ("focus",function(){return r._inputElement.nativeElement.focus()}),2&e&&(a.uIk("tabindex",null)("id",r.id)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),a.ekj("mat-radio-checked",r.checked)("mat-radio-disabled",r.disabled)("_mat-animation-noopable",r._noopAnimations)("mat-primary","primary"===r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color))},inputs:{disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matRadioButton"],features:[a.qOj],ngContentSelectors:FNe,decls:13,vars:19,consts:[[1,"mat-radio-label"],["label",""],[1,"mat-radio-container"],[1,"mat-radio-outer-circle"],[1,"mat-radio-inner-circle"],["type","radio",1,"mat-radio-input",3,"id","checked","disabled","required","change","click"],["input",""],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mat-radio-label-content"],[2,"display","none"]],template:function(e,r){if(1&e&&(a.F$t(),a.TgZ(0,"label",0,1)(2,"span",2),a._UZ(3,"span",3)(4,"span",4),a.TgZ(5,"input",5,6),a.NdJ("change",function(s){return r._onInputInteraction(s)})("click",function(s){return r._onInputClick(s)}),a.qZA(),a.TgZ(7,"span",7),a._UZ(8,"span",8),a.qZA()(),a.TgZ(9,"span",9)(10,"span",10),a._uU(11,"\xa0"),a.qZA(),a.Hsn(12),a.qZA()()),2&e){const i=a.MAs(1);a.uIk("for",r.inputId),a.xp6(5),a.Q6J("id",r.inputId)("checked",r.checked)("disabled",r.disabled)("required",r.required),a.uIk("name",r.name)("value",r.value)("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby),a.xp6(2),a.Q6J("matRippleTrigger",i)("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",a.VKq(17,ONe,r._noopAnimations?0:150)),a.xp6(2),a.ekj("mat-radio-label-before","before"==r.labelPosition)}},dependencies:[fh],styles:['.mat-radio-button{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-radio-label{-webkit-user-select:none;user-select:none;cursor:pointer;display:inline-flex;align-items:center;white-space:nowrap;vertical-align:middle;width:100%}.mat-radio-container{box-sizing:border-box;display:inline-block;position:relative;width:20px;height:20px;flex-shrink:0}.mat-radio-outer-circle{box-sizing:border-box;display:block;height:20px;left:0;position:absolute;top:0;transition:border-color ease 280ms;width:20px;border-width:2px;border-style:solid;border-radius:50%}._mat-animation-noopable .mat-radio-outer-circle{transition:none}.mat-radio-inner-circle{border-radius:50%;box-sizing:border-box;display:block;height:20px;left:0;position:absolute;top:0;opacity:0;transition:transform ease 280ms,background-color ease 280ms,opacity linear 1ms 280ms;width:20px;transform:scale(0.001);-webkit-print-color-adjust:exact;color-adjust:exact}.mat-radio-checked .mat-radio-inner-circle{transform:scale(0.5);opacity:1;transition:transform ease 280ms,background-color ease 280ms}.cdk-high-contrast-active .mat-radio-checked .mat-radio-inner-circle{border:solid 10px}._mat-animation-noopable .mat-radio-inner-circle{transition:none}.mat-radio-label-content{-webkit-user-select:auto;user-select:auto;display:inline-block;order:0;line-height:inherit;padding-left:8px;padding-right:0}[dir=rtl] .mat-radio-label-content{padding-right:8px;padding-left:0}.mat-radio-label-content.mat-radio-label-before{order:-1;padding-left:0;padding-right:8px}[dir=rtl] .mat-radio-label-content.mat-radio-label-before{padding-right:0;padding-left:8px}.mat-radio-disabled,.mat-radio-disabled .mat-radio-label{cursor:default}.mat-radio-button .mat-radio-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-radio-button .mat-radio-ripple .mat-ripple-element:not(.mat-radio-persistent-ripple){opacity:.16}.mat-radio-persistent-ripple{width:100%;height:100%;transform:none;top:0;left:0}.mat-radio-container:hover .mat-radio-persistent-ripple{opacity:.04}.mat-radio-button:not(.mat-radio-disabled).cdk-keyboard-focused .mat-radio-persistent-ripple,.mat-radio-button:not(.mat-radio-disabled).cdk-program-focused .mat-radio-persistent-ripple{opacity:.12}.mat-radio-persistent-ripple,.mat-radio-disabled .mat-radio-container:hover .mat-radio-persistent-ripple{opacity:0}@media(hover: none){.mat-radio-container:hover .mat-radio-persistent-ripple{display:none}}.mat-radio-input{opacity:0;position:absolute;top:0;left:0;margin:0;width:100%;height:100%;cursor:inherit;z-index:-1}.mat-radio-input:focus~.mat-focus-indicator::before{content:""}.cdk-high-contrast-active .mat-radio-disabled{opacity:.5}'],encapsulation:2,changeDetection:0}),n})(),HNe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[MI,$n,$n]}),n})();const GNe=["trigger"],WNe=["panel"];function jNe(n,t){if(1&n&&(a.TgZ(0,"span",8),a._uU(1),a.qZA()),2&n){const e=a.oxw();a.xp6(1),a.Oqu(e.placeholder)}}function qNe(n,t){if(1&n&&(a.TgZ(0,"span",12),a._uU(1),a.qZA()),2&n){const e=a.oxw(2);a.xp6(1),a.Oqu(e.triggerValue)}}function ZNe(n,t){1&n&&a.Hsn(0,0,["*ngSwitchCase","true"])}function YNe(n,t){if(1&n&&(a.TgZ(0,"span",9),a.YNc(1,qNe,2,1,"span",10),a.YNc(2,ZNe,1,0,"ng-content",11),a.qZA()),2&n){const e=a.oxw();a.Q6J("ngSwitch",!!e.customTrigger),a.xp6(2),a.Q6J("ngSwitchCase",!0)}}function KNe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",13)(1,"div",14,15),a.NdJ("@transformPanel.done",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._panelDoneAnimatingStream.next(i.toState))})("keydown",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._handleKeydown(i))}),a.Hsn(3,1),a.qZA()()}if(2&n){const e=a.oxw();a.Q6J("@transformPanelWrap",void 0),a.xp6(1),a.Gre("mat-select-panel ",e._getPanelTheme(),""),a.Udp("transform-origin",e._transformOrigin)("font-size",e._triggerFontSize,"px"),a.Q6J("ngClass",e.panelClass)("@transformPanel",e.multiple?"showing-multiple":"showing"),a.uIk("id",e.id+"-panel")("aria-multiselectable",e.multiple)("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby())}}const QNe=[[["mat-select-trigger"]],"*"],XNe=["mat-select-trigger","*"],$oe={transformPanelWrap:Bs("transformPanelWrap",[ei("* => void",Xh("@transformPanel",[cm()],{optional:!0}))]),transformPanel:Bs("transformPanel",[yi("void",Sn({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),yi("showing",Sn({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),yi("showing-multiple",Sn({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),ei("void => *",_i("120ms cubic-bezier(0, 0, 0.2, 1)")),ei("* => void",_i("100ms 25ms linear",Sn({opacity:0})))])};let Boe=0;const Uoe=new a.OlP("mat-select-scroll-strategy"),nRe=new a.OlP("MAT_SELECT_CONFIG"),rRe={provide:Uoe,deps:[_a],useFactory:function tRe(n){return()=>n.scrollStrategies.reposition()}};class iRe{constructor(t,e){this.source=t,this.value=e}}const sRe=RI(t$(NI(tse(class{constructor(n,t,e,r,i){this._elementRef=n,this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=r,this.ngControl=i,this.stateChanges=new Xt.x}})))),oRe=new a.OlP("MatSelectTrigger");let aRe=(()=>{class n extends sRe{constructor(e,r,i,s,o,l,c,u,f,m,_,y,w,T){super(o,s,c,u,m),this._viewportRuler=e,this._changeDetectorRef=r,this._ngZone=i,this._dir=l,this._parentFormField=f,this._liveAnnouncer=w,this._defaultOptions=T,this._panelOpen=!1,this._compareWith=(I,E)=>I===E,this._uid="mat-select-"+Boe++,this._triggerAriaLabelledBy=null,this._destroy=new Xt.x,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+Boe++,this._panelDoneAnimatingStream=new Xt.x,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=_1(()=>{const I=this.options;return I?I.changes.pipe(Ui(I),wn(()=>(0,cs.T)(...I.map(E=>E.onSelectionChange)))):this._ngZone.onStable.pipe(nr(1),wn(()=>this.optionSelectionChanges))}),this.openedChange=new a.vpe,this._openedStream=this.openedChange.pipe(cr(I=>I),(0,Ot.U)(()=>{})),this._closedStream=this.openedChange.pipe(cr(I=>!I),(0,Ot.U)(()=>{})),this.selectionChange=new a.vpe,this.valueChange=new a.vpe,this.ngControl&&(this.ngControl.valueAccessor=this),null!=T?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=T.typeaheadDebounceInterval),this._scrollStrategyFactory=y,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(_)||0,this.id=this.id}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(cn.required)??!1}set required(e){this._required=xn(e),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(e){this._multiple=xn(e)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(e){this._disableOptionCentering=xn(e)}get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this._assignValue(e)&&this._onChange(e)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(e){this._typeaheadDebounceInterval=ga(e)}get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new _1e(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe($u(),ur(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(ur(this._destroy)).subscribe(e=>{e.added.forEach(r=>r.select()),e.removed.forEach(r=>r.deselect())}),this.options.changes.pipe(Ui(null),ur(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const e=this._getTriggerAriaLabelledby(),r=this.ngControl;if(e!==this._triggerAriaLabelledBy){const i=this._elementRef.nativeElement;this._triggerAriaLabelledBy=e,e?i.setAttribute("aria-labelledby",e):i.removeAttribute("aria-labelledby")}r&&(this._previousControl!==r.control&&(void 0!==this._previousControl&&null!==r.disabled&&r.disabled!==this.disabled&&(this.disabled=r.disabled),this._previousControl=r.control),this.updateErrorState())}ngOnChanges(e){(e.disabled||e.userAriaDescribedBy)&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(e){this._assignValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const e=this._selectionModel.selected.map(r=>r.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){const r=e.keyCode,i=40===r||38===r||37===r||39===r,s=13===r||32===r,o=this._keyManager;if(!o.isTyping()&&s&&!Il(e)||(this.multiple||e.altKey)&&i)e.preventDefault(),this.open();else if(!this.multiple){const l=this.selected;o.onKeydown(e);const c=this.selected;c&&l!==c&&this._liveAnnouncer.announce(c.viewValue,1e4)}}_handleOpenKeydown(e){const r=this._keyManager,i=e.keyCode,s=40===i||38===i,o=r.isTyping();if(s&&e.altKey)e.preventDefault(),this.close();else if(o||13!==i&&32!==i||!r.activeItem||Il(e))if(!o&&this._multiple&&65===i&&e.ctrlKey){e.preventDefault();const l=this.options.some(c=>!c.disabled&&!c.selected);this.options.forEach(c=>{c.disabled||(l?c.select():c.deselect())})}else{const l=r.activeItemIndex;r.onKeydown(e),this._multiple&&s&&e.shiftKey&&r.activeItem&&r.activeItemIndex!==l&&r.activeItem._selectViaInteraction()}else e.preventDefault(),r.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(nr(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this._selectionModel.selected.forEach(r=>r.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&e)Array.isArray(e),e.forEach(r=>this._selectOptionByValue(r)),this._sortValues();else{const r=this._selectOptionByValue(e);r?this._keyManager.updateActiveItem(r):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(e){const r=this.options.find(i=>{if(this._selectionModel.isSelected(i))return!1;try{return null!=i.value&&this._compareWith(i.value,e)}catch{return!1}});return r&&this._selectionModel.select(r),r}_assignValue(e){return!!(e!==this._value||this._multiple&&Array.isArray(e))&&(this.options&&this._setSelectionByValue(e),this._value=e,!0)}_initKeyManager(){this._keyManager=new FEe(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe(ur(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe(ur(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const e=(0,cs.T)(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(ur(e)).subscribe(r=>{this._onSelect(r.source,r.isUserInput),r.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),(0,cs.T)(...this.options.map(r=>r._stateChanges)).pipe(ur(e)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}_onSelect(e,r){const i=this._selectionModel.isSelected(e);null!=e.value||this._multiple?(i!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),r&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),r&&this.focus())):(e.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(e.value)),i!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const e=this.options.toArray();this._selectionModel.sort((r,i)=>this.sortComparator?this.sortComparator(r,i,e):e.indexOf(r)-e.indexOf(i)),this.stateChanges.next()}}_propagateChanges(e){let r=null;r=this.multiple?this.selected.map(i=>i.value):this.selected?this.selected.value:e,this._value=r,this.valueChange.emit(r),this._onChange(r),this.selectionChange.emit(this._getChangeEvent(r)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(e){this._elementRef.nativeElement.focus(e)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();return this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();let r=(e?e+" ":"")+this._valueId;return this.ariaLabelledby&&(r+=" "+this.ariaLabelledby),r}_panelDoneAnimating(e){this.openedChange.emit(e)}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(jg),a.Y36(a.sBO),a.Y36(a.R0b),a.Y36(n$),a.Y36(a.SBq),a.Y36(Ws,8),a.Y36(tC,8),a.Y36(Jl,8),a.Y36(d$,8),a.Y36(co,10),a.$8M("tabindex"),a.Y36(Uoe),a.Y36(uq),a.Y36(nRe,8))},n.\u0275dir=a.lG2({type:n,viewQuery:function(e,r){if(1&e&&(a.Gf(GNe,5),a.Gf(WNe,5),a.Gf(Ose,5)),2&e){let i;a.iGM(i=a.CRH())&&(r.trigger=i.first),a.iGM(i=a.CRH())&&(r.panel=i.first),a.iGM(i=a.CRH())&&(r._overlayDir=i.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[a.qOj,a.TTD]}),n})(),Hq=(()=>{class n extends aRe{constructor(){super(...arguments),this._scrollTop=0,this._triggerFontSize=0,this._transformOrigin="top",this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}]}_calculateOverlayScroll(e,r,i){const s=this._getItemHeight();return Math.min(Math.max(0,s*e-r+s/2),i)}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe(ur(this._destroy)).subscribe(()=>{this.panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}open(){super._canOpen()&&(super.open(),this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._calculateOverlayPosition(),this._ngZone.onStable.pipe(nr(1)).subscribe(()=>{this._triggerFontSize&&this._overlayDir.overlayRef&&this._overlayDir.overlayRef.overlayElement&&(this._overlayDir.overlayRef.overlayElement.style.fontSize=`${this._triggerFontSize}px`)}))}_scrollOptionIntoView(e){const r=cse(e,this.options,this.optionGroups),i=this._getItemHeight();this.panel.nativeElement.scrollTop=0===e&&1===r?0:function EDe(n,t,e,r){return n<e?n:n+t>e+r?Math.max(0,n-r+t):e}((e+r)*i,i,this.panel.nativeElement.scrollTop,256)}_positioningSettled(){this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop}_panelDoneAnimating(e){this.panelOpen?this._scrollTop=0:(this._overlayDir.offsetX=0,this._changeDetectorRef.markForCheck()),super._panelDoneAnimating(e)}_getChangeEvent(e){return new iRe(this,e)}_calculateOverlayOffsetX(){const e=this._overlayDir.overlayRef.overlayElement.getBoundingClientRect(),r=this._viewportRuler.getViewportSize(),i=this._isRtl(),s=this.multiple?56:32;let o;if(this.multiple)o=40;else if(this.disableOptionCentering)o=16;else{let u=this._selectionModel.selected[0]||this.options.first;o=u&&u.group?32:16}i||(o*=-1);const l=0-(e.left+o-(i?s:0)),c=e.right+o-r.width+(i?0:s);l>0?o+=l+8:c>0&&(o-=c+8),this._overlayDir.offsetX=Math.round(o),this._overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(e,r,i){const s=this._getItemHeight(),o=(s-this._triggerRect.height)/2,l=Math.floor(256/s);let c;return this.disableOptionCentering?0:(c=0===this._scrollTop?e*s:this._scrollTop===i?(e-(this._getItemCount()-l))*s+(s-(this._getItemCount()*s-256)%s):r-s/2,Math.round(-1*c-o))}_checkOverlayWithinViewport(e){const r=this._getItemHeight(),i=this._viewportRuler.getViewportSize(),s=this._triggerRect.top-8,o=i.height-this._triggerRect.bottom-8,l=Math.abs(this._offsetY),u=Math.min(this._getItemCount()*r,256)-l-this._triggerRect.height;u>o?this._adjustPanelUp(u,o):l>s?this._adjustPanelDown(l,s,e):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(e,r){const i=Math.round(e-r);this._scrollTop-=i,this._offsetY-=i,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(e,r,i){const s=Math.round(e-r);if(this._scrollTop+=s,this._offsetY+=s,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=i)return this._scrollTop=i,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_calculateOverlayPosition(){const e=this._getItemHeight(),r=this._getItemCount(),i=Math.min(r*e,256),o=r*e-i;let l;l=this.empty?0:Math.max(this.options.toArray().indexOf(this._selectionModel.selected[0]),0),l+=cse(l,this.options,this.optionGroups);const c=i/2;this._scrollTop=this._calculateOverlayScroll(l,c,o),this._offsetY=this._calculateOverlayOffsetY(l,c,o),this._checkOverlayWithinViewport(o)}_getOriginBasedOnOption(){const e=this._getItemHeight(),r=(e-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-r+e/2}px 0px`}_getItemHeight(){return 3*this._triggerFontSize}_getItemCount(){return this.options.length+this.optionGroups.length}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-select"]],contentQueries:function(e,r,i){if(1&e&&(a.Suo(i,oRe,5),a.Suo(i,r$,5),a.Suo(i,lse,5)),2&e){let s;a.iGM(s=a.CRH())&&(r.customTrigger=s.first),a.iGM(s=a.CRH())&&(r.options=s),a.iGM(s=a.CRH())&&(r.optionGroups=s)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","true",1,"mat-select"],hostVars:19,hostBindings:function(e,r){1&e&&a.NdJ("keydown",function(s){return r._handleKeydown(s)})("focus",function(){return r._onFocus()})("blur",function(){return r._onBlur()}),2&e&&(a.uIk("id",r.id)("tabindex",r.tabIndex)("aria-controls",r.panelOpen?r.id+"-panel":null)("aria-expanded",r.panelOpen)("aria-label",r.ariaLabel||null)("aria-required",r.required.toString())("aria-disabled",r.disabled.toString())("aria-invalid",r.errorState)("aria-activedescendant",r._getAriaActiveDescendant()),a.ekj("mat-select-disabled",r.disabled)("mat-select-invalid",r.errorState)("mat-select-required",r.required)("mat-select-empty",r.empty)("mat-select-multiple",r.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matSelect"],features:[a._Bn([{provide:c$,useExisting:n},{provide:ase,useExisting:n}]),a.qOj],ngContentSelectors:XNe,decls:9,vars:12,consts:[["cdk-overlay-origin","",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder mat-select-min-line",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder","mat-select-min-line"],[1,"mat-select-value-text",3,"ngSwitch"],["class","mat-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-min-line"],[1,"mat-select-panel-wrap"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(e,r){if(1&e&&(a.F$t(QNe),a.TgZ(0,"div",0,1),a.NdJ("click",function(){return r.toggle()}),a.TgZ(3,"div",2),a.YNc(4,jNe,2,1,"span",3),a.YNc(5,YNe,3,2,"span",4),a.qZA(),a.TgZ(6,"div",5),a._UZ(7,"div",6),a.qZA()(),a.YNc(8,KNe,4,14,"ng-template",7),a.NdJ("backdropClick",function(){return r.close()})("attach",function(){return r._onAttached()})("detach",function(){return r.close()})),2&e){const i=a.MAs(1);a.uIk("aria-owns",r.panelOpen?r.id+"-panel":null),a.xp6(3),a.Q6J("ngSwitch",r.empty),a.uIk("id",r._valueId),a.xp6(1),a.Q6J("ngSwitchCase",!0),a.xp6(1),a.Q6J("ngSwitchCase",!1),a.xp6(3),a.Q6J("cdkConnectedOverlayPanelClass",r._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",r._scrollStrategy)("cdkConnectedOverlayOrigin",i)("cdkConnectedOverlayOpen",r.panelOpen)("cdkConnectedOverlayPositions",r._positions)("cdkConnectedOverlayMinWidth",null==r._triggerRect?null:r._triggerRect.width)("cdkConnectedOverlayOffsetY",r._offsetY)}},dependencies:[Aa,no,ko,T0,Ose,Mse],styles:['.mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{height:16px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;margin:0 4px}.mat-form-field.mat-focused .mat-select-arrow{transform:translateX(0)}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px;outline:0}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[$oe.transformPanelWrap,$oe.transformPanel]},changeDetection:0}),n})(),lRe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[rRe],imports:[No,Rb,use,$n,OI,h$,use,$n]}),n})();function cRe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",2)(1,"button",3),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.action())}),a._uU(2),a.qZA()()}if(2&n){const e=a.oxw();a.xp6(2),a.Oqu(e.data.action)}}function uRe(n,t){}const zoe=new a.OlP("MatSnackBarData");class x${constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}const dRe=Math.pow(2,31)-1;class Gq{constructor(t,e){this._overlayRef=e,this._afterDismissed=new Xt.x,this._afterOpened=new Xt.x,this._onAction=new Xt.x,this._dismissedByAction=!1,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,dRe))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}let hRe=(()=>{class n{constructor(e,r){this.snackBarRef=e,this.data=r}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(Gq),a.Y36(zoe))},n.\u0275cmp=a.Xpm({type:n,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[[1,"mat-simple-snack-bar-content"],["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(e,r){1&e&&(a.TgZ(0,"span",0),a._uU(1),a.qZA(),a.YNc(2,cRe,3,1,"div",1)),2&e&&(a.xp6(1),a.Oqu(r.data.message),a.xp6(1),a.Q6J("ngIf",r.hasAction))},dependencies:[Ur,js],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}.mat-simple-snack-bar-content{overflow:hidden;text-overflow:ellipsis}"],encapsulation:2,changeDetection:0}),n})();const fRe={snackBarState:Bs("state",[yi("void, hidden",Sn({transform:"scale(0.8)",opacity:0})),yi("visible",Sn({transform:"scale(1)",opacity:1})),ei("* => visible",_i("150ms cubic-bezier(0, 0, 0.2, 1)")),ei("* => void, * => hidden",_i("75ms cubic-bezier(0.4, 0.0, 1, 1)",Sn({opacity:0})))])};let pRe=(()=>{class n extends a${constructor(e,r,i,s,o){super(),this._ngZone=e,this._elementRef=r,this._changeDetectorRef=i,this._platform=s,this.snackBarConfig=o,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new Xt.x,this._onExit=new Xt.x,this._onEnter=new Xt.x,this._animationState="void",this.attachDomPortal=l=>{this._assertNotAttached();const c=this._portalOutlet.attachDomPortal(l);return this._afterPortalAttached(),c},this._live="assertive"!==o.politeness||o.announcementMessage?"off"===o.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();const r=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),r}attachTemplatePortal(e){this._assertNotAttached();const r=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),r}onAnimationEnd(e){const{fromState:r,toState:i}=e;if(("void"===i&&"void"!==r||"hidden"===i)&&this._completeExit(),"visible"===i){const s=this._onEnter;this._ngZone.run(()=>{s.next(),s.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe(nr(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_afterPortalAttached(){const e=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(i=>e.classList.add(i)):e.classList.add(r))}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),r=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&r){let i=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(i=document.activeElement),e.removeAttribute("aria-hidden"),r.appendChild(e),i?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.R0b),a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(Oi),a.Y36(x$))},n.\u0275dir=a.lG2({type:n,viewQuery:function(e,r){if(1&e&&a.Gf(ed,7),2&e){let i;a.iGM(i=a.CRH())&&(r._portalOutlet=i.first)}},features:[a.qOj]}),n})(),mRe=(()=>{class n extends pRe{_afterPortalAttached(){super._afterPortalAttached(),"center"===this.snackBarConfig.horizontalPosition&&this._elementRef.nativeElement.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&this._elementRef.nativeElement.classList.add("mat-snack-bar-top")}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275cmp=a.Xpm({type:n,selectors:[["snack-bar-container"]],hostAttrs:[1,"mat-snack-bar-container"],hostVars:1,hostBindings:function(e,r){1&e&&a.WFA("@state.done",function(s){return r.onAnimationEnd(s)}),2&e&&a.d8E("@state",r._animationState)},features:[a.qOj],decls:3,vars:2,consts:[["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(e,r){1&e&&(a.TgZ(0,"div",0),a.YNc(1,uRe,0,0,"ng-template",1),a.qZA(),a._UZ(2,"div")),2&e&&(a.xp6(2),a.uIk("aria-live",r._live)("role",r._role))},dependencies:[ed],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}"],encapsulation:2,data:{animation:[fRe.snackBarState]}}),n})(),Hoe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[Rb,Zg,No,pq,$n,$n]}),n})();const Goe=new a.OlP("mat-snack-bar-default-options",{providedIn:"root",factory:function gRe(){return new x$}});let _Re=(()=>{class n{constructor(e,r,i,s,o,l){this._overlay=e,this._live=r,this._injector=i,this._breakpointObserver=s,this._parentSnackBar=o,this._defaultConfig=l,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}openFromComponent(e,r){return this._attach(e,r)}openFromTemplate(e,r){return this._attach(e,r)}open(e,r="",i){const s={...this._defaultConfig,...i};return s.data={message:e,action:r},s.announcementMessage===e&&(s.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,s)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,r){const s=a.zs3.create({parent:r&&r.viewContainerRef&&r.viewContainerRef.injector||this._injector,providers:[{provide:x$,useValue:r}]}),o=new qg(this.snackBarContainerComponent,r.viewContainerRef,s),l=e.attach(o);return l.instance.snackBarConfig=r,l.instance}_attach(e,r){const i={...new x$,...this._defaultConfig,...r},s=this._createOverlay(i),o=this._attachSnackBarContainer(s,i),l=new Gq(o,s);if(e instanceof a.Rgc){const c=new Ab(e,null,{$implicit:i.data,snackBarRef:l});l.instance=o.attachTemplatePortal(c)}else{const c=this._createInjector(i,l),u=new qg(e,void 0,c),f=o.attachComponentPortal(u);l.instance=f.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(ur(s.detachments())).subscribe(c=>{s.overlayElement.classList.toggle(this.handsetCssClass,c.matches)}),i.announcementMessage&&o._onAnnounce.subscribe(()=>{this._live.announce(i.announcementMessage,i.politeness)}),this._animateSnackBar(l,i),this._openedSnackBarRef=l,this._openedSnackBarRef}_animateSnackBar(e,r){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),r.duration&&r.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(r.duration))}_createOverlay(e){const r=new FI;r.direction=e.direction;let i=this._overlay.position().global();const s="rtl"===e.direction,o="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!s||"end"===e.horizontalPosition&&s,l=!o&&"center"!==e.horizontalPosition;return o?i.left("0"):l?i.right("0"):i.centerHorizontally(),"top"===e.verticalPosition?i.top("0"):i.bottom("0"),r.positionStrategy=i,this._overlay.create(r)}_createInjector(e,r){return a.zs3.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:Gq,useValue:r},{provide:zoe,useValue:e.data}]})}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(_a),a.LFG(uq),a.LFG(a.zs3),a.LFG(ZL),a.LFG(n,12),a.LFG(Goe))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),I$=(()=>{class n extends _Re{constructor(e,r,i,s,o,l){super(e,r,i,s,o,l),this.simpleSnackBarComponent=hRe,this.snackBarContainerComponent=mRe,this.handsetCssClass="mat-snack-bar-handset"}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(_a),a.LFG(uq),a.LFG(a.zs3),a.LFG(ZL),a.LFG(n,12),a.LFG(Goe))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:Hoe}),n})();const vRe=[[["caption"]],[["colgroup"],["col"]]],bRe=["caption","colgroup, col"];function Wq(n){return class extends n{constructor(...t){super(...t),this._sticky=!1,this._hasStickyChanged=!1}get sticky(){return this._sticky}set sticky(t){const e=this._sticky;this._sticky=xn(t),this._hasStickyChanged=e!==this._sticky}hasStickyChanged(){const t=this._hasStickyChanged;return this._hasStickyChanged=!1,t}resetStickyChanged(){this._hasStickyChanged=!1}}}const BI=new a.OlP("CDK_TABLE");let VI=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkCellDef",""]]}),n})(),UI=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkHeaderCellDef",""]]}),n})(),T$=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkFooterCellDef",""]]}),n})();class IRe{}const TRe=Wq(IRe);let up=(()=>{class n extends TRe{constructor(e){super(),this._table=e,this._stickyEnd=!1}get name(){return this._name}set name(e){this._setNameInput(e)}get stickyEnd(){return this._stickyEnd}set stickyEnd(e){const r=this._stickyEnd;this._stickyEnd=xn(e),this._hasStickyChanged=r!==this._stickyEnd}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(e){e&&(this._name=e,this.cssClassFriendlyName=e.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(BI,8))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkColumnDef",""]],contentQueries:function(e,r,i){if(1&e&&(a.Suo(i,VI,5),a.Suo(i,UI,5),a.Suo(i,T$,5)),2&e){let s;a.iGM(s=a.CRH())&&(r.cell=s.first),a.iGM(s=a.CRH())&&(r.headerCell=s.first),a.iGM(s=a.CRH())&&(r.footerCell=s.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[a._Bn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),a.qOj]}),n})();class jq{constructor(t,e){e.nativeElement.classList.add(...t._columnCssClassName)}}let qq=(()=>{class n extends jq{constructor(e,r){super(e,r)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(up),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[a.qOj]}),n})(),Zq=(()=>{class n extends jq{constructor(e,r){if(super(e,r),1===e._table?._elementRef.nativeElement.nodeType){const i=e._table._elementRef.nativeElement.getAttribute("role");r.nativeElement.setAttribute("role","grid"===i||"treegrid"===i?"gridcell":"cell")}}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(up),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[a.qOj]}),n})();class joe{constructor(){this.tasks=[],this.endTasks=[]}}const Yq=new a.OlP("_COALESCED_STYLE_SCHEDULER");let qoe=(()=>{class n{constructor(e){this._ngZone=e,this._currentSchedule=null,this._destroyed=new Xt.x}schedule(e){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(e)}scheduleEnd(e){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(e)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new joe,this._getScheduleObservable().pipe(ur(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const e=this._currentSchedule;this._currentSchedule=new joe;for(const r of e.tasks)r();for(const r of e.endTasks)r()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?(0,Dn.D)(Promise.resolve(void 0)):this._ngZone.onStable.pipe(nr(1))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.R0b))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})(),Kq=(()=>{class n{constructor(e,r){this.template=e,this._differs=r}ngOnChanges(e){if(!this._columnsDiffer){const r=e.columns&&e.columns.currentValue||[];this._columnsDiffer=this._differs.find(r).create(),this._columnsDiffer.diff(r)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(e){return this instanceof I1?e.headerCell.template:this instanceof T1?e.footerCell.template:e.cell.template}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc),a.Y36(a.ZZ4))},n.\u0275dir=a.lG2({type:n,features:[a.TTD]}),n})();class SRe extends Kq{}const ERe=Wq(SRe);let I1=(()=>{class n extends ERe{constructor(e,r,i){super(e,r),this._table=i}ngOnChanges(e){super.ngOnChanges(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc),a.Y36(a.ZZ4),a.Y36(BI,8))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[a.qOj,a.TTD]}),n})();class DRe extends Kq{}const kRe=Wq(DRe);let T1=(()=>{class n extends kRe{constructor(e,r,i){super(e,r),this._table=i}ngOnChanges(e){super.ngOnChanges(e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc),a.Y36(a.ZZ4),a.Y36(BI,8))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[a.qOj,a.TTD]}),n})(),S$=(()=>{class n extends Kq{constructor(e,r,i){super(e,r),this._table=i}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc),a.Y36(a.ZZ4),a.Y36(BI,8))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[a.qOj]}),n})(),dp=(()=>{class n{constructor(e){this._viewContainer=e,n.mostRecentCellOutlet=this}ngOnDestroy(){n.mostRecentCellOutlet===this&&(n.mostRecentCellOutlet=null)}}return n.mostRecentCellOutlet=null,n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b))},n.\u0275dir=a.lG2({type:n,selectors:[["","cdkCellOutlet",""]]}),n})(),Qq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,r){1&e&&a.GkF(0,0)},dependencies:[dp],encapsulation:2}),n})(),Jq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,r){1&e&&a.GkF(0,0)},dependencies:[dp],encapsulation:2}),n})(),E$=(()=>{class n{constructor(e){this.templateRef=e,this._contentClassName="cdk-no-data-row"}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc))},n.\u0275dir=a.lG2({type:n,selectors:[["ng-template","cdkNoDataRow",""]]}),n})();const Zoe=["top","bottom","left","right"];class ARe{constructor(t,e,r,i,s=!0,o=!0,l){this._isNativeHtmlTable=t,this._stickCellCss=e,this.direction=r,this._coalescedStyleScheduler=i,this._isBrowser=s,this._needsPositionStickyOnElement=o,this._positionListener=l,this._cachedCellWidths=[],this._borderCellCss={top:`${e}-border-elem-top`,bottom:`${e}-border-elem-bottom`,left:`${e}-border-elem-left`,right:`${e}-border-elem-right`}}clearStickyPositioning(t,e){const r=[];for(const i of t)if(i.nodeType===i.ELEMENT_NODE){r.push(i);for(let s=0;s<i.children.length;s++)r.push(i.children[s])}this._coalescedStyleScheduler.schedule(()=>{for(const i of r)this._removeStickyStyle(i,e)})}updateStickyColumns(t,e,r,i=!0){if(!t.length||!this._isBrowser||!e.some(_=>_)&&!r.some(_=>_))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const s=t[0],o=s.children.length,l=this._getCellWidths(s,i),c=this._getStickyStartColumnPositions(l,e),u=this._getStickyEndColumnPositions(l,r),f=e.lastIndexOf(!0),m=r.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const _="rtl"===this.direction,y=_?"right":"left",w=_?"left":"right";for(const T of t)for(let I=0;I<o;I++){const E=T.children[I];e[I]&&this._addStickyStyle(E,y,c[I],I===f),r[I]&&this._addStickyStyle(E,w,u[I],I===m)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===f?[]:l.slice(0,f+1).map((T,I)=>e[I]?T:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===m?[]:l.slice(m).map((T,I)=>r[I+m]?T:null).reverse()}))})}stickRows(t,e,r){if(!this._isBrowser)return;const i="bottom"===r?t.slice().reverse():t,s="bottom"===r?e.slice().reverse():e,o=[],l=[],c=[];for(let f=0,m=0;f<i.length;f++){if(!s[f])continue;o[f]=m;const _=i[f];c[f]=this._isNativeHtmlTable?Array.from(_.children):[_];const y=_.getBoundingClientRect().height;m+=y,l[f]=y}const u=s.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{for(let f=0;f<i.length;f++){if(!s[f])continue;const m=o[f],_=f===u;for(const y of c[f])this._addStickyStyle(y,r,m,_)}"top"===r?this._positionListener?.stickyHeaderRowsUpdated({sizes:l,offsets:o,elements:c}):this._positionListener?.stickyFooterRowsUpdated({sizes:l,offsets:o,elements:c})})}updateStickyFooterContainer(t,e){if(!this._isNativeHtmlTable)return;const r=t.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{e.some(i=>!i)?this._removeStickyStyle(r,["bottom"]):this._addStickyStyle(r,"bottom",0,!1)})}_removeStickyStyle(t,e){for(const i of e)t.style[i]="",t.classList.remove(this._borderCellCss[i]);Zoe.some(i=>-1===e.indexOf(i)&&t.style[i])?t.style.zIndex=this._getCalculatedZIndex(t):(t.style.zIndex="",this._needsPositionStickyOnElement&&(t.style.position=""),t.classList.remove(this._stickCellCss))}_addStickyStyle(t,e,r,i){t.classList.add(this._stickCellCss),i&&t.classList.add(this._borderCellCss[e]),t.style[e]=`${r}px`,t.style.zIndex=this._getCalculatedZIndex(t),this._needsPositionStickyOnElement&&(t.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(t){const e={top:100,bottom:10,left:1,right:1};let r=0;for(const i of Zoe)t.style[i]&&(r+=e[i]);return r?`${r}`:""}_getCellWidths(t,e=!0){if(!e&&this._cachedCellWidths.length)return this._cachedCellWidths;const r=[],i=t.children;for(let s=0;s<i.length;s++)r.push(i[s].getBoundingClientRect().width);return this._cachedCellWidths=r,r}_getStickyStartColumnPositions(t,e){const r=[];let i=0;for(let s=0;s<t.length;s++)e[s]&&(r[s]=i,i+=t[s]);return r}_getStickyEndColumnPositions(t,e){const r=[];let i=0;for(let s=t.length;s>0;s--)e[s]&&(r[s]=i,i+=t[s]);return r}}const e5=new a.OlP("CDK_SPL");let D$=(()=>{class n{constructor(e,r){this.viewContainer=e,this.elementRef=r}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["","rowOutlet",""]]}),n})(),k$=(()=>{class n{constructor(e,r){this.viewContainer=e,this.elementRef=r}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["","headerRowOutlet",""]]}),n})(),A$=(()=>{class n{constructor(e,r){this.viewContainer=e,this.elementRef=r}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["","footerRowOutlet",""]]}),n})(),N$=(()=>{class n{constructor(e,r){this.viewContainer=e,this.elementRef=r}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["","noDataRowOutlet",""]]}),n})(),R$=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f,m,_,y){this._differs=e,this._changeDetectorRef=r,this._elementRef=i,this._dir=o,this._platform=c,this._viewRepeater=u,this._coalescedStyleScheduler=f,this._viewportRuler=m,this._stickyPositioningListener=_,this._ngZone=y,this._onDestroy=new Xt.x,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new a.vpe,this.viewChange=new Zo({start:0,end:Number.MAX_VALUE}),s||this._elementRef.nativeElement.setAttribute("role","table"),this._document=l,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}get trackBy(){return this._trackByFn}set trackBy(e){this._trackByFn=e}get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(e){this._multiTemplateDataRows=xn(e),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(e){this._fixedLayout=xn(e),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((e,r)=>this.trackBy?this.trackBy(r.dataIndex,r.data):r),this._viewportRuler.change().pipe(ur(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const r=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||r,this._forceRecalculateCellWidths=r,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(e=>{e.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),Pq(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const e=this._dataDiffer.diff(this._renderRows);if(!e)return this._updateNoDataRow(),void this.contentChanged.next();const r=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(e,r,(i,s,o)=>this._getEmbeddedViewArgs(i.item,o),i=>i.item.data,i=>{1===i.operation&&i.context&&this._renderCellTemplateForItem(i.record.item.rowDef,i.context)}),this._updateRowIndexContext(),e.forEachIdentityChange(i=>{r.get(i.currentIndex).context.$implicit=i.item.data}),this._updateNoDataRow(),this._ngZone&&a.R0b.isInAngularZone()?this._ngZone.onStable.pipe(nr(1),ur(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(e){this._customColumnDefs.add(e)}removeColumnDef(e){this._customColumnDefs.delete(e)}addRowDef(e){this._customRowDefs.add(e)}removeRowDef(e){this._customRowDefs.delete(e)}addHeaderRowDef(e){this._customHeaderRowDefs.add(e),this._headerRowDefChanged=!0}removeHeaderRowDef(e){this._customHeaderRowDefs.delete(e),this._headerRowDefChanged=!0}addFooterRowDef(e){this._customFooterRowDefs.add(e),this._footerRowDefChanged=!0}removeFooterRowDef(e){this._customFooterRowDefs.delete(e),this._footerRowDefChanged=!0}setNoDataRow(e){this._customNoDataRow=e}updateStickyHeaderRowStyles(){const e=this._getRenderedRows(this._headerRowOutlet),i=this._elementRef.nativeElement.querySelector("thead");i&&(i.style.display=e.length?"":"none");const s=this._headerRowDefs.map(o=>o.sticky);this._stickyStyler.clearStickyPositioning(e,["top"]),this._stickyStyler.stickRows(e,s,"top"),this._headerRowDefs.forEach(o=>o.resetStickyChanged())}updateStickyFooterRowStyles(){const e=this._getRenderedRows(this._footerRowOutlet),i=this._elementRef.nativeElement.querySelector("tfoot");i&&(i.style.display=e.length?"":"none");const s=this._footerRowDefs.map(o=>o.sticky);this._stickyStyler.clearStickyPositioning(e,["bottom"]),this._stickyStyler.stickRows(e,s,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,s),this._footerRowDefs.forEach(o=>o.resetStickyChanged())}updateStickyColumnStyles(){const e=this._getRenderedRows(this._headerRowOutlet),r=this._getRenderedRows(this._rowOutlet),i=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...e,...r,...i],["left","right"]),this._stickyColumnStylesNeedReset=!1),e.forEach((s,o)=>{this._addStickyColumnStyles([s],this._headerRowDefs[o])}),this._rowDefs.forEach(s=>{const o=[];for(let l=0;l<r.length;l++)this._renderRows[l].rowDef===s&&o.push(r[l]);this._addStickyColumnStyles(o,s)}),i.forEach((s,o)=>{this._addStickyColumnStyles([s],this._footerRowDefs[o])}),Array.from(this._columnDefsByName.values()).forEach(s=>s.resetStickyChanged())}_getAllRenderRows(){const e=[],r=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let i=0;i<this._data.length;i++){let s=this._data[i];const o=this._getRenderRowsForData(s,i,r.get(s));this._cachedRenderRowsMap.has(s)||this._cachedRenderRowsMap.set(s,new WeakMap);for(let l=0;l<o.length;l++){let c=o[l];const u=this._cachedRenderRowsMap.get(c.data);u.has(c.rowDef)?u.get(c.rowDef).push(c):u.set(c.rowDef,[c]),e.push(c)}}return e}_getRenderRowsForData(e,r,i){return this._getRowDefs(e,r).map(o=>{const l=i&&i.has(o)?i.get(o):[];if(l.length){const c=l.shift();return c.dataIndex=r,c}return{data:e,rowDef:o,dataIndex:r}})}_cacheColumnDefs(){this._columnDefsByName.clear(),M$(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(r=>{this._columnDefsByName.has(r.name),this._columnDefsByName.set(r.name,r)})}_cacheRowDefs(){this._headerRowDefs=M$(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=M$(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=M$(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const e=this._rowDefs.filter(r=>!r.when);this._defaultRowDef=e[0]}_renderUpdatedColumns(){const e=(o,l)=>o||!!l.getColumnsDiff(),r=this._rowDefs.reduce(e,!1);r&&this._forceRenderDataRows();const i=this._headerRowDefs.reduce(e,!1);i&&this._forceRenderHeaderRows();const s=this._footerRowDefs.reduce(e,!1);return s&&this._forceRenderFooterRows(),r||i||s}_switchDataSource(e){this._data=[],Pq(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),e||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=e}_observeRenderChanges(){if(!this.dataSource)return;let e;Pq(this.dataSource)?e=this.dataSource.connect(this):function yRe(n){return!!n&&(n instanceof Cr.y||(0,Po.m)(n.lift)&&(0,Po.m)(n.subscribe))}(this.dataSource)?e=this.dataSource:Array.isArray(this.dataSource)&&(e=St(this.dataSource)),this._renderChangeSubscription=e.pipe(ur(this._onDestroy)).subscribe(r=>{this._data=r||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((e,r)=>this._renderRow(this._headerRowOutlet,e,r)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((e,r)=>this._renderRow(this._footerRowOutlet,e,r)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(e,r){const i=Array.from(r.columns||[]).map(l=>this._columnDefsByName.get(l)),s=i.map(l=>l.sticky),o=i.map(l=>l.stickyEnd);this._stickyStyler.updateStickyColumns(e,s,o,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(e){const r=[];for(let i=0;i<e.viewContainer.length;i++){const s=e.viewContainer.get(i);r.push(s.rootNodes[0])}return r}_getRowDefs(e,r){if(1==this._rowDefs.length)return[this._rowDefs[0]];let i=[];if(this.multiTemplateDataRows)i=this._rowDefs.filter(s=>!s.when||s.when(r,e));else{let s=this._rowDefs.find(o=>o.when&&o.when(r,e))||this._defaultRowDef;s&&i.push(s)}return i}_getEmbeddedViewArgs(e,r){return{templateRef:e.rowDef.template,context:{$implicit:e.data},index:r}}_renderRow(e,r,i,s={}){const o=e.viewContainer.createEmbeddedView(r.template,s,i);return this._renderCellTemplateForItem(r,s),o}_renderCellTemplateForItem(e,r){for(let i of this._getCellTemplates(e))dp.mostRecentCellOutlet&&dp.mostRecentCellOutlet._viewContainer.createEmbeddedView(i,r);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const e=this._rowOutlet.viewContainer;for(let r=0,i=e.length;r<i;r++){const o=e.get(r).context;o.count=i,o.first=0===r,o.last=r===i-1,o.even=r%2==0,o.odd=!o.even,this.multiTemplateDataRows?(o.dataIndex=this._renderRows[r].dataIndex,o.renderIndex=r):o.index=this._renderRows[r].dataIndex}}_getCellTemplates(e){return e&&e.columns?Array.from(e.columns,r=>{const i=this._columnDefsByName.get(r);return e.extractCellTemplate(i)}):[]}_applyNativeTableSections(){const e=this._document.createDocumentFragment(),r=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const i of r){const s=this._document.createElement(i.tag);s.setAttribute("role","rowgroup");for(const o of i.outlets)s.appendChild(o.elementRef.nativeElement);e.appendChild(s)}this._elementRef.nativeElement.appendChild(e)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const e=(r,i)=>r||i.hasStickyChanged();this._headerRowDefs.reduce(e,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(e,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(e,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new ARe(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:St()).pipe(ur(this._onDestroy)).subscribe(r=>{this._stickyStyler.direction=r,this.updateStickyColumnStyles()})}_getOwnDefs(e){return e.filter(r=>!r._table||r._table===this)}_updateNoDataRow(){const e=this._customNoDataRow||this._noDataRow;if(!e)return;const r=0===this._rowOutlet.viewContainer.length;if(r===this._isShowingNoDataRow)return;const i=this._noDataRowOutlet.viewContainer;if(r){const s=i.createEmbeddedView(e.templateRef),o=s.rootNodes[0];1===s.rootNodes.length&&o?.nodeType===this._document.ELEMENT_NODE&&(o.setAttribute("role","row"),o.classList.add(e._contentClassName))}else i.clear();this._isShowingNoDataRow=r}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.ZZ4),a.Y36(a.sBO),a.Y36(a.SBq),a.$8M("role"),a.Y36(Ws,8),a.Y36(Nt),a.Y36(Oi),a.Y36(y1),a.Y36(Yq),a.Y36(jg),a.Y36(e5,12),a.Y36(a.R0b,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(e,r,i){if(1&e&&(a.Suo(i,E$,5),a.Suo(i,up,5),a.Suo(i,S$,5),a.Suo(i,I1,5),a.Suo(i,T1,5)),2&e){let s;a.iGM(s=a.CRH())&&(r._noDataRow=s.first),a.iGM(s=a.CRH())&&(r._contentColumnDefs=s),a.iGM(s=a.CRH())&&(r._contentRowDefs=s),a.iGM(s=a.CRH())&&(r._contentHeaderRowDefs=s),a.iGM(s=a.CRH())&&(r._contentFooterRowDefs=s)}},viewQuery:function(e,r){if(1&e&&(a.Gf(D$,7),a.Gf(k$,7),a.Gf(A$,7),a.Gf(N$,7)),2&e){let i;a.iGM(i=a.CRH())&&(r._rowOutlet=i.first),a.iGM(i=a.CRH())&&(r._headerRowOutlet=i.first),a.iGM(i=a.CRH())&&(r._footerRowOutlet=i.first),a.iGM(i=a.CRH())&&(r._noDataRowOutlet=i.first)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(e,r){2&e&&a.ekj("cdk-table-fixed-layout",r.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[a._Bn([{provide:BI,useExisting:n},{provide:y1,useClass:ooe},{provide:Yq,useClass:qoe},{provide:e5,useValue:null}])],ngContentSelectors:bRe,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(e,r){1&e&&(a.F$t(vRe),a.Hsn(0),a.Hsn(1,1),a.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[D$,k$,A$,N$],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2}),n})();function M$(n,t){return n.concat(Array.from(t))}let RRe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[_q]}),n})();const MRe=[[["caption"]],[["colgroup"],["col"]]],ORe=["caption","colgroup, col"];let Koe=(()=>{class n extends R${constructor(){super(...arguments),this.stickyCssClass="mat-table-sticky",this.needsPositionStickyOnElement=!1}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-table"],hostVars:2,hostBindings:function(e,r){2&e&&a.ekj("mat-table-fixed-layout",r.fixedLayout)},exportAs:["matTable"],features:[a._Bn([{provide:y1,useClass:ooe},{provide:R$,useExisting:n},{provide:BI,useExisting:n},{provide:Yq,useClass:qoe},{provide:e5,useValue:null}]),a.qOj],ngContentSelectors:ORe,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(e,r){1&e&&(a.F$t(MRe),a.Hsn(0),a.Hsn(1,1),a.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[D$,k$,A$,N$],styles:["mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}table.mat-table{border-spacing:0}tr.mat-header-row{height:56px}tr.mat-row,tr.mat-footer-row{height:48px}th.mat-header-cell{text-align:left}[dir=rtl] th.mat-header-cell{text-align:right}th.mat-header-cell,td.mat-cell,td.mat-footer-cell{padding:0;border-bottom-width:1px;border-bottom-style:solid}th.mat-header-cell:first-of-type,td.mat-cell:first-of-type,td.mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] th.mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] td.mat-cell:first-of-type:not(:only-of-type),[dir=rtl] td.mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}th.mat-header-cell:last-of-type,td.mat-cell:last-of-type,td.mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] th.mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] td.mat-cell:last-of-type:not(:only-of-type),[dir=rtl] td.mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}.mat-table-sticky{position:sticky !important}.mat-table-fixed-layout{table-layout:fixed}"],encapsulation:2}),n})(),t5=(()=>{class n extends VI{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["","matCellDef",""]],features:[a._Bn([{provide:VI,useExisting:n}]),a.qOj]}),n})(),n5=(()=>{class n extends UI{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["","matHeaderCellDef",""]],features:[a._Bn([{provide:UI,useExisting:n}]),a.qOj]}),n})(),r5=(()=>{class n extends up{get name(){return this._name}set name(e){this._setNameInput(e)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[a._Bn([{provide:up,useExisting:n},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),a.qOj]}),n})(),s5=(()=>{class n extends qq{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-header-cell"],features:[a.qOj]}),n})(),o5=(()=>{class n extends Zq{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:["role","gridcell",1,"mat-cell"],features:[a.qOj]}),n})(),Qoe=(()=>{class n extends I1{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[a._Bn([{provide:I1,useExisting:n}]),a.qOj]}),n})(),Xoe=(()=>{class n extends S${}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275dir=a.lG2({type:n,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[a._Bn([{provide:S$,useExisting:n}]),a.qOj]}),n})(),Joe=(()=>{class n extends Qq{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-header-row"],exportAs:["matHeaderRow"],features:[a._Bn([{provide:Qq,useExisting:n}]),a.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,r){1&e&&a.GkF(0,0)},dependencies:[dp],encapsulation:2}),n})(),eae=(()=>{class n extends Jq{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=a.n5z(n)))(r||n)}}(),n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-row"],exportAs:["matRow"],features:[a._Bn([{provide:Jq,useExisting:n}]),a.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,r){1&e&&a.GkF(0,0)},dependencies:[dp],encapsulation:2}),n})(),GRe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[RRe,$n,$n]}),n})();function jRe(n,t){1&n&&a.Hsn(0)}const tae=["*"];function qRe(n,t){}const ZRe=function(n){return{animationDuration:n}},YRe=function(n,t){return{value:n,params:t}},KRe=["tabListContainer"],QRe=["tabList"],XRe=["tabListInner"],JRe=["nextPaginator"],eMe=["previousPaginator"],tMe=["tabBodyWrapper"],nMe=["tabHeader"];function rMe(n,t){}function iMe(n,t){if(1&n&&a.YNc(0,rMe,0,0,"ng-template",10),2&n){const e=a.oxw().$implicit;a.Q6J("cdkPortalOutlet",e.templateLabel)}}function sMe(n,t){if(1&n&&a._uU(0),2&n){const e=a.oxw().$implicit;a.Oqu(e.textLabel)}}function oMe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",6),a.NdJ("click",function(){const i=a.CHM(e),s=i.$implicit,o=i.index,l=a.oxw(),c=a.MAs(1);return a.KtG(l._handleClick(s,c,o))})("cdkFocusChange",function(i){const o=a.CHM(e).index,l=a.oxw();return a.KtG(l._tabFocusChanged(i,o))}),a.TgZ(1,"div",7),a.YNc(2,iMe,1,1,"ng-template",8),a.YNc(3,sMe,1,1,"ng-template",null,9,a.W1O),a.qZA()()}if(2&n){const e=t.$implicit,r=t.index,i=a.MAs(4),s=a.oxw();a.ekj("mat-tab-label-active",s.selectedIndex===r),a.Q6J("id",s._getTabLabelId(r))("ngClass",e.labelClass)("disabled",e.disabled)("matRippleDisabled",e.disabled||s.disableRipple),a.uIk("tabIndex",s._getTabIndex(e,r))("aria-posinset",r+1)("aria-setsize",s._tabs.length)("aria-controls",s._getTabContentId(r))("aria-selected",s.selectedIndex===r)("aria-label",e.ariaLabel||null)("aria-labelledby",!e.ariaLabel&&e.ariaLabelledby?e.ariaLabelledby:null),a.xp6(2),a.Q6J("ngIf",e.templateLabel)("ngIfElse",i)}}function aMe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"mat-tab-body",11),a.NdJ("_onCentered",function(){a.CHM(e);const i=a.oxw();return a.KtG(i._removeTabBodyWrapperHeight())})("_onCentering",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s._setTabBodyWrapperHeight(i))}),a.qZA()}if(2&n){const e=t.$implicit,r=t.index,i=a.oxw();a.ekj("mat-tab-body-active",i.selectedIndex===r),a.Q6J("id",i._getTabContentId(r))("ngClass",e.bodyClass)("content",e.content)("position",e.position)("origin",e.origin)("animationDuration",i.animationDuration)("preserveContent",i.preserveContent),a.uIk("tabindex",null!=i.contentTabIndex&&i.selectedIndex===r?i.contentTabIndex:null)("aria-labelledby",i._getTabLabelId(r))}}const lMe=new a.OlP("MatInkBarPositioner",{providedIn:"root",factory:function cMe(){return t=>({left:t?(t.offsetLeft||0)+"px":"0",width:t?(t.offsetWidth||0)+"px":"0"})}});let nae=(()=>{class n{constructor(e,r,i,s){this._elementRef=e,this._ngZone=r,this._inkBarPositioner=i,this._animationMode=s}alignToElement(e){this.show(),this._ngZone.run(()=>{this._ngZone.onStable.pipe(nr(1)).subscribe(()=>{const r=this._inkBarPositioner(e),i=this._elementRef.nativeElement;i.style.left=r.left,i.style.width=r.width})})}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(lMe),a.Y36(a.QbO,8))},n.\u0275dir=a.lG2({type:n,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(e,r){2&e&&a.ekj("_mat-animation-noopable","NoopAnimations"===r._animationMode)}}),n})();const rae=new a.OlP("MatTabContent");let uMe=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.Rgc))},n.\u0275dir=a.lG2({type:n,selectors:[["","matTabContent",""]],features:[a._Bn([{provide:rae,useExisting:n}])]}),n})();const dMe=new a.OlP("MatTabLabel"),hMe=new a.OlP("MAT_TAB"),fMe=NI(class{}),iae=new a.OlP("MAT_TAB_GROUP");let sae=(()=>{class n extends fMe{constructor(e,r){super(),this._viewContainerRef=e,this._closestTabGroup=r,this.textLabel="",this._contentPortal=null,this._stateChanges=new Xt.x,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(e){this._setTemplateLabelInput(e)}get content(){return this._contentPortal}ngOnChanges(e){(e.hasOwnProperty("textLabel")||e.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new Ab(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(e){e&&e._closestTab===this&&(this._templateLabel=e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.s_b),a.Y36(iae,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-tab"]],contentQueries:function(e,r,i){if(1&e&&(a.Suo(i,dMe,5),a.Suo(i,rae,7,a.Rgc)),2&e){let s;a.iGM(s=a.CRH())&&(r.templateLabel=s.first),a.iGM(s=a.CRH())&&(r._explicitContent=s.first)}},viewQuery:function(e,r){if(1&e&&a.Gf(a.Rgc,7),2&e){let i;a.iGM(i=a.CRH())&&(r._implicitContent=i.first)}},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass"},exportAs:["matTab"],features:[a._Bn([{provide:hMe,useExisting:n}]),a.qOj,a.TTD],ngContentSelectors:tae,decls:1,vars:0,template:function(e,r){1&e&&(a.F$t(),a.YNc(0,jRe,1,0,"ng-template"))},encapsulation:2}),n})();const pMe={translateTab:Bs("translateTab",[yi("center, void, left-origin-center, right-origin-center",Sn({transform:"none"})),yi("left",Sn({transform:"translate3d(-100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),yi("right",Sn({transform:"translate3d(100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),ei("* => left, * => right, left => center, right => center",_i("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),ei("void => left-origin-center",[Sn({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"}),_i("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),ei("void => right-origin-center",[Sn({transform:"translate3d(100%, 0, 0)",visibility:"hidden"}),_i("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let mMe=(()=>{class n extends ed{constructor(e,r,i,s){super(e,r,s),this._host=i,this._centeringSub=kn.w0.EMPTY,this._leavingSub=kn.w0.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(Ui(this._host._isCenterPosition(this._host._position))).subscribe(e=>{e&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this._host.preserveContent||this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a._Vd),a.Y36(a.s_b),a.Y36((0,a.Gpc)(()=>oae)),a.Y36(Nt))},n.\u0275dir=a.lG2({type:n,selectors:[["","matTabBodyHost",""]],features:[a.qOj]}),n})(),gMe=(()=>{class n{constructor(e,r,i){this._elementRef=e,this._dir=r,this._dirChangeSubscription=kn.w0.EMPTY,this._translateTabComplete=new Xt.x,this._onCentering=new a.vpe,this._beforeCentering=new a.vpe,this._afterLeavingCenter=new a.vpe,this._onCentered=new a.vpe(!0),this.animationDuration="500ms",this.preserveContent=!1,r&&(this._dirChangeSubscription=r.change.subscribe(s=>{this._computePositionAnimationState(s),i.markForCheck()})),this._translateTabComplete.pipe($u((s,o)=>s.fromState===o.fromState&&s.toState===o.toState)).subscribe(s=>{this._isCenterPosition(s.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(s.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(e){this._positionIndex=e,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(e){const r=this._isCenterPosition(e.toState);this._beforeCentering.emit(r),r&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(e){return"center"==e||"left-origin-center"==e||"right-origin-center"==e}_computePositionAnimationState(e=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==e?"left":"right":this._positionIndex>0?"ltr"==e?"right":"left":"center"}_computePositionFromOrigin(e){const r=this._getLayoutDirection();return"ltr"==r&&e<=0||"rtl"==r&&e>0?"left-origin-center":"right-origin-center"}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Ws,8),a.Y36(a.sBO))},n.\u0275dir=a.lG2({type:n,inputs:{_content:["content","_content"],origin:"origin",animationDuration:"animationDuration",preserveContent:"preserveContent",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),n})(),oae=(()=>{class n extends gMe{constructor(e,r,i){super(e,r,i)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Ws,8),a.Y36(a.sBO))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-tab-body"]],viewQuery:function(e,r){if(1&e&&a.Gf(ed,5),2&e){let i;a.iGM(i=a.CRH())&&(r._portalHost=i.first)}},hostAttrs:[1,"mat-tab-body"],features:[a.qOj],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(e,r){1&e&&(a.TgZ(0,"div",0,1),a.NdJ("@translateTab.start",function(s){return r._onTranslateTabStarted(s)})("@translateTab.done",function(s){return r._translateTabComplete.next(s)}),a.YNc(2,qRe,0,0,"ng-template",2),a.qZA()),2&e&&a.Q6J("@translateTab",a.WLB(3,YRe,r._position,a.VKq(1,ZRe,r.animationDuration)))},dependencies:[mMe],styles:['.mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}.mat-tab-body-content[style*="visibility: hidden"]{display:none}'],encapsulation:2,data:{animation:[pMe.translateTab]}}),n})();const aae=new a.OlP("MAT_TABS_CONFIG"),_Me=NI(class{});let lae=(()=>{class n extends _Me{constructor(e){super(),this.elementRef=e}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(e,r){2&e&&(a.uIk("aria-disabled",!!r.disabled),a.ekj("mat-tab-disabled",r.disabled))},inputs:{disabled:"disabled"},features:[a.qOj]}),n})();const cae=Tb({passive:!0});let bMe=(()=>{class n{constructor(e,r,i,s,o,l,c){this._elementRef=e,this._changeDetectorRef=r,this._viewportRuler=i,this._dir=s,this._ngZone=o,this._platform=l,this._animationMode=c,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new Xt.x,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new Xt.x,this._disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new a.vpe,this.indexFocused=new a.vpe,o.runOutsideAngular(()=>{Wg(e.nativeElement,"mouseleave").pipe(ur(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get disablePagination(){return this._disablePagination}set disablePagination(e){this._disablePagination=xn(e)}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){e=ga(e),this._selectedIndex!=e&&(this._selectedIndexChanged=!0,this._selectedIndex=e,this._keyManager&&this._keyManager.updateActiveItem(e))}ngAfterViewInit(){Wg(this._previousPaginator.nativeElement,"touchstart",cae).pipe(ur(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),Wg(this._nextPaginator.nativeElement,"touchstart",cae).pipe(ur(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const e=this._dir?this._dir.change:St("ltr"),r=this._viewportRuler.change(150),i=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new aq(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap(),this._keyManager.updateActiveItem(this._selectedIndex),this._ngZone.onStable.pipe(nr(1)).subscribe(i),(0,cs.T)(e,r,this._items.changes,this._itemsResized()).pipe(ur(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>{Promise.resolve().then(()=>{this._scrollDistance=Math.max(0,Math.min(this._getMaxScrollDistance(),this._scrollDistance)),i()})}),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe(ur(this._destroyed)).subscribe(s=>{this.indexFocused.emit(s),this._setTabFocus(s)})}_itemsResized(){return"function"!=typeof ResizeObserver?Ga.E:this._items.changes.pipe(Ui(this._items),wn(e=>new Cr.y(r=>this._ngZone.runOutsideAngular(()=>{const i=new ResizeObserver(s=>r.next(s));return e.forEach(s=>i.observe(s.elementRef.nativeElement)),()=>{i.disconnect()}}))),rq(1),cr(e=>e.some(r=>r.contentRect.width>0&&r.contentRect.height>0)))}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(e){if(!Il(e))switch(e.keyCode){case 13:case 32:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(e));break;default:this._keyManager.onKeydown(e)}}_onContentChanges(){const e=this._elementRef.nativeElement.textContent;e!==this._currentTextContent&&(this._currentTextContent=e||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(e){!this._isValidIndex(e)||this.focusIndex===e||!this._keyManager||this._keyManager.setActiveItem(e)}_isValidIndex(e){if(!this._items)return!0;const r=this._items?this._items.toArray()[e]:null;return!!r&&!r.disabled}_setTabFocus(e){if(this._showPaginationControls&&this._scrollToLabel(e),this._items&&this._items.length){this._items.toArray()[e].focus();const r=this._tabListContainer.nativeElement;r.scrollLeft="ltr"==this._getLayoutDirection()?0:r.scrollWidth-r.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const e=this.scrollDistance,r="ltr"===this._getLayoutDirection()?-e:e;this._tabList.nativeElement.style.transform=`translateX(${Math.round(r)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(e){this._scrollTo(e)}_scrollHeader(e){return this._scrollTo(this._scrollDistance+("before"==e?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(e){this._stopInterval(),this._scrollHeader(e)}_scrollToLabel(e){if(this.disablePagination)return;const r=this._items?this._items.toArray()[e]:null;if(!r)return;const i=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:s,offsetWidth:o}=r.elementRef.nativeElement;let l,c;"ltr"==this._getLayoutDirection()?(l=s,c=l+o):(c=this._tabListInner.nativeElement.offsetWidth-s,l=c-o);const u=this.scrollDistance,f=this.scrollDistance+i;l<u?this.scrollDistance-=u-l+60:c>f&&(this.scrollDistance+=c-f+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const e=this._tabListInner.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;e||(this.scrollDistance=0),e!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=e}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabListInner.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const e=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,r=e?e.elementRef.nativeElement:null;r?this._inkBar.alignToElement(r):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(e,r){r&&null!=r.button&&0!==r.button||(this._stopInterval(),o$(650,100).pipe(ur((0,cs.T)(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:i,distance:s}=this._scrollHeader(e);(0===s||s>=i)&&this._stopInterval()}))}_scrollTo(e){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const r=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(r,e)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:r,distance:this._scrollDistance}}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(jg),a.Y36(Ws,8),a.Y36(a.R0b),a.Y36(Oi),a.Y36(a.QbO,8))},n.\u0275dir=a.lG2({type:n,inputs:{disablePagination:"disablePagination"}}),n})(),wMe=(()=>{class n extends bMe{constructor(e,r,i,s,o,l,c){super(e,r,i,s,o,l,c),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=xn(e)}_itemSelected(e){e.preventDefault()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(jg),a.Y36(Ws,8),a.Y36(a.R0b),a.Y36(Oi),a.Y36(a.QbO,8))},n.\u0275dir=a.lG2({type:n,inputs:{disableRipple:"disableRipple"},features:[a.qOj]}),n})(),CMe=(()=>{class n extends wMe{constructor(e,r,i,s,o,l,c){super(e,r,i,s,o,l,c)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(jg),a.Y36(Ws,8),a.Y36(a.R0b),a.Y36(Oi),a.Y36(a.QbO,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-tab-header"]],contentQueries:function(e,r,i){if(1&e&&a.Suo(i,lae,4),2&e){let s;a.iGM(s=a.CRH())&&(r._items=s)}},viewQuery:function(e,r){if(1&e&&(a.Gf(nae,7),a.Gf(KRe,7),a.Gf(QRe,7),a.Gf(XRe,7),a.Gf(JRe,5),a.Gf(eMe,5)),2&e){let i;a.iGM(i=a.CRH())&&(r._inkBar=i.first),a.iGM(i=a.CRH())&&(r._tabListContainer=i.first),a.iGM(i=a.CRH())&&(r._tabList=i.first),a.iGM(i=a.CRH())&&(r._tabListInner=i.first),a.iGM(i=a.CRH())&&(r._nextPaginator=i.first),a.iGM(i=a.CRH())&&(r._previousPaginator=i.first)}},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(e,r){2&e&&a.ekj("mat-tab-header-pagination-controls-enabled",r._showPaginationControls)("mat-tab-header-rtl","rtl"==r._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[a.qOj],ngContentSelectors:tae,decls:14,vars:10,consts:[["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","disabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["tabListInner",""],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","disabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(e,r){1&e&&(a.F$t(),a.TgZ(0,"button",0,1),a.NdJ("click",function(){return r._handlePaginatorClick("before")})("mousedown",function(s){return r._handlePaginatorPress("before",s)})("touchend",function(){return r._stopInterval()}),a._UZ(2,"div",2),a.qZA(),a.TgZ(3,"div",3,4),a.NdJ("keydown",function(s){return r._handleKeydown(s)}),a.TgZ(5,"div",5,6),a.NdJ("cdkObserveContent",function(){return r._onContentChanges()}),a.TgZ(7,"div",7,8),a.Hsn(9),a.qZA(),a._UZ(10,"mat-ink-bar"),a.qZA()(),a.TgZ(11,"button",9,10),a.NdJ("mousedown",function(s){return r._handlePaginatorPress("after",s)})("click",function(){return r._handlePaginatorClick("after")})("touchend",function(){return r._stopInterval()}),a._UZ(13,"div",2),a.qZA()),2&e&&(a.ekj("mat-tab-header-pagination-disabled",r._disableScrollBefore),a.Q6J("matRippleDisabled",r._disableScrollBefore||r.disableRipple)("disabled",r._disableScrollBefore||null),a.xp6(5),a.ekj("_mat-animation-noopable","NoopAnimations"===r._animationMode),a.xp6(6),a.ekj("mat-tab-header-pagination-disabled",r._disableScrollAfter),a.Q6J("matRippleDisabled",r._disableScrollAfter||r.disableRipple)("disabled",r._disableScrollAfter||null))},dependencies:[fh,iq,nae],styles:[".mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0);touch-action:none;box-sizing:content-box;background:none;border:none;outline:0;padding:0}.mat-tab-header-pagination::-moz-focus-inner{border:0}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}.mat-tab-list._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}.mat-tab-label::before{margin:5px}@media(max-width: 599px){.mat-tab-label{min-width:72px}}"],encapsulation:2}),n})(),xMe=0;class IMe{}const TMe=cp(RI(class{constructor(n){this._elementRef=n}}),"primary");let SMe=(()=>{class n extends TMe{constructor(e,r,i,s){super(e),this._changeDetectorRef=r,this._animationMode=s,this._tabs=new a.n_E,this._indexToSelect=0,this._lastFocusedTabIndex=null,this._tabBodyWrapperHeight=0,this._tabsSubscription=kn.w0.EMPTY,this._tabLabelSubscription=kn.w0.EMPTY,this._dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this._disablePagination=!1,this._preserveContent=!1,this.selectedIndexChange=new a.vpe,this.focusChange=new a.vpe,this.animationDone=new a.vpe,this.selectedTabChange=new a.vpe(!0),this._groupId=xMe++,this.animationDuration=i&&i.animationDuration?i.animationDuration:"500ms",this.disablePagination=!(!i||null==i.disablePagination)&&i.disablePagination,this.dynamicHeight=!(!i||null==i.dynamicHeight)&&i.dynamicHeight,this.contentTabIndex=i?.contentTabIndex??null,this.preserveContent=!!i?.preserveContent}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(e){this._dynamicHeight=xn(e)}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){this._indexToSelect=ga(e,null)}get animationDuration(){return this._animationDuration}set animationDuration(e){this._animationDuration=/^\d+$/.test(e+"")?e+"ms":e}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(e){this._contentTabIndex=ga(e,null)}get disablePagination(){return this._disablePagination}set disablePagination(e){this._disablePagination=xn(e)}get preserveContent(){return this._preserveContent}set preserveContent(e){this._preserveContent=xn(e)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){const r=this._elementRef.nativeElement;r.classList.remove(`mat-background-${this.backgroundColor}`),e&&r.classList.add(`mat-background-${e}`),this._backgroundColor=e}ngAfterContentChecked(){const e=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=e){const r=null==this._selectedIndex;if(!r){this.selectedTabChange.emit(this._createChangeEvent(e));const i=this._tabBodyWrapper.nativeElement;i.style.minHeight=i.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((i,s)=>i.isActive=s===e),r||(this.selectedIndexChange.emit(e),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((r,i)=>{r.position=i-e,null!=this._selectedIndex&&0==r.position&&!r.origin&&(r.origin=e-this._selectedIndex)}),this._selectedIndex!==e&&(this._selectedIndex=e,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{const e=this._clampTabIndex(this._indexToSelect);if(e===this._selectedIndex){const r=this._tabs.toArray();let i;for(let s=0;s<r.length;s++)if(r[s].isActive){this._indexToSelect=this._selectedIndex=s,this._lastFocusedTabIndex=null,i=r[s];break}!i&&r[e]&&Promise.resolve().then(()=>{r[e].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(e))})}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(Ui(this._allTabs)).subscribe(e=>{this._tabs.reset(e.filter(r=>r._closestTabGroup===this||!r._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(e){const r=this._tabHeader;r&&(r.focusIndex=e)}_focusChanged(e){this._lastFocusedTabIndex=e,this.focusChange.emit(this._createChangeEvent(e))}_createChangeEvent(e){const r=new IMe;return r.index=e,this._tabs&&this._tabs.length&&(r.tab=this._tabs.toArray()[e]),r}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=(0,cs.T)(...this._tabs.map(e=>e._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(e){return Math.min(this._tabs.length-1,Math.max(e||0,0))}_getTabLabelId(e){return`mat-tab-label-${this._groupId}-${e}`}_getTabContentId(e){return`mat-tab-content-${this._groupId}-${e}`}_setTabBodyWrapperHeight(e){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const r=this._tabBodyWrapper.nativeElement;r.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(r.style.height=e+"px")}_removeTabBodyWrapperHeight(){const e=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=e.clientHeight,e.style.height="",this.animationDone.emit()}_handleClick(e,r,i){e.disabled||(this.selectedIndex=r.focusIndex=i)}_getTabIndex(e,r){return e.disabled?null:r===(this._lastFocusedTabIndex??this.selectedIndex)?0:-1}_tabFocusChanged(e,r){e&&"mouse"!==e&&"touch"!==e&&(this._tabHeader.focusIndex=r)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(aae,8),a.Y36(a.QbO,8))},n.\u0275dir=a.lG2({type:n,inputs:{dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:"contentTabIndex",disablePagination:"disablePagination",preserveContent:"preserveContent",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[a.qOj]}),n})(),EMe=(()=>{class n extends SMe{constructor(e,r,i,s){super(e,r,i,s)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(aae,8),a.Y36(a.QbO,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-tab-group"]],contentQueries:function(e,r,i){if(1&e&&a.Suo(i,sae,5),2&e){let s;a.iGM(s=a.CRH())&&(r._allTabs=s)}},viewQuery:function(e,r){if(1&e&&(a.Gf(tMe,5),a.Gf(nMe,5)),2&e){let i;a.iGM(i=a.CRH())&&(r._tabBodyWrapper=i.first),a.iGM(i=a.CRH())&&(r._tabHeader=i.first)}},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(e,r){2&e&&a.ekj("mat-tab-group-dynamic-height",r.dynamicHeight)("mat-tab-group-inverted-header","below"===r.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[a._Bn([{provide:iae,useExisting:n}]),a.qOj],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","ngClass","disabled","matRippleDisabled","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","ngClass","disabled","matRippleDisabled","click","cdkFocusChange"],[1,"mat-tab-label-content"],[3,"ngIf","ngIfElse"],["tabTextLabel",""],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering"]],template:function(e,r){1&e&&(a.TgZ(0,"mat-tab-header",0,1),a.NdJ("indexFocused",function(s){return r._focusChanged(s)})("selectFocusedIndex",function(s){return r.selectedIndex=s}),a.YNc(2,oMe,5,15,"div",2),a.qZA(),a.TgZ(3,"div",3,4),a.YNc(5,aMe,1,11,"mat-tab-body",5),a.qZA()),2&e&&(a.Q6J("selectedIndex",r.selectedIndex||0)("disableRipple",r.disableRipple)("disablePagination",r.disablePagination),a.xp6(2),a.Q6J("ngForOf",r._tabs),a.xp6(1),a.ekj("_mat-animation-noopable","NoopAnimations"===r._animationMode),a.xp6(2),a.Q6J("ngForOf",r._tabs))},dependencies:[Aa,Na,Ur,ed,fh,Yie,lae,oae,CMe],styles:[".mat-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-tab-body-wrapper._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}"],encapsulation:2}),n})(),DMe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[No,$n,Zg,MI,qL,e$,$n]}),n})();const kMe=["*",[["mat-toolbar-row"]]],AMe=["*","mat-toolbar-row"],NMe=cp(class{constructor(n){this._elementRef=n}});let RMe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),n})(),MMe=(()=>{class n extends NMe{constructor(e,r,i){super(e),this._platform=r,this._document=i}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq),a.Y36(Oi),a.Y36(Nt))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-toolbar"]],contentQueries:function(e,r,i){if(1&e&&a.Suo(i,RMe,5),2&e){let s;a.iGM(s=a.CRH())&&(r._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,r){2&e&&a.ekj("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",0===r._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[a.qOj],ngContentSelectors:AMe,decls:2,vars:0,template:function(e,r){1&e&&(a.F$t(kMe),a.Hsn(0),a.Hsn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),n})(),OMe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[$n,$n]}),n})();const FMe=["tooltip"],dae="tooltip-panel",hae=Tb({passive:!0}),fae=new a.OlP("mat-tooltip-scroll-strategy"),BMe={provide:fae,deps:[_a],useFactory:function $Me(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},VMe=new a.OlP("mat-tooltip-default-options",{providedIn:"root",factory:function UMe(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}});let zMe=(()=>{class n{constructor(e,r,i,s,o,l,c,u,f,m,_,y){this._overlay=e,this._elementRef=r,this._scrollDispatcher=i,this._viewContainerRef=s,this._ngZone=o,this._platform=l,this._ariaDescriber=c,this._focusMonitor=u,this._dir=m,this._defaultOptions=_,this._position="below",this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new Xt.x,this._scrollStrategy=f,this._document=y,_&&(_.position&&(this.position=_.position),_.touchGestures&&(this.touchGestures=_.touchGestures)),m.change.pipe(ur(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get disabled(){return this._disabled}set disabled(e){this._disabled=xn(e),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=ga(e)}get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=ga(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=e?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(ur(this._destroyed)).subscribe(e=>{e?"keyboard"===e&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const e=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([r,i])=>{e.removeEventListener(r,i,hae)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay();this._detach(),this._portal=this._portal||new qg(this._tooltipComponent,this._viewContainerRef);const i=this._tooltipInstance=r.attach(this._portal).instance;i._triggerElement=this._elementRef.nativeElement,i._mouseLeaveHideDelay=this._hideDelay,i.afterHidden().pipe(ur(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),i.show(e)}hide(e=this.hideDelay){const r=this._tooltipInstance;r&&(r.isVisible()?r.hide(e):(r._cancelPendingAnimations(),this._detach()))}toggle(){this._isTooltipVisible()?this.hide():this.show()}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(){if(this._overlayRef)return this._overlayRef;const e=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(e);return r.positionChanges.pipe(ur(this._destroyed)).subscribe(i=>{this._updateCurrentPositionClass(i.connectionPair),this._tooltipInstance&&i.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${dae}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(ur(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(ur(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(ur(this._destroyed)).subscribe(i=>{this._isTooltipVisible()&&27===i.keyCode&&!Il(i)&&(i.preventDefault(),i.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){const r=e.getConfig().positionStrategy,i=this._getOrigin(),s=this._getOverlayPosition();r.withPositions([this._addOffset({...i.main,...s.main}),this._addOffset({...i.fallback,...s.fallback})])}_addOffset(e){return e}_getOrigin(){const e=!this._dir||"ltr"==this._dir.value,r=this.position;let i;"above"==r||"below"==r?i={originX:"center",originY:"above"==r?"top":"bottom"}:"before"==r||"left"==r&&e||"right"==r&&!e?i={originX:"start",originY:"center"}:("after"==r||"right"==r&&e||"left"==r&&!e)&&(i={originX:"end",originY:"center"});const{x:s,y:o}=this._invertPosition(i.originX,i.originY);return{main:i,fallback:{originX:s,originY:o}}}_getOverlayPosition(){const e=!this._dir||"ltr"==this._dir.value,r=this.position;let i;"above"==r?i={overlayX:"center",overlayY:"bottom"}:"below"==r?i={overlayX:"center",overlayY:"top"}:"before"==r||"left"==r&&e||"right"==r&&!e?i={overlayX:"end",overlayY:"center"}:("after"==r||"right"==r&&e||"left"==r&&!e)&&(i={overlayX:"start",overlayY:"center"});const{x:s,y:o}=this._invertPosition(i.overlayX,i.overlayY);return{main:i,fallback:{overlayX:s,overlayY:o}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(nr(1),ur(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,r){return"above"===this.position||"below"===this.position?"top"===r?r="bottom":"bottom"===r&&(r="top"):"end"===e?e="start":"start"===e&&(e="end"),{x:e,y:r}}_updateCurrentPositionClass(e){const{overlayY:r,originX:i,originY:s}=e;let o;if(o="center"===r?this._dir&&"rtl"===this._dir.value?"end"===i?"left":"right":"start"===i?"left":"right":"bottom"===r&&"top"===s?"above":"below",o!==this._currentPosition){const l=this._overlayRef;if(l){const c=`${this._cssClassPrefix}-${dae}-`;l.removePanelClass(c+this._currentPosition),l.addPanelClass(c+o)}this._currentPosition=o}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",()=>{this._setupPointerExitEventsIfNeeded(),this.show()}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",()=>{this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",r=>{const i=r.relatedTarget;(!i||!this._overlayRef?.overlayElement.contains(i))&&this.hide()}],["wheel",r=>this._wheelListener(r)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const r=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};e.push(["touchend",r],["touchcancel",r])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([r,i])=>{this._elementRef.nativeElement.addEventListener(r,i,hae)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){const r=this._document.elementFromPoint(e.clientX,e.clientY),i=this._elementRef.nativeElement;r!==i&&!i.contains(r)&&this.hide()}}_disableNativeGesturesIfNecessary(){const e=this.touchGestures;if("off"!==e){const r=this._elementRef.nativeElement,i=r.style;("on"===e||"INPUT"!==r.nodeName&&"TEXTAREA"!==r.nodeName)&&(i.userSelect=i.msUserSelect=i.webkitUserSelect=i.MozUserSelect="none"),("on"===e||!r.draggable)&&(i.webkitUserDrag="none"),i.touchAction="none",i.webkitTapHighlightColor="transparent"}}}return n.\u0275fac=function(e){a.$Z()},n.\u0275dir=a.lG2({type:n,inputs:{position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),n})(),S1=(()=>{class n extends zMe{constructor(e,r,i,s,o,l,c,u,f,m,_,y){super(e,r,i,s,o,l,c,u,f,m,_,y),this._tooltipComponent=GMe}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(_a),a.Y36(a.SBq),a.Y36(wse),a.Y36(a.s_b),a.Y36(a.R0b),a.Y36(Oi),a.Y36(OEe),a.Y36(Xc),a.Y36(fae),a.Y36(Ws,8),a.Y36(VMe,8),a.Y36(Nt))},n.\u0275dir=a.lG2({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-tooltip-trigger"],exportAs:["matTooltip"],features:[a.qOj]}),n})(),HMe=(()=>{class n{constructor(e,r){this._changeDetectorRef=e,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new Xt.x,this._animationsDisabled="NoopAnimations"===r}show(e){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_cancelPendingAnimations(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){const r=this._tooltip.nativeElement,i=this._showAnimation,s=this._hideAnimation;if(r.classList.remove(e?s:i),r.classList.add(e?i:s),this._isVisible=e,e&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const o=getComputedStyle(r);("0s"===o.getPropertyValue("animation-duration")||"none"===o.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(r.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.sBO),a.Y36(a.QbO,8))},n.\u0275dir=a.lG2({type:n}),n})(),GMe=(()=>{class n extends HMe{constructor(e,r,i){super(e,i),this._breakpointObserver=r,this._isHandset=this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)"),this._showAnimation="mat-tooltip-show",this._hideAnimation="mat-tooltip-hide"}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.sBO),a.Y36(ZL),a.Y36(a.QbO,8))},n.\u0275cmp=a.Xpm({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(e,r){if(1&e&&a.Gf(FMe,7),2&e){let i;a.iGM(i=a.CRH())&&(r._tooltip=i.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(e,r){1&e&&a.NdJ("mouseleave",function(s){return r._handleMouseLeave(s)}),2&e&&a.Udp("zoom",r.isVisible()?1:null)},features:[a.qOj],decls:4,vars:6,consts:[[1,"mat-tooltip",3,"ngClass","animationend"],["tooltip",""]],template:function(e,r){if(1&e&&(a.TgZ(0,"div",0,1),a.NdJ("animationend",function(s){return r._handleAnimationEnd(s)}),a.ALo(2,"async"),a._uU(3),a.qZA()),2&e){let i;a.ekj("mat-tooltip-handset",null==(i=a.lcZ(2,4,r._isHandset))?null:i.matches),a.Q6J("ngClass",r.tooltipClass),a.xp6(3),a.Oqu(r.message)}},dependencies:[Aa,Oh],styles:[".mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis;transform:scale(0)}.mat-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}.mat-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-tooltip-show{0%{opacity:0;transform:scale(0)}50%{opacity:.5;transform:scale(0.99)}100%{opacity:1;transform:scale(1)}}@keyframes mat-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(1)}}.mat-tooltip-show{animation:mat-tooltip-show 200ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-tooltip-hide{animation:mat-tooltip-hide 100ms cubic-bezier(0, 0, 0.2, 1) forwards}"],encapsulation:2,changeDetection:0}),n})(),WMe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({providers:[BMe],imports:[e$,No,Rb,$n,$n,OI]}),n})(),jMe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[L1e,pq,HDe,nke,YAe,m1e,g1e,h$,q1e,sNe,fAe,_Ne,mDe,INe,RNe,HNe,lRe,Hoe,GRe,DMe,OMe,WMe]}),n})();var qMe=z(9635);function a5(n){return n<=0?()=>Ga.E:(0,ti.e)((t,e)=>{let r=[];t.subscribe((0,zr.x)(e,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)e.next(i);e.complete()},void 0,()=>{r=null}))})}function pae(n,t){const e=arguments.length>=2;return r=>r.pipe(n?cr((i,s)=>n(i,s,r)):Pc.y,a5(1),e?qP(t):_X(()=>new jP))}const rr="primary",E1=Symbol("RouteTitle");class ZMe{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function zI(n){return new ZMe(n)}function YMe(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],l=n[s];if(o.startsWith(":"))i[o.substring(1)]=l;else if(o!==l.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function ph(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let i;for(let s=0;s<e.length;s++)if(i=e[s],!mae(n[i],t[i]))return!1;return!0}function mae(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((i,s)=>r[s]===i)}return n===t}function gae(n){return Array.prototype.concat.apply([],n)}function _ae(n){return n.length>0?n[n.length-1]:null}function Ko(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function Qg(n){return(0,a.CqO)(n)?n:(0,a.QGY)(n)?(0,Dn.D)(Promise.resolve(n)):St(n)}const XMe={exact:function bae(n,t,e){if(!Lb(n.segments,t.segments)||!O$(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!bae(n.children[r],t.children[r],e))return!1;return!0},subset:wae},yae={exact:function JMe(n,t){return ph(n,t)},subset:function eOe(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>mae(n[e],t[e]))},ignored:()=>!0};function vae(n,t,e){return XMe[e.paths](n.root,t.root,e.matrixParams)&&yae[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function wae(n,t,e){return Cae(n,t,t.segments,e)}function Cae(n,t,e,r){if(n.segments.length>e.length){const i=n.segments.slice(0,e.length);return!(!Lb(i,e)||t.hasChildren()||!O$(i,e,r))}if(n.segments.length===e.length){if(!Lb(n.segments,e)||!O$(n.segments,e,r))return!1;for(const i in t.children)if(!n.children[i]||!wae(n.children[i],t.children[i],r))return!1;return!0}{const i=e.slice(0,n.segments.length),s=e.slice(n.segments.length);return!!(Lb(n.segments,i)&&O$(n.segments,i,r)&&n.children[rr])&&Cae(n.children[rr],t,s,r)}}function O$(n,t,e){return t.every((r,i)=>yae[e](n[i].parameters,r.parameters))}class Pb{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=zI(this.queryParams)),this._queryParamMap}toString(){return rOe.serialize(this)}}class ar{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Ko(e,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return F$(this)}}class D1{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=zI(this.parameters)),this._parameterMap}toString(){return Sae(this)}}function Lb(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let xae=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:function(){return new c5},providedIn:"root"}),n})();class c5{parse(t){const e=new hOe(t);return new Pb(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${k1(t.root,!0)}`,r=function oOe(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(i=>`${P$(e)}=${P$(i)}`).join("&"):`${P$(e)}=${P$(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams),i="string"==typeof t.fragment?`#${function iOe(n){return encodeURI(n)}(t.fragment)}`:"";return`${e}${r}${i}`}}const rOe=new c5;function F$(n){return n.segments.map(t=>Sae(t)).join("/")}function k1(n,t){if(!n.hasChildren())return F$(n);if(t){const e=n.children[rr]?k1(n.children[rr],!1):"",r=[];return Ko(n.children,(i,s)=>{s!==rr&&r.push(`${s}:${k1(i,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function nOe(n,t){let e=[];return Ko(n.children,(r,i)=>{i===rr&&(e=e.concat(t(r,i)))}),Ko(n.children,(r,i)=>{i!==rr&&(e=e.concat(t(r,i)))}),e}(n,(r,i)=>i===rr?[k1(n.children[rr],!1)]:[`${i}:${k1(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[rr]?`${F$(n)}/${e[0]}`:`${F$(n)}/(${e.join("//")})`}}function Iae(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function P$(n){return Iae(n).replace(/%3B/gi,";")}function u5(n){return Iae(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function L$(n){return decodeURIComponent(n)}function Tae(n){return L$(n.replace(/\+/g,"%20"))}function Sae(n){return`${u5(n.path)}${function sOe(n){return Object.keys(n).map(t=>`;${u5(t)}=${u5(n[t])}`).join("")}(n.parameters)}`}const aOe=/^[^\/()?;=#]+/;function $$(n){const t=n.match(aOe);return t?t[0]:""}const lOe=/^[^=?&#]+/,uOe=/^[^&#]+/;class hOe{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ar([],{}):new ar([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[rr]=new ar(t,e)),r}parseSegment(){const t=$$(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new a.vHH(4009,!1);return this.capture(t),new D1(L$(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=$$(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const i=$$(this.remaining);i&&(r=i,this.capture(r))}t[L$(e)]=L$(r)}parseQueryParam(t){const e=function cOe(n){const t=n.match(lOe);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=function dOe(n){const t=n.match(uOe);return t?t[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=Tae(e),s=Tae(r);if(t.hasOwnProperty(i)){let o=t[i];Array.isArray(o)||(o=[o],t[i]=o),o.push(s)}else t[i]=s}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=$$(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new a.vHH(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=rr);const o=this.parseChildren();e[s]=1===Object.keys(o).length?o[rr]:new ar([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new a.vHH(4011,!1)}}function d5(n){return n.segments.length>0?new ar([],{[rr]:n}):n}function B$(n){const t={};for(const r of Object.keys(n.children)){const s=B$(n.children[r]);(s.segments.length>0||s.hasChildren())&&(t[r]=s)}return function fOe(n){if(1===n.numberOfChildren&&n.children[rr]){const t=n.children[rr];return new ar(n.segments.concat(t.segments),t.children)}return n}(new ar(n.segments,t))}function $b(n){return n instanceof Pb}function gOe(n,t,e,r,i){if(0===e.length)return HI(t.root,t.root,t.root,r,i);const s=function kae(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new Dae(!0,0,n);let t=0,e=!1;const r=n.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const l={};return Ko(s.outlets,(c,u)=>{l[u]="string"==typeof c?c.split("/"):c}),[...i,{outlets:l}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((l,c)=>{0==c&&"."===l||(0==c&&""===l?e=!0:".."===l?t++:""!=l&&i.push(l))}),i):[...i,s]},[]);return new Dae(e,t,r)}(e);return s.toRoot()?HI(t.root,t.root,new ar([],{}),r,i):function o(c){const u=function yOe(n,t,e,r){if(n.isAbsolute)return new GI(t.root,!0,0);if(-1===r)return new GI(e,e===t.root,0);return function Aae(n,t,e){let r=n,i=t,s=e;for(;s>i;){if(s-=i,r=r.parent,!r)throw new a.vHH(4005,!1);i=r.segments.length}return new GI(r,!1,i-s)}(e,r+(A1(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,t,n.snapshot?._urlSegment,c),f=u.processChildren?R1(u.segmentGroup,u.index,s.commands):f5(u.segmentGroup,u.index,s.commands);return HI(t.root,u.segmentGroup,f,r,i)}(n.snapshot?._lastPathIndex)}function A1(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function N1(n){return"object"==typeof n&&null!=n&&n.outlets}function HI(n,t,e,r,i){let o,s={};r&&Ko(r,(c,u)=>{s[u]=Array.isArray(c)?c.map(f=>`${f}`):`${c}`}),o=n===t?e:Eae(n,t,e);const l=d5(B$(o));return new Pb(l,s,i)}function Eae(n,t,e){const r={};return Ko(n.children,(i,s)=>{r[s]=i===t?e:Eae(i,t,e)}),new ar(n.segments,r)}class Dae{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&A1(r[0]))throw new a.vHH(4003,!1);const i=r.find(N1);if(i&&i!==_ae(r))throw new a.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class GI{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function f5(n,t,e){if(n||(n=new ar([],{})),0===n.segments.length&&n.hasChildren())return R1(n,t,e);const r=function bOe(n,t,e){let r=0,i=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=e.length)return s;const o=n.segments[i],l=e[r];if(N1(l))break;const c=`${l}`,u=r<e.length-1?e[r+1]:null;if(i>0&&void 0===c)break;if(c&&u&&"object"==typeof u&&void 0===u.outlets){if(!Rae(c,u,o))return s;r+=2}else{if(!Rae(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,t,e),i=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const s=new ar(n.segments.slice(0,r.pathIndex),{});return s.children[rr]=new ar(n.segments.slice(r.pathIndex),n.children),R1(s,0,i)}return r.match&&0===i.length?new ar(n.segments,{}):r.match&&!n.hasChildren()?p5(n,t,e):r.match?R1(n,0,i):p5(n,t,e)}function R1(n,t,e){if(0===e.length)return new ar(n.segments,{});{const r=function vOe(n){return N1(n[0])?n[0].outlets:{[rr]:n}}(e),i={};return Ko(r,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(i[o]=f5(n.children[o],t,s))}),Ko(n.children,(s,o)=>{void 0===r[o]&&(i[o]=s)}),new ar(n.segments,i)}}function p5(n,t,e){const r=n.segments.slice(0,t);let i=0;for(;i<e.length;){const s=e[i];if(N1(s)){const c=wOe(s.outlets);return new ar(r,c)}if(0===i&&A1(e[0])){r.push(new D1(n.segments[t].path,Nae(e[0]))),i++;continue}const o=N1(s)?s.outlets[rr]:`${s}`,l=i<e.length-1?e[i+1]:null;o&&l&&A1(l)?(r.push(new D1(o,Nae(l))),i+=2):(r.push(new D1(o,{})),i++)}return new ar(r,{})}function wOe(n){const t={};return Ko(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=p5(new ar([],{}),0,e))}),t}function Nae(n){const t={};return Ko(n,(e,r)=>t[r]=`${e}`),t}function Rae(n,t,e){return n==e.path&&ph(t,e.parameters)}class hp{constructor(t,e){this.id=t,this.url=e}}class m5 extends hp{constructor(t,e,r="imperative",i=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Bb extends hp{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class V$ extends hp{constructor(t,e,r,i){super(t,e),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Mae extends hp{constructor(t,e,r,i){super(t,e),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class COe extends hp{constructor(t,e,r,i){super(t,e),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xOe extends hp{constructor(t,e,r,i){super(t,e),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class IOe extends hp{constructor(t,e,r,i,s){super(t,e),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class TOe extends hp{constructor(t,e,r,i){super(t,e),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class SOe extends hp{constructor(t,e,r,i){super(t,e),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EOe{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class DOe{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class kOe{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class AOe{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class NOe{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ROe{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Oae{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Fae{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=g5(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=g5(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=_5(t,this._root);return e.length<2?[]:e[e.length-2].children.map(i=>i.value).filter(i=>i!==t)}pathFromRoot(t){return _5(t,this._root).map(e=>e.value)}}function g5(n,t){if(n===t.value)return t;for(const e of t.children){const r=g5(n,e);if(r)return r}return null}function _5(n,t){if(n===t.value)return[t];for(const e of t.children){const r=_5(n,e);if(r.length)return r.unshift(t),r}return[]}class fp{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function WI(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class Pae extends Fae{constructor(t,e){super(t),this.snapshot=e,y5(this,t)}toString(){return this.snapshot.toString()}}function Lae(n,t){const e=function OOe(n,t){const o=new U$([],{},{},"",{},rr,t,null,n.root,-1,{});return new Bae("",new fp(o,[]))}(n,t),r=new Zo([new D1("",{})]),i=new Zo({}),s=new Zo({}),o=new Zo({}),l=new Zo(""),c=new mh(r,i,o,l,s,rr,t,e.root);return c.snapshot=e.root,new Pae(new fp(c,[]),e)}class mh{constructor(t,e,r,i,s,o,l,c){this.url=t,this.params=e,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=l,this.title=this.data?.pipe((0,Ot.U)(u=>u[E1]))??St(void 0),this._futureSnapshot=c}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ot.U)(t=>zI(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ot.U)(t=>zI(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function $ae(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const i=e[r],s=e[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(s.component)break;r--}}return function FOe(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class U${constructor(t,e,r,i,s,o,l,c,u,f,m,_){this.url=t,this.params=e,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=l,this.title=this.data?.[E1],this.routeConfig=c,this._urlSegment=u,this._lastPathIndex=f,this._correctedLastPathIndex=_??f,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=zI(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=zI(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Bae extends Fae{constructor(t,e){super(e),this.url=t,y5(this,e)}toString(){return Vae(this._root)}}function y5(n,t){t.value._routerState=n,t.children.forEach(e=>y5(n,e))}function Vae(n){const t=n.children.length>0?` { ${n.children.map(Vae).join(", ")} } `:"";return`${n.value}${t}`}function v5(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,ph(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),ph(t.params,e.params)||n.params.next(e.params),function KMe(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!ph(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),ph(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function b5(n,t){const e=ph(n.params,t.params)&&function tOe(n,t){return Lb(n,t)&&n.every((e,r)=>ph(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||b5(n.parent,t.parent))}function M1(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const i=function LOe(n,t,e){return t.children.map(r=>{for(const i of e.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return M1(n,r,i);return M1(n,r)})}(n,t,e);return new fp(r,i)}{if(n.shouldAttach(t.value)){const s=n.retrieve(t.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(l=>M1(n,l)),o}}const r=function $Oe(n){return new mh(new Zo(n.url),new Zo(n.params),new Zo(n.queryParams),new Zo(n.fragment),new Zo(n.data),n.outlet,n.component,n)}(t.value),i=t.children.map(s=>M1(n,s));return new fp(r,i)}}const w5="ngNavigationCancelingError";function Uae(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=$b(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,i=zae(!1,0,t);return i.url=e,i.navigationBehaviorOptions=r,i}function zae(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[w5]=!0,r.cancellationCode=t,e&&(r.url=e),r}function Hae(n){return Gae(n)&&$b(n.url)}function Gae(n){return n&&n[w5]}class BOe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new O1,this.attachRef=null}}let O1=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const i=this.getOrCreateContext(e);i.outlet=r,this.contexts.set(e,i)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new BOe,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const z$=!1;let C5=(()=>{class n{constructor(e,r,i,s,o){this.parentContexts=e,this.location=r,this.changeDetector=s,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new a.vpe,this.deactivateEvents=new a.vpe,this.attachEvents=new a.vpe,this.detachEvents=new a.vpe,this.name=i||rr,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new a.vHH(4012,z$);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new a.vHH(4012,z$);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new a.vHH(4012,z$);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new a.vHH(4013,z$);this._activatedRoute=e;const i=this.location,o=e._futureSnapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new VOe(e,l,i.injector);if(r&&function UOe(n){return!!n.resolveComponentFactory}(r)){const u=r.resolveComponentFactory(o);this.activated=i.createComponent(u,i.length,c)}else this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(O1),a.Y36(a.s_b),a.$8M("name"),a.Y36(a.sBO),a.Y36(a.lqb))},n.\u0275dir=a.lG2({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class VOe{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===mh?this.route:t===O1?this.childContexts:this.parent.get(t,e)}}let x5=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[a.jDz],decls:1,vars:0,template:function(e,r){1&e&&a._UZ(0,"router-outlet")},dependencies:[C5],encapsulation:2}),n})();function Wae(n,t){return n.providers&&!n._injector&&(n._injector=(0,a.MMx)(n.providers,t,`Route: ${n.path}`)),n._injector??t}function T5(n){const t=n.children&&n.children.map(T5),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==rr&&(e.component=x5),e}function eu(n){return n.outlet||rr}function jae(n,t){const e=n.filter(r=>eu(r)===t);return e.push(...n.filter(r=>eu(r)!==t)),e}function F1(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class jOe{constructor(t,e,r,i){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=i}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),v5(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const i=WI(e);t.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Ko(i,(s,o)=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(t,e,r){const i=t.value,s=e?e.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else s&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),i=r&&t.value.component?r.children:e,s=WI(t);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),l=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:l})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),i=r&&t.value.component?r.children:e,s=WI(t);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const i=WI(e);t.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new ROe(s.value.snapshot))}),t.children.length&&this.forwardEvent(new AOe(t.value.snapshot))}activateRoutes(t,e,r){const i=t.value,s=e?e.value:null;if(v5(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const l=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(l.contexts),o.attachRef=l.componentRef,o.route=l.route.value,o.outlet&&o.outlet.attach(l.componentRef,l.route.value),v5(l.route.value),this.activateChildRoutes(t,null,o.children)}else{const l=F1(i.snapshot),c=l?.get(a._Vd)??null;o.attachRef=null,o.route=i,o.resolver=c,o.injector=l,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}}class qae{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class H${constructor(t,e){this.component=t,this.route=e}}function qOe(n,t,e){const r=n._root;return P1(r,t?t._root:null,e,[r.value])}function jI(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||(0,a.Z0I)(n)?t.get(n):n:r}function P1(n,t,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=WI(t);return n.children.forEach(o=>{(function YOe(n,t,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=t?t.value:null,l=e?e.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function KOe(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!Lb(n.url,t.url);case"pathParamsOrQueryParamsChange":return!Lb(n.url,t.url)||!ph(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!b5(n,t)||!ph(n.queryParams,t.queryParams);default:return!b5(n,t)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new qae(r)):(s.data=o.data,s._resolvedData=o._resolvedData),P1(n,t,s.component?l?l.children:null:e,r,i),c&&l&&l.outlet&&l.outlet.isActivated&&i.canDeactivateChecks.push(new H$(l.outlet.component,o))}else o&&L1(t,l,i),i.canActivateChecks.push(new qae(r)),P1(n,null,s.component?l?l.children:null:e,r,i)})(o,s[o.value.outlet],e,r.concat([o.value]),i),delete s[o.value.outlet]}),Ko(s,(o,l)=>L1(o,e.getContext(l),i)),i}function L1(n,t,e){const r=WI(n),i=n.value;Ko(r,(s,o)=>{L1(s,i.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new H$(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}function $1(n){return"function"==typeof n}function S5(n){return n instanceof jP||"EmptyError"===n?.name}const G$=Symbol("INITIAL_VALUE");function qI(){return wn(n=>DI(n.map(t=>t.pipe(nr(1),Ui(G$)))).pipe((0,Ot.U)(t=>{for(const e of t)if(!0!==e){if(e===G$)return G$;if(!1===e||e instanceof Pb)return e}return!0}),cr(t=>t!==G$),nr(1)))}function Zae(n){return(0,qMe.z)(Qr(t=>{if($b(t))throw Uae(0,t)}),(0,Ot.U)(t=>!0===t))}const E5={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Yae(n,t,e,r,i){const s=D5(n,t,e);return s.matched?function fFe(n,t,e,r){const i=t.canMatch;return i&&0!==i.length?St(i.map(o=>{const l=jI(o,n);return Qg(function nFe(n){return n&&$1(n.canMatch)}(l)?l.canMatch(t,e):n.runInContext(()=>l(t,e)))})).pipe(qI(),Zae()):St(!0)}(r=Wae(t,r),t,e).pipe((0,Ot.U)(o=>!0===o?s:{...E5})):St(s)}function D5(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...E5}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const i=(t.matcher||YMe)(e,n,t);if(!i)return{...E5};const s={};Ko(i.posParams,(l,c)=>{s[c]=l.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:e.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function W$(n,t,e,r,i="corrected"){if(e.length>0&&function gFe(n,t,e){return e.some(r=>j$(n,t,r)&&eu(r)!==rr)}(n,e,r)){const o=new ar(t,function mFe(n,t,e,r){const i={};i[rr]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const s of e)if(""===s.path&&eu(s)!==rr){const o=new ar([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,i[eu(s)]=o}return i}(n,t,r,new ar(e,n.children)));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function _Fe(n,t,e){return e.some(r=>j$(n,t,r))}(n,e,r)){const o=new ar(n.segments,function pFe(n,t,e,r,i,s){const o={};for(const l of r)if(j$(n,e,l)&&!i[eu(l)]){const c=new ar([],{});c._sourceSegment=n,c._segmentIndexShift="legacy"===s?n.segments.length:t.length,o[eu(l)]=c}return{...i,...o}}(n,t,e,r,n.children,i));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}const s=new ar(n.segments,n.children);return s._sourceSegment=n,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:e}}function j$(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function Kae(n,t,e,r){return!!(eu(n)===r||r!==rr&&j$(t,e,n))&&("**"===n.path||D5(t,n,e).matched)}function Qae(n,t,e){return 0===t.length&&!n.children[e]}const q$=!1;class Z${constructor(t){this.segmentGroup=t||null}}class Xae{constructor(t){this.urlTree=t}}function B1(n){return yo(new Z$(n))}function Jae(n){return yo(new Xae(n))}class wFe{constructor(t,e,r,i,s){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=i,this.config=s,this.allowRedirects=!0}apply(){const t=W$(this.urlTree.root,[],[],this.config).segmentGroup,e=new ar(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,rr).pipe((0,Ot.U)(s=>this.createUrlTree(B$(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ts(s=>{if(s instanceof Xae)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Z$?this.noMatchError(s):s}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,rr).pipe((0,Ot.U)(i=>this.createUrlTree(B$(i),t.queryParams,t.fragment))).pipe(ts(i=>{throw i instanceof Z$?this.noMatchError(i):i}))}noMatchError(t){return new a.vHH(4002,q$)}createUrlTree(t,e,r){const i=d5(t);return new Pb(i,e,r)}expandSegmentGroup(t,e,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe((0,Ot.U)(s=>new ar([],s))):this.expandSegment(t,r,e,r.segments,i,!0)}expandChildren(t,e,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return(0,Dn.D)(i).pipe(uo(s=>{const o=r.children[s],l=jae(e,s);return this.expandSegmentGroup(t,l,o,s).pipe((0,Ot.U)(c=>({segment:c,outlet:s})))}),Ff((s,o)=>(s[o.outlet]=o.segment,s),{}),pae())}expandSegment(t,e,r,i,s,o){return(0,Dn.D)(r).pipe(uo(l=>this.expandSegmentAgainstRoute(t,e,r,l,i,s,o).pipe(ts(u=>{if(u instanceof Z$)return St(null);throw u}))),qf(l=>!!l),ts((l,c)=>{if(S5(l))return Qae(e,i,s)?St(new ar([],{})):B1(e);throw l}))}expandSegmentAgainstRoute(t,e,r,i,s,o,l){return Kae(i,e,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,e,i,s,o):l&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,i,s,o):B1(e):B1(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,i){const s=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Jae(s):this.lineralizeSegments(r,s).pipe((0,Cs.z)(o=>{const l=new ar(o,{});return this.expandSegment(t,l,e,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,i,s,o){const{matched:l,consumedSegments:c,remainingSegments:u,positionalParamSegments:f}=D5(e,i,s);if(!l)return B1(e);const m=this.applyRedirectCommands(c,i.redirectTo,f);return i.redirectTo.startsWith("/")?Jae(m):this.lineralizeSegments(i,m).pipe((0,Cs.z)(_=>this.expandSegment(t,e,r,_.concat(u),o,!1)))}matchSegmentAgainstRoute(t,e,r,i,s){return"**"===r.path?(t=Wae(r,t),r.loadChildren?(r._loadedRoutes?St({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe((0,Ot.U)(l=>(r._loadedRoutes=l.routes,r._loadedInjector=l.injector,new ar(i,{})))):St(new ar(i,{}))):Yae(e,r,i,t).pipe(wn(({matched:o,consumedSegments:l,remainingSegments:c})=>o?this.getChildConfig(t=r._injector??t,r,i).pipe((0,Cs.z)(f=>{const m=f.injector??t,_=f.routes,{segmentGroup:y,slicedSegments:w}=W$(e,l,c,_),T=new ar(y.segments,y.children);if(0===w.length&&T.hasChildren())return this.expandChildren(m,_,T).pipe((0,Ot.U)(M=>new ar(l,M)));if(0===_.length&&0===w.length)return St(new ar(l,{}));const I=eu(r)===s;return this.expandSegment(m,T,_,w,I?rr:s,!0).pipe((0,Ot.U)(A=>new ar(l.concat(A.segments),A.children)))})):B1(e)))}getChildConfig(t,e,r){return e.children?St({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?St({routes:e._loadedRoutes,injector:e._loadedInjector}):function hFe(n,t,e,r){const i=t.canLoad;return void 0===i||0===i.length?St(!0):St(i.map(o=>{const l=jI(o,n);return Qg(function XOe(n){return n&&$1(n.canLoad)}(l)?l.canLoad(t,e):n.runInContext(()=>l(t,e)))})).pipe(qI(),Zae())}(t,e,r).pipe((0,Cs.z)(i=>i?this.configLoader.loadChildren(t,e).pipe(Qr(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):function vFe(n){return yo(zae(q$,3))}())):St({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],i=e.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return St(r);if(i.numberOfChildren>1||!i.children[rr])return yo(new a.vHH(4e3,q$));i=i.children[rr]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,i){const s=this.createSegmentGroup(t,e.root,r,i);return new Pb(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return Ko(t,(i,s)=>{if("string"==typeof i&&i.startsWith(":")){const l=i.substring(1);r[s]=e[l]}else r[s]=i}),r}createSegmentGroup(t,e,r,i){const s=this.createSegments(t,e.segments,r,i);let o={};return Ko(e.children,(l,c)=>{o[c]=this.createSegmentGroup(t,l,r,i)}),new ar(s,o)}createSegments(t,e,r,i){return e.map(s=>s.path.startsWith(":")?this.findPosParam(t,s,i):this.findOrReturn(s,r))}findPosParam(t,e,r){const i=r[e.path.substring(1)];if(!i)throw new a.vHH(4001,q$);return i}findOrReturn(t,e){let r=0;for(const i of e){if(i.path===t.path)return e.splice(r),i;r++}return t}}class xFe{}class SFe{constructor(t,e,r,i,s,o,l,c){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=i,this.url=s,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=l,this.urlSerializer=c}recognize(){const t=W$(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,rr).pipe((0,Ot.U)(e=>{if(null===e)return null;const r=new U$([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},rr,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new fp(r,e),s=new Bae(this.url,i);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(t){const e=t.value,r=$ae(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(t,e,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,i)}processChildren(t,e,r){return(0,Dn.D)(Object.keys(r.children)).pipe(uo(i=>{const s=r.children[i],o=jae(e,i);return this.processSegmentGroup(t,o,s,i)}),Ff((i,s)=>i&&s?(i.push(...s),i):null),Cse(i=>null!==i),qP(null),pae(),(0,Ot.U)(i=>{if(null===i)return null;const s=ele(i);return function EFe(n){n.sort((t,e)=>t.value.outlet===rr?-1:e.value.outlet===rr?1:t.value.outlet.localeCompare(e.value.outlet))}(s),s}))}processSegment(t,e,r,i,s){return(0,Dn.D)(e).pipe(uo(o=>this.processSegmentAgainstRoute(o._injector??t,o,r,i,s)),qf(o=>!!o),ts(o=>{if(S5(o))return Qae(r,i,s)?St([]):St(null);throw o}))}processSegmentAgainstRoute(t,e,r,i,s){if(e.redirectTo||!Kae(e,r,i,s))return St(null);let o;if("**"===e.path){const l=i.length>0?_ae(i).parameters:{},c=nle(r)+i.length;o=St({snapshot:new U$(i,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ile(e),eu(e),e.component??e._loadedComponent??null,e,tle(r),c,sle(e),c),consumedSegments:[],remainingSegments:[]})}else o=Yae(r,e,i,t).pipe((0,Ot.U)(({matched:l,consumedSegments:c,remainingSegments:u,parameters:f})=>{if(!l)return null;const m=nle(r)+c.length;return{snapshot:new U$(c,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ile(e),eu(e),e.component??e._loadedComponent??null,e,tle(r),m,sle(e),m),consumedSegments:c,remainingSegments:u}}));return o.pipe(wn(l=>{if(null===l)return St(null);const{snapshot:c,consumedSegments:u,remainingSegments:f}=l;t=e._injector??t;const m=e._loadedInjector??t,_=function DFe(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:y,slicedSegments:w}=W$(r,u,f,_.filter(I=>void 0===I.redirectTo),this.relativeLinkResolution);if(0===w.length&&y.hasChildren())return this.processChildren(m,_,y).pipe((0,Ot.U)(I=>null===I?null:[new fp(c,I)]));if(0===_.length&&0===w.length)return St([new fp(c,[])]);const T=eu(e)===s;return this.processSegment(m,_,y,w,T?rr:s).pipe((0,Ot.U)(I=>null===I?null:[new fp(c,I)]))}))}}function kFe(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function ele(n){const t=[],e=new Set;for(const r of n){if(!kFe(r)){t.push(r);continue}const i=t.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),e.add(i)):t.push(r)}for(const r of e){const i=ele(r.children);t.push(new fp(r.value,i))}return t.filter(r=>!e.has(r))}function tle(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function nle(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function ile(n){return n.data||{}}function sle(n){return n.resolve||{}}function ole(n){return"string"==typeof n.title||null===n.title}function k5(n){return wn(t=>{const e=n(t);return e?(0,Dn.D)(e).pipe((0,Ot.U)(()=>t)):St(t)})}let ale=(()=>{class n{buildTitle(e){let r,i=e.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===rr);return r}getResolvedTitleForRoute(e){return e.data[E1]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:function(){return(0,a.f3M)(lle)},providedIn:"root"}),n})(),lle=(()=>{class n extends ale{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(X0))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class LFe{}class BFe extends class $Fe{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const K$=new a.OlP("",{providedIn:"root",factory:()=>({})}),A5=new a.OlP("ROUTES");let N5=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return St(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=Qg(e.loadComponent()).pipe(Qr(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),v1(()=>{this.componentLoaders.delete(e)})),i=new Fq(r,()=>new Xt.x).pipe(Oq());return this.componentLoaders.set(e,i),i}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return St({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe((0,Ot.U)(l=>{this.onLoadEndListener&&this.onLoadEndListener(r);let c,u,f=!1;Array.isArray(l)?u=l:(c=l.create(e).injector,u=gae(c.get(A5,[],a.XFs.Self|a.XFs.Optional)));return{routes:u.map(T5),injector:c}}),v1(()=>{this.childrenLoaders.delete(r)})),o=new Fq(s,()=>new Xt.x).pipe(Oq());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(e){return Qg(e()).pipe((0,Cs.z)(r=>r instanceof a.YKP||Array.isArray(r)?St(r):(0,Dn.D)(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(a.zs3),a.LFG(a.Sil))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class UFe{}class zFe{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function HFe(n){throw n}function GFe(n,t,e){return t.parse("/")}const WFe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},jFe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function ule(){const n=(0,a.f3M)(xae),t=(0,a.f3M)(O1),e=(0,a.f3M)(_n),r=(0,a.f3M)(a.zs3),i=(0,a.f3M)(a.Sil),s=(0,a.f3M)(A5,{optional:!0})??[],o=(0,a.f3M)(K$,{optional:!0})??{},l=(0,a.f3M)(lle),c=(0,a.f3M)(ale,{optional:!0}),u=(0,a.f3M)(UFe,{optional:!0}),f=(0,a.f3M)(LFe,{optional:!0}),m=new jr(null,n,t,e,r,i,gae(s));return u&&(m.urlHandlingStrategy=u),f&&(m.routeReuseStrategy=f),m.titleStrategy=c??l,function qFe(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let jr=(()=>{class n{constructor(e,r,i,s,o,l,c){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=i,this.location=s,this.config=c,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Xt.x,this.errorHandler=HFe,this.malformedUriErrorHandler=GFe,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>St(void 0),this.urlHandlingStrategy=new zFe,this.routeReuseStrategy=new BFe,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(N5),this.configLoader.onLoadEndListener=_=>this.triggerEvent(new DOe(_)),this.configLoader.onLoadStartListener=_=>this.triggerEvent(new EOe(_)),this.ngModule=o.get(a.h0i),this.console=o.get(a.c2e);const m=o.get(a.R0b);this.isNgZoneEnabled=m instanceof a.R0b&&a.R0b.isInAngularZone(),this.resetConfig(c),this.currentUrlTree=function QMe(){return new Pb(new ar([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Lae(this.currentUrlTree,this.rootComponentType),this.transitions=new Zo({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(cr(i=>0!==i.id),(0,Ot.U)(i=>({...i,extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),wn(i=>{let s=!1,o=!1;return St(i).pipe(Qr(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),wn(l=>{const c=this.browserUrlTree.toString(),u=!this.navigated||l.extractedUrl.toString()!==c||c!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||u)&&this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return dle(l.source)&&(this.browserUrlTree=l.extractedUrl),St(l).pipe(wn(m=>{const _=this.transitions.getValue();return r.next(new m5(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),_!==this.transitions.getValue()?Ga.E:Promise.resolve(m)}),function CFe(n,t,e,r){return wn(i=>function bFe(n,t,e,r,i){return new wFe(n,t,e,r,i).apply()}(n,t,e,i.extractedUrl,r).pipe((0,Ot.U)(s=>({...i,urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Qr(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},i.urlAfterRedirects=m.urlAfterRedirects}),function NFe(n,t,e,r,i,s){return(0,Cs.z)(o=>function TFe(n,t,e,r,i,s,o="emptyOnly",l="legacy"){return new SFe(n,t,e,r,i,o,l,s).recognize().pipe(wn(c=>null===c?function IFe(n){return new Cr.y(t=>t.error(n))}(new xFe):St(c)))}(n,t,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,i,s).pipe((0,Ot.U)(l=>({...o,targetSnapshot:l}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),Qr(m=>{if(i.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const y=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(y,m)}this.browserUrlTree=m.urlAfterRedirects}const _=new COe(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(_)}));if(u&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:_,extractedUrl:y,source:w,restoredState:T,extras:I}=l,E=new m5(_,this.serializeUrl(y),w,T);r.next(E);const A=Lae(y,this.rootComponentType).snapshot;return St(i={...l,targetSnapshot:A,urlAfterRedirects:y,extras:{...I,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=l.rawUrl,l.resolve(null),Ga.E}),Qr(l=>{const c=new xOe(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),(0,Ot.U)(l=>i={...l,guards:qOe(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),function iFe(n,t){return(0,Cs.z)(e=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=e;return 0===o.length&&0===s.length?St({...e,guardsResult:!0}):function sFe(n,t,e,r){return(0,Dn.D)(n).pipe((0,Cs.z)(i=>function dFe(n,t,e,r,i){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?St(s.map(l=>{const c=F1(t)??i,u=jI(l,c);return Qg(function tFe(n){return n&&$1(n.canDeactivate)}(u)?u.canDeactivate(n,t,e,r):c.runInContext(()=>u(n,t,e,r))).pipe(qf())})).pipe(qI()):St(!0)}(i.component,i.route,e,t,r)),qf(i=>!0!==i,!0))}(o,r,i,n).pipe((0,Cs.z)(l=>l&&function QOe(n){return"boolean"==typeof n}(l)?function oFe(n,t,e,r){return(0,Dn.D)(t).pipe(uo(i=>Vk(function lFe(n,t){return null!==n&&t&&t(new kOe(n)),St(!0)}(i.route.parent,r),function aFe(n,t){return null!==n&&t&&t(new NOe(n)),St(!0)}(i.route,r),function uFe(n,t,e){const r=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(o=>function ZOe(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>_1(()=>St(o.guards.map(c=>{const u=F1(o.node)??e,f=jI(c,u);return Qg(function eFe(n){return n&&$1(n.canActivateChild)}(f)?f.canActivateChild(r,n):u.runInContext(()=>f(r,n))).pipe(qf())})).pipe(qI())));return St(s).pipe(qI())}(n,i.path,e),function cFe(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return St(!0);const i=r.map(s=>_1(()=>{const o=F1(t)??e,l=jI(s,o);return Qg(function JOe(n){return n&&$1(n.canActivate)}(l)?l.canActivate(t,n):o.runInContext(()=>l(t,n))).pipe(qf())}));return St(i).pipe(qI())}(n,i.route,e))),qf(i=>!0!==i,!0))}(r,s,n,t):St(l)),(0,Ot.U)(l=>({...e,guardsResult:l})))})}(this.ngModule.injector,l=>this.triggerEvent(l)),Qr(l=>{if(i.guardsResult=l.guardsResult,$b(l.guardsResult))throw Uae(0,l.guardsResult);const c=new IOe(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.triggerEvent(c)}),cr(l=>!!l.guardsResult||(this.restoreHistory(l),this.cancelNavigationTransition(l,"",3),!1)),k5(l=>{if(l.guards.canActivateChecks.length)return St(l).pipe(Qr(c=>{const u=new TOe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),wn(c=>{let u=!1;return St(c).pipe(function RFe(n,t){return(0,Cs.z)(e=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=e;if(!i.length)return St(e);let s=0;return(0,Dn.D)(i).pipe(uo(o=>function MFe(n,t,e,r){const i=n.routeConfig,s=n._resolve;return void 0!==i?.title&&!ole(i)&&(s[E1]=i.title),function OFe(n,t,e,r){const i=function FFe(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return St({});const s={};return(0,Dn.D)(i).pipe((0,Cs.z)(o=>function PFe(n,t,e,r){const i=F1(t)??r,s=jI(n,i);return Qg(s.resolve?s.resolve(t,e):i.runInContext(()=>s(t,e)))}(n[o],t,e,r).pipe(qf(),Qr(l=>{s[o]=l}))),a5(1),xoe(s),ts(o=>S5(o)?Ga.E:yo(o)))}(s,n,t,r).pipe((0,Ot.U)(o=>(n._resolvedData=o,n.data=$ae(n,e).resolve,i&&ole(i)&&(n.data[E1]=i.title),null)))}(o.route,r,n,t)),Qr(()=>s++),a5(1),(0,Cs.z)(o=>s===i.length?St(e):Ga.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Qr({next:()=>u=!0,complete:()=>{u||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),Qr(c=>{const u=new SOe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}))}),k5(l=>{const c=u=>{const f=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(u.routeConfig).pipe(Qr(m=>{u.component=m}),(0,Ot.U)(()=>{})));for(const m of u.children)f.push(...c(m));return f};return DI(c(l.targetSnapshot.root)).pipe(qP(),nr(1))}),k5(()=>this.afterPreactivation()),(0,Ot.U)(l=>{const c=function POe(n,t,e){const r=M1(n,t._root,e?e._root:void 0);return new Pae(r,t)}(this.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return i={...l,targetRouterState:c}}),Qr(l=>{this.currentUrlTree=l.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(l.urlAfterRedirects,l.rawUrl),this.routerState=l.targetRouterState,"deferred"===this.urlUpdateStrategy&&(l.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,l),this.browserUrlTree=l.urlAfterRedirects)}),((n,t,e)=>(0,Ot.U)(r=>(new jOe(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,l=>this.triggerEvent(l)),Qr({next(){s=!0},complete(){s=!0}}),v1(()=>{s||o||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),ts(l=>{if(o=!0,Gae(l)){Hae(l)||(this.navigated=!0,this.restoreHistory(i,!0));const c=new V$(i.id,this.serializeUrl(i.extractedUrl),l.message,l.cancellationCode);if(r.next(c),Hae(l)){const u=this.urlHandlingStrategy.merge(l.url,this.rawUrlTree),f={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||dle(i.source)};this.scheduleNavigation(u,"imperative",null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{this.restoreHistory(i,!0);const c=new Mae(i.id,this.serializeUrl(i.extractedUrl),l,i.targetSnapshot??void 0);r.next(c);try{i.resolve(this.errorHandler(l))}catch(u){i.reject(u)}}return Ga.E}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const i={replaceUrl:!0},s=e.state?.navigationId?e.state:null;if(s){const l={...s};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(i.state=l)}const o=this.parseUrl(e.url);this.scheduleNavigation(o,r,s,i)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(T5),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:l,preserveFragment:c}=r,u=i||this.routerState.root,f=c?this.currentUrlTree.fragment:o;let m=null;switch(l){case"merge":m={...this.currentUrlTree.queryParams,...s};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=s||null}return null!==m&&(m=this.removeEmptyProps(m)),gOe(u,this.currentUrlTree,e,m,f??null)}navigateByUrl(e,r={skipLocationChange:!1}){const i=$b(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function ZFe(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new a.vHH(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,e)}return r}isActive(e,r){let i;if(i=!0===r?{...WFe}:!1===r?{...jFe}:r,$b(e))return vae(this.currentUrlTree,e,i);const s=this.parseUrl(e);return vae(this.currentUrlTree,s,i)}removeEmptyProps(e){return Object.keys(e).reduce((r,i)=>{const s=e[i];return null!=s&&(r[i]=s),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new Bb(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let l,c,u;o?(l=o.resolve,c=o.reject,u=o.promise):u=new Promise((_,y)=>{l=_,c=y});const f=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),m=i&&i.\u0275routerPageId?i.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:f,targetPageId:m,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:s,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(_=>Promise.reject(_))}setBrowserUrl(e,r){const i=this.urlSerializer.serialize(e),s={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",s):this.location.go(i,"",s)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===i?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,i){const s=new V$(e.id,this.serializeUrl(e.extractedUrl),r,i);this.triggerEvent(s),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){a.$Z()},n.\u0275prov=a.Yz7({token:n,factory:function(){return ule()},providedIn:"root"}),n})();function dle(n){return"imperative"!==n}let X$=(()=>{class n{constructor(e,r,i,s,o){this.router=e,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new Xt.x,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=(0,a.D6c)(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=(0,a.D6c)(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=(0,a.D6c)(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,i=this.el.nativeElement;null!==e?r.setAttribute(i,"tabindex",e):r.removeAttribute(i,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(jr),a.Y36(mh),a.$8M("tabindex"),a.Y36(a.Qsj),a.Y36(a.SBq))},n.\u0275dir=a.lG2({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&a.NdJ("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[a.TTD]}),n})(),V1=(()=>{class n{constructor(e,r,i){this.router=e,this.route=r,this.locationStrategy=i,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new Xt.x,this.subscription=e.events.subscribe(s=>{s instanceof Bb&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=(0,a.D6c)(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=(0,a.D6c)(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=(0,a.D6c)(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,i,s,o){return!!(0!==e||r||i||s||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(jr),a.Y36(mh),a.Y36(ct))},n.\u0275dir=a.lG2({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&a.NdJ("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&e&&a.uIk("target",r.target)("href",r.href,a.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[a.TTD]}),n})();class hle{}let QFe=(()=>{class n{constructor(e,r,i,s,o){this.router=e,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(cr(e=>e instanceof Bb),uo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=(0,a.MMx)(s.providers,e,`Route: ${s.path}`));const o=s._injector??e,l=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?i.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&i.push(this.processRoutes(l,s.children??s._loadedRoutes))}return(0,Dn.D)(i).pipe((0,Bk.J)())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):St(null);const s=i.pipe((0,Cs.z)(o=>null===o?St(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));if(r.loadComponent&&!r._loadedComponent){const o=this.loader.loadComponent(r);return(0,Dn.D)([s,o]).pipe((0,Bk.J)())}return s})}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(jr),a.LFG(a.Sil),a.LFG(a.lqb),a.LFG(hle),a.LFG(N5))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const R5=new a.OlP("");let fle=(()=>{class n{constructor(e,r,i={}){this.router=e,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof m5?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Bb&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Oae&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new Oae(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){a.$Z()},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),n})();function ZI(n,t){return{\u0275kind:n,\u0275providers:t}}function M5(n){return[{provide:A5,multi:!0,useValue:n}]}function mle(){const n=(0,a.f3M)(a.zs3);return t=>{const e=n.get(a.z2F);if(t!==e.components[0])return;const r=n.get(jr),i=n.get(gle);1===n.get(O5)&&r.initialNavigation(),n.get(_le,null,a.XFs.Optional)?.setUpPreloading(),n.get(R5,null,a.XFs.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),i.closed||(i.next(),i.unsubscribe())}}const gle=new a.OlP("",{factory:()=>new Xt.x}),O5=new a.OlP("",{providedIn:"root",factory:()=>1});const _le=new a.OlP("");function tPe(n){return ZI(0,[{provide:_le,useExisting:QFe},{provide:hle,useExisting:n}])}const yle=new a.OlP("ROUTER_FORROOT_GUARD"),nPe=[_n,{provide:xae,useClass:c5},{provide:jr,useFactory:ule},O1,{provide:mh,useFactory:function ple(n){return n.routerState.root},deps:[jr]},N5];function rPe(){return new a.PXZ("Router",jr)}let vle=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[nPe,[],M5(e),{provide:yle,useFactory:aPe,deps:[[jr,new a.FiY,new a.tp0]]},{provide:K$,useValue:r||{}},r?.useHash?{provide:ct,useClass:kr}:{provide:ct,useClass:Fn},{provide:R5,useFactory:()=>{const n=(0,a.f3M)(jr),t=(0,a.f3M)(Y_),e=(0,a.f3M)(K$);return e.scrollOffset&&t.setOffset(e.scrollOffset),new fle(n,t,e)}},r?.preloadingStrategy?tPe(r.preloadingStrategy).\u0275providers:[],{provide:a.PXZ,multi:!0,useFactory:rPe},r?.initialNavigation?lPe(r):[],[{provide:ble,useFactory:mle},{provide:a.tb,multi:!0,useExisting:ble}]]}}static forChild(e){return{ngModule:n,providers:[M5(e)]}}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(yle,8))},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[x5]}),n})();function aPe(n){return"guarded"}function lPe(n){return["disabled"===n.initialNavigation?ZI(3,[{provide:a.ip1,multi:!0,useFactory:()=>{const t=(0,a.f3M)(jr);return()=>{t.setUpLocationChangeListener()}}},{provide:O5,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?ZI(2,[{provide:O5,useValue:0},{provide:a.ip1,multi:!0,deps:[a.zs3],useFactory:t=>{const e=t.get(sr,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(s=>{const o=t.get(jr),l=t.get(gle);(function i(s){t.get(jr).events.pipe(cr(l=>l instanceof Bb||l instanceof V$||l instanceof Mae),(0,Ot.U)(l=>l instanceof Bb||l instanceof V$&&(0===l.code||1===l.code)&&null),cr(l=>null!==l),nr(1)).subscribe(()=>{s()})})(()=>{s(!0),r=!0}),o.afterPreactivation=()=>(s(!0),r||l.closed?St(void 0):l),o.initialNavigation()}))}}]).\u0275providers:[]]}const ble=new a.OlP("");function dPe(n,t){1&n&&a._UZ(0,"mat-radio-button",6),2&n&&a.Q6J("value",t.index)}function hPe(n,t){if(1&n&&(a.TgZ(0,"li",7)(1,"div"),a._UZ(2,"div",8)(3,"img",9),a.TgZ(4,"h1"),a._uU(5),a.qZA()()()),2&n){const e=t.$implicit,r=t.index,i=a.oxw();a.ekj("active",r===i.activeImageIndex),a.xp6(3),a.Q6J("src",e.url,a.LSH),a.xp6(2),a.Oqu(e.text)}}let fPe=(()=>{class n{constructor(){this.carouselSections=[{url:"https://images.unsplash.com/photo-1581056771392-8a90ddb76831?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",text:"Improving life quality and bringing smiles to you and your loved ones"},{url:"https://images.unsplash.com/photo-1576091160550-2173dba999ef?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",text:"Integrating technology into medicine for excellence in healthcare"},{url:"https://images.unsplash.com/photo-1598300188480-626f2f79ab8d?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",text:"Fast, reliable medical screening for all of your needs"},{url:"https://images.unsplash.com/photo-1511174511562-5f7f18b874f8?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",text:"Cutting edge research facilites to provide world-class care"}],this.activeImageIndex=0,this.intervalSubscription=new kn.w0}ngOnInit(){this.startInterval()}ngOnDestroy(){this.stopInterval()}startInterval(){const r=function uPe(n=0,t=Fc){return n<0&&(n=0),o$(n,n,t)}(5e3);this.intervalSubscription=r.subscribe(()=>{this.switchToNextImg()})}stopInterval(){this.intervalSubscription&&this.intervalSubscription.unsubscribe()}resetInterval(){this.stopInterval(),this.startInterval()}switchToPrevImg(){0!==this.activeImageIndex?(this.activeImageIndex--,this.resetInterval()):this.activeImageIndex=this.carouselSections.length-1}switchToNextImg(){this.activeImageIndex!==this.carouselSections.length-1?(this.activeImageIndex++,this.resetInterval()):this.activeImageIndex=0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-carousel"]],decls:12,vars:3,consts:[[1,"carousel"],["mat-fab","",1,"carousel-button","prev",3,"click"],["mat-fab","",1,"carousel-button","next",3,"click"],[1,"radio-group",3,"ngModel","ngModelChange","change"],["class","carousel-radio",3,"value",4,"ngFor","ngForOf"],["class","slide",3,"active",4,"ngFor","ngForOf"],[1,"carousel-radio",3,"value"],[1,"slide"],[1,"gradient"],["alt","Medical Image",3,"src"]],template:function(e,r){1&e&&(a.TgZ(0,"section")(1,"div",0)(2,"button",1),a.NdJ("click",function(){return r.switchToPrevImg()}),a.TgZ(3,"mat-icon"),a._uU(4,"arrow_back"),a.qZA()(),a.TgZ(5,"button",2),a.NdJ("click",function(){return r.switchToNextImg()}),a.TgZ(6,"mat-icon"),a._uU(7,"arrow_forward"),a.qZA()(),a.TgZ(8,"mat-radio-group",3),a.NdJ("ngModelChange",function(s){return r.activeImageIndex=s})("change",function(){return r.resetInterval()}),a.YNc(9,dPe,1,1,"mat-radio-button",4),a.qZA(),a.TgZ(10,"ul"),a.YNc(11,hPe,6,4,"li",5),a.qZA()()()),2&e&&(a.xp6(8),a.Q6J("ngModel",r.activeImageIndex),a.xp6(1),a.Q6J("ngForOf",r.carouselSections),a.xp6(2),a.Q6J("ngForOf",r.carouselSections))},dependencies:[Na,js,td,Poe,Loe,Cf,hv],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}.carousel[_ngcontent-%COMP%]{max-width:100%;height:80vh;position:relative}.carousel[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}.slide[_ngcontent-%COMP%]{position:absolute;inset:0;opacity:0;transition:.2s opacity ease-in-out;transition-delay:.2s}.slide.active[_ngcontent-%COMP%]{opacity:1;transition-delay:0ms;z-index:1}.slide[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;height:100%;display:flex;justify-content:center}.slide[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{display:block;width:100%;height:100%;object-fit:cover;object-position:center}.gradient[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;background-image:linear-gradient(transparent 30%,rgba(0,0,0,.8) 80%,rgba(0,0,0,.8));z-index:2}.slide[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{position:absolute;top:70%;height:12%;overflow-y:hidden;color:#fff;z-index:3;padding:0 10%;text-align:center;display:flex;align-items:end}.carousel-button[_ngcontent-%COMP%]{position:absolute;top:50%;z-index:4;transform:translateY(-50%)}.carousel-button.prev[_ngcontent-%COMP%]{left:1rem}.carousel-button.next[_ngcontent-%COMP%]{right:1rem}.radio-group[_ngcontent-%COMP%]{z-index:4;position:absolute;top:90%;display:flex;justify-content:center;width:100%;gap:1.5rem;color:#fff}[_nghost-%COMP%]     .mat-radio-button .mat-radio-outer-circle, .mat-radio-outer-circle[_ngcontent-%COMP%]{border-color:var(--accent)!important}[_nghost-%COMP%]     .mat-radio-button.mat-accent.mat-radio-checked .mat-radio-outer-circle, .mat-radio-outer-circle[_ngcontent-%COMP%]{border-color:var(--accent)!important}"]}),n})(),pPe=(()=>{class n{constructor(e){this.router=e}ngOnInit(){}onContactButtonClick(){this.router.navigate(["contact"])}onAboutButtonClick(){this.router.navigate(["about"])}onMedicsButtonClick(){this.router.navigate(["medics"])}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(jr))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-home"]],decls:18,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-4"],["mat-raised-button","","color","primary",1,"call-to-action",3,"click"],["mat-raised-button","","color","accent",1,"call-to-action",3,"click"]],template:function(e,r){1&e&&(a._UZ(0,"app-carousel"),a.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"button",3),a.NdJ("click",function(){return r.onContactButtonClick()}),a._uU(5," Contact us "),a.TgZ(6,"mat-icon"),a._uU(7,"contact_support"),a.qZA()()(),a.TgZ(8,"div",2)(9,"button",4),a.NdJ("click",function(){return r.onMedicsButtonClick()}),a.TgZ(10,"mat-icon"),a._uU(11,"medical_information"),a.qZA(),a._uU(12," Check our medics "),a.qZA()(),a.TgZ(13,"div",2)(14,"button",3),a.NdJ("click",function(){return r.onAboutButtonClick()}),a._uU(15," About our clinic "),a.TgZ(16,"mat-icon"),a._uU(17,"info"),a.qZA()()()()())},dependencies:[js,td,fPe],styles:[".call-to-action[_ngcontent-%COMP%]{width:100%;padding:16px;font-size:32px;margin:2rem}"]}),n})(),U1=(()=>{class n{constructor(e,r){this.firestore=e,this.storage=r}getAllMedics(){return this.firestore.collection("medics").snapshotChanges().pipe((0,Ot.U)(e=>e.map(r=>{const i=r.payload.doc.data();return{id:r.payload.doc.id,...i}})))}getVisibleMedics(){return this.firestore.collection("medics",e=>e.where("isVisible","==",!0)).snapshotChanges().pipe((0,Ot.U)(e=>e.map(r=>{const i=r.payload.doc.data();return{id:r.payload.doc.id,...i}})))}getMedicById(e){return this.firestore.collection("medics").doc(e).valueChanges()}getMedicsById(e){return DI(e.map(i=>this.firestore.collection("medics").doc(i).snapshotChanges().pipe((0,Ot.U)(s=>{const o=s.payload.data();return{id:s.payload.id,...o}}))))}getMedicByUserId(e){return this.firestore.collection("medics",r=>r.where("userId","==",e)).snapshotChanges().pipe((0,Ot.U)(r=>{if(r.length>0){const i=r[0].payload.doc.data();return i.id=r[0].payload.doc.id,i}return null}),ts(r=>{throw r}))}addMedic(e){const r=this.firestore.collection("medics");return(0,Dn.D)(r.add(e))}editMedicByUserId(e,r){return this.firestore.collection("medics",i=>i.where("userId","==",e)).snapshotChanges().pipe(nr(1),wn(i=>{const s=i[0]?.payload.doc.id;if(!s)return yo(()=>new Error("No matching document found for the provided userId"));const o=this.firestore.collection("medics").doc(s);return(0,Dn.D)(o.update(r))}),ts(i=>(console.error("Error updating medic:",i),yo(()=>i))))}updateMedicVisibility(e,r){return this.firestore.collection("medics",i=>i.where("userId","==",e)).snapshotChanges().pipe(nr(1),wn(i=>{const s=i[0]?.payload.doc.id;if(!s)return yo(()=>new Error("No matching document found for the provided userId"));const o=this.firestore.collection("medics").doc(s);return(0,Dn.D)(o.update({isVisible:r}))}),ts(i=>(console.error("Error updating medic field:",i),yo(()=>i))))}getDefaulImgUrl(){return this.storage.ref("medic-images/default-medic-img.avif").getDownloadURL()}uploadImage(e,r,i){const s=this.storage.ref(`${i}/${e}/${(new Date).getTime()}${r.name}`),o=s.put(r);return(0,Dn.D)(o).pipe(wn(()=>s.getDownloadURL().pipe(ts(l=>(console.error("Error getting download URL:",l),yo(()=>l))))),ts(l=>yo(()=>l)))}setMedicImageUrl(e,r){return this.firestore.collection("medics",i=>i.where("userId","==",e)).snapshotChanges().pipe(nr(1),wn(i=>{const s=i[0]?.payload.doc.id;if(!s)return yo(()=>new Error("No matching document found for the provided userId"));const o=this.firestore.collection("medics").doc(s);return(0,Dn.D)(o.update({photoUrl:r}))}),ts(i=>(console.error("Error updating medic photo url:",i),yo(()=>i))))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(xI),a.LFG(Jj))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class wle{constructor(t,e,r,i){this.email=t,this.id=e,this._token=r,this._tokenExpirationDate=i}get token(){return!this._tokenExpirationDate||this._tokenExpirationDate<new Date?null:this._token}}let tu=(()=>{class n{constructor(e,r,i){this.http=e,this.firestore=r,this.afAuth=i,this._user=new Zo(null),this.authStateInitialized=!1,this.initAuthListener()}get user(){return this._user.asObservable()}isAuthenticated(){return this.user.pipe((0,Ot.U)(e=>!!e))}initAuthListener(){this.afAuth.authState.subscribe(e=>{e?e.getIdTokenResult().then(r=>{const i=new wle(e.email,e.uid,r.token);this._user.next(i),this.setAutoLogout(new Date(r.expirationTime).getTime()-(new Date).getTime()),this.authStateInitialized=!0}):(this._user.next(null),this.authStateInitialized=!0)})}signup(e,r){return(0,Dn.D)(this.afAuth.createUserWithEmailAndPassword(e,r)).pipe(ts(this.handleError),Qr(i=>{const{email:s,uid:o}=i.user;this.addUserToFirestore(o,{email:s,role:"patient"}).subscribe()}))}addUserToFirestore(e,r){const i=this.firestore.collection("users").doc(e);return(0,Dn.D)(i.set(r)).pipe(ts(s=>{throw console.error("Error adding document:",s),s}),v1(()=>{console.log("Document added successfully!")}))}login(e,r){return(0,Dn.D)(this.afAuth.signInWithEmailAndPassword(e,r)).pipe(ts(this.handleError))}logout(){(0,Dn.D)(this.afAuth.signOut()).subscribe()}setAutoLogout(e){this.clearAutoLogout(),this.tokenExpirationTimer=setTimeout(()=>{this.logout()},e)}clearAutoLogout(){this.tokenExpirationTimer&&(clearTimeout(this.tokenExpirationTimer),this.tokenExpirationTimer=null)}handleAuthentication(e,r,i,s){return(0,q.Z)(function*(){const o=new Date((new Date).getTime()+1e3*s),l=new wle(e,r,i,o);localStorage.setItem("userData",JSON.stringify(l))})()}handleError(e){let r="There was an error, please try again! Error: ";if(!e.error||!e.error.error){const s=new Error(r);return yo(()=>s)}switch(e.error.error.message){case"EMAIL_EXISTS":r+="The email address is already in use by another account.";break;case"INVALID_LOGIN_CREDENTIALS":r+="Invalid login credentials";break;default:r+="Unknown error."}const i=new Error(r);return yo(()=>i)}waitForAuthStateInitialization(){return new Cr.y(e=>{const r=()=>{this.authStateInitialized?(e.next(!0),e.complete()):setTimeout(r,100)};r()})}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(Oc),a.LFG(xI),a.LFG(n2))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Xg=(()=>{class n{constructor(e){this.firestore=e}getUserData(e){return this.firestore.collection("users").doc(e).valueChanges().pipe((0,Ot.U)(i=>i&&this.convertTimestampsToDates(i)))}updateUserData(e,r){const i=this.firestore.collection("users").doc(e);return(0,Dn.D)(i.update(r))}convertTimestampsToDates(e){return e.hasOwnProperty("dateOfBirth")&&(e.dateOfBirth=e.dateOfBirth.toDate()),e}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(xI))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function mPe(n,t){1&n&&(a.TgZ(0,"div",6),a._UZ(1,"mat-progress-bar",7),a.qZA())}function gPe(n,t){if(1&n&&(a.TgZ(0,"div",8)(1,"h1"),a._uU(2,"An Error Occurred!"),a.qZA(),a.TgZ(3,"p"),a._uU(4),a.qZA()()),2&n){const e=a.oxw();a.xp6(4),a.Oqu(e.error)}}function _Pe(n,t){if(1&n){const e=a.EpF();a.ynx(0),a.TgZ(1,"div",9)(2,"div")(3,"button",10),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onMedicPageButtonClick())}),a.TgZ(4,"em"),a._uU(5,"To set up or edit your medic page, go to your profile"),a.qZA()()()(),a.BQk()}}function yPe(n,t){1&n&&(a.TgZ(0,"mat-icon",22),a._uU(1,"star"),a.qZA())}function vPe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"mat-grid-tile")(1,"mat-card",13)(2,"mat-card-title-group",14)(3,"mat-card-title"),a.YNc(4,yPe,2,0,"mat-icon",15),a._uU(5),a.qZA(),a.TgZ(6,"mat-card-subtitle"),a._uU(7),a.qZA(),a._UZ(8,"img",16),a.qZA(),a.TgZ(9,"mat-card-content")(10,"p"),a._uU(11),a.qZA(),a.TgZ(12,"p"),a._uU(13," City: "),a.TgZ(14,"i"),a._uU(15),a.qZA()()(),a.TgZ(16,"mat-card-actions")(17,"button",17),a.NdJ("click",function(){const s=a.CHM(e).$implicit,o=a.oxw(2);return a.KtG(o.onScheduleAppointmentClick(s))}),a._uU(18," Schedule an appointment "),a.qZA(),a.TgZ(19,"button",18),a._uU(20,"Contact"),a.qZA(),a.TgZ(21,"mat-menu",19,20)(23,"button",21),a.NdJ("click",function(){const s=a.CHM(e).$implicit,o=a.oxw(2);return a.KtG(o.onMailClick(s.email))}),a.TgZ(24,"mat-icon"),a._uU(25,"email"),a.qZA(),a.TgZ(26,"span"),a._uU(27),a.qZA()(),a.TgZ(28,"button",21),a.NdJ("click",function(){const s=a.CHM(e).$implicit,o=a.oxw(2);return a.KtG(o.onPhoneClick(s.phoneNumber))}),a.TgZ(29,"mat-icon"),a._uU(30,"phone"),a.qZA(),a.TgZ(31,"span"),a._uU(32),a.qZA()()()()()()}if(2&n){const e=t.$implicit,r=a.MAs(22),i=a.oxw(2);a.xp6(4),a.Q6J("ngIf",e.userId===i.userId),a.xp6(1),a.lnq(" ",e.shortTitle," ",e.firstName," ",e.lastName," "),a.xp6(2),a.Oqu(e.specialty),a.xp6(1),a.Q6J("src",void 0!==e.photoUrl?e.photoUrl:i.defaultPhotoUrl,a.LSH)("alt",e.firstName+e.lastName),a.xp6(3),a.HOy("",e.firstName," ",e.lastName," - ",e.title," specialized in ",e.specialty,""),a.xp6(4),a.Oqu(e.city),a.xp6(4),a.Q6J("matMenuTriggerFor",r),a.xp6(8),a.Oqu(e.email),a.xp6(5),a.hij("+40",e.phoneNumber,"")}}function bPe(n,t){if(1&n&&(a.TgZ(0,"mat-grid-list",11),a.YNc(1,vPe,33,15,"mat-grid-tile",12),a.qZA()),2&n){const e=a.oxw();a.xp6(1),a.Q6J("ngForOf",e.medics)}}let wPe=(()=>{class n{constructor(e,r,i,s){this.medicService=e,this.router=r,this.authService=i,this.userService=s,this.medics=[],this.isFetching=!1,this.defaultPhotoUrl="https://images.unsplash.com/photo-1607368386669-d940ce438fba?q=80&w=1843&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",this.error=null,this.isAuthenticated=!1,this.userId=null,this.userSubs=[]}ngOnInit(){this.isFetching=!0,DI([this.medicService.getVisibleMedics(),this.authService.user]).subscribe({next:([e,r])=>{this.medics=e,this.getUserData(r)},error:e=>{this.error=e.message,console.error(e)}})}getUserData(e){this.isAuthenticated=!!e,this.userId=e?e.id:null,this.userId?this.userService.getUserData(this.userId).subscribe(r=>{this.userData=r,this.isFetching=!1}):this.isFetching=!1}onScheduleAppointmentClick(e){this.isAuthenticated?this.router.navigate(["/appointments"],{queryParams:{city:e.city,specialty:e.specialty,medicId:e.id}}):this.router.navigate(["/authenticate"])}onMedicPageButtonClick(){this.router.navigate(["profile",this.userId])}onMailClick(e){window.open(`mailto:${e}`)}onPhoneClick(e){window.open(`tel:+40${e}`)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(U1),a.Y36(jr),a.Y36(tu),a.Y36(Xg))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-medics"]],decls:8,vars:4,consts:[[1,"container","p-5"],[1,"row","text-center","mb-4"],["class","pt-5 mt-5",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[4,"ngIf"],["cols","3","gutterSize","2rem",4,"ngIf"],[1,"pt-5","mt-5"],["mode","indeterminate"],[1,"alert","alert-danger"],[1,"row","text-center"],["mat-raised-button","","type","button","color","primary",3,"click"],["cols","3","gutterSize","2rem"],[4,"ngFor","ngForOf"],[1,"medic-card"],[1,"mb-2"],["matTooltip","This is you",4,"ngIf"],["mat-card-lg-image","",1,"medic-img",3,"src","alt"],["mat-raised-button","","color","primary",3,"click"],["mat-button","","color","accent",3,"matMenuTriggerFor"],["yPosition","above"],["menu","matMenu"],["mat-menu-item","",3,"click"],["matTooltip","This is you"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0)(1,"div",1)(2,"h1"),a._uU(3,"Our Medics"),a.qZA()(),a.YNc(4,mPe,2,0,"div",2),a.YNc(5,gPe,5,1,"div",3),a.YNc(6,_Pe,6,0,"ng-container",4),a.YNc(7,bPe,2,1,"mat-grid-list",5),a.qZA()),2&e&&(a.xp6(4),a.Q6J("ngIf",r.isFetching&&!r.error),a.xp6(1),a.Q6J("ngIf",r.error),a.xp6(1),a.Q6J("ngIf",!r.isFetching&&!r.error&&r.isAuthenticated&&"medic"===(null==r.userData?null:r.userData.role)),a.xp6(1),a.Q6J("ngIf",!r.isFetching&&!r.error))},dependencies:[Na,Ur,js,UDe,zDe,PDe,LDe,$De,BDe,VDe,j1e,goe,td,Doe,w1,Noe,w$,S1],styles:[".medic-card[_ngcontent-%COMP%]{background-color:var(--secondary);border-radius:8px;padding:1.2rem}.medic-img[_ngcontent-%COMP%]{aspect-ratio:1;object-fit:cover}"]}),n})();function CPe(n,t){1&n&&a._UZ(0,"mat-spinner")}function xPe(n,t){if(1&n&&(a.TgZ(0,"div",6)(1,"p"),a._uU(2),a.qZA()()),2&n){const e=a.oxw();a.xp6(2),a.Oqu(e.error)}}function IPe(n,t){1&n&&(a.TgZ(0,"mat-hint"),a._uU(1,"Email is valid!"),a.qZA())}function TPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please enter a vaild email address "),a.qZA())}function SPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Email is "),a.TgZ(2,"strong"),a._uU(3,"required"),a.qZA()())}function EPe(n,t){1&n&&(a.TgZ(0,"mat-hint"),a._uU(1,"Password is valid!"),a.qZA())}function DPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Password must be at least "),a.TgZ(2,"strong"),a._uU(3,"8 characters"),a.qZA(),a._uU(4," long "),a.qZA())}function kPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Password is "),a.TgZ(2,"strong"),a._uU(3,"required"),a.qZA()())}function APe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Password must include at least "),a.TgZ(2,"strong"),a._uU(3,"one letter"),a.qZA(),a._uU(4," and "),a.TgZ(5,"strong"),a._uU(6,"one number"),a.qZA()())}function NPe(n,t){1&n&&(a.TgZ(0,"mat-hint"),a._uU(1,"Passwords match!"),a.qZA())}function RPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1,"Please repeat the password"),a.qZA())}function MPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1,"The passwords must "),a.TgZ(2,"strong"),a._uU(3,"match"),a.qZA()())}function OPe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"mat-form-field",8)(1,"mat-label"),a._uU(2,"Repeat Password"),a.qZA(),a._UZ(3,"input",15),a.TgZ(4,"button",11),a.NdJ("click",function(){a.CHM(e);const i=a.oxw(2);return a.KtG(i.hideRepeatPass=!i.hideRepeatPass)}),a.TgZ(5,"mat-icon"),a._uU(6),a.qZA()(),a.YNc(7,NPe,2,0,"mat-hint",3),a.YNc(8,RPe,2,0,"mat-error",3),a.YNc(9,MPe,4,0,"mat-error",3),a.qZA()}if(2&n){const e=a.oxw(2);let r,i,s;a.xp6(3),a.Q6J("type",e.hideRepeatPass?"password":"text")("errorStateMatcher",e.matcher),a.xp6(3),a.Oqu(e.hideRepeatPass?"visibility_off":"visibility"),a.xp6(1),a.Q6J("ngIf",null==(r=e.authForm.get("repeatPass"))?null:r.valid),a.xp6(1),a.Q6J("ngIf",null==(i=e.authForm.get("repeatPass"))?null:i.hasError("required")),a.xp6(1),a.Q6J("ngIf",null==(s=e.authForm.get("repeatPass"))?null:s.hasError("mismatch"))}}function FPe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"form",7),a.NdJ("ngSubmit",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onSubmit())})("keydown.enter",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onEnterPressed(i))}),a.TgZ(1,"h2"),a._uU(2),a.qZA(),a.TgZ(3,"mat-form-field",8)(4,"mat-label"),a._uU(5,"Email"),a.qZA(),a._UZ(6,"input",9),a.YNc(7,IPe,2,0,"mat-hint",3),a.YNc(8,TPe,2,0,"mat-error",3),a.YNc(9,SPe,4,0,"mat-error",3),a.qZA(),a.TgZ(10,"mat-form-field",8)(11,"mat-label"),a._uU(12,"Password"),a.qZA(),a.TgZ(13,"input",10),a.NdJ("input",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.updatePasswordsValidators())}),a.qZA(),a.TgZ(14,"button",11),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.hidePass=!i.hidePass)}),a.TgZ(15,"mat-icon"),a._uU(16),a.qZA()(),a.YNc(17,EPe,2,0,"mat-hint",3),a.YNc(18,DPe,5,0,"mat-error",3),a.YNc(19,kPe,4,0,"mat-error",3),a.YNc(20,APe,7,0,"mat-error",3),a.qZA(),a.YNc(21,OPe,10,6,"mat-form-field",12),a.TgZ(22,"button",13),a._uU(23),a.qZA(),a.TgZ(24,"a",14),a.NdJ("click",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.toggleLoginMode(i))}),a._uU(25),a.qZA()()}if(2&n){const e=a.oxw();let r,i,s,o,l,c,u;a.Q6J("formGroup",e.authForm),a.xp6(2),a.Oqu(e.isLoginMode?"Log In":"Register a new account"),a.xp6(4),a.Q6J("errorStateMatcher",e.matcher),a.xp6(1),a.Q6J("ngIf",null==(r=e.authForm.get("email"))?null:r.valid),a.xp6(1),a.Q6J("ngIf",(null==(i=e.authForm.get("email"))?null:i.hasError("email"))&&!(null!=(i=e.authForm.get("email"))&&i.hasError("required"))),a.xp6(1),a.Q6J("ngIf",null==(s=e.authForm.get("email"))?null:s.hasError("required")),a.xp6(4),a.Q6J("type",e.hidePass?"password":"text")("errorStateMatcher",e.matcher),a.xp6(3),a.Oqu(e.hidePass?"visibility_off":"visibility"),a.xp6(1),a.Q6J("ngIf",null==(o=e.authForm.get("password"))?null:o.valid),a.xp6(1),a.Q6J("ngIf",null==(l=e.authForm.get("password"))?null:l.hasError("minlength")),a.xp6(1),a.Q6J("ngIf",null==(c=e.authForm.get("password"))?null:c.hasError("required")),a.xp6(1),a.Q6J("ngIf",null==(u=e.authForm.get("password"))?null:u.hasError("pattern")),a.xp6(1),a.Q6J("ngIf",!e.isLoginMode),a.xp6(1),a.Q6J("disabled",e.authForm.invalid),a.xp6(1),a.hij(" ",e.isLoginMode?"Log in":"Sign up"," "),a.xp6(2),a.Oqu(e.isLoginMode?"Create your account":"Back to log in")}}class Cle{isErrorState(t,e){return!!(t&&t.invalid&&(t.dirty||t.touched||e&&e.submitted))}}let PPe=(()=>{class n{constructor(e,r,i){this.fb=e,this.authService=r,this.router=i,this.matcher=new Cle,this.hidePass=!0,this.hideRepeatPass=!0,this.isLoginMode=!0,this.isLoading=!1,this.error="",this.authForm=this.fb.group({email:["",[cn.required,cn.email]],password:["",[cn.required,cn.minLength(8),cn.pattern(/^(?=.*[a-zA-Z])(?=.*\d).+$/)]],repeatPass:["",this.isLoginMode?[]:[cn.required,this.matchPasswordValidator()]]})}ngOnInit(){}toggleLoginMode(e){e.preventDefault(),this.isLoginMode=!this.isLoginMode,this.authForm=this.fb.group({email:["",[cn.required,cn.email]],password:["",[cn.required,cn.minLength(8),cn.pattern(/^(?=.*[a-zA-Z])(?=.*\d).+$/)]],repeatPass:["",this.isLoginMode?[]:[cn.required,this.matchPasswordValidator()]]})}onSubmit(){if(this.authForm.valid){this.isLoading=!0;const e=this.authForm.get("email")?.value,r=this.authForm.get("password")?.value;let i;i=this.isLoginMode?this.login(e,r):this.signup(e,r),i.subscribe({next:()=>{this.isLoading=!1,this.router.navigate([""])},error:s=>{this.error=s,this.isLoading=!1,this.authForm.reset()}})}}login(e,r){return this.authService.login(e,r)}signup(e,r){return this.authService.signup(e,r)}onEnterPressed(e){e.preventDefault(),this.onSubmit()}matchPasswordValidator(){return e=>{const r=this.authForm.get("password")?.value,i=e.value;return i?r===i?null:{mismatch:!0}:null}}updatePasswordsValidators(){this.isLoginMode||this.authForm.get("repeatPass")?.updateValueAndValidity()}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(Nf),a.Y36(tu),a.Y36(jr))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-auth"]],decls:6,vars:3,consts:[[1,"container","p-5"],[1,"row"],[1,"col-12","d-flex","justify-content-center"],[4,"ngIf"],["class","alert alert-danger col-12 col-md-6 offset-md-3",4,"ngIf"],["class","login-container col-12 col-md-6 offset-md-3 p-4 text-center",3,"formGroup","ngSubmit","keydown.enter",4,"ngIf"],[1,"alert","alert-danger","col-12","col-md-6","offset-md-3"],[1,"login-container","col-12","col-md-6","offset-md-3","p-4","text-center",3,"formGroup","ngSubmit","keydown.enter"],["appearance","fill"],["type","email","matInput","","formControlName","email","placeholder","Ex. mike@example.com",3,"errorStateMatcher"],["matInput","","formControlName","password",3,"type","errorStateMatcher","input"],["mat-icon-button","","matSuffix","",3,"click"],["appearance","fill",4,"ngIf"],["type","submit","mat-raised-button","","color","primary",1,"mt-3","mb-3",3,"disabled"],["href","",3,"click"],["matInput","","formControlName","repeatPass",3,"type","errorStateMatcher"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0)(1,"div",1)(2,"div",2),a.YNc(3,CPe,1,0,"mat-spinner",3),a.qZA(),a.YNc(4,xPe,3,1,"div",4),a.YNc(5,FPe,26,17,"form",5),a.qZA()()),2&e&&(a.xp6(3),a.Q6J("ngIf",r.isLoading),a.xp6(1),a.Q6J("ngIf",r.error&&!r.isLoading),a.xp6(1),a.Q6J("ngIf",!r.isLoading))},dependencies:[Ur,js,d1,h1,u$,Mb,wq,td,f1,Jc,Mm,bf,Cf,av,Jl,Fm],styles:[".login-container[_ngcontent-%COMP%]{border:1px solid var(--secondary);display:flex;flex-direction:column;border-radius:1rem}"]}),n})();function LPe(n,t){1&n&&(a.TgZ(0,"div",2),a._UZ(1,"mat-spinner"),a.qZA())}function $Pe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"button",34),a.NdJ("click",function(){a.CHM(e);const i=a.oxw(2);return a.KtG(i.onMedicPageButtonClick())}),a.TgZ(1,"em"),a._uU(2,"Click here to set up your medic page"),a.qZA()()}if(2&n){const e=a.oxw(2);a.Q6J("disabled",!e.isProfileFilled)("matTooltipDisabled",e.isProfileFilled)}}function BPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input your name "),a.qZA())}function VPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input your name "),a.qZA())}function UPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please select your sex "),a.qZA())}function zPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Date of Birth is required "),a.qZA())}function HPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input your nationality "),a.qZA())}function GPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Street is required. "),a.qZA())}function WPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Country is required. "),a.qZA())}function jPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," State is required. "),a.qZA())}function qPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," City is required. "),a.qZA())}function ZPe(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Postal Code is required. "),a.qZA())}function YPe(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"form",3),a.NdJ("ngSubmit",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onSubmit())}),a.TgZ(1,"div",4)(2,"h2"),a._uU(3,"Edit your Information"),a.qZA()(),a.YNc(4,$Pe,3,2,"button",5),a.TgZ(5,"div",4)(6,"mat-form-field",6)(7,"mat-label"),a._uU(8,"Email"),a.qZA(),a._UZ(9,"input",7),a.qZA()(),a.TgZ(10,"div",4)(11,"mat-form-field",8)(12,"mat-label"),a._uU(13,"First Name"),a.qZA(),a._UZ(14,"input",9),a.YNc(15,BPe,2,0,"mat-error",10),a.qZA(),a.TgZ(16,"mat-form-field",8)(17,"mat-label"),a._uU(18,"Last Name"),a.qZA(),a._UZ(19,"input",11),a.YNc(20,VPe,2,0,"mat-error",10),a.qZA()(),a.TgZ(21,"div",4)(22,"mat-form-field",12)(23,"mat-label"),a._uU(24,"Sex"),a.qZA(),a.TgZ(25,"mat-select",13)(26,"mat-option",14),a._uU(27,"Male"),a.qZA(),a.TgZ(28,"mat-option",15),a._uU(29,"Female"),a.qZA()(),a.YNc(30,UPe,2,0,"mat-error",10),a.qZA(),a.TgZ(31,"mat-form-field",12)(32,"mat-label"),a._uU(33,"Date of Birth"),a.qZA(),a._UZ(34,"input",16),a.TgZ(35,"mat-hint"),a._uU(36,"DD/MM/YYYY"),a.qZA(),a._UZ(37,"mat-datepicker-toggle",17)(38,"mat-datepicker",18,19),a.YNc(40,zPe,2,0,"mat-error",10),a.qZA(),a.TgZ(41,"mat-form-field",20)(42,"mat-label"),a._uU(43,"Nationality"),a.qZA(),a._UZ(44,"input",21),a.YNc(45,HPe,2,0,"mat-error",10),a.qZA()(),a.TgZ(46,"div",22)(47,"div",4)(48,"mat-form-field",23)(49,"mat-label"),a._uU(50,"Street"),a.qZA(),a._UZ(51,"input",24),a.YNc(52,GPe,2,0,"mat-error",10),a.qZA(),a.TgZ(53,"mat-form-field",20)(54,"mat-label"),a._uU(55,"Country"),a.qZA(),a._UZ(56,"input",25),a.YNc(57,WPe,2,0,"mat-error",10),a.qZA()(),a.TgZ(58,"div",4)(59,"mat-form-field",12)(60,"mat-label"),a._uU(61,"State"),a.qZA(),a._UZ(62,"input",26),a.YNc(63,jPe,2,0,"mat-error",10),a.qZA(),a.TgZ(64,"mat-form-field",12)(65,"mat-label"),a._uU(66,"City"),a.qZA(),a._UZ(67,"input",27),a.YNc(68,qPe,2,0,"mat-error",10),a.qZA(),a.TgZ(69,"mat-form-field",20)(70,"mat-label"),a._uU(71,"Postal Code"),a.qZA(),a._UZ(72,"input",28,29),a.TgZ(74,"mat-hint",30),a._uU(75),a.qZA(),a.YNc(76,ZPe,2,0,"mat-error",10),a.qZA()()(),a.TgZ(77,"div",31)(78,"div",32)(79,"button",33),a._uU(80," Update "),a.qZA()()()()}if(2&n){const e=a.MAs(39),r=a.MAs(73),i=a.oxw();let s,o,l,c,u,f,m,_,y,w;a.Q6J("formGroup",i.profileForm),a.xp6(4),a.Q6J("ngIf",i.isMedicUser),a.xp6(11),a.Q6J("ngIf",(null==(s=i.profileForm.get("firstName"))?null:s.hasError("required"))&&(null==(s=i.profileForm.get("firstName"))?null:s.touched)),a.xp6(5),a.Q6J("ngIf",(null==(o=i.profileForm.get("lastName"))?null:o.hasError("required"))&&(null==(o=i.profileForm.get("lastName"))?null:o.touched)),a.xp6(10),a.Q6J("ngIf",(null==(l=i.profileForm.get("sex"))?null:l.hasError("required"))&&(null==(l=i.profileForm.get("lastName"))?null:l.touched)),a.xp6(4),a.Q6J("min",i.minDate)("max",i.maxDate)("matDatepicker",e),a.xp6(3),a.Q6J("for",e),a.xp6(3),a.Q6J("ngIf",(null==(c=i.profileForm.get("dateOfBirth"))?null:c.hasError("required"))&&(null==(c=i.profileForm.get("dateOfBirth"))?null:c.touched)),a.xp6(5),a.Q6J("ngIf",(null==(u=i.profileForm.get("nationality"))?null:u.hasError("required"))&&(null==(u=i.profileForm.get("nationality"))?null:u.touched)),a.xp6(7),a.Q6J("ngIf",(null==(f=i.profileForm.get("address.street"))?null:f.hasError("required"))&&(null==(f=i.profileForm.get("address.street"))?null:f.touched)),a.xp6(5),a.Q6J("ngIf",(null==(m=i.profileForm.get("address.country"))?null:m.hasError("required"))&&(null==(m=i.profileForm.get("address.country"))?null:m.touched)),a.xp6(6),a.Q6J("ngIf",(null==(_=i.profileForm.get("address.state"))?null:_.hasError("required"))&&(null==(_=i.profileForm.get("address.state"))?null:_.touched)),a.xp6(5),a.Q6J("ngIf",(null==(y=i.profileForm.get("address.city"))?null:y.hasError("required"))&&(null==(y=i.profileForm.get("address.city"))?null:y.touched)),a.xp6(7),a.hij("",r.value.length||0,"/6"),a.xp6(1),a.Q6J("ngIf",(null==(w=i.profileForm.get("address.postalCode"))?null:w.hasError("required"))&&(null==(w=i.profileForm.get("address.postalCode"))?null:w.touched)),a.xp6(3),a.Q6J("disabled",i.profileForm.invalid||!i.isFormChanged)}}let KPe=(()=>{class n{constructor(e,r,i,s,o){this.route=e,this.formBuilder=r,this.userService=i,this._snackBar=s,this.router=o,this.matcher=new Cle,this.isLoading=!1,this.isFormChanged=!1,this.isMedicUser=!1,this.isProfileFilled=!1,this.userId=this.route.snapshot.paramMap.get("userId")||"",this.minDate=new Date(1900,0,1),this.maxDate=new Date}ngOnInit(){this.isLoading=!0,this.userService.getUserData(this.userId).subscribe(e=>{this.createUserForm(e),this.subscribeToFormChanges(),this.isMedicUser="medic"===e.role,e.firstName&&(this.isProfileFilled=!0),this.isLoading=!1})}createUserForm(e){this.profileForm=this.formBuilder.group({email:[{value:e?.email,disabled:!0}],firstName:[e?.firstName||"",[cn.required]],lastName:[e?.lastName||"",[cn.required]],sex:[e?.sex||"",[cn.required]],dateOfBirth:[e?.dateOfBirth||"",[cn.required]],nationality:[e?.nationality||"",[cn.required]],address:this.formBuilder.group({street:[e?.address?.street||"",[cn.required]],country:[e?.address?.country||"",[cn.required]],state:[e?.address?.state||"",[cn.required]],city:[e?.address?.city||"",[cn.required]],postalCode:[e?.address?.postalCode||"",[cn.required,cn.minLength(6)]]})}),this.initialFormValue=this.profileForm.value}subscribeToFormChanges(){this.profileForm.valueChanges.subscribe(e=>{this.isFormChanged=!this.isEqual(e,this.initialFormValue)})}isEqual(e,r){return JSON.stringify(e)===JSON.stringify(r)}openSnackBar(e){this._snackBar.open(e,void 0,{duration:5e3})}onSubmit(){this.profileForm.valid&&this.userService.updateUserData(this.userId,this.profileForm.value).subscribe({next:()=>{this.openSnackBar("Successfully updated personal information."),this.isProfileFilled=!0},error:r=>{this.openSnackBar(`An error occured ${r}`)}})}onMedicPageButtonClick(){this.router.navigate(["medic-page",this.userId])}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(mh),a.Y36(Nf),a.Y36(Xg),a.Y36(I$),a.Y36(jr))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-user-profile"]],decls:2,vars:2,consts:[["class","d-flex justify-content-center mt-5",4,"ngIf"],["class","col-12 col-md-6 offset-md-3 p-4 text-center",3,"formGroup","ngSubmit",4,"ngIf"],[1,"d-flex","justify-content-center","mt-5"],[1,"col-12","col-md-6","offset-md-3","p-4","text-center",3,"formGroup","ngSubmit"],[1,"row"],["class","mb-2","mat-stroked-button","","type","button","matTooltip","Please fill out your profile information before setting up your medic page",3,"disabled","matTooltipDisabled","click",4,"ngIf"],["appearance","outline"],["matInput","","formControlName","email"],["appearance","outline",1,"col-md-6","col-12"],["matInput","","type","text","formControlName","firstName"],[4,"ngIf"],["matInput","","type","text","formControlName","lastName"],["appearance","outline",1,"col-md-4","col-sm-6","col-12"],["formControlName","sex"],["value","male"],["value","female"],["matInput","","formControlName","dateOfBirth",3,"min","max","matDatepicker"],["matSuffix","",3,"for"],["startView","multi-year"],["picker",""],["appearance","outline",1,"col-md-4","col-12"],["matInput","","type","text","formControlName","nationality"],["formGroupName","address"],["appearance","outline",1,"col-md-8","col-12"],["matInput","","type","text","formControlName","street"],["matInput","","type","text","formControlName","country"],["matInput","","type","text","formControlName","state"],["matInput","","type","text","formControlName","city"],["matInput","","type","text","formControlName","postalCode","maxlength","6"],["postalCode",""],["align","end"],[1,"row","mt-3"],[1,"col-lg-6","offset-lg-3","col-md-8","offset-md-2","col-sm-10","offset-sm-1","col-12"],["type","submit","mat-raised-button","","color","primary",1,"p-1","w-100",3,"disabled"],["mat-stroked-button","","type","button","matTooltip","Please fill out your profile information before setting up your medic page",1,"mb-2",3,"disabled","matTooltipDisabled","click"]],template:function(e,r){1&e&&(a.YNc(0,LPe,2,0,"div",0),a.YNc(1,YPe,81,18,"form",1)),2&e&&(a.Q6J("ngIf",r.isLoading),a.xp6(1),a.Q6J("ngIf",!r.isLoading))},dependencies:[Ur,js,kq,g1,eoe,d1,h1,u$,Mb,wq,f1,Jc,Hq,r$,S1,Mm,bf,Cf,av,Pm,Jl,Fm,kf]}),n})(),QPe=(()=>{class n{constructor(e,r){this.authService=e,this.router=r}canActivate(e,r){return this.authService.waitForAuthStateInitialization().pipe(wn(()=>this.authService.user.pipe(nr(1),wn(i=>{if(i){const s=i.id;return St(s===e.paramMap.get("userId")||this.router.createUrlTree(["profile",s]))}return St(this.router.createUrlTree(["/not-authorized"]))}))))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(tu),a.LFG(jr))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),XPe=(()=>{class n{constructor(e,r){this.authService=e,this.router=r}canActivate(e,r){return this.authService.waitForAuthStateInitialization().pipe(wn(()=>this.authService.isAuthenticated()),nr(1),wn(i=>St(!i||this.router.createUrlTree(["/"]))))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(tu),a.LFG(jr))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),tB=(()=>{class n{constructor(e,r){this.firestore=e,this.storage=r,this.addAppointmentSubject=new Xt.x,this.addAppointment$=this.addAppointmentSubject.asObservable()}getDistinctCities(){return this.firestore.collection("medics",e=>e.where("isVisible","==",!0)).get().pipe((0,Ot.U)(e=>{const r=[];return e.forEach(i=>{const s=i.data().city;r.includes(s)||r.push(s)}),r}))}getSpecialtiesForCity(e){return this.firestore.collection("medics",r=>r.where("isVisible","==",!0).where("city","==",e)).get().pipe((0,Ot.U)(r=>{const i=[];return r.forEach(s=>{const o=s.data().specialty;i.includes(o)||i.push(o)}),i}))}getMedicsForCityAndSpecialty(e,r){return this.firestore.collection("medics",i=>i.where("isVisible","==",!0).where("city","==",e).where("specialty","==",r)).valueChanges({idField:"id"})}getMedicAppointments(e){return this.firestore.collection("appointments",r=>r.where("medicId","==",e.id))}getMedicAppointmentBookedTimes(e,r){const i=Gr.fromDate(new Date(r.getFullYear(),r.getMonth(),r.getDate())),s=Gr.fromDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+1));return this.firestore.collection("appointments",o=>o.where("medicId","==",e).where("datetime",">=",i).where("datetime","<",s)).get().pipe((0,Ot.U)(o=>{const l=new Set;return o.forEach(c=>{const m=c.data().datetime.toDate();m.setSeconds(0),m.setMilliseconds(0),l.add(m)}),l}))}getMedicWeekAppointments(e,r,i){const s=Gr.fromDate(new Date(r.getFullYear(),r.getMonth(),r.getDate())),o=Gr.fromDate(new Date(i.getFullYear(),i.getMonth(),i.getDate()+1));return this.firestore.collection("appointments",l=>l.where("medicId","==",e).where("datetime",">=",s).where("datetime","<",o)).get().pipe((0,Ot.U)(l=>{const c=[];return l.forEach(u=>{const f=u.data(),m={...f,datetime:f.datetime.toDate()};c.push(m)}),c}))}addApointment(e){const r={...e,datetime:Gr.fromDate(e.datetime)},i=this.firestore.collection("appointments");return(0,Dn.D)(i.add(r)).pipe(Qr(()=>this.addAppointmentSubject.next()))}getAppointmentsByUserId(e){return this.firestore.collection("appointments",r=>r.where("userId","==",e).orderBy("datetime")).get().pipe((0,Ot.U)(r=>{const i=[];return r.forEach(s=>{const o=s.data(),l={...o,datetime:o.datetime.toDate()};i.push(l)}),i}))}uploadImage(e,r){const i=this.storage.ref(`${r}/${(new Date).getTime()}${e.name}`),s=i.put(e);return(0,Dn.D)(s).pipe(wn(()=>i.getDownloadURL().pipe(ts(o=>(console.error("Error getting download URL:",o),yo(()=>o))))),ts(o=>yo(()=>o)))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(xI),a.LFG(Jj))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function JPe(n,t){1&n&&(a.TgZ(0,"mat-option",46),a._uU(1,"No cities available"),a.qZA())}function e2e(n,t){1&n&&a.YNc(0,JPe,2,0,"ng-template")}function t2e(n,t){if(1&n&&(a.TgZ(0,"mat-option",47),a._uU(1),a.qZA()),2&n){const e=t.$implicit;a.Q6J("value",e),a.xp6(1),a.Oqu(e)}}function n2e(n,t){if(1&n&&(a.YNc(0,t2e,2,2,"mat-option",11),a.ALo(1,"async")),2&n){const e=a.oxw(2);a.Q6J("ngForOf",a.lcZ(1,1,e.cities$))}}function r2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function i2e(n,t){if(1&n&&(a.TgZ(0,"mat-option",47),a._uU(1),a.qZA()),2&n){const e=t.$implicit;a.Q6J("value",e),a.xp6(1),a.Oqu(e)}}function s2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function o2e(n,t){if(1&n&&(a.TgZ(0,"mat-option",47),a._uU(1),a.qZA()),2&n){const e=t.$implicit;a.Q6J("value",e.id),a.xp6(1),a.lnq("",e.shortTitle," ",e.lastName," ",e.firstName,"")}}function a2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function l2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function c2e(n,t){if(1&n&&(a.TgZ(0,"mat-option",48),a._uU(1),a.ALo(2,"date"),a.qZA()),2&n){const e=t.$implicit;a.Q6J("value",e.time)("disabled",e.disabled),a.xp6(1),a.hij(" ",a.xi3(2,3,e.time,"HH:mm")," ")}}function u2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function d2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function h2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function f2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function p2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input a valid email "),a.qZA())}function m2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function g2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function _2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function y2e(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input a valid phone number "),a.qZA())}function v2e(n,t){if(1&n&&(a.TgZ(0,"div",49),a._UZ(1,"img",50),a.qZA()),2&n){const e=a.oxw(2);a.xp6(1),a.Q6J("src",e.imageUrl,a.LSH)}}function b2e(n,t){1&n&&(a.ynx(0),a._UZ(1,"mat-spinner",51),a.BQk())}function w2e(n,t){1&n&&(a.TgZ(0,"span"),a._uU(1,"Submit"),a.qZA())}function C2e(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"form",1),a.NdJ("ngSubmit",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onSubmit())}),a.TgZ(1,"div",2)(2,"h2",3),a._uU(3,"Make a new appointment"),a.qZA(),a.TgZ(4,"h6",4),a._uU(5,"Complete the following form to create your appointment today!"),a.qZA()(),a.TgZ(6,"div",2)(7,"mat-form-field",5)(8,"mat-label"),a._uU(9,"City"),a.qZA(),a.TgZ(10,"mat-select",6),a.NdJ("selectionChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onCityChange(i))}),a.YNc(11,e2e,1,0,null,7),a.ALo(12,"async"),a.YNc(13,n2e,2,3,"ng-template",null,8,a.W1O),a.qZA(),a.YNc(15,r2e,2,0,"mat-error",9),a.qZA(),a.TgZ(16,"mat-form-field",5)(17,"mat-label"),a._uU(18,"Specialty"),a.qZA(),a.TgZ(19,"mat-select",10),a.NdJ("selectionChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onSpecialtyChange(i))}),a.ALo(20,"async"),a.YNc(21,i2e,2,2,"mat-option",11),a.ALo(22,"async"),a.qZA(),a.YNc(23,s2e,2,0,"mat-error",9),a.qZA()(),a._UZ(24,"div",2),a.TgZ(25,"div",2)(26,"mat-form-field",12)(27,"mat-label"),a._uU(28,"Medic"),a.qZA(),a.TgZ(29,"mat-select",13),a.NdJ("selectionChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onMedicChange(i))}),a.ALo(30,"async"),a.YNc(31,o2e,2,4,"mat-option",11),a.ALo(32,"async"),a.qZA(),a.YNc(33,a2e,2,0,"mat-error",9),a.qZA()(),a.TgZ(34,"div",14)(35,"mat-form-field",5)(36,"mat-label"),a._uU(37,"Date"),a.qZA(),a.TgZ(38,"input",15),a.NdJ("dateChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onDateChange(i))})("ngModelChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.fromDate=i)}),a.qZA(),a._UZ(39,"mat-datepicker-toggle",16)(40,"mat-datepicker",null,17),a.YNc(42,l2e,2,0,"mat-error",9),a.qZA(),a.TgZ(43,"mat-form-field",5)(44,"mat-label"),a._uU(45,"Time Slot"),a.qZA(),a.TgZ(46,"mat-select",18),a.ALo(47,"async"),a.YNc(48,c2e,3,6,"mat-option",19),a.ALo(49,"async"),a.qZA(),a.YNc(50,u2e,2,0,"mat-error",9),a.qZA()(),a._UZ(51,"mat-divider"),a.TgZ(52,"div",20)(53,"div",21)(54,"button",22),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onAutofillClick())}),a._uU(55," Autofill information "),a.qZA()()(),a.TgZ(56,"div",2)(57,"mat-form-field",5)(58,"mat-label"),a._uU(59,"First Name"),a.qZA(),a._UZ(60,"input",23),a.YNc(61,d2e,2,0,"mat-error",9),a.qZA(),a.TgZ(62,"mat-form-field",5)(63,"mat-label"),a._uU(64,"Last Name"),a.qZA(),a._UZ(65,"input",24),a.YNc(66,h2e,2,0,"mat-error",9),a.qZA()(),a.TgZ(67,"div",2)(68,"mat-form-field",12)(69,"mat-label"),a._uU(70,"Email"),a.qZA(),a._UZ(71,"input",25),a.YNc(72,f2e,2,0,"mat-error",9),a.YNc(73,p2e,2,0,"mat-error",9),a.qZA()(),a.TgZ(74,"div",2)(75,"mat-form-field",26)(76,"mat-label"),a._uU(77,"Sex"),a.qZA(),a.TgZ(78,"mat-select",27)(79,"mat-option",28),a._uU(80,"Male "),a.qZA(),a.TgZ(81,"mat-option",29),a._uU(82,"Female "),a.qZA(),a.TgZ(83,"mat-option",30),a._uU(84,"Other "),a.qZA()(),a.YNc(85,m2e,2,0,"mat-error",9),a.qZA(),a.TgZ(86,"mat-form-field",26)(87,"mat-label"),a._uU(88,"Age"),a.qZA(),a._UZ(89,"input",31),a.YNc(90,g2e,2,0,"mat-error",9),a.qZA(),a.TgZ(91,"mat-form-field",26)(92,"mat-label"),a._uU(93,"Phone Number"),a.qZA(),a.TgZ(94,"span",32),a._uU(95,"+40 \xa0"),a.qZA(),a._UZ(96,"input",33),a.YNc(97,_2e,2,0,"mat-error",9),a.YNc(98,y2e,2,0,"mat-error",9),a.qZA()(),a.TgZ(99,"div",2)(100,"mat-form-field",34)(101,"mat-label"),a._uU(102,"Short description of your problem"),a.qZA(),a._UZ(103,"textarea",35,36),a.TgZ(105,"mat-hint",37),a._uU(106),a.qZA()()(),a.YNc(107,v2e,2,1,"div",38),a.TgZ(108,"div",39)(109,"button",40),a.NdJ("click",function(){a.CHM(e);const i=a.MAs(114),s=a.oxw();return a.KtG(s.imageUploaded?s.removeImage():i.click())}),a._uU(110),a.qZA(),a.TgZ(111,"p",41),a._uU(112,"Please only add an image if you believe it will help the medic diagnose you"),a.qZA(),a.TgZ(113,"input",42,43),a.NdJ("change",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onFileSelected(i))}),a.qZA()(),a.TgZ(115,"div",2)(116,"button",44),a.YNc(117,b2e,2,0,"ng-container",7),a.YNc(118,w2e,2,0,"ng-template",null,45,a.W1O),a.qZA()()()}if(2&n){const e=a.MAs(14),r=a.MAs(41),i=a.MAs(104),s=a.MAs(119),o=a.oxw();let l,c,u,f,m,_,y,w,T,I,E,A,M;a.Q6J("formGroup",o.appointmentForm),a.xp6(11),a.Q6J("ngIf",!a.lcZ(12,35,o.cities$))("ngIfElse",e),a.xp6(4),a.Q6J("ngIf",(null==(l=o.appointmentForm.get("city"))?null:l.hasError("required"))&&(null==(l=o.appointmentForm.get("city"))?null:l.touched)),a.xp6(4),a.Q6J("disabled",!a.lcZ(20,37,o.availableSpecialties$)),a.xp6(2),a.Q6J("ngForOf",a.lcZ(22,39,o.availableSpecialties$)),a.xp6(2),a.Q6J("ngIf",(null==(c=o.appointmentForm.get("specialty"))?null:c.hasError("required"))&&(null==(c=o.appointmentForm.get("specialty"))?null:c.touched)),a.xp6(6),a.Q6J("disabled",!a.lcZ(30,41,o.availableMedics$)),a.xp6(2),a.Q6J("ngForOf",a.lcZ(32,43,o.availableMedics$)),a.xp6(2),a.Q6J("ngIf",(null==(u=o.appointmentForm.get("medic"))?null:u.hasError("required"))&&(null==(u=o.appointmentForm.get("medic"))?null:u.touched)),a.xp6(5),a.Q6J("matDatepicker",r)("matDatepickerFilter",o.freeDaysFilter)("ngModel",o.fromDate),a.xp6(1),a.Q6J("for",r),a.xp6(3),a.Q6J("ngIf",(null==(f=o.appointmentForm.get("date"))?null:f.hasError("required"))&&(null==(f=o.appointmentForm.get("date"))?null:f.touched)),a.xp6(4),a.Q6J("disabled",!a.lcZ(47,45,o.availableTimes$)),a.xp6(2),a.Q6J("ngForOf",a.lcZ(49,47,o.availableTimes$)),a.xp6(2),a.Q6J("ngIf",(null==(m=o.appointmentForm.get("time"))?null:m.hasError("required"))&&(null==(m=o.appointmentForm.get("time"))?null:m.touched)),a.xp6(4),a.Q6J("disabled",!o.hasProfileInfo)("matTooltipDisabled",o.hasProfileInfo),a.xp6(7),a.Q6J("ngIf",(null==(_=o.appointmentForm.get("firstName"))?null:_.hasError("required"))&&(null==(_=o.appointmentForm.get("firstName"))?null:_.touched)),a.xp6(5),a.Q6J("ngIf",(null==(y=o.appointmentForm.get("lastName"))?null:y.hasError("required"))&&(null==(y=o.appointmentForm.get("lastName"))?null:y.touched)),a.xp6(6),a.Q6J("ngIf",(null==(w=o.appointmentForm.get("email"))?null:w.hasError("required"))&&(null==(w=o.appointmentForm.get("email"))?null:w.touched)),a.xp6(1),a.Q6J("ngIf",(null==(T=o.appointmentForm.get("email"))?null:T.hasError("email"))&&(null==(T=o.appointmentForm.get("email"))?null:T.touched)),a.xp6(12),a.Q6J("ngIf",(null==(I=o.appointmentForm.get("sex"))?null:I.hasError("required"))&&(null==(I=o.appointmentForm.get("sex"))?null:I.touched)),a.xp6(5),a.Q6J("ngIf",(null==(E=o.appointmentForm.get("age"))?null:E.hasError("required"))&&(null==(E=o.appointmentForm.get("age"))?null:E.touched)),a.xp6(7),a.Q6J("ngIf",(null==(A=o.appointmentForm.get("telephone"))?null:A.hasError("required"))&&(null==(A=o.appointmentForm.get("telephone"))?null:A.touched)),a.xp6(1),a.Q6J("ngIf",(null==(M=o.appointmentForm.get("telephone"))?null:M.hasError("pattern"))&&(null==(M=o.appointmentForm.get("telephone"))?null:M.touched)),a.xp6(8),a.hij("",i.value.length||0,"/250"),a.xp6(1),a.Q6J("ngIf",o.imageUploaded),a.xp6(2),a.Q6J("color",o.imageUploaded?"warn":"accent"),a.xp6(1),a.hij(" ",o.imageUploaded?"Remove image":"Optional: Add an image."," "),a.xp6(6),a.Q6J("disabled",o.appointmentForm.invalid||o.isLoadingAppointmentAdd),a.xp6(1),a.Q6J("ngIf",o.isLoadingAppointmentAdd)("ngIfElse",s)}}let x2e=(()=>{class n{constructor(e,r,i,s,o){this.appointmentService=e,this.formBuilder=r,this.route=i,this._snackBar=s,this.userService=o,this.userId="",this.formLoaded=!1,this.cities$=new Cr.y,this.availableSpecialties$=new Cr.y,this.availableMedics$=new Cr.y,this.availableTimes$=new Cr.y,this.isLoadingAppointmentAdd=!1,this.hasProfileInfo=!1,this.profileSub=new kn.w0,this.imageUrl="",this.imageUploaded=!1,this.freeDaysFilter=l=>{if(null===l)return!1;const c=0!==l.getDay()&&6!==l.getDay(),u=l.getDate()>(new Date).getDate()||l.getMonth()>(new Date).getMonth()||l.getFullYear()>(new Date).getFullYear();return c&&u},this.cities$=this.appointmentService.getDistinctCities()}ngOnInit(){this.formLoaded=!1,this.getRouteParams(),this.profileSub=this.userService.getUserData(this.userId).subscribe(e=>{e.firstName&&(this.hasProfileInfo=!0,this.userData=e),this.createAppointmentForm(),this.city&&this.specialty&&this.medicId?this.autoFillWithRouteParams():this.formLoaded=!0})}ngOnDestroy(){this.profileSub.unsubscribe()}getRouteParams(){this.route.queryParams.subscribe(e=>{this.city=e.city,this.specialty=e.specialty,this.medicId=e.medicId})}autoFillWithRouteParams(){this.cities$.pipe(wn(()=>(this.availableSpecialties$=this.appointmentService.getSpecialtiesForCity(this.city),this.availableSpecialties$)),wn(()=>(this.availableMedics$=this.appointmentService.getMedicsForCityAndSpecialty(this.city,this.specialty),this.availableMedics$))).subscribe(()=>{this.appointmentForm.get("city")?.setValue(this.city),this.appointmentForm.get("specialty")?.setValue(this.specialty),this.appointmentForm.get("medic")?.setValue(this.medicId),this.formLoaded=!0})}createAppointmentForm(){this.appointmentForm=this.formBuilder.group({city:["",[cn.required]],specialty:["",[cn.required]],medic:["",[cn.required]],datetime:this.formBuilder.group({date:["",[cn.required]],time:["",[cn.required]]}),firstName:["",[cn.required]],lastName:["",[cn.required]],age:["",[cn.required]],sex:["",[cn.required]],telephone:["",[cn.required,cn.pattern("^[23467](\\d){8}$")]],email:["",[cn.required,cn.email]],comment:[""]}),this.initialFormValue=this.appointmentForm.value}onCityChange(e){this.availableSpecialties$=this.appointmentService.getSpecialtiesForCity(e.value),this.availableSpecialties$.subscribe(i=>{const s=this.appointmentForm.get("specialty");s?.setValue(""),s?.setValidators([cn.required,this.optionsValidator(i)]),s?.updateValueAndValidity()}),this.availableMedics$=new Cr.y}onSpecialtyChange(e){const r=this.appointmentForm.get("city")?.value;this.availableMedics$=this.appointmentService.getMedicsForCityAndSpecialty(r,e.value),this.availableMedics$.subscribe(s=>{const o=s.map(c=>c.id),l=this.appointmentForm.get("medic");l?.setValidators([cn.required,this.optionsValidator(o)]),l?.updateValueAndValidity()})}onMedicChange(e){this.fromDate=void 0,this.availableTimes$=new Cr.y}onDateChange(e){const r=e.value;if(r){const i=[];for(let o=8;o<16;o++)for(let l=0;l<60;l+=20){const c=new Date(r);c.setHours(o),c.setMinutes(l),c.setSeconds(0),c.setMilliseconds(0),i.push({time:c,disabled:!1})}const s=this.appointmentForm.get("medic")?.value;this.availableTimes$=this.appointmentService.getMedicAppointmentBookedTimes(s,r).pipe((0,Ot.U)(o=>(i.forEach(l=>{o.forEach(c=>{l.time.toISOString()===c.toISOString()&&(l.disabled=!0)})}),i))),this.availableTimes$.subscribe(o=>{const l=o.map(u=>u.time),c=this.appointmentForm.get("dateTime")?.get("time");c?.setValidators([cn.required,this.optionsValidator(l)]),c?.updateValueAndValidity()})}}optionsValidator(e){return r=>null!==cn.required(r)||e.includes(r.value)?null:{oneOf:!0}}onSubmit(){if(this.appointmentForm.valid){this.isLoadingAppointmentAdd=!0;const e=this.appointmentForm.value,r={city:e.city,datetime:e.datetime.time,email:e.email,firstName:e.firstName,lastName:e.lastName,age:e.age,sex:e.sex,telephone:e.telephone,medicId:e.medic,userId:this.userId,comment:e.comment};this.imageUploaded&&this.uploadedFile?this.appointmentService.uploadImage(this.uploadedFile,"appointment-images").pipe(wn(i=>(console.log("After upload image"),r.imgUrl=i,this.appointmentService.addApointment(r)))).subscribe({next:()=>{console.log("After add appointment"),this.appointmentForm.reset(),this.openSnackBar("Successfully created your appointment.")},error:i=>{this.openSnackBar(`An error occured ${i}`)},complete:()=>{this.isLoadingAppointmentAdd=!1}}):this.appointmentService.addApointment(r).subscribe({next:()=>{this.appointmentForm.reset(),this.openSnackBar("Successfully created your appointment.")},error:i=>{this.openSnackBar(`An error occured ${i}`)},complete:()=>{this.isLoadingAppointmentAdd=!1}})}}openSnackBar(e){this._snackBar.open(e,void 0,{duration:1e4})}onFileSelected(e){const r=e.target.files[0];if(r){const i=new FileReader;i.readAsDataURL(r),i.onload=()=>{this.imageUrl=i.result,this.imageUploaded=!0,this.uploadedFile=r,console.log(this.imageUrl,this.imageUploaded,this.uploadedFile)}}}removeImage(){this.imageUrl="",this.imageUploaded=!1}onAutofillClick(){this.appointmentForm.get("firstName")?.setValue(this.userData?.firstName),this.appointmentForm.get("lastName")?.setValue(this.userData?.lastName),this.appointmentForm.get("email")?.setValue(this.userData?.email);const e=this.userData?.sex[0].toUpperCase().concat(this.userData?.sex.slice(1));this.appointmentForm.get("sex")?.setValue(e);const r=this.calculateAge(this.userData?.dateOfBirth);this.appointmentForm.get("age")?.setValue(r)}calculateAge(e){const r=new Date;let o=r.getFullYear()-e.getFullYear();return(r.getMonth()<e.getMonth()||r.getMonth()===e.getMonth()&&r.getDate()<e.getDate())&&o--,o}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(tB),a.Y36(Nf),a.Y36(mh),a.Y36(I$),a.Y36(Xg))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-make-appointment"]],inputs:{userId:"userId"},decls:1,vars:1,consts:[["class","col-12 col-md-6 offset-md-3 p-4 text-center",3,"formGroup","ngSubmit",4,"ngIf"],[1,"col-12","col-md-6","offset-md-3","p-4","text-center",3,"formGroup","ngSubmit"],[1,"row"],[1,"form-title"],[1,"form-subtitle"],["appearance","outline",1,"col-6"],["formControlName","city",3,"selectionChange"],[4,"ngIf","ngIfElse"],["loaded",""],[4,"ngIf"],["formControlName","specialty",3,"disabled","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline"],["formControlName","medic",3,"disabled","selectionChange"],["formGroupName","datetime",1,"row"],["matInput","","formControlName","date",3,"matDatepicker","matDatepickerFilter","ngModel","dateChange","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["formControlName","time",3,"disabled"],[3,"value","disabled",4,"ngFor","ngForOf"],[1,"row","mt-2"],[1,"col-4","offset-4"],["mat-button","","type","button","color","primary","matTooltip","To enable autofill, please fill out your personal information on your profile page",3,"disabled","matTooltipDisabled","click"],["matInput","","type","text","formControlName","firstName"],["matInput","","type","text","formControlName","lastName"],["matInput","","type","email","formControlName","email","placeholder","stefanpopescu@gmail.com"],["appearance","outline",1,"col-4"],["formControlName","sex"],["value","Male"],["value","Female"],["value","Other"],["matInput","","type","number","min","0","max","120","formControlName","age"],["matPrefix",""],["matInput","","type","tel","formControlName","telephone","placeholder","720123456","maxlength","9"],["appearance","outline","hintLabel","Max 250 characters"],["rows","5","matInput","","formControlName","comment","placeholder","Ex. It hurts when I...","maxlength","250"],["textarea",""],["align","end"],["class","row mt-2 text-center",4,"ngIf"],[1,"row","mt-3","mb-3"],["type","button","mat-raised-button","",1,"add-photo-button",3,"color","click"],[1,"disclaimer"],["hidden","","type","file","id","file","accept","image/*",3,"change"],["fileInput",""],["type","submit","mat-raised-button","","color","primary",1,"submit-button",3,"disabled"],["notLoading",""],["disabled",""],[3,"value"],[3,"value","disabled"],[1,"row","mt-2","text-center"],["alt","Appointment image",3,"src"],["diameter","24",2,"margin","auto"]],template:function(e,r){1&e&&a.YNc(0,C2e,120,49,"form",0),2&e&&a.Q6J("ngIf",r.formLoaded)},dependencies:[Na,Ur,js,kq,g1,eoe,Kg,d1,h1,u$,Mb,bq,wq,f1,Jc,Hq,r$,S1,Mm,bf,nC,Cf,av,Pm,cE,lE,Jl,Fm,kf,Oh,ra],styles:[".form-title[_ngcontent-%COMP%]{color:var(--text)}.form-subtitle[_ngcontent-%COMP%]{color:var(--accent)}.submit-button[_ngcontent-%COMP%]{height:40px}.disclaimer[_ngcontent-%COMP%]{font-size:14px;color:gray;margin-top:5px}"]}),n})();function I2e(n,t){1&n&&(a.TgZ(0,"h6")(1,"em"),a._uU(2,"No upcoming appointments"),a.qZA()())}function T2e(n,t){if(1&n&&(a.ynx(0),a.TgZ(1,"div",1)(2,"p")(3,"strong"),a._uU(4,"Medic:"),a.qZA(),a._uU(5),a.qZA()(),a.TgZ(6,"div",1)(7,"p")(8,"strong"),a._uU(9,"Specialty:"),a.qZA(),a._uU(10),a.qZA()(),a.BQk()),2&n){const e=t.ngIf;a.xp6(5),a.lnq(" ",e.shortTitle," ",e.firstName," ",e.lastName,""),a.xp6(5),a.hij(" ",e.specialty,"")}}function S2e(n,t){if(1&n&&(a.ynx(0),a.TgZ(1,"div",1)(2,"h4"),a._uU(3,"Uploaded image:"),a.qZA()(),a.TgZ(4,"div",1)(5,"div",8),a._UZ(6,"img",9),a.qZA()(),a.BQk()),2&n){const e=a.oxw().$implicit;a.xp6(6),a.Q6J("src",e.imgUrl,a.LSH)}}function E2e(n,t){if(1&n&&(a.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),a._uU(3," Upcoming appointment "),a.qZA(),a.TgZ(4,"mat-panel-description"),a._uU(5),a.ALo(6,"date"),a.qZA()(),a.TgZ(7,"div",7)(8,"h2"),a._uU(9,"Appointment Details"),a.qZA()(),a.TgZ(10,"div",1)(11,"div",8)(12,"div",1)(13,"h4"),a._uU(14,"Appointment Info"),a.qZA()(),a.TgZ(15,"div",1)(16,"p")(17,"strong"),a._uU(18,"City:"),a.qZA(),a._uU(19),a.qZA()(),a.TgZ(20,"div",1)(21,"p")(22,"strong"),a._uU(23,"Appointment time:"),a.qZA(),a._uU(24),a.ALo(25,"date"),a.qZA()(),a.YNc(26,T2e,11,4,"ng-container",3),a.qZA(),a.TgZ(27,"div",8)(28,"div",1)(29,"h4"),a._uU(30,"Patient Info"),a.qZA()(),a.TgZ(31,"div",1)(32,"p")(33,"strong"),a._uU(34,"Patient Name:"),a.qZA(),a._uU(35),a.qZA()(),a.TgZ(36,"div",1)(37,"p")(38,"strong"),a._uU(39,"Email:"),a.qZA(),a._uU(40),a.qZA()(),a.TgZ(41,"div",1)(42,"p")(43,"strong"),a._uU(44,"Phone Number:"),a.qZA(),a._uU(45),a.qZA()(),a.TgZ(46,"div",1)(47,"p")(48,"strong"),a._uU(49,"Reason:"),a.qZA(),a._uU(50),a.qZA()()()(),a.YNc(51,S2e,7,1,"ng-container",3),a.qZA()),2&n){const e=t.$implicit,r=a.oxw(2);a.xp6(5),a.hij(" ",a.lcZ(6,10,e.datetime)," "),a.xp6(14),a.hij(" ",e.city,""),a.xp6(5),a.hij(" ",a.xi3(25,12,e.datetime,"medium"),""),a.xp6(2),a.Q6J("ngIf",r.getMedicById(e.medicId)),a.xp6(9),a.AsE(" ",e.firstName," ",e.lastName,""),a.xp6(5),a.hij(" ",e.email,""),a.xp6(5),a.hij(" +40",e.telephone,""),a.xp6(5),a.hij(" ",e.comment?e.comment:"No reason given",""),a.xp6(1),a.Q6J("ngIf",e.imgUrl)}}function D2e(n,t){if(1&n&&(a.ynx(0),a.TgZ(1,"h4",5),a._uU(2,"Upcoming appointments"),a.qZA(),a.YNc(3,I2e,3,0,"h6",3),a.YNc(4,E2e,52,15,"mat-expansion-panel",6),a.BQk()),2&n){const e=t.ngIf;a.xp6(3),a.Q6J("ngIf",0===e.length),a.xp6(1),a.Q6J("ngForOf",e)}}function k2e(n,t){1&n&&(a.TgZ(0,"h6")(1,"em"),a._uU(2,"No past appointments"),a.qZA()())}function A2e(n,t){if(1&n&&(a.ynx(0),a.TgZ(1,"div",1)(2,"p")(3,"strong"),a._uU(4,"Medic:"),a.qZA(),a._uU(5),a.qZA()(),a.TgZ(6,"div",1)(7,"p")(8,"strong"),a._uU(9,"Specialty:"),a.qZA(),a._uU(10),a.qZA()(),a.BQk()),2&n){const e=t.ngIf;a.xp6(5),a.lnq(" ",e.shortTitle," ",e.firstName," ",e.lastName,""),a.xp6(5),a.hij(" ",e.specialty,"")}}function N2e(n,t){if(1&n&&(a.ynx(0),a.TgZ(1,"div",1)(2,"h4"),a._uU(3,"Uploaded image:"),a.qZA()(),a.TgZ(4,"div",1)(5,"div",8),a._UZ(6,"img",9),a.qZA()(),a.BQk()),2&n){const e=a.oxw().$implicit;a.xp6(6),a.Q6J("src",e.imgUrl,a.LSH)}}function R2e(n,t){if(1&n&&(a.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),a._uU(3," Past appointment "),a.qZA(),a.TgZ(4,"mat-panel-description"),a._uU(5),a.ALo(6,"date"),a.qZA()(),a.TgZ(7,"div",11)(8,"h2"),a._uU(9,"Appointment Details"),a.qZA()(),a.TgZ(10,"div",1)(11,"div",8)(12,"div",1)(13,"h4"),a._uU(14,"Appointment Info"),a.qZA()(),a.TgZ(15,"div",1)(16,"p")(17,"strong"),a._uU(18,"City:"),a.qZA(),a._uU(19),a.qZA()(),a.TgZ(20,"div",1)(21,"p")(22,"strong"),a._uU(23,"Appointment time:"),a.qZA(),a._uU(24),a.ALo(25,"date"),a.qZA()(),a.YNc(26,A2e,11,4,"ng-container",3),a.qZA(),a.TgZ(27,"div",8)(28,"div",1)(29,"h4"),a._uU(30,"Patient Info"),a.qZA()(),a.TgZ(31,"div",1)(32,"p")(33,"strong"),a._uU(34,"Patient Name:"),a.qZA(),a._uU(35),a.qZA()(),a.TgZ(36,"div",1)(37,"p")(38,"strong"),a._uU(39,"Email:"),a.qZA(),a._uU(40),a.qZA()(),a.TgZ(41,"div",1)(42,"p")(43,"strong"),a._uU(44,"Phone Number:"),a.qZA(),a._uU(45),a.qZA()(),a.TgZ(46,"div",1)(47,"p")(48,"strong"),a._uU(49,"Reason:"),a.qZA(),a._uU(50),a.qZA()()()(),a.YNc(51,N2e,7,1,"ng-container",3),a.qZA()),2&n){const e=t.$implicit,r=a.oxw(2);a.xp6(5),a.hij(" ",a.lcZ(6,10,e.datetime)," "),a.xp6(14),a.hij(" ",e.city,""),a.xp6(5),a.hij(" ",a.xi3(25,12,e.datetime,"medium"),""),a.xp6(2),a.Q6J("ngIf",r.getMedicById(e.medicId)),a.xp6(9),a.AsE(" ",e.firstName," ",e.lastName,""),a.xp6(5),a.hij(" ",e.email,""),a.xp6(5),a.hij(" +40",e.telephone,""),a.xp6(5),a.hij(" ",e.comment?e.comment:"No reason given",""),a.xp6(1),a.Q6J("ngIf",e.imgUrl)}}function M2e(n,t){if(1&n&&(a.ynx(0),a.TgZ(1,"h4",10),a._uU(2,"Past appointments"),a.qZA(),a.YNc(3,k2e,3,0,"h6",3),a.YNc(4,R2e,52,15,"mat-expansion-panel",6),a.BQk()),2&n){const e=t.ngIf;a.xp6(3),a.Q6J("ngIf",0===e.length),a.xp6(1),a.Q6J("ngForOf",e)}}let O2e=(()=>{class n{constructor(e,r){this.appointmentService=e,this.medicService=r,this.userId="",this.appointments$=new Cr.y,this.pastAppointments$=new Cr.y,this.futureAppointments$=new Cr.y,this.medics=[]}ngOnInit(){this.getAppointmentsForUser(),this.getMedicsForAppointments()}getAppointmentsForUser(){this.appointments$=this.appointmentService.getAppointmentsByUserId(this.userId),this.pastAppointments$=this.appointments$.pipe((0,Ot.U)(e=>e.filter(r=>r.datetime<new Date).sort((r,i)=>i.datetime.getTime()-r.datetime.getTime()))),this.futureAppointments$=this.appointments$.pipe((0,Ot.U)(e=>e.filter(r=>r.datetime>=new Date)))}getMedicsForAppointments(){this.appointments$.pipe(wn(e=>{const r=e.map(i=>i.medicId);return this.medicService.getMedicsById(r)})).subscribe(e=>{this.medics=e})}getMedicById(e){return this.medics.find(r=>r.id===e)}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(tB),a.Y36(U1))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-view-appointment"]],inputs:{userId:"userId"},decls:11,vars:6,consts:[[1,"col-12","p-1","pt-5","overflow-x-hidden"],[1,"row"],["multi","",1,"appointmentAccordion"],[4,"ngIf"],[1,"row","mt-3","mb-3"],[1,"upcoming-appointments-header"],[4,"ngFor","ngForOf"],[1,"row","text-center","mb-3"],[1,"col-6"],["alt","Appointment Image",1,"w-100",3,"src"],[1,"past-appointments-header"],[1,"row","mb-3"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0)(1,"div",1)(2,"mat-accordion",2),a.YNc(3,D2e,5,2,"ng-container",3),a.ALo(4,"async"),a.qZA()(),a.TgZ(5,"div",4),a._UZ(6,"mat-divider"),a.qZA(),a.TgZ(7,"div",1)(8,"mat-accordion",2),a.YNc(9,M2e,5,2,"ng-container",3),a.ALo(10,"async"),a.qZA()()()),2&e&&(a.xp6(3),a.Q6J("ngIf",a.lcZ(4,2,r.futureAppointments$)),a.xp6(6),a.Q6J("ngIf",a.lcZ(10,4,r.pastAppointments$)))},dependencies:[Na,Ur,P1e,hoe,foe,F1e,O1e,Kg,Oh,ra],styles:[".upcoming-appointments-header[_ngcontent-%COMP%]{color:green}.past-appointments-header[_ngcontent-%COMP%]{color:red}"]}),n})();function F2e(n,t){if(1&n&&a._UZ(0,"app-make-appointment",5),2&n){const e=a.oxw();a.Q6J("userId",e.userId)}}function P2e(n,t){if(1&n&&a._UZ(0,"app-view-appointment",5),2&n){const e=a.oxw();a.Q6J("userId",e.userId)}}let xle=(()=>{class n{constructor(e,r){this.authService=e,this.appointmentService=r,this.userId="",this.selected=new dv(0)}ngOnInit(){this.getUserId(),this.appointmentService.addAppointment$.subscribe(()=>{this.selected.setValue(1)})}getUserId(){this.authService.user.subscribe(e=>{e&&(this.userId=e.id)})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(tu),a.Y36(tB))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-appointments"]],decls:6,vars:1,consts:[[1,"container","p-5"],["animationDuration","0ms",3,"selectedIndex","selectedIndexChange"],["label","Create an appointment"],["matTabContent",""],["label","View your appointments"],[3,"userId"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0)(1,"mat-tab-group",1),a.NdJ("selectedIndexChange",function(s){return r.selected.setValue(s)}),a.TgZ(2,"mat-tab",2),a.YNc(3,F2e,1,1,"ng-template",3),a.qZA(),a.TgZ(4,"mat-tab",4),a.YNc(5,P2e,1,1,"ng-template",3),a.qZA()()()),2&e&&(a.xp6(1),a.Q6J("selectedIndex",r.selected.value))},dependencies:[EMe,sae,uMe,x2e,O2e]}),n})(),Ile=(()=>{class n{constructor(e,r,i){this.authService=e,this.userService=r,this.router=i}canActivate(e,r){return this.authService.waitForAuthStateInitialization().pipe(wn(()=>this.authService.isAuthenticated()),wn(i=>St(!!i||this.router.createUrlTree(["/not-authorized"]))))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(tu),a.LFG(Xg),a.LFG(jr))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Tle{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class F5{refCount(t){return Sl("refCount")}incRef(t){return Sl("incRef")}timerAvailable(){return!0}time(t){return Sl("time")}read(t){return Sl("read")}readSync(t){return Sl("readSync")}readToGPU(t,e){return Sl("readToGPU")}numDataIds(){return Sl("numDataIds")}disposeData(t,e){return Sl("disposeData")}write(t,e,r){return Sl("write")}move(t,e,r,i,s){return Sl("move")}createTensorFromGPUData(t,e,r){return Sl("createTensorFromGPUData")}memory(){return Sl("memory")}floatPrecision(){return Sl("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return Sl("dispose")}}function Sl(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function Sle(n){let t=n.length,e=0;for(;t>0;)e=Math.random()*t|0,t--,Jg(n,t,e)}function Vb(n,t,e){return Math.max(n,Math.min(t,e))}function P5(n){return n%2==0?n:n+1}function Jg(n,t,e){const r=n[t];n[t]=n[e],n[e]=r}function G(n,t){if(!n)throw new Error("string"==typeof t?t:t())}function El(n,t,e=""){G(dr(n,t),()=>e+` Shapes ${n} and ${t} must match`)}function YI(n){G(null!=n,()=>"The input to the tensor constructor must be a non-null value.")}function Ye(n){if(0===n.length)return 1;let t=n[0];for(let e=1;e<n.length;e++)t*=n[e];return t}function dr(n,t){if(n===t)return!0;if(null==n||null==t||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function KI(n){return n%1==0}function L5(n){const t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function QI(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function Ele(n,t=(i=>0),e,r){return new Promise((i,s)=>{let o=0;const l=()=>{if(n())return void i();o++;const c=t(o);null!=e&&o>=e?s():null!=r?r(l,c):setTimeout(l,c)};l()})}function Dle(n,t){let e=1,r=-1;for(let s=0;s<n.length;++s)if(n[s]>=0)e*=n[s];else if(-1===n[s]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(n[s]<0)throw Error(`Shapes can not be < 0. Found ${n[s]} at dim ${s}`);if(-1===r){if(t>0&&t!==e)throw Error(`Size(${t}) must match the product of shape ${n}`);return n}if(0===e)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(t%e!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${e}`);const i=n.slice();return i[r]=t/e,i}function Kn(n,t){const e=t.length;return G((n=null==n?t.map((r,i)=>i):[].concat(n)).every(r=>r>=-e&&r<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${n}`),G(n.every(r=>KI(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?e+r:r)}function e_(n,t){const e=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,s=null==t||i?null:Kn(t,n).sort();let o=0;for(let l=0;l<n.length;++l){if(null!=s){if(s[o]===l&&1!==n[l])throw new Error(`Can't squeeze axis ${l} since its dim '${n[l]}' is not 1`);(null==s[o]||s[o]>l)&&1===n[l]&&(e.push(n[l]),r.push(l)),s[o]<=l&&o++}1!==n[l]&&(e.push(n[l]),r.push(l))}return{newShape:e,keptDims:r}}function vo(n,t){return ns(n,t)}function ns(n,t){let e=null;if(null==n||"float32"===n)e=new Float32Array(t);else if("int32"===n)e=new Int32Array(t);else if("bool"===n)e=new Uint8Array(t);else{if("string"!==n)throw new Error(`Unknown data type ${n}`);e=new Array(t)}return e}function kle(n,t){return!("complex64"===t||"float32"===t&&"complex64"!==n||"int32"===t&&"float32"!==n&&"complex64"!==n||"bool"===t&&"bool"===n)}function nB(n){if("float32"===n||"int32"===n)return 4;if("complex64"===n)return 8;if("bool"===n)return 1;throw new Error(`Unknown dtype ${n}`)}function z1(n){return"string"==typeof n||n instanceof String}function $5(n){return"number"==typeof n}function XI(n){return Array.isArray(n)?XI(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":$5(n)?"float32":z1(n)?"string":function G2e(n){return"boolean"==typeof n}(n)?"bool":"float32"}function B5(n){return!!(n&&n.constructor&&n.call&&n.apply)}function V5(n,t){for(let e=t;e<n;++e)if(n%e==0)return e;return n}function pn(n){const t=n.length;if(t<2)return[];const e=new Array(t-1);e[t-2]=n[t-1];for(let r=t-3;r>=0;--r)e[r]=e[r+1]*n[r+1];return e}function Ale(n,t,e,r=!1){const i=new Array;if(1===t.length){const s=t[0]*(r?2:1);for(let o=0;o<s;o++)i[o]=e[n+o]}else{const s=t[0],o=t.slice(1),l=o.reduce((c,u)=>c*u)*(r?2:1);for(let c=0;c<s;c++)i[c]=Ale(n+c*l,o,e,r)}return i}function nu(n,t,e=!1){if(0===n.length)return t[0];const r=n.reduce((i,s)=>i*s)*(e?2:1);if(0===r)return[];if(r!==t.length)throw new Error(`[${n}] does not match the input size ${t.length}${e?" for a complex tensor":""}.`);return Ale(0,n,t,e)}function U5(n,t){const e=Qo(n,t);for(let r=0;r<e.length;r++)e[r]=1;return e}function Qo(n,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(n);if("int32"===t)return new Int32Array(n);if("bool"===t)return new Uint8Array(n);throw new Error(`Unknown data type ${t}`)}function Nle(n,t){const e=n.reduce((r,i)=>r*i,1);if(null==t||"float32"===t)return nu(n,new Float32Array(e));if("int32"===t)return nu(n,new Int32Array(e));if("bool"===t)return nu(n,new Uint8Array(e));throw new Error(`Unknown data type ${t}`)}function dc(n){n.forEach(t=>{G(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function gh(n,t,e){if(0===t)return 0;if(1===t)return n[0];let r=n[n.length-1];for(let i=0;i<n.length-1;++i)r+=e[i]*n[i];return r}function JI(n,t,e){if(0===t)return[];if(1===t)return[n];const r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(n/e[i]),n-=r[i]*e[i];return r[r.length-1]=n,r}function Ub(n){return n&&n.then&&"function"==typeof n.then}class j2e{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=q2e,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,r){if(this.flagRegistry[t]={evaluationFn:e,setHook:r},null!=this.urlFlags[t]){const i=this.urlFlags[t];Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}getAsync(t){var e=this;return(0,q.Z)(function*(){return t in e.flags||(e.flags[t]=yield e.evaluateFlag(t)),e.flags[t]})()}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Ub(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);"tfjsflags"in t&&t.tfjsflags.split(",").forEach(r=>{const[i,s]=r.split(":");this.urlFlags[i]=function Y2e(n,t){const e=t.toLowerCase();return"true"===e||"false"===e?"true"===e:""+ +e===e?+e:t}(0,s)})}}function q2e(n){const t={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...r)=>(function Z2e(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}(t,r[0],r[1]),r.join("="))),t}function Me(){return Mle}let z5,Mle=null;function Ole(){if(null==z5){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(!(typeof self<"u"))throw new Error("Could not find a global object");n=self}z5=n}return z5}function H5(n,t){const e=function Q2e(){const n=Ole();return null==n._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals}();if(e.has(n))return e.get(n);{const r=t();return e.set(n,r),e.get(n)}}const rB="Abs",H1="Acos",G1="Acosh",eT="Add",iB="AddN",sB="ArgMax",oB="ArgMin",W1="Asin",j1="Asinh",q1="Atan",Z1="Atanh",Y1="Atan2",aB="AvgPool",j5="AvgPoolGrad",lB="AvgPool3D",q5="AvgPool3DGrad",cB="BatchMatMul",uB="BatchToSpaceND",Z5="Bincount",dB="BitwiseAnd",Y5="BroadcastArgs",K1="Cast",Q1="Ceil",X1="ClipByValue",K5="Complex",hB="ComplexAbs",fB="Concat",pB="Conv2D",Q5="Conv2DBackpropFilter",mB="Conv2DBackpropInput",gB="Conv3D",X5="Conv3DBackpropFilterV2",J5="Conv3DBackpropInputV2",J1="Cos",eN="Cosh",eZ="Cumprod",_B="Cumsum",tZ="CropAndResize",nZ="DenseBincount",rZ="DepthToSpace",yB="DepthwiseConv2dNative",iZ="DepthwiseConv2dNativeBackpropFilter",sZ="DepthwiseConv2dNativeBackpropInput",oZ="Diag",vB="Dilation2D",aZ="Dilation2DBackpropInput",lZ="Dilation2DBackpropFilter",tN="RealDiv",uZ="Einsum",nN="Elu",dZ="EluGrad",rN="Erf",bB="Equal",iN="Exp",wB="ExpandDims",sN="Expm1",fZ="Fill",pZ="FlipLeftRight",oN="Floor",aN="FloorDiv",CB="FusedBatchNorm",xB="GatherV2",mZ="GatherNd",IB="Greater",lN="GreaterEqual",cN="Identity",gZ="IFFT",_Z="Imag",uN="IsFinite",dN="IsInf",hN="IsNan",TB="LeakyRelu",SB="Less",EB="LessEqual",yZ="LinSpace",fN="Log",pN="Log1p",DB="LogicalAnd",kB="LogicalNot",AB="LogicalOr",NB="LRN",vZ="LRNGrad",RB="Max",mN="Maximum",MB="MaxPool",bZ="MaxPoolGrad",OB="MaxPool3D",wZ="MaxPool3DGrad",CZ="MaxPoolWithArgmax",FB="Mean",PB="Min",gN="Minimum",LB="MirrorPad",_N="Mod",xZ="Multinomial",yN="Multiply",$B="Neg",BB="NotEqual",IZ="NonMaxSuppressionV3",TZ="NonMaxSuppressionV4",SZ="NonMaxSuppressionV5",VB="OnesLike",UB="OneHot",zB="Pack",HB="PadV2",vN="Pow",GB="Prelu",WB="Prod",EZ="RaggedGather",DZ="RaggedRange",kZ="RaggedTensorToTensor",AZ="Range",NZ="Real",bN="Reciprocal",wN="Relu",jB="Reshape",qB="ResizeNearestNeighbor",RZ="ResizeNearestNeighborGrad",ZB="ResizeBilinear",MZ="ResizeBilinearGrad",CN="Relu6",YB="Reverse",xN="Round",IN="Rsqrt",OZ="ScatterNd",FZ="TensorScatterUpdate",PZ="SearchSorted",KB="Select",TN="Selu",QB="Slice",SN="Sin",EN="Sinh",DN="Sign",kN="Sigmoid",AN="Softplus",NN="Sqrt",XB="Sum",JB="SpaceToBatchND",eV="SplitV",tV="Softmax",LZ="SparseFillEmptyRows",$Z="SparseReshape",BZ="SparseSegmentMean",VZ="SparseSegmentSum",UZ="SparseToDense",RN="SquaredDifference",zZ="Square",nV="StaticRegexReplace",HZ="StridedSlice",GZ="StringNGrams",WZ="StringSplit",jZ="StringToHashBucketFast",MN="Sub",ON="Tan",FN="Tanh",PN="Tile",qZ="TopK",ZZ="Transform",tT="Transpose",YZ="Unique",rV="Unpack",iV="UnsortedSegmentSum",sV="ZerosLike",LN="Step",KZ="FromPixels",QZ="RotateWithOffset",oV="_FusedMatMul",aV="FusedConv2D",lV="FusedDepthwiseConv2D";function hc(...n){Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(...n)}function eLe(...n){Me().getBool("IS_TEST")||Me().getBool("PROD")||console.log(...n)}const nT=H5("kernelRegistry",()=>new Map),$N=H5("gradRegistry",()=>new Map);function cV(n,t){const e=e8(n,t);return nT.get(e)}function Fle(n){return $N.get(n)}function XZ(n){const t=nT.entries(),e=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[s,o]=i,[l]=s.split("_");l===n&&e.push(o)}return e}function JZ(n){const{kernelName:t,backendName:e}=n,r=e8(t,e);nT.has(r)&&hc(`The kernel '${t}' for backend '${e}' is already registered`),nT.set(r,n)}function tLe(n){const{kernelName:t}=n;$N.has(t)&&Me().getBool("DEBUG")&&hc(`Overriding the gradient for '${t}'`),$N.set(t,n)}function e8(n,t){return`${t}_${n}`}function Ple(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var Lle=z(7658);const zb=z.n(Lle)()||Lle;function uV(n){return zb.fromString(n,!0,16)}const $le=uV("c3a5c85c97cb3127"),Hb=uV("b492b66fbe98f273"),ya=uV("9ae16a3b2f90404f");function t8(n){return n.xor(n.shru(47))}function Ble(n,t,e){const r=n.slice(t,t+e);return zb.fromBytes(Array.from(r),!0,!0)}function ni(n,t){return Ble(n,t,8)}function Vle(n,t){return Ble(n,t,4)}function qs(n,t){return 0===t?n:n.shru(t).or(n.shl(64-t))}function t_(n,t,e=uV("9ddfea08eb382d69")){let r=n.xor(t).mul(e);r=r.xor(r.shru(47));let i=t.xor(r).mul(e);return i=i.xor(i.shru(47)),i=i.mul(e),i}function dV(n,t,e,r){return function rLe(n,t,e,r,i,s){i=i.add(n),s=qs(s.add(i).add(r),21);const o=i;return i=(i=i.add(t)).add(e),s=s.add(qs(i,44)),[i.add(r),s.add(o)]}(ni(n,t),ni(n,t+8),ni(n,t+16),ni(n,t+24),e,r)}function aLe(n,t=n.length){const e=zb.fromNumber(81,!0);if(t<=32)return t<=16?function iLe(n,t=n.length){if(t>=8){const e=ya.add(2*t),r=ni(n,0).add(ya),i=ni(n,t-8);return t_(qs(i,37).mul(e).add(r),qs(r,25).add(i).mul(e),e)}if(t>=4){const e=ya.add(2*t);return t_(Vle(n,0).shl(3).add(t),Vle(n,t-4),e)}if(t>0){const o=t+(n[t-1]<<2);return t8(ya.mul(n[0]+(n[t>>1]<<8)).xor($le.mul(o))).mul(ya)}return ya}(n,t):function sLe(n,t=n.length){const e=ya.add(2*t),r=ni(n,0).mul(Hb),i=ni(n,8),s=ni(n,t-8).mul(e),o=ni(n,t-16).mul(ya);return t_(qs(r.add(i),43).add(qs(s,30)).add(o),r.add(qs(i.add(ya),18)).add(s),e)}(n,t);if(t<=64)return function oLe(n,t=n.length){const e=ya.add(2*t),r=ni(n,0).mul(ya),i=ni(n,8),s=ni(n,t-8).mul(e),o=ni(n,t-16).mul(ya),l=qs(r.add(i),43).add(qs(s,30)).add(o),c=t_(l,r.add(qs(i.add(ya),18)).add(s),e),u=ni(n,16).mul(e),f=ni(n,24),m=l.add(ni(n,t-32)).mul(e),_=c.add(ni(n,t-24)).mul(e);return t_(qs(u.add(f),43).add(qs(m,30)).add(_),u.add(qs(f.add(r),18)).add(m),e)}(n,t);let r=e,i=e.mul(Hb).add(113),s=t8(i.mul(ya).add(113)).mul(ya),o=[zb.UZERO,zb.UZERO],l=[zb.UZERO,zb.UZERO];r=r.mul(ya).add(ni(n,0));let c=0;const u=64*(t-1>>6),f=u+(t-1&63)-63;do{r=qs(r.add(i).add(o[0]).add(ni(n,c+8)),37).mul(Hb),i=qs(i.add(o[1]).add(ni(n,c+48)),42).mul(Hb),r=r.xor(l[1]),i=i.add(o[0]).add(ni(n,c+40)),s=qs(s.add(l[0]),33).mul(Hb),o=dV(n,c,o[1].mul(Hb),r.add(l[0])),l=dV(n,c+32,s.add(l[1]),i.add(ni(n,c+16))),[s,r]=[r,s],c+=64}while(c!==u);const m=Hb.add(s.and(255).shl(1));return c=f,l[0]=l[0].add(t-1&63),o[0]=o[0].add(l[0]),l[0]=l[0].add(o[0]),r=qs(r.add(i).add(o[0]).add(ni(n,c+8)),37).mul(m),i=qs(i.add(o[1]).add(ni(n,c+48)),42).mul(m),r=r.xor(l[1].mul(9)),i=i.add(o[0].mul(9).add(ni(n,c+40))),s=qs(s.add(l[0]),33).mul(m),o=dV(n,c,o[1].mul(m),r.add(l[0])),l=dV(n,c+32,s.add(l[1]),i.add(ni(n,c+16))),[s,r]=[r,s],t_(t_(o[0],l[0],m).add(t8(i).mul($le)).add(s),t_(o[1],l[1],m).add(r),m)}function n_(n,t){return"string"===t?r_(n):Gb([n],t)}function Gb(n,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Wb(n)),Me().getBool("DEBUG")&&function U2e(n,t){for(let e=0;e<n.length;e++){const r=n[e];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}(n,t),function lLe(n,t){return n instanceof Float32Array&&"float32"===t||n instanceof Int32Array&&"int32"===t||n instanceof Uint8Array&&"bool"===t}(n,t))return n;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(n);if("int32"===t)return new Int32Array(n);if("bool"===t){const e=new Uint8Array(n.length);for(let r=0;r<e.length;++r)0!==Math.round(n[r])&&(e[r]=1);return e}throw new Error(`Unknown data type ${t}`)}function Qa(){return Me().platform.now()}function r_(n,t="utf-8"){return t=t||"utf-8",Me().platform.encode(n,t)}function i_(n,t="utf-8"){return t=t||"utf-8",Me().platform.decode(n,t)}function ru(n){return null!=Me().platform.isTypedArray?Me().platform.isTypedArray(n):Ple(n)}function Wb(n,t=[],e=!1){if(null==t&&(t=[]),"boolean"==typeof n||"number"==typeof n||"string"==typeof n||Ub(n)||null==n||ru(n)&&e)t.push(n);else if(Array.isArray(n)||ru(n))for(let r=0;r<n.length;++r)Wb(n[r],t,e);else{let r=-1;for(const i of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)Wb(n[i],t,e)}return t}class cLe{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new dLe)}profileKernel(t,e,r){let i;const s=()=>{i=r()};let o;const l=Qa();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();for(const u of i)u.dataSync();o=Promise.resolve({kernelMs:Qa()-l})}if(Me().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<i.length;u++){const f=i[u];f.data().then(m=>{uLe(m,f.dtype,t)})}return{kernelName:t,outputs:i,inputs:e,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>null!=u.getExtraProfileInfo?u.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:e,outputs:r,timeMs:i,inputs:s,extraInfo:o}=t;r.forEach(l=>{Promise.all([l.data(),i,o]).then(c=>{this.logger.logKernelProfile(e,l,c[0],c[1],s,c[2])})})}}function uLe(n,t,e){if("float32"!==t)return!1;for(let r=0;r<n.length;r++){const i=n[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${e}'`),!0}return!1}class dLe{logKernelProfile(t,e,r,i,s,o){const l="number"==typeof i?QI(`${i}ms`,9):i.error,c=QI(t,25),u=e.rank,f=e.size,m=QI(e.shape.toString(),14);let _="";for(const y in s){const w=s[y];if(null!=w){const T=w.shape||e.shape,I=T.length;_+=`${y}: ${I}D ${I>0?T:""} `}}console.log(`%c${c}\t%c${l}\t%c${u}D ${m}\t%c${f}\t%c${_}\t%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function pLe(n,t,e,r){const i=pn(t),s=function mLe(n,t,e,r){const i=Ye(t),s=r[r.length-1],o=new Array(s).fill(0),l=t.length,c="complex64"===e?UN(n):n;if(l>1)for(let u=0;u<i/s;u++){const f=u*s;for(let m=0;m<s;m++)o[m]=Math.max(o[m],VN(c[f+m],0,e).length)}return o}(n,t,e,i),o=t.length,l=hV(n,t,e,i,s),c=["Tensor"];return r&&(c.push(`  dtype: ${e}`),c.push(`  rank: ${o}`),c.push(`  shape: [${t}]`),c.push("  values:")),c.push(l.map(u=>"    "+u).join("\n")),c.join("\n")}function VN(n,t,e){let r;return r=Array.isArray(n)?`${parseFloat(n[0].toFixed(7))} + ${parseFloat(n[1].toFixed(7))}j`:z1(n)?`'${n}'`:"bool"===e?zle(n):parseFloat(n.toFixed(7)).toString(),QI(r,t)}function zle(n){return 0===n?"false":"true"}function hV(n,t,e,r,i,s=!0){const o="complex64"===e?2:1,l=t[0],c=t.length;if(0===c)return"complex64"===e?[VN(UN(n)[0],0,e)]:"bool"===e?[zle(n[0])]:[n[0].toString()];if(1===c){if(l>20){let E=Array.from(n.slice(0,3*o)),A=Array.from(n.slice((l-3)*o,l*o));return"complex64"===e&&(E=UN(E),A=UN(A)),["["+E.map((M,O)=>VN(M,i[O],e)).join(", ")+", ..., "+A.map((M,O)=>VN(M,i[l-3+O],e)).join(", ")+"]"]}return["["+("complex64"===e?UN(n):Array.from(n)).map((I,E)=>VN(I,i[E],e)).join(", ")+"]"]}const u=t.slice(1),f=r.slice(1),m=r[0]*o,_=[];if(l>20){for(let T=0;T<3;T++){const I=T*m;_.push(...hV(n.slice(I,I+m),u,e,f,i,!1))}_.push("...");for(let T=l-3;T<l;T++){const I=T*m;_.push(...hV(n.slice(I,I+m),u,e,f,i,T===l-1))}}else for(let T=0;T<l;T++){const I=T*m;_.push(...hV(n.slice(I,I+m),u,e,f,i,T===l-1))}const y=2===c?",":"";_[0]="["+(l>0?_[0]+y:"");for(let T=1;T<_.length-1;T++)_[T]=" "+_[T]+y;let w=",\n";for(let T=2;T<c;T++)w+="\n";return _[_.length-1]=" "+_[_.length-1]+"]"+(s?"":w),_}function UN(n){const t=[];for(let e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}class Ds{constructor(t,e,r){if(this.dtype=e,this.shape=t.slice(),this.size=Ye(t),null!=r){const i=r.length;G(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||ns(e,this.size),this.strides=pn(t)}set(t,...e){0===e.length&&(e=[0]),G(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const r=this.locToIndex(e);this.values[r]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const i of t){if(i<0||i>=this.shape[e])throw new Error(`Requested out of range element at ${t}.   Buffer shape=${this.shape}`);e++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return nd().makeTensor(this.values,this.shape,this.dtype)}}let nd=null,rT=null,Hle=null;class fi{constructor(t,e,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Ye(t),this.strides=pn(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){var t=this;return(0,q.Z)(function*(){const e=yield t.data();return rT.buffer(t.shape,t.dtype,e)})()}bufferSync(){return rT.buffer(this.shape,this.dtype,this.dataSync())}array(){var t=this;return(0,q.Z)(function*(){const e=yield t.data();return nu(t.shape,e,"complex64"===t.dtype)})()}arraySync(){return nu(this.shape,this.dataSync(),"complex64"===this.dtype)}data(){var t=this;return(0,q.Z)(function*(){t.throwIfDisposed();const e=nd().read(t.dataId);if("string"===t.dtype){const r=yield e;try{return r.map(i=>i_(i))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e})()}dataToGPU(t){return this.throwIfDisposed(),nd().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=nd().readSync(this.dataId);if("string"===this.dtype)try{return t.map(e=>i_(e))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}bytes(){var t=this;return(0,q.Z)(function*(){t.throwIfDisposed();const e=yield nd().read(t.dataId);return"string"===t.dtype?e:new Uint8Array(e.buffer)})()}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),nd().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return rT.print(this,t)}clone(){return this.throwIfDisposed(),rT.clone(this)}toString(t=!1){return pLe(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),rT.cast(this,t)}variable(t=!0,e,r){return this.throwIfDisposed(),nd().makeVariable(this,t,e,r)}}function Xe(){return H5("Tensor",()=>fi)}Object.defineProperty(fi,Symbol.hasInstance,{value:n=>!!n&&null!=n.data&&null!=n.dataSync&&null!=n.throwIfDisposed}),Xe();class fV extends fi{constructor(t,e,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=e,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!dr(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);nd().disposeTensor(this),this.dataId=t.dataId,nd().incRef(this,null)}dispose(){nd().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(fV,Symbol.hasInstance,{value:n=>n instanceof fi&&null!=n.assign&&n.assign instanceof Function});var pV=(()=>(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"}(pV||(pV={})),pV))(),mV=(()=>(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"}(mV||(mV={})),mV))(),gV=(()=>(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"}(gV||(gV={})),gV))(),_V=(()=>(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"}(_V||(_V={})),_V))();const vLe={float32:gV,int32:pV,bool:mV,complex64:_V};function Dl(n,t){if("string"===n||"string"===t){if("string"===n&&"string"===t)return"string";throw new Error(`Can not upcast ${n} with ${t}`)}return vLe[n][t]}function r8(n){return Dl(n,"int32")}function Gle(n){return null!=n&&"object"==typeof n&&"texture"in n&&n.texture instanceof WebGLTexture}function Wle(n){return typeof GPUBuffer<"u"&&null!=n&&"object"==typeof n&&"buffer"in n&&n.buffer instanceof GPUBuffer}function Hi(n,t){if(n.dtype===t.dtype)return[n,t];const e=Dl(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function jle(n){const t=[];return qle(n,t,new Set),t}function qle(n,t,e){if(null==n)return;if(n instanceof fi)return void t.push(n);if(!function wLe(n){return Array.isArray(n)||"object"==typeof n}(n))return;const r=n;for(const i in r){const s=r[i];e.has(s)||(e.add(s),qle(s,t,e))}}function i8(n){return null!=n.kernelName}class Zle{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}let CLe=(()=>{class n{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Zle}ready(){var e=this;return(0,q.Z)(function*(){if(null!=e.pendingBackendInit)return e.pendingBackendInit.then(()=>{});if(null!=e.backendInstance)return;const r=e.getSortedBackends();for(let i=0;i<r.length;i++){const s=r[i];if(yield e.initializeBackend(s).success)return void(yield e.setBackend(s))}throw new Error("Could not initialize any backends, all backend initializations failed.")})()}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:r}=this.initializeBackendsAndReturnBest();if(r)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:r}=this.initializeBackend(e);if(r)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,r,i=1){return e in this.registryFactory?(hc(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:r,priority:i},!0)}setBackend(e){var r=this;return(0,q.Z)(function*(){if(null==r.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(r.backendName=e,null==r.registry[e]){r.backendInstance=null;const{success:i,asyncInit:s}=r.initializeBackend(e);if(!(s?yield i:i))return!1}return r.backendInstance=r.registry[e],r.setupRegisteredKernels(),r.profiler=new cLe(r.backendInstance),!0})()}setupRegisteredKernels(){XZ(this.backendName).forEach(r=>{null!=r.setupFunc&&r.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){XZ(e).forEach(i=>{null!=i.disposeFunc&&i.disposeFunc(this.registry[e])})}initializeBackend(e){const r=this.registryFactory[e];if(null==r)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const i=r.factory();if(!i||i instanceof F5||"function"!=typeof i.then)return this.registry[e]=i,{success:!0,asyncInit:!1};{const s=++this.pendingBackendInitId,o=i.then(l=>!(s<this.pendingBackendInitId||(this.registry[e]=l,this.pendingBackendInit=null,0))).catch(l=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,hc(`Initialization of backend ${e} failed`),hc(l.stack||l.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}}catch(i){return hc(`Initialization of backend ${e} failed`),hc(i.stack||i.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,r)=>this.registryFactory[r].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let r=0;r<e.length;r++){const i=e[r],{success:s,asyncInit:o}=this.initializeBackend(i);if(o||s)return{name:i,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,r){const i=this.state.tensorInfo.get(r),s=i.backend,o=this.readSync(r),l=s.refCount(r);s.disposeData(r,!0),i.backend=e,e.move(r,o,i.shape,i.dtype,l),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,r){let s,i=null;if(null==r){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");r=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof r)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun(()=>this.startScope(i),()=>this.endScope(s),()=>(s=r(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,r,i){e();try{const s=i();return r(),s}catch(s){throw r(),s}}nextTensorId(){return n.nextTensorId++}nextVariableId(){return n.nextVariableId++}clone(e){const r=ce.runKernel(cN,{x:e});return this.addTapeNode(this.state.activeScope.name,{x:e},[r],l=>({x:()=>ce.runKernel(K1,{x:l},{dtype:"float32"})}),[],{}),r}runKernel(e,r,i){if(null==cV(e,this.backendName))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:r,attrs:i})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,r,i){const s=this.backend.numDataIds();let o=0;i.forEach(u=>{o+="complex64"===u.dtype?3:1});const c=s-r-o-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(c>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${c} data ids) after running '${e}'`)}runKernelFunc(e){let r,i=[];const s=this.isTapeOn(),o=this.state.numBytes,l=this.state.numTensors;let c,u;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const f=i8(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(i8(e)){const{kernelName:T,inputs:I,attrs:E}=e,A=cV(T,this.backendName);G(null!=A,()=>`Cannot find registered kernel '${T}' for backend '${this.backendName}'`),c=()=>{const M=this.backend.numDataIds();u=A.kernelFunc({inputs:I,attrs:E,backend:this.backend});const O=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(T,M,O);const $=O.map(V=>null!=V.rank?V:this.makeTensorFromTensorInfo(V));if(s){const V=this.getTensorsForGradient(T,I,$);i=this.saveTensorsForBackwardMode(V)}return $}}else{const{forwardFunc:T}=e,I=E=>{!s||(i=E.map(A=>this.keep(this.clone(A))))};c=()=>{const E=this.backend.numDataIds();u=this.tidy(()=>T(this.backend,I));const A=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(f,E,A),A}}const{inputs:m,attrs:_}=e,y=i8(e)?null:e.backwardsFunc;let w;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(w=this.profiler.profileKernel(f,m,()=>c()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(w),r=w.outputs):r=c()}),s&&this.addTapeNode(f,m,r,y,i,_),this.state.profiling&&this.state.activeProfile.kernels.push({name:f,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(m).map(T=>null!=m[T]?m[T].shape:null),outputShapes:r.map(T=>T.shape),kernelTimeMs:w.timeMs,extraInfo:w.extraInfo}),Array.isArray(u)?r:r[0]}saveTensorsForBackwardMode(e){return e.map(i=>this.keep(this.clone(i)))}getTensorsForGradient(e,r,i){const s=Fle(e);if(null!=s){const o=s.inputsToSave||[],l=s.outputsToSave||[];let c;s.saveAllInputs?(G(Array.isArray(r),()=>"saveAllInputs is true, expected inputs to be an array."),c=Object.keys(r).map(f=>r[f])):c=o.map(f=>r[f]);const u=i.filter((f,m)=>l[m]);return c.concat(u)}return[]}makeTensor(e,r,i,s){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");s=s||this.backend;let o=e;"string"===(i=i||"float32")&&z1(e[0])&&(o=e.map(u=>r_(u)));const l=s.write(o,r,i),c=new fi(r,i,l,this.nextTensorId());if(this.trackTensor(c,s),"string"===i){const u=this.state.tensorInfo.get(l),f=function H2e(n){if(null==n)return 0;let t=0;return n.forEach(e=>t+=e.length),t}(o);this.state.numBytes+=f-u.bytes,u.bytes=f}return c}makeTensorFromDataId(e,r,i,s){return this.makeTensorFromTensorInfo({dataId:e,shape:r,dtype:i=i||"float32"},s)}makeTensorFromTensorInfo(e,r){const{dataId:i,shape:s,dtype:o}=e,l=new fi(s,o,i,this.nextTensorId());return this.trackTensor(l,r),l}makeVariable(e,r=!0,i,s){i=i||this.nextVariableId().toString(),null!=s&&s!==e.dtype&&(e=e.cast(s));const o=new fV(e,r,i,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,r){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let i=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(i=e.size*nB(e.dtype)),this.state.numBytes+=i,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:r||this.backend,dtype:e.dtype,shape:e.shape,bytes:i})),e instanceof fV||this.track(e)}incRef(e,r){this.trackTensor(e,r),this.backend.incRef(e.dataId)}removeDataId(e,r){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===r&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const r=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=r.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const i=e.size*nB(e.dtype);this.state.numBytes-=i}r.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,r.backend)}disposeVariables(){for(const e in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[e])}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}profile(e){var r=this;return(0,q.Z)(function*(){r.state.profiling=!0;const i=r.state.numBytes,s=r.state.numTensors;r.state.activeProfile.kernels=[],r.state.activeProfile.result=yield e(),r.state.profiling=!1,r.state.activeProfile.peakBytes=Math.max(...r.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),r.state.activeProfile.newBytes=r.state.numBytes-i,r.state.activeProfile.newTensors=r.state.numTensors-s;for(const o of r.state.activeProfile.kernels)o.kernelTimeMs=yield o.kernelTimeMs,o.extraInfo=yield o.extraInfo;return r.state.activeProfile})()}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,r,i,s,o,l){const c={id:this.state.nextTapeNodeId++,kernelName:e,inputs:r,outputs:i,saved:o},u=Fle(e);null!=u&&(s=u.gradFunc),null!=s&&(c.gradient=f=>(f=f.map((m,_)=>{if(null==m){const y=i[_],w=Qo(y.size,y.dtype);return this.makeTensor(w,y.shape,y.dtype)}return m}),s(f.length>1?f:f[0],o,l))),this.state.activeTape.push(c)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(r.name=e),this.state.scopeStack.push(r),this.state.activeScope=r}endScope(e){const r=jle(e),i=new Set(r.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const l=this.state.activeScope.track[o];!l.kept&&!i.has(l.id)&&l.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,r,i,s=!1){if(G(r.length>0,()=>"gradients() received an empty list of xs."),null!=i&&"float32"!==i.dtype)throw new Error(`dy must have 'float32' dtype, but has '${i.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));G(o instanceof fi,()=>"The result y returned by f() must be a tensor.");const l=function hLe(n,t,e){const r={},i={};for(let c=0;c<t.length;c++)r[t[c].id]=!0;for(let c=0;c<n.length;c++){const u=n[c],f=u.inputs;for(const m in f){const _=f[m];let y=!1;for(let w=0;w<t.length;w++)if(r[_.id]){u.outputs.forEach(T=>r[T.id]=!0),y=!0,i[u.id]=!0;break}if(y)break}}const s={};s[e.id]=!0;const o={};for(let c=n.length-1;c>=0;c--){const u=n[c],f=u.inputs;for(let m=0;m<u.outputs.length;m++)if(s[u.outputs[m].id]){for(const _ in f)s[f[_].id]=!0,o[u.id]=!0;break}}const l=[];for(let c=0;c<n.length;c++){const u=n[c];if(i[u.id]&&o[u.id]){const f={};for(const _ in u.inputs){const y=u.inputs[_];r[y.id]&&(f[_]=y)}const m=Object.assign({},u);m.inputs=f,m.outputs=u.outputs,l.push(m)}}return l}(this.state.activeTape,r,o);if(!s&&0===l.length&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const c={};c[o.id]=i??function xLe(n){const t=U5(Ye(n),"float32");return ce.makeTensor(t,n,"float32")}(o.shape),function fLe(n,t,e,r){for(let i=t.length-1;i>=0;i--){const s=t[i],o=[];if(s.outputs.forEach(c=>{const u=n[c.id];o.push(null!=u?u:null)}),null==s.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const l=s.gradient(o);for(const c in s.inputs){if(!(c in l))throw new Error(`Cannot backprop through input ${c}. Available gradients found: ${Object.keys(l)}.`);const u=e(()=>l[c]());if("float32"!==u.dtype)throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${c} must have 'float32' dtype, but has '${u.dtype}'`);const f=s.inputs[c];if(!dr(u.shape,f.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${c}' has shape '${u.shape}', which does not match the shape of the input '${f.shape}'`);if(null==n[f.id])n[f.id]=u;else{const m=n[f.id];n[f.id]=r(m,u),m.dispose()}}}}(c,l,f=>this.tidy(f),ILe);const u=r.map(f=>c[f.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(f=>{for(const m of f.saved)m.dispose()}),this.state.activeTape=null),{value:o,grads:u}})}customGrad(e){return G(B5(e),()=>"The f passed in customGrad(f) must be a function."),(...r)=>{let i;G(r.every(c=>c instanceof fi),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const s={};return r.forEach((c,u)=>{s[u]=c}),this.runKernelFunc({forwardFunc:(c,u)=>(i=e(...r,u),G(i.value instanceof fi,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),G(B5(i.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),i.value),backwardsFunc:(c,u)=>{const f=i.gradFunc(c,u),m=Array.isArray(f)?f:[f];G(m.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),G(m.every(y=>y instanceof fi),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const _={};return m.forEach((y,w)=>{_[w]=()=>y}),_},inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,r){return this.state.tensorInfo.get(e).backend.readToGPU(e,r)}time(e){var r=this;return(0,q.Z)(function*(){const i=Qa(),s=yield r.backend.time(e);return s.wallMs=Qa()-i,s})()}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Zle;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}return n.nextTensorId=0,n.nextVariableId=0,n})();function Yle(){const n=Ole();if(null==n._tfengine){const t=new j2e(n);n._tfengine=new CLe(t)}return function K2e(n){Mle=n}(n._tfengine.ENV),function gLe(n){nd=n}(()=>n._tfengine),n._tfengine}const ce=Yle();function ILe(n,t){return ce.runKernel(eT,{a:n,b:t})}function Kle(n){if(n||function TLe(){return typeof navigator<"u"&&null!=navigator}()){if(n||(n=navigator),"ReactNative"===n.product)return!0;const t=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!t){const e=n;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function Qle(){return typeof window<"u"&&null!=window.document||typeof WorkerGlobalScope<"u"}const Xa=Me();function s_(n,t){let e=n;if(ru(n))return"string"===t?[]:[n.length];if(Gle(n))return[n.height,n.width*(n.channels||"RGBA").length];if(Wle(n))return[n.buffer.size/(null==t?4:nB(t))];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(e)||ru(e)&&"string"!==t;)r.push(e.length),e=e[0];return Array.isArray(n)&&Me().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Xle(n,r,[]),r}function Xle(n,t,e){if(e=e||[],!Array.isArray(n)&&!ru(n))return void G(0===t.length,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);G(t.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${n.length} elements`),G(n.length===t[0],()=>`Element arr[${e.join("][")}] should have ${t[0]} elements, but has ${n.length} elements`);const r=t.slice(1);for(let i=0;i<n.length;++i)Xle(n[i],r,e.concat(i))}function Jle(n,t,e,r){if("string_or_numeric"!==n){if(null==n)throw new Error("Expected dtype cannot be null.");if("numeric"!==n&&n!==t||"numeric"===n&&"string"===t)throw new Error(`Argument '${e}' passed to '${r}' must be ${n} tensor, but got ${t} tensor`)}}function j(n,t,e,r="numeric"){if(n instanceof Xe())return Jle(r,n.dtype,t,e),n;let i=XI(n);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Jle(r,i,t,e),null==n||!ru(n)&&!Array.isArray(n)&&"number"!=typeof n&&"boolean"!=typeof n&&"string"!=typeof n)throw new Error(`Argument '${t}' passed to '${e}' must be a Tensor or TensorLike, but got '${null==n?"null":n.constructor.name}'`);const s=s_(n,i);!ru(n)&&!Array.isArray(n)&&(n=[n]);const l="string"!==i?Gb(n,i):Wb(n,[],!0);return ce.makeTensor(l,s,i)}function yV(n,t,e,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${t} passed to ${e} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((s,o)=>j(s,`${t}[${o}]`,e,r))}Xa.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Xa.registerFlag("IS_BROWSER",()=>Qle()),Xa.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"),Xa.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),Xa.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),Xa.registerFlag("PROD",()=>!1),Xa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Xa.getBool("DEBUG")),Xa.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),Xa.registerFlag("IS_TEST",()=>!1),Xa.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Xa.getBool("DEBUG")),Xa.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),Xa.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),Xa.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);const ece="__op";function se(n){const t=Object.keys(n);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let e=t[0];const r=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e+=ece;const i=(...s)=>{ce.startScope(e);try{const o=r(...s);return Ub(o)&&console.error("Cannot return a Promise inside of tidy."),ce.endScope(o),o}catch(o){throw ce.endScope(null),o}};return Object.defineProperty(i,"name",{value:e,configurable:!0}),i}const o_=se({complex_:function SLe(n,t){const e=j(n,"real","complex"),r=j(t,"imag","complex");return El(e.shape,r.shape,`real and imag shapes, ${e.shape} and ${r.shape}, must match in call to tf.complex().`),ce.runKernel(K5,{real:e,imag:r})}});function a_(n,t,e,r){if(null==r)r=XI(n);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Wle(n)||Gle(n)){if("float32"!==r&&"int32"!==r)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return ce.backend.createTensorFromGPUData(n,t||e,r)}if(!ru(n)&&!Array.isArray(n)&&"number"!=typeof n&&"boolean"!=typeof n&&"string"!=typeof n)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){dc(t);const i=Ye(t),s=Ye(e);G(i===s,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${s}`);for(let o=0;o<e.length;++o){const l=e[o],c=o!==e.length-1||l!==Ye(t.slice(o));G(e[o]===t[o]||!c,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${t}). `)}}return!ru(n)&&!Array.isArray(n)&&(n=[n]),t=t||e,n="string"!==r?Gb(n,r):Wb(n,[],!0),ce.makeTensor(n,t,r)}function iu(n,t,e){return a_(n,t,s_(n,e),e)}const jb={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class rd{static join(t){return new rd(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,null==t||(t instanceof Array||(t=[t]),0===(t=t.map(r=>ru(r)?r.buffer:r)).length))return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let r=0;r<t.length;r++){const i=t[r];r!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=e+i.byteLength;this.shards.push({buffer:i,start:e,end:s}),e=s}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,e=this.byteLength){if(0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),(e=Math.min(this.byteLength,e))<=t)return new ArrayBuffer(0);const r=this.findShardForByte(t);if(-1===r)throw new Error(`Could not find start shard for byte ${t}`);const s=new ArrayBuffer(e-t),o=new Uint8Array(s);let l=0;for(let c=r;c<this.shards.length;c++){const u=this.shards[c],m=t+l-u.start,_=l,w=Math.min(e,u.end)-u.start,T=new Uint8Array(u.buffer,m,w-m);if(o.set(T,_),l+=T.length,e<u.end)break}return s}findShardForByte(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(i){return t<i.start?-1:t>=i.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;const r=function ELe(n,t){let e=0,r=n.length;for(;e<=r;){const i=Math.floor((r-e)/2)+e,s=t(n[i]);if(0===s)return i;s<0?r=i:e=i+1}return-1}(this.shards,e);return-1===r?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function _h(){return ce}function o8(){return ce.memory()}function Ie(n,t){return ce.tidy(n,t)}function Qn(n){jle(n).forEach(e=>e.dispose())}function Zs(n){return ce.keep(n)}function ALe(){return ce.backendName}function tce(n,t,e=1){return ce.registerBackend(n,t,e)}function nce(){return ce.backend}function a8(n,t){return l8.apply(this,arguments)}function l8(){return l8=(0,q.Z)(function*(n,t){const e=[],r=[],i=Array.isArray(n)?n.map(o=>o.name):Object.keys(n);for(let o=0;o<i.length;++o){const l=i[o],c=Array.isArray(n)?n[o].tensor:n[l];if("float32"!==c.dtype&&"int32"!==c.dtype&&"bool"!==c.dtype&&"string"!==c.dtype&&"complex64"!==c.dtype)throw new Error(`Unsupported dtype in weight '${l}': ${c.dtype}`);const u={name:l,shape:c.shape,dtype:c.dtype};if("string"===c.dtype){const f=new Promise(function(){var m=(0,q.Z)(function*(_){const y=yield c.bytes(),w=y.reduce((E,A)=>E+A.length,0)+4*y.length,T=new Uint8Array(w);let I=0;for(let E=0;E<y.length;E++){const A=y[E],M=new Uint8Array(new Uint32Array([A.length]).buffer);T.set(M,I),I+=4,T.set(A,I),I+=A.length}_(T)});return function(_){return m.apply(this,arguments)}}());r.push(f)}else r.push(c.data());null!=t&&(u.group=t),e.push(u)}return{data:MLe(yield Promise.all(r)),specs:e}}),l8.apply(this,arguments)}function rce(n,t){const e=new rd(n),r={};let i=0;for(const s of t){const o=NLe(s,(l,c)=>e.slice(i+l,i+c));r[s.name]=ice(s,e.slice(i,i+o)),i+=o}return r}function NLe(n,t){const e=Ye(n.shape);let r;if("quantization"in n)r=jb[n.quantization.dtype];else{if("string"===n.dtype){let i=0;for(let s=0;s<e;s++)i+=4+new Uint32Array(t(i,i+4))[0];return i}r=jb[n.dtype]}return e*r}function RLe(n,t){return c8.apply(this,arguments)}function c8(){return c8=(0,q.Z)(function*(n,t){const e=Ye(n.shape);let r;if("quantization"in n)r=jb[n.quantization.dtype];else{if("string"===n.dtype){let i=0;for(let s=0;s<e;s++)i+=4+new Uint32Array(yield t(i,i+4))[0];return i}r=jb[n.dtype]}return e*r}),c8.apply(this,arguments)}function ice(n,t){const e=n.name,r=n.dtype,i=n.shape,s=Ye(i);let o,l=0;if("quantization"in n){const c=n.quantization;if("uint8"===c.dtype||"uint16"===c.dtype){if(!("min"in c)||!("scale"in c))throw new Error(`Weight ${n.name} with quantization ${c.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==c.dtype)throw new Error(`Weight ${n.name} has unknown quantization dtype ${c.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==r)throw new Error(`Weight ${n.name} is quantized with ${c.dtype} which only supports weights of type float32 not ${r}.`)}const u=jb[c.dtype],f="uint8"===c.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===r)if("uint8"===c.dtype||"uint16"===c.dtype){o=new Float32Array(f.length);for(let m=0;m<f.length;m++)o[m]=f[m]*c.scale+c.min}else{if("float16"!==c.dtype)throw new Error(`Unsupported quantization type ${c.dtype} for weight type float32.`);o=function BLe(){const n=function PLe(){const n=e=>{let r=e<<13,i=0;for(;0==(8388608&r);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},t=new Uint32Array(2048);t[0]=0;for(let e=1;e<1024;e++)t[e]=n(e);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}(),t=function LLe(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let t=1;t<31;t++)n[t]=t<<23;for(let t=33;t<63;t++)n[t]=2147483648+(t-32<<23);return n}(),e=function $Le(){const n=new Uint32Array(64);for(let t=0;t<64;t++)n[t]=1024;return n[0]=n[32]=0,n}();return r=>{const i=new ArrayBuffer(4*r.length),s=new Uint32Array(i);for(let o=0;o<r.length;o++){const l=r[o];s[o]=n[e[l>>10]+(1023&l)]+t[l>>10]}return new Float32Array(i)}}()(f)}else{if("int32"!==r)throw new Error(`Unsupported dtype in weight '${e}': ${r}`);if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error(`Unsupported quantization type ${c.dtype} for weight type int32.`);o=new Int32Array(f.length);for(let m=0;m<f.length;m++)o[m]=Math.round(f[m]*c.scale+c.min)}l+=s*u}else if("string"===r){const c=Ye(n.shape);o=[];for(let u=0;u<c;u++){const f=new Uint32Array(t.slice(l,l+4))[0];l+=4;const m=new Uint8Array(t.slice(l,l+f));o.push(m),l+=f}}else{const c=jb[r];if("float32"===r)o=new Float32Array(t);else if("int32"===r)o=new Int32Array(t);else{if("bool"!==r){if("complex64"===r){o=new Float32Array(t);const u=new Float32Array(o.length/2),f=new Float32Array(o.length/2);for(let w=0;w<u.length;w++)u[w]=o[2*w],f[w]=o[2*w+1];const m=iu(u,i,"float32"),_=iu(f,i,"float32"),y=o_(m,_);return m.dispose(),_.dispose(),y}throw new Error(`Unsupported dtype in weight '${e}': ${r}`)}o=new Uint8Array(t)}l+=s*c}return iu(o,i,r)}function sce(n,t,e){return u8.apply(this,arguments)}function u8(){return u8=(0,q.Z)(function*(n,t,e){let r=new Uint8Array(t);for(;r.byteLength<e;){const{done:i,value:s}=yield n.read();if(i&&null==s)throw new Error(`Reader is done but ${e-r.byteLength} bytes are still expected`);const o=new Uint8Array(r.length+s.byteLength);o.set(r,0),o.set(new Uint8Array(s),r.length),r=o}return r.buffer}),u8.apply(this,arguments)}function oce(n,t){return d8.apply(this,arguments)}function d8(){return d8=(0,q.Z)(function*(n,t){const e={},r=n.getReader();let i=new ArrayBuffer(0);for(const s of t){const o=yield RLe(s,function(){var u=(0,q.Z)(function*(f,m){return i=yield sce(r,i,m),i.slice(f,m)});return function(f,m){return u.apply(this,arguments)}}());i=yield sce(r,i,o);const l=i.slice(0,o);i=i.slice(o);const c=ice(s,l);if(e[s.name]=c,"webgpu"===ALe()){const u=nce();"uploadToGPU"in u&&Ye(c.shape)>=Me().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(c.dataId)}}return e}),d8.apply(this,arguments)}function MLe(n){if(null===n)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let t=0;const e=[];n.forEach(s=>{if(t+=s.byteLength,e.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(t);let i=0;return e.forEach(s=>{r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}!function yLe(n){Hle=n}(function DLe(n){Me().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")});const h8=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function ace(n){return h8?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function lce(n){return rd.join(n)}function cce(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);const e=n.split("/");return e[e.length-1]}function uce(n,t){const e={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:t};return null!=n.signature&&(e.signature=n.signature),null!=n.userDefinedMetadata&&(e.userDefinedMetadata=n.userDefinedMetadata),null!=n.modelInitializer&&(e.modelInitializer=n.modelInitializer),null!=n.initializerSignature&&(e.initializerSignature=n.initializerSignature),null!=n.trainingConfig&&(e.trainingConfig=n.trainingConfig),e}function dce(n,t,e){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(null!=n.trainingConfig&&(r.trainingConfig=n.trainingConfig),null!=n.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!e)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=e}return null!=n.signature&&(r.signature=n.signature),null!=n.userDefinedMetadata&&(r.userDefinedMetadata=n.userDefinedMetadata),null!=n.modelInitializer&&(r.modelInitializer=n.modelInitializer),null!=n.initializerSignature&&(r.initializerSignature=n.initializerSignature),r}function f8(n,t){return p8.apply(this,arguments)}function p8(){return p8=(0,q.Z)(function*(n,t){let e,r;return null!=n.weightsManifest&&([e,r]=yield t(n.weightsManifest)),dce(n,e,r)}),p8.apply(this,arguments)}function zN(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==n.modelTopology?0:ace(JSON.stringify(n.modelTopology)),weightSpecsBytes:null==n.weightSpecs?0:ace(JSON.stringify(n.weightSpecs)),weightDataBytes:null==n.weightData?0:new rd(n.weightData).byteLength}}function m8(n){const t=[];for(const e of n)t.push(...e.weights);return t}class Fi{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Fi.instance&&(Fi.instance=new Fi),Fi.instance}static registerSaveRouter(t){Fi.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Fi.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Fi.getHandlers(t,"save")}static getLoadHandlers(t,e){return Fi.getHandlers(t,"load",e)}static getHandlers(t,e,r){const i=[];return("load"===e?Fi.getInstance().loadRouters:Fi.getInstance().saveRouters).forEach(o=>{const l=o(t,r);null!==l&&i.push(l)}),i}}const VLe=n=>Fi.registerSaveRouter(n),ULe=n=>Fi.registerLoadRouter(n),hce=n=>Fi.getSaveHandlers(n),zLe=(n,t)=>Fi.getLoadHandlers(n,t),vV="tensorflowjs",qb="models_store",c_="model_info_store";function y8(){if(!Me().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function v8(n){const t=n.result;t.createObjectStore(qb,{keyPath:"modelPath"}),t.createObjectStore(c_,{keyPath:"modelPath"})}let iT=(()=>{class n{constructor(e){if(this.indexedDB=y8(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}save(e){var r=this;return(0,q.Z)(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return r.databaseAction(r.modelPath,e)})()}load(){var e=this;return(0,q.Z)(function*(){return e.databaseAction(e.modelPath)})()}databaseAction(e,r){return new Promise((i,s)=>{const o=this.indexedDB.open(vV,1);o.onupgradeneeded=()=>v8(o),o.onsuccess=()=>{const l=o.result;if(null==r){const c=l.transaction(qb,"readonly"),f=c.objectStore(qb).get(this.modelPath);f.onsuccess=()=>{if(null==f.result)return l.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));i(f.result.modelArtifacts)},f.onerror=m=>(l.close(),s(f.error)),c.oncomplete=()=>l.close()}else{r.weightData=rd.join(r.weightData);const c=zN(r),u=l.transaction(c_,"readwrite");let m,_,f=u.objectStore(c_);try{m=f.put({modelPath:this.modelPath,modelArtifactsInfo:c})}catch(y){return s(y)}m.onsuccess=()=>{_=l.transaction(qb,"readwrite");const y=_.objectStore(qb);let w;try{w=y.put({modelPath:this.modelPath,modelArtifacts:r,modelArtifactsInfo:c})}catch(T){return s(T)}w.onsuccess=()=>i({modelArtifactsInfo:c}),w.onerror=T=>{f=u.objectStore(c_);const I=f.delete(this.modelPath);I.onsuccess=()=>(l.close(),s(w.error)),I.onerror=E=>(l.close(),s(w.error))}},m.onerror=y=>(l.close(),s(m.error)),u.oncomplete=()=>{null==_?l.close():_.oncomplete=()=>l.close()}}},o.onerror=l=>s(o.error)})}}return n.URL_SCHEME="indexeddb://",n})();const fce=n=>Me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(iT.URL_SCHEME)?function HLe(n){return new iT(n)}(n.slice(iT.URL_SCHEME.length)):null;Fi.registerSaveRouter(fce),Fi.registerLoadRouter(fce);class WLe{constructor(){this.indexedDB=y8()}listModels(){var t=this;return(0,q.Z)(function*(){return new Promise((e,r)=>{const i=t.indexedDB.open(vV,1);i.onupgradeneeded=()=>v8(i),i.onsuccess=()=>{const s=i.result,o=s.transaction(c_,"readonly"),c=o.objectStore(c_).getAll();c.onsuccess=()=>{const u={};for(const f of c.result)u[f.modelPath]=f.modelArtifactsInfo;e(u)},c.onerror=u=>(s.close(),r(c.error)),o.oncomplete=()=>s.close()},i.onerror=s=>r(i.error)})})()}removeModel(t){var e=this;return(0,q.Z)(function*(){return t=function GLe(n){return n.startsWith(iT.URL_SCHEME)?n.slice(iT.URL_SCHEME.length):n}(t),new Promise((r,i)=>{const s=e.indexedDB.open(vV,1);s.onupgradeneeded=()=>v8(s),s.onsuccess=()=>{const o=s.result,l=o.transaction(c_,"readwrite"),c=l.objectStore(c_),u=c.get(t);let f;u.onsuccess=()=>{if(null==u.result)return o.close(),i(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const m=c.delete(t),_=()=>{f=o.transaction(qb,"readwrite");const w=f.objectStore(qb).delete(t);w.onsuccess=()=>r(u.result.modelArtifactsInfo),w.onerror=T=>i(u.error)};m.onsuccess=_,m.onerror=y=>(_(),o.close(),i(u.error))}},u.onerror=m=>(o.close(),i(u.error)),l.oncomplete=()=>{null==f?o.close():f.oncomplete=()=>o.close()}},s.onerror=o=>i(s.error)})})()}}const yh="/",Zb="tensorflowjs_models",pce="info",jLe="model_topology",qLe="weight_specs",ZLe="weight_data",YLe="model_metadata";function mce(n){return{info:[Zb,n,pce].join(yh),topology:[Zb,n,jLe].join(yh),weightSpecs:[Zb,n,qLe].join(yh),weightData:[Zb,n,ZLe].join(yh),modelMetadata:[Zb,n,YLe].join(yh)}}function gce(n){for(const t of Object.values(n))window.localStorage.removeItem(t)}function _ce(n){const t=n.split(yh);if(t.length<3)throw new Error(`Invalid key format: ${n}`);return t.slice(1,t.length-1).join(yh)}let sT=(()=>{class n{constructor(e){if(!Me().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=mce(this.modelPath)}save(e){var r=this;return(0,q.Z)(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const i=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),o=zN(e),l=rd.join(e.weightData);try{return r.LS.setItem(r.keys.info,JSON.stringify(o)),r.LS.setItem(r.keys.topology,i),r.LS.setItem(r.keys.weightSpecs,s),r.LS.setItem(r.keys.weightData,function OLe(n){if(h8)return Buffer.from(n).toString("base64");const t=new Uint8Array(n);let e="";for(let r=0,i=t.length;r<i;r++)e+=String.fromCharCode(t[r]);return btoa(e)}(l)),r.LS.setItem(r.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0})),{modelArtifactsInfo:o}}catch{throw gce(r.keys),new Error(`Failed to save model '${r.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}})()}load(){var e=this;return(0,q.Z)(function*(){const r=JSON.parse(e.LS.getItem(e.keys.info));if(null==r)throw new Error(`In local storage, there is no model with name '${e.modelPath}'`);if("JSON"!==r.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const i={},s=JSON.parse(e.LS.getItem(e.keys.topology));if(null==s)throw new Error(`In local storage, the topology of model '${e.modelPath}' is missing.`);i.modelTopology=s;const o=JSON.parse(e.LS.getItem(e.keys.weightSpecs));if(null==o)throw new Error(`In local storage, the weight specs of model '${e.modelPath}' are missing.`);i.weightSpecs=o;const l=e.LS.getItem(e.keys.modelMetadata);if(null!=l){const u=JSON.parse(l);i.format=u.format,i.generatedBy=u.generatedBy,i.convertedBy=u.convertedBy,null!=u.signature&&(i.signature=u.signature),null!=u.userDefinedMetadata&&(i.userDefinedMetadata=u.userDefinedMetadata),null!=u.modelInitializer&&(i.modelInitializer=u.modelInitializer),null!=u.initializerSignature&&(i.initializerSignature=u.initializerSignature),null!=u.trainingConfig&&(i.trainingConfig=u.trainingConfig)}const c=e.LS.getItem(e.keys.weightData);if(null==c)throw new Error(`In local storage, the binary weight values of model '${e.modelPath}' are missing.`);return i.weightData=function FLe(n){if(h8){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const t=atob(n),e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e.set([t.charCodeAt(r)],r);return e.buffer}(c),i})()}}return n.URL_SCHEME="localstorage://",n})();const yce=n=>Me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(sT.URL_SCHEME)?function QLe(n){return new sT(n)}(n.slice(sT.URL_SCHEME.length)):null;Fi.registerSaveRouter(yce),Fi.registerLoadRouter(yce);class XLe{constructor(){G(Me().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),G(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){var t=this;return(0,q.Z)(function*(){const e={},r=Zb+yh,i=yh+pce;for(let s=0;s<t.LS.length;++s){const o=t.LS.key(s);o.startsWith(r)&&o.endsWith(i)&&(e[_ce(o)]=JSON.parse(t.LS.getItem(o)))}return e})()}removeModel(t){var e=this;return(0,q.Z)(function*(){t=function KLe(n){return n.startsWith(sT.URL_SCHEME)?n.slice(sT.URL_SCHEME.length):n}(t);const r=mce(t);if(null==e.LS.getItem(r.info))throw new Error(`Cannot find model at path '${t}'`);const i=JSON.parse(e.LS.getItem(r.info));return gce(r),i})()}}const oT="://";class va{constructor(){this.managers={}}static getInstance(){return null==va.instance&&(va.instance=new va),va.instance}static registerManager(t,e){G(null!=t,()=>"scheme must not be undefined or null."),t.endsWith(oT)&&(t=t.slice(0,t.indexOf(oT))),G(t.length>0,()=>"scheme must not be an empty string.");const r=va.getInstance();G(null==r.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=e}static getManager(t){const e=va.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(va.getInstance().managers)}}function bV(n){if(-1===n.indexOf(oT))throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${va.getSchemes().join(",")}`);return{scheme:n.split(oT)[0],path:n.split(oT)[1]}}function vce(n,t){return b8.apply(this,arguments)}function b8(){return b8=(0,q.Z)(function*(n,t,e=!1){G(n!==t,()=>`Old path and new path are the same: '${n}'`);const r=Fi.getLoadHandlers(n);G(r.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),G(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${n}.`);const i=r[0],s=Fi.getSaveHandlers(t);G(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),G(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);const o=s[0],l=bV(n).scheme,c=bV(n).path,u=l===bV(n).scheme,f=yield i.load();e&&u&&(yield va.getManager(l).removeModel(c));const m=yield o.save(f);return e&&!u&&(yield va.getManager(l).removeModel(c)),m.modelArtifactsInfo}),b8.apply(this,arguments)}function JLe(){return w8.apply(this,arguments)}function w8(){return w8=(0,q.Z)(function*(){const n=va.getSchemes(),t={};for(const e of n){const r=yield va.getManager(e).listModels();for(const i in r)t[e+oT+i]=r[i]}return t}),w8.apply(this,arguments)}function e$e(n){return C8.apply(this,arguments)}function C8(){return C8=(0,q.Z)(function*(n){const t=bV(n);return va.getManager(t.scheme).removeModel(t.path)}),C8.apply(this,arguments)}function t$e(n,t){return x8.apply(this,arguments)}function x8(){return x8=(0,q.Z)(function*(n,t){return vce(n,t,!1)}),x8.apply(this,arguments)}function n$e(n,t){return I8.apply(this,arguments)}function I8(){return I8=(0,q.Z)(function*(n,t){return vce(n,t,!0)}),I8.apply(this,arguments)}class r$e{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){typeof window>"u"||!Me().getBool("USE_SETTIMEOUTCUSTOM")?setTimeout(t,e):(this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{r.source===window&&r.data.name===this.messageName&&(r.stopPropagation(),(0,this.functionRefs[r.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))},!0)))}isTypedArray(t){return Ple(t)}}if(Me().get("IS_BROWSER")){Me().setPlatform("browser",new r$e);try{va.registerManager(sT.URL_SCHEME,new XLe)}catch{}try{va.registerManager(iT.URL_SCHEME,new WLe)}catch{}}let aT;function qn(n,t="float32",e){return t=t||"float32",dc(n),new Ds(n,t,e)}Me().get("IS_NODE")&&!Me().get("IS_BROWSER")&&Me().setPlatform("node",new class s$e{constructor(){this.util=z(8628),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=Me().global.fetch?Me().global.fetch(t,e):(null==aT&&(aT=z(5410)),aT(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}});const Pt=se({cast_:function o$e(n,t){const e=j(n,"x","cast");if(!function z2e(n){return"bool"===n||"complex64"===n||"float32"===n||"int32"===n||"string"===n}(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==e.dtype||"string"!==t&&"string"===e.dtype)throw new Error("Only strings can be casted to strings");return ce.runKernel(K1,{x:e},{dtype:t})}}),pp=se({clone_:function a$e(n){const e={x:j(n,"x","clone","string_or_numeric")};return ce.runKernel(cN,e)}});function bce(n,t=!1){console.log(n.toString(t))}Yle(),function _Le(n){rT=n}({buffer:qn,cast:Pt,clone:pp,print:bce});const dt=se({add_:function l$e(n,t){let e=j(n,"a","add"),r=j(t,"b","add");return[e,r]=Hi(e,r),ce.runKernel(eT,{a:e,b:r})}}),T8=se({floorDiv_:function c$e(n,t){let e=j(n,"a","floorDiv"),r=j(t,"b","floorDiv");return[e,r]=Hi(e,r),ce.runKernel(aN,{a:e,b:r})}}),ln=se({div_:function u$e(n,t){let e=j(n,"a","div"),r=j(t,"b","div");return[e,r]=Hi(e,r),"int32"===e.dtype&&"int32"===r.dtype?T8(e,r):ce.runKernel(tN,{a:e,b:r},{})}}),ue=se({mul_:function d$e(n,t){let e=j(n,"a","mul"),r=j(t,"b","mul");return[e,r]=Hi(e,r),ce.runKernel(yN,{a:e,b:r})}}),bo=se({sqrt_:function h$e(n){const e={x:j(n,"x","sqrt","float32")};return ce.runKernel(NN,e)}}),Xr=se({square_:function f$e(n){const t=j(n,"x","square");return ce.runKernel("Square",{x:t},{})}}),gr=se({zerosLike_:function p$e(n){const e={x:j(n,"x","zerosLike")};return ce.runKernel(sV,e)}});function mp(n){return ce.customGrad(n)}function gn(n,t){if((ru(n)&&"string"!==t||Array.isArray(n))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&ru(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return a_(n,[],[],t)}const g$e=new Map,S8=new Map;class lT{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class su{constructor(){this.classNameMap={}}static getMap(){return null==su.instance&&(su.instance=new su),su.instance}static register(t){su.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function pt(n,t,e){G(null!=n.className,()=>"Class being registered does not have the static className property defined."),G("string"==typeof n.className,()=>"className is required to be a string, but got type "+typeof n.className),G(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof e>"u"&&(e=n.className);const i=t+">"+e;return su.register(n),g$e.set(i,n),S8.set(n,i),n}class u_ extends lT{minimize(t,e=!1,r){const{value:i,grads:s}=this.computeGradients(t,r);if(null!=r){const o=r.map(l=>({name:l.name,tensor:s[l.name]}));this.applyGradients(o)}else this.applyGradients(s);return Qn(s),e?i:(i.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return function m$e(n,t){G(B5(n),()=>"The f passed in variableGrads(f) must be a function"),G(null==t||Array.isArray(t)&&t.every(u=>u instanceof fV),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const e=null!=t;if(!e){t=[];for(const u in ce.registeredVariables)t.push(ce.registeredVariables[u])}const r=e?t.filter(u=>!u.trainable):null,i=t.length;G((t=t.filter(u=>u.trainable)).length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const{value:o,grads:l}=ce.gradients(n,t,null,!0);G(l.some(u=>null!=u),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),G(0===o.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const c={};return t.forEach((u,f)=>{null!=l[f]&&(c[u.name]=l[f])}),r?.forEach(u=>c[u.name]=null),{value:o,grads:c}}(t,e)}dispose(){null!=this.iterations_&&Qn(this.iterations_)}saveIterations(){var t=this;return(0,q.Z)(function*(){return null==t.iterations_&&(t.iterations_=0),{name:"iter",tensor:gn(t.iterations_,"int32")}})()}getWeights(){return(0,q.Z)(function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})()}setWeights(t){var e=this;return(0,q.Z)(function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${e.getClassName()}`)})()}extractIterations(t){var e=this;return(0,q.Z)(function*(){return e.iterations_=(yield t[0].tensor.data())[0],t.slice(1)})()}}Object.defineProperty(u_,Symbol.hasInstance,{value:n=>null!=n.minimize&&null!=n.computeGradients&&null!=n.applyGradients});class wce extends u_{static get className(){return"Adadelta"}constructor(t,e,r=null){super(),this.learningRate=t,this.rho=e,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==r&&(this.epsilon=ce.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=ce.registeredVariables[r];null==this.accumulatedGrads[i]&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:Ie(()=>gr(s).variable(!1))}),null==this.accumulatedUpdates[i]&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:Ie(()=>gr(s).variable(!1))});const l=Array.isArray(t)?t[i].tensor:t[r];if(null==l)return;const c=this.accumulatedGrads[i].variable,u=this.accumulatedUpdates[i].variable;Ie(()=>{const f=dt(ue(c,this.rho),ue(Xr(l),1-this.rho)),m=ue(ln(bo(dt(u,this.epsilon)),bo(dt(c,this.epsilon))),l),_=dt(ue(u,this.rho),ue(Xr(m),1-this.rho));c.assign(f),u.assign(_);const y=dt(ue(m,-this.learningRate),s);s.assign(y)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Qn(this.accumulatedGrads.map(t=>t.variable)),Qn(this.accumulatedUpdates.map(t=>t.variable)))}getWeights(){var t=this;return(0,q.Z)(function*(){const e=[...t.accumulatedGrads,...t.accumulatedUpdates];return[yield t.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})()}setWeights(t){var e=this;return(0,q.Z)(function*(){const r=(t=yield e.extractIterations(t)).length/2;e.accumulatedGrads=t.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(!1)})),e.accumulatedUpdates=t.slice(r,2*r).map(s=>({originalName:s.name,variable:s.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}function cT(n,t,e){return dc(n),e=e||XI(t),ce.runKernel(fZ,{},{shape:n,value:t,dtype:e})}class Cce extends u_{static get className(){return"Adagrad"}constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=ce.registeredVariables[r];null==this.accumulatedGrads[i]&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:Ie(()=>cT(s.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(t)?t[i].tensor:t[r];if(null==o)return;const l=this.accumulatedGrads[i].variable;Ie(()=>{const c=dt(l,Xr(o));l.assign(c);const u=dt(ue(ln(o,bo(dt(c,ce.backend.epsilon()))),-this.learningRate),s);s.assign(u)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Qn(this.accumulatedGrads.map(t=>t.variable))}getWeights(){var t=this;return(0,q.Z)(function*(){return[yield t.saveIterations()].concat(t.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))})()}setWeights(t){var e=this;return(0,q.Z)(function*(){t=yield e.extractIterations(t),e.accumulatedGrads=t.map(i=>({originalName:i.name,variable:i.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}const gp=se({pow_:function _$e(n,t){let e=j(n,"base","pow"),r=j(t,"exp","pow");return[e,r]=Hi(e,r),ce.runKernel(vN,{a:e,b:r})}}),Kt=se({sub_:function y$e(n,t){let e=j(n,"a","sub"),r=j(t,"b","sub");return[e,r]=Hi(e,r),ce.runKernel(MN,{a:e,b:r})}});class xce extends u_{static get className(){return"Adam"}constructor(t,e,r,i=null){super(),this.learningRate=t,this.beta1=e,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ie(()=>{this.accBeta1=gn(e).variable(),this.accBeta2=gn(r).variable()}),null==i&&(this.epsilon=ce.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);Ie(()=>{const r=Kt(1,this.accBeta1),i=Kt(1,this.accBeta2);e.forEach((s,o)=>{const l=ce.registeredVariables[s];null==this.accumulatedFirstMoment[o]&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:Ie(()=>gr(l).variable(!1))}),null==this.accumulatedSecondMoment[o]&&(this.accumulatedSecondMoment[o]={originalName:`${s}/v`,variable:Ie(()=>gr(l).variable(!1))});const u=Array.isArray(t)?t[o].tensor:t[s];if(null==u)return;const f=this.accumulatedFirstMoment[o].variable,m=this.accumulatedSecondMoment[o].variable,_=dt(ue(f,this.beta1),ue(u,1-this.beta1)),y=dt(ue(m,this.beta2),ue(Xr(u),1-this.beta2)),w=ln(_,r),T=ln(y,i);f.assign(_),m.assign(y);const I=dt(ue(ln(w,dt(bo(T),this.epsilon)),-this.learningRate),l);l.assign(I)}),this.accBeta1.assign(ue(this.accBeta1,this.beta1)),this.accBeta2.assign(ue(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Qn(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&Qn(this.accumulatedSecondMoment.map(t=>t.variable))}getWeights(){var t=this;return(0,q.Z)(function*(){const e=[...t.accumulatedFirstMoment,...t.accumulatedSecondMoment];return[yield t.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})()}setWeights(t){var e=this;return(0,q.Z)(function*(){t=yield e.extractIterations(t),Ie(()=>{e.accBeta1.assign(gp(e.beta1,e.iterations_+1)),e.accBeta2.assign(gp(e.beta2,e.iterations_+1))});const r=t.length/2;e.accumulatedFirstMoment=t.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(!1)})),e.accumulatedSecondMoment=t.slice(r,2*r).map(s=>({originalName:s.name,variable:s.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}const ks=se({abs_:function v$e(n){const t=j(n,"x","abs");return ce.runKernel("complex64"===t.dtype?hB:rB,{x:t})}});function uT(n,t){const e=n.length,r=[];for(let i=0;i<e;i++){const s=e-1-i,o=n[s]||1;(t[t.length-1-i]||1)>1&&1===o&&r.unshift(s)}return r}function As(n,t){const e=[];for(let r=0;r<t.length;r++){const i=n[n.length-r-1],s=t.length-r-1,o=t[s];(null==i||1===i&&o>1)&&e.unshift(s)}return e}function Bn(n,t){const e=Math.max(n.length,t.length),r=new Array(e);for(let i=0;i<e;i++){let s=n[n.length-i-1];null==s&&(s=1);let o=t[t.length-i-1];if(null==o&&(o=1),1===s)r[e-i-1]=o;else if(1===o)r[e-i-1]=s;else{if(s!==o)throw Error(`Operands could not be broadcast together with shapes ${n} and ${t}.`);r[e-i-1]=s}}return r}const _p=se({maximum_:function b$e(n,t){let e=j(n,"a","maximum"),r=j(t,"b","maximum");return[e,r]=Hi(e,r),"bool"===e.dtype&&(e=Pt(e,"int32"),r=Pt(r,"int32")),Bn(e.shape,r.shape),ce.runKernel(mN,{a:e,b:r})}});class Ice extends u_{static get className(){return"Adamax"}constructor(t,e,r,i=null,s=0){super(),this.learningRate=t,this.beta1=e,this.beta2=r,this.epsilon=i,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ie(()=>{this.iteration=gn(0).variable(),this.accBeta1=gn(e).variable()}),null==i&&(this.epsilon=ce.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);Ie(()=>{const r=Kt(1,this.accBeta1),i=ln(-this.learningRate,dt(ue(this.iteration,this.decay),1));e.forEach((s,o)=>{const l=ce.registeredVariables[s];null==this.accumulatedFirstMoment[o]&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:gr(l).variable(!1)}),null==this.accumulatedWeightedInfNorm[o]&&(this.accumulatedWeightedInfNorm[o]={originalName:`${s}/v`,variable:gr(l).variable(!1)});const u=Array.isArray(t)?t[o].tensor:t[s];if(null==u)return;const f=this.accumulatedFirstMoment[o].variable,m=this.accumulatedWeightedInfNorm[o].variable,_=dt(ue(f,this.beta1),ue(u,1-this.beta1)),y=ue(m,this.beta2),w=ks(u),T=_p(y,w);f.assign(_),m.assign(T);const I=dt(ue(ln(i,r),ln(_,dt(T,this.epsilon))),l);l.assign(I)}),this.iteration.assign(dt(this.iteration,1)),this.accBeta1.assign(ue(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Qn(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&Qn(this.accumulatedWeightedInfNorm.map(t=>t.variable))}getWeights(){return(0,q.Z)(function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})()}setWeights(t){return(0,q.Z)(function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})()}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}class E8 extends u_{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Array.isArray(t)?t[i].tensor:t[r];if(null==s)return;const o=ce.registeredVariables[r];Ie(()=>{const l=dt(ue(this.c,s),o);o.assign(l)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Zs(gn(-t))}dispose(){this.c.dispose()}getWeights(){var t=this;return(0,q.Z)(function*(){return[yield t.saveIterations()]})()}setWeights(t){var e=this;return(0,q.Z)(function*(){if(0!==(t=yield e.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")})()}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}class Tce extends E8{static get className(){return"Momentum"}constructor(t,e,r=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=r,this.accumulations=[],this.m=gn(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=ce.registeredVariables[r];null==this.accumulations[i]&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:Ie(()=>gr(s).variable(!1))});const o=this.accumulations[i].variable,l=Array.isArray(t)?t[i].tensor:t[r];null!=l&&Ie(()=>{let c;const u=dt(ue(this.m,o),l);c=dt(ue(this.c,this.useNesterov?dt(l,ue(u,this.m)):u),s),o.assign(u),s.assign(c)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Qn(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}getWeights(){var t=this;return(0,q.Z)(function*(){return[yield t.saveIterations()].concat(t.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))})()}setWeights(t){var e=this;return(0,q.Z)(function*(){t=yield e.extractIterations(t),e.accumulations=t.map(i=>({originalName:i.name,variable:i.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}class Sce extends u_{static get className(){return"RMSProp"}constructor(t,e=.9,r=0,i=null,s=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,null==i&&(this.epsilon=ce.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=ce.registeredVariables[r],o=!1;null==this.accumulatedMeanSquares[i]&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:Ie(()=>gr(s).variable(o))}),null==this.accumulatedMoments[i]&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:Ie(()=>gr(s).variable(o))}),null==this.accumulatedMeanGrads[i]&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:Ie(()=>gr(s).variable(o))});const l=Array.isArray(t)?t[i].tensor:t[r];if(null==l)return;const c=this.accumulatedMeanSquares[i].variable,u=this.accumulatedMoments[i].variable;Ie(()=>{const f=dt(ue(c,this.decay),ue(Xr(l),1-this.decay));if(this.centered){const m=this.accumulatedMeanGrads[i].variable,_=dt(ue(m,this.decay),ue(l,1-this.decay)),y=ln(ue(l,this.learningRate),bo(Kt(f,dt(Xr(_),this.epsilon)))),w=dt(ue(u,this.momentum),y);c.assign(f),m.assign(_),u.assign(w);const T=Kt(s,w);s.assign(T)}else{const m=dt(ue(c,this.decay),ue(Xr(l),1-this.decay)),_=dt(ue(u,this.momentum),ln(ue(l,this.learningRate),bo(dt(m,this.epsilon))));c.assign(m),u.assign(_);const y=Kt(s,_);s.assign(y)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Qn(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&Qn(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&Qn(this.accumulatedMoments.map(t=>t.variable))}getWeights(){var t=this;return(0,q.Z)(function*(){const e=[...t.accumulatedMeanSquares,...t.accumulatedMoments];return t.centered&&e.push(...t.accumulatedMeanGrads),[yield t.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})()}setWeights(t){var e=this;return(0,q.Z)(function*(){t=yield e.extractIterations(t);const r=e.centered?t.length/3:t.length/2,i=!1;e.accumulatedMeanSquares=t.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(i)})),e.accumulatedMoments=t.slice(r,2*r).map(s=>({originalName:s.name,variable:s.tensor.variable(i)})),e.centered&&(e.accumulatedMeanGrads=t.slice(2*r,3*r).map(s=>({originalName:s.name,variable:s.tensor.variable(i)})))})()}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}const w$e=[wce,Cce,xce,Ice,Tce,Sce,E8];function Ece(n){return new Promise(t=>setTimeout(t)).then(n)}let D8=(()=>{class n{constructor(e){if(!Me().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),(null==e||0===e.length)&&(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}save(e){var r=this;return(0,q.Z)(function*(){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const i=rd.join(e.weightData),s=window.URL.createObjectURL(new Blob([i],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const l=uce(e,[{paths:["./"+r.weightDataFileName],weights:e.weightSpecs}]),c=window.URL.createObjectURL(new Blob([JSON.stringify(l)],{type:"application/json"})),u=r.modelJsonAnchor??document.createElement("a");if(u.download=r.modelJsonFileName,u.href=c,yield Ece(()=>u.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){const f=r.weightDataAnchor??document.createElement("a");f.download=r.weightDataFileName,f.href=s,yield Ece(()=>f.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:zN(e)}}})()}}return n.URL_SCHEME="downloads://",n})();class S$e{constructor(t){if(null==t||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}load(){var t=this;return(0,q.Z)(function*(){return new Promise((e,r)=>{const i=new FileReader;i.onload=s=>{const o=JSON.parse(s.target.result),l=o.modelTopology;if(null==l)return void r(new Error(`modelTopology field is missing from file ${t.jsonFile.name}`));if(null==o.weightsManifest)return void r(new Error(`weightManifest field is missing from file ${t.jsonFile.name}`));if(0===t.weightsFiles.length)return void e({modelTopology:l});const u=f8(o,f=>t.loadWeights(f));e(u)},i.onerror=s=>r(`Failed to read model topology and weights manifest JSON from file '${t.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),i.readAsText(t.jsonFile)})})()}loadWeights(t){const e=[],r=[];for(const o of t)e.push(...o.weights),r.push(...o.paths);const i=this.checkManifestAndWeightFiles(t),s=r.map(o=>this.loadWeightsFile(o,i[o]));return Promise.all(s).then(o=>[e,o])}loadWeightsFile(t,e){return new Promise((r,i)=>{const s=new FileReader;s.onload=o=>{r(o.target.result)},s.onerror=o=>i(`Failed to weights data from file of path '${t}'.`),s.readAsArrayBuffer(e)})}checkManifestAndWeightFiles(t){const e=[],r=this.weightsFiles.map(s=>cce(s.name)),i={};for(const s of t)s.paths.forEach(o=>{const l=cce(o);if(-1!==e.indexOf(l))throw new Error(`Duplicate file basename found in weights manifest: '${l}'`);if(e.push(l),-1===r.indexOf(l))throw new Error(`Weight file with basename '${l}' is not provided.`);i[o]=this.weightsFiles[r.indexOf(l)]});if(e.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${e.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}function k$e(n){return new S$e(n)}function Dce(n,t,e,r){(function o(c){G(null!=c&&Array.isArray(c)&&c.length>0,()=>"promises must be a none empty array")})(n),function l(c,u){G(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${c}`),G(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),G(u>=c,()=>`startFraction must be no more than endFraction, but got startFraction ${c} and endFraction ${u}`)}(e=e??0,r=r??1);let i=0;return Promise.all(n.map(c=>(c.then(u=>{const f=e+ ++i/n.length*(r-e);return t(f),u}),c)))}function kce(n,t){return k8.apply(this,arguments)}function k8(){return k8=(0,q.Z)(function*(n,t){null==t&&(t={});const e=t.fetchFunc??Me().platform.fetch,r=n.map(m=>e(m,t.requestInit,{isBinary:!0})),l=(null==t.onProgress?yield Promise.all(r):yield Dce(r,t.onProgress,0,.5)).map(m=>m.arrayBuffer());return null==t.onProgress?yield Promise.all(l):yield Dce(l,t.onProgress,.5,1)}),k8.apply(this,arguments)}function N$e(n){return A8.apply(this,arguments)}function A8(){return A8=(0,q.Z)(function*(n,t="",e,r){return Ace(o=>kce(o,{requestInit:r}))(n,t,e)}),A8.apply(this,arguments)}function Ace(n){return function(){var t=(0,q.Z)(function*(e,r="",i){const s=e.map(()=>!1),o={},l=null!=i?i.map(()=>!1):[],c=[];if(e.forEach((w,T)=>{let I=0;w.weights.forEach(E=>{const M=jb["quantization"in E?E.quantization.dtype:E.dtype]*Ye(E.shape),O=()=>{s[T]=!0,null==o[T]&&(o[T]=[]),o[T].push({manifestEntry:E,groupOffset:I,sizeBytes:M})};null!=i?i.forEach(($,V)=>{$===E.name&&(O(),l[V]=!0)}):O(),c.push(E.name),I+=M})}),!l.every(w=>w)){const w=i.filter((T,I)=>!l[I]);throw new Error(`Could not find weights in manifest with names: ${w.join(", ")}. \nManifest JSON has weights with names: ${c.join(", ")}.`)}const u=s.reduce((w,T,I)=>(T&&w.push(I),w),[]),f=[];u.forEach(w=>{e[w].paths.forEach(T=>{const I=r+(r.endsWith("/")?"":"/")+T;f.push(I)})});const m=yield n(f),_={};let y=0;return u.forEach(w=>{const T=e[w].paths.length,I=new rd(m.slice(y,y+T));o[w].forEach(A=>{const O=rce(I.slice(A.groupOffset,A.groupOffset+A.sizeBytes),[A.manifestEntry]);for(const $ in O)_[$]=O[$]}),y+=T}),_});return function(e){return t.apply(this,arguments)}}()}Fi.registerSaveRouter(n=>Me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(D8.URL_SCHEME)?function D$e(n="model"){return new D8(n)}(n.slice(D8.URL_SCHEME.length)):null);let Nce=(()=>{class n{constructor(e,r){if(this.DEFAULT_METHOD="POST",null==r&&(r={}),this.weightPathPrefix=r.weightPathPrefix,this.weightUrlConverter=r.weightUrlConverter,null!=r.fetchFunc?(G("function"==typeof r.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=r.fetchFunc):this.fetch=Me().platform.fetch,G(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&G(2===e.length,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,null!=r.requestInit&&null!=r.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=r.requestInit||{},this.loadOptions=r}save(e){var r=this;return(0,q.Z)(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const i=Object.assign({method:r.DEFAULT_METHOD},r.requestInit);i.body=new FormData;const o=uce(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(i.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),null!=e.weightData){const c=rd.join(e.weightData);i.body.append("model.weights.bin",new Blob([c],{type:"application/octet-stream"}),"model.weights.bin")}const l=yield r.fetch(r.path,i);if(l.ok)return{modelArtifactsInfo:zN(e),responses:[l]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${l.status}.`)})()}loadModelJSON(){var e=this;return(0,q.Z)(function*(){const r=yield e.fetch(e.path,e.requestInit);if(!r.ok)throw new Error(`Request to ${e.path} failed with status code ${r.status}. Please verify this URL points to the model JSON of the model to load.`);let i;try{i=yield r.json()}catch{let c=`Failed to parse model JSON of response from ${e.path}.`;throw e.path.endsWith(".pb")?c+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":c+=" Please make sure the server is serving valid JSON for this request.",new Error(c)}if(null==i.modelTopology&&null==i.weightsManifest)throw new Error(`The JSON from HTTP path ${e.path} contains neither model topology or manifest for weights.`);return i})()}load(){var e=this;return(0,q.Z)(function*(){return e.loadOptions.streamWeights?e.loadStream():f8(yield e.loadModelJSON(),i=>e.loadWeights(i))})()}loadStream(){var e=this;return(0,q.Z)(function*(){const r=yield e.loadModelJSON(),i=yield e.getWeightUrls(r.weightsManifest),s=m8(r.weightsManifest);return Object.assign(Object.assign({},r),{weightSpecs:s,getWeightStream:()=>function A$e(n,t){var e;const r=t.fetchFunc??Me().platform.fetch;let s,i=0;return null===(e=t.onProgress)||void 0===e||e.call(t,0),new ReadableStream({pull:(o=(0,q.Z)(function*(l){for(var c;i<n.length;){s||(s=(yield r(n[i],t.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:f}=yield s.read();if(!u)return void l.enqueue(f);i++,s=void 0,null===(c=t.onProgress)||void 0===c||c.call(t,i/n.length)}l.close()}),function(c){return o.apply(this,arguments)})});var o}(i,e.loadOptions)})})()}getWeightUrls(e){var r=this;return(0,q.Z)(function*(){const i=Array.isArray(r.path)?r.path[1]:r.path,[s,o]=function O$e(n){const t=n.lastIndexOf("/"),e=n.lastIndexOf("?");return[n.substring(0,t)+"/",e>t?n.substring(e):""]}(i),l=r.weightPathPrefix||s,c=[],u=[];for(const f of e)for(const m of f.paths)null!=r.weightUrlConverter?u.push(r.weightUrlConverter(m)):c.push(l+m+o);return r.weightUrlConverter&&c.push(...yield Promise.all(u)),c})()}loadWeights(e){var r=this;return(0,q.Z)(function*(){const i=yield r.getWeightUrls(e);return[m8(e),yield kce(i,r.loadOptions)]})()}}return n.URL_SCHEME_REGEX=/^https?:\/\//,n})();function N8(n){return null!=n.match(Nce.URL_SCHEME_REGEX)}const Rce=(n,t)=>{if(typeof fetch>"u"&&(null==t||null==t.fetchFunc))return null;{let e=!0;if(e=Array.isArray(n)?n.every(r=>N8(r)):N8(n),e)return R8(n,t)}return null};function R8(n,t){return new Nce(n,t)}function F$e(n,t){return R8(n,t)}Fi.registerSaveRouter(Rce),Fi.registerLoadRouter(Rce);class M8{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class Mce{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class P$e{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function L$e(n,t,e,r){const i=arguments;return new P$e(Oce(...i))}function Oce(n,t,e,r){return 1===arguments.length?null!=n.modelTopology||null!=n.weightSpecs?new M8(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new M8({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new M8({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:r}))}function $$e(n){return new Mce(n)}function B$e(n){return new Mce(n)}function Fce(n,t,e){if(YI(n),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const r=s_(n,e);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return a_(n,t,r,e)}let Yb;const W$e=se({fromPixels_:function Lce(n,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==n)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let e=!1,r=!1,i=!1,s=!1,o=!1,l=!1;if(n.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)s=!0;else if(null!=n.getContext)o=!0;else{if(!(typeof ImageBitmap<"u"&&n instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);l=!0}if(null!=cV(KZ,ce.backendName))return ce.runKernel(KZ,{pixels:n},{numChannels:t});const[u,f]=i?[n.videoWidth,n.videoHeight]:[n.width,n.height];let m,_;if(o)m=n.getContext("2d").getImageData(0,0,u,f).data;else if(r||e)m=n.data;else if(s||i||l){if(null==Yb)if(typeof document>"u"){if(!(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u"))throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Yb=new OffscreenCanvas(1,1).getContext("2d")}else Yb=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Yb.canvas.width=u,Yb.canvas.height=f,Yb.drawImage(n,0,0,u,f),m=Yb.getImageData(0,0,u,f).data}if(4===t)_=new Int32Array(m);else{const w=u*f;_=new Int32Array(w*t);for(let T=0;T<w;T++)for(let I=0;I<t;++I)_[T*t+I]=m[4*T+I]}return Fce(_,[f,u,t],"int32")}});function L8(n,t,e){const r=n.shape.length;G(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),G(r===e.length,()=>`Error in slice${r}D: Length of size ${e} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)G(t[i]+e[i]<=n.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+e[i]}) would overflow input.shape[${i}] (${n.shape[i]})`)}function q$e(n){const t=[];let e=0;for(;n>0;)1&n&&t.push(e),n/=2,e++;return t}function $8(n,t,e){const r=[];for(let i=0;i<n.length;i++)r[i]=Math.ceil((t[i]-n[i])/e[i]);return r}function Bce(n,t,e,r){const i=[...n];for(let s=i.length;s<r.length;s++)i.push(1);for(let s=0;s<e;s++)0===s?i[t]=1:(i.splice(t,0,1),i.pop());return i}function Vce(n,t,e){return e<=n?e:e-(t-1)}function Uce(n,t){const e=[];for(let r=0;r<n;r++)e.push(t+r);return e}function Z$e(n,t,e,r,i,s,o,l,c){const u=n.length;let f=new Array(u),m=new Array(u),_=new Array(u);if(t.length&&e>0){const y=t[0],w=e+1;f=zce(o,y,w,r,n),m=Hce(l,y,w,i,n),_=Bce(s,y,w,n)}else for(let y=0;y<u;y++)f[y]=Wce(o,r,s,n,y,c),m[y]=jce(l,i,s,n,y,c),_[y]=Gce(s,y,c);return{begin:f,end:m,strides:_}}function zce(n,t,e,r,i){const s=[...i],o=Uce(e,t);for(let l=0;l<s.length;l++)if(o.indexOf(l)>-1)s[l]=0;else{const c=Vce(t,e,l);let u=r[c];n&1<<c&&(u=0),s[l]=u}return s}function Hce(n,t,e,r,i){const s=[...i],o=Uce(e,t);for(let l=0;l<s.length;l++)if(o.indexOf(l)>-1)s[l]=Number.MAX_SAFE_INTEGER;else{const c=Vce(t,e,l);let u=r[c];n&1<<c&&(u=Number.MAX_SAFE_INTEGER),s[l]=u}for(let l=0;l<s.length;l++){const c=i[l];s[l]<0&&(s[l]+=c),s[l]=Vb(0,s[l],i[l])}return s}function Gce(n,t,e){let r=n[t];return(e&1<<t||null==r)&&(r=1),r}function Wce(n,t,e,r,i,s){let o=t[i];(n&1<<i||s&1<<i||null==o)&&(o=(e[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const c=r[i];return o<0&&(o+=c),o=Vb(0,o,c-1),o}function jce(n,t,e,r,i,s){let o=t[i];const l=e[i]||1;(n&1<<i||s&1<<i||null==o)&&(o=l>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const c=r[i];return o<0&&(o+=c),o=l>0?Vb(0,o,c):Vb(-1,o,c-1),o}function B8(n,t,e){let r=e.length;for(let i=0;i<e.length;i++)if(e[i]>1){r=i;break}for(let i=r+1;i<e.length;i++)if(t[i]>0||e[i]!==n[i])return!1;return!0}function V8(n,t){let e=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)e+=n[r]*t[r];return e}function CV(n,t,e){let r;const i=n.shape.length;let s;return r="number"==typeof t?[t,...new Array(i-1).fill(0)]:t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice(),r.forEach(o=>{G(-1!==o,()=>"slice() does not support negative begin indexing.")}),s=null==e?new Array(i).fill(-1):"number"==typeof e?[e,...new Array(i-1).fill(-1)]:e.length<i?e.concat(new Array(i-e.length).fill(-1)):e,s=s.map((o,l)=>o>=0?o:(G(-1===o,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${l}.`),n.shape[l]-r[l])),[r,s]}function U8(n,t,e,r,i,s,o,l,c){let u;if(null==r?(u=new Array(t.length),u.fill(1)):u=r,null!=o&&0!=(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");let f=!1;const m={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:e.slice(),strides:u.slice(),beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:l,shrinkAxisMask:c};for(let M=0;M<m.dims;M++)f&&0!=(1<<M&l)&&m.numAddAxisAfterEllipsis++,1<<M&o&&(f=!0);f||(m.ellipsisMask|=1<<m.dims,m.dims++);const _={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function Y$e(n,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let e=0;t.beginValid=null!=n.begin,t.endValid=null!=n.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const i=Math.min(t.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,t.dims);for(;e<i;e++)t.begin[e]=0,t.end[e]=0,t.strides[e]=1,t.beginMask|=1<<e,t.endMask|=1<<e,t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[e]=r}else if(1<<r&n.newAxisMask)t.finalShapeGatherIndices.push(-2),t.finalShapeGatherIndicesSparse.push(-1);else{if(e===t.begin.length)throw Error(`Index out of range using input dim ${e}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=n.begin&&(t.begin[e]=n.begin[r]),null!=n.end&&(t.end[e]=n.end[r]),t.strides[e]=n.strides[r],n.beginMask&1<<r&&(t.beginMask|=1<<e),n.endMask&1<<r&&(t.endMask|=1<<e),n.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(-1),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<e):(t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[e]=r,e++}}(m,_);let y=!0,w=!0,T=!0;const I=[],E=[];for(let M=0;M<n.length;++M){if(0===_.strides[M])throw Error(`strides[${M}] must be non-zero`);const O=!!(_.shrinkAxisMask&1<<M),$=n[M];if(-1===$){I.push(O?1:-1);continue}const V=[_.beginMask&1<<M,_.endMask&1<<M],Z=[_.strides[M]>0?0:-1,_.strides[M]>0?$:$-1];if(O&&_.strides[M]<=0)throw Error("only stride 1 allowed on non-range indexing.");T=T&&1===_.strides[M];const Q=!!(_.beginMask&1<<M&&_.endMask&1<<M);if(_.beginValid&&_.endValid){if(O){const Ve=_.begin[M]<0?$+_.begin[M]:_.begin[M];if(_.begin[M]=Ve,_.end[M]=_.begin[M]+1,Ve<0||Ve>=$)throw Error(`slice index ${_.begin[M]} of dimension ${M} out of bounds.`)}else _.begin[M]=qce(_.begin[M],0,_.strides[M],$,V,Z),_.end[M]=qce(_.end[M],1,_.strides[M],$,V,Z);const ye=1===_.strides[M]&&0===_.begin[M]&&_.end[M]===$;y=y&&ye,w=w&&(0===M&&1===_.strides[M]||ye)}else y=y&&1===_.strides[M]&&Q,w=w&&(0===M&&1===_.strides[M]||Q);let re,oe=!1;if(_.beginValid&&_.endValid?(re=_.end[M]-_.begin[M],oe=!0):O?(re=1,oe=!0):Q&&$>=0&&(re=_.strides[M]<0?-$:$,oe=!0),oe){let ye;ye=0===re||re<0!=_.strides[M]<0?0:Math.trunc(re/_.strides[M])+(re%_.strides[M]!=0?1:0),I.push(ye)}else I.push(-1)}for(let M=0;M<_.finalShapeGatherIndices.length;++M){const O=_.finalShapeGatherIndices[M];O>=0?E.push(I[O]):-2===O&&E.push(1)}return{finalShapeSparse:E.filter((M,O)=>-2!==_.finalShapeGatherIndices[O]),finalShape:E,isIdentity:y,sliceDim0:w,isSimpleSlice:T,begin:_.begin,end:_.end,strides:_.strides}}function qce(n,t,e,r,i,s){if(i[t])return e>0?s[t]:s[t+1&1];{const o=n<0?r+n:n;return o<s[0]?s[0]:o>s[1]?s[1]:o}}const Zce=se({acos_:function Q$e(n){const e={x:j(n,"x","acos")};return ce.runKernel(H1,e)}}),Yce=se({acosh_:function X$e(n){const e={x:j(n,"x","acosh")};return ce.runKernel(G1,e)}}),eBe=se({addN_:function J$e(n){G(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),G(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const t=n.map((i,s)=>j(i,`tensors${s}`,"addN")),e=t[0];return t.forEach(i=>{if(i.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!dr(i.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),ce.runKernel(iB,t)}}),z8=se({all_:function tBe(n,t=null,e=!1){const i={x:j(n,"x","all","bool")};return ce.runKernel("All",i,{axis:t,keepDims:e})}}),xV=se({any_:function nBe(n,t=null,e=!1){const i={x:j(n,"x","any","bool")};return ce.runKernel("Any",i,{axis:t,keepDims:e})}}),dT=se({argMax_:function rBe(n,t=0){const r={x:j(n,"x","argMax")};return ce.runKernel(sB,r,{axis:t})}}),Kce=se({argMin_:function iBe(n,t=0){const r={x:j(n,"x","argMin")};return ce.runKernel(oB,r,{axis:t})}}),Qce=se({asin_:function sBe(n){const e={x:j(n,"x","asin")};return ce.runKernel(W1,e)}}),Xce=se({asinh_:function oBe(n){const e={x:j(n,"x","asinh")};return ce.runKernel(j1,e)}}),Jce=se({atan_:function aBe(n){const e={x:j(n,"x","atan")};return ce.runKernel(q1,e)}}),eue=se({atan2_:function lBe(n,t){let e=j(n,"a","atan2"),r=j(t,"b","atan2");return[e,r]=Hi(e,r),ce.runKernel(Y1,{a:e,b:r})}}),tue=se({atanh_:function cBe(n){const e={x:j(n,"x","atanh")};return ce.runKernel(Z1,e)}});function HN(n,t,e,r,i="NHWC",s){return Ys(n,[...t,n[3]],e,s,r,null,null,vp(i))}function ou(n,t,e,r,i,s,o="channelsLast"){const[l,c]=GN(t);let u;if("channelsLast"===o)u=[l,c,n[3],n[3]];else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);u=[l,c,n[1],n[1]]}return Ys(n,u,e,r,i,s,!1,o)}function yp(n,t,e,r,i,s,o="NDHWC"){const[l,c,u]=G8(t);let f,m;if("NDHWC"===o)m="channelsLast",f=[l,c,u,n[4],n[4]];else{if("NCDHW"!==o)throw new Error(`Unknown dataFormat ${o}`);m="channelsFirst",f=[l,c,u,n[1],n[1]]}return d_(n,f,e,r,i,!1,m,s)}function Ys(n,t,e,r,i,s,o=!1,l="channelsLast"){let[c,u,f,m]=[-1,-1,-1,-1];if("channelsLast"===l)[c,u,f,m]=n;else{if("channelsFirst"!==l)throw new Error(`Unknown dataFormat ${l}`);[c,m,u,f]=n}const[_,y,,w]=t,[T,I]=GN(e),[E,A]=GN(r),M=hT(_,E),O=hT(y,A),{padInfo:$,outHeight:V,outWidth:Z}=function hBe(n,t,e,r,i,s,o,l,c){let u,f,m;if("number"==typeof n){u={top:n,bottom:n,left:n,right:n,type:0===n?"VALID":"NUMBER"};const y=function uBe(n,t,e,r,i){null==r&&(r=H8(n,t,e));const o=n[1];return[WN((n[0]-t+2*r)/e+1,i),WN((o-t+2*r)/e+1,i)]}([t,e],s,r,n,l);f=y[0],m=y[1]}else if("same"===n){f=Math.ceil(t/r),m=Math.ceil(e/i);const _=Math.max(0,(f-1)*r+s-t),y=Math.max(0,(m-1)*i+o-e),w=Math.floor(_/2),T=_-w,I=Math.floor(y/2);u={top:w,bottom:T,left:I,right:y-I,type:"SAME"}}else if("valid"===n)u={top:0,bottom:0,left:0,right:0,type:"VALID"},f=Math.ceil((t-s+1)/r),m=Math.ceil((e-o+1)/i);else{if("object"!=typeof n)throw Error(`Unknown padding parameter: ${n}`);{const _="channelsLast"===c?n[1][0]:n[2][0],y="channelsLast"===c?n[1][1]:n[2][1],w="channelsLast"===c?n[2][0]:n[3][0],T="channelsLast"===c?n[2][1]:n[3][1];u={top:_,bottom:y,left:w,right:T,type:0===_&&0===y&&0===w&&0===T?"VALID":"EXPLICIT"},f=WN((t-s+_+y)/r+1,l),m=WN((e-o+w+T)/i+1,l)}}return{padInfo:u,outHeight:f,outWidth:m}}(i,u,f,T,I,M,O,s,l),Q=o?w*m:w;let re;return"channelsFirst"===l?re=[c,Q,V,Z]:"channelsLast"===l&&(re=[c,V,Z,Q]),{batchSize:c,dataFormat:l,inHeight:u,inWidth:f,inChannels:m,outHeight:V,outWidth:Z,outChannels:Q,padInfo:$,strideHeight:T,strideWidth:I,filterHeight:_,filterWidth:y,effectiveFilterHeight:M,effectiveFilterWidth:O,dilationHeight:E,dilationWidth:A,inShape:n,outShape:re,filterShape:t}}function d_(n,t,e,r,i,s=!1,o="channelsLast",l){let[c,u,f,m,_]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,u,f,m,_]=n;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[c,_,u,f,m]=n}const[y,w,T,,I]=t,[E,A,M]=G8(e),[O,$,V]=G8(r),Z=hT(y,O),Q=hT(w,$),re=hT(T,V),{padInfo:oe,outDepth:ye,outHeight:Ve,outWidth:We}=function fBe(n,t,e,r,i,s,o,l,c,u,f){let m,_,y,w;if("valid"===n&&(n=0),"number"==typeof n){m={top:n,bottom:n,left:n,right:n,front:n,back:n,type:0===n?"VALID":"NUMBER"};const I=function dBe(n,t,e,r,i,s){null==i&&(i=H8(n,t[0],r[0]));const o=[0,0,0,e];for(let l=0;l<3;l++)n[l]+2*i>=t[l]&&(o[l]=WN((n[l]-t[l]+2*i)/r[l]+1,s));return o}([t,e,r,1],[l,c,u],1,[i,s,o],n,f);_=I[0],y=I[1],w=I[2]}else{if("same"!==n)throw Error(`Unknown padding parameter: ${n}`);{_=Math.ceil(t/i),y=Math.ceil(e/s),w=Math.ceil(r/o);const T=(_-1)*i+l-t,I=(y-1)*s+c-e,E=(w-1)*o+u-r,A=Math.floor(T/2),M=T-A,O=Math.floor(I/2),$=I-O,V=Math.floor(E/2);m={top:O,bottom:$,left:V,right:E-V,front:A,back:M,type:"SAME"}}}return{padInfo:m,outDepth:_,outHeight:y,outWidth:w}}(i,u,f,m,E,A,M,Z,Q,re,l),Ke=s?I*_:I;let Qe;return"channelsFirst"===o?Qe=[c,Ke,ye,Ve,We]:"channelsLast"===o&&(Qe=[c,ye,Ve,We,Ke]),{batchSize:c,dataFormat:o,inDepth:u,inHeight:f,inWidth:m,inChannels:_,outDepth:ye,outHeight:Ve,outWidth:We,outChannels:Ke,padInfo:oe,strideDepth:E,strideHeight:A,strideWidth:M,filterDepth:y,filterHeight:w,filterWidth:T,effectiveFilterDepth:Z,effectiveFilterHeight:Q,effectiveFilterWidth:re,dilationDepth:O,dilationHeight:$,dilationWidth:V,inShape:n,outShape:Qe,filterShape:t}}function H8(n,t,e,r=1){const i=hT(t,r);return Math.floor((n[0]*(e-1)-e+i)/2)}function GN(n){return"number"==typeof n?[n,n,n]:2===n.length?[n[0],n[1],1]:n}function G8(n){return"number"==typeof n?[n,n,n]:n}function hT(n,t){return t<=1?n:n+(n-1)*(t-1)}function WN(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function h_(n){const[t,e,r]=GN(n);return 1===t&&1===e&&1===r}function wo(n,t){return h_(n)||h_(t)}function Kb(n){return GN(n).every(t=>t>0)}function vp(n){if("NHWC"===n)return"channelsLast";if("NCHW"===n)return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function ba(n,t,e){if(null!=e){if("string"==typeof t)throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);if("number"==typeof t)G(KI(t),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);else{if("object"!=typeof t)throw Error(`Error in ${n}: Unknown padding parameter: ${t}`);t.forEach(r=>{r.forEach(i=>{G(KI(i),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${i}.`)})})}}}const fe=se({reshape_:function pBe(n,t){const r={x:j(n,"x","reshape","string_or_numeric")};return ce.runKernel(jB,r,{shape:t})}}),IV=se({avgPool_:function mBe(n,t,e,r,i){const s=j(n,"x","avgPool","float32");G(wo(e,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`);let l=s,c=!1;3===s.rank&&(c=!0,l=fe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),G(4===l.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${l.rank}.`),ba("avgPool",r,i);let m=ce.runKernel(aB,{x:l},{filterSize:t,strides:e,pad:r,dimRoundingMode:i});return m=Pt(m,s.dtype),c?fe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),nue=se({avgPool3d_:function gBe(n,t,e,r,i,s="NDHWC"){const o=j(n,"x","avgPool3d","float32");let l=o,c=!1;4===o.rank&&(c=!0,l=fe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),G(5===l.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),G("NDHWC"===s,()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),G("number"==typeof e&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`),ba("avgPool3d",r,i);let m=ce.runKernel(lB,{x:l},{filterSize:t,strides:e,pad:r,dimRoundingMode:i,dataFormat:s});return m=Pt(m,l.dtype),c?fe(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),ms=se({concat_:function _Be(n,t=0){G(n.length>=1,()=>"Pass at least one tensor to concat");const e=yV(n,"tensors","concat","string_or_numeric");return"complex64"===e[0].dtype&&e.forEach(s=>{if("complex64"!==s.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${s.dtype}. `)}),1===e.length?pp(e[0]):ce.runKernel(fB,e,{axis:t})}}),ir=se({matMul_:function yBe(n,t,e=!1,r=!1){let i=j(n,"a","matMul"),s=j(t,"b","matMul");return[i,s]=Hi(i,s),ce.runKernel(cB,{a:i,b:s},{transposeA:e,transposeB:r})}}),vh=se({sigmoid_:function vBe(n){const e={x:j(n,"x","sigmoid","float32")};return ce.runKernel(kN,e)}}),_r=se({slice_:function bBe(n,t,e){const r=j(n,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");return ce.runKernel(QB,{x:r},{begin:t,size:e})}}),Qb=se({tanh_:function wBe(n){const e={x:j(n,"x","tanh","float32")};return ce.runKernel(FN,e)}}),xBe=se({basicLSTMCell_:function CBe(n,t,e,r,i,s){const o=j(n,"forgetBias","basicLSTMCell"),l=j(t,"lstmKernel","basicLSTMCell"),c=j(e,"lstmBias","basicLSTMCell"),u=j(r,"data","basicLSTMCell"),f=j(i,"c","basicLSTMCell"),m=j(s,"h","basicLSTMCell"),_=ms([u,m],1),y=ir(_,l),w=dt(y,c),I=w.shape[1]/4,E=[w.shape[0],I],A=_r(w,[0,0],E),M=_r(w,[0,I],E),O=_r(w,[0,2*I],E),$=_r(w,[0,3*I],E),V=dt(ue(vh(A),Qb(M)),ue(f,vh(dt(o,O))));return[V,ue(Qb(V),vh($))]}}),TV=se({batchToSpaceND_:function IBe(n,t,e){const r=j(n,"x","batchToSpaceND"),i=t.reduce((l,c)=>l*c);return G(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),G(e.length===t.length,()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${t.length}`),G(r.shape[0]%i==0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`),ce.runKernel(uB,{x:r},{blockShape:t,crops:e})}});function TBe(n){let t;return t=0===n.rank||1===n.rank?fe(n,[1,1,1,n.size]):2===n.rank?fe(n,[1,1,n.shape[0],n.shape[1]]):3===n.rank?fe(n,[1,n.shape[0],n.shape[1],n.shape[2]]):n,t}const jN=se({batchNorm_:function SBe(n,t,e,r,i,s){null==s&&(s=.001);const o=j(n,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(e,"variance","batchNorm");let u,f;null!=i&&(u=j(i,"scale","batchNorm")),null!=r&&(f=j(r,"offset","batchNorm")),G(l.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),G(null==f||l.rank===f.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),G(null==u||l.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const _={x:TBe(o),scale:u,offset:f,mean:l,variance:c},w=ce.runKernel(CB,_,{varianceEpsilon:s});return fe(w,o.shape)}}),rue=se({batchNorm2d_:function EBe(n,t,e,r,i,s){const o=j(n,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(e,"variance","batchNorm");let u,f;return null!=i&&(u=j(i,"scale","batchNorm")),null!=r&&(f=j(r,"offset","batchNorm")),G(2===o.rank,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),G(2===l.rank||1===l.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${l.rank}.`),G(2===c.rank||1===c.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),null!=u&&G(2===u.rank||1===u.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),null!=f&&G(2===f.rank||1===f.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${f.rank}.`),jN(o,l,c,f,u,s)}}),iue=se({batchNorm3d_:function DBe(n,t,e,r,i,s){const o=j(n,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(e,"variance","batchNorm");let u,f;return null!=i&&(u=j(i,"scale","batchNorm")),null!=r&&(f=j(r,"offset","batchNorm")),G(3===o.rank,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),G(3===l.rank||1===l.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${l.rank}.`),G(3===c.rank||1===c.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),null!=u&&G(3===u.rank||1===u.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),null!=f&&G(3===f.rank||1===f.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${f.rank}.`),jN(o,l,c,f,u,s)}}),sue=se({batchNorm4d_:function kBe(n,t,e,r,i,s){const o=j(n,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(e,"variance","batchNorm");let u,f;return null!=i&&(u=j(i,"scale","batchNorm")),null!=r&&(f=j(r,"offset","batchNorm")),G(4===o.rank,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),G(4===l.rank||1===l.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${l.rank}.`),G(4===c.rank||1===c.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),null!=u&&G(4===u.rank||1===u.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),null!=f&&G(4===f.rank||1===f.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${f.rank}.`),jN(o,l,c,f,u,s)}}),oue=se({bincount_:function ABe(n,t,e){const r=j(n,"x","bincount"),i=j(t,"weights","bincount");return G("int32"===r.dtype,()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),G(e>=0,()=>`size must be non-negative, but got ${e}.`),G(i.size===r.size||0===i.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`),ce.runKernel(Z5,{x:r,weights:i},{size:e})}}),RBe=se({bitwiseAnd_:function NBe(n,t){const e=j(n,"x","bitwiseAnd"),r=j(t,"y","bitwiseAnd");if(!dr(e.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${e.shape}, y: ${r.shape}`);if("int32"!==e.dtype||"int32"!==r.dtype)throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${e.dtype} and type of y: ${r.dtype}`);return ce.runKernel(dB,{a:e,b:r})}}),OBe=se({broadcastArgs_:function MBe(n,t){const e=j(n,"s0","broadcastArgs","int32"),r=j(t,"s1","broadcastArgs","int32");if(1!==e.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${e.rank}`);if(1!==r.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);return ce.runKernel(Y5,{s0:e,s1:r})}}),fT=se({broadcastTo_:function FBe(n,t){let e=j(n,"broadcastTo","x");const r=e.shape;if(dc(t),t.length<e.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${e.rank}.`);if(t.length>e.rank){const u=e.shape.slice();for(;u.length<t.length;)u.unshift(1);e=fe(e,u)}const i=e.shape,s=Array.from(t);for(let u=t.length-1;u>=0;u--)if(i[u]===t[u])s[u]=1;else if(1!==e.shape[u])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);return 0===s.map((u,f)=>u>1?f:-1).filter(u=>u>=0).length?pp(e):ce.runKernel(PN,{x:e},{reps:s})}}),aue=se({ceil_:function PBe(n){const e={x:j(n,"x","ceil","float32")};return ce.runKernel(Q1,e)}}),kl=se({clipByValue_:function LBe(n,t,e){const r=j(n,"x","clipByValue");return G(t<=e,()=>`Error in clip: min (${t}) must be less than or equal to max (${e}).`),t===e?cT(r.shape,t,r.dtype):ce.runKernel(X1,{x:r},{clipValueMin:t,clipValueMax:e})}}),lue=se({concat1d_:function $Be(n){return ms(n,0)}}),cue=se({concat2d_:function BBe(n,t){return ms(n,t)}}),uue=se({concat3d_:function VBe(n,t){return ms(n,t)}}),due=se({concat4d_:function UBe(n,t){return ms(n,t)}}),f_=se({conv2d_:function zBe(n,t,e,r,i="NHWC",s=[1,1],o){const l=j(n,"x","conv2d","float32"),c=j(t,"filter","conv2d","float32");let u=l,f=!1;3===l.rank&&(f=!0,u=fe(l,[1,l.shape[0],l.shape[1],l.shape[2]])),G(4===u.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),G(4===c.rank,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),ba("conv2d",r,o);const m="NHWC"===i?u.shape[3]:u.shape[1];G(m===c.shape[2],()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${c.shape[2]}.`),G(wo(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),G(Kb(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),G(Kb(e),()=>"Error in conv2D: Strides should be larger than 0.");const w=ce.runKernel(pB,{x:u,filter:c},{strides:e,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o});return f?fe(w,[w.shape[1],w.shape[2],w.shape[3]]):w}}),W8=se({conv1d_:function HBe(n,t,e,r,i="NWC",s=1,o){const l=j(n,"x","conv1d"),c=j(t,"filter","conv1d");let u=l,f=!1;2===l.rank&&(f=!0,u=fe(l,[1,l.shape[0],l.shape[1]])),G(3===u.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),G(3===c.rank,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),ba("conv1d",r,o),G(u.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${c.shape[1]}.`),G(wo(e,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${s}'`),G(Kb(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),G(Kb(e),()=>"Error in conv1D: Stride should be larger than 0."),G("NWC"===i,()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const m=fe(c,[1,c.shape[0],c.shape[1],c.shape[2]]),_=fe(u,[u.shape[0],1,u.shape[1],u.shape[2]]),I=f_(_,m,[1,e],r,"NHWC",[1,s],o);return fe(I,f?[I.shape[2],I.shape[3]]:[I.shape[0],I.shape[2],I.shape[3]])}}),j8=se({conv2DBackpropInput_:function GBe(n,t,e,r,i,s="NHWC",o){G(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let l=n,c=t,u=!1;3===t.rank&&(u=!0,c=fe(t,[1,t.shape[0],t.shape[1],t.shape[2]]),l=[1,n[0],n[1],n[2]]),G(4===l.length,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${l.length}.`),G(4===c.rank,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),G(4===e.rank,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`);const f="NHWC"===s?l[3]:l[1],m="NHWC"===s?c.shape[3]:c.shape[1];G(f===e.shape[2],()=>`Error in conv2dDerInput: depth of input (${f}) must match input depth for filter ${e.shape[2]}.`),G(m===e.shape[3],()=>`Error in conv2dDerInput: depth of output (${m}) must match output depth for filter ${e.shape[3]}.`),ba("conv2dDerInput",i,o);const w=ce.runKernel(mB,{dy:c,filter:e},{strides:r,pad:i,dataFormat:s,dimRoundingMode:o,inputShape:l});return u?fe(w,[w.shape[1],w.shape[2],w.shape[3]]):w}}),q8=se({conv2dTranspose_:function WBe(n,t,e,r,i,s){const o=j(n,"x","conv2dTranspose"),l=j(t,"filter","conv2dTranspose");return j8(e,o,l,r,i,"NHWC",s)}}),hue=se({conv3d_:function jBe(n,t,e,r,i="NDHWC",s=[1,1,1]){const o=j(n,"x","conv3d"),l=j(t,"filter","conv3d");let c=o,u=!1;4===o.rank&&(u=!0,c=fe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),G(5===c.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),G(5===l.rank,()=>`Error in conv3d: filter must be rank 5, but got rank ${l.rank}.`),G(c.shape[4]===l.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${l.shape[3]}.`),G(wo(e,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),G("NDHWC"===i,()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),G(Kb(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),G(Kb(e),()=>"Error in conv3D: Strides should be larger than 0.");const _=ce.runKernel(gB,{x:c,filter:l},{strides:e,pad:r,dataFormat:i,dilations:s});return u?fe(_,[_.shape[1],_.shape[2],_.shape[3],_.shape[4]]):_}}),fue=se({conv3DBackpropInput_:function qBe(n,t,e,r,i){G(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let s=n,o=t,l=!1;4===t.rank&&(l=!0,o=fe(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,n[0],n[1],n[2],n[3]]);const c=s[4],u=o.shape[4];G(5===s.length,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),G(5===o.rank,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),G(5===e.rank,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`),G(c===e.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${e.shape[3]}.`),G(u===e.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${e.shape[4]}.`);const _=ce.runKernel(J5,{dy:o,filter:e},{pad:i,strides:r,inputShape:s});return l?fe(_,[_.shape[1],_.shape[2],_.shape[3],_.shape[4]]):_}}),pue=se({conv3dTranspose_:function ZBe(n,t,e,r,i){const s=j(n,"x","conv3dTranspose"),o=j(t,"filter","conv3dTranspose");return fue(e,s,o,r,i)}}),SV=se({cos_:function YBe(n){const e={x:j(n,"x","cos","float32")};return ce.runKernel(J1,e)}}),Z8=se({cosh_:function KBe(n){const e={x:j(n,"x","cosh","float32")};return ce.runKernel(eN,e)}}),EV=se({cumprod_:function QBe(n,t=0,e=!1,r=!1){const s={x:j(n,"x","cumprod")};return ce.runKernel(eZ,s,{axis:t,exclusive:e,reverse:r})}}),Y8=se({cumsum_:function XBe(n,t=0,e=!1,r=!1){const s={x:j(n,"x","cumsum")};return ce.runKernel(_B,s,{axis:t,exclusive:e,reverse:r})}}),K8=se({denseBincount_:function JBe(n,t,e,r=!1){const i=j(n,"x","denseBincount"),s=j(t,"weights","denseBincount");return G("int32"===i.dtype,()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),G(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),G(e>=0,()=>`size must be non-negative, but got ${e}.`),G(s.size===i.size||0===s.size,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`),ce.runKernel(nZ,{x:i,weights:s},{size:e,binaryOutput:r})}}),mue=se({depthToSpace_:function eVe(n,t,e="NHWC"){const r=j(n,"x","depthToSpace","float32"),i="NHWC"===e?r.shape[1]:r.shape[2],s="NHWC"===e?r.shape[2]:r.shape[3],o="NHWC"===e?r.shape[3]:r.shape[1];return G(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),G(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${t}  for depthToSpace with input shape\n    ${r.shape}`),G(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${t} for depthToSpace with input shape\n        ${r.shape}`),G(o%(t*t)==0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${r.shape}`),ce.runKernel(rZ,{x:r},{blockSize:t,dataFormat:e})}}),qN=se({depthwiseConv2d_:function tVe(n,t,e,r,i="NHWC",s=[1,1],o){const l=j(n,"x","depthwiseConv2d","float32"),c=j(t,"filter","depthwiseConv2d","float32");let u=l,f=!1;3===l.rank&&(f=!0,u=fe(l,[1,l.shape[0],l.shape[1],l.shape[2]])),G(4===u.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),G(4===c.rank,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`);const m="NHWC"===i?u.shape[3]:u.shape[1];G(m===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${m}) must match the inChannels dimension in filter ${c.shape[2]}.`),ba("depthwiseConv2d",r,o);const w=ce.runKernel(yB,{x:u,filter:c},{strides:e,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o});return f?fe(w,[w.shape[1],w.shape[2],w.shape[3]]):w}}),rVe=se({diag_:function nVe(n){const e={x:j(n,"x","diag")};return ce.runKernel(oZ,e)}}),gue=se({dilation2d_:function iVe(n,t,e,r,i=[1,1],s="NHWC"){const o=j(n,"x","dilation2d"),l=j(t,"filter","dilation2d");G(3===o.rank||4===o.rank,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),G(3===l.rank,()=>`Error in dilation2d: filter must be rank 3, but got rank ${l.rank}.`),G("NHWC"===s,()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let c=o,u=!1;3===o.rank&&(c=fe(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),G(c.shape[3]===l.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${c.shape[3]} vs ${l.shape[2]}`);const _=ce.runKernel(vB,{x:c,filter:l},{strides:e,pad:r,dilations:i});return u?fe(_,[_.shape[1],_.shape[2],_.shape[3]]):_}}),id=se({equal_:function sVe(n,t){let e=j(n,"a","equal","string_or_numeric"),r=j(t,"b","equal","string_or_numeric");return[e,r]=Hi(e,r),Bn(e.shape,r.shape),ce.runKernel(bB,{a:e,b:r})}}),Xo=se({where_:function oVe(n,t,e){const r=j(t,"a","where"),i=j(e,"b","where"),s=j(n,"condition","where","bool"),o=Bn(Bn(s.shape,r.shape),i.shape),l=fT(s,o),c=fT(r,o),u=fT(i,o);return ce.runKernel(KB,{condition:l,t:c,e:u})}}),_ue=se({divNoNan_:function aVe(n,t){let e=j(n,"a","div"),r=j(t,"b","div");[e,r]=Hi(e,r);const i=ln(e,r),s=gr(i),o=id(r,s);return Xo(o,s,i)}}),yue=se({dot_:function lVe(n,t){const e=j(n,"t1","dot"),r=j(t,"t2","dot");G(!(1!==e.rank&&2!==e.rank||1!==r.rank&&2!==r.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${r.rank}.`);const i=1===e.rank?e.size:e.shape[1],s=1===r.rank?r.size:r.shape[0];if(G(i===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`),1===e.rank&&1===r.rank){const o=fe(e,[1,-1]),l=fe(r,[-1,1]),c=ir(o,l);return fe(c,[])}if(1===e.rank&&2===r.rank){const o=fe(e,[1,-1]),l=fe(r,[r.shape[0],r.shape[1]]),c=ir(o,l);return fe(c,[c.size])}if(2===e.rank&&1===r.rank){const o=fe(r,[-1,1]),l=ir(e,o);return fe(l,[l.size])}{const o=fe(r,[r.shape[0],r.shape[1]]);return ir(e,o)}}}),pT=se({einsum_:function cVe(n,...t){const e=t.map((i,s)=>j(i,`tensors${s}`,"einsum"));return ce.runKernel(uZ,e,{equation:n})}}),ZN=se({elu_:function uVe(n){const e={x:j(n,"x","elu","float32")};return ce.runKernel(nN,e)}}),hVe=se({ensureShape_:function dVe(n,t){const e=j(n,"x","ensureShape","string_or_numeric");if(!function V2e(n,t){if(n===t)return!0;if(null==n||null==t||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(null!==n[e]&&null!==t[e]&&n[e]!==t[e])return!1;return!0}(e.shape,t))throw new Error(`EnsureShape: Shape of tensor ${e.shape} is not compatible with expected shape ${t}`);return n}}),Q8=se({erf_:function fVe(n){let t=j(n,"x","erf");return G("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=Pt(t,"float32")),ce.runKernel(rN,{x:t})}});function X8(n,t){for(let e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function vue(n,t,e){const r=n.length+t.length,i=[];let s=0,o=0;for(let l=0;l<r;l++)-1===e.indexOf(l)?i.push(n[s++]):i.push(t[o++]);return i}function Ks(n,t){const e=[],r=n.length;for(let s=0;s<r;s++)-1===t.indexOf(s)&&e.push(n[s]);return[e,t.map(s=>n[s])]}function rs(n,t){return vue(n,t.map(r=>1),t)}function Co(n,t,e){G(X8(t,e),()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`)}function Pi(n,t){if(X8(n,t))return null;const e=[];for(let r=0;r<t;++r)-1===n.indexOf(r)&&e.push(r);return n.forEach(r=>e.push(r)),e}function p_(n){return n.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function is(n,t){const e=[];for(let r=t-n;r<t;++r)e.push(r);return e}const au=se({max_:function pVe(n,t=null,e=!1){const i={x:j(n,"x","max")};return ce.runKernel(RB,i,{reductionIndices:t,keepDims:e})}}),YN=se({min_:function mVe(n,t=null,e=!1){const i={x:j(n,"x","min")};return ce.runKernel(PB,i,{axis:t,keepDims:e})}}),tn=se({sum_:function gVe(n,t=null,e=!1){let r=j(n,"x","sum");return"bool"===r.dtype&&(r=Pt(r,"int32")),ce.runKernel(XB,{x:r},{axis:t,keepDims:e})}});function bue(n,t,e=null){if(0===n.rank)return ks(n);if(1!==n.rank&&null===e)return bue(fe(n,[-1]),t,e);if(1===n.rank||"number"==typeof e||Array.isArray(e)&&1===e.length){if(1===t)return tn(ks(n),e);if(t===1/0)return au(ks(n),e);if(t===-1/0)return YN(ks(n),e);if("euclidean"===t||2===t)return bo(tn(gp(ks(n),gn(2,"int32")),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(e)&&2===e.length){if(1===t)return au(tn(ks(n),e[0]),e[1]-1);if(t===1/0)return au(tn(ks(n),e[1]),e[0]);if(t===-1/0)return YN(tn(ks(n),e[1]),e[0]);if("fro"===t||"euclidean"===t)return bo(tn(Xr(n),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${e}`)}const KN=se({norm_:function _Ve(n,t="euclidean",e=null,r=!1){const i=bue(n=j(n,"x","norm"),t,e);let s=i.shape;if(r){const o=Kn(e,n.shape);s=rs(i.shape,o)}return fe(i,s)}}),wue=se({euclideanNorm_:function yVe(n,t=null,e=!1){return KN(n,"euclidean",t,e)}}),Al=se({exp_:function vVe(n){const e={x:j(n,"x","exp")};return ce.runKernel(iN,e)}}),wa=se({expandDims_:function bVe(n,t=0){const e=j(n,"x","expandDims","string_or_numeric");return G(t<=e.rank,()=>"Axis must be <= rank of the tensor"),ce.runKernel(wB,{input:e},{dim:t})}}),Cue=se({expm1_:function wVe(n){const e={x:j(n,"x","expm1")};return ce.runKernel(sN,e)}}),lu=se({tile_:function CVe(n,t){const e=j(n,"x","tile","string_or_numeric");return G(e.rank===t.length,()=>`Error in transpose: rank of input ${e.rank} must match length of reps ${t}.`),ce.runKernel(PN,{x:e},{reps:t})}}),J8=se({eye_:function xVe(n,t,e,r="float32"){null==t&&(t=n);const i=qn([n,t],r),s=n<=t?n:t;for(let l=0;l<s;++l)i.set(1,l,l);const o=fe(i.toTensor(),[n,t]);if(null==e)return o;if(1===e.length)return lu(wa(o,0),[e[0],1,1]);if(2===e.length)return lu(wa(wa(o,0),0),[e[0],e[1],1,1]);if(3===e.length)return lu(wa(wa(wa(o,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}}),QN=se({floor_:function IVe(n){const e={x:j(n,"x","floor","float32")};return ce.runKernel(oN,e)}}),XN=se({gather_:function TVe(n,t,e=0,r=0){const i=j(n,"x","gather"),s=j(t,"indices","gather","int32");return ce.runKernel(xB,{x:i,indices:s},{axis:e,batchDims:r})}}),Nl=se({greater_:function SVe(n,t){let e=j(n,"a","greater","string_or_numeric"),r=j(t,"b","greater","string_or_numeric");return[e,r]=Hi(e,r),Bn(e.shape,r.shape),ce.runKernel(IB,{a:e,b:r})}}),m_=se({greaterEqual_:function EVe(n,t){let e=j(n,"a","greaterEqual","string_or_numeric"),r=j(t,"b","greaterEqual","string_or_numeric");return[e,r]=Hi(e,r),Bn(e.shape,r.shape),ce.runKernel(lN,{a:e,b:r})}}),DV=se({imag_:function DVe(n){const e={input:j(n,"input","imag")};return ce.runKernel(_Z,e)}}),xue=se({isFinite_:function kVe(n){const e={x:j(n,"x","isFinite")};return ce.runKernel(uN,e)}}),Iue=se({isInf_:function AVe(n){const e={x:j(n,"x","isInf")};return ce.runKernel(dN,e)}}),Tue=se({isNaN_:function NVe(n){const e={x:j(n,"x","isNaN")};return ce.runKernel(hN,e)}}),kV=se({leakyRelu_:function RVe(n,t=.2){const r={x:j(n,"x","leakyRelu")};return ce.runKernel(TB,r,{alpha:t})}}),JN=se({less_:function MVe(n,t){let e=j(n,"a","less","string_or_numeric"),r=j(t,"b","less","string_or_numeric");return[e,r]=Hi(e,r),Bn(e.shape,r.shape),ce.runKernel(SB,{a:e,b:r})}}),Xb=se({lessEqual_:function OVe(n,t){let e=j(n,"a","lessEqual","string_or_numeric"),r=j(t,"b","lessEqual","string_or_numeric");return[e,r]=Hi(e,r),Bn(e.shape,r.shape),ce.runKernel(EB,{a:e,b:r})}});function FVe(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");return ce.runKernel(yZ,{},{start:n,stop:t,num:e})}const Sue=se({localResponseNormalization_:function PVe(n,t=5,e=1,r=1,i=.5){const s=j(n,"x","localResponseNormalization");G(4===s.rank||3===s.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${s.rank}.`),G(KI(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=s,l=!1;3===s.rank&&(l=!0,o=fe(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const f=ce.runKernel(NB,{x:o},{depthRadius:t,bias:e,alpha:r,beta:i});return l?fe(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),fc=se({log_:function LVe(n){const e={x:j(n,"x","log","float32")};return ce.runKernel(fN,e)}}),AV=se({log1p_:function $Ve(n){const e={x:j(n,"x","log1p")};return ce.runKernel(pN,e)}}),pi=se({neg_:function BVe(n){const e={x:j(n,"x","neg")};return ce.runKernel($B,e)}}),mT=se({softplus_:function VVe(n){const e={x:j(n,"x","softplus")};return ce.runKernel(AN,e)}}),Eue=se({logSigmoid_:function UVe(n){const t=j(n,"x","logSigmoid");return mp(r=>({value:pi(mT(pi(r))),gradFunc:o=>ue(o,vh(pi(r)))}))(t)}}),eY=se({logSoftmax_:function zVe(n,t=-1){const e=j(n,"logits","logSoftmax");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${t}`);return mp((i,s)=>{const l=au(i,t,!0),c=Kt(i,l),u=Kt(Pt(c,"float32"),fc(tn(Al(c),t,!0)));return s([u]),{value:u,gradFunc:(m,_)=>{const[y]=_,T=Al(y);return Kt(m,ue(tn(m,t,!0),T))}}})(e)}}),NV=se({logSumExp_:function HVe(n,t=null,e=!1){const r=j(n,"x","logSumExp"),i=Kn(t,r.shape),s=au(r,i,!0),o=Kt(r,s),l=Al(o),c=tn(l,i),u=fc(c),f=dt(fe(s,u.shape),u);if(e){const m=rs(f.shape,i);return fe(f,m)}return f}}),bh=se({logicalAnd_:function GVe(n,t){const e=j(n,"a","logicalAnd","bool"),r=j(t,"b","logicalAnd","bool");return Bn(e.shape,r.shape),ce.runKernel(DB,{a:e,b:r})}}),RV=se({logicalNot_:function WVe(n){const e={x:j(n,"x","logicalNot","bool")};return ce.runKernel(kB,e)}}),tY=se({logicalOr_:function jVe(n,t){const e=j(n,"a","logicalOr","bool"),r=j(t,"b","logicalOr","bool");return Bn(e.shape,r.shape),ce.runKernel(AB,{a:e,b:r})}}),Due=se({logicalXor_:function qVe(n,t){const e=j(n,"a","logicalXor","bool"),r=j(t,"b","logicalXor","bool");return Bn(e.shape,r.shape),bh(tY(n,t),RV(bh(n,t)))}}),MV=2147483648,nY=se({searchSorted_:function ZVe(n,t,e="left"){const r=j(n,"sortedSequence","searchSorted"),i=j(t,"values","searchSorted"),o=i.shape[i.shape.length-1],l=fe(r,[-1,r.shape[r.shape.length-1]]),c=fe(i,[-1,o]);if(l.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(l.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Ye(c.shape)>=MV)throw new Error(`values tensor size must less than ${MV}`);if(l.shape[1]>=MV)throw new Error(`trailing dim_size must less than ${MV} for int32 output type, was ${l.shape[1]}`);return ce.runKernel(PZ,{sortedSequence:l,values:c},{side:e})}});function YVe(n,t){return nY(n,t,"left")}const OV=se({maxPool_:function KVe(n,t,e,r,i){const s=j(n,"x","maxPool");let l=s,c=!1;3===s.rank&&(c=!0,l=fe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),G(4===l.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${l.rank}.`),G(wo(e,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`),ba("maxPool",r,i);const m=ce.runKernel(MB,{x:l},{filterSize:t,strides:e,pad:r,dimRoundingMode:i});return c?fe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),kue=se({maxPool3d_:function QVe(n,t=[1,1,1],e,r,i,s="NDHWC"){const o=j(n,"x","maxPool3d");let l=o,c=!1;4===o.rank&&(c=!0,l=fe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),G(5===l.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),G("NDHWC"===s,()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),ba("maxPool3d",r,i);const m=ce.runKernel(OB,{x:l},{filterSize:t,strides:e,pad:r,dimRoundingMode:i,dataFormat:s});return c?fe(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),JVe=se({maxPoolWithArgmax_:function XVe(n,t,e,r,i=!1){const o={x:j(n,"x","maxPoolWithArgmax")},c=ce.runKernel(CZ,o,{filterSize:t,strides:e,pad:r,includeBatchInIndex:i});return{result:c[0],indexes:c[1]}}}),Gi=se({mean_:function e3e(n,t=null,e=!1){const i={x:j(n,"x","mean")};return ce.runKernel(FB,i,{axis:t,keepDims:e})}});function Ns(n,t="float32"){if(dc(n),"complex64"===t){const r=Ns(n,"float32"),i=Ns(n,"float32");return o_(r,i)}const e=Qo(Ye(n),t);return ce.makeTensor(e,n,t)}function Rl(n,t="float32"){if(dc(n),"complex64"===t){const r=Rl(n,"float32"),i=Ns(n,"float32");return o_(r,i)}const e=U5(Ye(n),t);return ce.makeTensor(e,n,t)}function t3e(n,t,{indexing:e="xy"}={}){if("xy"!==e&&"ij"!==e)throw new TypeError(`${e} is not a valid third argument to meshgrid`);if(void 0===n)return[];let r=j(n,"x","meshgrid",n instanceof fi?n.dtype:"float32");if(void 0===t)return[r];let i=j(t,"y","meshgrid",t instanceof fi?t.dtype:"float32");const s=Ye(r.shape),o=Ye(i.shape);return"xy"===e?(r=fe(r,[1,-1]),i=fe(i,[-1,1]),[ir(Rl([o,1],r.dtype),r),ir(i,Rl([1,s],i.dtype))]):(r=fe(r,[-1,1]),i=fe(i,[1,-1]),[ir(r,Rl([1,o],r.dtype)),ir(Rl([s,1],i.dtype),i)])}const Jb=se({minimum_:function n3e(n,t){let e=j(n,"a","minimum"),r=j(t,"b","minimum");return[e,r]=Hi(e,r),"bool"===e.dtype&&(e=Pt(e,"int32"),r=Pt(r,"int32")),Bn(e.shape,r.shape),ce.runKernel(gN,{a:e,b:r})}}),Aue=se({mirrorPad_:function r3e(n,t,e){G("reflect"===e||"symmetric"===e,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`);const r=j(n,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");G(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);const i="reflect"===e?1:0;for(let l=0;l<r.rank;l++)G(2===t[l].length,()=>"Invalid number of paddings. Must be length of 2 each."),G(t[l][0]>=0&&t[l][0]<=r.shape[l]-i&&t[l][1]>=0&&t[l][1]<=r.shape[l]-i,()=>`Padding in dimension ${l} cannot be greater than or equal to ${r.shape[l]-i} or less than 0 for input of shape ${r.shape}`);return ce.runKernel(LB,{x:r},{paddings:t,mode:e})}}),Nue=se({mod_:function i3e(n,t){let e=j(n,"a","mod"),r=j(t,"b","mod");return[e,r]=Hi(e,r),ce.runKernel(_N,{a:e,b:r})}}),FV=se({moments_:function s3e(n,t=null,e=!1){const r=Kn(t,(n=j(n,"x","moments")).shape),i=Gi(n,r,e);let s=i.shape;e||(s=rs(i.shape,r));const o=Xr(Kt(Pt(n,"float32"),fe(i,s)));return{mean:i,variance:Gi(o,r,e)}}}),a3e=se({multiRNNCell_:function o3e(n,t,e,r){const i=j(t,"data","multiRNNCell"),s=yV(e,"c","multiRNNCell"),o=yV(r,"h","multiRNNCell");let l=i;const c=[];for(let m=0;m<n.length;m++){const _=n[m](l,s[m],o[m]);c.push(_[0]),c.push(_[1]),l=_[1]}const u=[],f=[];for(let m=0;m<c.length;m+=2)u.push(c[m]),f.push(c[m+1]);return[u,f]}}),c3e=se({multinomial_:function l3e(n,t,e,r=!1){const i=j(n,"logits","multinomial"),s=i.size,o=i.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);e=e||Math.random();const c={logits:1===o?fe(i,[1,-1]):i},f=ce.runKernel(xZ,c,{numSamples:t,seed:e,normalized:r});return 1===o?fe(f,[f.size]):f}}),gT=se({notEqual_:function u3e(n,t){let e=j(n,"a","notEqual","string_or_numeric"),r=j(t,"b","notEqual","string_or_numeric");return[e,r]=Hi(e,r),Bn(e.shape,r.shape),ce.runKernel(BB,{a:e,b:r})}}),rY=se({oneHot_:function d3e(n,t,e=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const o={indices:j(n,"indices","oneHot","int32")};return ce.runKernel(UB,o,{dtype:i,depth:t,onValue:e,offValue:r})}}),pc=se({onesLike_:function h3e(n){const e={x:j(n,"x","onesLike")};return ce.runKernel(VB,e)}}),p3e=se({outerProduct_:function f3e(n,t){const e=j(n,"v1","outerProduct"),r=j(t,"v2","outerProduct");G(1===e.rank&&1===r.rank,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${e.rank} and ${r.rank}.`);const i=fe(e,[-1,1]),s=fe(r,[1,-1]);return ir(i,s)}}),g_=se({pad_:function m3e(n,t,e=0){const r=j(n,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return ce.runKernel(HB,{x:r},{paddings:t,constantValue:e})}}),_3e=se({pad1d_:function g3e(n,t,e=0){return G(2===t.length,()=>"Invalid number of paddings. Must be length of 2."),g_(n,[t],e)}}),v3e=se({pad2d_:function y3e(n,t,e=0){return G(2===t.length&&2===t[0].length&&2===t[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),g_(n,t,e)}}),w3e=se({pad3d_:function b3e(n,t,e=0){return G(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),g_(n,t,e)}}),x3e=se({pad4d_:function C3e(n,t,e=0){return G(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),g_(n,t,e)}}),PV=se({spaceToBatchND_:function I3e(n,t,e){const r=j(n,"x","spaceToBatchND");return G(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),G(e.length===t.length,()=>`paddings.shape[0] ${e.length} must be equal to [blockShape] ${t.length}`),G(r.shape.reduce((o,l,c)=>c>0&&c<=t.length?o&&(l+e[c-1][0]+e[c-1][1])%t[c-1]==0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${e.toString()} must be divisible by blockShapes ${t.toString()}`),ce.runKernel(JB,{x:r},{blockShape:t,paddings:e})}}),Rue=se({pool_:function T3e(n,t,e,r,i,s,o){null==i&&(i=[1,1]),null==s&&(s=1),0===r&&(r="valid");const l=j(n,"x","maxPool");let c=l,u=!1;3===l.rank&&(u=!0,c=fe(l,[1,l.shape[0],l.shape[1],l.shape[2]])),G(wo(s,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`);const f=ou(c.shape,t,s,i,r),m=[f.dilationHeight,f.dilationWidth];let _;_="same"===r?function E3e(n,t){const r=n.map((o,l)=>o+(o-1)*(t[l]-1)).map(o=>o-1),i=r.map(o=>Math.floor(o/2)),s=r.map((o,l)=>o-i[l]);return r.map((o,l)=>[i[l],s[l]])}([f.filterHeight,f.filterWidth],m):[[0,0],[0,0]];const y=1===m[0]&&1===m[1],[w,T]=function S3e(n,t,e){const r=e.map(f=>f[0]),i=e.map(f=>f[1]),s=n.concat(r,i),o=t.map((f,m)=>(f-s[m]%f)%f),l=i.map((f,m)=>f+o[m]),c=t.map((f,m)=>[r[m],l[m]]),u=t.map((f,m)=>[0,o[m]]);return[c,u]}([f.inHeight,f.inWidth],m,_),I=y?r:"valid",E=y?c:PV(c,m,w),M=("avg"===e?()=>IV(E,t,s,I,o):()=>OV(E,t,s,I,o))(),O=y?M:TV(M,m,T);return u?fe(O,[O.shape[1],O.shape[2],O.shape[3]]):O}}),LV=se({prelu_:function D3e(n,t){const e=j(n,"x","prelu"),r=j(t,"alpha","prelu");return ce.runKernel(GB,{x:e,alpha:r})}}),Mue=se({prod_:function k3e(n,t=null,e=!1){let r=j(n,"x","prod");return"bool"===r.dtype&&(r=Pt(r,"int32")),ce.runKernel(WB,{x:r},{axis:t,keepDims:e})}}),N3e=se({raggedGather_:function A3e(n,t,e,r){const i=n.map((f,m)=>j(f,`tensors${m}`,"raggedGather","int32")),s=j(t,"paramsDenseValues","raggedGather"),o=j(e,"indices","raggedGather","int32"),u=ce.runKernel(EZ,{paramsNestedSplits:i,paramsDenseValues:s,indices:o},{outputRaggedRank:r});return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}}),M3e=se({raggedRange_:function R3e(n,t,e){const r=j(n,"starts","raggedRange"),i=j(t,"limits","raggedRange",r.dtype),s=j(e,"deltas","raggedRange",r.dtype),l=ce.runKernel(DZ,{starts:r,limits:i,deltas:s});return{rtNestedSplits:l[0],rtDenseValues:l[1]}}}),F3e=se({raggedTensorToTensor_:function O3e(n,t,e,r,i){const s=j(n,"shape","raggedTensorToTensor","int32"),o=j(t,"values","raggedTensorToTensor"),l=j(e,"defaultValue","raggedTensorToTensor",o.dtype),c=r.map((m,_)=>j(m,`tensors${_}`,"raggedTensorToTensor","int32"));return ce.runKernel(kZ,{shape:s,values:o,defaultValue:l,rowPartitionTensors:c},{rowPartitionTypes:i})}}),L3e=se({rand_:function P3e(n,t,e){dc(n);const r=Ye(n);let i=null;if(null==e||"float32"===e)i=new Float32Array(r);else if("int32"===e)i=new Int32Array(r);else{if("bool"!==e)throw new Error(`Unknown data type ${e}`);i=new Uint8Array(r)}for(let s=0;s<r;s++)i[s]=t();return ce.makeTensor(i,n,e)}});var $V=z(340);class iY{constructor(t,e,r,i,s){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=s||Math.random();this.random=$V.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,e,r=!1;for(;!r;){let i,s,o;do{i=2*this.random()-1,s=2*this.random()-1,o=i*i+s*s}while(o>=1||0===o);const l=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*i*l,e=this.mean+this.stdDev*s*l,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(e))&&(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class $3e{constructor(t,e,r,i){this.alpha=t,this.beta=1/e,this.dtype=r;const s=i||Math.random();this.randu=$V.alea(s.toString()),this.randn=new iY(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,r,i,s,o;for(;;){do{i=this.randn.nextValue(),o=1+this.c*i}while(o<=0);if(o*=o*o,t=i*i,e=1-.331*t*t,r=.5*t+this.d*(1-o+Math.log(o)),s=this.randu(),s<e||Math.log(s)<r)break}return o*=1/this.beta*this.d,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class B3e{constructor(t=0,e=1,r,i){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=r,null==i&&(i=Math.random()),"number"==typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=$V.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const G3e=se({randomGamma_:function H3e(n,t,e=1,r="float32",i){if(dc(n),null==e&&(e=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error(`Unsupported data type ${r}`);const s=new $3e(t,e,r,i),o=qn(n,r);for(let l=0;l<o.values.length;l++)o.values[l]=s.nextValue();return o.toTensor()}}),oY=se({randomNormal_:function W3e(n,t=0,e=1,r,i){if(dc(n),null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);const s=new iY(t,e,r,!1,i),o=qn(n,r);for(let l=0;l<o.values.length;l++)o.values[l]=s.nextValue();return o.toTensor()}}),q3e=se({randomStandardNormal_:function j3e(n,t,e){if(null!=t&&"bool"===t)throw new Error(`Unsupported data type ${t}`);return oY(n,0,1,t,e)}}),e0=se({randomUniform_:function Z3e(n,t=0,e=1,r="float32",i){dc(n);const s=qn(n,r),o=new B3e(t,e,null,i);for(let l=0;l<s.values.length;l++)s.values[l]=o.nextValue();return s.toTensor()}}),K3e=se({randomUniformInt_:function Y3e(n,t,e,r){return e0(n,t,e,"int32",r)}});function _T(n,t,e=1,r="float32"){if(0===e)throw new Error("Cannot have a step of zero");return ce.runKernel(AZ,{},{start:n,stop:t,step:e,dtype:r})}const eR=se({real_:function Q3e(n){const e={input:j(n,"input","real")};return ce.runKernel(NZ,e)}}),Oue=se({reciprocal_:function X3e(n){const e={x:j(n,"x","reciprocal")};return ce.runKernel(bN,e)}}),wh=se({relu_:function J3e(n){const e={x:j(n,"x","relu")};return ce.runKernel(wN,e)}}),aY=se({relu6_:function eUe(n){const e={x:j(n,"x","relu6")};return ce.runKernel(CN,e)}}),mc=se({reverse_:function tUe(n,t){const r={x:j(n,"x","reverse")};return ce.runKernel(YB,r,{dims:t})}}),rUe=se({reverse1d_:function nUe(n){const t=j(n,"x","reverse");return G(1===t.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),mc(t,0)}}),sUe=se({reverse2d_:function iUe(n,t){const e=j(n,"x","reverse");return G(2===e.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${e.rank}.`),mc(e,t)}}),aUe=se({reverse3d_:function oUe(n,t){const e=j(n,"x","reverse");return G(3===e.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${e.rank}.`),mc(e,t)}}),cUe=se({reverse4d_:function lUe(n,t){const e=j(n,"x","reverse");return G(4===e.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${e.rank}.`),mc(e,t)}}),lY=se({round_:function uUe(n){const e={x:j(n,"x","round")};return ce.runKernel(xN,e)}}),cY=se({rsqrt_:function dUe(n){const e={x:j(n,"x","rsqrt","float32")};return ce.runKernel(IN,e)}}),uY=se({selu_:function hUe(n){const e={x:j(n,"x","selu")};return ce.runKernel(TN,e)}}),dY=se({separableConv2d_:function fUe(n,t,e,r,i,s=[1,1],o="NHWC"){const l=j(n,"x","separableConv2d"),c=j(t,"depthwiseFilter","separableConv2d"),u=j(e,"pointwiseFilter","separableConv2d");let f=l,m=!1;if(3===l.rank&&(m=!0,f=fe(l,[1,l.shape[0],l.shape[1],l.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");G(4===f.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${f.rank}.`),G(4===c.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),G(4===u.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),G(1===u.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),G(1===u.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const _=c.shape[2],y=c.shape[3];G(u.shape[2]===_*y,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${_*y}, but got ${u.shape[2]}.`);const w=qN(f,c,r,i,o,s),I=f_(w,u,1,"valid",o);return m?fe(I,[I.shape[1],I.shape[2],I.shape[3]]):I}});function hY(){return hY=(0,q.Z)(function*(n,t){const e=j(n,"x","setdiff1d"),r=j(t,"y","setdiff1d");G(e.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${e.dtype}) and y (${r.dtype}).`),G(1===e.rank,()=>`x should be 1D tensor, but got x (${e.shape}).`),G(1===r.rank,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=yield e.data(),s=yield r.data(),o=new Set(s);let l=0;for(let f=0;f<i.length;f++)o.has(i[f])||l++;const c=new Ds([l],e.dtype),u=new Ds([l],"int32");for(let f=0,m=0;f<i.length;f++)o.has(i[f])||(c.values[m]=i[f],u.values[m]=f,m++);return[c.toTensor(),u.toTensor()]}),hY.apply(this,arguments)}const mUe=function pUe(n,t){return hY.apply(this,arguments)},Fue=se({sign_:function gUe(n){const e={x:j(n,"x","sign")};return ce.runKernel(DN,e)}}),fY=se({sin_:function _Ue(n){const e={x:j(n,"x","sin","float32")};return ce.runKernel(SN,e)}}),pY=se({sinh_:function yUe(n){const e={x:j(n,"x","sinh")};return ce.runKernel(EN,e)}}),BV=se({slice1d_:function vUe(n,t,e){const r=j(n,"x","slice1d");return G(1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),_r(r,[t],[e])}}),mY=se({slice2d_:function bUe(n,t,e){const r=j(n,"x","slice2d");return G(2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),_r(r,t,e)}}),VV=se({slice3d_:function wUe(n,t,e){const r=j(n,"x","slice3d");return G(3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),_r(r,t,e)}}),tR=se({slice4d_:function CUe(n,t,e){const r=j(n,"x","slice4d");return G(4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),_r(r,t,e)}}),UV=se({softmax_:function xUe(n,t=-1){const e=j(n,"logits","softmax","float32");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and dim was ${t}`);return ce.runKernel(tV,{logits:e},{dim:t})}}),zV=se({fft_:function IUe(n){return G("complex64"===n.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`),ce.runKernel("FFT",{input:n})}}),nR=se({ifft_:function TUe(n){return G("complex64"===n.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`),ce.runKernel(gZ,{input:n})}}),gY=se({irfft_:function SUe(n){const t=n.shape[n.shape.length-1],e=n.size/t;let r;if(t<=2){const i=fe(n,[e,t]);r=nR(i)}else{const i=[e,2*(t-1)],s=fe(eR(n),[e,t]),o=fe(DV(n),[e,t]),l=mc(_r(s,[0,1],[e,t-2]),1),c=ue(mc(_r(o,[0,1],[e,t-2]),1),gn(-1)),u=ms([s,l],1),f=ms([o,c],1),m=fe(o_(u,f),[i[0],i[1]]);r=nR(m)}if(r=eR(r),3===n.rank&&0!==n.shape[0]){const i=r,s=n.shape[0];r=fe(r,[s,r.shape[0]/s,r.shape[1]]),i.dispose()}return r}}),Ml=se({split_:function EUe(n,t,e=0){const i={x:j(n,"x","split")};return ce.runKernel(eV,i,{numOrSizeSplits:t,axis:e})}}),HV=se({rfft_:function DUe(n,t){G("float32"===n.dtype,()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let e=n.shape[n.shape.length-1];const r=n.size/e;let i;if(null!=t&&t<e){const w=n.shape.map(I=>0),T=n.shape.map(I=>I);T[n.shape.length-1]=t,i=_r(n,w,T),e=t}else if(null!=t&&t>e){const w=n.shape.map(T=>T);w[n.shape.length-1]=t-e,i=ms([n,Ns(w)],n.shape.length-1),e=t}else i=n;const s=gr(i),o=fe(o_(i,s),[r,e]),l=zV(o),c=Math.floor(e/2)+1,u=eR(l),f=DV(l),m=Ml(u,[c,e-c],u.shape.length-1),_=Ml(f,[c,e-c],f.shape.length-1),y=i.shape.slice();return y[i.shape.length-1]=c,fe(o_(m[0],_[0]),y)}}),_Y=se({squaredDifference_:function kUe(n,t){let e=j(n,"a","squaredDifference"),r=j(t,"b","squaredDifference");return[e,r]=Hi(e,r),Bn(e.shape,r.shape),ce.runKernel(RN,{a:e,b:r},{})}}),t0=se({squeeze_:function AUe(n,t){const e=j(n,"x","squeeze","string_or_numeric");return fe(e,e_(e.shape,t).newShape)}}),Ol=se({stack_:function NUe(n,t=0){const e=yV(n,"tensors","stack","string_or_numeric");return G(e.length>=1,()=>"Pass at least one tensor to tf.stack"),e.length>0&&G(t<=e[0].rank,()=>"Axis must be <= rank of the tensor"),ce.runKernel(zB,e,{axis:t})}}),yT=se({step_:function RUe(n,t=0){const r={x:j(n,"x","step")};return ce.runKernel(LN,r,{alpha:t})}}),Pue=se({stridedSlice_:function MUe(n,t,e,r,i=0,s=0,o=0,l=0,c=0){const f={x:j(n,"x","stridedSlice","string_or_numeric")};return ce.runKernel(HZ,f,{begin:t,end:e,strides:r,beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:l,shrinkAxisMask:c})}}),Lue=se({tan_:function OUe(n){const e={x:j(n,"x","tan","float32")};return ce.runKernel(ON,e)}});function Ca(n,t){YI(n);const e=s_(n,t);if(1!==e.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return a_(n,null,e,t)}function rR(n,t,e){if(YI(n),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=s_(n,e);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return a_(n,t,r,e)}function FUe(n,t,e){if(YI(n),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");const r=s_(n,e);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return a_(n,t,r,e)}function PUe(n,t,e){if(YI(n),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");const r=s_(n,e);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return a_(n,t,r,e)}function LUe(n,t,e){if(YI(n),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");const r=s_(n,e);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return a_(n,t=t||r,r,e)}function $ue(n,t,e){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${t.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${i}.`;if(e.rank<i)throw new Error(s+` update.rank < ${i}. `);if(n.length<r+(e.rank-i))throw new Error(s+` Output shape length < ${r+(e.rank-i)}`);if(e.rank!==i+n.length-r)throw new Error(s+" update.rank != "+(i+n.length-r));for(let o=0;o<i;++o)if(e.shape[o]!==t.shape[o])throw new Error(s+` updates.shape[${o}] (${e.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<e.rank-i;++o)if(e.shape[o+i]!==n[o+r])throw new Error(s+` updates.shape[${o+i}] (${e.shape[o+i]}) != shape[${o+i}] (${n[o+i]})`)}function yY(n,t,e){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(0===e.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===n.size)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}$ue(e,t,n)}function n0(n,t,e){const r=t.shape.length,i=r>1?t.shape[r-1]:1,s=e.length;let o=1;for(let m=i;m<s;++m)o*=e[m];const l=i<1?1:i;return{sliceRank:i,numUpdates:Ye(t.shape)/l,sliceSize:o,strides:[...pn(e.slice(0,i)),1],outputSize:Ye(e)}}const BUe=se({tensorScatterUpdate_:function $Ue(n,t,e){const r=j(n,"tensor","tensorScatterupdate"),i=j(t,"indices","tensorScatterupdate","int32"),s=j(e,"updates","tensorScatterupdate");if(yY(s,i,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);return ce.runKernel(FZ,{tensor:r,indices:i,updates:s},{})}}),Bue=se({topk_:function VUe(n,t=1,e=!0){const r=j(n,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const s={x:r},o={k:t,sorted:e},[l,c]=ce.runKernel(qZ,s,o);return{values:l,indices:c}}}),vY=se({truncatedNormal_:function UUe(n,t=0,e=1,r,i){if(dc(n),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const s=new iY(t,e,r,!0,i),o=qn(n,r);for(let l=0;l<o.values.length;l++)o.values[l]=s.nextValue();return o.toTensor()}}),Vue=se({unique_:function zUe(n,t=0){const e=j(n,"x","unique","string_or_numeric");G(e.rank>0,()=>"The input tensor must be at least 1D");const r={x:e},i={axis:t},[s,o]=ce.runKernel(YZ,r,i);return{values:s,indices:o}}}),bY=se({unsortedSegmentSum_:function HUe(n,t,e){const r=j(n,"x","unsortedSegmentSum"),i=j(t,"segmentIds","unsortedSegmentSum","int32");return G(KI(e),()=>"numSegments must be of dtype int"),ce.runKernel(iV,{x:r,segmentIds:i},{numSegments:e})}}),cu=se({unstack_:function GUe(n,t=0){const e=j(n,"x","unstack","string_or_numeric");return G(t>=-e.shape.length&&t<e.shape.length,()=>`Axis = ${t} is not in [-${e.shape.length}, ${e.shape.length})`),ce.runKernel(rV,{value:e},{axis:t})}});function WUe(n,t){return nY(n,t,"right")}function Uue(n,t=!0,e,r){return ce.makeVariable(n,t,e,r)}function wY(n,t){const e=[];for(let s=0;s<t.length;s++)t[s]&&e.push(s);const r=qn(n,"int32"),i=qn([e.length,n.length],"int32");for(let s=0;s<e.length;s++){const o=r.indexToLoc(e[s]);i.values.set(o,s*n.length)}return i.toTensor()}function CY(){return CY=(0,q.Z)(function*(n){const t=j(n,"condition","whereAsync","bool"),e=yield t.data(),r=wY(t.shape,e);return n!==t&&t.dispose(),r}),CY.apply(this,arguments)}const zue=function jUe(n){return CY.apply(this,arguments)};function xY(){return xY=(0,q.Z)(function*(n,t,e){const r=j(n,"tensor","boolMask"),i=j(t,"mask","boolMask","bool"),s=e??0,o=i.rank,l=r.shape;G(o>0,()=>"mask cannot be scalar"),El(l.slice(s,s+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let T=s;T<s+o;T++)c*=l[T];const u=l.slice(0,s).concat([c],l.slice(s+o)),f=fe(r,u),m=fe(i,[-1]),_=yield zue(m),y=t0(_,[1]),w=XN(f,y,s);return n!==r&&r.dispose(),t!==i&&i.dispose(),y.dispose(),f.dispose(),m.dispose(),_.dispose(),w}),xY.apply(this,arguments)}const ZUe=function qUe(n,t,e){return xY.apply(this,arguments)},yr=se({transpose_:function YUe(n,t,e){const r=j(n,"x","transpose");if(null==t&&(t=r.shape.map((o,l)=>l).reverse()),G(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(o=>{G(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();const i={x:r},s={perm:t};return"complex64"===r.dtype?Ie(()=>{let o=eR(r),l=DV(r);return o=ce.runKernel(tT,{x:o},s),l=ce.runKernel(tT,{x:l},s),e&&(l=pi(l)),o_(o,l)}):ce.runKernel(tT,i,s)}}),QUe=se({movingAverage_:function KUe(n,t,e,r,i=!0){const s=j(n,"v","movingAverage"),o=j(t,"x","movingAverage"),l=j(e,"decay","movingAverage");(function bLe(n,t){G(n.dtype===t.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${t.dtype}) input must match`)})(s,o),G(dr(s.shape,o.shape),()=>"Shape mismatch in v and x");const c=gn(1),u=Kt(c,l);let f=ue(Kt(o,s),u);if(i){G(null!=r,()=>"When using zeroDebias: true, step is required.");const m=j(r,"step","movingAverage");f=ln(f,Kt(c,gp(l,m)))}return dt(s,f)}}),JUe=se({scatterND_:function XUe(n,t,e){dc(e);const r=j(n,"indices","scatterND","int32"),i=j(t,"updates","scatterND");return yY(i,r,e),ce.runKernel(OZ,{indices:r,updates:i},{shape:e})}}),nze=se({sparseToDense_:function tze(n,t,e,r=0){dc(e);const i=j(n,"sparseIndices","sparseToDense","int32"),s=j(t,"sparseValues","sparseToDense","string_or_numeric"),o=j(r,"defaultValue","sparseToDense",s.dtype);return function eze(n,t,e,r){if("int32"!==n.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const i=n.rank>0?n.shape[0]:1,s=n.rank>1?n.shape[1]:1;if(e.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${e.length}, should be: ${s}.`);if(0!==t.rank&&(1!==t.rank||t.size!==i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,s,e,o),ce.runKernel(UZ,{sparseIndices:i,sparseValues:s,defaultValue:o},{outputShape:e})}}),ize=se({gatherND_:function rze(n,t){const e=j(t,"indices","gatherND","int32"),i={params:j(n,"x","gatherND","string_or_numeric"),indices:e};return ce.runKernel(mZ,i)}}),Hue=se({dropout_:function oze(n,t,e,r){const i=j(n,"x","dropout");if(G("float32"===i.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),G(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),0===t)return n instanceof fi?i.clone():i;const s=function sze(n,t){if(null==t)return n.shape.slice();if(dr(n.shape,t))return t;if(n.shape.length===t.length){const e=[];for(let r=0;r<n.shape.length;r++)e.push(null==t[r]&&null!=n.shape[r]?n.shape[r]:t[r]);return e}return t}(i,e),o=1-t,l=ln(QN(dt(e0(s,0,1,"float32",r),o)),o);return ue(i,l)}});function Gue(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function IY(n,t,e){const r=1-n%2,i=new Float32Array(n);for(let s=0;s<n;++s){const o=2*Math.PI*s/(n+r-1);i[s]=t-e*Math.cos(o)}return Ca(i,"float32")}function TY(){return TY=(0,q.Z)(function*(n,t,e=1){const r=j(n,"predictions","inTopK"),i=j(t,"targets","inTopK");G(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),G(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),El(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];G(e>0&&e<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${e}`);const o=yield r.data(),l=yield i.data(),[c,u]=[o.length/s,s],f=vo("bool",c);for(let m=0;m<c;m++){const _=m*u,y=o.subarray(_,_+u),w=[];for(let T=0;T<y.length;T++)w.push({value:y[T],index:T});w.sort((T,I)=>I.value-T.value),f[m]=0;for(let T=0;T<e;T++)if(w[T].index===l[m]){f[m]=1;break}}return n!==r&&r.dispose(),t!==i&&i.dispose(),iu(f,i.shape,"bool")}),TY.apply(this,arguments)}const lze=function aze(n,t){return TY.apply(this,arguments)},SY=se({conv2DBackpropFilter_:function cze(n,t,e,r,i,s="NHWC",o){let l=n;3===n.rank&&(l=fe(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=t;3===c.rank&&(c=fe(t,[1,t.shape[0],t.shape[1],t.shape[2]])),G(4===l.rank,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${l.shape}.`),G(4===c.rank,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),G(4===e.length,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`);const u="NHWC"===s?l.shape[3]:l.shape[1],f="NHWC"===s?c.shape[3]:c.shape[1];return G(u===e[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${e[2]}.`),G(f===e[3],()=>`Error in conv2dDerFilter: depth of dy (${f}) must match output depth for filter (${e[3]}).`),ba("conv2dDerFilter",i,o),ce.runKernel(Q5,{x:l,dy:c},{strides:r,pad:i,dataFormat:s,dimRoundingMode:o,filterShape:e})}});function GV(n,t,e){if(null==e||"linear"===e)return n;if("relu"===e)return ue(n,yT(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function WV(n,t){let e=t;const r=As(n.shape,t.shape);return r.length>0&&(e=tn(e,r)),fe(e,n.shape)}function jV(n,t,e,r){if("linear"===t)return n;if("relu"===t)return wh(n);if("elu"===t)return ZN(n);if("relu6"===t)return aY(n);if("prelu"===t)return LV(n,e);if("leakyrelu"===t)return kV(n,r);if("sigmoid"===t)return vh(n);throw new Error(`Unknown fused activation ${t}.`)}const qV=(n,t)=>!(n>0)||"linear"===t,Wue=se({fusedConv2d_:function uze({x:n,filter:t,strides:e,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:f}){if(!1===qV(ce.state.gradientDepth,c=c||"linear")){G("NHWC"===i,()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let V=f_(n,t,e,r,i,s,o);return null!=l&&(V=dt(V,l)),jV(V,c,u,f)}const m=j(n,"x","conv2d","float32"),_=j(t,"filter","conv2d","float32");let y=m,w=!1;3===m.rank&&(w=!0,y=fe(m,[1,m.shape[0],m.shape[1],m.shape[2]])),G(4===y.rank,()=>`Error in fused conv2d: input must be rank 4, but got rank ${y.rank}.`),G(4===_.rank,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${_.rank}.`),ba("fused conv2d",r,o);const T="NHWC"===i?y.shape[3]:y.shape[1];G(_.shape[2]===T,()=>`Error in conv2d: depth of input (${T}) must match input depth for filter ${_.shape[2]}.`),G(wo(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`);const I=Ys(y.shape,_.shape,e,s,r,o);let E,A;if(null!=l&&(E=j(l,"bias","fused conv2d"),[E]=Hi(E,m),"NHWC"===i?Bn(I.outShape,E.shape):(G(E.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${E.shape.length}.`),G(0===E.shape.length||E.shape[0]===I.outChannels||1===E.shape[0],()=>`Error in fused conv2d: bias shape (${E.shape}) is not compatible with the number of output channels (${I.outChannels})`))),null!=u){const V=u.shape;if(G(V.length<=1||3===V.length,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${V.length}.`),1===V.length)G(1===V[0]||V[0]===I.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${V}) is not compatible with the number of output channels (${I.outChannels}).`);else if(3===V.length)try{Bn(V,I.outShape)}catch{throw Error(`Error in fused conv2d: PReLU activation weights (${V}) is not compatible with the output shape of the conv2d (${I.outShape}).`)}A=j(u,"prelu weights","fused conv2d")}const M=(V,Z)=>{G("NHWC"===i,()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[Q,re,oe,ye]=Z,Ve=GV(V,oe,c);G(h_(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const Qe=[j8(re.shape,Ve,Q,e,r),SY(re,Ve,Q.shape,e,r)];if(null!=ye){const ge=WV(ye,Ve);Qe.push(ge)}return Qe},O={x:y,filter:_,bias:E,preluActivationWeights:A},$={strides:e,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:c,leakyreluAlpha:f};return null==l?mp((Z,Q,re)=>{let oe=ce.runKernel(aV,O,$);return re([Q,Z,oe]),w&&(oe=fe(oe,[oe.shape[1],oe.shape[2],oe.shape[3]])),{value:oe,gradFunc:M}})(y,_):mp((Z,Q,re,oe)=>{let ye=ce.runKernel(aV,O,$);return oe([Q,Z,ye,re]),w&&(ye=fe(ye,[ye.shape[1],ye.shape[2],ye.shape[3]])),{value:ye,gradFunc:M}})(y,_,E)}}),jue=se({depthwiseConv2dNativeBackpropFilter_:function dze(n,t,e,r,i,s=[1,1],o){let l=n;3===n.rank&&(l=fe(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=t;return 3===c.rank&&(c=fe(t,[1,t.shape[0],t.shape[1],t.shape[2]])),ce.runKernel(iZ,{x:l,dy:c},{strides:r,pad:i,dimRoundingMode:o,dilations:s,filterShape:e})}}),que=se({depthwiseConv2dNativeBackpropInput_:function hze(n,t,e,r,i,s=[1,1],o){let l=t,c=!1;3===t.rank&&(c=!0,l=fe(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const m=ce.runKernel(sZ,{dy:l,filter:e},{strides:r,pad:i,dimRoundingMode:o,dilations:s,inputShape:n});return c?fe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),pze=se({fusedDepthwiseConv2d_:function fze({x:n,filter:t,strides:e,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:f}){if(!1===qV(ce.state.gradientDepth,c)){let $=qN(n,t,e,r,i,s,o);return null!=l&&($=dt($,l)),jV($,c,u,f)}const m=j(n,"x","depthwiseConv2d","float32"),_=j(t,"filter","depthwiseConv2d","float32");let y=m,w=!1;3===m.rank&&(w=!0,y=fe(m,[1,m.shape[0],m.shape[1],m.shape[2]])),G(4===y.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${y.rank}.`),G(4===_.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${_.rank}.`),G(y.shape[3]===_.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${y.shape[3]}) must match the inChannels dimension in filter ${_.shape[2]}.`),null==s&&(s=[1,1]),G(wo(e,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),ba("fused depthwiseConv2d",r,o);const T=Ys(y.shape,_.shape,e,s,r,o,!0);let I,E;null!=l&&(I=j(l,"bias","fused conv2d"),[I]=Hi(I,m),Bn(T.outShape,I.shape)),null!=u&&(E=j(u,"prelu weights","fused depthwiseConv2d"));const A=($,V)=>{G(h_(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[Z,Q,re,oe]=V,ye=GV($,re,c),Ve=que(Q.shape,ye,Z,e,r,s,o),We=jue(Q,ye,Z.shape,e,r,s,o);return null!=oe?[Ve,We,WV(I,ye)]:[Ve,We]},M={x:y,filter:_,bias:I,preluActivationWeights:E},O={strides:e,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:c,leakyreluAlpha:f};return null==l?mp((V,Z,Q)=>{let re=ce.runKernel(lV,M,O);return Q([Z,V,re]),w&&(re=fe(re,[re.shape[1],re.shape[2],re.shape[3]])),{value:re,gradFunc:A}})(y,_):mp((V,Z,Q,re)=>{let oe=ce.runKernel(lV,M,O);return re([Z,V,oe,Q]),w&&(oe=fe(oe,[oe.shape[1],oe.shape[2],oe.shape[3]])),{value:oe,gradFunc:A}})(y,_,I)}}),EY=se({fusedMatMul_:function mze({a:n,b:t,transposeA:e=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:o,leakyreluAlpha:l=.2}){if(!1===qV(ce.state.gradientDepth,s)){let ye=ir(n,t,e,r);return null!=i&&(ye=dt(ye,i)),jV(ye,s,o,l)}let c=j(n,"a","fused matMul"),u=j(t,"b","fused matMul");[c,u]=Hi(c,u);const f=e?c.shape[c.rank-2]:c.shape[c.rank-1],m=r?u.shape[u.rank-1]:u.shape[u.rank-2],_=e?c.shape[c.rank-1]:c.shape[c.rank-2],y=r?u.shape[u.rank-2]:u.shape[u.rank-1],w=c.shape.slice(0,-2),T=u.shape.slice(0,-2),I=Ye(w),E=Ye(T);G(f===m,()=>`Error in fused matMul: inner shapes (${f}) and (${m}) of Tensors with shapes ${c.shape} and ${u.shape} and transposeA=${e} and transposeB=${r} must match.`);const M=Bn(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([_,y]),O=fe(c,e?[I,f,_]:[I,_,f]),$=fe(u,r?[E,y,m]:[E,m,y]);let V,Z;null!=i&&(V=j(i,"bias","fused matMul"),[V]=Hi(V,c),Bn(M,V.shape)),null!=o&&(Z=j(o,"prelu weights","fused matMul"));const Q=(ye,Ve)=>{const[We,Ke,Qe,ge]=Ve,we=GV(fe(ye,Qe.shape),Qe,s);let _e,ze;return e||r?!e&&r?(_e=ir(we,Ke,!1,!1),ze=ir(we,We,!0,!1)):e&&!r?(_e=ir(Ke,we,!1,!0),ze=ir(We,we,!1,!1)):(_e=ir(Ke,we,!0,!0),ze=ir(we,We,!0,!0)):(_e=ir(we,Ke,!1,!0),ze=ir(We,we,!0,!1)),null!=i?[_e,ze,WV(ge,we)]:[_e,ze]},re={a:O,b:$,bias:V,preluActivationWeights:Z},oe={transposeA:e,transposeB:r,activation:s,leakyreluAlpha:l};return null==i?mp((Ve,We,Ke)=>{const Qe=ce.runKernel(oV,re,oe);return Ke([Ve,We,Qe]),{value:fe(Qe,M),gradFunc:Q}})(O,$):mp((Ve,We,Ke,Qe)=>{const ge=ce.runKernel(oV,re,oe);return Qe([Ve,We,ge,Ke]),{value:fe(ge,M),gradFunc:Q}})(O,$,V)}}),_ze=se({hammingWindow_:function gze(n){return IY(n,.54,.46)}}),Zue=se({hannWindow_:function yze(n){return IY(n,.5,.5)}}),Yue=se({frame_:function vze(n,t,e,r=!1,i=0){let s=0;const o=[];for(;s+t<=n.size;)o.push(_r(n,s,t)),s+=e;if(r)for(;s<n.size;){const l=s+t-n.size,c=ms([_r(n,s,t-l),cT([l],i)]);o.push(c),s+=e}return 0===o.length?rR([],[0,t]):fe(ms(o),[o.length,t])}}),wze=se({stft_:function bze(n,t,e,r,i=Zue){null==r&&(r=Gue(t));const s=Yue(n,t,e),o=ue(s,i(t));return HV(o,r)}}),xze=se({cropAndResize_:function Cze(n,t,e,r,i="bilinear",s=0){const o=j(n,"image","cropAndResize"),l=j(t,"boxes","cropAndResize","float32"),c=j(e,"boxInd","cropAndResize","int32"),u=l.shape[0];return G(4===o.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),G(2===l.rank&&4===l.shape[1],()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${l.shape}.`),G(1===c.rank&&c.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${l.shape}.`),G(2===r.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),G(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),G("bilinear"===i||"nearest"===i,()=>`method must be bilinear or nearest, but was ${i}`),ce.runKernel(tZ,{image:o,boxes:l,boxInd:c},{method:i,extrapolationValue:s,cropSize:r})}}),Tze=se({flipLeftRight_:function Ize(n){const t=j(n,"image","flipLeftRight","float32");return G(4===t.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`),ce.runKernel(pZ,{image:t},{})}}),Eze=se({grayscaleToRGB_:function Sze(n){const t=j(n,"image","grayscaleToRGB"),e=t.rank-1,r=t.shape[e];G(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),G(1===r,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(t.rank);return i.fill(1,0,e),i[e]=3,lu(t,i)}}),kze=se({rgbToGrayscale_:function Dze(n){const t=j(n,"image","RGBToGrayscale"),r=t.shape[t.rank-1];G(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),G(3===r,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const i=t.dtype,s=Pt(t,"float32"),o=Ca([.2989,.587,.114]);let l;switch(t.rank){case 2:l=pT("ij,j->i",s,o);break;case 3:l=pT("ijk,k->ij",s,o);break;case 4:l=pT("ijkl,l->ijk",s,o);break;case 5:l=pT("ijklm,m->ijkl",s,o);break;case 6:l=pT("ijklmn,n->ijklm",s,o);break;default:throw new Error("Not a valid tensor rank.")}return l=wa(l,-1),Pt(l,i)}}),Nze=se({rotateWithOffset_:function Aze(n,t,e=0,r=.5){const i=j(n,"image","rotateWithOffset","float32");return G(4===i.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`),ce.runKernel(QZ,{image:i},{radians:t,fillValue:e,center:r})}});function vT(n,t,e,r,i,s){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==s&&(s=0);const o=n.shape[0];return e=Math.min(e,o),G(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),G(2===n.rank,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),G(4===n.shape[1],()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),G(1===t.rank,()=>"scores must be a 1D tensor"),G(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),G(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:e,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}const Mze=se({nonMaxSuppression_:function Rze(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY){const s=j(n,"boxes","nonMaxSuppression","float32"),o=j(t,"scores","nonMaxSuppression","float32"),l=vT(s,o,e,r,i);return ce.runKernel(IZ,{boxes:s,scores:o},{maxOutputSize:e=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:i=l.scoreThreshold})}});function Oze(n,t,e){const r=function Fze(n,t,e){return function Lze(n,t,e){let r=0,i=n.length,s=0,o=!1;for(;r<i;){s=r+(i-r>>>1);const l=e(t,n[s]);l>0?r=s+1:(i=s,o=!l)}return o?r:-r-1}(n,t,e||Pze)}(n,t,e);n.splice(r<0?-(r+1):r,0,t)}function Pze(n,t){return n>t?1:n<t?-1:0}function DY(n,t,e,r,i){return NY(n,t,e,r,i,0)}function kY(n,t,e,r,i,s){return NY(n,t,e,r,i,0,!1,s,!0)}function AY(n,t,e,r,i,s){return NY(n,t,e,r,i,s,!0)}function NY(n,t,e,r,i,s,o=!1,l=!1,c=!1){const u=[];for(let I=0;I<t.length;I++)t[I]>i&&u.push({score:t[I],boxIndex:I,suppressBeginIndex:0});u.sort(Kue);const f=s>0?-.5/s:0,m=[],_=[];for(;m.length<e&&u.length>0;){const I=u.pop(),{score:E,boxIndex:A,suppressBeginIndex:M}=I;if(E<i)break;let O=!1;for(let $=m.length-1;$>=M;--$){const V=$ze(n,A,m[$]);if(V>=r){O=!0;break}if(I.score=I.score*Bze(r,f,V),I.score<=i)break}I.suppressBeginIndex=m.length,O||(I.score===E?(m.push(A),_.push(I.score)):I.score>i&&Oze(u,I,Kue))}const y=m.length,w=e-y;l&&w>0&&(m.push(...new Array(w).fill(0)),_.push(...new Array(w).fill(0)));const T={selectedIndices:m};return o&&(T.selectedScores=_),c&&(T.validOutputs=y),T}function $ze(n,t,e){const r=n.subarray(4*t,4*t+4),i=n.subarray(4*e,4*e+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),l=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),f=Math.min(i[1],i[3]),m=Math.max(i[0],i[2]),_=Math.max(i[1],i[3]),y=(l-s)*(c-o),w=(m-u)*(_-f);if(y<=0||w<=0)return 0;const T=Math.max(s,u),I=Math.max(o,f),E=Math.min(l,m),A=Math.min(c,_),M=Math.max(E-T,0)*Math.max(A-I,0);return M/(y+w-M)}function Bze(n,t,e){const r=Math.exp(t*e*e);return e<=n?r:0}function Kue(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}function RY(){return RY=(0,q.Z)(function*(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY){const s=j(n,"boxes","nonMaxSuppressionAsync"),o=j(t,"scores","nonMaxSuppressionAsync"),l=vT(s,o,e,r,i);e=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold;const c=yield Promise.all([s.data(),o.data()]),u=c[0],f=c[1],{selectedIndices:m}=DY(u,f,e,r,i);return s!==n&&s.dispose(),o!==t&&o.dispose(),Ca(m,"int32")}),RY.apply(this,arguments)}const Hze=se({nonMaxSuppressionWithScore_:function zze(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=j(n,"boxes","nonMaxSuppression"),l=j(t,"scores","nonMaxSuppression"),c=vT(o,l,e,r,i,s),m=ce.runKernel(SZ,{boxes:o,scores:l},{maxOutputSize:e=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:i=c.scoreThreshold,softNmsSigma:s=c.softNmsSigma});return{selectedIndices:m[0],selectedScores:m[1]}}});function MY(){return MY=(0,q.Z)(function*(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=j(n,"boxes","nonMaxSuppressionAsync"),l=j(t,"scores","nonMaxSuppressionAsync"),c=vT(o,l,e,r,i,s);e=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,s=c.softNmsSigma;const u=yield Promise.all([o.data(),l.data()]),f=u[0],m=u[1],{selectedIndices:_,selectedScores:y}=AY(f,m,e,r,i,s);return o!==n&&o.dispose(),l!==t&&l.dispose(),{selectedIndices:Ca(_,"int32"),selectedScores:Ca(y)}}),MY.apply(this,arguments)}const qze=se({nonMaxSuppressionPadded_:function jze(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=j(n,"boxes","nonMaxSuppression"),l=j(t,"scores","nonMaxSuppression"),c=vT(o,l,e,r,i,null),w=ce.runKernel(TZ,{boxes:o,scores:l},{maxOutputSize:c.maxOutputSize,iouThreshold:c.iouThreshold,scoreThreshold:c.scoreThreshold,padToMaxOutputSize:s});return{selectedIndices:w[0],validOutputs:w[1]}}});function OY(){return OY=(0,q.Z)(function*(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=j(n,"boxes","nonMaxSuppressionAsync"),l=j(t,"scores","nonMaxSuppressionAsync"),c=vT(o,l,e,r,i,null),u=c.maxOutputSize,f=c.iouThreshold,m=c.scoreThreshold,[_,y]=yield Promise.all([o.data(),l.data()]),{selectedIndices:w,validOutputs:T}=kY(_,y,u,f,m,s);return o!==n&&o.dispose(),l!==t&&l.dispose(),{selectedIndices:Ca(w,"int32"),validOutputs:gn(T,"int32")}}),OY.apply(this,arguments)}const Que=se({resizeBilinear_:function Kze(n,t,e=!1,r=!1){const i=j(n,"images","resizeBilinear");G(3===i.rank||4===i.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),G(2===t.length,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),G(!1===r||!1===e,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;3===i.rank&&(o=!0,s=fe(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=t,u=ce.runKernel(ZB,{images:s},{alignCorners:e,halfPixelCenters:r,size:t});return o?fe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),Xue=se({resizeNearestNeighbor_:function Qze(n,t,e=!1,r=!1){const i=j(n,"images","resizeNearestNeighbor");G(3===i.rank||4===i.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),G(2===t.length,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),G("float32"===i.dtype||"int32"===i.dtype,()=>"`images` must have `int32` or `float32` as dtype"),G(!1===r||!1===e,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;3===i.rank&&(o=!0,s=fe(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=t,u=ce.runKernel(qB,{images:s},{alignCorners:e,halfPixelCenters:r,size:t});return o?fe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),e4e=se({threshold_:function Xze(n,t="binary",e=!1,r=.5){const i=j(n,"image","threshold"),c=i.shape[0]*i.shape[1];let f,m,_,y,u=ue(Ca([r]),255);if(G(3===i.rank,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),G(3===i.shape[2]||1===i.shape[2],()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),G("int32"===i.dtype||"float32"===i.dtype,()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),G("otsu"===t||"binary"===t,()=>`Method must be binary or otsu, but was ${t}`),3===i.shape[2]){[f,m,_]=Ml(i,[1,1,1],-1);const I=ue(f,.2989),E=ue(m,.587),A=ue(_,.114);y=dt(dt(I,E),A)}else y=n;"otsu"===t&&(u=function Jze(n,t){let s,o,l,c,u,f,e=Ca([-1]),r=Ca([0]),i=Ca([0]);for(let m=0;m<n.size-1;m++){s=_r(n,0,m+1),o=_r(n,m+1),u=ln(tn(s),t),f=ln(tn(o),t);const _=tn(ue(s,_T(0,s.size)));l=ln(_,tn(s));const y=cT(o.shape,s.size),w=dt(_T(0,o.size),y),T=ue(o,w);c=ln(tn(T),tn(o));const I=Kt(l,c),E=Kt(l,c),A=ue(u,f);i=ue(ue(A,I),E);const M=Nl(i,r);r=Xo(M,i,r),e=Xo(M,Ca([m]),e)}return e}(oue(Pt(lY(y),"int32"),iu([]),256),c));const w=e?Xb(y,u):Nl(y,u);return Pt(ue(w,255),"int32")}}),n4e=se({transform_:function t4e(n,t,e="nearest",r="constant",i=0,s){const o=j(n,"image","transform","float32"),l=j(t,"transforms","transform","float32");return G(4===o.rank,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),G(2===l.rank&&(l.shape[0]===o.shape[0]||1===l.shape[0])&&8===l.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),G(null==s||2===s.length,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`),ce.runKernel(ZZ,{image:o,transforms:l},{interpolation:e,fillMode:r,fillValue:i,outputShape:s})}}),i4e=se({bandPart_:function r4e(n,t,e){const r=j(n,"a","bandPart");G(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[s,o]=r.shape.slice(-2);let l,c;"number"==typeof t?(G(t%1==0,()=>`bandPart(): numLower must be an integer, got ${t}.`),G(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),l=j(t<0?s:t,"numLower","bandPart")):(G("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),l=Xo(JN(t,0),s,Jb(t,s))),"number"==typeof e?(G(e%1==0,()=>`bandPart(): numUpper must be an integer, got ${e}.`),G(e<=o,()=>`bandPart(): numUpper (${e}) must not be greater than the number of columns (${o}).`),c=j(e<0?o:e,"numUpper","bandPart")):(G("int32"===e.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),c=Xo(JN(e,0),o,Jb(e,o)));const u=fe(_T(0,s,1,"int32"),[-1,1]),f=_T(0,o,1,"int32"),m=Kt(u,f),_=bh(Xb(m,l),m_(m,pi(c))),y=Ns([s,o],r.dtype);return fe(Ol(cu(fe(r,[-1,s,o])).map(w=>Xo(_,w,y))),i)}}),o4e=se({gramSchmidt_:function s4e(n){let t;if(Array.isArray(n)){t=!1,G(null!=n&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=n[0].shape[0];for(let s=1;s<n.length;++s)G(n[s].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[s].shape[0]} vs. ${i})`)}else t=!0,n=Ml(n,n.shape[0],0).map(i=>t0(i,[0]));G(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const e=[],r=n;for(let i=0;i<n.length;++i)e.push(ce.tidy(()=>{let s=r[i];if(i>0)for(let o=0;o<i;++o){const l=ue(tn(ue(e[o],s)),e[o]);s=Kt(s,l)}return ln(s,KN(s,"euclidean"))}));return t?Ol(e,0):e}});function Jue(n,t=!1){return ce.tidy(()=>{G(2===n.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const e=n.shape[0],r=n.shape[1];let i=J8(e),s=pp(n);const o=rR([[1]],[1,1]);let l=pp(o);const c=e>=r?r:e;for(let u=0;u<c;++u){const f=s,m=l,_=i;[l,s,i]=ce.tidy(()=>{const y=_r(s,[u,u],[e-u,1]),w=KN(y),T=_r(s,[u,u],[1,1]),I=Xo(Nl(T,0),rR([[-1]]),rR([[1]])),E=Kt(T,ue(I,w)),A=ln(y,E);l=1===A.shape[0]?pp(o):ms([o,_r(A,[1,0],[A.shape[0]-1,A.shape[1]])],0);const M=pi(ln(ir(I,E),w)),O=_r(s,[u,0],[e-u,r]),$=ue(M,l),V=yr(l);if(0===u)s=Kt(O,ir($,ir(V,O)));else{const re=Kt(O,ir($,ir(V,O)));s=ms([_r(s,[0,0],[u,r]),re],0)}const Z=yr($),Q=_r(i,[0,u],[e,i.shape[1]-u]);if(0===u)i=Kt(Q,ir(ir(Q,l),Z));else{const re=Kt(Q,ir(ir(Q,l),Z));i=ms([_r(i,[0,0],[e,u]),re],1)}return[l,s,i]}),Qn([f,m,_])}return!t&&e>r&&(i=_r(i,[0,0],[e,r]),s=_r(s,[0,0],[r,r])),[i,s]})}const l4e=se({qr_:function a4e(n,t=!1){if(G(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),2===n.rank)return Jue(n,t);{const e=n.shape.slice(0,n.shape.length-2).reduce((c,u)=>c*u),r=cu(fe(n,[e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],s=[];return r.forEach(c=>{const[u,f]=Jue(c,t);i.push(u),s.push(f)}),[fe(Ol(i,0),n.shape),fe(Ol(s,0),n.shape)]}}});var xa=(()=>(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(xa||(xa={})),xa))();const bp=se({computeWeightedLoss_:function c4e(n,t,e=xa.SUM_BY_NONZERO_WEIGHTS){const r=j(n,"losses","computeWeightedLoss");let i=null;null!=t&&(i=j(t,"weights","computeWeightedLoss"));const s=null==i?r:ue(r,i);if(e===xa.NONE)return s;if(e===xa.SUM)return tn(s);if(e===xa.MEAN){if(null==i)return Gi(s);{const o=r.size/i.size,l=ln(tn(s),tn(i));return o>1?ln(l,gn(o)):l}}if(e===xa.SUM_BY_NONZERO_WEIGHTS){if(null==i)return ln(tn(s),gn(r.size));{const o=ue(i,Rl(r.shape)),l=Pt(tn(gT(o,gn(0))),"float32");return ln(tn(s),l)}}throw Error(`Unknown reduction: ${e}`)}}),d4e=se({absoluteDifference_:function u4e(n,t,e,r=xa.SUM_BY_NONZERO_WEIGHTS){const i=j(n,"labels","absoluteDifference"),s=j(t,"predictions","absoluteDifference");let o=null;null!=e&&(o=j(e,"weights","absoluteDifference")),El(i.shape,s.shape,"Error in absoluteDifference: ");const l=ks(Kt(i,s));return bp(l,o,r)}}),f4e=se({cosineDistance_:function h4e(n,t,e,r,i=xa.SUM_BY_NONZERO_WEIGHTS){const s=j(n,"labels","cosineDistance"),o=j(t,"predictions","cosineDistance");let l=null;null!=r&&(l=j(r,"weights","cosineDistance")),El(s.shape,o.shape,"Error in cosineDistance: ");const c=gn(1),u=Kt(c,tn(ue(s,o),e,!0));return bp(u,l,i)}}),m4e=se({hingeLoss_:function p4e(n,t,e,r=xa.SUM_BY_NONZERO_WEIGHTS){let i=j(n,"labels","hingeLoss");const s=j(t,"predictions","hingeLoss");let o=null;null!=e&&(o=j(e,"weights","hingeLoss")),El(i.shape,s.shape,"Error in hingeLoss: ");const l=gn(1);i=Kt(ue(gn(2),i),l);const c=wh(Kt(l,ue(i,s)));return bp(c,o,r)}}),_4e=se({huberLoss_:function g4e(n,t,e,r=1,i=xa.SUM_BY_NONZERO_WEIGHTS){const s=j(n,"labels","huberLoss"),o=j(t,"predictions","huberLoss");let l=null;null!=e&&(l=j(e,"weights","huberLoss")),El(s.shape,o.shape,"Error in huberLoss: ");const c=gn(r),u=ks(Kt(o,s)),f=Jb(u,c),m=Kt(u,f),_=dt(ue(gn(.5),Xr(f)),ue(c,m));return bp(_,l,i)}}),v4e=se({logLoss_:function y4e(n,t,e,r=1e-7,i=xa.SUM_BY_NONZERO_WEIGHTS){const s=j(n,"labels","logLoss"),o=j(t,"predictions","logLoss");let l=null;null!=e&&(l=j(e,"weights","logLoss")),El(s.shape,o.shape,"Error in logLoss: ");const c=gn(1),u=gn(r),f=pi(ue(s,fc(dt(o,u)))),m=ue(Kt(c,s),fc(dt(Kt(c,o),u))),_=Kt(f,m);return bp(_,l,i)}}),w4e=se({meanSquaredError_:function b4e(n,t,e,r=xa.SUM_BY_NONZERO_WEIGHTS){const i=j(n,"labels","meanSquaredError"),s=j(t,"predictions","meanSquaredError");let o=null;null!=e&&(o=j(e,"weights","meanSquaredError")),El(i.shape,s.shape,"Error in meanSquaredError: ");const l=_Y(i,s);return bp(l,o,r)}}),I4e=se({sigmoidCrossEntropy_:function x4e(n,t,e,r=0,i=xa.SUM_BY_NONZERO_WEIGHTS){let s=j(n,"multiClassLabels","sigmoidCrossEntropy");const o=j(t,"logits","sigmoidCrossEntropy");let l=null;if(null!=e&&(l=j(e,"weights","sigmoidCrossEntropy")),El(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=gn(r),f=gn(1),m=gn(.5);s=dt(ue(s,Kt(f,u)),ue(m,u))}const c=function C4e(n,t){const e=j(n,"labels","sigmoidCrossEntropyWithLogits"),r=j(t,"logits","sigmoidCrossEntropyWithLogits");El(e.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=wh(r),s=ue(r,e),o=AV(Al(pi(ks(r))));return dt(Kt(i,s),o)}(s,o);return bp(c,l,i)}}),E4e=se({softmaxCrossEntropy_:function S4e(n,t,e,r=0,i=xa.SUM_BY_NONZERO_WEIGHTS){let s=j(n,"onehotLabels","softmaxCrossEntropy");const o=j(t,"logits","softmaxCrossEntropy");let l=null;if(null!=e&&(l=j(e,"weights","softmaxCrossEntropy")),El(s.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const u=gn(r),f=gn(1),m=gn(s.shape[1]);s=dt(ue(s,Kt(f,u)),ln(u,m))}const c=function T4e(n,t,e=-1){if(-1===e&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${e}`);return mp((i,s,o)=>{const c=NV(s,[e],!0),u=Kt(Pt(s,"float32"),c);o([i,u]);const f=pi(ue(u,i));return{value:tn(f,[e]),gradFunc:(y,w)=>{const[T,I]=w,E=rs(y.shape,[e]);return[ue(fe(y,E),Kt(Pt(T,"float32"),Al(I))),ue(fe(y,E),Kt(Al(I),Pt(T,"float32")))]}}})(n,t)}(s,o);return bp(c,l,i)}}),k4e=se({sparseFillEmptyRows_:function D4e(n,t,e,r){const i=j(n,"indices","sparseFillEmptyRows","int32"),s=j(t,"values","sparseFillEmptyRows"),o=j(e,"denseShape","sparseFillEmptyRows","int32"),l=j(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(2!==i.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${i.shape}`);if(1!==s.rank)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(1!==o.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(0!==l.rank)throw new Error(`Default value should be a scalar but received shape ${l.shape}`);const u=ce.runKernel(LZ,{indices:i,values:s,denseShape:o,defaultValue:l});return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}}),N4e=se({sparseReshape_:function A4e(n,t,e){const r=j(n,"inputIndices","sparseReshape","int32"),i=j(t,"inputShape","sparseReshape","int32"),s=j(e,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${r.shape}`);if(1!==i.rank)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(1!==s.rank)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const l=ce.runKernel($Z,{inputIndices:r,inputShape:i,newShape:s});return{outputIndices:l[0],outputShape:l[1]}}}),M4e=se({sparseSegmentMean_:function R4e(n,t,e){const r=j(n,"data","sparseSegmentMean"),i=j(t,"indices","sparseSegmentMean","int32"),s=j(e,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${i.shape}`);if(1!==s.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${s.shape}`);return ce.runKernel(BZ,{data:r,indices:i,segmentIds:s})}}),F4e=se({sparseSegmentSum_:function O4e(n,t,e){const r=j(n,"data","sparseSegmentSum"),i=j(t,"indices","sparseSegmentSum","int32"),s=j(e,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${i.shape}`);if(1!==s.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${s.shape}`);return ce.runKernel(VZ,{data:r,indices:i,segmentIds:s})}}),L4e=se({stringNGrams_:function P4e(n,t,e,r,i,s,o,l){const c=j(n,"data","stringNGrams","string");if("string"!==c.dtype)throw new Error("Data must be of datatype string");if(1!==c.shape.length)throw new Error(`Data must be a vector, saw: ${c.shape}`);const u=j(t,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");const _=ce.runKernel(GZ,{data:c,dataSplits:u},{separator:e,nGramWidths:r,leftPad:i,rightPad:s,padWidth:o,preserveShortSequences:l});return{nGrams:_[0],nGramsSplits:_[1]}}}),B4e=se({stringSplit_:function $4e(n,t,e=!0){const r=j(n,"input","stringSplit","string"),i=j(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==i.rank)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const l=ce.runKernel(WZ,{input:r,delimiter:i},{skipEmpty:e});return{indices:l[0],values:l[1],shape:l[2]}}}),U4e=se({stringToHashBucketFast_:function V4e(n,t){const e=j(n,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");return ce.runKernel(jZ,{input:e},r)}}),H4e=se({staticRegexReplace_:function z4e(n,t,e,r=!0){const i=j(n,"input","staticRegexReplace","string");return ce.runKernel(nV,{x:i},{pattern:t,rewrite:e,replaceGlobal:r})}}),G4e={fft:zV,ifft:nR,rfft:HV,irfft:gY},W4e={hammingWindow:_ze,hannWindow:Zue,frame:Yue,stft:wze},sd={flipLeftRight:Tze,grayscaleToRGB:Eze,resizeNearestNeighbor:Xue,resizeBilinear:Que,rgbToGrayscale:kze,rotateWithOffset:Nze,cropAndResize:xze,nonMaxSuppression:Mze,nonMaxSuppressionAsync:function Vze(n,t,e){return RY.apply(this,arguments)},nonMaxSuppressionWithScore:Hze,nonMaxSuppressionWithScoreAsync:function Gze(n,t,e){return MY.apply(this,arguments)},nonMaxSuppressionPadded:qze,nonMaxSuppressionPaddedAsync:function Zze(n,t,e){return OY.apply(this,arguments)},threshold:e4e,transform:n4e},ede={bandPart:i4e,gramSchmidt:o4e,qr:l4e},j4e={absoluteDifference:d4e,computeWeightedLoss:bp,cosineDistance:f4e,hingeLoss:m4e,huberLoss:_4e,logLoss:v4e,meanSquaredError:w4e,sigmoidCrossEntropy:I4e,softmaxCrossEntropy:E4e},q4e={sparseFillEmptyRows:k4e,sparseReshape:N4e,sparseSegmentMean:M4e,sparseSegmentSum:F4e},Z4e={stringNGrams:L4e,stringSplit:B4e,stringToHashBucketFast:U4e,staticRegexReplace:H4e},bT=class Y4e{static sgd(t){return new E8(t)}static momentum(t,e,r=!1){return new Tce(t,e,r)}static rmsprop(t,e=.9,r=0,i=null,s=!1){return new Sce(t,e,r,i,s)}static adam(t=.001,e=.9,r=.999,i=null){return new xce(t,e,r,i)}static adadelta(t=.001,e=.95,r=null){return new wce(t,e,r)}static adamax(t=.002,e=.9,r=.999,i=null,s=0){return new Ice(t,e,r,i,s)}static adagrad(t,e=.1){return new Cce(t,e)}},K4e=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function tde(){return new Promise(n=>K4e(()=>n()))}function FY(n,t){const e=n[0].length;n.forEach((i,s)=>{G(i.length===e,()=>`Error in concat${e}D: rank of tensors[${s}] must be the same as the rank of the rest (${e})`)}),G(t>=0&&t<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);const r=n[0];n.forEach((i,s)=>{for(let o=0;o<e;o++)G(o===t||i[o]===r[o],()=>`Error in concat${e}D: Shape of tensors[${s}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function Ch(n,t){const e=n[0].slice();for(let r=1;r<n.length;r++)e[t]+=n[r][t];return e}var uu=(()=>(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"}(uu||(uu={})),uu))();function nde(n,t,e){let r=new Array;if(null==e&&null==t)return r;if(null==t)for(;r.length<n+e.length;)r.push(-1);else r=t.slice();if(null==e)return r;if(n+e.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${n+e.length}, but shape.rank = ${r.length}`);for(let i=1;i<e.length;++i){const s=e[i],o=r[r.length-e.length+i],l=r[o];if(s>=0)if(l>=0){if(l!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+n}] = ${s} but shape[${i+n}] = ${l}`)}else r[o]=s}return r}function rde(n){const t={FIRST_DIM_SIZE:uu.FIRST_DIM_SIZE,VALUE_ROWIDS:uu.VALUE_ROWIDS,ROW_LENGTHS:uu.ROW_LENGTHS,ROW_SPLITS:uu.ROW_SPLITS,ROW_LIMITS:uu.ROW_LIMITS,ROW_STARTS:uu.ROW_STARTS},e=[];for(const r of n){if(!(r in t))break;e.push(t[r])}return e}function ide(n){return 0===n.length?0:n[0]===uu.FIRST_DIM_SIZE?n.length-1:n.length}function sde(n,t){if(null==n||null==t)return;const e=n.length,r=t.length;if(e>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${e} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(e,r-1);++i){const s=n[i],o=t[i+1];if(s>=0&&o>=0&&1!==s&&s!==o)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-n.length}] = ${s} but ragged tensor input.flatValues.shape[${i-n.length}] = ${o}`)}}const PY=30;function ZV(n){return n<=PY?n:V5(n,Math.floor(Math.sqrt(n)))}function LY(n,t,e){return[e*("number"==typeof n?n:n[0]),t*("number"==typeof n?n:n[1])]}function iR(n,t,e,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(n[0]/e),i=i.concat(n.slice(1));else{i=i.concat(n[0]);const s=t.length;for(let o=0;o<s;++o)i=i.concat([n[o+1]/t[o],t[o]]);i=i.concat(n.slice(s+1))}return i}function sR(n,t,e=!0){const r=[];if(e){r.push(t);for(let i=t+1;i<n;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{const i=[],s=[];for(let o=1;o<n;++o)o>=2*t+1||o%2==1?s.push(o):i.push(o);r.push(...i),r.push(0),r.push(...s)}return r}function oR(n,t,e,r=!0){const i=[];i.push(r?n[0]/e:n[0]*e);for(let s=1;s<n.length;++s)i.push(s<=t.length?r?t[s-1]*n[s]:n[s]/t[s-1]:n[s]);return i}function $Y(n,t){const e=[0];for(let r=0;r<t;++r)e.push(n[r][0]);return e}function BY(n,t,e){const r=n.slice(0,1);for(let i=0;i<e;++i)r.push(n[i+1]-t[i][0]-t[i][1]);return r}function VY(n,t){const e=n.shape.length,r=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${e}`);if(0===Ye(n.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const i=t.shape,s=i[i.length-1];let o=1;for(let m=0;m<i.length-1;++m)o*=i[m];const l=n.shape,c=i.slice();c.pop();let u=1;for(let m=s;m<e;++m)u*=l[m],c.push(l[m]);const f=[...pn(n.shape).map(m=>m/u),1].slice(0,s);return[c,o,u,f]}const YV=1.7580993408473768,KV=1.0507009873554805,UY=.3275911,zY=.254829592,HY=-.284496736,GY=1.421413741,WY=-1.453152027,jY=1.061405429;function wp(n,t){if(n.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${t.length}.`);const e=new Float32Array(2*n.length);for(let r=0;r<e.length;r+=2)e[r]=n[r/2],e[r+1]=t[r/2];return e}function ode(n){const t=new Float32Array(n.length/2),e=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)t[r/2]=n[r],e[r/2]=n[r+1];return{real:t,imag:e}}function ade(n){const t=Math.ceil(n.length/4),e=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<n.length;i+=4)e[Math.floor(i/4)]=n[i],r[Math.floor(i/4)]=n[i+1];return{real:e,imag:r}}function lde(n){const t=Math.floor(n.length/4),e=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<n.length;i+=4)e[Math.floor(i/4)]=n[i],r[Math.floor(i/4)]=n[i+1];return{real:e,imag:r}}function qY(n,t){return{real:n[2*t],imag:n[2*t+1]}}function cde(n,t,e,r){n[2*r]=t,n[2*r+1]=e}function ude(n,t){const e=new Float32Array(n/2),r=new Float32Array(n/2);for(let i=0;i<Math.ceil(n/2);i++){const s=(t?2:-2)*Math.PI*(i/n);e[i]=Math.cos(s),r[i]=Math.sin(s)}return{real:e,imag:r}}function dde(n,t,e){const r=(e?2:-2)*Math.PI*(n/t);return{real:Math.cos(r),imag:Math.sin(r)}}const Q4e=/->/g;function YY(n,t){const e=((n=n.replace(/\s/g,"")).length-n.replace(Q4e,"").length)/"->".length;if(e<1)throw new Error("Equations without an arrow are not supported.");if(e>1)throw new Error('Equation must contain exactly one arrow ("->").');const[r,i]=n.split("->");G(-1===r.indexOf("..."),()=>'The ellipsis notation ("...") is not supported yet.');const s=r.split(","),o=s.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const l=[];for(let _=0;_<i.length;++_){const y=i[_];if(!s.some(w=>-1!==w.indexOf(y)))throw new Error(`Output subscripts contain the label ${y} not present in the input subscripts.`);-1===l.indexOf(y)&&l.push(y)}for(let _=0;_<r.length;++_){const y=r[_];-1===l.indexOf(y)&&","!==y&&l.push(y)}const c=new Array(s.length);for(let _=0;_<o;++_){if(new Set(s[_].split("")).size!==s[_].length)throw new Error(`Found duplicate axes in input component ${s[_]}. Support for duplicate axes in input is not implemented yet.`);c[_]=[];for(let y=0;y<s[_].length;++y)c[_].push(l.indexOf(s[_][y]))}const u=l.length,m=[];for(let _=i.length;_<u;++_)m.push(_);return{allDims:l,summedDims:m,idDims:c}}function KY(n,t){let e=new Array(n);e.fill(-1);for(let i=0;i<t.length;++i)e[t[i]]=i;const r=[];for(let i=0;i<n;++i)-1===e[i]&&r.push(i);return e=e.filter(i=>-1!==i),{permutationIndices:e,expandDims:r}}function QY(n,t,e){const r=new Array(n);for(let i=0;i<e.length;++i){const s=e[i].shape;for(let o=0;o<t[i].length;++o)void 0===r[t[i][o]]?r[t[i][o]]=s[o]:G(r[t[i][o]]===s[o],()=>`Expected dimension ${r[t[i][o]]} at axis ${o} of input shaped ${JSON.stringify(s)}, but got dimension ${s[o]}`)}}function XY(n,t){const e=n,r=[];let i=0;0===n.length&&e.push(-1),i=n.length+1;for(let o=0;o<i;++o)r.push([]);const s=[];for(let o=0;o<e.length;++o){const c=X4e(t,e[o]);for(const u of c)-1===s.indexOf(u)&&(r[o].push(u),s.push(u))}return{path:e,steps:r}}function JY(n){return n.every((t,e)=>t===e)}function X4e(n,t){const e=[];for(let r=0;r<n.length;++r)(0===n[r].length||-1!==n[r].indexOf(t)||-1===t)&&e.push(r);return e}function eK(n,t,e=0){let r=[];if("number"==typeof t)G(n.shape[e]%t==0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(n.shape[e]/t);else{G(t.reduce((o,l)=>(-1===l&&(o+=1),o),0)<=1,()=>"There should be only one negative value in split array.");const s=t.indexOf(-1);if(-1!==s){const o=t.reduce((l,c)=>c>0?l+c:l);t[s]=n.shape[e]-o}G(n.shape[e]===t.reduce((o,l)=>o+l),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}function pde(n){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${n}`}function mde(n,t){return`indices(${n}, 0) is invalid: ${t} < 0`}function gde(n,t,e){return`indices(${n}, 0) is invalid: ${t} >= ${e}`}function _de(n,t){return`only one output dimension may be -1, not both ${n} and ${t}`}function yde(n,t){return`size ${n} must be non-negative, not ${t}`}function vde(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function bde(n,t){return`Input to reshape is a SparseTensor with ${Ye(n)}\n  dense values, but the requested shape requires a multiple of ${Ye(t)}. inputShape=${n} outputShape= ${t}`}function wde(n,t){return`Input to reshape is a tensor with ${Ye(n)} dense values, but the requested shape has ${Ye(t)}. inputShape=${n} outputShape=${t}`}function tK(){return"segment ids must be >= 0"}function Cde(){return"segment ids are not increasing"}function xde(n,t){return`Segment id ${n} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function Ide(n,t,e){return`Bad: indices[${n}] == ${t} out of range [0, ${e})`}function Tde(n,t){let r,e=!1;for(n<=PY?(r=n,e=!0):r=V5(n,Math.floor(Math.sqrt(n)));!e;)r>t||r===n?e=!0:r=V5(n,r+1);return r}function Sde(n,t,e){const r=[],i=n.length;for(let s=0;s<i;s++)r.push(s!==t?n[s]:e);return r}function nK(n,t,e,r){const i=t.shape.length,s=n.shape.length;if(0!==r&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${s}).`);if(e<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${e}).`);for(let m=0;m<r;++m)if(n.shape[m]!==t.shape[m])throw new Error(`x.shape[${m}]: ${n.shape[m]} should be equal to indices.shape[${m}]: ${t.shape[m]}.`);const o=n.shape[e],l=[];let c=1,u=1,f=1;for(let m=0;m<r;++m)l.push(n.shape[m]),c*=n.shape[m];for(let m=r;m<e;m++)l.push(n.shape[m]),u*=n.shape[m];for(let m=r;m<i;m++)l.push(t.shape[m]);for(let m=e+1;m<s;m++)l.push(n.shape[m]),f*=n.shape[m];return{batchSize:c,sliceSize:f,outerSize:u,dimSize:o,outputShape:l}}function Cp(n){try{return n.map(t=>i_(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function Ede(n){return n.map(t=>r_(t))}!function C$e(){for(const n of w$e)pt(n)}();const Dde={kernelName:rB,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(n,yT(Pt(e,"float32"),-1))}}},J4e={kernelName:H1,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const r=Xr(Pt(e,"float32")),i=bo(Kt(gn(1),r));return pi(ln(n,i))}}}},eHe={kernelName:G1,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const r=bo(Kt(Xr(Pt(e,"float32")),1));return ln(n,r)}}}},tHe={kernelName:eT,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Bn(e.shape,r.shape);return{a:()=>{let l=n;const c=As(e.shape,i);return c.length>0&&(l=tn(l,c)),fe(l,e.shape)},b:()=>{let l=n;const c=As(r.shape,i);return c.length>0&&(l=tn(l,c)),fe(l,r.shape)}}}},nHe={kernelName:iB,saveAllInputs:!0,gradFunc:(n,t)=>{const e={};return t.forEach((r,i)=>{e[i]=()=>n.clone()}),e}},rHe={kernelName:sB,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>gr(e)}}},iHe={kernelName:oB,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>gr(e)}}},sHe={kernelName:W1,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ln(n,bo(Kt(gn(1),Xr(Pt(e,"float32")))))}}},oHe={kernelName:j1,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const r=bo(dt(gn(1),Xr(Pt(e,"float32"))));return ln(n,r)}}}},aHe={kernelName:Y1,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Bn(e.shape,r.shape);return{a:()=>{const l=dt(Xr(e),Xr(r));let c=ue(n,ln(r,l));const u=As(e.shape,i);return u.length>0&&(c=tn(c,u)),fe(c,e.shape)},b:()=>{const l=dt(Xr(e),Xr(r));let c=pi(ue(n,ln(e,l)));const u=As(r.shape,i);return u.length>0&&(c=tn(c,u)),fe(c,r.shape)}}}},lHe={kernelName:q1,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ln(n,dt(Xr(Pt(e,"float32")),1))}}},cHe={kernelName:Z1,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ln(n,Kt(gn(1),Xr(Pt(e,"float32"))))}}},dHe=se({avgPool3dGrad_:function uHe(n,t,e,r,i,s){const o=j(n,"dy","avgPool3dGrad"),l=j(t,"input","avgPool3dGrad");let c=o,u=l,f=!1;4===l.rank&&(f=!0,c=fe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=fe(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),G(5===c.rank,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),G(5===u.rank,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),ba("avgPool3dGrad",i,s);const y=ce.runKernel(q5,{dy:c,input:u},{filterSize:e,strides:r,pad:i,dimRoundingMode:s});return f?fe(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}}),hHe={kernelName:lB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=e;return{x:()=>dHe(n,r,i,s,o,l)}}},pHe=se({avgPoolGrad_:function fHe(n,t,e,r,i){const s=j(n,"dy","avgPoolGrad"),o=j(t,"input","avgPoolGrad");G(o.rank===s.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`);let l=o,c=s,u=!1;3===o.rank&&(u=!0,l=fe(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=fe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),G(4===c.rank,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${c.rank}.`),G(4===l.rank,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${l.rank}.`);const _=ce.runKernel(j5,{dy:c,input:l},{filterSize:e,strides:r,pad:i});return u?fe(_,[_.shape[1],_.shape[2],_.shape[3]]):_}}),mHe={kernelName:aB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{filterSize:i,strides:s,pad:o}=e;return{x:()=>pHe(n,r,i,s,o)}}},gHe={kernelName:cB,inputsToSave:["a","b"],gradFunc:(n,t,e)=>{const[r,i]=t,{transposeA:s,transposeB:o}=e;return s||o?!s&&o?{a:()=>ir(n,i,!1,!1),b:()=>ir(n,r,!0,!1)}:s&&!o?{a:()=>ir(i,n,!1,!0),b:()=>ir(r,n,!1,!1)}:{a:()=>ir(i,n,!0,!0),b:()=>ir(n,r,!0,!0)}:{a:()=>ir(n,i,!1,!0),b:()=>ir(r,n,!0,!1)}}},_He={kernelName:uB,gradFunc:(n,t,e)=>{const{blockShape:r,crops:i}=e;return{x:()=>PV(n,r,i)}}},yHe={kernelName:"BroadcastTo",gradFunc:(n,t,e)=>{const i=e.inputShape,s=e.shape,o=Array.from(s);for(let c=i.length-1;c>=0;c--)if(i[c]===s[c])o[c]=1;else if(1!==i[c])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${s}].`);const l=[];for(let c=0;c<o.length;c++)o[c]>1&&l.push(c);return{x:()=>tn(n,l,!0)}}},vHe={kernelName:K1,gradFunc:n=>({x:()=>n.clone()})},bHe={kernelName:Q1,gradFunc:n=>({x:()=>gr(n)})},wHe={kernelName:X1,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{clipValueMin:i,clipValueMax:s}=e;return{x:()=>Xo(bh(m_(r,i),Xb(r,s)),n,gr(n))}}},CHe={kernelName:hB,inputsToSave:["x"],gradFunc:Dde.gradFunc},xHe={kernelName:fB,saveAllInputs:!0,gradFunc:(n,t,e)=>{const r=t.map(c=>c.shape),{axis:i}=e,s=Kn(i,t[0].shape)[0],o=r.map(c=>c[s]);return Ml(n,o,s).map(c=>()=>c)}},IHe={kernelName:pB,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[r,i]=t,{dilations:s,strides:o,pad:l,dataFormat:c}=e;return G(h_(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>j8(r.shape,n,i,o,l,c),filter:()=>SY(r,n,i.shape,o,l,c)}}},THe={kernelName:mB,inputsToSave:["dy","filter"],gradFunc:(n,t,e)=>{const[r,i]=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c}=e;return{dy:()=>f_(n,i,s,o,l,1,c),filter:()=>SY(n,r,i.shape,s,o,l,c)}}},EHe=se({conv3DBackpropFilter_:function SHe(n,t,e,r,i){let s=n;4===n.rank&&(s=fe(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let o=t;return 4===o.rank&&(o=fe(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),G(5===s.rank,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),G(5===o.rank,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),G(5===e.length,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`),G(s.shape[4]===e[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${e[3]}.`),G(o.shape[4]===e[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${e[4]}).`),ce.runKernel(X5,{x:s,dy:o},{strides:r,pad:i,filterShape:e})}}),DHe={kernelName:gB,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:r,strides:i,pad:s}=e;G(h_(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,l]=t;return{x:()=>fue(o.shape,n,l,i,s),filter:()=>EHe(o,n,l.shape,i,s)}}},kHe={kernelName:J1,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(pi(fY(Pt(e,"float32"))),n)}}},AHe={kernelName:eN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(pY(Pt(e,"float32")),n)}}},NHe={kernelName:_B,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{axis:i,exclusive:s,reverse:o}=e;return{x:()=>{const l=Pi([i],r.rank);let c=Y8(n,i,s,!o);return null!=l&&(c=yr(c,l)),c}}}},RHe={kernelName:yB,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:r,strides:i,pad:s,dimRoundingMode:o}=e,l=r??[1,1];G(h_(l),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${l}'`);const[c,u]=t;return G(4===c.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${c.rank}.`),G(4===u.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),G(c.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),G(wo(i,l),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${l}'.`),ba("depthwiseConv2d",s,o),{x:()=>que(c.shape,n,u,i,s,l,o),filter:()=>jue(c,n,u.shape,i,s,l,o)}}},MHe={kernelName:vB,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[r,i]=t,s={x:r,filter:i,dy:n},o={x:r,filter:i,dy:n};return{x:()=>ce.runKernel(aZ,s,e),filter:()=>ce.runKernel(lZ,o,e)}}},OHe={kernelName:nN,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t,r={dy:n,y:e};return{x:()=>ce.runKernel(dZ,r)}}},FHe={kernelName:rN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,r=ue(Al(pi(Xr(e))),2/Math.sqrt(Math.PI));return{x:()=>ue(n,r)}}},PHe={kernelName:iN,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(n,e)}}},LHe={kernelName:wB,inputsToSave:["input"],gradFunc:(n,t)=>{const[e]=t;return{input:()=>fe(n,e.shape)}}},$He={kernelName:sN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(n,Al(e))}}},BHe={kernelName:oN,gradFunc:n=>({x:()=>gr(n)})},VHe={kernelName:aN,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Bn(e.shape,r.shape);return{a:()=>{const l=ln(n,Pt(r,"float32")),c=As(e.shape,i);return c.length>0?fe(tn(l,c),e.shape):l},b:()=>{let l=ue(n,Pt(e,"float32"));const c=As(r.shape,i);c.length>0&&(l=fe(tn(l,c),r.shape));const u=Xr(r);return pi(ln(l,Pt(u,"float32")))}}}},UHe={kernelName:CB,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,t,e)=>{const{varianceEpsilon:r}=e,[i,s,o,l]=t,c=l??gn(1),u=As(s.shape,i.shape),f=[];if(1===s.rank){for(let O=0;O<i.shape.length-1;++O)f.push(i.shape[O]);f.push(1)}const m=Kt(i,s),_=ue(n,c),y=cY(dt(o,gn(r))),w=ue(ue(ue(y,y),y),gn(-.5));return{x:()=>fe(ue(ue(n,1===s.rank?lu(fe(y,[1,1,1,s.shape[0]]),f):y),c),i.shape),mean:()=>{let O=ue(ue(y,gn(-1)),_);return 1===s.rank&&(O=tn(O,u)),fe(O,s.shape)},variance:()=>{let O=ue(ue(w,m),_);return 1===s.rank&&(O=tn(O,u)),fe(O,s.shape)},scale:()=>{const O=ue(m,y);let $=ue(n,O);return 1===s.rank&&($=tn($,u)),fe($,s.shape)},offset:()=>{let O=n;return 1===s.rank&&(O=tn(O,u)),fe(O,s.shape)}}}},zHe={kernelName:xB,inputsToSave:["x","indices"],gradFunc:(n,t,e)=>{const[r,i]=t,{axis:s,batchDims:o}=e,l=Kn(s,r.shape)[0],c=(u,f,m)=>()=>{const _=u.shape,y=f.size,w=_.slice(0,l),T=w.length,I=_.slice(s,_.length).slice(1),E=I.length,A=kde(0,T),M=kde(T+1,T+1+E),O=Ade([w,[y],I]),$=fe(m,O),V=fe(f,[y]),Z=Ade([[T],A,M]),Q=yr($,Z);let re=bY(Q,V,u.shape[l]);const oe=p_(Z);return re=yr(re,oe),re};if(1===o){const f=r.split(r.shape[0],0);return{x:()=>Ol(f.map((y,w)=>c(y,i.slice(w,1),n.slice(w,1))())).reshape(r.shape),indices:()=>i}}return{x:c(r,i,n),indices:()=>i}}};function kde(n,t){const e=[];for(let r=n;r<t;++r)e.push(r);return e}function Ade(n){const t=[];for(let e=0;e<n.length;++e)for(let r=0;r<n[e].length;++r)t.push(n[e][r]);return t}const HHe={kernelName:lN,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t;return{a:()=>gr(e),b:()=>gr(r)}}},GHe={kernelName:cN,gradFunc:n=>({x:()=>Pt(n,"float32")})},WHe={kernelName:uN,gradFunc:n=>({x:()=>gr(n)})},jHe={kernelName:dN,gradFunc:n=>({x:()=>gr(n)})},qHe={kernelName:hN,gradFunc:n=>({x:()=>gr(n)})},ZHe={kernelName:TB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{alpha:i}=e,s=Nl(r,0);return{x:()=>Xo(s,n,ue(n,i))}}},YHe={kernelName:pN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ln(n,dt(e,1))}}},KHe={kernelName:fN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ln(n,Pt(e,"float32"))}}},QHe={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r]=t,{axis:i}=e;return{logits:()=>{const o=Al(r);return Kt(n,ue(tn(n,i,!0),o))}}}},JHe=se({localResponseNormalizationBackprop_:function XHe(n,t,e,r=5,i=1,s=1,o=.5){return ce.runKernel(vZ,{x:n,y:t,dy:e},{depthRadius:r,bias:i,alpha:s,beta:o})}}),eGe={kernelName:NB,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r,i]=t,{depthRadius:s,bias:o,alpha:l,beta:c}=e;return{x:()=>JHe(r,i,n,s,o,l,c)}}};function Nde(n,t,e,r){return t.rank<e.rank&&(t=fe(t,rs(t.shape,r))),n.rank<e.rank&&(n=fe(n,rs(n.shape,r))),{x:()=>ue(n,Pt(id(e,t),n.dtype))}}const Rde={kernelName:RB,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const r=e,{reductionIndices:i}=r,s=t[0],c=Nde(n,t[1],s,Kn(i,s.shape));return{x:()=>c.x()}}},tGe={kernelName:mN,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t;return{a:()=>ue(n,Pt(m_(e,r),"float32")),b:()=>ue(n,Pt(JN(e,r),"float32"))}}},rGe=se({maxPool3dGrad_:function nGe(n,t,e,r,i,s,o){const l=j(n,"dy","maxPool3dGrad"),c=j(t,"input","maxPool3dGrad"),u=j(e,"output","maxPool3dGrad");let f=l,m=c,_=u,y=!1;4===c.rank&&(y=!0,f=fe(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),m=fe(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),_=fe(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),G(5===f.rank,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`),G(5===m.rank,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${m.rank}.`),G(5===_.rank,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${_.rank}.`),ba("maxPool3dGrad",s,o);const I=ce.runKernel(wZ,{dy:f,input:m,output:_},{filterSize:r,strides:i,pad:s,dimRoundingMode:o});return y?fe(I,[I.shape[1],I.shape[2],I.shape[3],I.shape[4]]):I}}),iGe={kernelName:OB,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r,i]=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=e;return{x:()=>rGe(n,r,i,s,o,l,c)}}},oGe=se({maxPoolGrad_:function sGe(n,t,e,r,i,s,o){const l=j(n,"dy","maxPoolGrad"),c=j(t,"input","maxPoolGrad"),u=j(e,"output","maxPoolGrad");return G(c.rank===l.rank,()=>`Rank of input (${c.rank}) does not match rank of dy (${l.rank})`),G(4===l.rank,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),G(4===c.rank,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${c.rank}.`),ba("maxPoolGrad",s,o),ce.runKernel(bZ,{dy:l,input:c,output:u},{filterSize:r,strides:i,pad:s,dimRoundingMode:o})}}),aGe={kernelName:MB,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r,i]=t,{filterSize:s,strides:o,pad:l}=e;return{x:()=>oGe(n,r,i,s,o,l)}}},lGe={kernelName:FB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{axis:i}=e,s=Kn(i,r.shape),c=Ye(Ks(r.shape,s)[1]);return{x:()=>{const f=r.shape.slice();s.forEach(y=>{f[y]=1});const m=fe(n,f);return ln(ue(m,Rl(r.shape,"float32")),c)}}}},cGe={kernelName:PB,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const r=e,{axis:i}=r,[s,o]=t,c=Nde(n,o,s,Kn(i,s.shape));return{x:()=>c.x()}}},uGe={kernelName:gN,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t;return{a:()=>ue(n,Pt(Xb(e,r),"float32")),b:()=>ue(n,Pt(Nl(e,r),"float32"))}}},dGe={kernelName:LB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const r=t[0],{paddings:i}=e,s=i.map(o=>o[0]);return{x:()=>_r(n,s,r.shape)}}},hGe={kernelName:_N,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Bn(e.shape,r.shape);return{a:()=>{const l=As(e.shape,i);return l.length>0?fe(tn(n,l),e.shape):n},b:()=>{const l=ue(n,pi(QN(ln(e,r)))),c=As(r.shape,i);return c.length>0?fe(tn(l,c),r.shape):l}}}},fGe={kernelName:yN,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Bn(e.shape,r.shape);return{a:()=>{const l=ue(n,Pt(r,"float32")),c=As(e.shape,i);return c.length>0?fe(tn(l,c),e.shape):l},b:()=>{const l=ue(n,Pt(e,"float32")),c=As(r.shape,i);return c.length>0?fe(tn(l,c),r.shape):l}}}},pGe={kernelName:$B,gradFunc:n=>({x:()=>pi(n)})},gGe={kernelName:VB,gradFunc:n=>({x:()=>gr(n)})},_Ge={kernelName:zB,saveAllInputs:!0,gradFunc:(n,t,e)=>{const{axis:r}=e;return cu(n,r).map(s=>()=>s)}},Mde={kernelName:HB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const r=t[0],{paddings:i}=e,s=i.map(o=>o[0]);return{x:()=>_r(n,s,r.shape)}}},yGe={kernelName:vN,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,t)=>{const[e,r,i]=t,s=e,o=r,l=Bn(s.shape,o.shape);return{a:()=>{const f=Pt(o,"float32");let m=ue(n,ue(f,gp(s,Kt(f,gn(1)))));const _=As(s.shape,l);return _.length>0&&(m=tn(m,_)),fe(m,s.shape)},b:()=>{const f=Nl(s,0),m=Xo(f,fc(s),gr(s));let _=ue(n,ue(i,m));const y=As(o.shape,l);return y.length>0&&(_=tn(_,y)),fe(_,o.shape)}}}},vGe={kernelName:GB,inputsToSave:["x","alpha"],gradFunc:(n,t)=>{const[e,r]=t,i=Nl(e,0);return{x:()=>Xo(i,n,ue(n,r)),alpha:()=>{let s=Xo(i,gr(n),ue(n,e));const o=As(r.shape,n.shape);return o.length>0&&(s=tn(s,o)),fe(s,r.shape)}}}};const CGe={kernelName:WB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{axis:i}=e;let s=[];return s=null==i?r.shape.map((o,l)=>l):"number"==typeof i?[i]:i,{x:()=>function wGe(n,t,e){const r=n.shape.length,i=r-e.length,s=Pi(e,r);let o=n;null!=s&&(o=yr(n,s));const l=o.shape.slice(),u=l.splice(r-e.length,e.length).reduce((_,y)=>_*y,1);l.push(u);let m=function bGe(n,t,e){const r=n.shape.slice();r[e]=1;const i=fe(t,r),s=EV(n,e,!0,!1),o=EV(n,e,!0,!0),l=ue(s,o);return ue(i,l)}(o.reshape(l),t,i);if(m=m.reshape(o.shape),null!=s){const _=p_(s);m=yr(m,_)}return m}(r,n,s)}}},xGe={kernelName:tN,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Bn(e.shape,r.shape);return{a:()=>{const l=ln(n,Pt(r,"float32")),c=As(e.shape,i);return c.length>0?fe(tn(l,c),e.shape):l},b:()=>{let l=ue(n,Pt(e,"float32"));const c=As(r.shape,i);c.length>0&&(l=fe(tn(l,c),r.shape));const u=Xr(r);return pi(ln(l,Pt(u,"float32")))}}}},IGe={kernelName:bN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ln(n,pi(Xr(e)))}}},TGe={kernelName:CN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,r=ue(Xb(e,6),yT(e));return{x:()=>ue(n,Pt(r,"float32"))}}},SGe={kernelName:wN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(n,Pt(yT(e),"float32"))}}},EGe={kernelName:jB,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>fe(n,e.shape)}}},DGe={kernelName:ZB,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[r]=t,i={dy:n,images:r};return{images:()=>ce.runKernel(MZ,i,e)}}},kGe={kernelName:qB,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[r]=t,i={dy:n,images:r};return{images:()=>ce.runKernel(RZ,i,e)}}},AGe={kernelName:YB,gradFunc:(n,t,e)=>{const{dims:r}=e,i=Kn(r,n.shape);return{x:()=>mc(n,i)}}},NGe={kernelName:xN,gradFunc:n=>({x:()=>gr(n)})},RGe={kernelName:IN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>pi(ln(n,ue(gp(e,1.5),2)))}}},MGe={kernelName:KB,inputsToSave:["condition"],gradFunc:(n,t)=>{const[e]=t;return{condition:()=>Pt(gr(e),"float32"),t:()=>ue(n,Pt(e,n.dtype)),e:()=>ue(n,Pt(RV(e),n.dtype))}}},OGe={kernelName:TN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const r=Nl(e,gn(0)),i=gn(YV),s=gn(KV),o=ue(n,s),l=ue(ue(n,i),Al(Pt(e,"float32")));return Xo(r,o,l)}}}},FGe={kernelName:kN,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(n,ue(e,Kt(gn(1),e)))}}},PGe={kernelName:DN,gradFunc:n=>({x:()=>gr(n)})},LGe={kernelName:SN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(SV(Pt(e,"float32")),n)}}},$Ge={kernelName:EN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(Z8(Pt(e,"float32")),n)}}},BGe={kernelName:QB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{begin:i,size:s}=e,o=r.shape,[l,c]=CV(r,i,s),u=[];for(let f=0;f<n.rank;f++)u.push([l[f],o[f]-l[f]-c[f]]);return{x:()=>g_(n,u)}}},VGe={kernelName:tV,outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r]=t,{dim:i}=e,o=ue(n,r);return{logits:()=>Kt(o,ue(tn(o,[i],!0),r))}}},UGe={kernelName:AN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(n,vh(e))}}},Ode={kernelName:JB,gradFunc:(n,t,e)=>{const{blockShape:r,paddings:i}=e;return{x:()=>TV(n,r,i)}}},Fde={kernelName:eV,gradFunc:(n,t,e)=>{const{axis:r}=e;return{x:()=>ms(n,r)}}},zGe={kernelName:NN,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ln(n,ue(bo(Pt(e,"float32")),2))}}},HGe={kernelName:zZ,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(n,ue(Pt(e,"float32"),2))}}},GGe={kernelName:RN,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=gn(2);return{a:()=>ue(n,ue(i,Kt(e,r))),b:()=>ue(n,ue(i,Kt(r,e)))}}},WGe={kernelName:LN,gradFunc:n=>({x:()=>gr(n)})},jGe={kernelName:MN,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Bn(e.shape,r.shape);return{a:()=>{let l=n;const c=As(e.shape,i);return c.length>0&&(l=tn(l,c)),fe(l,e.shape)},b:()=>{let l=n;const c=As(r.shape,i);return c.length>0&&(l=tn(l,c)),fe(pi(l),r.shape)}}}},qGe={kernelName:XB,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,i=r.shape.slice(),{axis:s}=e;Kn(s,r.shape).forEach(u=>{i[u]=1});const l=fe(n,i),c=ue(l,Rl(r.shape,"float32"));return{x:()=>c}}},ZGe={kernelName:ON,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ln(n,Xr(SV(e)))}}},YGe={kernelName:FN,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ue(Kt(gn(1),Xr(e)),n)}}},KGe={kernelName:PN,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{reps:i}=e;return{x:()=>{let o=gr(r);if(1===r.rank)for(let l=0;l<i[0];++l)o=dt(o,_r(n,[l*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let l=0;l<i[0];++l)for(let c=0;c<i[1];++c)o=dt(o,_r(n,[l*r.shape[0],c*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let l=0;l<i[0];++l)for(let c=0;c<i[1];++c)for(let u=0;u<i[2];++u)o=dt(o,_r(n,[l*r.shape[0],c*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let l=0;l<i[0];++l)for(let c=0;c<i[1];++c)for(let u=0;u<i[2];++u)for(let f=0;f<i[3];++f)o=dt(o,_r(n,[l*r.shape[0],c*r.shape[1],u*r.shape[2],f*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return o}}}},QGe={kernelName:tT,gradFunc:(n,t,e)=>{const r=e,{perm:i}=r,s=p_(i);return{x:()=>yr(n,s)}}},XGe={kernelName:rV,gradFunc:(n,t,e)=>{const r=e,{axis:i}=r;return{value:()=>Ol(n,i)}}},JGe={kernelName:iV,inputsToSave:["segmentIds"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>function e6e(n,t){const e=_p(t,gr(t)),r=XN(n,e);let i=m_(t,gn(0,"int32"));const s=r.rank-i.rank;for(let l=0;l<s;++l)i=wa(i,l+1);i=bh(i,Rl(r.shape,"bool"));const o=gr(r);return Xo(i,r,o)}(n,e)}}},t6e={kernelName:sV,gradFunc:n=>({x:()=>gr(n)})},n6e=[Dde,J4e,eHe,tHe,nHe,rHe,iHe,sHe,oHe,aHe,lHe,cHe,hHe,mHe,gHe,_He,yHe,vHe,bHe,wHe,CHe,xHe,THe,IHe,DHe,kHe,AHe,NHe,RHe,MHe,xGe,OHe,FHe,PHe,LHe,$He,VHe,BHe,UHe,zHe,HHe,GHe,WHe,jHe,qHe,ZHe,YHe,KHe,QHe,eGe,Rde,Rde,tGe,iGe,aGe,lGe,cGe,uGe,dGe,hGe,fGe,pGe,{kernelName:UB,inputsToSave:["indices"],gradFunc:(n,t)=>{const e=t[0];return{indices:()=>Ns(e.shape,"float32")}}},gGe,_Ge,Mde,Mde,yGe,vGe,CGe,IGe,TGe,SGe,EGe,DGe,kGe,AGe,NGe,RGe,MGe,OGe,FGe,PGe,LGe,$Ge,BGe,VGe,UGe,Ode,Ode,Fde,Fde,zGe,GGe,HGe,WGe,jGe,qGe,ZGe,YGe,KGe,QGe,XGe,JGe,t6e];for(const n of n6e)tLe(n);Xe().prototype.abs=function(){return this.throwIfDisposed(),ks(this)},Xe().prototype.acos=function(){return this.throwIfDisposed(),Zce(this)},Xe().prototype.acosh=function(){return this.throwIfDisposed(),Yce(this)},Xe().prototype.add=function(n){return this.throwIfDisposed(),dt(this,n)},Xe().prototype.all=function(n,t){return this.throwIfDisposed(),z8(this,n,t)},Xe().prototype.any=function(n,t){return this.throwIfDisposed(),xV(this,n,t)},Xe().prototype.argMax=function(n){return this.throwIfDisposed(),dT(this,n)},Xe().prototype.argMin=function(n){return this.throwIfDisposed(),Kce(this,n)},Xe().prototype.asScalar=function(){return this.throwIfDisposed(),G(1===this.size,()=>"The array must have only 1 element."),fe(this,[])},Xe().prototype.asType=function(n){return this.throwIfDisposed(),Pt(this,n)},Xe().prototype.as1D=function(){return this.throwIfDisposed(),fe(this,[this.size])},Xe().prototype.as2D=function(n,t){return this.throwIfDisposed(),fe(this,[n,t])},Xe().prototype.as3D=function(n,t,e){return this.throwIfDisposed(),fe(this,[n,t,e])},Xe().prototype.as4D=function(n,t,e,r){return this.throwIfDisposed(),fe(this,[n,t,e,r])},Xe().prototype.as5D=function(n,t,e,r,i){return this.throwIfDisposed(),fe(this,[n,t,e,r,i])},Xe().prototype.asin=function(){return this.throwIfDisposed(),Qce(this)},Xe().prototype.asinh=function(){return this.throwIfDisposed(),Xce(this)},Xe().prototype.atan=function(){return this.throwIfDisposed(),Jce(this)},Xe().prototype.atan2=function(n){return this.throwIfDisposed(),eue(this,n)},Xe().prototype.atanh=function(){return this.throwIfDisposed(),tue(this)},Xe().prototype.avgPool=function(n,t,e,r){return this.throwIfDisposed(),IV(this,n,t,e,r)},Xe().prototype.batchToSpaceND=function(n,t){return this.throwIfDisposed(),TV(this,n,t)},Xe().prototype.batchNorm=function(n,t,e,r,i){return this.throwIfDisposed(),jN(this,n,t,e,r,i)},Xe().prototype.broadcastTo=function(n){return this.throwIfDisposed(),fT(this,n)},Xe().prototype.cast=function(n){return this.throwIfDisposed(),Pt(this,n)},Xe().prototype.ceil=function(){return this.throwIfDisposed(),aue(this)},Xe().prototype.clipByValue=function(n,t){return this.throwIfDisposed(),kl(this,n,t)},Xe().prototype.concat=function(n,t){return this.throwIfDisposed(),n instanceof fi&&(n=[n]),ms([this,...n],t)},Xe().prototype.conv1d=function(n,t,e,r,i,s){return this.throwIfDisposed(),W8(this,n,t,e,r,i,s)},Xe().prototype.conv2dTranspose=function(n,t,e,r,i){return this.throwIfDisposed(),q8(this,n,t,e,r,i)},Xe().prototype.conv2d=function(n,t,e,r,i,s){return this.throwIfDisposed(),f_(this,n,t,e,r,i,s)},Xe().prototype.cos=function(){return this.throwIfDisposed(),SV(this)},Xe().prototype.cosh=function(){return this.throwIfDisposed(),Z8(this)},Xe().prototype.cumprod=function(n,t,e){return this.throwIfDisposed(),EV(this,n,t,e)},Xe().prototype.cumsum=function(n,t,e){return this.throwIfDisposed(),Y8(this,n,t,e)},Xe().prototype.depthToSpace=function(n,t){return this.throwIfDisposed(),mue(this,n,t)},Xe().prototype.depthwiseConv2d=function(n,t,e,r,i,s){return this.throwIfDisposed(),qN(this,n,t,e,r,i,s)},Xe().prototype.dilation2d=function(n,t,e,r,i){return this.throwIfDisposed(),gue(this,n,t,e,r,i)},Xe().prototype.divNoNan=function(n){return this.throwIfDisposed(),_ue(this,n)},Xe().prototype.div=function(n){return this.throwIfDisposed(),ln(this,n)},Xe().prototype.dot=function(n){return this.throwIfDisposed(),yue(this,n)},Xe().prototype.elu=function(){return this.throwIfDisposed(),ZN(this)},Xe().prototype.equal=function(n){return this.throwIfDisposed(),id(this,n)},Xe().prototype.erf=function(){return this.throwIfDisposed(),Q8(this)},Xe().prototype.euclideanNorm=function(n,t){return this.throwIfDisposed(),wue(this,n,t)},Xe().prototype.exp=function(){return this.throwIfDisposed(),Al(this)},Xe().prototype.expandDims=function(n){return this.throwIfDisposed(),wa(this,n)},Xe().prototype.expm1=function(){return this.throwIfDisposed(),Cue(this)},Xe().prototype.fft=function(){return this.throwIfDisposed(),zV(this)},Xe().prototype.flatten=function(){return this.throwIfDisposed(),fe(this,[this.size])},Xe().prototype.floor=function(){return this.throwIfDisposed(),QN(this)},Xe().prototype.floorDiv=function(n){return this.throwIfDisposed(),T8(this,n)},Xe().prototype.gather=function(n,t,e){return this.throwIfDisposed(),XN(this,n,t,e)},Xe().prototype.greaterEqual=function(n){return this.throwIfDisposed(),m_(this,n)},Xe().prototype.greater=function(n){return this.throwIfDisposed(),Nl(this,n)},Xe().prototype.ifft=function(){return this.throwIfDisposed(),nR(this)},Xe().prototype.irfft=function(){return this.throwIfDisposed(),gY(this)},Xe().prototype.isFinite=function(){return this.throwIfDisposed(),xue(this)},Xe().prototype.isInf=function(){return this.throwIfDisposed(),Iue(this)},Xe().prototype.isNaN=function(){return this.throwIfDisposed(),Tue(this)},Xe().prototype.leakyRelu=function(n){return this.throwIfDisposed(),kV(this,n)},Xe().prototype.lessEqual=function(n){return this.throwIfDisposed(),Xb(this,n)},Xe().prototype.less=function(n){return this.throwIfDisposed(),JN(this,n)},Xe().prototype.localResponseNormalization=function(n,t,e,r){return this.throwIfDisposed(),Sue(this,n,t,e,r)},Xe().prototype.logSigmoid=function(){return this.throwIfDisposed(),Eue(this)},Xe().prototype.logSoftmax=function(n){return this.throwIfDisposed(),eY(this,n)},Xe().prototype.logSumExp=function(n,t){return this.throwIfDisposed(),NV(this,n,t)},Xe().prototype.log=function(){return this.throwIfDisposed(),fc(this)},Xe().prototype.log1p=function(){return this.throwIfDisposed(),AV(this)},Xe().prototype.logicalAnd=function(n){return this.throwIfDisposed(),bh(this,n)},Xe().prototype.logicalNot=function(){return this.throwIfDisposed(),RV(this)},Xe().prototype.logicalOr=function(n){return this.throwIfDisposed(),tY(this,n)},Xe().prototype.logicalXor=function(n){return this.throwIfDisposed(),Due(this,n)},Xe().prototype.matMul=function(n,t,e){return this.throwIfDisposed(),ir(this,n,t,e)},Xe().prototype.maxPool=function(n,t,e,r){return this.throwIfDisposed(),OV(this,n,t,e,r)},Xe().prototype.max=function(n,t){return this.throwIfDisposed(),au(this,n,t)},Xe().prototype.maximum=function(n){return this.throwIfDisposed(),_p(this,n)},Xe().prototype.mean=function(n,t){return this.throwIfDisposed(),Gi(this,n,t)},Xe().prototype.min=function(n,t){return this.throwIfDisposed(),YN(this,n,t)},Xe().prototype.minimum=function(n){return this.throwIfDisposed(),Jb(this,n)},Xe().prototype.mirrorPad=function(n,t){return this.throwIfDisposed(),Aue(this,n,t)},Xe().prototype.mod=function(n){return this.throwIfDisposed(),Nue(this,n)},Xe().prototype.mul=function(n){return this.throwIfDisposed(),ue(this,n)},Xe().prototype.neg=function(){return this.throwIfDisposed(),pi(this)},Xe().prototype.norm=function(n,t,e){return this.throwIfDisposed(),KN(this,n,t,e)},Xe().prototype.notEqual=function(n){return this.throwIfDisposed(),gT(this,n)},Xe().prototype.oneHot=function(n,t=1,e=0){return this.throwIfDisposed(),rY(this,n,t,e)},Xe().prototype.onesLike=function(){return this.throwIfDisposed(),pc(this)},Xe().prototype.pad=function(n,t){return this.throwIfDisposed(),g_(this,n,t)},Xe().prototype.pool=function(n,t,e,r,i,s){return this.throwIfDisposed(),Rue(this,n,t,e,r,i,s)},Xe().prototype.pow=function(n){return this.throwIfDisposed(),gp(this,n)},Xe().prototype.prelu=function(n){return this.throwIfDisposed(),LV(this,n)},Xe().prototype.prod=function(n,t){return this.throwIfDisposed(),Mue(this,n,t)},Xe().prototype.reciprocal=function(){return this.throwIfDisposed(),Oue(this)},Xe().prototype.relu=function(){return this.throwIfDisposed(),wh(this)},Xe().prototype.relu6=function(){return this.throwIfDisposed(),aY(this)},Xe().prototype.reshapeAs=function(n){return this.throwIfDisposed(),fe(this,n.shape)},Xe().prototype.reshape=function(n){return this.throwIfDisposed(),fe(this,n)},Xe().prototype.resizeBilinear=function(n,t,e){return this.throwIfDisposed(),Que(this,n,t,e)},Xe().prototype.resizeNearestNeighbor=function(n,t,e){return this.throwIfDisposed(),Xue(this,n,t,e)},Xe().prototype.reverse=function(n){return this.throwIfDisposed(),mc(this,n)},Xe().prototype.rfft=function(){return this.throwIfDisposed(),HV(this)},Xe().prototype.round=function(){return this.throwIfDisposed(),lY(this)},Xe().prototype.rsqrt=function(){return this.throwIfDisposed(),cY(this)},Xe().prototype.selu=function(){return this.throwIfDisposed(),uY(this)},Xe().prototype.separableConv2d=function(n,t,e,r,i,s){return this.throwIfDisposed(),dY(this,n,t,e,r,i,s)},Xe().prototype.sigmoid=function(){return this.throwIfDisposed(),vh(this)},Xe().prototype.sign=function(){return this.throwIfDisposed(),Fue(this)},Xe().prototype.sin=function(){return this.throwIfDisposed(),fY(this)},Xe().prototype.sinh=function(){return this.throwIfDisposed(),pY(this)},Xe().prototype.slice=function(n,t){return this.throwIfDisposed(),_r(this,n,t)},Xe().prototype.softmax=function(n){return this.throwIfDisposed(),UV(this,n)},Xe().prototype.softplus=function(){return this.throwIfDisposed(),mT(this)},Xe().prototype.spaceToBatchND=function(n,t){return this.throwIfDisposed(),PV(this,n,t)},Xe().prototype.split=function(n,t){return this.throwIfDisposed(),Ml(this,n,t)},Xe().prototype.sqrt=function(){return this.throwIfDisposed(),bo(this)},Xe().prototype.square=function(){return this.throwIfDisposed(),Xr(this)},Xe().prototype.squaredDifference=function(n){return this.throwIfDisposed(),_Y(this,n)},Xe().prototype.squeeze=function(n){return this.throwIfDisposed(),t0(this,n)},Xe().prototype.stack=function(n,t){this.throwIfDisposed();const e=n instanceof fi?[this,n]:[this,...n];return Ol(e,t)},Xe().prototype.step=function(n){return this.throwIfDisposed(),yT(this,n)},Xe().prototype.stridedSlice=function(n,t,e,r,i,s,o,l){return this.throwIfDisposed(),Pue(this,n,t,e,r,i,s,o,l)},Xe().prototype.sub=function(n){return this.throwIfDisposed(),Kt(this,n)},Xe().prototype.sum=function(n,t){return this.throwIfDisposed(),tn(this,n,t)},Xe().prototype.tan=function(){return this.throwIfDisposed(),Lue(this)},Xe().prototype.tanh=function(){return this.throwIfDisposed(),Qb(this)},Xe().prototype.tile=function(n){return this.throwIfDisposed(),lu(this,n)},Xe().prototype.toBool=function(){return this.throwIfDisposed(),Pt(this,"bool")},Xe().prototype.toFloat=function(){return this.throwIfDisposed(),Pt(this,"float32")},Xe().prototype.toInt=function(){return this.throwIfDisposed(),Pt(this,"int32")},Xe().prototype.topk=function(n,t){return this.throwIfDisposed(),Bue(this,n,t)},Xe().prototype.transpose=function(n){return this.throwIfDisposed(),yr(this,n)},Xe().prototype.unique=function(n){return this.throwIfDisposed(),Vue(this,n)},Xe().prototype.unsortedSegmentSum=function(n,t){return this.throwIfDisposed(),bY(this,n,t)},Xe().prototype.unstack=function(n){return this.throwIfDisposed(),cu(this,n)},Xe().prototype.where=function(n,t){return this.throwIfDisposed(),Xo(n,this,t)},Xe().prototype.zerosLike=function(){return this.throwIfDisposed(),gr(this)};class xh extends Error{constructor(t){super(t),Object.setPrototypeOf(this,xh.prototype)}}class du extends Error{constructor(t){super(t),Object.setPrototypeOf(this,du.prototype)}}class pe extends Error{constructor(t){super(t),Object.setPrototypeOf(this,pe.prototype)}}class zn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,zn.prototype)}}class rK extends Error{constructor(t){super(t),Object.setPrototypeOf(this,rK.prototype)}}Error;class Lde{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=t}}function r0(n,t){if(Array.isArray(n)){let e=[];for(let r=0;r<t;r++)e=e.concat(n);return e}{const e=new Array(t);return e.fill(n),e}}function gc(n,t){if(!n)throw new rK(t)}function $de(n,t){let e=0;for(const r of n)r===t&&e++;return e}function Ja(n){return 1===n.length?n[0]:n}function Mr(n){return Array.isArray(n)?n:[n]}function xp(n){const e=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function s0(n){return n.length<=1||-1===n.indexOf("_")?n:n.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let hu={};function iK(n){if(null==n)return null;const t={};return t.className=n.getClassName(),t.config=n.getConfig(),t}function sK(n){if(null!=n&&"object"==typeof n)if(Array.isArray(n))n.forEach(t=>sK(t));else{const t=Object.keys(n);for(const e of t){const r=n[e];null!=r&&"object"==typeof r&&(Array.isArray(r)||"ndarray"!==r.type||"number"!=typeof r.value?sK(r):n[e]=r.value)}}}function aR(n,t={},e={},r="object",i=!1){if("string"==typeof n){const s=n;let o;if(s in e)o=e[s];else if(s in hu)o=hu[s];else if(o=t[s],null==o)throw new pe(`Unknown ${r}: ${n}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}{const s=n;if(null==s.className||null==s.config)throw new pe(`${r}: Improper config format: ${JSON.stringify(s)}.\n'className' and 'config' must set.`);const o=s.className;let l,c;if(o in e?[l,c]=e[o]:o in hu?[l,c]=hu.className:o in t&&([l,c]=t[o]),null==l)throw new pe(`Unknown ${r}: ${o}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=c){const u={};for(const y of Object.keys(hu))u[y]=hu[y];for(const y of Object.keys(e))u[y]=e[y];s.config.customObjects=u;const m=Object.assign({},hu);for(const y of Object.keys(e))hu[y]=e[y];sK(s.config);const _=c(l,s.config,e,i);return hu=Object.assign({},m),_}{const u=Object.assign({},hu);for(const m of Object.keys(e))hu[m]=e[m];const f=new l(s.config);return hu=Object.assign({},u),f}}}function QV(n,t){return-1*function r6e(n,t){return n<t?-1:n>t?1:0}(n,t)}function __(n){if(null==n)return n;const t=[];for(const e of n)-1===t.indexOf(e)&&t.push(e);return t}function i6e(n){if(null==n)throw new pe(`Invalid value in obj: ${JSON.stringify(n)}`);for(const t in n)if(n.hasOwnProperty(t))return!1;return!0}function o0(n,t,e){if(null!=e&&n.indexOf(e)<0)throw new pe(`${e} is not a valid ${t}.  Valid values are ${n} or null/undefined.`)}function oK(n,t,e=0,r=1/0){return gc(e>=0),gc(r>=e),Array.isArray(n)&&n.length>=e&&n.length<=r&&n.every(i=>typeof i===t)}function Qs(n,t){Array.isArray(n)?(G(n.length>0,()=>`${t} is unexpectedly an empty array.`),n.forEach((e,r)=>Qs(e,`element ${r+1} of ${t}`))):G(Number.isInteger(n)&&n>0,()=>`Expected ${t} to be a positive integer, but got ${Bde(n)}.`)}function Bde(n){return null===n?"null":Array.isArray(n)?"["+n.map(t=>Bde(t)).join(",")+"]":"string"==typeof n?`"${n}"`:`${n}`}function Vde(n){return"relu"===n?"relu":"linear"===n?"linear":"elu"===n?"elu":null}let o6e=0;function Ude(){return o6e++}const XV={};function JV(n=""){return n in XV||(XV[n]=0),XV[n]+=1,n+XV[n].toString()}const a6e=["channelsFirst","channelsLast"],l6e=["nearest","bilinear"],c6e=["valid","same","causal"],u6e=["max","avg"],d6e=["sum","mul","concat","ave"],wT=new Map;function ss(n){o0(a6e,"DataFormat",n)}function _c(n){o0(c6e,"PaddingMode",n)}function zde(n){o0(u6e,"PoolMode",n)}const lR=[];function a0(n,t){lR.push(n);try{const e=t();return lR.pop(),e}catch(e){throw lR.pop(),e}}function Gde(n){if(!jde(n))throw new Error("Not a valid tensor name: '"+n+"'");return function f6e(){return 0===lR.length?"":lR.join("/")+"/"}()+n}function Wde(n){if(!jde(n))throw new Error("Not a valid tensor name: '"+n+"'");wT.has(n)||wT.set(n,0);const t=wT.get(n);if(wT.set(n,wT.get(n)+1),t>0){const e=`${n}_${t}`;return wT.set(e,1),e}return n}const p6e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function jde(n){return!!n.match(p6e)}function m6e(n){return n===parseInt(n.toString(),10)}function y_(n,t,e){null==t&&(t=0),null==e&&(e=n.length);let r=1;for(let i=t;i<e;++i)r*=n[i];return r}function CT(n){if(0===n.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let e=0;e<n.length;e++){const r=n[e];r<t&&(t=r)}return t}function v_(n){if(0===n.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let e=0;e<n.length;e++){const r=n[e];r>t&&(t=r)}return t}function od(n,t){if(t<n)throw new pe(`end (${t}) < begin (${n}) is forbidden.`);const e=[];for(let r=n;r<t;++r)e.push(r);return e}let e3;function Rs(){return null==e3&&(e3=nce().epsilon()),e3}function Ih(n,t){return Pt(n,t)}function cR(n,t=-1){const e=n.shape.slice();return t<0&&(t=e.length+t+1),e.splice(t,0,1),fe(n,e)}function l0(n,t,e){return Ie(()=>{switch(n.rank){case 1:return BV(n,t,e);case 2:return mY(n,[t,0],[e,n.shape[1]]);case 3:return VV(n,[t,0,0],[e,n.shape[1],n.shape[2]]);case 4:return tR(n,[t,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3]]);case 5:return _r(n,[t,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return _r(n,[t,0,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new pe(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function aK(n,t,e){return Ie(()=>{switch(n.rank){case 1:return BV(n,t,e);case 2:return mY(n,[0,t],[n.shape[0],e]);case 3:return VV(n,[0,0,t],[n.shape[0],n.shape[1],e]);case 4:return tR(n,[0,0,0,t],[n.shape[0],n.shape[1],n.shape[2],e]);default:throw new pe(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function t3(n,t,e,r){return Ie(()=>{switch(n.rank){case 1:return BV(n,t,e);case 2:switch(r){case 1:return l0(n,t,e);case 2:return aK(n,t,e);default:throw new pe(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return l0(n,t,e);case 2:return VV(n,[0,t,0],[n.shape[0],e,n.shape[2]]);case 3:return aK(n,t,e);default:throw new pe(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return l0(n,t,e);case 2:return tR(n,[0,t,0,0],[n.shape[0],e,n.shape[2],n.shape[3]]);case 3:return tR(n,[0,0,t,0],[n.shape[0],n.shape[1],e,n.shape[3]]);case 4:return aK(n,t,e);default:throw new pe(`The axis is not within the rank of the tensor ${r}`)}default:throw new pe(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function lK(n,t=-1){let e;return t<0&&(e=n[0].rank,t=0!==e?e:0),t===n[0].rank&&(t=-1),ms(n,t)}function Zde(n,t){switch(n.rank){case 1:return lue([n,t]);case 2:return cue([n,t],0);case 3:return uue([n,t],0);case 4:return due([n,t],0);default:throw new pe(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function cK(n,t){if(Array.isArray(t)||(t=[t]),n.rank!==t.length)throw new pe(`The length of input n (${t.length}) does not match the number of dimensions in input x (${n.rank})`);return lu(n,t)}function n3(n,t=0,e=1,r,i){return oY(n,t,e,r,i)}function Th(n,t,e,r){if(n.rank<2||t.rank<2)throw new zn(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${t.shape}`);if(t.rank>=3&&n.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new zn(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${t.shape}`);if(2===n.rank&&2===t.rank)return EY({a:n,b:t,transposeA:!1,transposeB:!1,bias:r?uK(n.rank,r,"channelsLast"):null,activation:e});{const i=n.shape.slice(),s=i.pop();n=fe(n,[-1,s]);const o=t.shape.slice(),l=o.pop(),c=o.pop(),u=[...o,l],f=Array.from({length:t.rank},(w,T)=>0===T?t.rank-2:T<=t.rank-2?T-1:T);t=fe(yr(t,f),[c,-1]);const m=[...i,...u];return fe(EY({a:n,b:t,transposeA:!1,transposeB:!1,bias:r?uK(n.rank,r,"channelsLast"):null,activation:e}),m)}}function Yde(n,t,e){return Ie(()=>(t=Array.isArray(t)?Ca(t,"int32"):Pt(t,"int32"),XN(n,t,e)))}function uR(n){return ue(n,n)}function uK(n,t,e){const r=t.shape;if(1!==t.rank&&t.rank!==n)throw new pe(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${n}`);if(5===n){if("channelsFirst"===e)return fe(t,1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===e)return fe(t,1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===n){if("channelsFirst"===e)return fe(t,1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===e)return fe(t,1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===n){if("channelsFirst"===e)return fe(t,1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===e)return fe(t,1===r.length?[1,1,r[0]]:[1].concat(r))}else if(n<3)return t;throw new pe(`Unsupported input rank by biasAdd: ${t.rank}`)}function ld(n,t,e){return Ie(()=>(null==e&&(e="channelsLast"),ss(e),dt(n,uK(n.rank,t,e))))}function Kde(n,t,e,r){return Ie(()=>Hue(n,t,e,r))}function dR(n,t,e=!1){return e?n():t()}const I6e=["fanIn","fanOut","fanAvg"],T6e=["normal","uniform","truncatedNormal"];class fu extends lT{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}pt((()=>{class n extends fu{apply(e,r){return Ns(e,r)}}return n.className="Zeros",n})());let Qde=(()=>{class n extends fu{apply(e,r){return Rl(e,r)}}return n.className="Ones",n})();pt(Qde),pt((()=>{class n extends fu{constructor(e){if(super(),"object"!=typeof e)throw new pe(`Expected argument of type ConstantConfig but got ${e}`);if(void 0===e.value)throw new pe(`config must have value set but got ${e}`);this.value=e.value}apply(e,r){return Ie(()=>ue(gn(this.value),Rl(e,r)))}getConfig(){return{value:this.value}}}return n.className="Constant",n})()),pt((()=>{class n extends fu{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,r){return e0(e,this.minval,this.maxval,r,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}return n.className="RandomUniform",n})()),pt((()=>{class n extends fu{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if("float32"!==(r=r||"float32")&&"int32"!==r)throw new zn(`randomNormal does not support dType ${r}.`);return n3(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return n.className="RandomNormal",n})()),pt((()=>{class n extends fu{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if("float32"!==(r=r||"float32")&&"int32"!==r)throw new zn(`truncatedNormal does not support dType ${r}.`);return vY(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return n.className="TruncatedNormal",n})()),pt((()=>{class n extends fu{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,r){return Ie(()=>{if(2!==e.length||e[0]!==e[1])throw new pe("Identity matrix initializer can only be used for 2D square matrices.");return ue(this.gain,J8(e[0]))})}getConfig(){return{gain:this.gain}}}return n.className="Identity",n})());let yc=(()=>{class n extends fu{constructor(e){if(super(),e.scale<0)throw new pe(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale??1,this.mode=e.mode??"fanIn",function S6e(n){o0(I6e,"FanMode",n)}(this.mode),this.distribution=e.distribution??"normal",function E6e(n){o0(T6e,"Distribution",n)}(this.distribution),this.seed=e.seed}apply(e,r){const i=function D6e(n,t="channelsLast"){let e,r;if(ss(t),2===n.length)e=n[0],r=n[1];else if(-1!==[3,4,5].indexOf(n.length)){if("channelsFirst"===t){const i=y_(n,2);e=n[1]*i,r=n[0]*i}else if("channelsLast"===t){const i=y_(n,0,n.length-2);e=n[n.length-2]*i,r=n[n.length-1]*i}}else{const i=y_(n);e=Math.sqrt(i),r=Math.sqrt(i)}return[e,r]}(e),s=i[0],o=i[1];let l=this.scale;if(l/="fanIn"===this.mode?Math.max(1,s):"fanOut"===this.mode?Math.max(1,o):Math.max(1,(s+o)/2),"normal"===this.distribution){const c=Math.sqrt(l);if("float32"!==(r=r||"float32")&&"int32"!==r)throw new zn(`${this.getClassName()} does not support dType ${r}.`);return vY(e,0,c,r,this.seed)}{const c=Math.sqrt(3*l);return e0(e,-c,c,r,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}return n.className="VarianceScaling",n})();pt(yc);let Xde=(()=>{class n extends yc{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return yc.className}}return n.className="GlorotUniform",n})();pt(Xde);let Jde=(()=>{class n extends yc{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return yc.className}}return n.className="GlorotNormal",n})();pt(Jde);let ehe=(()=>{class n extends yc{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return yc.className}}return n.className="HeNormal",n})();pt(ehe);let the=(()=>{class n extends yc{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return yc.className}}return n.className="HeUniform",n})();pt(the);let nhe=(()=>{class n extends yc{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return yc.className}}return n.className="LeCunNormal",n})();pt(nhe);let rhe=(()=>{class n extends yc{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return yc.className}}return n.className="LeCunUniform",n})();pt(rhe),pt((()=>{class n extends fu{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain??this.DEFAULT_GAIN,this.seed=e.seed}apply(e,r){return Ie(()=>{if(e.length<2)throw new zn("Shape must be at least 2D.");if("int32"!==r&&"float32"!==r&&void 0!==r)throw new TypeError(`Unsupported data type ${r}.`);const i=Ye(e.slice(0,-1)),s=e[e.length-1],o=i*s;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const c=n3([Math.max(s,i),Math.min(s,i)],0,1,r,this.seed),u=ede.qr(c,!1);let f=u[0];const _=u[1].flatten().stridedSlice([0],[Math.min(s,i)*Math.min(s,i)],[Math.min(s,i)+1]);return f=ue(f,_.sign()),i<s&&(f=f.transpose()),ue(gn(this.gain),f.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}return n.className="Orthogonal",n})());const ihe={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function she(n,t={}){return aR(n,su.getMap().classNameMap,t,"initializer")}function Li(n){return iK(n)}function Ei(n){if("string"==typeof n){const t=n in ihe?ihe[n]:n;if("GlorotNormal"===t)return new Jde;if("GlorotUniform"===t)return new Xde;if("HeNormal"===t)return new ehe;if("HeUniform"===t)return new the;if("LeCunNormal"===t)return new nhe;if("LeCunUniform"===t)return new rhe;{const e={};return e.className=t,e.config={},she(e)}}return n instanceof fu?n:she(n)}function dK(n){return Array.isArray(n)&&Array.isArray(n[0])}function r3(n){return 0===n.length?[]:Array.isArray(n[0])?n:[n]}function En(n){let t;if(Array.isArray(n)){if(1!==n.length)throw new pe(`Expected Tensor length to be 1; got ${n.length}`);t=n[0]}else t=n;return t}function Tr(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(1===n.length)return n[0];throw new pe(`Expected exactly 1 Shape; got ${n.length}`)}return n}function s3(n){let t=0;for(const e of n)t+=0===e.shape.length?1:e.shape.reduce((r,i)=>r*i);return t}class Sh{constructor(t,e="float32",r="Variable",i=!0,s=null){this.dtype=e??"float32",this.shape=t.shape,this.id=Ude(),this.originalName=Gde(r=r??"Variable"),this.name=Wde(this.originalName),this.trainable_=i,this.constraint=s,this.val=Uue(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function k6e(n,t){if(n.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function hK(n){return n.map(t=>t.read())}function fK(n){n.forEach(t=>{t[0].write(t[1])})}class Ms{constructor(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Eh{constructor(t,e,r,i,s,o,l){this.dtype=t,this.shape=e,this.sourceLayer=r,this.inputs=i,this.callArgs=s,this.outputTensorIndex=l,this.id=Ude(),null!=o&&(this.originalName=Gde(o),this.name=Wde(this.originalName)),this.rank=e.length}}let A6e=0;class o3{constructor(t,e){this.callArgs=e,this.id=A6e++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const r of t.inboundLayers)r?.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)t.push(null!=e?e.name:null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let N6e=0;class Xn extends lT{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=N6e++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const r=this.getClassName();e=xp(r)+"_"+JV(r)}if(this.name=e,this.trainable_=t.trainable??!0,null!=t.inputShape||null!=t.batchInputShape){let r;if(null!=t.batchInputShape)r=t.batchInputShape;else if(null!=t.inputShape){let s=null;null!=t.batchSize&&(s=t.batchSize),r=[s].concat(t.inputShape)}this.batchInputShape=r;let i=t.dtype;null==i&&(i=t.inputDType),null==i&&(i="float32"),this.dtype=i}this.initialWeights=null!=t.weights?t.weights:null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new du(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new pe(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return Ja(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Ja(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new xh(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new xh(`Layer ${this.name} is not connected, no input to return.`);return Ja(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new xh(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new xh(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ja(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const e=Mr(t);if(null==this.inputSpec||0===this.inputSpec.length)return;const r=Mr(this.inputSpec);if(e.length!==r.length)throw new pe(`Layer ${this.name} expects ${r.length} inputs, but it received ${e.length} input tensors. Input received: ${t}`);for(let i=0;i<e.length;i++){const s=e[i],o=r[i];if(null==o)continue;const l=s.rank;if(null!=o.ndim&&l!==o.ndim)throw new pe(`Input ${i} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${l}`);if(null!=o.maxNDim&&l>o.maxNDim)throw new pe(`Input ${i} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${l}`);if(null!=o.minNDim&&l<o.minNDim)throw new pe(`Input ${i} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${l}.`);if(null!=o.dtype&&s.dtype!==o.dtype)throw new pe(`Input ${i} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${s.dtype}.`);if(o.axes){const c=s.shape;for(const u in o.axes){const f=Number(u),m=o.axes[u],_=f>=0?c[f]:c[c.length+f];if(null!=m&&-1===[m,null].indexOf(_))throw new pe(`Input ${i} is incompatible with layer ${this.name}: expected axis ${f} of input shape to have value ${m} but got shape ${c}.`)}}if(null!=o.shape)for(let c=0;c<o.shape.length;++c){const u=o.shape[c],f=s.shape[c];if(null!=u&&null!=f&&u!==f)throw new pe(`Input ${i} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${s.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const r=Mr(t),i=function O6e(n){let t=!0;for(const e of Mr(n))if(!(e instanceof Eh)){t=!1;break}return t}(t),s=function F6e(n){let t=!0;for(const e of Mr(n))if(e instanceof Eh){t=!1;break}return t}(t);if(i===s)throw new pe("Arguments to apply() must be all SymbolicTensors or all Tensors");return a0(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const o=[];for(const l of Mr(t))o.push(l.shape);this.build(Ja(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&s&&(this._refCount=1)}if(this.assertInputCompatibility(t),s){let o=this.call(t,e);this.supportsMasking&&this.setMaskMetadata(t,o);const l=Mr(o),c=[];for(let u of l)-1!==r.indexOf(u)&&(u=u.clone()),c.push(u);if(o=Ja(c),null!=this.activityRegularizer)throw new zn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}{const o=function R6e(n){n=Mr(n);const t=[];for(const e of n)t.push(e.shape);return Ja(t)}(t),l=this.computeOutputShape(o);let c;const u="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?o[0]:o),c=null!=l&&l.length>0&&Array.isArray(l[0])?l.map((f,m)=>new Eh(u,f,this,Mr(t),e,this.name,m)):new Eh(u,l,this,Mr(t),e,this.name),this.addInboundNode(t,c,null,null,o,l,e),this._refCount++,null!=this.activityRegularizer)throw new zn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((r,i)=>{null!=r&&null!=t[i]&&t[i]!==r&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new xh(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const r=JSON.stringify(e.outputShapes);-1===t.indexOf(r)&&t.push(r)}if(1===t.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new xh(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new du(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return s3(this.weights)}build(t){this.built=!0}getWeights(t=!1){return hK(t?this.trainableWeights:this.weights)}setWeights(t){Ie(()=>{const e=this.weights;if(e.length!==t.length)throw new pe(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const r=[],i=hK(e);for(let s=0;s<i.length;++s){const o=i[s],l=e[s],c=t[s];if(!dr(o.shape,c.shape))throw new pe(`Layer weight shape ${o.shape} not compatible with provided weight shape ${c.shape}`);r.push([l,c])}fK(r)})}addWeight(t,e,r,i,s,o,l,c){if(-1!==this._addedWeightNames.indexOf(t))throw new pe(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==r&&(r="float32"),this.fastWeightInitDuringBuild&&(i=null!=c?c():Ei("zeros"));const u=i.apply(e,r),f=new Sh(u,r,t,o,l);return u.dispose(),null!=s&&this.addLoss(()=>s.apply(f.read())),null==o&&(o=!0),o?this._trainableWeights.push(f):this._nonTrainableWeights.push(f),f}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=Mr(t),null!=this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach(r=>{if(null!=r)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)})}return null}return e}setMaskMetadata(t,e,r){if(!this.supportsMasking)return;const i=this.computeMask(t,r),s=Mr(e),o=Mr(i);if(s.length!==o.length)throw new Error(`${this.name} outputs ${s.length} tensors but ${s.length} masks for those tensors`);for(let l=0;l<s.length;l++)s[l].kerasMask=o[l]}addInboundNode(t,e,r,i,s,o,l=null){const c=Mr(t);e=Mr(e),r=Mr(r),i=Mr(i),s=r3(s),o=r3(o);const u=[],f=[],m=[];for(const _ of c)u.push(_.sourceLayer),f.push(_.nodeIndex),m.push(_.tensorIndex);new o3({outboundLayer:this,inboundLayers:u,nodeIndices:f,tensorIndices:m,inputTensors:c,outputTensors:e,inputMasks:r,outputMasks:i,inputShapes:s,outputShapes:o},l);for(let _=0;_<e.length;_++)e[_].sourceLayer=this,e[_].nodeIndex=this.inboundNodes.length-1,e[_].tensorIndex=_}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function ahe(n,t,e){if((null==t||null!=e&&e>0)&&(t=n.sourceLayer,e=n.nodeIndex),0===t.inboundNodes.length)return[n];{const r=t.inboundNodes[e];if(0===r.inboundLayers.length)return r.inputTensors;{const i=[];for(let s=0;s<r.inboundLayers.length;s++){const u=ahe(r.inputTensors[s],r.inboundLayers[s],r.nodeIndices[s]);for(const f of u)-1===i.indexOf(f)&&i.push(f)}return i}}}let a3=(()=>{class n extends Xn{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:JV("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new pe("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let r=e.batchInputShape;if(null==r){if(null==e.inputShape)throw new pe("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new pe("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const i=e.dtype||"float32";this.batchInputShape=r,this.dtype=i,this.inputSpec=[{shape:r}];const s=new Eh(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new o3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]})}apply(e,r){throw new pe(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}return n.className="InputLayer",n})();pt(a3);class b_{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof b_)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,r){if(null!=this.id2Value[t.id])throw new pe(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=function L6e(n,t){if(null==n.dtype||n.dtype===t.dtype)return t;try{return Pt(t,n.dtype)}catch{throw new pe(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=r&&(this.id2Mask[t.id]=r),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Eh){if(null==this.id2Value[t.id])throw new pe(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new pe(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof Eh){if(null==this.id2Value[t.id])throw new pe(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new pe(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&Qn(this.id2Mask)}}const l3=new Lde,c3=new Lde;function hR(n,t,e,r){const i=null!=e&&e.training,s=Array.isArray(n),o=s?n:[n],l=o.map(w=>w.name),c=[],u=t.names();for(const w of l)-1!==u.indexOf(w)?c.push(t.getValue(w)):c.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const f=l.join(",")+"|"+t.names().sort().join(",");let _,m=l3.get(f);if(null==m){const w=function B6e(n,t){G(null!=n&&n.length>0,()=>"Expected at least one fetch, got none");let e=[],r={};if(1===n.length){const i=lhe(n[0],t);e=i.sorted,r=i.recipientMap}else{const i=new Set;for(const s of n){const{sorted:o,recipientMap:l}=lhe(s,t);for(const c of o)i.has(c.name)||(e.push(c),i.add(c.name));for(const c in l)null==r[c]&&(r[c]=new Set),l[c].forEach(u=>r[c].add(u))}}return{sorted:e,recipientCounts:V6e(r)}}(o,t);m=w.sorted,_=w.recipientCounts,l3.put(f,m),c3.put(f,_)}_={},i||Object.assign(_,c3.get(f));const y=new b_(t);for(let w=0;w<m.length;++w){if(null!=r){const re=o8().numTensors;re>r.maxNumTensors&&(r.maxNumTensors=re),re<r.minNumTensors&&(r.minNumTensors=re)}const T=m[w],I=T.sourceLayer;if(I instanceof a3)continue;const E=[],A=[],M=[];let O=!1;for(const re of T.inputs){const oe=y.getValue(re),ye=y.getMask(re);E.push(oe),A.push(ye),null!=ye&&(O=!0),i||(_[re.name]--,0===_[re.name]&&!t.hasKey(re)&&-1===l.indexOf(re.name)&&!oe.isDisposed&&!0!==re.sourceLayer.stateful&&M.push(oe))}O&&((e=e||{}).mask=A[0]);const $=Mr(I.apply(E,e));let V=null;I.supportsMasking&&(V=I.computeMask(E,A));const Z=U6e(T),Q=Array.isArray(Z)?Z:[Z];for(let re=0;re<Q.length;++re){y.hasKey(Q[re])||y.add(Q[re],$[re],Array.isArray(V)?V[0]:V);const oe=l.indexOf(Q[re].name);-1!==oe&&(c[oe]=$[re])}i||Qn(M)}return y.disposeMasks(),s?c:c[0]}function V6e(n){const t={};for(const e in n)t[e]=n[e].size;return t}function lhe(n,t){const e=new Set,r=[],i={};for(const l of t.names())e.add(l);const s=[],o=[];for(s.push(n);s.length>0;){const l=s[s.length-1];if(e.has(l.name)){s.pop();continue}const c=o[o.length-1]===s.length-1;if(0===l.inputs.length||c)s.pop(),r.push(l),e.add(l.name),c&&o.pop();else{o.push(s.length-1);for(const u of l.inputs)null==i[u.name]&&(i[u.name]=new Set),i[u.name].add(l.name),!e.has(u.name)&&s.push(u)}}return{sorted:r,recipientMap:i}}function U6e(n){let t;if(1===n.sourceLayer.inboundNodes.length)t=n.sourceLayer.output;else{let e=null;for(let r=0;r<n.sourceLayer.inboundNodes.length;++r)for(const i of n.sourceLayer.inboundNodes[r].outputTensors)if(i.id===n.id){e=r;break}t=n.sourceLayer.getOutputAt(e)}return t}function pK(n,t){return Ie(()=>bo(tn(ue(n,n),t,!0)))}Me().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function $6e(n){l3?.setMaxEntries(n),c3?.setMaxEntries(n)});class fR extends lT{getConfig(){return{}}}pt((()=>{class n extends fR{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ie(()=>{const r=pK(e,this.axis),i=kl(r,0,this.maxValue);return ue(e,ln(i,dt(Rs(),r)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}return n.className="MaxNorm",n})()),pt((()=>{class n extends fR{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ie(()=>ln(e,dt(Rs(),pK(e,this.axis))))}getConfig(){return{axis:this.axis}}}return n.className="UnitNorm",n})()),pt((()=>{class n extends fR{apply(e){return wh(e)}}return n.className="NonNeg",n})()),pt((()=>{class n extends fR{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ie(()=>{const r=pK(e,this.axis),i=dt(ue(this.rate,kl(r,this.minValue,this.maxValue)),ue(1-this.rate,r));return ue(e,ln(i,dt(Rs(),r)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}return n.className="MinMaxNorm",n})());const che={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Os(n){return iK(n)}function uhe(n,t={}){return aR(n,su.getMap().classNameMap,t,"constraint")}function Fs(n){return null==n?null:"string"==typeof n?uhe({className:n in che?che[n]:n,config:{}}):n instanceof fR?n:uhe(n)}function w_(n){return mK.apply(this,arguments)}function mK(){return mK=(0,q.Z)(function*(n){if(null==n)return;const t=[],e=[],r=[];for(const i in n){const s=n[i];if("number"!=typeof s){const o=s;t.push(o.data()),e.push(i),r.push(o)}}if(t.length>0){const i=yield Promise.all(t);for(let s=0;s<i.length;++s)n[e[s]]=i[s][0];Qn(r)}}),mK.apply(this,arguments)}function dhe(n){if(null!=n)for(const t in n){const e=n[t];"number"!=typeof e&&e.dispose()}}class xT{constructor(){this.validationData=null}setParams(t){this.params=t}onEpochBegin(t,e){return(0,q.Z)(function*(){})()}onEpochEnd(t,e){return(0,q.Z)(function*(){})()}onBatchBegin(t,e){return(0,q.Z)(function*(){})()}onBatchEnd(t,e){return(0,q.Z)(function*(){})()}onTrainBegin(t){return(0,q.Z)(function*(){})()}onTrainEnd(t){return(0,q.Z)(function*(){})()}setModel(t){}}class H6e{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}onEpochBegin(t,e){var r=this;return(0,q.Z)(function*(){null==e&&(e={});for(const i of r.callbacks)yield i.onEpochBegin(t,e)})()}onEpochEnd(t,e){var r=this;return(0,q.Z)(function*(){null==e&&(e={});for(const i of r.callbacks)yield i.onEpochEnd(t,e)})()}onBatchBegin(t,e){var r=this;return(0,q.Z)(function*(){null==e&&(e={});for(const i of r.callbacks)yield i.onBatchBegin(t,e)})()}onBatchEnd(t,e){var r=this;return(0,q.Z)(function*(){null==e&&(e={});for(const i of r.callbacks)yield i.onBatchEnd(t,e)})()}onTrainBegin(t){var e=this;return(0,q.Z)(function*(){null==t&&(t={});for(const r of e.callbacks)yield r.onTrainBegin(t)})()}onTrainEnd(t){var e=this;return(0,q.Z)(function*(){null==t&&(t={});for(const r of e.callbacks)yield r.onTrainEnd(t)})()}}class G6e extends xT{constructor(){super()}onEpochBegin(t){var e=this;return(0,q.Z)(function*(){e.seen=0,e.totals={}})()}onBatchEnd(t,e){var r=this;return(0,q.Z)(function*(){null==e&&(e={});const i=e.size??0;r.seen+=i;for(const s in e){const o=e[s];if("number"==typeof o)r.totals.hasOwnProperty(s)||(r.totals[s]=0),r.totals[s]=r.totals[s]+o*i;else{let l;s in r.totals?l=r.totals[s]:r.totals[s]=0;const c=Ie(()=>dt(r.totals[s],ue(o,i)));r.totals[s]=c,l?.dispose()}}})()}onEpochEnd(t,e){var r=this;return(0,q.Z)(function*(){if(null!=e)for(const i of r.params.metrics)null!=r.totals[i]&&("number"==typeof r.totals[i]?e[i]=r.totals[i]/r.seen:Ie(()=>{const s=ue(ln(1,r.seen),r.totals[i]);e[i]=s,r.totals[i].dispose(),Zs(e[i])}))})()}}class W6e extends xT{onTrainBegin(t){var e=this;return(0,q.Z)(function*(){e.epoch=[],e.history={}})()}onEpochEnd(t,e){var r=this;return(0,q.Z)(function*(){null==e&&(e={}),r.epoch.push(t);for(const i in e)null==r.history[i]&&(r.history[i]=[]),r.history[i].push(e[i])})()}syncData(){var t=this;return(0,q.Z)(function*(){const e=[],r=[],i=[];for(const o in t.history){const l=t.history[o];for(let c=0;c<l.length;++c)"number"!=typeof l[c]&&(e.push(l[c].data()),r.push(o),i.push(c))}const s=yield Promise.all(e);for(let o=0;o<s.length;++o)t.history[r[o]][i[o]].dispose(),t.history[r[o]][i[o]]=s[o][0]})()}}class j6e extends xT{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||tde,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");$5(this.yieldEvery)&&(this.maybeWait=function s6e(n,t,e){let i,r=null!=e?e():Qa();return(...o)=>{const l=null!=e?e():Qa();return l-r<t||(r=l,i=n(...o)),i}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}maybeWait(t,e,r){var i=this;return(0,q.Z)(function*(){const s=[];null!=i.yield&&(yield w_(r),s.push(i.yield(t,e,r))),s.push(i.nextFrameFunc()),yield Promise.all(s)})()}onEpochBegin(t,e){var r=this;return(0,q.Z)(function*(){r.currentEpoch=t,null!=r.epochBegin&&(yield w_(e),yield r.epochBegin(t,e))})()}onEpochEnd(t,e){var r=this;return(0,q.Z)(function*(){const i=[];null!=r.epochEnd&&(yield w_(e),i.push(r.epochEnd(t,e))),"epoch"===r.yieldEvery&&i.push(r.nextFrameFunc()),yield Promise.all(i)})()}onBatchBegin(t,e){var r=this;return(0,q.Z)(function*(){null!=r.batchBegin&&(yield w_(e),yield r.batchBegin(t,e))})()}onBatchEnd(t,e){var r=this;return(0,q.Z)(function*(){const i=[];null!=r.batchEnd&&(yield w_(e),i.push(r.batchEnd(t,e))),"batch"===r.yieldEvery?i.push(r.nextFrameFunc()):$5(r.yieldEvery)&&i.push(r.maybeWait(r.currentEpoch,t,e)),yield Promise.all(i)})()}onTrainBegin(t){var e=this;return(0,q.Z)(function*(){null!=e.trainBegin&&(yield w_(t),yield e.trainBegin(t))})()}onTrainEnd(t){var e=this;return(0,q.Z)(function*(){null!=e.trainEnd&&(yield w_(t),yield e.trainEnd(t))})()}}function hhe(n,t){return null==n&&(n={}),n instanceof xT?[n]:Array.isArray(n)&&n[0]instanceof xT?n:Mr(n).map(r=>new j6e(r,t))}let q6e=(()=>{class n{constructor(){}static registerCallbackConstructor(e,r){G(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),n.checkForDuplicate(r),null==n.constructors[e]&&(n.constructors[e]=[]),n.constructors[e].push(r)}static checkForDuplicate(e){for(const r in n.constructors)n.constructors[+r].forEach(s=>{if(s===e)throw new pe("Duplicate callback constructor.")})}static clear(){n.constructors={}}static createCallbacks(e){const r=[];for(const i in n.constructors){const s=+i;e>=s&&r.push(...n.constructors[s])}return r.map(i=>new i)}}return n.constructors={},n})();function fhe(n,t,e,r,i,s,o,l,c){const u=new W6e,f=[new G6e,...q6e.createCallbacks(t)];null!=n&&f.push(...n),f.push(u);const m=new H6e(f);return m.setParams({epochs:e,initialEpoch:r,samples:i,steps:s,batchSize:o,verbose:t,doValidation:l,metrics:c}),{callbackList:m,history:u}}function Ip(n,t={},e=!1){return aR(n,su.getMap().classNameMap,t,"layer",e)}function u3(n,t){return Ie(()=>{"float32"!==n.dtype&&(n=Pt(n,"float32"));const e=tn(uR(n),t,!0),r=cT(e.shape,Rs()),i=bo(_p(e,r));return ln(n,i)})}function d3(n,t){return Ie(()=>Gi(uR(Kt(t,n)),-1))}function gK(n,t){return Ie(()=>Gi(ks(Kt(t,n)),-1))}function _K(n,t){return Ie(()=>{const e=Kt(n,t),r=kl(ks(n),Rs(),Number.MAX_VALUE),i=ks(ln(e,r));return ue(100,Gi(i,-1))})}function pR(n,t,e=!1){return Ie(()=>{if(e)t=UV(t);else{const r=tn(t,t.shape.length-1,!0);t=ln(t,r)}return t=kl(t,Rs(),1-Rs()),pi(tn(ue(Pt(n,"float32"),fc(t)),t.shape.length-1))})}function h3(n,t,e=!1){return Ie(()=>{const r=Pt(QN(function v6e(n){const t=[y_(n.shape)];return fe(n,t)}(n)),"int32"),i=(t=kl(t,Rs(),1-Rs())).shape;return pR(fe(rY(r,i[i.length-1]),i),t,e)})}function f3(n,t){return Ie(()=>{let e;return e=kl(t,Rs(),1-Rs()),e=fc(ln(e,Kt(1,e))),Gi(function J6e(n,t){if(!dr(n.shape,t.shape))throw new pe(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(t.shape)}`);return Ie(()=>{const e=wh(t),r=pi(ks(t));return dt(Kt(e,ue(t,n)),AV(Al(r)))})}(n,e),-1)})}function phe(n,t){return Ie(()=>{const e=u3(n,-1),r=u3(t,-1),i=ue(e,r);return pi(tn(i,-1))})}const p3={meanSquaredError:d3,meanAbsoluteError:gK,meanAbsolutePercentageError:_K,meanSquaredLogarithmicError:function Z6e(n,t){return Ie(()=>{const e=kl(t,Rs(),Number.MAX_VALUE),r=fc(dt(1,e)),i=kl(n,Rs(),Number.MAX_VALUE),s=fc(dt(1,i));return Gi(uR(Kt(r,s)),-1)})},squaredHinge:function Y6e(n,t){return Ie(()=>{const e=_p(0,Kt(1,ue(n,t)));return Gi(uR(e),-1)})},hinge:function K6e(n,t){return Ie(()=>{const e=_p(0,Kt(1,ue(n,t)));return Gi(e,-1)})},categoricalHinge:function Q6e(n,t){return Ie(()=>{const e=tn(ue(n,t),-1),r=au(ue(Kt(1,n),t),-1);return _p(0,dt(1,Kt(r,e)))})},logcosh:function X6e(n,t){return Ie(()=>{const e=Math.log(2),r=Kt(t,n),i=Kt(dt(r,mT(ue(-2,r))),e);return Gi(i,-1)})},categoricalCrossentropy:pR,sparseCategoricalCrossentropy:h3,binaryCrossentropy:f3,kullbackLeiblerDivergence:function eWe(n,t){return Ie(()=>{const e=kl(n,Rs(),1),r=kl(t,Rs(),1);return tn(ue(n,fc(ln(e,r))),-1)})},poisson:function tWe(n,t){return Ie(()=>{const e=fc(dt(Rs(),t));return Gi(Kt(t,ue(n,e)),-1)})},cosineProximity:phe};function yK(n){if("string"==typeof n){if(n in p3)return p3[n];let t=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new pe(t)}return n}function mhe(n,t){return Ie(()=>{const e=ue(.5,pc(t)),r=Ih(Nl(t,e),n.dtype);return Gi(id(n,r),-1)})}function ghe(n,t){return Ie(()=>Ih(id(dT(n,-1),dT(t,-1)),"float32"))}function sWe(n,t){return f3(n,t)}function oWe(n,t){return n.rank===t.rank&&(n=t0(n,[n.rank-1])),(t=dT(t,-1)).dtype!==n.dtype&&(t=Pt(t,n.dtype)),Pt(id(n,t),"float32")}const yhe=pR,vhe=h3,m3={binaryAccuracy:mhe,categoricalAccuracy:ghe,precision:function iWe(n,t){return Ie(()=>{const e=function _he(n,t){return Ie(()=>Pt(tn(bh(id(n,1),id(t,1))),"float32"))}(n,t),r=function rWe(n,t){return Ie(()=>Pt(tn(bh(id(n,0),id(t,1))),"float32"))}(n,t),i=dt(e,r);return Pt(Xo(Nl(i,0),ln(e,i),0),"float32")})},categoricalCrossentropy:yhe,sparseCategoricalCrossentropy:vhe,mse:d3,MSE:d3,mae:gK,MAE:gK,mape:_K,MAPE:_K,cosine:phe};function pWe(n){if("string"==typeof n&&n in m3)return m3[n];if("string"!=typeof n&&null!=n)return n;throw new pe(`Unknown metric ${n}`)}function g3(n){if(gc(null!==n,`Unknown LossOrMetricFn ${n}`),"string"==typeof n)return n;{let t;for(const e of Object.keys(p3))if(p3[e]===n){t=e;break}if(void 0!==t)return t;for(const e of Object.keys(m3))if(m3[e]===n){t=e;break}return void 0!==t?t:n.name}}function whe(n,t,e=!1){if(null==n||"object"!=typeof n||Object.getPrototypeOf(n)!==Object.prototype||!vK(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){const r=JSON.stringify(n);r.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function vK(n){if(null===n)return!0;if("object"==typeof n){if(Object.getPrototypeOf(n)===Object.prototype){const t=Object.keys(n);for(const e of t)if("string"!=typeof e||!vK(n[e]))return!1;return!0}if(Array.isArray(n)){for(const t of n)if(!vK(t))return!1;return!0}return!1}{const t=typeof n;return"string"===t||"number"===t||"boolean"===t}}function _3(n,t,e=console.log){let r="";for(let i=0;i<n.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=n[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);e(r)}function vWe(n,t,e){let r,i;try{i=n.inboundNodes.map(c=>JSON.stringify(c.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}_3([`${n.name} (${n.getClassName()})`,i,r,n.countParams().toString()],t,e)}function bWe(n,t,e,r){let i,s;try{s=n.inboundNodes.map(m=>JSON.stringify(m.inputShapes)).join(",")}catch{s="multiple"}try{i=JSON.stringify(n.outputShape)}catch{i="multiple"}const o=[];for(const m of n.inboundNodes)if(!(null!=e&&e.length>0&&-1===e.indexOf(m)))for(let _=0;_<m.inboundLayers.length;++_)o.push(`${m.inboundLayers[_].name}[${m.nodeIndices[_]}][${m.tensorIndices[_]}]`);const l=n.name,c=n.getClassName(),u=0===o.length?"":o[0];_3([`${l} (${c})`,s,i,n.countParams().toString(),u],t,r);for(let m=1;m<o.length;++m)_3(["","","","",o[m]],t,r)}function Che(n,t,e){return("inboundNodes"===n||"outputLayers"===n||"inputLayers"===n)&&0===t&&"string"==typeof e}function bK(n,t){if(null===n)return null;if("string"==typeof n)return s0(n);if("number"==typeof n||"boolean"==typeof n)return n;if(n instanceof Array){const e=[],r=n.length;for(let i=0;i<r;++i){const s=n[i];Che(t,i,s)?e.push(s):e.push(bK(s,t))}return e}{const e={};for(const r of Object.keys(n)){const i=n[r];if("name"===r&&"string"==typeof i)e[r]=i;else{const s=s0(r);e[s]=bK(i,s)}}return e}}function wK(n,t){if(null==n)return null;if("string"==typeof n)return xp(n);if("number"==typeof n||"boolean"==typeof n)return n;if(n instanceof Array){const e=[],r=n.length;for(let i=0;i<r;++i){const s=n[i];Che(t,i,s)?e.push(s):e.push(wK(s,t))}return e}{const e={};for(const r of Object.keys(n)){const i=n[r];e[xp(r)]="name"!==r&&"className"!==r||"string"!=typeof i?wK(i,r):i}return e}}class cd extends Xn{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const A=this.getClassName().toLowerCase();this.name=JV(A)}if(this.supportsMasking=!1,this.trainable_=!0,this.inputs=Array.isArray(t.inputs)?t.inputs.slice():[t.inputs],this.outputs=Array.isArray(t.outputs)?t.outputs.slice():[t.outputs],__(this.inputs).length!==this.inputs.length)throw new pe(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(A=>A.name)}`);__(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(A=>A.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const A of this.outputs){const O=A.nodeIndex,$=A.tensorIndex;this.outputLayers.push(A.sourceLayer),this.outputLayersNodeIndices.push(O),this.outputLayersTensorIndices.push($)}for(const A of this.inputs){const M=A.sourceLayer,O=A.nodeIndex,$=A.tensorIndex;gc(0===O,"input layer has >1 nodes"),gc(0===$,"input layer has >1 tensors"),this.inputLayers.push(M),this.inputLayersNodeIndices.push(O),this.inputLayersTensorIndices.push($)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let A=0;A<this.inputLayers.length;A++){const M=this.inputLayers[A];if(!(M instanceof a3))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${A} (0-based) originates from layer type ${M.getClassName()}.`);this.inputNames.push(M.name),this.feedInputShapes.push(M.batchInputShape),this.feedInputNames.push(M.name)}for(const A of this.outputLayers)this.outputNames.push(A.name);this.internalInputShapes=this.inputs.map(A=>A.shape),this.internalOutputShapes=this.outputs.map(A=>A.shape);const e={},r={},i={},s={},o={},l=[],c=(A,M,O,$,V,Z)=>{(null==$||null==V||null==Z)&&($=A.sourceLayer,V=A.nodeIndex,Z=A.tensorIndex);const Q=$.inboundNodes[V];if(-1!==O.indexOf(Q))throw new du(`The tensor ${A.name} at layer "${$.name}" is part of a cycle.`);if(-1!==M.indexOf(Q))return;this.containerNodes.add(cd.nodeKey($,V)),$.id in o||(o[$.id]=Object.keys(o).length),-1===O.indexOf(Q)&&O.push(Q);const re=Q.inboundLayers.length;for(let oe=0;oe<re;oe++)c(Q.inputTensors[oe],M,O,Q.inboundLayers[oe],Q.nodeIndices[oe],Q.tensorIndices[oe]);for(M.push(Q);O.indexOf(Q)>=0;)O.splice(O.indexOf(Q),1);l.push(Q)},u=[],f=[];for(const A of this.outputs)c(A,u,f);const m=l.slice().reverse();for(const A of m){r[A.id]=A,A.id in e||(e[A.id]=0);let M=e[A.id];M=Math.max(M,i[A.outboundLayer.id]??0),i[A.outboundLayer.id]=M,s[A.outboundLayer.id]=A.outboundLayer,e[A.id]=M;for(let $=0;$<A.inboundLayers.length;$++){const Q=A.inboundLayers[$].inboundNodes[A.nodeIndices[$]];e[Q.id]=Math.max(M+1,e[Q.id]??0),r[Q.id]=Q}}const _={};for(const A in e){const M=e[A];M in _||(_[M]=[]),_[M].push(r[A])}const y={};for(const A in i){const M=i[A];M in y||(y[M]=[]),y[M].push(s[A])}let w=Object.keys(y).map(A=>parseInt(A,10)).sort(QV);this.layers=[];for(const A of w){const M=y[A];M.sort((O,$)=>{const V=o[O.id],Z=o[$.id];return V<Z?-1:V>Z?1:0});for(const O of M)O instanceof cd&&this.internalContainerRefs.push(O),this.layers.push(O)}this.layersByDepth=y,w=Object.keys(_).map(A=>parseInt(A,10)).sort(QV);const T=this.inputs.slice(),I=[];for(const A of w)for(const M of _[A]){const O=M.outboundLayer;if(null!=O){for(const $ of M.inputTensors)if(-1===T.indexOf($))throw new du(`Graph disconnected: cannot obtain value for tensor ${$} at layer "${O.name}". The following previous layers were accessed without issue: ${I}`);for(const $ of M.outputTensors)T.push($);I.push(O.name)}}this.nodesByDepth=_;const E=this.layers.map(A=>A.name);for(const A of E){const M=E.filter(O=>O===A).length;if(1!==M)throw new du(`The name "${A}" is used ${M} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(E))}this.outboundNodes=[],this.inboundNodes=[],new o3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(A=>null),outputMasks:this.outputs.map(A=>null),inputShapes:this.inputs.map(A=>A.shape),outputShapes:this.outputs.map(A=>A.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new pe("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const r of this.layers)e.push(...r.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const r={};let i=0;const s=(n=>{const t=Object.keys(n);if(0===t.length)return!1;const e=t[0].split("/");return!isNaN(parseInt(e[e.length-1],10))})(t);s&&this.parseWeights(t);for(const l of this.layers)for(const[c,u]of l.weights.entries()){const f=s?`${u.name.split("/").slice(0,-1).join("/")+"/"}${c}`:u.originalName;if(null!=r[f])throw new pe(`Duplicate weight name: ${f}`);r[f]=u,i++}const o=[];for(const l in t){let c=l;if(null==r[l]){const u=l.split("/");c=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(null!=r[c])o.push([r[c],t[l]]);else if(e)throw new pe(`Provided weight data has no target variable: ${l}`);delete r[c]}if(e){const l=[];for(const c in r)l.push(c);if(l.length>0)throw new pe(`${l.length} of ${i} weights are not set: ${l}`)}fK(o)}parseWeights(t){for(const e in Object.keys(t)){const r=e.split("/"),i=["vars","layer_checkpoint_dependencies"],s=r.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!i.includes(o)).join("/");s!==e&&(t[s]=t[e],delete t[e])}}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 4.22.0",e.backend="TensorFlow.js",e}toJSON(t,e=!0){const r=wK(this.updatedConfig());return e?JSON.stringify(r):r}call(t,e){return Ie(()=>{t=Mr(t);const r=new b_;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return hR(this.outputs,r,e)})}computeMask(t,e){return Ie(()=>{let r;return t=Mr(t),r=null==e?r0(null,t.length):Mr(e),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){const e=r3(t);if(e.length!==this.inputLayers.length)throw new pe(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let l=0;l<e.length;l++)r[this.inputLayers[l].name+"_0_0"]=e[l];const i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(QV);if(i.length>1)for(const l of i){const c=this.nodesByDepth[l];for(const u of c){const f=u.outboundLayer;if(-1!==this.inputLayers.map(T=>T.id).indexOf(f.id))continue;const m=[];for(let T=0;T<u.inboundLayers.length;T++)m.push(r[`${u.inboundLayers[T].name}_${u.nodeIndices[T]}_${u.tensorIndices[T]}`]);const y=r3(f.computeOutputShape(Ja(m))),w=f.inboundNodes.indexOf(u);for(let T=0;T<y.length;T++)r[`${f.name}_${w}_${T}`]=y[T]}}const s=[],o=[];for(let l=0;l<this.outputLayers.length;l++)o.push(`${this.outputLayers[l].name}_${this.outputLayersNodeIndices[l]}_${this.outputLayersTensorIndices[l]}`);for(let l=0;l<o.length;l++){const c=o[l];gc(c in r),s.push(r[c])}return Ja(s)}runInternalGraph(t,e){null==e&&(e=r0(null,t.length));const r={};for(let c=0;c<this.inputs.length;++c)r[this.inputs[c].id]=[t[c],e[c]];const i=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(QV);for(const c of i){const u=this.nodesByDepth[c];for(const f of u){const m=f.outboundLayer,_=f.inputTensors,y=f.outputTensors,w=new Array;for(const T of _)T.id in r&&w.push(r[T.id]);if(w.length===_.length){let I,E,A,M,T={};if(null!=f.callArgs&&(T=f.callArgs),1===w.length){const[O,$]=w[0];null==T.mask&&(T.mask=$),A=Mr(m.call(O,T)),M=Mr(m.computeMask(O,$)),I=[O],E=[$]}else I=w.map(O=>O[0]),E=w.map(O=>O[1]),null==T.mask&&(T.mask=E),A=Mr(m.call(I,T)),M=Mr(m.computeMask(I,E));if(m.activityRegularizer)throw new zn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let O=0;O<y.length;++O)r[y[O].id]=[A[O],M[O]]}}}const s=[],o=[],l=[];for(const c of this.outputs){gc(c.id in r,`Could not compute output ${c.name} : ${c.id}`);const[u,f]=r[c.id];l.push(u.shape),s.push(u),o.push(f)}return[s,o,l]}buildNodeConversionMap(t){const e={};let r;for(const i of this.layers){r=i instanceof cd?1:0;for(let s=0;s<i.inboundNodes.length;s++){const o=cd.nodeKey(i,s);this.containerNodes.has(o)&&(e[o]=r,r+=1)}}return e}getLayer(t,e){if(null!=e)return this.findLayer(e);if(null==t)throw new pe("Provide either a layer name or layer index");if("number"==typeof t)return this.findLayer(t);for(const r of this.layers)if(r.name===t)return r;throw new pe(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new pe(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return Ie(()=>{const t=[];for(const e of this.layers)for(let r=0;r<e.inboundNodes.length;++r){const i=cd.nodeKey(e,r);this.containerNodes.has(i)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const l=o.getClassName(),c=o.getConfig(),u=[];for(let m=0;m<o.inboundNodes.length;m++){const _=o.inboundNodes[m],y=cd.nodeKey(o,m);let w={};if(this.containerNodes.has(y)){if(_.callArgs)try{JSON.stringify(_.callArgs),w=_.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${_.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),w={}}if(_.inboundLayers.length>0){const T=[];for(let I=0;I<_.inboundLayers.length;I++){const E=_.inboundLayers[I],M=_.tensorIndices[I];let $=e[cd.nodeKey(E,_.nodeIndices[I])];null==$&&($=0),T.push([E.name,$,M,w])}u.push(T)}}}const f={};f.name=o.name,f.className=l,f.config=c,f.inboundNodes=u,r.push(f)}t.layers=r;const i=[];for(let o=0;o<this.inputLayers.length;o++){const l=this.inputLayers[o],u=cd.nodeKey(l,this.inputLayersNodeIndices[o]);if(!this.containerNodes.has(u))continue;let f=e[u];null==f&&(f=0),i.push([l.name,f,this.inputLayersTensorIndices[o]])}t.inputLayers=i;const s=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],u=cd.nodeKey(l,this.outputLayersNodeIndices[o]);if(!this.containerNodes.has(u))continue;let f=e[u];null==f&&(f=0),s.push([l.name,f,this.outputLayersTensorIndices[o]])}return t.outputLayers=s,t}static fromConfig(t,e,r={},i=!1){const s={},o={};function l(I,E){I.name in o?o[I.name].push(E):o[I.name]=[E]}function c(I,E){const A=[];let M;for(const O of E){const $=O[0],V=O[1],Z=O[2];if(M=O[3]??{},!($ in s))return void l(I,E);const Q=s[$];if(Q.inboundNodes.length<=V)return void l(I,E);A.push(Q.inboundNodes[V].outputTensors[Z])}A.length>0&&I.apply(Ja(A),M)}function u(I){const E=I.name,A=Ip(I,null!=e.customObjects?e.customObjects:{});A.setFastWeightInitDuringBuild(i),s[E]=A,I.inboundNodes.forEach(O=>{if(!(O instanceof Array))throw new pe(`Corrupted configuration, expected array for nodeData: ${O}`);l(A,O)})}const f=e.name,m=e.layers;for(const I of m)u(I);for(;!i6e(o);)for(const I of m){const E=s[I.name];if(E.name in o){const A=o[E.name];delete o[E.name];for(const M of A)c(E,M)}}const _=[],y=[],w=e.inputLayers;for(const I of w){const E=I[0],A=I[1],M=I[2];gc(E in s),_.push(s[E].inboundNodes[A].outputTensors[M])}const T=e.outputLayers;for(const I of T){const E=I[0],A=I[1],M=I[2];gc(E in s),y.push(s[E].inboundNodes[A].outputTensors[M])}return new t({inputs:_,outputs:y,name:f})}get stateful(){if(this._stateful)throw new pe("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Ie(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}function Ihe(n,t){return function xhe(n,t,e){const r=t.length;if(null==n||Array.isArray(n)&&0===n.length)return t.map(i=>null);if(1===r)return Array.isArray(n)&&1===n.length?n:"object"==typeof n&&t[0]in n?[n[t[0]]]:[n];if(Array.isArray(n)){if(n.length!==r)throw new Error(`Provided ${e} is an array of ${n.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return n}if("object"==typeof n&&Object.keys(n).length>0&&"object"==typeof n[Object.keys(n)[0]]){const i=[];return t.forEach(s=>{i.push(s in n?n[s]:null)}),i}throw new Error(`The model has multiple (${r}) outputs, so ${e} must be either an array with ${r} elements or an object with ${t} keys. Provided ${e} not understood: ${JSON.stringify(n)}`)}(n,t,"classWeight")}function The(n,t,e,r){return xK.apply(this,arguments)}function xK(){return xK=(0,q.Z)(function*(n,t,e,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=e){const i=Ie(()=>{if(1===n.shape.length)return pp(n);if(2===n.shape.length){if(n.shape[1]>1)return dT(n,1);if(1===n.shape[1])return fe(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(yield i.data());Qn(i);const o=[];return s.forEach(l=>{if(null==e[l])throw new Error(`classWeight must contain all classes in the training data. The class ${l} exists in the data but not in classWeight`);o.push(e[l])}),Ca(o,"float32")}return null}),xK.apply(this,arguments)}function CWe(n,t){return ue(n,t)}function She(n,t){let e,r;e=t.xs,r=t.ys,G(null!=e&&null!=r,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const s=Ehe("input",n.inputNames,e),o=Ehe("output",n.outputNames,r),l=s[0].shape[0];G(s.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),G(o.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let c=0;c<s.length;c++)G(s[c].shape[0]===l,()=>`Batch size mismatch: input ${n.inputNames[c]} has ${s[c].shape[0]}; expected  ${l} based on input ${n.inputNames[0]}.`);for(let c=0;c<o.length;c++)G(o[c].shape[0]===l,()=>`Batch size mismatch: output ${n.outputNames[c]} has ${o[c].shape[0]}; expected  ${l} based on input ${n.inputNames[0]}.`);return{xs:s,ys:o}}function Ehe(n,t,e){if(e instanceof fi)return[e];if(Array.isArray(e))return G(e.length===t.length,()=>`Received an array of ${e.length} Tensors, but expected ${t.length} to match the ${n} keys ${t}.`),e;{const r=[];for(const i of t){if(null==e[i])throw new pe(`The feature data generated by the dataset lacks the required ${n} key '${i}'.`);r.push(e[i])}return r}}function IWe(n){if(3===n.length)throw new zn("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}function IK(){return IK=(0,q.Z)(function*(n,t,e){const r=null!=e.batchesPerEpoch;if(G(null!=n.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),G(null!=e,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),G(null!=e.epochs&&e.epochs>0&&Number.isInteger(e.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${e.epochs}`),G(!r||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${e.batchesPerEpoch}`),G(null==e.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const i=null!=e.validationData;let s,o;if(i)if(Dhe(e.validationData))G(null==e.validationBatches||e.validationBatches>0&&Number.isInteger(e.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${e.validationBatches}`);else{const I=IWe(e.validationData);s=I.xs,o=I.ys}const l=n.makeTrainFunction(),c=n.getDedupedMetricsNames();let u;u=i?c.slice().concat(c.map(I=>"val_"+I)):c.slice();const f=hhe(e.callbacks,e.yieldEvery),m=e.verbose??1,{callbackList:_,history:y}=fhe(f,m,e.epochs,null,null,SWe(t,e),null,i,u);_.setModel(n),n.history=y,yield _.onTrainBegin(),n.stopTraining_=!1;let w=e.initialEpoch??0,T=yield t.iterator();for(;w<e.epochs;){const I={};yield _.onEpochBegin(w);let E=0,A=0;for(r||(T=yield t.iterator());!r||E<e.batchesPerEpoch;){const M=yield T.next();if(r&&M.done){console.warn(`You provided \`batchesPerEpoch\` as ${e.batchesPerEpoch}, but your dataset iterator ran out of data after ${E} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${e.batchesPerEpoch*e.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(null!=M.value){const{xs:O,ys:$}=She(n,M.value),V={};V.batch=A,V.size=O[0].shape[0],yield _.onBatchBegin(A,V);const Z=[];if(null!=e.classWeight){const oe=Ihe(e.classWeight,n.outputNames);for(let ye=0;ye<oe.length;++ye)Z.push(yield The($[ye],null,oe[ye]))}const Q=O.concat($).concat(Z),re=l(Q);Qn(Q);for(let oe=0;oe<c.length;++oe){const Ve=re[oe];V[c[oe]]=Ve,Zs(Ve)}yield _.onBatchEnd(A,V),dhe(V),A++,E++}if(r?E>=e.batchesPerEpoch:M.done){if(i){let O;O=Dhe(e.validationData)?Mr(yield n.evaluateDataset(e.validationData,{batches:e.validationBatches})):Mr(n.evaluate(s,o,{batchSize:e.validationBatchSize??32,verbose:0}));for(let $=0;$<n.metricsNames.length;++$)I[`val_${n.metricsNames[$]}`]=O[$]}break}if(n.stopTraining_)break}if(yield _.onEpochEnd(w,I),w++,n.stopTraining_)break}return yield _.onTrainEnd(),yield n.history.syncData(),n.history}finally{n.isTraining=!1}}),IK.apply(this,arguments)}function SWe(n,t){let e=null;return null!=t.batchesPerEpoch?e=t.batchesPerEpoch:Number.isFinite(n.size)&&(e=n.size),e}function Dhe(n){return"function"==typeof n.iterator}function EWe(n){return"function"==typeof n.next}function TK(){return TK=(0,q.Z)(function*(n,t,e){const r=null!=(e=e||{}).batches,i=n.testFunction;let s=[];if(e.verbose>0)throw new zn("Verbose mode is not implemented yet.");G(!r||e.batches>0&&Number.isInteger(e.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(e.batches)}`);const o=EWe(t)?t:yield t.iterator();let l=0,c=0;for(;!r||c<e.batches;){const u=yield o.next();if(s=Ie(()=>{if(u.value){const{xs:f,ys:m}=She(n,u.value),_=f.concat(m),y=Ie(()=>i(_));if(Qn(_),0===c)for(let T=0;T<y.length;++T)s.push(gn(0));const w=_[0].shape[0];for(let T=0;T<y.length;++T){const I=y[T],E=s[T];s[T]=Ie(()=>dt(s[T],ue(w,I))),c>0&&Qn(E)}Qn(y),l+=w,++c}return s}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${e.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<s.length;++u){const f=s[u];s[u]=ln(s[u],l),Qn(f)}return Ja(s)}),TK.apply(this,arguments)}function SK(n){G(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function mR(n,t,e){return null==n?[null]:Array.isArray(n)?n.map(r=>l0(r,t,e-t)):l0(n,t,e-t)}function EK(n,t){return Ie(()=>null==n?null:Array.isArray(n)?n.map(e=>EK(e,t)):Yde(n,"int32"===t.dtype?t:Pt(t,"int32")))}function DK(n,t){const e=[];let r=0,i=null;for(;r<n;)i=r+t,i>=n&&(i=n),e.push([r,i]),r=i;return e}function khe(n){const t=[];n instanceof fi&&(n=[n]);for(let e=0;e<n.length;++e){const r=n[e];if(1===r.rank)t.push(cR(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function ud(n,t){if(null==n)return;const e=[];if(t instanceof fi)e.push(t.id);else if(Array.isArray(t))t.forEach(i=>e.push(i.id));else if(null!=t)for(const i in t)e.push(t[i].id);const r=[];if(n instanceof fi)-1===e.indexOf(n.id)&&r.push(n);else if(Array.isArray(n))n.forEach(i=>{-1===e.indexOf(i.id)&&r.push(i)});else if(null!=n)for(const i in n){const s=n[i];-1===e.indexOf(s.id)&&r.push(s)}r.forEach(i=>{i.isDisposed||i.dispose()})}function kK(n){return Array.isArray(n)}function Ahe(n){return!function kWe(n){return n instanceof fi}(n)&&!kK(n)}function Nhe(n,t,e,r=!0,i=""){if(null==t||0===t.length){if(null!=n){let o=!1;if(kK(n)&&n.length>0)o=!0;else if(Ahe(n)){for(const l in n)if(n.hasOwnProperty(l)){o=!0;break}}else o=!0;if(o)throw new pe(`Error when checking model ${i} expected no data, but got ${n}`)}return[]}if(null==n)return t.map(o=>null);let s;if(Ahe(n)){s=[];for(const o of t){if(null==n[o])throw new pe(`No data provided for "${o}". Need data for each key in: ${t}`);s.push(n[o])}}else if(kK(n)){if(n.length!==t.length)throw new pe(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);s=n}else{if(t.length>1)throw new pe(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);s=[n]}if(s=khe(s),null!=e)for(let o=0;o<t.length;++o){if(null==e[o])continue;const l=s[o];if(l.shape.length!==e[o].length)throw new pe(`Error when checking ${i}: expected ${t[o]} to have ${e[o].length} dimension(s). but got array with shape ${l.shape}`);for(let c=0;c<e[o].length;++c){if(0===c&&!r)continue;const u=l.shape[c],f=e[o][c];if(null!=f&&f>=0&&u!==f)throw new pe(`${i} expected a batch of elements where each example has shape [${e[o].slice(1,e[o].length)}] (i.e.,tensor shape [*,${e[o].slice(1,e[o].length)}]) but the ${i} received an input with ${l.shape[0]} examples, each with shape [${l.shape.slice(1,l.shape.length)}] (tensor shape [${l.shape}])`)}}return s}function Rhe(n,t,e,r=!0,i=""){let s;if(Array.isArray(n)){if(n.length!==t.length)throw new pe(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${n.length} Tensors(s).`);s=n}else{if(t.length>1)throw new pe(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);s=[n]}if(null!=e)for(let o=0;o<t.length;++o){if(null==e[o])continue;const l=s[o];if(l.shape.length!==e[o].length)throw new pe(`Error when checking ${i}: expected ${t[o]} to have ${e[o].length} dimension(s), but got array with shape ${JSON.stringify(l.shape)}`);for(let c=0;c<e[o].length;++c){if(0===c&&!r)continue;const u=l.shape[c],f=e[o][c];if(null!=f&&f!==u)throw new pe(`Error when checking ${i}: expected ${t[o]} to have shape ${JSON.stringify(e[o])} but got array with shape ${JSON.stringify(l.shape)}.`)}}}let IT=(()=>{class n extends cd{constructor(e){super(e),this.isTraining=!1}summary(e,r,i=console.log){if(!this.built)throw new pe("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function gWe(n,t,e,r=console.log){const i=function yWe(n){let t=!0;const e=[],r=[];for(const i in n.nodesByDepth)e.push(n.nodesByDepth[i]);for(const i of e){if(i.length>1||1===i.length&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(const i of n.layers){let s=!1;for(const o of i.inboundNodes)if(-1!==r.indexOf(o)){if(s){t=!1;break}s=!0}if(!t)break}return t}(n),s=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(i?(t=t||90,e=e||[.32,.61,.89,1]):(t=t||115,e=e||[.24,.48,.7,.8,1]),e[e.length-1]<=1&&(e=e.map(f=>Math.floor(t*f))),!i){s.push("Receives inputs"),o=[];for(const f in n.nodesByDepth)o.push(...n.nodesByDepth[f])}r("_".repeat(t)),_3(s,e,r),r("=".repeat(t));const l=n.layers;for(let f=0;f<l.length;++f)i?vWe(l[f],e,r):bWe(l[f],e,o,r),r((f===l.length-1?"=":"_").repeat(t));n.checkTrainableWeightsConsistency();const c=function _We(n){let t;return t=s3(null!=n.collectedTrainableWeights?n.collectedTrainableWeights:n.trainableWeights),t}(n),u=s3(n.nonTrainableWeights);r(`Total params: ${c+u}`),r(`Trainable params: ${c}`),r(`Non-trainable params: ${u}`),r("_".repeat(t))}(this,e,r,i)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function mWe(n){const t={Adagrad:()=>bT.adagrad(.01),Adadelta:()=>bT.adadelta(1,.95,Rs()),Adam:()=>bT.adam(.001,.9,.999,Rs()),Adamax:()=>bT.adamax(.002,.9,.999,Rs(),0),RMSProp:()=>bT.rmsprop(.001,.9,0,Rs()),SGD:()=>bT.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,n in t)return t[n]();throw new pe(`Unknown Optimizer ${n}`)}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof u_))throw new pe("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let r=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new pe(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);r=e.loss.map(c=>yK(c))}else{const l=yK(e.loss);this.outputs.forEach(c=>{r.push(l)})}else{e.loss=e.loss;for(const l in e.loss)if(-1===this.outputNames.indexOf(l))throw new pe(`Unknown entry in loss dictionary: "${l}". Only expected the following keys: ${this.outputNames}`);for(const l of this.outputNames)null==e.loss[l]&&console.warn(`Output "${l}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${l} during training`),r.push(yK(e.loss[l]))}this.lossFunctions=r,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let l=0;l<this.outputs.length;++l){const c=this.internalOutputShapes[l];this.feedOutputNames.push(this.outputNames[l]),this.feedOutputShapes.push(c),this.feedLossFns.push(this.lossFunctions[l])}const i=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],a0("loss",()=>{for(let l=0;l<this.outputs.length;++l){if(-1!==i.indexOf(l))continue;const c=this.lossFunctions[l];this.outputs.length>1&&(this.metricsTensors.push([c,l]),this.metricsNames.push(this.outputNames[l]+"_loss"))}});const s=function RWe(n,t){if(null==n||Array.isArray(n)&&0===n.length)return t.map(r=>[]);let e;if("string"==typeof n||"function"==typeof n)e=[n];else{if(!Array.isArray(n)&&"object"!=typeof n)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);e=n}if(Array.isArray(e))return t.map(r=>e);{const r=[];for(const i of t){let s=e.hasOwnProperty(i)?e[i]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}(e.metrics,this.outputNames),o=(l,c,u)=>{this.outputNames.length>1&&(c=this.outputNames[l]+"_"+c),this.metricsNames.push(c),this.metricsTensors.push([u,l])};a0("metric",()=>{for(let l=0;l<this.outputs.length;++l)-1===i.indexOf(l)&&(f=>{let _,y,w;for(const T of f){if("string"==typeof T&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(T)){const E=this.internalOutputShapes[l];let A;1===E[E.length-1]||this.lossFunctions[l]===f3?-1!==["accuracy","acc"].indexOf(T)?y=mhe:-1!==["crossentropy","ce"].indexOf(T)&&(y=sWe):this.lossFunctions[l]===h3?-1!==["accuracy","acc"].indexOf(T)?y=oWe:-1!==["crossentropy","ce"].indexOf(T)&&(y=vhe):-1!==["accuracy","acc"].indexOf(T)?y=ghe:-1!==["crossentropy","ce"].indexOf(T)&&(y=yhe),-1!==["accuracy","acc"].indexOf(T)?A="acc":-1!==["crossentropy","ce"].indexOf(T)&&(A="ce"),w=y,_=""+A}else w=pWe(T),_=""+g3(T);let I;a0(_,()=>{I=w}),o(l,_,I)}})(s[l])}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,r,i={}){const s=i.batchSize??32;SK(s);const l=this.standardizeUserDataXY(e,r,!0,s);try{const c=l[0].concat(l[1]);return this.makeTestFunction(),Ja(this.testLoop(this.testFunction,c,s,i.verbose,i.steps))}finally{ud(l[0],e),ud(l[1],r)}}evaluateDataset(e,r){var i=this;return(0,q.Z)(function*(){return i.makeTestFunction(),function DWe(n,t,e){return TK.apply(this,arguments)}(i,e,r)})()}checkNumSamples(e,r,i,s="steps"){let o;if(null!=i){if(o=null,null!=r)throw new pe(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${r}`)}else{if(null==e)throw new pe(`Either the input data should have a defined shape, or ${s} shoud be specified.`);o=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return o}execute(e,r){if(Array.isArray(r)&&0===r.length)throw new pe("`outputs` is an empty Array, which is not allowed.");const i=Array.isArray(r),o=this.retrieveSymbolicTensors(i?r:[r]),l=new b_;if(e instanceof fi&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new pe(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let u=0;u<this.inputs.length;++u)l.add(this.inputs[u],e[u])}else for(const u of this.inputs){const f=e[u.name];if(null==f)throw new pe(`No value is provided for the model's input ${u.name}`);l.add(u,f)}const c=hR(o,l);return i?c:c[0]}retrieveSymbolicTensors(e){const r=r0(null,e.length);let i=e.length;for(const s of this.layers){const o=Array.isArray(s.output)?s.output:[s.output],l=o.map(c=>c.name);for(let c=0;c<e.length;++c){const u=l.indexOf(e[c]);if(-1!==u&&(r[c]=o[u],i--),0===i)break}if(0===i)break}if(i>0){const s=[];throw r.forEach((o,l)=>{null==o&&s.push(e[l])}),new pe(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return r}predictLoop(e,r=32,i=!1){return Ie(()=>{const s=this.checkNumSamples(e);if(i)throw new zn("Verbose predictLoop() is not implemented yet.");const o=DK(s,r),l=this.outputs.map(c=>[]);for(let c=0;c<o.length;++c)Ie(()=>{const _=mR(e,o[c][0],o[c][1]),y=[];if(Array.isArray(_))for(let T=0;T<_.length;++T)y.push({key:this.inputs[T],value:_[T]});else y.push({key:this.inputs[0],value:_});const w=new b_(y);return hR(this.outputs,w)}).forEach((f,m)=>l[m].push(f));return Ja(l.map(c=>ms(c,0)))})}predict(e,r={}){const i=khe(e);Rhe(i,this.inputNames,this.feedInputShapes,!1);try{const s=r.batchSize??32;return SK(s),this.predictLoop(i,s)}finally{ud(i,e)}}predictOnBatch(e){Rhe(e,this.inputNames,this.feedInputShapes,!0);const r=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,r)}standardizeUserDataXY(e,r,i=!0,s){if(null==this.optimizer_)throw new du("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let l=0;l<this.feedOutputShapes.length;++l){const c=this.feedOutputShapes[l];o.push(this.feedLossFns[l]===h3?c.slice(0,c.length-1).concat([1]):c)}if(function AWe(n,t,e){const r=__(n.map(s=>s.shape[0]));r.sort();const i=__(t.map(s=>s.shape[0]));if(i.sort(),r.length>1)throw new pe(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(s=>s.shape))}`);if(i.length>1)throw new pe(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(r.length>0&&i.length>0&&!dr(r,i))throw new pe(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}(e=Nhe(e,this.feedInputNames,this.feedInputShapes,!1,"input"),r=Nhe(r,this.feedOutputNames,o,!1,"target")),function NWe(n,t,e){const r=[d3,f3,pR];for(let i=0;i<n.length;++i){const s=n[i],o=t[i],l=e[i];if(null!=o){if(o===pR&&1===s.shape[s.shape.length-1])throw new pe(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(o)){const c=s.shape.slice(1),u=l.slice(1);for(let f=0;f<c.length;++f){const m=c[f],_=u[f];if(null!=_&&m!==_)throw new pe(`A target Tensor with shape ${s.shape} was passed for an output of shape ${l}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=s&&s>0&&e[0].shape[0]%s!=0)throw new pe(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,r]}standardizeUserData(e,r,i,s,o=!0,l){var c=this;return(0,q.Z)(function*(){const[u,f]=c.standardizeUserDataXY(e,r,o,l);if(null!=i)throw new Error("sample weight is not supported yet.");let m=null;if(null!=s){const _=Ihe(s,c.outputNames);m=[];for(let y=0;y<_.length;++y)m.push(yield The(f[y],null,_[y]))}return[u,f,m]})()}testLoop(e,r,i,s=0,o){return Ie(()=>{const l=this.checkNumSamples(r,i,o,"steps"),c=[];if(s>0)throw new zn("Verbose mode is not implemented yet.");if(null!=o)throw new zn("steps mode in testLoop() is not implemented yet");{const u=DK(l,i),f=Ca(od(0,l));for(let m=0;m<u.length;++m){const _=u[m][0],y=u[m][1],w=l0(f,_,y-_),T=EK(r,w),I=e(T);if(0===m)for(let E=0;E<I.length;++E)c.push(gn(0));for(let E=0;E<I.length;++E)c[E]=dt(c[E],ue(y-_,I[E]))}for(let m=0;m<c.length;++m)c[m]=ln(c[m],l)}return c})}getDedupedMetricsNames(){const e=this.metricsNames,r=[];for(let i=0;i<e.length;++i){const s=e[i];let o=s;$de(e,s)>1&&(o+=`_${$de(e.slice(0,i),s)}`),r.push(o)}return r}makeTrainFunction(){return e=>{const r=[],i=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),l=[],u=this.collectedTrainableWeights.map(_=>_.read());return[this.optimizer_.minimize(()=>{const _=[];for(let I=0;I<this.inputs.length;++I)_.push({key:this.inputs[I],value:i[I]});const y=new b_(_),w=hR(this.outputs,y,{training:!0});let T;for(let I=0;I<this.lossFunctions.length;++I){let A=(0,this.lossFunctions[I])(s[I],w[I]);null!=o[I]&&(A=CWe(A,o[I]));const M=Gi(A);r.push(M),T=0===I?A:dt(T,A)}for(let I=0;I<this.metricsTensors.length;++I){let E;if(this.outputs.length>1&&I<this.outputs.length)E=r[I];else{const M=this.metricsTensors[I][1];E=Gi((0,this.metricsTensors[I][0])(s[M],w[M]))}Zs(E),l.push(E)}return T=Gi(T),this.calculateLosses().forEach(I=>{T=dt(T,I)}),T},!0,u)].concat(l)}}makeTestFunction(){this.testFunction=e=>Ie(()=>{const r=[];let i;const s=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),l=[];for(let f=0;f<this.inputs.length;++f)l.push({key:this.inputs[f],value:s[f]});const c=new b_(l),u=hR(this.outputs,c);for(let f=0;f<this.lossFunctions.length;++f){const _=Gi((0,this.lossFunctions[f])(o[f],u[f]));i=0===f?_:dt(i,_),r.push(i)}for(let f=0;f<this.metricsTensors.length;++f){const _=this.metricsTensors[f][1],y=Gi((0,this.metricsTensors[f][0])(o[_],u[_]));r.push(y)}return r})}fit(e,r,i={}){var s=this;return(0,q.Z)(function*(){if(s.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let o,l,c,u,f,m,_,y,w;s.isTraining=!0;try{const T=i.batchSize??32;SK(T);const I=!1,E=yield s.standardizeUserData(e,r,i.sampleWeight,i.classWeight,I,T);o=E[0],l=E[1],w=E[2];let M,A=!1;if(null!=i.validationData&&i.validationData.length>0){if(A=!0,2!==i.validationData.length)throw 3===i.validationData.length?new zn("validationData including sample weights is not supported yet."):new pe(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${i.validationData} is invalid.`);f=i.validationData[0],m=i.validationData[1];const ye=!0,Ve=yield s.standardizeUserData(f,m,null,null,ye,T);_=Ve[0],y=Ve[1],M=_.concat(y)}else if(null!=i.validationSplit&&i.validationSplit>0&&i.validationSplit<1){A=!0;const ye=Math.floor(o[0].shape[0]*(1-i.validationSplit)),Ve=o[0].shape[0];_=mR(o,ye,Ve),c=o,o=mR(o,0,ye),y=mR(l,ye,Ve),u=l,l=mR(l,0,ye),M=_.concat(y)}else null!=i.validationSteps&&(A=!0);const O=o.concat(l).concat(w);s.checkTrainableWeightsConsistency();const $=s.makeTrainFunction(),V=s.getDedupedMetricsNames();let Z,Q;A?(s.makeTestFunction(),Z=s.testFunction,Q=V.slice().concat(V.map(ye=>"val_"+ye))):(Z=null,M=[],Q=V.slice());const re=hhe(i.callbacks,i.yieldEvery);return yield s.fitLoop($,O,V,T,i.epochs,i.verbose,re,Z,M,i.shuffle,Q,i.initialEpoch,null,null)}finally{s.isTraining=!1,ud(o,e),ud(l,r),ud(c,e),ud(u,r),ud(_,f),ud(y,m),null!=w&&Qn(w)}})()}fitLoop(e,r,i,s,o,l,c,u,f,m,_,y,w,T){var I=this;return(0,q.Z)(function*(){null==s&&(s=32),null==o&&(o=1),null==m&&(m=!0),null==y&&(y=0);let E=!1;if(null!=u&&null!=f&&(E=!0),null!=T&&(E=!0,null==w))throw new pe("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const A=I.checkNumSamples(r,s,w,"steps_per_epoch");let M;null!=A&&(M=od(0,A)),null==l&&(l=1);const{callbackList:O,history:$}=fhe(c,l,o,y,A,w,s,E,_);O.setModel(I),I.history=$,yield O.onTrainBegin(),I.stopTraining_=!1;for(let V=y;V<o;++V){yield O.onEpochBegin(V);const Z={};if(null!=w)throw new zn("stepsPerEpoch mode is not implemented yet.");{if("batch"===m)throw new zn("batch shuffling is not implemneted yet");m&&Sle(M);const Q=Ca(M),re=DK(A,s);for(let oe=0;oe<re.length;++oe){const ye={};if(yield O.onBatchBegin(oe,ye),Ie(()=>{const Ve=re[oe][0],We=re[oe][1],Ke=l0(Q,Ve,We-Ve);ye.batch=oe,ye.size=We-Ve;const Qe=EK(r,Ke),ge=e(Qe);for(let we=0;we<i.length;++we){const ze=ge[we];ye[i[we]]=ze,Zs(ze)}if(oe===re.length-1&&E){const we=I.testLoop(u,f,s);for(let _e=0;_e<i.length;++_e){const ze=i[_e],it=we[_e];Zs(it),Z["val_"+ze]=it}}}),yield O.onBatchEnd(oe,ye),dhe(ye),I.stopTraining_)break}Q.dispose()}if(yield O.onEpochEnd(V,Z),I.stopTraining_)break}return yield O.onTrainEnd(),yield I.history.syncData(),I.history})()}fitDataset(e,r){var i=this;return(0,q.Z)(function*(){return function TWe(n,t,e){return IK.apply(this,arguments)}(i,e,r)})()}trainOnBatch(e,r){var i=this;return(0,q.Z)(function*(){const s=yield i.standardizeUserData(e,r),o=s[0],l=s[1],u=i.makeTrainFunction()(o.concat(l)),f=[];for(const m of u){const _=yield m.data();f.push(_[0])}return Qn(u),ud(s[0],e),ud(s[1],r),Ja(f)})()}getNamedWeights(e){const r=[],i=null!=e&&e.trainableOnly,s=i?this.trainableWeights:this.weights,o=this.getWeights(i);for(let l=0;l<s.length;++l)i&&!s[l].trainable||r.push({name:s[l].originalName,tensor:o[l]});return r}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const r=o8().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=r-o8().numTensors}return e}getLossIdentifiers(){let e;if("string"==typeof this.loss)e=xp(this.loss);else if(Array.isArray(this.loss)){for(const r of this.loss)if("string"!=typeof r)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(r=>xp(r))}else{const r=Object.keys(this.loss);e={};const i=this.loss;for(const s of r){if("string"!=typeof i[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=xp(i[s])}}return e}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[xp(g3(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>xp(g3(e)));{const e={};for(const r in this.metrics)e[r]=xp(g3(this.metrics[r]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const i=Ip(bK(e.optimizer_config));let s,o;if("string"==typeof e.loss)s=s0(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(l=>s0(l));else if(null!=e.loss){s={};for(const l in e.loss)s[l]=s0(e.loss[l])}if(Array.isArray(e.metrics))o=e.metrics.map(l=>s0(l));else if(null!=e.metrics){o={};for(const l in e.metrics)o[l]=s0(e.metrics[l])}this.compile({loss:s,metrics:o,optimizer:i})}save(e,r){var i=this;return(0,q.Z)(function*(){if("string"==typeof e){const m=hce(e);if(0===m.length)throw new pe(`Cannot find any save handlers for URL '${e}'`);if(m.length>1)throw new pe(`Found more than one (${m.length}) save handlers for URL '${e}'`);e=m[0]}if(null==e.save)throw new pe("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=yield a8(i.getNamedWeights(r)),u={modelTopology:i.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v4.22.0",convertedBy:null};if(null!=r&&r.includeOptimizer&&null!=i.optimizer){u.trainingConfig=i.getTrainingConfig();const m="optimizer",{data:_,specs:y}=yield a8(yield i.optimizer.getWeights(),m);s.specs.push(...y),s.data=lce([s.data,_])}return null!=i.userDefinedMetadata&&(whe(i.userDefinedMetadata,i.name,!0),u.userDefinedMetadata=i.userDefinedMetadata),u.weightData=s.data,u.weightSpecs=s.specs,e.save(u)})()}setUserDefinedMetadata(e){whe(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}return n.className="Model",n})();pt(IT),pt((()=>{class n extends IT{}return n.className="Functional",n})()),pt((()=>{class n extends IT{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:JV("sequential_"),null!=e.layers)for(const r of e.layers)this.add(r)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(i=>i<0))throw new pe(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const r=e instanceof n||e instanceof IT;let i;if(r){if(i=e,1!==i.outputs.length)throw new pe("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==i.inputs.length)throw new pe("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new pe("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=function P6e(n){if(null==n.batchShape&&null==n.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=n.batchShape&&null!=n.shape)throw new pe("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=n.batchShape;null!=n.shape&&null==t&&(t=[null].concat(n.shape));let e=n.dtype;return null==e&&(e="float32"),new a3({batchInputShape:t,name:n.name,dtype:e,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(r)this.outputs=i.outputs,this.inputs=i.inputs;else{if(1!==e.inboundNodes.length)throw new pe(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(1!==e.inboundNodes[0].outputTensors.length)throw new pe("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=ahe(this.outputs[0])}this.inboundNodes=[],new o3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:r0(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,r){return null==this.model&&this.build(),this.model.call(e,r)}build(e){if(Tr(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new IT({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,r,i=console.log){this.built||this.build(),super.summary(e,r,i)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,r,i={}){if(!this.built)throw new du("The model needs to be compiled before being used.");return this.model.evaluate(e,r,i)}evaluateDataset(e,r){var i=this;return(0,q.Z)(function*(){if(!i.built)throw new du("The model needs to be compiled before being used.");return i.model.evaluateDataset(e,r)})()}predict(e,r={}){return null==this.model&&this.build(),this.model.predict(e,r)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}fit(e,r,i={}){var s=this;return(0,q.Z)(function*(){if(!s.built)throw new du("The model needs to be compiled before being used.");return s.model.fit(e,r,i)})()}fitDataset(e,r){var i=this;return(0,q.Z)(function*(){if(!i.built)throw new du("The model needs to be compiled before being used.");return i.model.fitDataset(e,r)})()}trainOnBatch(e,r){var i=this;return(0,q.Z)(function*(){return i.model.trainOnBatch(e,r)})()}static fromConfig(e,r,i={},s=!1){let o,l={};if(r instanceof Array){if(null==r[0].className||"Merge"===r[0].className)throw new pe("Legacy serialization format not supported yet.");o=r}else G(null!=r.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=r.layers,delete r.layers,l=r;const c=new e(l);if(!(c instanceof n))throw new zn(`Sequential.fromConfig called on non-Sequential input: ${c}`);for(const u of o){const m=Ip(u,void 0,s);s&&m.setFastWeightInitDuringBuild(!0),c.add(m)}return c}set stopTraining(e){if(null==this.model)throw new pe("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new pe("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const r of this.layers){const i={};i.className=r.getClassName(),i.config=r.getConfig(),e.push(i)}return{name:this.name,layers:e}}}return n.className="Sequential",n})());class Jo extends lT{getConfig(){return{}}}pt((()=>{class n extends Jo{apply(e,r=1){return function w6e(n,t=1){if(1!==t)throw new zn(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return ZN(n)}(e,r)}}return n.className="elu",n})()),pt((()=>{class n extends Jo{apply(e){return uY(e)}}return n.className="selu",n})()),pt((()=>{class n extends Jo{apply(e){return wh(e)}}return n.className="relu",n})()),pt((()=>{class n extends Jo{apply(e){return Ie(()=>Jb(6,wh(e)))}}return n.className="relu6",n})()),pt((()=>{class n extends Jo{apply(e){return e}}return n.className="linear",n})()),pt((()=>{class n extends Jo{apply(e){return vh(e)}}return n.className="sigmoid",n})()),pt((()=>{class n extends Jo{apply(e){return function x6e(n){return Ie(()=>{const t=dt(.5,ue(.2,n));return kl(t,0,1)})}(e)}}return n.className="hardSigmoid",n})()),pt((()=>{class n extends Jo{apply(e){return mT(e)}}return n.className="softplus",n})()),pt((()=>{class n extends Jo{apply(e){return function C6e(n){return Ie(()=>ln(n,dt(ks(n),1)))}(e)}}return n.className="softsign",n})()),pt((()=>{class n extends Jo{apply(e){return Qb(e)}}return n.className="tanh",n})());let Mhe=(()=>{class n extends Jo{apply(e,r=-1){return UV(e,r)}}return n.className="softmax",n})();function C_(n){return n.getClassName()}function MK(n,t={}){return aR(n,su.getMap().classNameMap,t,"activation")}function x_(n){if(null==n){return MK({className:"linear",config:{}})}if("string"==typeof n){const t={};return t.className=n,t.config={},MK(t)}return n instanceof Jo?n:MK(n)}pt(Mhe),pt((()=>{class n extends Jo{apply(e,r=-1){return eY(e,r)}}return n.className="logSoftmax",n})()),pt((()=>{class n extends Jo{apply(e){return Ie(()=>Ie(()=>{const r=Math.sqrt(2),i=ue(.5,dt(1,Q8(ln(e,r))));return ue(e,i)}))}}return n.className="gelu",n})()),pt((()=>{class n extends Jo{apply(e){return Ie(()=>ue(.5,ue(e,dt(1,Qb(ue(bo(ln(2,Math.PI)),dt(e,ue(.044715,gp(e,3)))))))))}}return n.className="gelu_new",n})()),pt((()=>{class n extends Jo{apply(e){return Ie(()=>ue(e,Qb(mT(e))))}}return n.className="mish",n})()),pt((()=>{class n extends Jo{apply(e,r=1){return Ie(()=>ue(vh(ue(e,r)),e))}}return n.className="swish",n})());class Ohe extends lT{}let FK=(()=>{class n extends Ohe{constructor(e){super(),function OK(n){if(null!=n&&"object"!=typeof n)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return Ie(()=>{let r=Ns([1]);return this.hasL1&&(r=dt(r,tn(ue(this.l1,ks(e))))),this.hasL2&&(r=dt(r,tn(ue(this.l2,uR(e))))),fe(r,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,r){return new e({l1:r.l1,l2:r.l2})}}return n.className="L1L2",n})();pt(FK);const Fhe={l1l2:"L1L2"};function Jr(n){return iK(n)}function Phe(n,t={}){return aR(n,su.getMap().classNameMap,t,"regularizer")}function Di(n){return null==n?null:"string"==typeof n?Phe({className:n in Fhe?Fhe[n]:n,config:{}}):n instanceof Ohe?n:Phe(n)}function TT(n,t,e){if("number"==typeof n)return r0(n,t);if(n.length!==t)throw new pe(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${n.length} elements.`);for(let r=0;r<t;++r){const i=n[r];if(!m6e(i))throw new pe(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(n)} including a non-integer number ${i}`)}return n}function dd(n,t,e,r,i=1){if(null==n)return n;let o;return o="same"===e?n:n-(t+(t-1)*(i-1))+1,Math.floor((o+r-1)/r)}function Dh(n,t,e,r){if(null==n)return null;if("valid"===r)n=n*t+v_([e-t,0]);else{if("same"!==r)throw new pe(`Unsupport padding mode: ${r}.`);n*=t}return n}function PK(n,t){return Ie(()=>(ss(t),"channelsFirst"===t?yr(n,[0,2,3,1]):n))}function Lhe(n,t){return Ie(()=>(ss(t),"channelsFirst"===t?yr(n,[0,2,3,4,1]):n))}function LK(n,t,e,r=[1,1],i="valid",s,o,l=null){return Ie(()=>{if(null==s&&(s="channelsLast"),ss(s),3!==n.rank&&4!==n.rank)throw new pe(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(3!==t.rank&&4!==t.rank)throw new pe(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let c=PK(n,s);if("causal"===i)throw new zn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=Wue({x:c,filter:t,strides:r,pad:"same"===i?"same":"valid",dilations:o,dataFormat:"NHWC",bias:e,activation:l}),"channelsFirst"===s&&(c=yr(c,[0,3,1,2])),c})}pt((()=>{class n extends Xn{constructor(e){super(e??{}),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,r){e=En(e);let i=wh(e);return null!=this.maxValue&&(i=kl(i,0,this.maxValue)),i}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ReLU",n})()),pt((()=>{class n extends Xn{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=e.alpha??this.DEFAULT_ALPHA}call(e,r){const i=En(e);return kV(i,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return n.className="LeakyReLU",n})()),pt((()=>{class n extends Xn{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Ei(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Di(e.alphaRegularizer),this.alphaConstraint=Fs(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new pe(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`);this.sharedAxes=[e.sharedAxes]}}build(e){const r=(e=Tr(e)).slice(1);if(null!=this.sharedAxes)for(const s of this.sharedAxes)r[s-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const i={};if(null!=this.sharedAxes)for(let s=1;s<e.length;++s)i[s]=e[s];this.inputSpec=[new Ms({ndim:e.length,axes:i})],this.built=!0}call(e,r){return e=En(e),LV(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Li(this.alphaInitializer),alphaRegularizer:Jr(this.alphaRegularizer),alphaConstraint:Os(this.alphaConstraint),sharedAxes:this.sharedAxes},r=super.getConfig();return Object.assign(e,r),e}}return n.className="PReLU",n})()),pt((()=>{class n extends Xn{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new zn(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha??this.DEFAULT_ALPHA}call(e,r){const i=En(e);return ZN(i)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ELU",n})()),pt((()=>{class n extends Xn{constructor(e){super(e??{}),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=e.theta??this.DEFAULT_THETA}call(e,r){const i=En(e);return ue(i,Pt(Nl(i,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ThresholdedReLU",n})()),pt((()=>{class n extends Xn{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new Mhe).apply,this.axis=e.axis??this.DEFAULT_AXIS}call(e,r){return Ie(()=>{let i=En(e);const s=r.mask;if(null!=s){const o=ue(Kt(Rl(i.shape),Pt(s,i.dtype)),gn(-1e9));i=dt(i,o)}return this.axis instanceof Array?this.axis.length>1?Al(Kt(i,NV(i,this.axis,!0))):this.softmax(i,this.axis[0]):this.softmax(i,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Softmax",n})());class y3 extends Xn{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",y3.verifyArgs(e),this.rank=t,Qs(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new zn(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=TT(e.kernelSize,t,"kernelSize"),this.strides=TT(e.strides??1,t,"strides"),this.padding=e.padding??"valid",_c(this.padding),this.dataFormat=e.dataFormat??"channelsLast",ss(this.dataFormat),this.activation=x_(e.activation),this.useBias=e.useBias??!0,this.biasInitializer=Ei(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Fs(e.biasConstraint),this.biasRegularizer=Di(e.biasRegularizer),this.activityRegularizer=Di(e.activityRegularizer),this.dilationRate=TT(e.dilationRate??1,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new pe(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new pe(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new pe(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(t){if(gc("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!oK(t.kernelSize,"number",1,3))throw new pe(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:C_(this.activation),useBias:this.useBias,biasInitializer:Li(this.biasInitializer),biasRegularizer:Jr(this.biasRegularizer),activityRegularizer:Jr(this.activityRegularizer),biasConstraint:Os(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class ST extends y3{constructor(t,e){super(t,e),this.kernel=null,ST.verifyArgs(e),this.filters=e.filters,Qs(this.filters,"filters"),this.kernelInitializer=Ei(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Fs(e.kernelConstraint),this.kernelRegularizer=Di(e.kernelRegularizer)}build(t){t=Tr(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new pe(`The channel dimension of the input should be defined. Found ${t[e]}`);const r=t[e],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:r}}],this.built=!0}call(t,e){return Ie(()=>{let r;t=En(t);const i=null==this.bias?null:this.bias.read(),s=Vde(this.activation.getClassName());if(null!=s&&2===this.rank)r=LK(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(1===this.rank)r=function $he(n,t,e,r=1,i="valid",s,o=1){return Ie(()=>{if(null==s&&(s="channelsLast"),ss(s),3!==n.shape.length)throw new pe(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(3!==t.shape.length)throw new pe(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(null!=e&&1!==e.shape.length)throw new pe(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if("channelsFirst"===s&&(n=yr(n,[0,2,1])),"causal"===i)throw new zn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let l=W8(n,t,r,"same"===i?"same":"valid","NWC",o);return null!=e&&(l=ld(l,e)),l})}(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)r=LK(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new zn("convolutions greater than 3D are not implemented yet.");r=function Bhe(n,t,e,r=[1,1,1],i="valid",s,o){return Ie(()=>{if(null==s&&(s="channelsLast"),ss(s),4!==n.rank&&5!==n.rank)throw new pe(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(4!==t.rank&&5!==t.rank)throw new pe(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let l=Lhe(n,s);if("causal"===i)throw new zn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return l=hue(l,t,r,"same"===i?"same":"valid","NDHWC",o),null!=e&&(l=ld(l,e)),"channelsFirst"===s&&(l=yr(l,[0,4,1,2,3])),l})}(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=Tr(t);const e=[],r="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<r.length;++s){const o=dd(r[s],this.kernelSize[s],this.padding,this.strides[s],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[s]);e.push(o)}let i=[t[0]];return"channelsLast"===this.dataFormat?(i=i.concat(e),i.push(this.filters)):(i.push(this.filters),i=i.concat(e)),i}getConfig(){const t={filters:this.filters,kernelInitializer:Li(this.kernelInitializer),kernelRegularizer:Jr(this.kernelRegularizer),kernelConstraint:Os(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new pe(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}let Vhe=(()=>{class n extends ST{constructor(e){super(2,e),n.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!oK(e.kernelSize,"number",1,2))throw new pe(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv2D",n})();pt(Vhe);let Uhe=(()=>{class n extends ST{constructor(e){super(3,e),n.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new pe(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv3D",n})();pt(Uhe),pt((()=>{class n extends Vhe{constructor(e){if(super(e),this.inputSpec=[new Ms({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new pe(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(4!==(e=Tr(e)).length)throw new pe("Input should have rank 4; Received input shape: "+JSON.stringify(e));const r="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[r])throw new pe("The channel dimension of the inputs should be defined. Found `None`.");const i=e[r],s=this.kernelSize.concat([this.filters,i]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ms({ndim:4,axes:{[r]:i}})],this.built=!0}call(e,r){return Ie(()=>{let i=En(e);if(4!==i.shape.length)throw new pe(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${i.shape.length}`);const s=i.shape;let l,c;"channelsFirst"===this.dataFormat?(l=2,c=3):(l=1,c=2);const f=s[c],_=this.kernelSize[1],w=this.strides[1],E=[s[0],Dh(s[l],this.strides[0],this.kernelSize[0],this.padding),Dh(f,w,_,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(i=yr(i,[0,2,3,1]));let A=q8(i,this.kernel.read(),E,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(A=yr(A,[0,3,1,2])),null!=this.bias&&(A=ld(A,this.bias.read(),this.dataFormat)),null!=this.activation&&(A=this.activation.apply(A)),A})}computeOutputShape(e){const r=(e=Tr(e)).slice();let i,s,o;"channelsFirst"===this.dataFormat?(i=1,s=2,o=3):(i=3,s=1,o=2);const l=this.kernelSize[0],c=this.kernelSize[1],u=this.strides[0],f=this.strides[1];return r[i]=this.filters,r[s]=Dh(r[s],u,l,this.padding),r[o]=Dh(r[o],f,c,this.padding),r}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}return n.className="Conv2DTranspose",n})()),pt((()=>{class n extends Uhe{constructor(e){if(super(e),this.inputSpec=[new Ms({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new pe(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(5!==(e=Tr(e)).length)throw new pe("Input should have rank 5; Received input shape: "+JSON.stringify(e));const r="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[r])throw new pe("The channel dimension of the inputs should be defined. Found `None`.");const i=e[r],s=this.kernelSize.concat([this.filters,i]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ms({ndim:5,axes:{[r]:i}})],this.built=!0}call(e,r){return Ie(()=>{let i=En(e);if(5!==i.shape.length)throw new pe(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${i.shape.length}`);const s=i.shape;let l,c,u;"channelsFirst"===this.dataFormat?(u=2,l=3,c=4):(u=1,l=2,c=3);const m=s[l],_=s[c],w=this.kernelSize[1],T=this.kernelSize[2],E=this.strides[1],A=this.strides[2],V=[s[0],Dh(s[u],this.strides[0],this.kernelSize[0],this.padding),Dh(m,E,w,this.padding),Dh(_,A,T,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(i=yr(i,[0,2,3,4,1]));let Z=pue(i,this.kernel.read(),V,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(Z=yr(Z,[0,4,1,2,3])),null!==this.bias&&(Z=ld(Z,this.bias.read(),this.dataFormat)),null!==this.activation&&(Z=this.activation.apply(Z)),Z})}computeOutputShape(e){const r=(e=Tr(e)).slice();let i,s,o,l;"channelsFirst"===this.dataFormat?(i=1,s=2,o=3,l=4):(i=4,s=1,o=2,l=3);const c=this.kernelSize[0],u=this.kernelSize[1],f=this.kernelSize[2],m=this.strides[0],_=this.strides[1],y=this.strides[2];return r[i]=this.filters,r[s]=Dh(r[s],m,c,this.padding),r[o]=Dh(r[o],_,u,this.padding),r[l]=Dh(r[l],y,f,this.padding),r}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}return n.className="Conv3DTranspose",n})());let PWe=(()=>{class n extends ST{constructor(e,r){if(super(e,r),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==r.filters)throw new pe("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new pe("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new pe(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(r.padding)}`);this.depthMultiplier=r.depthMultiplier??1,this.depthwiseInitializer=Ei(r.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Di(r.depthwiseRegularizer),this.depthwiseConstraint=Fs(r.depthwiseConstraint),this.pointwiseInitializer=Ei(r.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Di(r.pointwiseRegularizer),this.pointwiseConstraint=Fs(r.pointwiseConstraint)}build(e){if((e=Tr(e)).length<this.rank+2)throw new pe(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const r="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[r]||e[r]<0)throw new pe(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[r])}`);const i=e[r],s=this.kernelSize.concat([i,this.depthMultiplier]),o=[];for(let c=0;c<this.rank;++c)o.push(1);o.push(i*this.depthMultiplier,this.filters);const l=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,l,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,l,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,l,this.biasConstraint):null,this.inputSpec=[new Ms({ndim:this.rank+2,axes:{[r]:i}})],this.built=!0}call(e,r){return Ie(()=>{let i;if(e=En(e),1===this.rank)throw new zn("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=yr(e,[0,2,3,1])),i=dY(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(i=ld(i,this.bias.read(),this.dataFormat)),null!=this.activation&&(i=this.activation.apply(i)),"channelsFirst"===this.dataFormat&&(i=yr(i,[0,3,1,2])),i})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Li(this.depthwiseInitializer),e.pointwiseInitializer=Li(this.pointwiseInitializer),e.depthwiseRegularizer=Jr(this.depthwiseRegularizer),e.pointwiseRegularizer=Jr(this.pointwiseRegularizer),e.depthwiseConstraint=Os(this.depthwiseConstraint),e.pointwiseConstraint=Os(this.pointwiseConstraint),e}}return n.className="SeparableConv",n})();function zhe(n,t,e,r){if(Array.isArray(n)){if(null!=t||null!=e)throw new pe("When inputs is an array, neither initialState or constants should be provided");null!=r&&(e=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r)),n.length>1&&(t=n.slice(1,n.length)),n=n[0]}function i(s){return null==s||Array.isArray(s)?s:[s]}return{inputs:n,initialState:t=i(t),constants:e=i(e)}}function Hhe(n,t,e,r=!1,i,s,o=!1,l=!1){return Ie(()=>{const c=t.shape.length;if(c<3)throw new pe(`Input should be at least 3D, but is ${c}D.`);const u=[1,0].concat(od(2,c));if(t=yr(t,u),null!=s)throw new zn("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=Pt(Pt(i,"bool"),"float32")).rank===c-1&&(i=wa(i,-1)),i=yr(i,u)),r&&(t=mc(t,0),null!=i&&(i=mc(i,0)));const f=[];let m,_=e;const y=t.shape[0],w=cu(t);let T,I;null!=i&&(T=cu(i));for(let E=0;E<y;++E){const A=w[E],M=Ie(()=>n(A,_));if(null==i)m=M[0],_=M[1];else{const O=Ie(()=>{const $=T[E],V=Kt(pc($),$);return{output:dt(ue(M[0],$),ue(_[0],V)),newStates:_.map((re,oe)=>dt(ue(M[1][oe],$),ue(re,V)))}});m=O.output,_=O.newStates}l&&f.push(m)}return l&&(I=Ol(f,1)),[m,I,_]})}pt((()=>{class n extends PWe{constructor(e){super(2,e)}}return n.className="SeparableConv2D",n})()),pt((()=>{class n extends ST{constructor(e){super(1,e),n.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!oK(e.kernelSize,"number",1,1))throw new pe(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv1D",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.cropping="number"==typeof e.cropping?[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,r){return Ie(()=>{if(e=En(e),"channelsLast"===this.dataFormat){const i=t3(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return t3(i,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const i=t3(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return t3(i,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Cropping2D",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size??this.DEFAULT_SIZE,this.dataFormat=e.dataFormat??"channelsLast",ss(this.dataFormat),this.interpolation=e.interpolation??"nearest",function h6e(n){o0(l6e,"InterpolationFormat",n)}(this.interpolation)}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],null==e[2]?null:this.size[0]*e[2],null==e[3]?null:this.size[1]*e[3]]:[e[0],null==e[1]?null:this.size[0]*e[1],null==e[2]?null:this.size[1]*e[2],e[3]]}call(e,r){return Ie(()=>{let i=En(e);const s=i.shape;if("channelsFirst"===this.dataFormat){i=yr(i,[0,2,3,1]);const o=this.size[0]*s[2],l=this.size[1]*s[3],c="nearest"===this.interpolation?sd.resizeNearestNeighbor(i,[o,l]):sd.resizeBilinear(i,[o,l]);return yr(c,[0,3,1,2])}{const o=this.size[0]*s[1],l=this.size[1]*s[2];return"nearest"===this.interpolation?sd.resizeNearestNeighbor(i,[o,l]):sd.resizeBilinear(i,[o,l])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},r=super.getConfig();return Object.assign(e,r),e}}return n.className="UpSampling2D",n})()),pt((()=>{class n extends y3{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier??1,this.depthwiseInitializer=Ei(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Fs(e.depthwiseConstraint),this.depthwiseRegularizer=Di(e.depthwiseRegularizer)}build(e){if((e=Tr(e)).length<4)throw new pe(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const r="channelsFirst"===this.dataFormat?1:3;if(null==e[r]||e[r]<0)throw new pe(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[r]}).`);const i=e[r];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,r){return Ie(()=>{let i=function LWe(n,t,e=[1,1],r="valid",i,s){return Ie(()=>{null==i&&(i="channelsLast"),ss(i);let o=PK(n,i);if(4!==n.rank)throw new pe(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(4!==t.rank)throw new pe(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=qN(o,t,e,"same"===r?"same":"valid","NHWC",s),"channelsFirst"===i&&(o=yr(o,[0,3,1,2])),o})}(e=En(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(i=ld(i,this.bias.read(),this.dataFormat)),null!=this.activation&&(i=this.activation.apply(i)),i})}computeOutputShape(e){e=Tr(e);const i="channelsFirst"===this.dataFormat?e[3]:e[2],s="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=dd("channelsFirst"===this.dataFormat?e[2]:e[1],this.kernelSize[0],this.padding,this.strides[0]),l=dd(i,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],s,o,l]:[e[0],o,l,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Li(this.depthwiseInitializer),e.depthwiseRegularizer=Jr(this.depthwiseRegularizer),e.depthwiseConstraint=Os(this.depthwiseRegularizer),e}}return n.className="DepthwiseConv2D",n})());let gR=(()=>{class n extends Xn{constructor(e){let r;if(super(e),null==e.cell)throw new pe("cell property is missing for the constructor of RNN.");if(r=Array.isArray(e.cell)?new jhe({cells:e.cell}):e.cell,null==r.stateSize)throw new pe("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=r,this.returnSequences=e.returnSequences??!1,this.returnState=e.returnState??!1,this.goBackwards=e.goBackwards??!1,this._stateful=e.stateful??!1,this.unroll=e.unroll??!1,this.supportsMasking=!0,this.inputSpec=[new Ms({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return this.states_??od(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(r=>null)}setStates(e){this.states_=e}computeOutputShape(e){dK(e)&&(e=e[0]);let r=this.cell.stateSize;Array.isArray(r)||(r=[r]);const i=r[0];let s;if(s=this.returnSequences?[e[0],e[1],i]:[e[0],i],this.returnState){const o=[];for(const l of r)o.push([e[0],l]);return[s].concat(o)}return s}computeMask(e,r){return Ie(()=>{Array.isArray(r)&&(r=r[0]);const i=this.returnSequences?r:null;if(this.returnState){const s=this.states.map(o=>null);return[i].concat(s)}return i})}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[];for(let i=0;i<e;++i)r.push(null);return r}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new zn("Constants support is not implemented in RNN yet.");dK(e)&&(e=e[0]);const i=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Ms({shape:[i,null,...s]});const o=[e[0]].concat(e.slice(2));let l;if(this.cell.build(o),l=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!dr(this.stateSpec.map(c=>c.shape[c.shape.length-1]),l))throw new pe(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=l.map(c=>new Ms({shape:[null,c]}));this.stateful&&this.resetStates()}resetStates(e,r=!1){Ie(()=>{if(!this.stateful)throw new xh("Cannot call resetStates() on an RNN Layer that is not stateful.");const i=this.inputSpec[0].shape[0];if(null==i)throw new pe("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>Ns([i,s])):[Ns([i,this.cell.stateSize])];else if(null==e)Qn(this.states_),null!=this.keptStates&&(Qn(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Ns([i,s])):this.states_[0]=Ns([i,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new pe(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);!0===r?this.keptStates.push(this.states_.slice()):Qn(this.states_);for(let s=0;s<this.states_.length;++s){const o=e[s],l=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,c=[i,l];if(!dr(o.shape,c))throw new pe(`State ${s} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${o.shape}`);this.states_[s]=o}}this.states_=this.states_.map(s=>Zs(s.clone()))})}apply(e,r){let i=null==r?null:r.initialState,s=null==r?null:r.constants;null==r&&(r={});const o=zhe(e,i,s,this.numConstants);e=o.inputs,i=o.initialState,s=o.constants;let l=[],c=[];if(null!=i){r.initialState=i,l=l.concat(i),this.stateSpec=[];for(const f of i)this.stateSpec.push(new Ms({shape:f.shape}));c=c.concat(this.stateSpec)}if(null!=s&&(r.constants=s,l=l.concat(s),this.numConstants=s.length),l[0]instanceof Eh){const f=[e].concat(l),m=this.inputSpec.concat(c),_=this.inputSpec;this.inputSpec=m;const y=super.apply(f,r);return this.inputSpec=_,y}return super.apply(e,r)}call(e,r){return Ie(()=>{const i=null==r?null:r.mask,s=null==r?null:r.training;let o=null==r?null:r.initialState;e=En(e),null==o&&(o=this.stateful?this.states_:this.getInitialState(e));const l=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==l)throw new pe(`RNN Layer has ${l} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const c={training:s},f=Hhe((T,I)=>{const E=this.cell.call([T].concat(I),c);return[E[0],E.slice(1)]},e,o,this.goBackwards,i,null,this.unroll,this.returnSequences),m=f[0],_=f[1],y=f[2];this.stateful&&this.resetStates(y,s);const w=this.returnSequences?_:m;return this.returnState?[w].concat(y):w})}getInitialState(e){return Ie(()=>{let r=Ns(e.shape);return r=tn(r,[1,2]),r=cR(r),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(i=>i>1?cK(r,[1,i]):r):this.cell.stateSize>1?[cK(r,[1,this.cell.stateSize])]:[r]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(r.numConstants=this.numConstants);const i=this.cell.getConfig();return this.getClassName()===n.className&&(r.cell={className:this.cell.getClassName(),config:i}),Object.assign(Object.assign(Object.assign({},i),e),r)}static fromConfig(e,r,i={}){const o=Ip(r.cell,i);return new e(Object.assign(r,{cell:o}))}}return n.className="RNN",n})();pt(gR);class v3 extends Xn{}let Ghe=(()=>{class n extends v3{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Qs(this.units,"units"),this.activation=x_(e.activation??this.DEFAULT_ACTIVATION),this.useBias=e.useBias??!0,this.kernelInitializer=Ei(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ei(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ei(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Di(e.kernelRegularizer),this.recurrentRegularizer=Di(e.recurrentRegularizer),this.biasRegularizer=Di(e.biasRegularizer),this.kernelConstraint=Fs(e.kernelConstraint),this.recurrentConstraint=Fs(e.recurrentConstraint),this.biasConstraint=Fs(e.biasConstraint),this.dropout=CT([1,v_([0,e.dropout??0])]),this.recurrentDropout=CT([1,v_([0,e.recurrentDropout??0])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Tr(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,r){return Ie(()=>{if(2!==e.length)throw new pe(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let i=e[1];e=e[0];const s=r.training??!1;let o;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=I_({ones:()=>pc(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=I_({ones:()=>pc(i),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=this.recurrentDropoutMask;o=Th(null!=l?ue(e,l):e,this.kernel.read()),null!=this.bias&&(o=ld(o,this.bias.read())),null!=c&&(i=ue(i,c));let u=dt(o,Th(i,this.recurrentKernel.read()));return null!=this.activation&&(u=this.activation.apply(u)),[u,u]})}getConfig(){const e=super.getConfig(),r={units:this.units,activation:C_(this.activation),useBias:this.useBias,kernelInitializer:Li(this.kernelInitializer),recurrentInitializer:Li(this.recurrentInitializer),biasInitializer:Li(this.biasInitializer),kernelRegularizer:Jr(this.kernelRegularizer),recurrentRegularizer:Jr(this.recurrentRegularizer),biasRegularizer:Jr(this.biasRegularizer),activityRegularizer:Jr(this.activityRegularizer),kernelConstraint:Os(this.kernelConstraint),recurrentConstraint:Os(this.recurrentConstraint),biasConstraint:Os(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),r)}}return n.className="SimpleRNNCell",n})();pt(Ghe),pt((()=>{class n extends gR{constructor(e){e.cell=new Ghe(e),super(e)}call(e,r){return Ie(()=>(null!=this.cell.dropoutMask&&(Qn(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Qn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==r?null:r.mask,training:null==r?null:r.training,initialState:null==r?null:r.initialState})))}static fromConfig(e,r){return new e(r)}}return n.className="SimpleRNN",n})());let Whe=(()=>{class n extends v3{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new pe("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Qs(this.units,"units"),this.activation=x_(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=x_(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias??!0,this.kernelInitializer=Ei(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ei(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ei(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Di(e.kernelRegularizer),this.recurrentRegularizer=Di(e.recurrentRegularizer),this.biasRegularizer=Di(e.biasRegularizer),this.kernelConstraint=Fs(e.kernelConstraint),this.recurrentConstraint=Fs(e.recurrentConstraint),this.biasConstraint=Fs(e.biasConstraint),this.dropout=CT([1,v_([0,e.dropout??0])]),this.recurrentDropout=CT([1,v_([0,e.recurrentDropout??0])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Tr(e),this.kernel=this.addWeight("kernel",[e[e.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,r){return Ie(()=>{if(2!==e.length)throw new pe(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const i=r.training??!1;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=I_({ones:()=>pc(e),rate:this.dropout,training:i,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=I_({ones:()=>pc(s),rate:this.recurrentDropout,training:i,count:3,dropoutFunc:this.dropoutFunc}));const l=this.recurrentDropoutMask;let c,u,f;0<this.dropout&&this.dropout<1&&(e=ue(e,this.dropoutMask[0]));let m=Th(e,this.kernel.read());this.useBias&&(m=ld(m,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=ue(s,l[0]));const _=this.recurrentKernel.read(),[y,w]=Ml(_,[2*this.units,this.units],_.rank-1),T=Th(s,y),[I,E,A]=Ml(m,3,m.rank-1),[M,O]=Ml(T,2,T.rank-1);c=this.recurrentActivation.apply(dt(I,M)),u=this.recurrentActivation.apply(dt(E,O));const $=Th(ue(u,s),w);f=this.activation.apply(dt(A,$));const V=dt(ue(c,s),ue(dt(1,pi(c)),f));return[V,V]})}getConfig(){const e=super.getConfig(),r={units:this.units,activation:C_(this.activation),recurrentActivation:C_(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Li(this.kernelInitializer),recurrentInitializer:Li(this.recurrentInitializer),biasInitializer:Li(this.biasInitializer),kernelRegularizer:Jr(this.kernelRegularizer),recurrentRegularizer:Jr(this.recurrentRegularizer),biasRegularizer:Jr(this.biasRegularizer),activityRegularizer:Jr(this.activityRegularizer),kernelConstraint:Os(this.kernelConstraint),recurrentConstraint:Os(this.recurrentConstraint),biasConstraint:Os(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),r)}}return n.className="GRUCell",n})();pt(Whe),pt((()=>{class n extends gR{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Whe(e),super(e)}call(e,r){return Ie(()=>(null!=this.cell.dropoutMask&&(Qn(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Qn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==r?null:r.mask,training:null==r?null:r.training,initialState:null==r?null:r.initialState})))}static fromConfig(e,r){return 0===r.implmentation&&(r.implementation=1),new e(r)}}return n.className="GRU",n})());let $K=(()=>{class n extends v3{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Qs(this.units,"units"),this.activation=x_(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=x_(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias??!0,this.kernelInitializer=Ei(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ei(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ei(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Di(e.kernelRegularizer),this.recurrentRegularizer=Di(e.recurrentRegularizer),this.biasRegularizer=Di(e.biasRegularizer),this.kernelConstraint=Fs(e.kernelConstraint),this.recurrentConstraint=Fs(e.recurrentConstraint),this.biasConstraint=Fs(e.biasConstraint),this.dropout=CT([1,v_([0,e.dropout??0])]),this.recurrentDropout=CT([1,v_([0,e.recurrentDropout??0])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var r;let s;if(e=Tr(e),this.kernel=this.addWeight("kernel",[e[e.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,l=this.units;s=new((r=class extends fu{apply(u,f){const m=o.apply([l]),_=(new Qde).apply([l]),y=o.apply([2*l]);return Zde(Zde(m,_),y)}}).className="CustomInit",r)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,r){return Ie(()=>{const i=r.training??!1;if(3!==e.length)throw new pe(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=I_({ones:()=>pc(e),rate:this.dropout,training:i,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=I_({ones:()=>pc(s),rate:this.recurrentDropout,training:i,count:4,dropoutFunc:this.dropoutFunc}));const c=this.recurrentDropoutMask;let u,f,m,_;0<this.dropout&&this.dropout<1&&(e=ue(e,this.dropoutMask[0]));let y=Th(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=ue(s,c[0])),y=dt(y,Th(s,this.recurrentKernel.read())),this.useBias&&(y=ld(y,this.bias.read()));const[w,T,I,E]=Ml(y,4,y.rank-1);u=this.recurrentActivation.apply(w),f=this.recurrentActivation.apply(T),m=dt(ue(f,o),ue(u,this.activation.apply(I))),_=this.recurrentActivation.apply(E);const A=ue(_,this.activation.apply(m));return[A,A,m]})}getConfig(){const e=super.getConfig(),r={units:this.units,activation:C_(this.activation),recurrentActivation:C_(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Li(this.kernelInitializer),recurrentInitializer:Li(this.recurrentInitializer),biasInitializer:Li(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Jr(this.kernelRegularizer),recurrentRegularizer:Jr(this.recurrentRegularizer),biasRegularizer:Jr(this.biasRegularizer),activityRegularizer:Jr(this.activityRegularizer),kernelConstraint:Os(this.kernelConstraint),recurrentConstraint:Os(this.recurrentConstraint),biasConstraint:Os(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),r)}}return n.className="LSTMCell",n})();pt($K),pt((()=>{class n extends gR{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new $K(e),super(e)}call(e,r){return Ie(()=>(null!=this.cell.dropoutMask&&(Qn(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Qn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==r?null:r.mask,training:null==r?null:r.training,initialState:null==r?null:r.initialState})))}static fromConfig(e,r){return 0===r.implmentation&&(r.implementation=1),new e(r)}}return n.className="LSTM",n})());let jhe=(()=>{class n extends v3{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const r of this.cells.slice().reverse())Array.isArray(r.stateSize)?e.push(...r.stateSize):e.push(r.stateSize);return e}call(e,r){return Ie(()=>{let i=e.slice(1);const s=[];for(const c of this.cells.slice().reverse())Array.isArray(c.stateSize)?s.push(i.splice(0,c.stateSize.length)):s.push(i.splice(0,1));s.reverse();const o=[];let l;for(let c=0;c<this.cells.length;++c){const u=this.cells[c];i=s[c],l=0===c?[e[0]].concat(i):[l[0]].concat(i),l=u.call(l,r),o.push(l.slice(1))}i=[];for(const c of o.slice().reverse())i.push(...c);return[l[0]].concat(i)})}build(e){let r;dK(e)&&(e=e[0]),this.cells.forEach((i,s)=>{a0(`RNNCell_${s}`,()=>{i.build(e),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,e=[e[0],r]})}),this.built=!0}getConfig(){const e=super.getConfig(),s={cells:this.cells.map(o=>({className:o.getClassName(),config:o.getConfig()}))};return Object.assign(Object.assign({},e),s)}static fromConfig(e,r,i={}){const s=[];for(const o of r.cells)s.push(Ip(o,i));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const r of this.cells)e.push(...r.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const r of this.cells)e.push(...r.nonTrainableWeights);if(!this.trainable){const r=[];for(const i of this.cells)r.push(...i.trainableWeights);return r.concat(e)}return e}getWeights(){const e=[];for(const r of this.cells)e.push(...r.weights);return hK(e)}setWeights(e){const r=[];for(const i of this.cells){const o=e.splice(i.weights.length);for(let l=0;l<i.weights.length;++l)r.push([i.weights[l],o[l]])}fK(r)}}return n.className="StackedRNNCells",n})();function I_(n){const{ones:t,rate:e,training:r=!1,count:i=1,dropoutFunc:s}=n,o=()=>null!=s?s(t(),e):Kde(t(),e),l=()=>dR(o,t,r);return!i||i<=1?Zs(l().clone()):Array(i).fill(void 0).map(l).map(u=>Zs(u.clone()))}pt(jhe);let BWe=(()=>{class n extends gR{constructor(e){if(e.unroll)throw new zn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new zn("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Ms({ndim:5})]}call(e,r){return Ie(()=>{if(null!=this.cell.dropoutMask&&(Qn(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Qn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),r&&r.constants)throw new pe("ConvRNN2D cell does not support constants");return super.call(e,{mask:null==r?null:r.mask,training:null==r?null:r.training,initialState:null==r?null:r.initialState})})}computeOutputShape(e){let r=this.computeSingleOutputShape(e);return this.returnSequences||(r=[r[0],...r.slice(2)]),this.returnState&&(r=[r,...Array(2).fill([e[0],...r.slice(-3)])]),r}getInitialState(e){return Ie(()=>{const{stateSize:r}=this.cell,s=this.computeSingleOutputShape(e.shape),l=Ns([s[0],...s.slice(2)]);return Array.isArray(r)?Array(r.length).fill(l):[l]})}resetStates(e,r=!1){Ie(()=>{if(!this.stateful)throw new xh("Cannot call resetStates() on an RNN Layer that is not stateful.");const i=this.inputSpec[0].shape,s=this.computeSingleOutputShape(i),o=[s[0],...s.slice(2)];if(null==i[0])throw new pe("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(()=>Ns(o)):[Ns(o)];else if(null==e)Qn(this.states_),null!=this.keptStates&&(Qn(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ns(o)):this.states_[0]=Ns(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new pe(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);r?this.keptStates.push(this.states_.slice()):Qn(this.states_);for(let c=0;c<this.states_.length;++c){const u=e[c],f=o;if(!dr(u.shape,f))throw new pe(`State ${c} is incompatible with layer ${this.name}: expected shape=${f}, received shape=${u.shape}`);this.states_[c]=u}}this.states_=this.states_.map(c=>Zs(c.clone()))})}computeSingleOutputShape(e){const{dataFormat:r,filters:i,kernelSize:s,padding:o,strides:l,dilationRate:c}=this.cell,u="channelsFirst"===r,m=e[u?4:3],_=dd(e[u?3:2],s[0],o,l[0],c[0]),y=dd(m,s[1],o,l[1],c[1]);return[...e.slice(0,2),...u?[i,_,y]:[_,y,i]]}}return n.className="ConvRNN2D",n})(),qhe=(()=>{class n extends $K{constructor(e){const{filters:r,kernelSize:i,strides:s,padding:o,dataFormat:l,dilationRate:c}=e;super(Object.assign(Object.assign({},e),{units:r})),this.filters=r,Qs(this.filters,"filters"),this.kernelSize=TT(i,2,"kernelSize"),this.kernelSize.forEach(u=>Qs(u,"kernelSize")),this.strides=TT(s||1,2,"strides"),this.strides.forEach(u=>Qs(u,"strides")),this.padding=o||"valid",_c(this.padding),this.dataFormat=l||"channelsLast",ss(this.dataFormat),this.dilationRate=TT(c||1,2,"dilationRate"),this.dilationRate.forEach(u=>Qs(u,"dilationRate"))}build(e){var r;e=Tr(e);const i="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[i])throw new pe(`The channel dimension of the input should be defined. Found ${e[i]}`);const l=this.kernelSize.concat([e[i],4*this.filters]);this.kernel=this.addWeight("kernel",l,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const c=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",c,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let u;if(this.unitForgetBias){const f=this.biasInitializer,m=this.filters;u=new((r=class extends fu{apply(y,w){return lK([f.apply([m]),Rl([m]),f.apply([2*m])])}}).className="CustomInit",r)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,r){return Ie(()=>{if(3!==e.length)throw new pe(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const i=r.training||!1,s=e[0],o=e[1],l=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=I_({ones:()=>pc(s),rate:this.dropout,training:i,count:4,dropoutFunc:this.dropoutFunc}));const u=this.dropoutMask,f=(ht,bt,_t)=>bt&&bt[_t]?ue(bt[_t],ht):ht;let m=f(s,u,0),_=f(s,u,1),y=f(s,u,2),w=f(s,u,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=I_({ones:()=>pc(o),rate:this.recurrentDropout,training:i,count:4,dropoutFunc:this.dropoutFunc}));const T=this.recurrentDropoutMask;let I=f(o,T,0),E=f(o,T,1),A=f(o,T,2),M=f(o,T,3);const[$,V,Z,Q]=Ml(this.kernel.read(),4,3),[re,oe,ye,Ve]=this.useBias?Ml(this.bias.read(),4):[null,null,null,null];m=this.inputConv(m,$,re,this.padding),_=this.inputConv(_,V,oe,this.padding),y=this.inputConv(y,Z,ye,this.padding),w=this.inputConv(w,Q,Ve,this.padding);const[We,Ke,Qe,ge]=Ml(this.recurrentKernel.read(),4,3);I=this.recurrentConv(I,We),E=this.recurrentConv(E,Ke),A=this.recurrentConv(A,Qe),M=this.recurrentConv(M,ge);const we=this.recurrentActivation.apply(dt(m,I)),_e=this.recurrentActivation.apply(dt(_,E)),ze=dt(ue(_e,l),ue(we,this.activation.apply(dt(y,A)))),it=ue(this.recurrentActivation.apply(dt(w,M)),this.activation.apply(ze));return[it,it,ze]})}getConfig(){const i=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e}(super.getConfig(),["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},i),s)}inputConv(e,r,i,s){const o=f_(e,r,this.strides,s||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return i?ld(o,i,this.dataFormat):o}recurrentConv(e,r){return f_(e,r,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}return n.className="ConvLSTM2DCell",n})();pt(qhe),pt((()=>{class n extends BWe{constructor(e){const r=new qhe(e);super(Object.assign(Object.assign({},e),{cell:r}))}static fromConfig(e,r){return new e(r)}}return n.className="ConvLSTM2D",n})());let Zhe=(()=>{class n extends Xn{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const r=e.shape,i=[];for(let s=0;s<this.noiseShape.length;++s)i.push(this.noiseShape[s]??r[s]);return i}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);const i=En(e);if(0<this.rate&&this.rate<1){const s=r.training??!1,o=this.getNoiseShape(i);return dR(()=>Kde(i,this.rate,o,this.seed),()=>i,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=super.getConfig();return Object.assign(e,r),e}dispose(){return super.dispose()}}return n.className="Dropout",n})();pt(Zhe),pt((()=>{class n extends Zhe{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const r=e.shape;return[r[0],1,r[2]]}}return n.className="SpatialDropout1D",n})()),pt((()=>{class n extends Xn{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let r=null;null!=e.batchSize&&(r=e.batchSize),this.batchInputShape=[r,e.inputDim]}this.units=e.units,Qs(this.units,"units"),this.activation=x_(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=Ei(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Ei(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Fs(e.kernelConstraint),this.biasConstraint=Fs(e.biasConstraint),this.kernelRegularizer=Di(e.kernelRegularizer),this.biasRegularizer=Di(e.biasRegularizer),this.activityRegularizer=Di(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const r=(e=Tr(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[r,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:r}}],this.built=!0}computeOutputShape(e){const r=(e=Tr(e)).slice();return r[r.length-1]=this.units,r}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);const i=En(e),s=Vde(this.activation.getClassName());let o;return null!=s?o=Th(i,this.kernel.read(),s,this.bias?this.bias.read():null):(o=Th(i,this.kernel.read()),null!=this.bias&&(o=ld(o,this.bias.read())),null!=this.activation&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:C_(this.activation),useBias:this.useBias,kernelInitializer:Li(this.kernelInitializer),biasInitializer:Li(this.biasInitializer),kernelRegularizer:Jr(this.kernelRegularizer),biasRegularizer:Jr(this.biasRegularizer),activityRegularizer:Jr(this.activityRegularizer),kernelConstraint:Os(this.kernelConstraint),biasConstraint:Os(this.biasConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Dense",n})()),pt((()=>{class n extends Xn{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Tr(e);for(const r of e.slice(1))if(null==r)throw new pe(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],y_(e,1)]}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);let i=En(e);if("channelsFirst"===this.dataFormat&&i.rank>1){const s=[0];for(let o=2;o<i.rank;++o)s.push(o);s.push(1),i=yr(i,s)}return function b6e(n){if(n.rank<=1)throw new pe(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const t=[n.shape[0],y_(n.shape,1)];return fe(n,t)}(i)})}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const r=super.getConfig();return Object.assign(e,r),e}}return n.className="Flatten",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.supportsMasking=!0,this.activation=x_(e.activation)}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);const i=En(e);return this.activation.apply(i)})}getConfig(){const e={activation:C_(this.activation)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Activation",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,r){return Ie(()=>function y6e(n,t){return Ie(()=>{if(2!==n.shape.length)throw new pe(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);return cK(cR(n,1),[1,t,1])})}(e=En(e),this.n))}getConfig(){const e={n:this.n},r=super.getConfig();return Object.assign(e,r),e}}return n.className="RepeatVector",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.targetShape=e.targetShape;for(let r=0;r<this.targetShape.length;++r)this.isUnknown(this.targetShape[r])&&(this.targetShape[r]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,r){const i="Total size of new array must be unchanged.",s=r.slice();let o=1,l=null;for(let u=0;u<s.length;++u){const f=s[u];if(this.isUnknown(f)){if(null!==l)throw new pe("Can only specifiy one unknown dimension.");l=u}else o*=f}const c=y_(e);if(null!==l){if(0===o||c%o!=0)throw new pe(i);s[l]=c/o}else if(c!==o)throw new pe(i);return s}computeOutputShape(e){let r=!1;for(let i=0;i<e.length;++i)if(this.isUnknown(e[i])){r=!0;break}return r?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);const i=En(e),s=i.shape,o=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return fe(i,o)})}getConfig(){const e={targetShape:this.targetShape},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Reshape",n})()),pt((()=>{class n extends Xn{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const r=od(1,e.dims.length+1);if(!dr(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ms({ndim:this.dims.length+1})]}computeOutputShape(e){const r=(e=Tr(e)).slice();return this.dims.forEach((i,s)=>{r[s+1]=e[i]}),r}call(e,r){return yr(En(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Permute",n})()),pt((()=>{class n extends Xn{constructor(e){super(e??{}),this.supportsMasking=!0,this.maskValue=null!=e?e.maskValue??0:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),r={maskValue:this.maskValue};return Object.assign(r,e),r}computeMask(e,r){const i=En(e);return xV(gT(i,this.maskValue),-1)}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);const i=En(e),l=xV(gT(i,this.maskValue),-1,!0);return ue(i,Pt(l,i.dtype))})}}return n.className="Masking",n})()),pt((()=>{class n extends Xn{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let r=null;null!=e.batchSize&&(r=e.batchSize),this.batchInputShape=null==e.inputLength?[r,null]:[r].concat(Mr(e.inputLength))}this.inputDim=e.inputDim,Qs(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Qs(this.outputDim,"outputDim"),this.embeddingsInitializer=Ei(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Di(e.embeddingsRegularizer),this.activityRegularizer=Di(e.activityRegularizer),this.embeddingsConstraint=Fs(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,r){return Ie(()=>this.maskZero?(e=En(e),gT(e,gr(e))):null)}computeOutputShape(e){if(e=Tr(e),null==this.inputLength)return[...e,this.outputDim];const r=Mr(this.inputLength);if(r.length!==e.length-1)throw new pe(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let i=0;for(let s=0;s<r.length;++s){const o=r[s],l=e[s+1];if(null!=o&&null!=l&&o!==l)throw new pe(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);null==o&&(r[i]=l),i++}}return[e[0],...r,this.outputDim]}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);let i=En(e);"int32"!==i.dtype&&(i=Ih(i,"int32"));const s=Yde(this.embeddings.read(),fe(i,[i.size]));return fe(s,Tr(this.computeOutputShape(i.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Li(this.embeddingsInitializer),embeddingsRegularizer:Jr(this.embeddingsRegularizer),activityRegularizer:Jr(this.activityRegularizer),embeddingsConstraint:Os(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Embedding",n})());class c0 extends Xn{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new zn}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const r=t.slice(0,t.length-e.length);for(let i=0;i<e.length;++i){const s=t[t.length-e.length+i],o=e[i];if(null==s||null==o||s<0||o<0)r.push(null);else if(1===s)r.push(o);else if(1===o)r.push(s);else{if(s!==o)throw new pe("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));r.push(s)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Tr(t)]),t.length<2)throw new pe(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const s of t)null!=s&&null!==s[0]&&e.push(s[0]);if(e=__(e),e.length>1)throw new pe(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=null==t[0]?null:t[0].slice(1);for(let s=1;s<t.length;++s){const o=null==t[s]?null:t[s].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const i=t.map(s=>s.length);this.reshapeRequired=-1!==t.indexOf(null)||1!==__(i).length}call(t,e){return Ie(()=>{if(this.reshapeRequired){const r=[],i=t.map(s=>s.rank);if(-1===i.indexOf(null)){const s=v_(i);for(let o of t){const l=o.rank;for(let c=0;c<s-l;++c)o=cR(o,1);r.push(o)}return this.mergeFunction(r)}{let s=!1;for(const c of t){const u=c.rank;if(null==u){const f=c.shape,m=f[0],_=f.slice(1).concat([m]);let y=fe(c,[m].concat(y_(f.slice(1))));y=yr(y,[1,0]),y=fe(y,_),r.push(y),s=!0}else if(u>1){const f=od(1,u).concat([0]);r.push(yr(c,f)),s=!0}else r.push(c)}let o=this.mergeFunction(r);const l=o.rank;if(s)if(null==l){const c=o.shape,f=c[c.length-1],m=[f].concat(c.slice(0,c.length-1));o=fe(yr(fe(o,[-1,f]),[1,0]),m)}else if(l>1){const c=[l-1].concat(od(0,l-1));o=yr(o,c)}return o}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==t[0]?null:t[0].slice(1);for(let i=1;i<t.length;++i){const s=null==t[i]?null:t[i].slice(1);e=this.computeElementwiseOpOutputShape(e,s)}let r=[];for(const i of t)null!=i&&null!==i[0]&&r.push(i[0]);return r=__(r),e=1===r.length?r.concat(e):[null].concat(e),e}computeMask(t,e){return Ie(()=>{if(null==e)return null;if(!Array.isArray(e))throw new pe("`mask` should be an Array");if(!Array.isArray(t))throw new pe("`inputs` should be an Array");if(e.length!==t.length)throw new pe(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(i=>null==i))return null;let r=(e=e.map(i=>null==i?i:wa(i,0)))[0];for(let i=1;i<e.length-1;++i)r=bh(r,e[i]);return r})}}let BK=(()=>{class n extends c0{constructor(e){super(e)}mergeFunction(e){return Ie(()=>{let r=e[0].clone();for(let i=1;i<e.length;++i)r=dt(r,e[i]);return r})}}return n.className="Add",n})();pt(BK);let VK=(()=>{class n extends c0{constructor(e){super(e)}mergeFunction(e){return Ie(()=>{let r=e[0].clone();for(let i=1;i<e.length;++i)r=ue(r,e[i]);return r})}}return n.className="Multiply",n})();pt(VK);let UK=(()=>{class n extends c0{constructor(e){super(e)}mergeFunction(e){return Ie(()=>{let r=e[0].clone();for(let i=1;i<e.length;++i)r=dt(r,e[i]);return ue(1/e.length,r)})}}return n.className="Average",n})();pt(UK);let zK=(()=>{class n extends c0{constructor(e){super(e)}mergeFunction(e){return Ie(()=>{let r=e[0];for(let i=1;i<e.length;++i)r=_p(r,e[i]);return r})}}return n.className="Maximum",n})();pt(zK);let HK=(()=>{class n extends c0{constructor(e){super(e)}mergeFunction(e){return Ie(()=>{let r=e[0];for(let i=1;i<e.length;++i)r=Jb(r,e[i]);return r})}}return n.className="Minimum",n})();pt(HK);let GK=(()=>{class n extends c0{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=e.axis??this.DEFAULT_AXIS,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new pe("A `Concatenate` layer should be called on a list of at least 2 inputs");let r=!0;for(const s of e)if(null!=s){r=!1;break}if(r)return;const i=[];for(let s=0;s<e.length;++s){const o=e[s].slice();o.splice(this.axis,1);let l=!1;for(const c of i)if(dr(c,o)){l=!0;break}l||i.push(o)}if(i.length>1)throw new pe("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Ie(()=>lK(e,this.axis))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new pe("A `Concatenate` layer should be called on a list of inputs.");const r=e,i=r[0].slice(),s=this.axis<0?i.length+this.axis:this.axis;for(const o of r.slice(1)){if(null==i[s]||null==o[s]){i[s]=null;break}i[s]+=o[s]}return i}computeMask(e,r){if(null==r)return null;if(!Array.isArray(r))throw new pe("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new pe("`inputs` should be an array for Concatenate");if(r.length!==e.length)throw new pe(`Mismatch in the length of mask (${r.length}) and the legnth of inputs (${e.length})`);return Ie(()=>{let i=!0;if(r.forEach(l=>{null==l||(i=!1)}),i)return null;const s=[];for(let l=0;l<e.length;++l)s.push(null==r[l]?Pt(pc(e[l]),"bool"):r[l].rank<e[l].rank?wa(r[l],-1):r[l]);const o=ms(s,this.axis);return z8(o,-1,!1)})}getConfig(){const e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Concatenate",n})();function _R(n,t){for(;n<0;)n+=t;return n}function yR(n,t,e,r,i,s=.001){let o;if(2===n.rank)o=rue(n,t,e,r,i,s);else if(3===n.rank)o=iue(n,t,e,r,i,s);else{if(4!==n.rank)throw new zn(`batchNormalization is not implemented for array of rank ${n.rank} yet`);o=sue(n,t,e,r,i,s)}return o}function b3(n,t,e,r,i,s){return Ie(()=>{let o;ss(i),zde(s),_c(r),null==e&&(e=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==s&&(s="max"),n=PK(n,i);const l="same"===r?"same":"valid";return o="max"===s?OV(n,t,e,l):IV(n,t,e,l),"channelsFirst"===i&&(o=yr(o,[0,3,1,2])),o})}function Yhe(n,t,e,r,i,s){return Ie(()=>{let o;ss(i),zde(s),_c(r),null==e&&(e=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==s&&(s="max"),n=Lhe(n,i);const l="same"===r?"same":"valid";return o="max"===s?kue(n,t,e,l):nue(n,t,e,l),"channelsFirst"===i&&(o=yr(o,[0,4,1,2,3])),o})}pt(GK),pt((()=>{class n extends c0{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize??!1,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){G(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const r=e[0],i=e[1];if(r.length>3||i.length>3)throw new zn("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(r,i);if(r[s[0]]!==i[s[1]])throw new pe(`Dimension incompatibility: ${r[s[0]]} !== ${i[s[1]]}`)}mergeFunction(e){if(2!==e.length)throw new pe(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let s,r=e[0],i=e[1];return s=Array.isArray(this.axes)?this.axes.map((o,l)=>_R(o,e[l].shape.length)):[_R(this.axes,r.shape.length),_R(this.axes,i.shape.length)],this.normalize&&(r=u3(r,s[0]),i=u3(i,s[1])),function VWe(n,t,e){if(n.shape.length>3||t.shape.length>3)throw new zn("batchDot is not implemented for tensors of 4D or higher rank yet");if(G(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),G(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),"number"==typeof e&&(e=[e,e]),"complex64"===n.dtype||"complex64"===t.dtype)throw new zn("batchDot is not implemented for complex64-type Tensors yet.");const r=n.shape.length,i=t.shape.length;null==e&&(e=[r-1,i-2]);const s=e;return Ie(()=>{let o,l;if(r>i){o=r-i;const c=[];for(let u=0;u<o;++u)c.push(1);t=fe(t,t.shape.concat(c))}else if(i>r){o=i-r;const c=[];for(let u=0;u<o;++u)c.push(1);n=fe(n,n.shape.concat(c))}else o=0;if(l=2===n.shape.length&&2===t.shape.length?s[0]===s[1]?tn(ue(n,t),s[0]):tn(ue(yr(n,[1,0]),t),s[1]):ir(n,t,s[0]!==n.shape.length-1,s[1]===t.shape.length-1),o>0){let c;c=r>i?r+i-3:r-1;const u=[];for(let f=c;f<c+o;++f)u.push(f);l=t0(l,u)}return 1===l.shape.length&&(l=wa(l,1)),l})}(r,i,s)}interpretAxes(e,r){let i;return i=Array.isArray(this.axes)?this.axes:[_R(this.axes,e.length),_R(this.axes,r.length)],i}computeOutputShape(e){G(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const r=e[0].slice(),i=e[1].slice();if(r.length>3||i.length>3)throw new zn("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(r,i);r.splice(s[0],1),i.splice(s[1],1),i.splice(0,1);const o=r.concat(i);return 1===o.length&&o.push(1),o}computeMask(e,r){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Dot",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),r={stddev:this.stddev};return Object.assign(r,e),r}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);const i=En(e);return dR(()=>dt(n3(i.shape,0,this.stddev),i),()=>i,r.training||!1)})}}return n.className="GaussianNoise",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return Ie(()=>{this.invokeCallHook(e,r);const i=En(e);return this.rate>0&&this.rate<1?dR(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return ue(i,n3(i.shape,1,o))},()=>i,r.training||!1):i})}}return n.className="GaussianDropout",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||En(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return Ie(()=>{if(this.rate<1&&this.rate>0){const i=this._getNoiseShape(e);return dR(()=>{const o=En(e),u=-1.7580993408473766;let f=m_(e0(i),this.rate);f=Ih(f,"float32");const m=((1-this.rate)*(1+this.rate*u**2))**-.5,_=-m*u*this.rate,y=dt(ue(o,f),ue(dt(f,-1),u));return dt(ue(y,m),_)},()=>En(e),r.training||!1)}return e})}}return n.className="AlphaDropout",n})()),pt((()=>{class n extends Xn{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis??-1,this.momentum=e.momentum??.99,this.epsilon=e.epsilon??.001,this.center=e.center??!0,this.scale=e.scale??!0,this.betaInitializer=Ei(e.betaInitializer||"zeros"),this.gammaInitializer=Ei(e.gammaInitializer||"ones"),this.movingMeanInitializer=Ei(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Ei(e.movingVarianceInitializer||"ones"),this.betaConstraint=Fs(e.betaConstraint),this.gammaConstraint=Fs(e.gammaConstraint),this.betaRegularizer=Di(e.betaRegularizer),this.gammaRegularizer=Di(e.gammaRegularizer)}build(e){e=Tr(e);const r=this.axis>=0?this.axis:this.axis+e.length,i=e[r];if(null==i)throw new pe(`Axis ${r} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Ms({ndim:e.length,axes:{[r]:i}})];const s=[i];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,r){return Ie(()=>{const i=r.training??!1,s=En(e),o=s.shape,l=o.length,c=od(0,l),u=this.axis>=0?this.axis:this.axis+l;c.splice(u,1);const f=r0(1,l);f[u]=o[u];const m=c.slice();m.sort();const _=!dr(m,od(0,l).slice(0,l-1));if(!i)return(()=>{if(_){const M=fe(this.movingMean.read(),f),O=fe(this.movingVariance.read(),f),$=this.center?fe(this.beta.read(),f):null,V=this.scale?fe(this.gamma.read(),f):null;return yR(s,M,O,$,V,this.epsilon)}return yR(s,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[w,T,I]=function HWe(n,t,e,r,i=.001){return dr(r.slice().sort(),od(0,n.rank-1))?function UWe(n,t,e,r,i=.001){return Ie(()=>{const s=FV(n,r),o=s.mean,l=s.variance;return[yR(n,o,l,e,t,i),o,l]})}(n,t,e,r,i):function zWe(n,t,e,r,i=.001){return Ie(()=>{const s=FV(n,r),o=s.mean,l=s.variance,c=[];for(const w of od(0,n.rank))-1!==r.indexOf(w)?c.push(1):c.push(n.shape[w]);const u=fe(o,c),f=fe(l,c),m=null==t?null:fe(t,c),_=null==e?null:fe(e,c);return[yR(n,u,f,_,m,i),o,l]})}(n,t,e,r,i)}(s,this.gamma.read(),this.beta.read(),c,this.epsilon),E=(M,O,$)=>{Ie(()=>{const V=1-$,Z=M.read(),Q=ue(Kt(Z,O),V);M.write(Kt(Z,Q))})};return(()=>{E(this.movingMean,T,this.momentum),E(this.movingVariance,I,this.momentum)})(),w})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Li(this.betaInitializer),gammaInitializer:Li(this.gammaInitializer),movingMeanInitializer:Li(this.movingMeanInitializer),movingVarianceInitializer:Li(this.movingVarianceInitializer),betaRegularizer:Jr(this.betaRegularizer),gammaRegularizer:Jr(this.gammaRegularizer),betaConstraint:Os(this.betaConstraint),gammaConstraint:Os(this.gammaConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="BatchNormalization",n})()),pt((()=>{class n extends Xn{constructor(e){if(null==e&&(e={}),super(e),this.axis=e.axis??-1,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(const r of this.axis)if(!Number.isInteger(r))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=e.epsilon??.001,this.center=e.center??!0,this.scale=e.scale??!0,this.betaInitializer=Ei(e.betaInitializer||"zeros"),this.gammaInitializer=Ei(e.gammaInitializer||"ones"),this.betaRegularizer=Di(e.betaRegularizer),this.gammaRegularizer=Di(e.gammaRegularizer),this.supportsMasking=!0}build(e){const r=(e=Tr(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=r);for(const o of this.axis)if(o<0||o>=r)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==__(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const i=this.axis.map(o=>e[o]);this.gamma=this.scale?this.addWeight("gamma",i,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",i,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}call(e,r){const i=En(e),s=i.shape,o=s.length;return Ie(()=>{let{mean:c,variance:u}=FV(i,this.axis,!0);const f=r0(1,o);for(const I of this.axis)f[I]=s[I];const m=I=>null!=I&&I.shape.length!==o?fe(I,f):I;let _=this.scale?m(this.gamma.read()):null,y=this.center?m(this.beta.read()):null;const w=[],T=[];for(let I=0;I<o;++I)-1!==this.axis.indexOf(I)?(w.push(s[I]),T.push(1)):(w.push(1),T.push(s[I]));return c=lu(c,w),u=lu(u,w),null!=_&&(_=lu(_,T)),null!=y&&(y=lu(y,T)),yR(i,c,u,y,_,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Li(this.betaInitializer),gammaInitializer:Li(this.gammaInitializer),betaRegularizer:Jr(this.betaRegularizer),gammaRegularizer:Jr(this.gammaRegularizer)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="LayerNormalization",n})()),pt((()=>{class n extends Xn{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=e.dataFormat??"channelsLast",null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new pe(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let r,i;if("number"==typeof e.padding[0])r=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new pe(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(r=e.padding[0],2!==e.padding[1].length)throw new pe(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);i=e.padding[1]}this.padding=[r,i]}this.inputSpec=[new Ms({ndim:4})]}computeOutputShape(e){let r,i;return e=Tr(e),"channelsFirst"===this.dataFormat?(r=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,i=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],r,i]):(r=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,i=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],r,i,e[3]])}call(e,r){return Ie(()=>function GWe(n,t,e){return Ie(()=>{if(4!==n.rank)throw new pe(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new pe("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==e&&(e="channelsLast"),"channelsLast"!==e&&"channelsFirst"!==e)throw new pe(`Unknown data format: ${e}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return r="channelsFirst"===e?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],g_(n,r)})}(En(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ZeroPadding2D",n})());class Khe extends Xn{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new pe(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);this.poolSize=t.poolSize}if(Qs(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new pe(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);this.strides=t.strides}Qs(this.strides,"strides"),this.padding=t.padding??"valid",_c(this.padding),this.inputSpec=[new Ms({ndim:3})]}computeOutputShape(t){const e=dd((t=Tr(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return Ie(()=>{this.invokeCallHook(t,e),t=cR(En(t),2);const r=this.poolingFunction(En(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return t0(r,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}pt((()=>{class n extends Khe{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return ss(o),_c(s),b3(e,r,i,s,o,"max")}}return n.className="MaxPooling1D",n})()),pt((()=>{class n extends Khe{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return ss(o),_c(s),b3(e,r,i,s,o,"avg")}}return n.className="AveragePooling1D",n})());class Qhe extends Xn{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new pe(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Qs(this.poolSize,"poolSize"),Qs(this.strides,"strides"),this.padding=t.padding??"valid",this.dataFormat=t.dataFormat??"channelsLast",ss(this.dataFormat),_c(this.padding),this.inputSpec=[new Ms({ndim:4})]}computeOutputShape(t){t=Tr(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],r="channelsFirst"===this.dataFormat?t[3]:t[2];return e=dd(e,this.poolSize[0],this.padding,this.strides[0]),r=dd(r,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,r]:[t[0],e,r,t[3]]}call(t,e){return Ie(()=>(this.invokeCallHook(t,e),this.poolingFunction(En(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}pt((()=>{class n extends Qhe{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return ss(o),_c(s),b3(e,r,i,s,o,"max")}}return n.className="MaxPooling2D",n})()),pt((()=>{class n extends Qhe{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return ss(o),_c(s),b3(e,r,i,s,o,"avg")}}return n.className="AveragePooling2D",n})());class Xhe extends Xn{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new pe(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Qs(this.poolSize,"poolSize"),Qs(this.strides,"strides"),this.padding=t.padding??"valid",this.dataFormat=t.dataFormat??"channelsLast",ss(this.dataFormat),_c(this.padding),this.inputSpec=[new Ms({ndim:5})]}computeOutputShape(t){t=Tr(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],r="channelsFirst"===this.dataFormat?t[3]:t[2],i="channelsFirst"===this.dataFormat?t[4]:t[3];return e=dd(e,this.poolSize[0],this.padding,this.strides[0]),r=dd(r,this.poolSize[1],this.padding,this.strides[1]),i=dd(i,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,r,i]:[t[0],e,r,i,t[4]]}call(t,e){return Ie(()=>(this.invokeCallHook(t,e),this.poolingFunction(En(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}pt((()=>{class n extends Xhe{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return ss(o),_c(s),Yhe(e,r,i,s,o,"max")}}return n.className="MaxPooling3D",n})()),pt((()=>{class n extends Xhe{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return ss(o),_c(s),Yhe(e,r,i,s,o,"avg")}}return n.className="AveragePooling3D",n})());class Jhe extends Xn{constructor(t){super(t),this.inputSpec=[new Ms({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new zn}}pt((()=>{class n extends Jhe{constructor(e){super(e||{})}call(e,r){return Ie(()=>{const i=En(e);return Gi(i,1)})}}return n.className="GlobalAveragePooling1D",n})()),pt((()=>{class n extends Jhe{constructor(e){super(e||{})}call(e,r){return Ie(()=>{const i=En(e);return au(i,1)})}}return n.className="GlobalMaxPooling1D",n})());class efe extends Xn{constructor(t){super(t),this.dataFormat=t.dataFormat??"channelsLast",ss(this.dataFormat),this.inputSpec=[new Ms({ndim:4})]}computeOutputShape(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new zn}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}pt((()=>{class n extends efe{call(e,r){return Ie(()=>{const i=En(e);return Gi(i,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}return n.className="GlobalAveragePooling2D",n})()),pt((()=>{class n extends efe{call(e,r){return Ie(()=>{const i=En(e);return au(i,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}return n.className="GlobalMaxPooling2D",n})());class tfe extends Xn{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,r={}){const s=Ip(e.layer,r);delete e.layer;const o={layer:s};return Object.assign(o,e),new t(o)}}pt((()=>{class n extends tfe{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=Tr(e)).length<3)throw new pe(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const r=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),super.build(e)}computeOutputShape(e){const r=[(e=Tr(e))[0]].concat(e.slice(2)),i=this.layer.computeOutputShape(r);return[i[0],e[1]].concat(i.slice(1))}call(e,r){return Ie(()=>Hhe((l,c)=>[En(this.layer.call(l,r)),[]],e=En(e),[],!1,null,null,!1,!0)[1])}}return n.className="TimeDistributed",n})()),pt((()=>{class n extends tfe{constructor(e){super(e);const r=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=r,this.forwardLayer=Ip(i),r.goBackwards=!0!==r.goBackwards;const s={};if(s.className=e.layer.getClassName(),s.config=r,this.backwardLayer=Ip(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function WWe(n){o0(d6e,"BidirectionalMergeMode",n)}(this.mergeMode),e.weights)throw new zn("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const i=Math.floor(e.length/2);this.forwardLayer.setWeights(e.slice(0,i)),this.backwardLayer.setWeights(e.slice(i))}computeOutputShape(e){let i,s,o,r=this.forwardLayer.computeOutputShape(e);return Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),this.returnState&&(o=r.slice(1)),i=r[0],"concat"===this.mergeMode?(i[i.length-1]*=2,s=[i]):s=null==this.mergeMode?[i,i.slice()]:[i],this.returnState?null==this.mergeMode?s.concat(o).concat(o.slice()):[i].concat(o).concat(o.slice()):Ja(s)}apply(e,r){let i=null==r?null:r.initialState,s=null==r?null:r.constants;null==r&&(r={});const o=zhe(e,i,s,this.numConstants);if(e=o.inputs,i=o.initialState,s=o.constants,Array.isArray(e)&&(i=e.slice(1),e=e[0]),(null==i||0===i.length)&&null==s)return super.apply(e,r);const l=[],c=[];if(null!=i){const f=i.length;if(f%2>0)throw new pe("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,l.push(...i);const m=i.map(_=>new Ms({shape:_.shape}));this.forwardLayer.stateSpec=m.slice(0,f/2),this.backwardLayer.stateSpec=m.slice(f/2),c.push(...m)}if(null!=s)throw new zn("Support for constants in Bidirectional layers is not implemented yet.");const u=l[0]instanceof Eh;for(const f of l)if(f instanceof Eh!==u)throw new pe("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){const f=[e].concat(l),m=this.inputSpec.concat(c),_=this.inputSpec;this.inputSpec=m;const y=super.apply(f,r);return this.inputSpec=_,y}return super.apply(e,r)}call(e,r){return Ie(()=>{const i=r.initialState;let s,o,l,c;if(null==i)s=this.forwardLayer.call(e,r),o=this.backwardLayer.call(e,r);else{const u=i.slice(0,i.length/2),f=i.slice(i.length/2);s=this.forwardLayer.call(e,Object.assign(r,{initialState:u})),o=this.backwardLayer.call(e,Object.assign(r,{initialState:f}))}return this.returnState&&(Array.isArray(s)&&(l=s.slice(1).concat(o.slice(1))),s=s[0],o=o[0]),this.returnSequences&&(o=mc(o,1)),"concat"===this.mergeMode?c=lK([s,o]):"sum"===this.mergeMode?c=dt(s,o):"ave"===this.mergeMode?c=ue(.5,dt(s,o)):"mul"===this.mergeMode?c=ue(s,o):null==this.mergeMode&&(c=[s,o]),this.returnState?null==this.mergeMode?c.concat(l):[c].concat(l):c})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){a0(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),a0(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,r){let i;if(Array.isArray(r)&&(r=r[0]),i=this.returnSequences?null==this.mergeMode?[r,r]:r:null==this.mergeMode?[null,null]:null,this.returnState){const o=this.forwardLayer.states.map(l=>null);return Array.isArray(i)?i.concat(o).concat(o):[i].concat(o).concat(o)}return i}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},r=super.getConfig();return Object.assign(e,r),e}static fromConfig(e,r){const i=Ip(r.layer);if(delete r.layer,null!=r.numConstants)throw new zn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=r;return s.layer=i,new e(s)}}return n.className="Bidirectional",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.scale=e.scale,this.offset=e.offset?e.offset:0}getConfig(){const e={scale:this.scale,offset:this.offset},r=super.getConfig();return Object.assign(e,r),e}call(e,r){return Ie(()=>("float32"!==(e=En(e)).dtype&&(e=Ih(e,"float32")),dt(ue(e,this.scale),this.offset)))}}return n.className="Rescaling",n})());const{resizeBilinear:qWe,cropAndResize:ZWe}=sd;pt((()=>{class n extends Xn{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,r,i,s,o,l,c,u){return Ie(()=>{let f,m=!1;const I=[r/l,i/c,(s+r)/l,(o+i)/c],E=[];3===e.rank?(m=!0,f=Ol([e])):f=e;for(let V=0;V<f.shape[0];V++)E.push(I);const A=iu(E,[E.length,4]),M=_T(0,E.length,1,"int32"),$=ZWe(f,A,M,[s,o],"nearest");return Ih(m?En(cu($)):$,u)})}upsize(e,r,i,s){return Ie(()=>Ih(qWe(e,[r,i]),s))}call(e,r){return Ie(()=>{const i=En(e),s=i.dtype,o=i.shape,l=o[o.length-3],c=o[o.length-2];let u=0;l!==this.height&&(u=Math.floor((l-this.height)/2));let f=0;return c!==this.width&&(f=Math.floor((c-this.width)/2),0===f&&(f=1)),u>=0&&f>=0?this.centerCrop(i,u,f,this.height,this.width,l,c,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){const i=(e=Tr(e)).length-2;return e[e.length-3]=this.height,e[i]=this.width,e}}return n.className="CenterCrop",n})()),pt((()=>{class n extends Xn{constructor(e){super(e),this.numTokens=e.numTokens,this.outputMode=e.outputMode?e.outputMode:"multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){return null==(e=Tr(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,r){return Ie(()=>{let i;if("int32"!==(e=En(e)).dtype&&(e=Ih(e,"int32")),typeof r.countWeights<"u"){if("count"!==this.outputMode)throw new pe(`countWeights is not used when outputMode !== count.\n              Received countWeights=${r.countWeights}`);i=En(r.countWeights)}const s=au(e),o=YN(e),l=Nl(this.numTokens,s).bufferSync().get(0),c=m_(o,0).bufferSync().get(0);if(!l||!c)throw new pe(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return function YWe(n,t,e,r){let i=En(n);if("int32"!==i.dtype&&(i=Ih(i,"int32")),"int"===t)return i;const s=i.shape;if(0===i.rank&&(i=wa(i,-1)),"oneHot"===t&&1!==i.shape[i.shape.length-1]&&(i=wa(i,-1)),i.rank>2)throw new pe(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${i.rank}.`);const o=["multiHot","oneHot"].includes(t);let c;if(c=K8(i,typeof r<"u"&&"count"===t?r:[],e,o),"tfIdf"!==t)return c;if(r)return ue(c,r);throw new pe("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,i)})}}return n.className="CategoryEncoding",n})());const nfe=new Set(["bilinear","nearest"]);pt((()=>{class n extends Xn{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!nfe.has(e.interpolation))throw new pe(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){return e=Tr(e),[this.height,this.width,e[2]]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},r=super.getConfig();return Object.assign(e,r),e}call(e,r){return Ie(()=>{const i=[this.height,this.width];if("bilinear"===this.interpolation)return sd.resizeBilinear(e,i,!this.cropToAspectRatio);if("nearest"===this.interpolation)return sd.resizeNearestNeighbor(e,i,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...nfe]} are supported`)})}}return n.className="Resizing",n})());let QWe=(()=>{class n{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}return n.className="RandomSeed",n})(),XWe=(()=>{class n extends Xn{constructor(e){super(e),this.randomGenerator=new QWe(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},r=super.getConfig();return Object.assign(e,r),e}}return n.className="BaseRandomLayer",n})();const rfe=new Set(["bilinear","nearest"]);pt((()=>{class n extends XWe{constructor(e){super(e);const{factor:r,interpolation:i="bilinear"}=e;if(this.factor=r,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new pe(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new pe(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new pe(`factor cannot have upper bound less than lower bound.\n        Got upper bound: ${this.widthUpper}.\n        Got lower bound: ${this.widthLower}\n      `);if(i){if(!rfe.has(i))throw new pe(`Invalid interpolation parameter: ${i} is not implemented`);this.interpolation=i}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){return e=Tr(e),[this.imgHeight,-1,e[2]]}call(e,r){return Ie(()=>{const i=En(e);this.imgHeight=i.shape[i.shape.length-3];const s=i.shape[i.shape.length-2];this.widthFactor=e0([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*s;o=Math.round(o);const l=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return sd.resizeBilinear(e,l);case"nearest":return sd.resizeNearestNeighbor(e,l);default:throw new Error(`Interpolation is ${this.interpolation}\n          but only ${[...rfe]} are supported`)}})}}return n.className="RandomWidth",n})()),Me().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var lfe,el=(()=>(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"}(el||(el={})),el))();!function(n){let t;var e;(e=t=n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(lfe||(lfe={}));const WK={};function cfe(n){return WK[n]}function P(n,t,e,r,i){const s=t.inputParams[n];if(s&&void 0!==s.inputIndexStart){const l=s.inputIndexStart,c=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?l+1:s.inputIndexEnd,u=l<0?t.inputNames.length+l:l;if("tensor"===s.type)return xo(t.inputNames[u],e,r,i);if("tensors"===s.type){const _=t.inputs.slice(l,c);return t.inputNames.slice(l,c).filter((w,T)=>{var I;return"NoOp"!==(null===(I=_[T])||void 0===I?void 0:I.op)}).map(w=>xo(w,e,r,i))}const f=xo(t.inputNames[u],e,r,i),m=f.dataSync();return"number"===s.type?m[0]:nu(f.shape,m)}const o=t.attrParams[n];return o&&o.value}function xo(n,t,e,r){const[i,s]=Fl(n,e);if(null!=r){const l=r.getHashTableHandleByName(i);if(null!=l)return l}const o=e.currentContextIds.find(l=>!!t[C3(i,l)]);return void 0!==o?t[C3(i,o)][s]:void 0}function ufe(n,t,e){return t[C3(n,e.currentContextId)]}function Tp(n,t){const[e,r,i]=Fl(n,t);return[C3(e,t&&t.currentContextId),r,i]}function C3(n,t){return t?`${n}-${t}`:n}function Fl(n,t){if(""===n)return["",0,void 0];const e=null!=t&&null!=t.parseNodeNameCache;if(e){const s=t.parseNodeNameCache.get(n);if(null!=s)return s}const r=n.split(":");let i;if(1===r.length)i=[n,0,void 0];else{const o=3===r.length?r[1]:void 0;i=[r[0],Number(r[r.length-1]),o]}return e&&t.parseNodeNameCache.set(n,i),i}function x3(n,t,e){let r=P("pad",n,t,e);if("explicit"===r){r=P("explicitPaddings",n,t,e);const i=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)i[s][0]=r[2*s],i[s][1]=r[2*s+1];return i}return r}function Sp(n){return n.kept?n:pp(n)}const rje=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],ije=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],sje=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],oje=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],aje=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],lje=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],cje=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],uje=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],dje=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],hje=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],fje=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],pje=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],mje=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],gje=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],_je=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],yje=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],vje=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],bje=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],wje=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class dfe{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[Re,tt,Ne,ne,K,ee,X,Ce,Ue,Ae,Dt,$e,Je,Gt,an,nt,Pe,Oe,be].map(r=>r.json));this.opMappers=e.reduce((r,i)=>(r[i.tfOpName]=i,r),{})}transformGraph(t,e={}){const i=[],s=[],o=[],l=t.node.reduce((T,I)=>(T[I.name]=this.mapNode(I),I.op.startsWith("Placeholder")?i.push(T[I.name]):"Const"===I.op?s.push(T[I.name]):(null==I.input||0===I.input.length)&&o.push(T[I.name]),T),{});let c=[];const u=[];let f={},m={};null!=e&&(f=this.mapSignatureEntries(e.inputs),m=this.mapSignatureEntries(e.outputs));const _=Object.keys(l);_.forEach(T=>{const I=l[T];I.inputNames.forEach((E,A)=>{const[M,,O]=Tp(E),$=l[M];if(null!=$.outputs){const V=$.outputs.indexOf(O);-1!==V&&(I.inputNames[A]=`${M}:${V}`)}I.inputs.push($),$.children.push(I)})}),0===Object.keys(m).length?_.forEach(T=>{const I=l[T];0===I.children.length&&u.push(I)}):Object.keys(m).forEach(T=>{const[I]=Tp(T),E=l[I];null!=E&&(E.signatureKey=m[T],u.push(E))}),Object.keys(f).length>0?Object.keys(f).forEach(T=>{const[I]=Tp(T),E=l[I];E&&(E.signatureKey=f[T],c.push(E))}):c=i;let y={};null!=t.library&&null!=t.library.function&&(y=t.library.function.reduce((T,I)=>(T[I.signature.name]=this.mapFunction(I),T),{}));const w={nodes:l,inputs:c,outputs:u,weights:s,placeholders:i,signature:e,functions:y};return o.length>0&&(w.initNodes=o),w}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,r)=>(e[t[r].name]=r,e),{})}mapNode(t){const e=cfe(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const r={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(i=>i.startsWith("^")?i.slice(1):i),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return null!=e.inputs&&(r.inputParams=e.inputs.reduce((i,s)=>(i[s.name]={type:s.type,inputIndexStart:s.start,inputIndexEnd:s.end},i),{})),null!=e.attrs&&(r.attrParams=e.attrs.reduce((i,s)=>{const o=s.type;let l;switch(s.type){case"string":l=jK(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=jK(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"string[]":l=e9(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=e9(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"number":l=ZK(t.attr,s.tfName,s.defaultValue||0),void 0===l&&s.tfDeprecatedName&&(l=ZK(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"number[]":l=JK(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=JK(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool":l=qK(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=qK(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool[]":l=n9(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=n9(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape":l=XK(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=XK(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape[]":l=t9(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=t9(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype":l=KK(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=KK(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype[]":l=QK(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=QK(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"func":l=ffe(t.attr,s.tfName,s.defaultValue),void 0===l&&s.tfDeprecatedName&&(l=ffe(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${s.type} for op: ${t.op}`)}return i[s.name]={value:l,type:o},i},{})),r}mapFunction(t){const e=t.nodeDef,i=[];let s={};null!=e&&(s=e.reduce((m,_)=>(m[_.name]=this.mapNode(_),"Const"===_.op&&i.push(m[_.name]),m),{}));const o=[],l=[];t.signature.inputArg.forEach(m=>{const[_]=Tp(m.name),y={name:_,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:YK(m.type),type:"dtype"}},children:[]};y.signatureKey=m.name,o.push(y),s[_]=y}),Object.keys(s).forEach(m=>{const _=s[m];_.inputNames.forEach((y,w)=>{const[T,,I]=Tp(y),E=s[T];if(null!=E.outputs){const A=E.outputs.indexOf(I);-1!==A&&(_.inputNames[w]=`${T}:${A}`)}_.inputs.push(E),E.children.push(_)})});const u=t.ret;t.signature.outputArg.forEach(m=>{const[_,y]=Tp(u[m.name]),w=s[_];null!=w&&(w.defaultOutput=y,l.push(w))});const f=this.mapArgsToSignature(t);return{nodes:s,inputs:o,outputs:l,weights:i,placeholders:[],signature:f}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((e,r)=>(e[r.name]=this.mapArgToTensorInfo(r),e),{}),outputs:t.signature.outputArg.reduce((e,r)=>(e[r.name]=this.mapArgToTensorInfo(r,t.ret),e),{})}}mapArgToTensorInfo(t,e){let r=t.name;return null!=e&&(r=e[r]),{name:r,dtype:t.type}}}function hfe(n,t){const e=Array.isArray(n)?String.fromCharCode.apply(null,n):function Cje(n){const t=Me().global;if(typeof t.atob<"u")return t.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(n);return t?e:e.toLowerCase()}function jK(n,t,e,r=!1){const i=n[t];return null!=i?hfe(i.s,r):e}function qK(n,t,e){const r=n[t];return r?r.b:e}function ZK(n,t,e){const r=n[t]||{},i=null!=r.i?r.i:null!=r.f?r.f:e;return"number"==typeof i?i:parseInt(i,10)}function YK(n){switch("string"==typeof n&&(n=el[n]),n){case el.DT_FLOAT:case el.DT_HALF:return"float32";case el.DT_INT32:case el.DT_INT64:case el.DT_INT8:case el.DT_UINT8:return"int32";case el.DT_BOOL:return"bool";case el.DT_DOUBLE:return"float32";case el.DT_STRING:return"string";case el.DT_COMPLEX64:case el.DT_COMPLEX128:return"complex64";default:return null}}function ffe(n,t,e){const r=n[t];return r&&r.func?r.func.name:e}function KK(n,t,e){const r=n[t];return r&&r.type?YK(r.type):e}function QK(n,t,e){const r=n[t];return r&&r.list&&r.list.type?r.list.type.map(i=>YK(i)):e}function pfe(n){if(!n.unknownRank)return null!=n.dim?n.dim.map(t=>"number"==typeof t.size?t.size:parseInt(t.size,10)):[]}function XK(n,t,e){const r=n[t];return r&&r.shape?pfe(r.shape):e}function JK(n,t,e){const r=n[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(i=>"number"==typeof i?i:parseInt(i,10)):e}function e9(n,t,e,r=!1){const i=n[t];return i&&i.list&&i.list.s?i.list.s.map(s=>hfe(s,r)):e}function t9(n,t,e){const r=n[t];return r&&r.list&&r.list.shape?r.list.shape.map(i=>pfe(i)):e}function n9(n,t,e){const r=n[t];return r&&r.list&&r.list.b?r.list.b:e}class xje{constructor(t,e,r){this.node=t,this.tensorMap=e,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(i=>this.getInput(i)),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((i,s)=>(i[s]=this.getAttr(s),i),{}))}getInput(t){return xo(t,this.tensorMap,this.context)}getAttr(t,e){const r=this.node.rawAttrs[t];if(null!=r.tensor)return xo(t,this.tensorMap,this.context);if(null!=r.i||null!=r.f)return ZK(this.node.rawAttrs,t,e);if(null!=r.s)return jK(this.node.rawAttrs,t,e);if(null!=r.b)return qK(this.node.rawAttrs,t,e);if(null!=r.shape)return XK(this.node.rawAttrs,t,e);if(null!=r.type)return KK(this.node.rawAttrs,t,e);if(null!=r.list){if(null!=r.list.i||null!=r.list.f)return JK(this.node.rawAttrs,t,e);if(null!=r.list.s)return e9(this.node.rawAttrs,t,e);if(null!=r.list.shape)return t9(this.node.rawAttrs,t,e);if(null!=r.list.b)return n9(this.node.rawAttrs,t,e);if(null!=r.list.type)return QK(this.node.rawAttrs,t,e)}return e}}function pu(n,t,e=""){if("number"!=typeof n&&"number"!=typeof t){G(n.length===t.length,()=>e+` Shapes ${n} and ${t} must match`);for(let r=0;r<n.length;r++){const i=n[r],s=t[r];G(i<0||s<0||i===s,()=>e+` Shapes ${n} and ${t} must match`)}}}function mfe(n){return!("number"==typeof n||n.some(t=>t<0))}function vR(n,t,e){let r=r9(n,e);const i=!mfe(r);if(i&&0===t.length)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&t.forEach(s=>{r=r9(s.shape,r)}),!mfe(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function r9(n,t){if("number"==typeof n)return t;if("number"==typeof t)return n;if(n.length!==t.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${t}`);const e=[];for(let r=0;r<n.length;++r){const i=n[r],s=t[r];if(i>=0&&s>=0&&i!==s)throw new Error(`Incompatible shape during merge: ${n} vs. ${t}`);e[r]=i>=0?i:s}return e}class Sje{constructor(t,e,r,i,s,o,l){this.name=t,this.dtype=e,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=s,this.dynamicSize=o,this.clearAfterRead=l,this.tensors=[],this.closed_=!1,this.idTensor=gn(0),Zs(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{(null==t||!t.has(e.tensor.id))&&e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(e=>this.read(e))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},\n          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0===this.size()&&(null==this.elementShape||0===this.elementShape.length)&&(this.elementShape=e.shape),pu(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);r.tensor=e,Zs(e),r.written=!0,this.tensors[t]=r}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((r,i)=>this.write(r,e[i]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let i=0;i<this.size();i++)t.push(i)}if(0===t.length)return iu([],[0].concat(this.elementShape));const r=this.readMany(t);return pu(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Ol(r,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(0===this.size())return iu([],[0].concat(this.elementShape));const e=[];for(let i=0;i<this.size();i++)e.push(i);const r=this.readMany(e);return pu(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),ms(r,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const r=Math.max(...t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(t,cu(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let r=0;const i=t.map(c=>(r+=c,r));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const s=0===r?0:e.size/r,o=[];Ie(()=>{e=fe(e,[1,r,s]);for(let c=0;c<t.length;++c)o[c]=fe(_r(e,[0,0===c?0:i[c-1],0],[1,t[c],s]),this.elementShape);return o});const l=[];for(let c=0;c<t.length;c++)l[c]=c;this.writeMany(l,o)}}class u0{get id(){return this.idTensor.id}constructor(t,e,r,i=-1){this.tensors=t,this.elementShape=e,this.elementDtype=r,t?.forEach(s=>{if(r!==s.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${s.dtype}`);pu(e,s.shape,"TensorList shape mismatch: "),Zs(s)}),this.idTensor=gn(0),this.maxNumElements=i,Zs(this.idTensor)}copy(){return new u0([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{(null==t||!t.has(e.id))&&e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e,r=-1){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(-1!==r&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);pu(t,this.elementShape,"TensorList shape mismatch: ");const i=vR(this.elementShape,this.tensors,t);return Ie(()=>{const s=this.tensors.map(o=>fe(o,i));return Ol(s,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const r=vR(this.elementShape,this.tensors,t),i=this.tensors.pop();return i.kept=!1,pu(i.shape,t,"TensorList shape mismatch: "),fe(i,r)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(pu(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Zs(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const e=new u0([],this.elementShape,this.elementDtype,this.maxNumElements);e.tensors.length=t;for(let r=0;r<Math.min(this.tensors.length,t);++r)e.tensors[r]=this.tensors[r];return e}getItem(t,e,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[t])throw new Error(`element at index ${t} is null.`);pu(this.tensors[t].shape,e,"TensorList shape mismatch: ");const i=vR(this.elementShape,this.tensors,e);return fe(this.tensors[t],i)}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);pu(this.elementShape,e.shape,"TensorList shape mismatch: "),Zs(e),null!=this.tensors[t]&&(this.tensors[t].kept=!1),this.tensors[t]=e}gather(t,e,r){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);pu(this.elementShape,r,"TensorList shape mismatch: "),t=t.slice(0,this.size());const i=vR(this.elementShape,this.tensors,r);return 0===t.length?iu([],[0].concat(i)):Ie(()=>{const s=t.map(o=>fe(this.tensors[o],i));return Ol(s,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);pu(this.elementShape,e,"TensorList shape mismatch: ");const r=vR(this.elementShape,this.tensors,e);return 0===this.size()?iu([],[0].concat(r)):Ie(()=>{const i=this.tensors.map(s=>fe(s,r));return ms(i,0)})}}const Nje=function(){var n=(0,q.Z)(function*(t,e,r){switch(t.op){case"If":case"StatelessIf":{const i=P("thenBranch",t,e,r),s=P("elseBranch",t,e,r),o=P("cond",t,e,r),l=P("args",t,e,r);return(yield o.data())[0]?r.functionMap[i].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap):r.functionMap[s].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap)}case"While":case"StatelessWhile":{const i=P("body",t,e,r),s=P("cond",t,e,r),o=P("args",t,e,r),l=yield r.functionMap[s].executeFunctionAsync(o,r.tensorArrayMap,r.tensorListMap),c=o.map(m=>m.id);let u=yield l[0].data();l.forEach(m=>{!m.kept&&-1===c.indexOf(m.id)&&m.dispose()});let f=o;for(;u[0];){const m=f;f=yield r.functionMap[i].executeFunctionAsync(f,r.tensorArrayMap,r.tensorListMap);const _=f.map(w=>w.id);m.forEach(w=>{!w.kept&&-1===c.indexOf(w.id)&&-1===_.indexOf(w.id)&&w.dispose()});const y=yield r.functionMap[s].executeFunctionAsync(f,r.tensorArrayMap,r.tensorListMap);u=yield y[0].data(),y.forEach(w=>{!w.kept&&-1===c.indexOf(w.id)&&-1===_.indexOf(w.id)&&w.dispose()})}return f}case"LoopCond":return[Sp(P("pred",t,e,r))];case"Switch":{const i=P("pred",t,e,r);let s=P("data",t,e,r);return s.kept||(s=Sp(s)),(yield i.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const i=t.inputNames.find(s=>void 0!==xo(s,e,r));return i?[Sp(xo(i,e,r))]:void 0}case"Enter":{const i=P("frameName",t,e,r),s=P("tensor",t,e,r);return r.enterFrame(i),[Sp(s)]}case"Exit":{const i=P("tensor",t,e,r);return r.exitFrame(),[Sp(i)]}case"NextIteration":{const i=P("tensor",t,e,r);return r.nextIteration(),[Sp(i)]}case"TensorArrayV3":{const i=P("size",t,e,r),s=P("dtype",t,e,r),o=P("elementShape",t,e,r),l=P("dynamicSize",t,e,r),c=P("clearAfterRead",t,e,r),u=P("identicalElementShapes",t,e,r),f=P("name",t,e,r),m=new Sje(f,s,i,o,u,l,c);return r.addTensorArray(m),[m.idTensor,gn(1)]}case"TensorArrayWriteV3":{const i=P("tensorArrayId",t,e,r),s=P("index",t,e,r),o=P("tensor",t,e,r),l=r.getTensorArray(i.id);return l.write(s,o),[l.idTensor]}case"TensorArrayReadV3":{const i=P("tensorArrayId",t,e,r),s=P("index",t,e,r);return[r.getTensorArray(i.id).read(s)]}case"TensorArrayGatherV3":{const i=P("tensorArrayId",t,e,r),s=P("indices",t,e,r),o=P("dtype",t,e,r);return[r.getTensorArray(i.id).gather(s,o)]}case"TensorArrayScatterV3":{const i=P("tensorArrayId",t,e,r),s=P("indices",t,e,r),o=P("tensor",t,e,r),l=r.getTensorArray(i.id);return l.scatter(s,o),[l.idTensor]}case"TensorArrayConcatV3":{const i=P("tensorArrayId",t,e,r),s=r.getTensorArray(i.id),o=P("dtype",t,e,r);return[s.concat(o)]}case"TensorArraySplitV3":{const i=P("tensorArrayId",t,e,r),s=P("tensor",t,e,r),o=P("lengths",t,e,r),l=r.getTensorArray(i.id);return l.split(o,s),[l.idTensor]}case"TensorArraySizeV3":{const i=P("tensorArrayId",t,e,r);return[gn(r.getTensorArray(i.id).size(),"int32")]}case"TensorArrayCloseV3":{const i=P("tensorArrayId",t,e,r),s=r.getTensorArray(i.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const i=P("tensorListId",t,e,r),s=P("index",t,e,r),o=P("tensor",t,e,r),l=r.getTensorList(i.id);return l.setItem(s,o),[l.idTensor]}case"TensorListGetItem":{const i=P("tensorListId",t,e,r),s=P("index",t,e,r),o=P("elementShape",t,e,r),l=P("elementDType",t,e,r);return[r.getTensorList(i.id).getItem(s,o,l)]}case"TensorListScatterV2":case"TensorListScatter":{const i=P("indices",t,e,r),c=function kje(n,t,e,r){if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const i=Math.max(...t);if(null!=r&&-1!==r&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const s=new u0([],e,n.dtype,r),o=cu(n,0);return t.forEach((l,c)=>{s.setItem(l,o[c])}),s}(P("tensor",t,e,r),i,P("elementShape",t,e,r),P("numElements",t,e,r));return r.addTensorList(c),[c.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const i=P("elementShape",t,e,r),s=P("elementDType",t,e,r);let o;o="TensorListReserve"===t.op?"numElements":"maxNumElements";const l=P(o,t,e,r),u=function Dje(n,t,e,r){return new u0([],n,t,r)}(i,s,0,"TensorListReserve"===t.op?-1:l);return r.addTensorList(u),[u.idTensor]}case"TensorListGather":{const i=P("tensorListId",t,e,r),s=P("indices",t,e,r),o=P("elementShape",t,e,r),l=P("elementDType",t,e,r);return[r.getTensorList(i.id).gather(s,l,o)]}case"TensorListStack":{const i=P("tensorListId",t,e,r),s=P("elementShape",t,e,r),o=P("elementDType",t,e,r),l=P("numElements",t,e,r);return[r.getTensorList(i.id).stack(s,o,l)]}case"TensorListFromTensor":{const l=function Eje(n,t,e){const r=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==e)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${e}`);pu(n.shape.slice(1),t,"TensorList shape mismatch: ");const s=cu(n);return new u0(s,t,r)}(P("tensor",t,e,r),P("elementShape",t,e,r),P("elementDType",t,e,r));return r.addTensorList(l),[l.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const i=P("tensorListId",t,e,r),s=r.getTensorList(i.id),o=P("dtype",t,e,r),l=P("elementShape",t,e,r);return[s.concat(o,l)]}case"TensorListPushBack":{const i=P("tensorListId",t,e,r),s=P("tensor",t,e,r),o=r.getTensorList(i.id);return o.pushBack(s),[o.idTensor]}case"TensorListPopBack":{const i=P("tensorListId",t,e,r),s=P("elementShape",t,e,r),o=P("elementDType",t,e,r);return[r.getTensorList(i.id).popBack(s,o)]}case"TensorListSplit":{const i=P("tensor",t,e,r),s=P("elementShape",t,e,r),l=function Aje(n,t,e){let r=0;const i=t.map(f=>(r+=f,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${n.shape}`);const o=r9(n.shape.slice(1),e),l=0===r?0:n.size/r,c=Ie(()=>{const f=[];n=fe(n,[1,r,l]);for(let m=0;m<t.length;++m)f[m]=fe(_r(n,[0,0===m?0:i[m-1],0],[1,t[m],l]),o);return n.dispose(),f}),u=new u0([],e,n.dtype,t.length);for(let f=0;f<c.length;f++)u.setItem(f,c[f]);return u}(i,P("lengths",t,e,r),s);return r.addTensorList(l),[l.idTensor]}case"TensorListLength":{const i=P("tensorListId",t,e,r);return[gn(r.getTensorList(i.id).size(),"int32")]}case"TensorListResize":{const i=P("tensorListId",t,e,r),s=P("size",t,e,r),l=r.getTensorList(i.id).resize(s);return r.addTensorList(l),[l.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}});return function(e,r,i){return n.apply(this,arguments)}}();function gfe(n,t,e){const[r,i]=P("fusedOps",n,t,e),s="biasadd"===r,o=!s,l="prelu"===i,c="fusedbatchnorm"===r,u=P("numArgs",n,t,e);if(s){if(l&&2!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!l&&s&&1!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const f=P("strides",n,t,e),m=x3(n,t,e),_=P("dataFormat",n,t,e).toUpperCase(),y=P("dilations",n,t,e);let[w,T]=P("args",n,t,e);return o&&(T=w,w=void 0),{stride:f,pad:m,dataFormat:_,dilations:y,biasArg:w,preluArg:T,activationFunc:i,leakyreluAlpha:P("leakyreluAlpha",n,t,e)}}function i9(n,t,e){return{boxes:P("boxes",n,t,e),scores:P("scores",n,t,e),maxOutputSize:P("maxOutputSize",n,t,e),iouThreshold:P("iouThreshold",n,t,e),scoreThreshold:P("scoreThreshold",n,t,e),softNmsSigma:P("softNmsSigma",n,t,e)}}const Oje=function(){var n=(0,q.Z)(function*(t,e,r,i,s=he){switch(t.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:l,maxOutputSize:c,iouThreshold:u,scoreThreshold:f,softNmsSigma:m}=i9(t,e,r),_=yield s.image.nonMaxSuppressionWithScoreAsync(o,l,c,u,f,m);return[_.selectedIndices,_.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:l,maxOutputSize:c,iouThreshold:u,scoreThreshold:f}=i9(t,e,r),m=P("padToMaxOutputSize",t,e,r),_=yield s.image.nonMaxSuppressionPaddedAsync(o,l,c,u,f,m);return[_.selectedIndices,_.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:l,maxOutputSize:c,iouThreshold:u,scoreThreshold:f}=i9(t,e,r);return[yield s.image.nonMaxSuppressionAsync(o,l,c,u,f)]}case"Where":{const o=s.cast(P("condition",t,e,r),"bool"),l=[yield s.whereAsync(o)];return o.dispose(),l}case"ListDiff":return s.setdiff1dAsync(P("x",t,e,r),P("y",t,e,r));default:throw TypeError(`Node type ${t.op} is not implemented`)}});return function(e,r,i,s){return n.apply(this,arguments)}}();class Lje{get id(){return this.handle.id}constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=gn(0),this.tensorMap=new Map,Zs(this.handle)}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return gn(this.size(),"int32")}import(t,e){var r=this;return(0,q.Z)(function*(){r.checkKeyAndValueTensor(t,e);const i=yield t.data();return r.tensorMap.forEach(s=>s.dispose()),r.tensorMap.clear(),Ie(()=>{const s=cu(e),o=i.length,l=s.length;G(o===l,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${l} elements.`);for(let c=0;c<o;c++){const u=i[c],f=s[c];Zs(f),r.tensorMap.set(u,f)}return r.handle})})()}find(t,e){var r=this;return(0,q.Z)(function*(){r.checkKeyAndValueTensor(t,e);const i=yield t.data();return Ie(()=>{const s=[];for(let o=0;o<i.length;o++){const c=r.findWithDefault(i[o],e);s.push(c)}return Ol(s)})})()}findWithDefault(t,e){return this.tensorMap.get(t)??e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(e.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${e.dtype}`)}}const $je=function(){var n=(0,q.Z)(function*(t,e,r,i){switch(t.op){case"HashTable":case"HashTableV2":{const s=i.getHashTableHandleByName(t.name);if(null!=s)return[s];{const o=P("keyDType",t,e,r),l=P("valueDType",t,e,r),c=new Lje(o,l);return i.addHashTable(t.name,c),[c.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=P("tableHandle",t,e,r,i),o=P("keys",t,e,r),l=P("values",t,e,r);return[yield i.getHashTableById(s.id).import(o,l)]}case"LookupTableFind":case"LookupTableFindV2":{const s=P("tableHandle",t,e,r,i),o=P("keys",t,e,r),l=P("defaultValue",t,e,r);return[yield i.getHashTableById(s.id).find(o,l)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=P("tableHandle",t,e,r,i);return[i.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}});return function(e,r,i,s){return n.apply(this,arguments)}}();function _fe(n,t,e,r,i=Ie){const s=((o,l,c)=>{switch(o.category){case"arithmetic":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(P("a",n,t,e),P("b",n,t,e))];case"AddN":return[r.addN(P("tensors",n,t,e))];case"FloorMod":case"Mod":return[r.mod(P("a",n,t,e),P("b",n,t,e))];case"Mul":return[r.mul(P("a",n,t,e),P("b",n,t,e))];case"RealDiv":case"Div":return[r.div(P("a",n,t,e),P("b",n,t,e))];case"DivNoNan":return[r.divNoNan(P("a",n,t,e),P("b",n,t,e))];case"FloorDiv":return[r.floorDiv(P("a",n,t,e),P("b",n,t,e))];case"Sub":return[r.sub(P("a",n,t,e),P("b",n,t,e))];case"Minimum":return[r.minimum(P("a",n,t,e),P("b",n,t,e))];case"Maximum":return[r.maximum(P("a",n,t,e),P("b",n,t,e))];case"Pow":return[r.pow(P("a",n,t,e),P("b",n,t,e))];case"SquaredDifference":return[r.squaredDifference(P("a",n,t,e),P("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"basic_math":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"Abs":case"ComplexAbs":return[r.abs(P("x",n,t,e))];case"Acos":return[r.acos(P("x",n,t,e))];case"Acosh":return[r.acosh(P("x",n,t,e))];case"Asin":return[r.asin(P("x",n,t,e))];case"Asinh":return[r.asinh(P("x",n,t,e))];case"Atan":return[r.atan(P("x",n,t,e))];case"Atan2":return[r.atan2(P("x",n,t,e),P("y",n,t,e))];case"Atanh":return[r.atanh(P("x",n,t,e))];case"Ceil":return[r.ceil(P("x",n,t,e))];case"Complex":return[r.complex(P("real",n,t,e),P("imag",n,t,e))];case"Cos":return[r.cos(P("x",n,t,e))];case"Cosh":return[r.cosh(P("x",n,t,e))];case"Elu":return[r.elu(P("x",n,t,e))];case"Erf":return[r.erf(P("x",n,t,e))];case"Exp":return[r.exp(P("x",n,t,e))];case"Expm1":return[r.expm1(P("x",n,t,e))];case"Floor":return[r.floor(P("x",n,t,e))];case"Log":return[r.log(P("x",n,t,e))];case"Log1p":return[r.log1p(P("x",n,t,e))];case"Imag":return[r.imag(P("x",n,t,e))];case"Neg":return[r.neg(P("x",n,t,e))];case"Reciprocal":return[r.reciprocal(P("x",n,t,e))];case"Real":return[r.real(P("x",n,t,e))];case"Relu":return[r.relu(P("x",n,t,e))];case"Round":return[r.round(P("x",n,t,e))];case"Selu":return[r.selu(P("x",n,t,e))];case"Sigmoid":return[r.sigmoid(P("x",n,t,e))];case"Sin":return[r.sin(P("x",n,t,e))];case"Sign":return[r.sign(P("x",n,t,e))];case"Sinh":return[r.sinh(P("x",n,t,e))];case"Softplus":return[r.softplus(P("x",n,t,e))];case"Sqrt":return[r.sqrt(P("x",n,t,e))];case"Square":return[r.square(P("x",n,t,e))];case"Tanh":return[r.tanh(P("x",n,t,e))];case"Tan":return[r.tan(P("x",n,t,e))];case"ClipByValue":return[r.clipByValue(P("x",n,t,e),P("clipValueMin",n,t,e),P("clipValueMax",n,t,e))];case"Relu6":return[r.relu6(P("x",n,t,e))];case"Rsqrt":return[r.rsqrt(xo(n.inputNames[0],t,e))];case"LeakyRelu":return[r.leakyRelu(P("x",n,t,e),P("alpha",n,t,e))];case"Prelu":return[r.prelu(P("x",n,t,e),P("alpha",n,t,e))];case"IsNan":return[r.isNaN(xo(n.inputNames[0],t,e))];case"IsInf":return[r.isInf(xo(n.inputNames[0],t,e))];case"IsFinite":return[r.isFinite(xo(n.inputNames[0],t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"control":return Nje(o,l,c);case"convolution":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"Conv1D":{const i=P("stride",n,t,e),s=P("pad",n,t,e),o=P("dataFormat",n,t,e).toUpperCase(),l=P("dilation",n,t,e);return[r.conv1d(P("x",n,t,e),P("filter",n,t,e),i,s,o,l)]}case"Conv2D":{const i=P("strides",n,t,e),s=x3(n,t,e),o=P("dataFormat",n,t,e).toUpperCase(),l=P("dilations",n,t,e);return[r.conv2d(P("x",n,t,e),P("filter",n,t,e),[i[1],i[2]],s,o,[l[1],l[2]])]}case"_FusedConv2D":{const{stride:i,pad:s,dataFormat:o,dilations:l,biasArg:c,preluArg:u,activationFunc:f,leakyreluAlpha:m}=gfe(n,t,e);return[r.fused.conv2d({x:P("x",n,t,e),filter:P("filter",n,t,e),strides:[i[1],i[2]],pad:s,dataFormat:o,dilations:[l[1],l[2]],bias:c,activation:f,preluActivationWeights:u,leakyreluAlpha:m})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:s,dataFormat:o,dilations:l,biasArg:c,preluArg:u,activationFunc:f,leakyreluAlpha:m}=gfe(n,t,e);return[r.fused.depthwiseConv2d({x:P("x",n,t,e),filter:P("filter",n,t,e),strides:[i[1],i[2]],pad:s,dataFormat:o,dilations:[l[1],l[2]],bias:c,activation:f,preluActivationWeights:u,leakyreluAlpha:m})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=P("outputShape",n,t,e),s=P("strides",n,t,e),o=x3(n,t,e);return[r.conv2dTranspose(P("x",n,t,e),P("filter",n,t,e),i,[s[1],s[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=P("strides",n,t,e),s=x3(n,t,e),o=P("dilations",n,t,e),l=P("dataFormat",n,t,e).toUpperCase();return[r.depthwiseConv2d(P("input",n,t,e),P("filter",n,t,e),[i[1],i[2]],s,l,[o[1],o[2]])]}case"Conv3D":{const i=P("strides",n,t,e),s=P("pad",n,t,e),o=P("dataFormat",n,t,e).toUpperCase(),l=P("dilations",n,t,e);return[r.conv3d(P("x",n,t,e),P("filter",n,t,e),[i[1],i[2],i[3]],s,o,[l[1],l[2],l[3]])]}case"AvgPool":{const i=P("strides",n,t,e),s=P("pad",n,t,e),o=P("kernelSize",n,t,e);return[r.avgPool(P("x",n,t,e),[o[1],o[2]],[i[1],i[2]],s)]}case"MaxPool":{const i=P("strides",n,t,e),s=P("pad",n,t,e),o=P("kernelSize",n,t,e);return[r.maxPool(P("x",n,t,e),[o[1],o[2]],[i[1],i[2]],s)]}case"MaxPoolWithArgmax":{const i=P("strides",n,t,e),s=P("pad",n,t,e),o=P("kernelSize",n,t,e),l=P("includeBatchInIndex",n,t,e),{result:c,indexes:u}=r.maxPoolWithArgmax(P("x",n,t,e),[o[1],o[2]],[i[1],i[2]],s,l);return[c,u]}case"AvgPool3D":{const i=P("strides",n,t,e),s=P("pad",n,t,e),o=P("kernelSize",n,t,e);return[r.avgPool3d(P("x",n,t,e),[o[1],o[2],o[3]],[i[1],i[2],i[3]],s)]}case"MaxPool3D":{const i=P("strides",n,t,e),s=P("pad",n,t,e),o=P("kernelSize",n,t,e);return[r.maxPool3d(P("x",n,t,e),[o[1],o[2],o[3]],[i[1],i[2],i[3]],s)]}case"Dilation2D":{const i=P("strides",n,t,e),s=P("pad",n,t,e),o=P("dilations",n,t,e),l=i[1],c=i[2],u=o[1],f=o[2];return[r.dilation2d(P("x",n,t,e),P("filter",n,t,e),[l,c],s,[u,f],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"creation":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"Fill":{const i=P("shape",n,t,e),s=P("dtype",n,t,e),o=P("value",n,t,e);return[r.fill(i,o,s)]}case"LinSpace":{const i=P("start",n,t,e),s=P("stop",n,t,e),o=P("num",n,t,e);return[r.linspace(i,s,o)]}case"Multinomial":{const i=P("logits",n,t,e),s=P("numSamples",n,t,e),o=P("seed",n,t,e);return[r.multinomial(i,s,o)]}case"OneHot":{const i=P("indices",n,t,e),s=P("depth",n,t,e),o=P("onValue",n,t,e),l=P("offValue",n,t,e),c=P("dtype",n,t,e);return[r.oneHot(i,s,o,l,c)]}case"Ones":return[r.ones(P("shape",n,t,e),P("dtype",n,t,e))];case"OnesLike":return[r.onesLike(P("x",n,t,e))];case"RandomStandardNormal":return[r.randomStandardNormal(P("shape",n,t,e),P("dtype",n,t,e),P("seed",n,t,e))];case"RandomUniform":return[r.randomUniform(P("shape",n,t,e),P("minval",n,t,e),P("maxval",n,t,e),P("dtype",n,t,e))];case"RandomUniformInt":return[r.randomUniformInt(P("shape",n,t,e),P("minval",n,t,e),P("maxval",n,t,e),P("seed",n,t,e))];case"Range":{const i=P("start",n,t,e),s=P("stop",n,t,e),o=P("step",n,t,e);return[r.range(i,s,o,P("dtype",n,t,e))]}case"TruncatedNormal":{const i=P("shape",n,t,e),s=P("mean",n,t,e),o=P("stdDev",n,t,e),l=P("seed",n,t,e);return[r.truncatedNormal(i,s,o,P("dtype",n,t,e),l)]}case"Zeros":return[r.zeros(P("shape",n,t,e),P("dtype",n,t,e))];case"ZerosLike":return[r.zerosLike(P("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"dynamic":return Oje(o,l,c);case"evaluation":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"LowerBound":{const i=P("sortedSequence",n,t,e),s=P("values",n,t,e);return[r.lowerBound(i,s)]}case"TopKV2":{const i=P("x",n,t,e),s=P("k",n,t,e),o=P("sorted",n,t,e),l=r.topk(i,s,o);return[l.values,l.indices]}case"UpperBound":{const i=P("sortedSequence",n,t,e),s=P("values",n,t,e);return[r.upperBound(i,s)]}case"Unique":{const i=P("x",n,t,e),s=r.unique(i);return[s.values,s.indices]}case"UniqueV2":{const i=P("x",n,t,e),s=P("axis",n,t,e),o=r.unique(i,s);return[o.values,o.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"image":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"ResizeBilinear":{const i=P("images",n,t,e),s=P("size",n,t,e),o=P("alignCorners",n,t,e),l=P("halfPixelCenters",n,t,e);return[r.image.resizeBilinear(i,[s[0],s[1]],o,l)]}case"ResizeNearestNeighbor":{const i=P("images",n,t,e),s=P("size",n,t,e),o=P("alignCorners",n,t,e),l=P("halfPixelCenters",n,t,e);return[r.image.resizeNearestNeighbor(i,[s[0],s[1]],o,l)]}case"CropAndResize":{const i=P("image",n,t,e),s=P("boxes",n,t,e),o=P("boxInd",n,t,e),l=P("cropSize",n,t,e),c=P("method",n,t,e),u=P("extrapolationValue",n,t,e);return[r.image.cropAndResize(i,s,o,l,c,u)]}case"ImageProjectiveTransformV3":{const i=P("images",n,t,e),s=P("transforms",n,t,e),o=P("outputShape",n,t,e),l=P("fillValue",n,t,e),c=P("interpolation",n,t,e),u=P("fillMode",n,t,e);return[r.image.transform(i,s,c.toLowerCase(),u.toLowerCase(),l,o)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"graph":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"Const":return t[n.name];case"PlaceholderWithDefault":const i=P("default",n,t,e);return[xo(n.name,t,e)||i];case"Placeholder":return[xo(n.name,t,e)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[Sp(P("x",n,t,e))];case"IdentityN":return P("x",n,t,e).map(f=>Sp(f));case"Shape":return[r.tensor1d(P("x",n,t,e).shape,"int32")];case"ShapeN":return P("x",n,t,e).map(f=>r.tensor1d(f.shape));case"Size":return[r.scalar(P("x",n,t,e).size,"int32")];case"Rank":return[r.scalar(P("x",n,t,e).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=P("x",n,t,e),l=P("data",n,t,e),c=P("message",n,t,e),u=P("summarize",n,t,e);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(let f=0;f<l.length;f++)console.log(Array.prototype.slice.call(l[f].dataSync()).slice(0,u));return[o];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"logical":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"Equal":return[r.equal(P("a",n,t,e),P("b",n,t,e))];case"NotEqual":return[r.notEqual(P("a",n,t,e),P("b",n,t,e))];case"Greater":return[r.greater(P("a",n,t,e),P("b",n,t,e))];case"GreaterEqual":return[r.greaterEqual(P("a",n,t,e),P("b",n,t,e))];case"Less":return[r.less(P("a",n,t,e),P("b",n,t,e))];case"LessEqual":return[r.lessEqual(P("a",n,t,e),P("b",n,t,e))];case"LogicalAnd":return[r.logicalAnd(P("a",n,t,e),P("b",n,t,e))];case"LogicalNot":return[r.logicalNot(P("a",n,t,e))];case"LogicalOr":return[r.logicalOr(P("a",n,t,e),P("b",n,t,e))];case"Select":case"SelectV2":return[r.where(P("condition",n,t,e),P("a",n,t,e),P("b",n,t,e))];case"BitwiseAnd":return[r.bitwiseAnd(P("a",n,t,e),P("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"matrices":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(P("a",n,t,e),P("b",n,t,e),P("transposeA",n,t,e),P("transposeB",n,t,e))];case"Einsum":return[r.einsum(P("equation",n,t,e),...P("tensors",n,t,e))];case"Transpose":return[r.transpose(P("x",n,t,e),P("perm",n,t,e))];case"_FusedMatMul":const[i,s]=P("fusedOps",n,t,e),o="biasadd"===i,l="prelu"===s,c=P("numArgs",n,t,e),u=P("leakyreluAlpha",n,t,e);if(o){if(l&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!l&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[f,m]=P("args",n,t,e);return[r.fused.matMul({a:P("a",n,t,e),b:P("b",n,t,e),transposeA:P("transposeA",n,t,e),transposeB:P("transposeB",n,t,e),bias:f,activation:s,preluActivationWeights:m,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart(P("a",n,t,e),P("numLower",n,t,e),P("numUpper",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"normalization":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"EuclideanNorm":return[r.euclideanNorm(P("x",n,t,e),P("axis",n,t,e),P("keepDims",n,t,e))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(P("x",n,t,e),P("mean",n,t,e),P("variance",n,t,e),P("offset",n,t,e),P("scale",n,t,e),P("epsilon",n,t,e))];case"LRN":return[r.localResponseNormalization(P("x",n,t,e),P("radius",n,t,e),P("bias",n,t,e),P("alpha",n,t,e),P("beta",n,t,e))];case"Softmax":return[r.softmax(P("x",n,t,e))];case"LogSoftmax":return[r.logSoftmax(P("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"ragged":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:i,outputDenseValues:s}=r.raggedGather(P("paramsNestedSplits",n,t,e),P("paramsDenseValues",n,t,e),P("indices",n,t,e),P("outputRaggedRank",n,t,e));return i.concat(s)}case"RaggedRange":{const{rtNestedSplits:i,rtDenseValues:s}=r.raggedRange(P("starts",n,t,e),P("limits",n,t,e),P("splits",n,t,e));return[i,s]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(P("shape",n,t,e),P("values",n,t,e),P("defaultValue",n,t,e),P("rowPartitionTensors",n,t,e),P("rowPartitionTypes",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"reduction":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"Max":{const l=P("axis",n,t,e),c=P("keepDims",n,t,e);return[r.max(P("x",n,t,e),l,c)]}case"Mean":{const l=P("axis",n,t,e),c=P("keepDims",n,t,e);return[r.mean(P("x",n,t,e),l,c)]}case"Min":{const l=P("axis",n,t,e),c=P("keepDims",n,t,e);return[r.min(P("x",n,t,e),l,c)]}case"Sum":{const l=P("axis",n,t,e),c=P("keepDims",n,t,e);return[r.sum(P("x",n,t,e),l,c)]}case"All":{const l=P("axis",n,t,e),c=P("keepDims",n,t,e);return[r.all(P("x",n,t,e),l,c)]}case"Any":{const l=P("axis",n,t,e),c=P("keepDims",n,t,e);return[r.any(P("x",n,t,e),l,c)]}case"ArgMax":{const l=P("axis",n,t,e);return[r.argMax(P("x",n,t,e),l)]}case"ArgMin":{const l=P("axis",n,t,e);return[r.argMin(P("x",n,t,e),l)]}case"Prod":{const l=P("axis",n,t,e),c=P("keepDims",n,t,e);return[r.prod(P("x",n,t,e),l,c)]}case"Cumprod":{const l=P("axis",n,t,e),c=P("exclusive",n,t,e),u=P("reverse",n,t,e);return[r.cumprod(P("x",n,t,e),l,c,u)]}case"Cumsum":{const l=P("axis",n,t,e),c=P("exclusive",n,t,e),u=P("reverse",n,t,e);return[r.cumsum(P("x",n,t,e),l,c,u)]}case"Bincount":const i=P("x",n,t,e),s=P("weights",n,t,e),o=P("size",n,t,e);return[r.bincount(i,s,o)];case"DenseBincount":{const l=P("x",n,t,e),c=P("weights",n,t,e),u=P("size",n,t,e),f=P("binaryOutput",n,t,e);return[r.denseBincount(l,c,u,f)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"slice_join":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"ConcatV2":case"Concat":{const i=P("n",n,t,e),s=P("axis",n,t,e);let o=P("tensors",n,t,e);return o=o.slice(0,i),[r.concat(o,s)]}case"Gather":{const i=P("x",n,t,e),s=P("indices",n,t,e);return[r.gather(i,r.cast(s,"int32"),0)]}case"GatherV2":{const i=P("axis",n,t,e),s=P("batchDims",n,t,e),o=P("x",n,t,e),l=P("indices",n,t,e);return[r.gather(o,r.cast(l,"int32"),i,s)]}case"Reverse":{const i=P("dims",n,t,e),s=[];for(let l=0;l<i.length;l++)i[l]&&s.push(l);const o=P("x",n,t,e);return[r.reverse(o,s)]}case"ReverseV2":{const i=P("axis",n,t,e),s=P("x",n,t,e);return[r.reverse(s,i)]}case"Slice":{const i=P("begin",n,t,e),s=P("size",n,t,e);return[r.slice(P("x",n,t,e),i,s)]}case"StridedSlice":{const i=P("begin",n,t,e),s=P("end",n,t,e),o=P("strides",n,t,e),l=P("beginMask",n,t,e),c=P("endMask",n,t,e),u=P("ellipsisMask",n,t,e),f=P("newAxisMask",n,t,e),m=P("shrinkAxisMask",n,t,e),_=P("x",n,t,e);return[r.stridedSlice(_,i,s,o,l,c,u,f,m)]}case"Pack":return Ie(()=>{const i=P("axis",n,t,e),s=P("tensors",n,t,e),o=s[0].shape,l=r.squeeze(s[0]).shape,c=s.map(u=>{const f=dr(u.shape,o);if(!f&&!dr(r.squeeze(u).shape,l))throw new Error("the input tensors shape does not match");return f?u:r.reshape(u,o)});return[r.stack(c,i)]});case"Unpack":{const i=P("axis",n,t,e),s=P("tensor",n,t,e);return r.unstack(s,i)}case"Tile":{const i=P("reps",n,t,e);return[r.tile(P("x",n,t,e),i)]}case"Split":case"SplitV":{const i=P("axis",n,t,e),s=P("numOrSizeSplits",n,t,e),o=P("x",n,t,e);return r.split(o,s,i)}case"ScatterNd":{const i=P("indices",n,t,e),s=P("values",n,t,e),o=P("shape",n,t,e);return[r.scatterND(i,s,o)]}case"GatherNd":{const i=P("x",n,t,e),s=P("indices",n,t,e);return[r.gatherND(i,s)]}case"SparseToDense":{const i=P("sparseIndices",n,t,e),s=P("outputShape",n,t,e),o=P("sparseValues",n,t,e),l=P("defaultValue",n,t,e);return[r.sparseToDense(i,o,s,o.dtype===l.dtype?l:r.cast(l,o.dtype))]}case"TensorScatterUpdate":{const i=P("indices",n,t,e),s=P("values",n,t,e),o=P("tensor",n,t,e);return[r.tensorScatterUpdate(o,i,s)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"sparse":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:s,emptyRowIndicator:o,reverseIndexMap:l}=r.sparse.sparseFillEmptyRows(P("indices",n,t,e),P("values",n,t,e),P("denseShape",n,t,e),P("defaultValue",n,t,e));return[i,s,o,l]}case"SparseReshape":{const{outputIndices:i,outputShape:s}=r.sparse.sparseReshape(P("inputIndices",n,t,e),P("inputShape",n,t,e),P("newShape",n,t,e));return[i,s]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(P("data",n,t,e),P("indices",n,t,e),P("segmentIds",n,t,e))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(P("data",n,t,e),P("indices",n,t,e),P("segmentIds",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"spectral":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"FFT":return[r.fft(P("x",n,t,e))];case"IFFT":return[r.ifft(P("x",n,t,e))];case"RFFT":return[r.rfft(P("x",n,t,e))];case"IRFFT":return[r.irfft(P("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"string":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(P("input",n,t,e),P("pattern",n,t,e),P("rewrite",n,t,e),P("replaceGlobal",n,t,e))];case"StringNGrams":{const{nGrams:i,nGramsSplits:s}=r.string.stringNGrams(P("data",n,t,e),P("dataSplits",n,t,e),P("separator",n,t,e),P("nGramWidths",n,t,e),P("leftPad",n,t,e),P("rightPad",n,t,e),P("padWidth",n,t,e),P("preserveShortSequences",n,t,e));return[i,s]}case"StringSplit":{const{indices:i,values:s,shape:o}=r.string.stringSplit(P("input",n,t,e),P("delimiter",n,t,e),P("skipEmpty",n,t,e));return[i,s,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(P("input",n,t,e),P("numBuckets",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"transformation":return i(()=>((n,t,e,r=he)=>{switch(n.op){case"Cast":return[r.cast(P("x",n,t,e),P("dtype",n,t,e))];case"ExpandDims":{const i=P("axis",n,t,e);return[r.expandDims(P("x",n,t,e),i)]}case"Squeeze":{const i=P("axis",n,t,e);return[r.squeeze(P("x",n,t,e),i)]}case"Reshape":return[r.reshape(P("x",n,t,e),P("shape",n,t,e))];case"EnsureShape":return[r.ensureShape(P("x",n,t,e),P("shape",n,t,e))];case"MirrorPad":return[r.mirrorPad(P("x",n,t,e),P("padding",n,t,e),P("mode",n,t,e))];case"PadV2":case"Pad":return[r.pad(P("x",n,t,e),P("padding",n,t,e),P("constantValue",n,t,e))];case"SpaceToBatchND":{const i=P("blockShape",n,t,e),s=P("paddings",n,t,e);return[r.spaceToBatchND(P("x",n,t,e),i,s)]}case"BatchToSpaceND":{const i=P("blockShape",n,t,e),s=P("crops",n,t,e);return[r.batchToSpaceND(P("x",n,t,e),i,s)]}case"DepthToSpace":{const i=P("blockSize",n,t,e),s=P("dataFormat",n,t,e).toUpperCase();return[r.depthToSpace(P("x",n,t,e),i,s)]}case"BroadcastTo":return[r.broadcastTo(P("x",n,t,e),P("shape",n,t,e))];case"BroadcastArgs":return[r.broadcastArgs(P("s0",n,t,e),P("s1",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,l,c));case"hash_table":return $je(o,l,c,r);case"custom":const u=cfe(o.op);if(u&&u.customExecutor)return u.customExecutor(new xje(o,l,c));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,t,e);return Ub(s)?s.then(o=>[].concat(o)):[].concat(s)}class yfe{constructor(t={},e={},r={},i={},s){this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=r,this.functionMap=i,this.parseNodeNameCache=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const r=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}function vfe(n,t,e,r){const i=new Set,s=[];let o=null,l=null;const c=new Set,u=new Set(Object.keys(n).map(_=>Fl(_)[0]));r=r||[];const f=new Set(r.map(_=>Fl(_.name)[0])),m=[...t];for(;m.length>0;){const _=m.pop();if((d0(_)||rqe(_)||iqe(_))&&null==o&&(o=_,l=o.children.map(y=>y.name).filter(y=>i.has(y))),i.add(_.name),null==e[_.name]&&!u.has(_.name)&&!f.has(_.name)){if(0===_.inputs.length){s.push(_.name);continue}_.inputs.forEach(y=>{c.has(y.name)||(c.add(y.name),m.push(y))})}}return{inputs:n,outputs:t,usedNodes:i,missingInputs:s,dynamicNode:o,syncInputs:l}}class I3 extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}const eqe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),tqe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),nqe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function d0(n){return eqe.has(n.op)}function rqe(n){return tqe.has(n.op)}function iqe(n){return nqe.has(n.op)}class T3{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(r=>t[r].map(i=>i.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(r=>{this._functionExecutorMap[r]=new T3(t.functions[r],this)})}getCompilationKey(t,e){const r=t.map(s=>s.name).sort(),i=e.map(s=>s.name).sort();return r.join(this.SEPARATOR)+"--"+i.join(this.SEPARATOR)}compile(t,e){const r=vfe(t,e,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:s,syncInputs:o}=r;if(null!=s)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(i.length>0){const u=e.map(m=>m.name),f=Object.keys(t);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${f}]. Missing the following inputs: [${i}]`)}const l=function Kje(n,t){const{usedNodes:e,inputs:r}=t,o=I=>e.has("string"==typeof I?I:I.name);function l(I){return[...new Map(I.map(E=>[E.name,E])).values()]}const c=l([...Object.keys(r).map(I=>Fl(I)[0]).map(I=>n.nodes[I]),...n.weights,...n.initNodes||[]]).filter(o),u=l([...c,...Object.values(n.nodes)]).filter(o),f=new Map(u.map(I=>[I.name,I])),m={};for(const I of u){m[I.name]=m[I.name]||0;for(const E of I.children)o(E)||(m[E.name]=Number.POSITIVE_INFINITY),m[E.name]=(m[E.name]||0)+1}const _=Object.entries(m).filter(([,I])=>0===I).map(([I])=>I),y=[..._];for(;_.length>0;){const I=_.pop(),E=f.get(I);for(const A of E.children.filter(o))0==--m[A.name]&&(y.push(A.name),_.push(A.name))}const T=function Qje(n,t){const e=new Map(n.map(o=>[o.name,o])),r=t.map(o=>o.name),i=new Set(r);for(;r.length>0;){const o=r.pop(),l=e.get(o);for(const c of l.children)!e.has(c.name)||i.has(c.name)||(i.add(c.name),r.push(c.name))}return n.filter(o=>i.has(o.name))}(y.map(I=>f.get(I)),c);return function Xje(n,t){const e=new Map(n.map((l,c)=>[l.name,c])),r=new Set(t.map(l=>l.name)),i=l=>r.has("string"==typeof l?l:l.name),s=new Set(n.map(l=>l.name)),o=l=>s.has("string"==typeof l?l:l.name);for(const l of n){for(const c of l.children.filter(o)){if(!e.has(c.name))throw new I3(`Child ${c.name} of node ${l.name} is unreachable.`);if(e.get(l.name)>e.get(c.name))throw new I3(`Node ${l.name} is scheduled to run after its child ${c.name}.`)}if(!i(l))for(const c of l.inputs){if(!e.has(c.name))throw new I3(`Input ${c.name} of node ${l.name} is unreachable.`);if(e.get(c.name)>e.get(l.name))throw new I3(`Node ${l.name} is scheduled to run before its input ${c.name}.`)}}}(T,c),T}(this.graph,r),c=function Jje(n){const t=new Map(n.map((l,c)=>[l.name,c])),e=Number.MAX_SAFE_INTEGER,r=n.map((l,c)=>d0(l)?e:c),i=l=>r[t.get(l.name)]??-1,s=n.map((l,c)=>l.children.map(i).reduce((u,f)=>Math.max(u,f),r[c])),o=new Map;for(let l=0;l<n.length;++l){const c=s[l];if(c===e)continue;const u=n[l],f=n[c];o.has(f.name)||o.set(f.name,[]),o.get(f.name).push(u)}return o}(l);return{orderedNodes:l,nodeLiveUntilMap:c}}cloneAndKeepTensor(t){if(null==t)return null;const e=t.clone();return Zs(e),e}cloneTensorList(t){return t?t.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e,this.cloneTensorList(r)]))}execute(t,e){this.disposeIntermediateTensors(),t=this.mapInputs(t);const r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const i=r.map(_=>this.graph.nodes[Fl(_)[0]]),s=e.map(_=>Fl(_)[0]),o=new Set(s);let l=s.map(_=>this.graph.nodes[_]);0===l.length&&(l=this._outputs);const c=this.getCompilationKey(i,l);let u=this.compiledMap.get(c);null==u&&(u=this.compile(t,l),this.compiledMap.set(c,u));try{this.keepIntermediateTensors=Me().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(_){this.keepIntermediateTensors=!1,console.warn(_.message)}const f={},m={};return Ie(()=>{const _=new yfe(this.weightMap,f,m,this.functionExecutorMap,this.parseNodeNameCache),y=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(E=>{const[A,M]=Fl(E,_),O=[];O[M]=t[E],y[A]=O,this.keepIntermediateTensors&&(this.clonedTensorsMap[A]=this.cloneTensorList(O))});const w=this.getFrozenTensorIds(y),{orderedNodes:T,nodeLiveUntilMap:I}=u;for(const E of T){if(y[E.name])continue;const A=_fe(E,y,_,this._resourceManager);if(Ub(A))throw new Error(`The execution of the op '${E.op}' returned a promise. Please use model.executeAsync() instead.`);y[E.name]=A,this.keepIntermediateTensors&&(this.clonedTensorsMap[E.name]=this.cloneTensorList(A)),this.checkTensorForDisposalWithNodeLiveUntilInfo(E,y,_,w,o,I.get(E.name))}return null==this.parent&&_.dispose(w),e.map(E=>xo(E,y,_))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(r=>t[r]).map(r=>r.map(i=>i.id)));return new Set(e)}checkTensorForDisposal(t,e,r,i,s,o,l){if(!d0(e)&&!o.has(t)){for(const c of r[t])null!=c&&(l[c.id]=(l[c.id]||0)+e.children.length);for(const c of e.inputs){if(d0(c))continue;const u=ufe(c.name,r,i);if(null!=u)for(const f of u){if(!f||f.kept||s.has(f.id))continue;const m=l[f.id];1===m?(f.dispose(),delete l[f.id]):null!=m&&l[f.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,e,r,i,s,o){function l(c){return d0(c)||s.has(c.name)}if(!d0(t)&&null!=o)for(const c of o){if(l(c))continue;const u=ufe(c.name,e,r);for(const f of u)!f||f.kept||i.has(f.id)||f.dispose()}}executeAsync(t,e){var r=this;return(0,q.Z)(function*(){return r._executeAsync(t,e)})()}disposeIntermediateTensors(){!this.clonedTensorsMap||(Object.values(this.clonedTensorsMap).forEach(t=>{for(const e of t)e&&!e.isDisposed&&e.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}_executeAsync(t,e,r=!1,i={},s={}){var o=this;return(0,q.Z)(function*(){o.disposeIntermediateTensors(),r||(t=o.mapInputs(t),o.checkInputs(t),o.checkInputShapeAndType(t),e=o.mapOutputs(e),o.checkOutputs(e));try{o.keepIntermediateTensors=Me().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(y){o.keepIntermediateTensors=!1,console.warn(y.message)}const l=new yfe(o.weightMap,i,s,o.functionExecutorMap,o.parseNodeNameCache);o.keepIntermediateTensors&&(o.clonedTensorsMap=o.cloneTensorMap(o.weightMap));const c=yield o.executeWithControlFlow(t,l,e,r),u=e.map(y=>xo(y,c,l)),f=u.map(y=>y.id),m=Object.keys(t).map(y=>t[y].id),_=new Set([...f,...m,...o.weightIds]);return Object.values(c).forEach(y=>{y.forEach(w=>{w&&!w.isDisposed&&!_.has(w.id)&&w.dispose()})}),null==o.parent&&l.dispose(_),u})()}executeFunctionAsync(t,e,r){var i=this;return(0,q.Z)(function*(){const s=t.reduce((o,l,c)=>(o[i.inputs[c].name]=l,o),{});return i._executeAsync(s,i.outputNodes,!0,e,r)})()}executeWithControlFlow(t,e,r,i){var s=this;return(0,q.Z)(function*(){const o=Object.keys(t),l=o.map($=>s.graph.nodes[Fl($)[0]]),c=r.map($=>Fl($)[0]),u=new Set(c);let f=c.map($=>s.graph.nodes[$]);0===f.length&&(f=s._outputs);const{usedNodes:m,missingInputs:_,dynamicNode:y,syncInputs:w}=vfe(t,f,s.weightMap,s._initNodes),T=[...l,...s.graph.weights,...s._initNodes||[]].map($=>({node:$,contexts:e.currentContext})),I=Object.assign({},s.weightMap);Object.keys(t).forEach($=>{const[V,Z]=Fl($),Q=[];Q[Z]=t[$],I[V]=Q});const E={},A=s.getFrozenTensorIds(I),M={};for(;T.length>0;){const $=s.processStack(l,T,e,I,M,A,u,E,m);yield Promise.all($)}null==y&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const O=f.filter($=>!d0($)&&!xo($.name,I,e)).map($=>$.name);if(O.length>0){let $="";throw null!=y&&($=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${w}]`),new Error(`Cannot compute the outputs [${O}] from the provided inputs [${o}]. Consider providing the following inputs: [${_}]. ${$}`)}return I})()}processStack(t,e,r,i,s,o,l,c,u){const f=[];for(;e.length>0;){const m=e.pop();r.currentContext=m.contexts;let _="";if("Enter"===m.node.op&&P("isConstant",m.node,i,r)&&([_]=Tp(m.node.name,r)),null==i[m.node.name]){const y=_fe(m.node,i,r,this._resourceManager);_||([_]=Tp(m.node.name,r));const w=r.currentContext;Ub(y)?f.push(y.then(T=>(i[_]=T,this.keepIntermediateTensors&&(this.clonedTensorsMap[_]=this.cloneTensorList(T)),r.currentContext=w,this.checkTensorForDisposal(_,m.node,i,r,o,l,c),this.processChildNodes(m.node,e,r,i,s,u),T))):(i[_]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[_]=this.cloneTensorList(y)),this.checkTensorForDisposal(_,m.node,i,r,o,l,c),this.processChildNodes(m.node,e,r,i,s,u))}else this.processChildNodes(m.node,e,r,i,s,u)}return f}processChildNodes(t,e,r,i,s,o){t.children.forEach(l=>{const[c]=Tp(l.name,r);s[c]||!o.has(l.name)||("Merge"===l.op?l.inputNames.some(u=>!!xo(u,i,r))&&(s[c]=!0,e.push({contexts:r.currentContext,node:l})):l.inputNames.every(u=>!!xo(u,i,r))&&(s[c]=!0,e.push({contexts:r.currentContext,node:l})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(e=>e.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const r=t[e],[i]=Fl(e),s=this.graph.nodes[i];if(s.attrParams.shape&&s.attrParams.shape.value){const o=s.attrParams.shape.value;G(o.length===r.shape.length&&r.shape.every((c,u)=>-1===o[u]||o[u]===c),()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&G(r.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(t){var e,r;const i={};for(const s in t){const o=null===(r=null===(e=this._signature)||void 0===e?void 0:e.inputs)||void 0===r?void 0:r[s];null!=o?i[o.name]=t[s]:i[s]=t[s]}return i}checkInputs(t){const e=Object.keys(t).filter(r=>{const[i]=Fl(r);return null==this.graph.nodes[i]});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(e=>{var r,i;const s=null===(i=null===(r=this._signature)||void 0===r?void 0:r.outputs)||void 0===i?void 0:i[e];return null!=s?s.name:e},{})}checkOutputs(t){t.forEach(e=>{const[r]=Fl(e);if(!this.graph.nodes[r])throw new Error(`The output '${e}' is not found in the graph`)})}}class sqe{constructor(t={},e={}){this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}class bfe{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t,e={},r=B){this.modelUrl=t,this.loadOptions=e,this.version="n/a",this.io=r,null==e&&(this.loadOptions={}),this.resourceManager=new sqe}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const e=this.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return Ub(t)?t.then(e=>null==e.getWeightStream?this.loadSync(e):this.loadStreaming(e)):this.loadSync(t)}loadSync(t){const e=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,e)}loadStreaming(t){var e=this;return(0,q.Z)(function*(){if(null==t.getWeightStream)throw new Error("Model artifacts missing streamWeights function");const r=yield oce(t.getWeightStream(),t.weightSpecs);return e.loadWithWeightMap(t,r)})()}loadWithWeightMap(t,e){this.artifacts=t;const r=this.artifacts.modelTopology;let i=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const s=this.artifacts.userDefinedMetadata;null!=s.signature&&(i=s.signature),null!=s.structuredOutputKeys&&(this.structuredOutputKeys=s.structuredOutputKeys)}if(this.signature=i,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new T3(dfe.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(e),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){const s=dfe.Instance.transformGraph(t.modelInitializer);this.initializer=new T3(s),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}save(t,e){var r=this;return(0,q.Z)(function*(){if("string"==typeof t){const i=r.io.getSaveHandlers(t);if(0===i.length)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(i.length>1)throw new Error(`Found more than one (${i.length}) save handlers for URL '${t}'`);t=i[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(r.artifacts)})()}addStructuredOutputNames(t){if(this.structuredOutputKeys){const r={};return(t instanceof fi?[t]:t).forEach((i,s)=>r[this.structuredOutputKeys[s]]=i),r}return t}predict(t,e){const r=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(r)}predictAsync(t,e){var r=this;return(0,q.Z)(function*(){const i=yield r.executeAsync(t,r.outputNodes);return r.addStructuredOutputNames(i)})()}normalizeInputs(t){var e;if(!(t instanceof fi||Array.isArray(t))){const s=null===(e=this.signature)||void 0===e?void 0:e.inputs;if(null!=s)for(const o in s){const l=s[o];null!=l.resourceId&&(t[o]=this.resourceIdToCapturedInput[l.resourceId])}return t}t=Array.isArray(t)?t:[t];const r=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${t.length} input tensors provided.`);let i=0;return this.inputNodes.reduce((s,o)=>{var l,c,u;const f=null===(u=null===(c=null===(l=this.signature)||void 0===l?void 0:l.inputs)||void 0===c?void 0:c[o])||void 0===u?void 0:u.resourceId;return s[o]=null!=f?this.resourceIdToCapturedInput[f]:t[i++],s},{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return null==this.initializer?[]:this.initializer.execute({},null==this.initializerSignature?[]:Object.keys(this.initializerSignature.outputs))}executeInitializerGraphAsync(){var t=this;return(0,q.Z)(function*(){return null==t.initializer?[]:t.initializer.executeAsync({},null==t.initializerSignature?[]:Object.keys(t.initializerSignature.outputs))})()}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const e=this.initializerSignature.outputs,r=Object.keys(e);for(let i=0;i<r.length;i++)this.resourceIdToCapturedInput[e[r[i]].resourceId]=t[i]}}execute(t,e){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const r=this.executor.execute(t,e);return r.length>1?r:r[0]}executeAsync(t,e){var r=this;return(0,q.Z)(function*(){null==r.resourceIdToCapturedInput&&r.setResourceIdToCapturedInput(yield r.executeInitializerGraphAsync()),t=r.normalizeInputs(t),e=r.normalizeOutputs(e);const i=yield r.executor.executeAsync(t,e);return i.length>1?i:i[0]})()}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,r)=>(e[r]=[t[r]],e),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Qn(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}function s9(){return s9=(0,q.Z)(function*(n,t={},e=B){if(null==n)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&"string"==typeof n&&(n=cqe(n));const r=new bfe(n,t,e);return yield r.load(),r}),s9.apply(this,arguments)}function cqe(n){return n.endsWith("/")||(n+="/"),`${n}model.json?tfjs-format=file`}function nn(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{null!=e&&G("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the CPU backend.`)})}Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");const Lqe=wY;let $qe=(()=>{class n extends F5{nextDataId(){return n.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Tle(this,_h())}write(e,r,i){this.firstUse&&(this.firstUse=!1,Me().get("IS_NODE")&&hc("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:i,refCount:1}),s}makeTensorInfo(e,r,i){let s;if("string"===r&&null!=i&&i.length>0&&z1(i[0])){const o=i.map(l=>r_(l));s=this.write(o,e,r)}else s=this.write(i,e,r);return{dataId:s,shape:e,dtype:r}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){this.data.get(e).refCount++}decRef(e){this.data.has(e)&&this.data.get(e).refCount--}move(e,r,i,s,o){this.data.set(e,{values:r,dtype:s,refCount:o})}numDataIds(){return this.data.numDataIds()}read(e){var r=this;return(0,q.Z)(function*(){return r.readSync(e)})()}readSync(e){const{dtype:r,complexTensorInfos:i}=this.data.get(e);return"complex64"===r?wp(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):function W2e(n,t){if(Array.isArray(n))return n;if("float32"===t)return n instanceof Float32Array?n:new Float32Array(n);if("int32"===t)return n instanceof Int32Array?n:new Int32Array(n);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${t}`)}(this.data.get(e).values,r)}bufferSync(e){const r=this.readSync(e.dataId);if("string"===e.dtype)try{const i=r.map(s=>i_(s));return qn(e.shape,e.dtype,i)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qn(e.shape,e.dtype,r)}makeOutput(e,r,i){return _h().makeTensorFromTensorInfo(this.makeTensorInfo(r,i,e),this)}disposeData(e,r=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!r&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:i}=this.data.get(e);null!=i&&(this.disposeData(i.real.dataId,!0),this.disposeData(i.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}time(e){return(0,q.Z)(function*(){const r=Qa();return e(),{kernelMs:Qa()-r}})()}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){nn([e],"where");const r=this.readSync(e.dataId);return Lqe(e.shape,r)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}return n.nextDataId=0,n})();function kh(n){return(t,e,r)=>{const i=ns(e,t.length);for(let s=0;s<t.length;++s)i[s]=n(t[s],r);return i}}function Lr(n,t,e){return T_(n,kh(t),e)}function T_(n,t,e){return({inputs:r,attrs:i,backend:s})=>{const{x:o}=r;nn(o,n);const l=s,c=l.data.get(o.dataId).values;let u;if("string"===o.dtype){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");u=Cp(c)}else u=c;const f=e||o.dtype,m=t(u,f,i);return l.makeTensorInfo(o.shape,f,m)}}tce("cpu",()=>new $qe,1);const Nfe=Lr(nN,n=>n>=0?n:Math.exp(n)-1),Vqe={kernelName:nN,backendName:"cpu",kernelFunc:Nfe};function Ah(n){const{inputs:t,backend:e}=n,{x:r}=t;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Uqe={kernelName:cN,backendName:"cpu",kernelFunc:Ah};function Rfe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{alpha:s}=r;nn([i],"leakyRelu");const o=Ye(i.shape),l=e.data.get(i.dataId).values,c=vo("float32",o);for(let u=0;u<l.length;u++)c[u]=l[u]<0?s*l[u]:l[u];return e.makeTensorInfo(i.shape,"float32",c)}const zqe={kernelName:TB,backendName:"cpu",kernelFunc:Rfe};function os(n){return(t,e,r,i,s)=>{const o=Bn(t,e),l=o.length,c=pn(o),f=vo(s,Ye(o)),m=t.length,_=e.length,y=pn(t),w=pn(e),T=uT(t,o),I=uT(e,o);if(T.length+I.length===0)for(let E=0;E<f.length;++E)f[E]=n(r[E%r.length],i[E%i.length]);else for(let E=0;E<f.length;++E){const A=JI(E,l,c),M=A.slice(-m);T.forEach(Z=>M[Z]=0);const O=gh(M,m,y),$=A.slice(-_);I.forEach(Z=>$[Z]=0);const V=gh($,_,w);f[E]=n(r[O],i[V])}return[f,o]}}const Hqe=os((n,t)=>n<0?t*n:n);function Mfe(n){const{inputs:t,backend:e}=n,{x:r,alpha:i}=t;nn([r,i],"prelu");const s=e.data.get(r.dataId).values,o=e.data.get(i.dataId).values,[l,c]=Hqe(r.shape,i.shape,s,o,"float32");return e.makeTensorInfo(c,"float32",l)}const Gqe={kernelName:GB,backendName:"cpu",kernelFunc:Mfe},Ofe=Lr(wN,n=>Math.max(0,n)),Wqe={kernelName:wN,backendName:"cpu",kernelFunc:Ofe},Ffe=Lr(CN,n=>Math.min(Math.max(0,n),6)),jqe={kernelName:CN,backendName:"cpu",kernelFunc:Ffe},qqe=kh(n=>1/(1+Math.exp(-n))),Pfe=Lr(kN,n=>1/(1+Math.exp(-n))),Zqe={kernelName:kN,backendName:"cpu",kernelFunc:Pfe};function k3(n,t,e,r,i){if("linear"===e)return Ah({inputs:{x:t},backend:n});if("relu"===e)return Ofe({inputs:{x:t},backend:n});if("elu"===e)return Nfe({inputs:{x:t},backend:n});if("relu6"===e)return Ffe({inputs:{x:t},backend:n});if("prelu"===e)return Mfe({inputs:{x:t,alpha:r},backend:n});if("leakyrelu"===e)return Rfe({inputs:{x:t},backend:n,attrs:{alpha:i}});if("sigmoid"===e)return Pfe({inputs:{x:t},backend:n});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}function Pl(n){const{inputs:t,backend:e}=n,{real:r,imag:i}=t,s=e.data.get(r.dataId).values,o=e.data.get(i.dataId).values,l=e.makeTensorInfo(r.shape,"complex64");return e.data.get(l.dataId).complexTensorInfos={real:e.makeTensorInfo(r.shape,"float32",s),imag:e.makeTensorInfo(i.shape,"float32",o)},l}const Yqe={kernelName:K5,backendName:"cpu",kernelFunc:Pl};function A3(n,t,e="float32"){if("complex64"===e)return Pl({inputs:{real:A3(n,t,"float32"),imag:A3(n,t,"float32")},backend:n});const r=Qo(Ye(t),e);return n.makeTensorInfo(t,e,r)}function h0(n){const{inputs:t,backend:e}=n,{input:r}=t,i=e.data.get(r.dataId).complexTensorInfos.real,s=e.data.get(i.dataId).values;return e.makeTensorInfo(i.shape,i.dtype,s)}const Kqe={kernelName:NZ,backendName:"cpu",kernelFunc:h0};function Lfe(n,t,e,r){if("int32"===r)return[t,"int32",Int32Array.from(n)];if("bool"===r){const i=Gb([0],e),[s,o]=os((l,c)=>l!==c?1:0)(t,[],n,i,"bool");return[o,"bool",s]}throw new Error(`Error in Cast: failed to cast ${e} to ${r}`)}function S_(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{dtype:s}=r;if("complex64"===s){if("complex64"===i.dtype)return Ah({inputs:{x:i},backend:e});const f=A3(e,i.shape,i.dtype),m=S_({inputs:{x:i},backend:e,attrs:{dtype:"float32"}}),_=Pl({inputs:{real:m,imag:f},backend:e});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(m),_}if("complex64"===i.dtype){const f=h0({inputs:{input:i},backend:e}),m=S_({inputs:{x:f},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(f),m}if(!kle(i.dtype,s)){const f=Ah({inputs:{x:i},backend:e});return{dataId:f.dataId,shape:f.shape,dtype:s}}const o=e.data.get(i.dataId).values,[l,c,u]=Lfe(o,i.shape,i.dtype,s);return e.makeTensorInfo(l,c,u)}const Qqe={kernelName:K1,backendName:"cpu",kernelFunc:S_};function Ps(n,t,e,r){return null==e?({inputs:i,backend:s})=>{const{a:o,b:l}=i,c=s;nn([o,l],n);const u=c.data.get(o.dataId).values,f=c.data.get(l.dataId).values,m="string"===o.dtype?Cp(u):u,_="string"===o.dtype?Cp(f):f,y=r||o.dtype,[w,T]=t(o.shape,l.shape,m,_,y);return c.makeTensorInfo(T,y,w)}:({inputs:i,backend:s})=>{const{a:o,b:l}=i,c=s;if("complex64"===o.dtype||"complex64"===l.dtype){const u=S_({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),f=c.data.get(u.dataId),_=f.complexTensorInfos.imag,y=c.data.get(f.complexTensorInfos.real.dataId).values,w=c.data.get(_.dataId).values,T=S_({inputs:{x:l},backend:c,attrs:{dtype:"complex64"}}),I=c.data.get(T.dataId),A=I.complexTensorInfos.imag,M=c.data.get(I.complexTensorInfos.real.dataId).values,O=c.data.get(A.dataId).values,[$,V,Z]=e(o.shape,l.shape,y,w,M,O),Q=c.makeTensorInfo(Z,"float32",$),re=c.makeTensorInfo(Z,"float32",V),oe=Pl({inputs:{real:Q,imag:re},backend:c});return c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(T),c.disposeIntermediateTensorInfo(Q),c.disposeIntermediateTensorInfo(re),oe}{const u=c.data.get(o.dataId).values,f=c.data.get(l.dataId).values,m=r||o.dtype,[_,y]=t(o.shape,l.shape,u,f,m);return c.makeTensorInfo(y,m,_)}}}function h9(n){return(t,e,r,i,s,o)=>{const l=Bn(t,e),c=Ye(l),u=l.length,f=pn(l),m=vo("float32",c),_=vo("float32",c),y=uT(t,l),w=uT(e,l),T=wp(r,i),I=wp(s,o),E=t.length,A=pn(t),M=e.length,O=pn(e);if(y.length+w.length===0)for(let $=0;$<m.length;$++){const V=$%T.length,Z=$%I.length,Q=n(T[2*V],T[2*V+1],I[2*Z],I[2*Z+1]);m[$]=Q.real,_[$]=Q.imag}else for(let $=0;$<m.length;$++){const V=JI($,u,f),Z=V.slice(-E);y.forEach(Ve=>Z[Ve]=0);const Q=gh(Z,E,A),re=V.slice(-M);w.forEach(Ve=>re[Ve]=0);const oe=gh(re,M,O),ye=n(T[2*Q],T[2*Q+1],I[2*oe],I[2*oe+1]);m[$]=ye.real,_[$]=ye.imag}return[m,_,l]}}const $fe=os((n,t)=>n+t),Xqe=h9((n,t,e,r)=>({real:n+e,imag:t+r})),ET=Ps(eT,$fe,Xqe),Jqe={kernelName:eT,backendName:"cpu",kernelFunc:ET};function ri(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{shape:s}=r,o=Ye(i.shape),l=Dle(s,o),c=Ye(l);G(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),e.incRef(i.dataId);const u=e.data.get(i.dataId);if(null!=u.complexTensorInfos){const m=u.complexTensorInfos.imag;u.complexTensorInfos.real.shape=l,m.shape=l}return{dataId:i.dataId,shape:l,dtype:i.dtype}}const e5e={kernelName:jB,backendName:"cpu",kernelFunc:ri};function Bfe(n){const{inputs:t,backend:e,attrs:r}=n,{a:i,b:s}=t,{transposeA:o,transposeB:l}=r;nn([i,s],"matMul");const c=i.shape.length,u=s.shape.length,f=o?i.shape[c-2]:i.shape[c-1],m=l?s.shape[u-1]:s.shape[u-2],_=o?i.shape[c-1]:i.shape[c-2],y=l?s.shape[u-2]:s.shape[u-1],w=i.shape.slice(0,-2),T=s.shape.slice(0,-2),I=Ye(w),E=Ye(T),M=Bn(i.shape.slice(0,-2),s.shape.slice(0,-2)).concat([_,y]);G(f===m,()=>`Error in matMul: inner shapes (${f}) and (${m}) of Tensors with shapes ${i.shape} and ${s.shape} and transposeA=${o} and transposeB=${l} must match.`);const $=l?[E,y,m]:[E,m,y],V=ri({inputs:{x:i},backend:e,attrs:{shape:o?[I,f,_]:[I,_,f]}}),Z=ri({inputs:{x:s},backend:e,attrs:{shape:$}}),Q=o?V.shape[1]:V.shape[2],re=o?V.shape[2]:V.shape[1],oe=l?Z.shape[1]:Z.shape[2],ye=Math.max(I,E),Ve=e.data.get(V.dataId).values,We=e.data.get(Z.dataId).values,Ke=pn(V.shape),Qe=pn(Z.shape),[ge,we,_e]=o?[Ke[0],1,Ke[1]]:[Ke[0],Ke[1],1],[ze,it,ht]=l?[1,Qe[1],Qe[0]]:[Qe[1],1,Qe[0]],bt=re*oe,_t=qn([ye,re,oe],V.dtype),xt=_t.values,At=e.blockSize;for(let qt=0;qt<ye;qt++){const Ht=qt%I,mn=qt%E;for(let rn=0;rn<re;rn+=At){const On=Math.min(rn+At,re);for(let Vn=0;Vn<oe;Vn+=At){const $r=Math.min(Vn+At,oe);for(let ii=0;ii<Q;ii+=At){const Wi=Math.min(ii+At,Q);for(let si=rn;si<On;si++)for(let Zr=Vn;Zr<$r;Zr++){let $i=0;for(let ki=ii;ki<Wi;ki++)$i+=Ve[Ht*ge+si*we+ki*_e]*We[ki*ze+Zr*it+mn*ht];xt[qt*bt+(si*oe+Zr)]+=$i}}}}}return e.disposeIntermediateTensorInfo(V),e.disposeIntermediateTensorInfo(Z),e.makeTensorInfo(M,_t.dtype,_t.values)}const t5e={kernelName:cB,backendName:"cpu",kernelFunc:Bfe},r5e={kernelName:oV,backendName:"cpu",kernelFunc:function n5e(n){const{inputs:t,backend:e,attrs:r}=n,{a:i,b:s,bias:o,preluActivationWeights:l}=t,{transposeA:c,transposeB:u,activation:f,leakyreluAlpha:m}=r;let _,y,w;const T=[];_=Bfe({inputs:{a:i,b:s},attrs:{transposeA:c,transposeB:u},backend:e}),o&&(y=ET({inputs:{a:_,b:o},backend:e}),T.push(_),_=y),f&&(w=k3(e,_,f,l,m),T.push(_),_=w);for(const E of T)e.disposeIntermediateTensorInfo(E);return _}};function Vfe(n){const t=new Float32Array(n.length);for(let e=0;e<n.length;++e)t[e]=Math.abs(n[e]);return t}const i5e={kernelName:rB,backendName:"cpu",kernelFunc:n=>{const{x:t}=n.inputs,e=n.backend;nn(t,"abs");let r=new Float32Array(Ye(t.shape));return r=Vfe(e.data.get(t.dataId).values),e.makeOutput(r,t.shape,t.dtype)}},s5e=Lr(H1,n=>Math.acos(n)),o5e={kernelName:H1,backendName:"cpu",kernelFunc:s5e},a5e=Lr(G1,n=>Math.acosh(n)),l5e={kernelName:G1,backendName:"cpu",kernelFunc:a5e},u5e={kernelName:iB,backendName:"cpu",kernelFunc:function c5e(n){const{inputs:t,backend:e}=n,r=t;nn(t,"addN");const i=r.map(l=>e.data.get(l.dataId).values),s=qn(r[0].shape,r[0].dtype),o=s.values;for(let l=0;l<r.length;l++){const c=i[l];for(let u=0;u<o.length;u++)o[u]+=c[u]}return e.makeTensorInfo(s.shape,s.dtype,s.values)}};function f9(n,t,e,r,i){const s=t.length,o=Ye(t),l=pn(t),c=pn(i),u=vo(e,Ye(i));for(let f=0;f<o;++f){const m=JI(f,s,l),_=new Array(m.length);for(let w=0;w<_.length;w++)_[w]=m[r[w]];u[gh(_,s,c)]=n[f]}return u}function tl(n){const{inputs:t,attrs:e,backend:r}=n,{x:i}=t,{perm:s}=e;nn(i,"transpose");const l=new Array(i.shape.length);for(let m=0;m<l.length;m++)l[m]=i.shape[s[m]];const u=f9(r.data.get(i.dataId).values,i.shape,i.dtype,s,l);return{dataId:r.write(u,l,i.dtype),shape:l,dtype:i.dtype}}const d5e={kernelName:tT,backendName:"cpu",kernelFunc:tl},f5e={kernelName:"All",backendName:"cpu",kernelFunc:function h5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;nn(i,"all");const l=Kn(s,i.shape);let c=l;const u=Pi(c,i.shape.length);let f=i;null!=u&&(f=tl({inputs:{x:i},backend:e,attrs:{perm:u}}),c=is(c.length,i.shape.length)),Co("all",c,f.shape.length);const[m,_]=Ks(f.shape,c),y=Ye(_),w=Qo(Ye(m),f.dtype),T=e.data.get(f.dataId).values;for(let E=0;E<w.length;++E){const A=E*y;let M=T[A];for(let O=0;O<y;++O){const $=T[A+O];M=M&&$}w[E]=M}null!=u&&e.disposeIntermediateTensorInfo(f);const I=e.makeTensorInfo(m,f.dtype,w);if(o){const A=ri({inputs:{x:I},backend:e,attrs:{shape:rs(m,l)}});return e.disposeIntermediateTensorInfo(I),A}return I}},m5e={kernelName:"Any",backendName:"cpu",kernelFunc:function p5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;nn(i,"any");const l=Kn(s,i.shape);let c=l;const u=Pi(c,i.shape.length);let f=i;null!=u&&(f=tl({inputs:{x:i},backend:e,attrs:{perm:u}}),c=is(c.length,i.shape.length)),Co("any",c,f.shape.length);const[m,_]=Ks(f.shape,c),y=Ye(_),w=Qo(Ye(m),f.dtype),T=e.data.get(f.dataId).values;for(let E=0;E<w.length;++E){const A=E*y;let M=T[A];for(let O=0;O<y;++O){const $=T[A+O];M=M||$}w[E]=M}null!=u&&e.disposeIntermediateTensorInfo(f);const I=e.makeTensorInfo(m,f.dtype,w);if(o){const A=ri({inputs:{x:I},backend:e,attrs:{shape:rs(m,l)}});return e.disposeIntermediateTensorInfo(I),A}return I}},_5e={kernelName:sB,backendName:"cpu",kernelFunc:function g5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s}=r;nn(i,"argMax");let o=Kn(s,i.shape);const l=Pi(o,i.shape.length);let c=i;const u=[];null!=l&&(c=tl({inputs:{x:i},backend:e,attrs:{perm:l}}),u.push(c),o=is(o.length,c.shape.length)),o=[o[0]],Co("argMax",o,c.shape.length);const[f,m]=Ks(c.shape,o),y=Qo(Ye(f),"int32"),w=Ye(m),T=e.data.get(c.dataId).values;for(let I=0;I<y.length;++I){const E=I*w;let A=T[E],M=0;for(let O=0;O<w;++O){const $=T[E+O];$>A&&(A=$,M=O)}y[I]=M}return u.forEach(I=>e.disposeIntermediateTensorInfo(I)),e.makeTensorInfo(f,"int32",y)}},v5e={kernelName:oB,backendName:"cpu",kernelFunc:function y5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s}=r;nn(i,"argMin");let o=Kn(s,i.shape);const l=Pi(o,i.shape.length);let c=i;const u=[];null!=l&&(c=tl({inputs:{x:i},backend:e,attrs:{perm:l}}),u.push(c),o=is(o.length,c.shape.length)),o=[o[0]],Co("argMin",o,c.shape.length);const[f,m]=Ks(c.shape,o),y=Qo(Ye(f),"int32"),w=Ye(m),T=e.data.get(c.dataId).values;for(let I=0;I<y.length;++I){const E=I*w;let A=T[E],M=0;for(let O=0;O<w;++O){const $=T[E+O];$<A&&(A=$,M=O)}y[I]=M}return u.forEach(I=>e.disposeIntermediateTensorInfo(I)),e.makeTensorInfo(f,"int32",y)}},b5e=Lr(W1,n=>Math.asin(n)),w5e={kernelName:W1,backendName:"cpu",kernelFunc:b5e},C5e=Lr(j1,n=>Math.asinh(n)),x5e={kernelName:j1,backendName:"cpu",kernelFunc:C5e},I5e=Lr(q1,n=>Math.atan(n)),T5e={kernelName:q1,backendName:"cpu",kernelFunc:I5e},S5e=os((n,t)=>Math.atan2(n,t)),E5e=Ps(Y1,S5e),D5e={kernelName:Y1,backendName:"cpu",kernelFunc:E5e},k5e=Lr(Z1,n=>Math.atanh(n)),A5e={kernelName:Z1,backendName:"cpu",kernelFunc:k5e};function p9(n,t,e,r,i,s){const o=i.strideHeight,l=i.strideWidth,c=i.dilationHeight,u=i.dilationWidth,f=i.effectiveFilterHeight,m=i.effectiveFilterWidth,_=i.padInfo.top,y=i.padInfo.left,w="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,T=qn(i.outShape,e),I=T.values,E=i.outShape[1]*i.outShape[2]*i.outShape[3],A=i.outShape[2]*i.outShape[3],M=i.outShape[3];for(let O=0;O<i.batchSize;++O){const $=O*E,V=O*r[0];for(let Z=0;Z<i.inChannels;++Z)for(let Q=0;Q<i.outHeight;++Q){const re=Q*o-_,oe=Math.max(0,re),ye=Math.min(i.inHeight,f+re),Ve=$+Q*A;for(let We=0;We<i.outWidth;++We){const Ke=We*l-y,Qe=Math.max(0,Ke),ge=Math.min(i.inWidth,m+Ke);let we=w,_e=0,ze=0;for(let ht=oe;ht<ye;ht+=c){const bt=V+ht*r[1];for(let _t=Qe;_t<ge;_t+=u){const At=n[bt+_t*r[2]+Z];"max"===s&&At>we?we=At:"avg"===s&&(_e+=At,ze++)}if(isNaN(we))break}I[Ve+We*M+Z]="avg"===s?_e/ze:we}}}return T}function Ufe(n,t,e,r,i=!1,s=!1){const o=qn(r.outShape,"int32"),l=r.strideHeight,c=r.strideWidth,u=r.dilationHeight,f=r.dilationWidth,m=r.effectiveFilterHeight,_=r.effectiveFilterWidth,y=r.padInfo.top,w=r.padInfo.left,T=qn(t,e,n);for(let I=0;I<r.batchSize;++I)for(let E=0;E<r.inChannels;++E)for(let A=0;A<r.outHeight;++A){const M=A*l-y;let O=M;for(;O<0;)O+=u;const $=Math.min(r.inHeight,m+M);for(let V=0;V<r.outWidth;++V){const Z=V*c-w;let Q=Z;for(;Q<0;)Q+=f;const re=Math.min(r.inWidth,_+Z);let oe=Number.NEGATIVE_INFINITY,ye=-1;for(let Ve=O;Ve<$;Ve+=u){const We=Ve-M;for(let Ke=Q;Ke<re;Ke+=f){const Qe=Ke-Z,ge=T.get(I,Ve,Ke,E);ge>oe&&(oe=ge,ye=i?s?((I*r.inHeight+Ve)*r.inWidth+Ke)*r.inChannels+E:(Ve*r.inWidth+Ke)*r.inChannels+E:We*_+Qe)}}o.set(ye,I,A,V,E)}}return o}function zfe(n,t,e,r,i,s){const o=i.strideDepth,l=i.strideHeight,c=i.strideWidth,u=i.dilationDepth,f=i.dilationHeight,m=i.dilationWidth,_=i.effectiveFilterDepth,y=i.effectiveFilterHeight,w=i.effectiveFilterWidth,T=i.padInfo.front,I=i.padInfo.top,E=i.padInfo.left,A="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,M=qn(i.outShape,e),O=M.values,$=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],V=i.outShape[2]*i.outShape[3]*i.outShape[4],Z=i.outShape[3]*i.outShape[4],Q=i.outShape[4];for(let re=0;re<i.batchSize;++re){const oe=re*$,ye=re*r[0];for(let Ve=0;Ve<i.inChannels;++Ve)for(let We=0;We<i.outDepth;++We){const Ke=We*o-T;let Qe=Ke;for(;Qe<0;)Qe+=u;const ge=Math.min(i.inDepth,_+Ke),we=oe+We*V;for(let _e=0;_e<i.outHeight;++_e){const ze=_e*l-I;let it=ze;for(;it<0;)it+=f;const ht=Math.min(i.inHeight,y+ze),bt=we+_e*Z;for(let _t=0;_t<i.outWidth;++_t){const xt=_t*c-E;let At=xt;for(;At<0;)At+=m;const qt=Math.min(i.inWidth,w+xt),Ht=bt+_t*Q;let mn=A,rn=0,On=0;for(let $r=Qe;$r<ge;$r+=u){const ii=ye+$r*r[1];for(let Wi=it;Wi<ht;Wi+=f){const si=ii+Wi*r[2];for(let Zr=At;Zr<qt;Zr+=m){const ki=n[si+Zr*r[3]+Ve];if("max"===s&&ki>mn?mn=ki:"avg"===s&&(rn+=ki,On++),isNaN(mn))break}if(isNaN(mn))break}if(isNaN(mn))break}O[Ht+Ve]="avg"===s?rn/Math.max(On,1):mn}}}}return M}const M5e={kernelName:aB,backendName:"cpu",kernelFunc:function R5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;nn(i,"avgPool");const{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;G(wo(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const f=ou(i.shape,s,o,1,l,c);let m;if(1===f.filterWidth&&1===f.filterHeight&&dr(f.inShape,f.outShape))m=Ah({inputs:{x:i},backend:e});else{const _=e.data.get(i.dataId).values,y=pn(i.shape),w=p9(_,0,i.dtype,y,f,"avg");m=e.makeTensorInfo(f.outShape,i.dtype,w.values)}return m}},F5e={kernelName:lB,backendName:"cpu",kernelFunc:function O5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=r;nn(i,"avgPool3d");const f=yp(i.shape,s,o,1,l,c,u),_=zfe(e.data.get(i.dataId).values,0,i.dtype,pn(i.shape),f,"avg");return e.makeTensorInfo(_.shape,"float32",_.values)}},L5e={kernelName:q5,backendName:"cpu",kernelFunc:function P5e(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r;nn([i,s],"avgPool3DGrad");const f=yp(s.shape,o,l,1,c,u),m=f.strideDepth,_=f.strideHeight,y=f.strideWidth,w=f.filterDepth,T=f.filterHeight,I=f.filterWidth,E=f.dilationDepth,A=f.dilationHeight,M=f.dilationWidth,O=f.effectiveFilterDepth,$=f.effectiveFilterHeight,V=f.effectiveFilterWidth,Z=O-1-f.padInfo.front,Q=V-1-f.padInfo.left,re=$-1-f.padInfo.top,oe=qn(s.shape,"float32"),ye=1/(w*T*I),Ve=e.bufferSync(i);for(let We=0;We<f.batchSize;++We)for(let Ke=0;Ke<f.inChannels;++Ke)for(let Qe=0;Qe<f.inDepth;++Qe)for(let ge=0;ge<f.inHeight;++ge)for(let we=0;we<f.inWidth;++we){const _e=Qe-Z,ze=ge-re,it=we-Q;let ht=0;for(let bt=0;bt<O;bt+=E){const _t=(_e+bt)/m;if(!(_t<0||_t>=f.outDepth||Math.floor(_t)!==_t))for(let xt=0;xt<$;xt+=A){const At=(ze+xt)/_;if(!(At<0||At>=f.outHeight||Math.floor(At)!==At))for(let qt=0;qt<V;qt+=M){const Ht=(it+qt)/y;Ht<0||Ht>=f.outWidth||Math.floor(Ht)!==Ht||(ht+=Ve.get(We,_t,At,Ht,Ke))}}}oe.set(ht*ye,We,Qe,ge,we,Ke)}return e.makeTensorInfo(oe.shape,oe.dtype,oe.values)}},B5e={kernelName:j5,backendName:"cpu",kernelFunc:function $5e(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,o=s;nn([i,s],"avgPoolGrad");const{filterSize:l,strides:c,pad:u}=r,f=ou(o.shape,l,c,1,u),m=f.strideHeight,_=f.strideWidth,y=f.filterHeight,w=f.filterWidth,T=f.dilationHeight,I=f.dilationWidth,E=f.effectiveFilterHeight,A=f.effectiveFilterWidth,M=A-1-f.padInfo.left,O=E-1-f.padInfo.top,$=qn(o.shape,"float32"),V=1/(y*w),Z=e.data.get(i.dataId).values,Q=qn(i.shape,"float32",Z);for(let re=0;re<f.batchSize;++re)for(let oe=0;oe<f.inChannels;++oe)for(let ye=0;ye<f.inHeight;++ye)for(let Ve=0;Ve<f.inWidth;++Ve){const We=ye-O,Ke=Ve-M;let Qe=0;for(let ge=0;ge<E;ge+=T){const we=(We+ge)/m;if(!(we<0||we>=f.outHeight||Math.floor(we)!==we))for(let _e=0;_e<A;_e+=I){const ze=(Ke+_e)/_;ze<0||ze>=f.outWidth||Math.floor(ze)!==ze||(Qe+=Q.get(re,we,ze,oe))}}$.set(Qe*V,re,ye,Ve,oe)}return e.makeTensorInfo($.shape,$.dtype,$.values)}},U5e={kernelName:CB,backendName:"cpu",kernelFunc:function V5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,scale:s,offset:o,mean:l,variance:c}=t;G(l.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),G(null==o||l.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),G(null==s||l.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),nn([i,l,c,s,o],"batchNorm");let{varianceEpsilon:u}=r;null==u&&(u=.001);const f=e.data.get(i.dataId).values,m=e.data.get(l.dataId).values,_=e.data.get(c.dataId).values,y=s?e.data.get(s.dataId).values:new Float32Array([1]),w=o?e.data.get(o.dataId).values:new Float32Array([0]),T=new Float32Array(f.length),I=w.length,E=y.length,A=_.length,M=m.length;let O=0,$=0,V=0,Z=0;for(let Q=0;Q<f.length;++Q)T[Q]=w[O++]+(f[Q]-m[$++])*y[V++]/Math.sqrt(_[Z++]+u),O>=I&&(O=0),$>=M&&($=0),V>=E&&(V=0),Z>=A&&(Z=0);return e.makeTensorInfo(i.shape,i.dtype,T)}};function Hfe(n,t,e,r,i){const s=B8(r,t,e),o=Ye(e),l=pn(r);if(s){const m=V8(t,l);return"string"===i?n.slice(m,m+o):n.subarray(m,m+o)}const u=qn(r,i,"string"===i?Cp(n):n),f=qn(e,i);for(let m=0;m<f.size;++m){const _=f.indexToLoc(m),y=_.map((w,T)=>w+t[T]);f.set(u.get(...y),..._)}return"string"===i?Ede(f.values):f.values}function f0(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{begin:s,size:o}=r;nn(i,"slice");const[l,c]=CV(i,s,o);L8(i,l,c);const f=Hfe(e.data.get(i.dataId).values,l,c,i.shape,i.dtype);return e.makeTensorInfo(c,i.dtype,f)}const z5e={kernelName:QB,backendName:"cpu",kernelFunc:f0},G5e={kernelName:uB,backendName:"cpu",kernelFunc:function H5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockShape:s,crops:o}=r;nn([i],"batchToSpaceND");const l=s.reduce((E,A)=>E*A),c=iR(i.shape,s,l),u=sR(c.length,s.length),f=oR(i.shape,s,l),m=$Y(o,s.length),_=BY(f,o,s.length),y=ri({inputs:{x:i},backend:e,attrs:{shape:c}}),w=tl({inputs:{x:y},backend:e,attrs:{perm:u}}),T=ri({inputs:{x:w},backend:e,attrs:{shape:f}}),I=f0({inputs:{x:T},backend:e,attrs:{begin:m,size:_}});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(T),I}};function m9(n,t,e,r,i){const s=Ye(r),o=Qo(i,e);for(let l=0;l<n.length;l++){const c=n[l];if(c<0)throw new Error("Input x must be non-negative!");c>=i||(o[c]+=s>0?t[l]:1)}return o}function Gfe(n,t,e,r=!1){const i=n.shape[0],s=n.shape[1],o=qn([i,e],t.dtype);for(let l=0;l<i;l++)for(let c=0;c<s;c++){const u=n.get(l,c);if(u<0)throw new Error("Input x must be non-negative!");u>=e||o.set(r?1:t.size>0?o.get(l,u)+t.get(l,c):o.get(l,u)+1,l,u)}return o}const j5e={kernelName:Z5,backendName:"cpu",kernelFunc:function W5e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,weights:s}=t,{size:o}=r,u=m9(e.data.get(i.dataId).values,e.data.get(s.dataId).values,s.dtype,s.shape,o);return e.makeTensorInfo([o],s.dtype,u)}},Wfe=os((n,t)=>n&t),q5e=Ps(dB,Wfe),Z5e={kernelName:dB,backendName:"cpu",kernelFunc:q5e},K5e={kernelName:Y5,backendName:"cpu",kernelFunc:function Y5e(n){const{inputs:t,backend:e}=n,{s0:r,s1:i}=t,s=e.data.get(r.dataId).values,o=e.data.get(i.dataId).values,l=Bn(Array.from(s),Array.from(o));return e.makeTensorInfo([l.length],"int32",Int32Array.from(l))}},jfe=kh(n=>Math.ceil(n)),Q5e=T_(Q1,jfe),X5e={kernelName:Q1,backendName:"cpu",kernelFunc:Q5e},J5e=Lr(X1,(n,t)=>n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n),eZe={kernelName:X1,backendName:"cpu",kernelFunc:J5e},tZe={kernelName:hB,backendName:"cpu",kernelFunc:n=>{const{x:t}=n.inputs,e=n.backend,r=new Float32Array(Ye(t.shape)),i=e.data.get(t.dataId),o=i.complexTensorInfos.imag,l=e.data.get(i.complexTensorInfos.real.dataId).values,c=e.data.get(o.dataId).values;for(let u=0;u<l.length;u++)r[u]=Math.hypot(l[u],c[u]);return e.makeOutput(r,t.shape,"float32")}};function qfe(n,t,e,r){const i=ns(e,Ye(t));if(r&&"string"!==e){let s=0;n.forEach(o=>{const l=Ye(o.shape);i.set(o.vals,s),s+=l})}else{let s=0;n.forEach(o=>{const l="string"===e?Cp(o.vals):o.vals;let c=0;for(let u=0;u<o.shape[0];++u){const f=u*t[1]+s;for(let m=0;m<o.shape[1];++m)i[f+m]=l[c++]}s+=o.shape[1]})}return i}function DT(n){const{inputs:t,backend:e}=n,{input:r}=t,i=e.data.get(r.dataId).complexTensorInfos.imag,s=e.data.get(i.dataId).values;return e.makeTensorInfo(i.shape,i.dtype,s)}const nZe={kernelName:_Z,backendName:"cpu",kernelFunc:DT};function kT(n){const{inputs:t,backend:e,attrs:r}=n,{axis:i}=r,s=Kn(i,t[0].shape)[0];FY(t.map(T=>T.shape),s);let l=Ch(t.map(T=>T.shape),s);if(0===Ye(l))return e.makeTensorInfo(l,t[0].dtype,[]);const c=t.filter(T=>Ye(T.shape)>0);if(1===c.length)return Ah({inputs:{x:c[0]},backend:e});if("complex64"===c[0].dtype){const T=c.map(O=>h0({inputs:{input:O},backend:e})),I=c.map(O=>DT({inputs:{input:O},backend:e})),E=kT({inputs:T,backend:e,attrs:{axis:s}}),A=kT({inputs:I,backend:e,attrs:{axis:s}}),M=Pl({inputs:{real:E,imag:A},backend:e});return T.forEach(O=>e.disposeIntermediateTensorInfo(O)),I.forEach(O=>e.disposeIntermediateTensorInfo(O)),e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(A),M}const u=c.map(T=>{const I=Ye(T.shape.slice(s));return ri({inputs:{x:T},backend:e,attrs:{shape:[-1,I]}})}),f=u.map(T=>({vals:e.data.get(T.dataId).values,shape:T.shape}));l=Ch(u.map(T=>T.shape),1);const _=qfe(f,l,t[0].dtype,1===u[0].shape[0]),y=Ch(c.map(T=>T.shape),s),w=e.makeTensorInfo(y,t[0].dtype,_);return u.forEach(T=>e.disposeIntermediateTensorInfo(T)),w}const rZe={kernelName:fB,backendName:"cpu",kernelFunc:kT};function Zfe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:l,dataFormat:c,dilations:u,dimRoundingMode:f}=r;nn([i,s],"conv2d");const m=vp(c),_=Ys(i.shape,s.shape,o,u,l,f,!1,m),y=_.filterHeight,w=_.filterWidth,T=_.dilationHeight,I=_.dilationWidth,E=_.padInfo.left,A=_.padInfo.top,M="channelsLast"===_.dataFormat,O=new Ds(_.outShape,i.dtype),$=pn(i.shape),V=pn(s.shape),Z=$[0],Q=M?$[1]:$[2],re=M?$[2]:1,oe=M?1:$[1],ye=O.strides[0],Ve=M?O.strides[1]:O.strides[2],We=M?O.strides[2]:1,Ke=M?1:O.strides[1],Qe=e.data.get(i.dataId).values,ge=e.data.get(s.dataId).values,we=O.values;for(let _e=0;_e<_.batchSize;++_e){const ze=_e*Z,it=_e*ye;for(let ht=0;ht<_.outHeight;++ht){const bt=it+ht*Ve,_t=ht*_.strideHeight-A;for(let xt=0;xt<y;++xt){const At=_t+xt*T;if(At<0||At>=_.inHeight)continue;const qt=xt*V[0],Ht=ze+At*Q;for(let mn=0;mn<_.outWidth;++mn){const rn=bt+mn*We,On=mn*_.strideWidth-E;for(let Vn=0;Vn<w;++Vn){const $r=On+Vn*I;if($r<0||$r>=_.inWidth)continue;const Wi=Ht+$r*re;let si=qt+Vn*V[1];for(let Zr=0;Zr<_.inChannels;++Zr){const $i=Qe[Wi+Zr*oe];for(let ki=0;ki<_.outChannels;++ki)we[rn+ki*Ke]+=$i*ge[si+ki];si+=_.outChannels}}}}}}return e.makeTensorInfo(O.shape,O.dtype,we)}const iZe={kernelName:pB,backendName:"cpu",kernelFunc:Zfe},oZe={kernelName:Q5,backendName:"cpu",kernelFunc:function sZe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,pad:l,dataFormat:c,dimRoundingMode:u,filterShape:f}=r;nn([i,s],"conv2dBackpropFilter");const m=vp(c),_=Ys(i.shape,f,o,1,l,u,!1,m),{strideHeight:y,strideWidth:w,filterHeight:T,filterWidth:I}=_,E="channelsLast"===_.dataFormat,A=new Ds(_.filterShape,"float32"),M=_.padInfo.left,O=_.padInfo.top,$=e.data.get(i.dataId).values,V=e.data.get(s.dataId).values,Z=new Ds(i.shape,i.dtype,$),Q=new Ds(s.shape,s.dtype,V);for(let re=0;re<T;++re){const oe=Math.max(0,Math.ceil((O-re)/y)),ye=Math.min(_.outHeight,(_.inHeight+O-re)/y);for(let Ve=0;Ve<I;++Ve){const We=Math.max(0,Math.ceil((M-Ve)/w)),Ke=Math.min(_.outWidth,(_.inWidth+M-Ve)/w);for(let Qe=0;Qe<_.inChannels;++Qe)for(let ge=0;ge<_.outChannels;++ge){let we=0;for(let _e=0;_e<_.batchSize;++_e)for(let ze=oe;ze<ye;++ze){const it=re+ze*y-O;for(let ht=We;ht<Ke;++ht){const bt=Ve+ht*w-M;we+=E?Z.get(_e,it,bt,Qe)*Q.get(_e,ze,ht,ge):Z.get(_e,Qe,it,bt)*Q.get(_e,ge,ze,ht)}}A.set(we,re,Ve,Qe,ge)}}}return e.makeTensorInfo(A.shape,A.dtype,A.values)}},lZe={kernelName:mB,backendName:"cpu",kernelFunc:function aZe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{inputShape:o,strides:l,pad:c,dataFormat:u,dimRoundingMode:f}=r;nn([i,s],"conv2dBackpropInput");const m=pn(s.shape),_=pn(i.shape);let y=vp(u);const w=Ys(o,s.shape,l,1,c,f,!1,y),T=new Ds(w.inShape,"float32"),I=T.values,E=e.data.get(i.dataId).values,A=e.data.get(s.dataId).values,[M,O,$]=m,{batchSize:V,filterHeight:Z,filterWidth:Q,inChannels:re,inHeight:oe,inWidth:ye,outChannels:Ve,outHeight:We,outWidth:Ke,strideHeight:Qe,strideWidth:ge}=w;y=w.dataFormat;const we=Z-1-w.padInfo.top,_e=Q-1-w.padInfo.left,ze="channelsLast"===y,it=T.strides[0],ht=ze?T.strides[1]:T.strides[2],bt=ze?T.strides[2]:1,_t=ze?1:T.strides[1],xt=_[0],At=ze?_[1]:_[2],qt=ze?_[2]:1,Ht=ze?1:_[1];for(let mn=0;mn<V;++mn)for(let rn=0;rn<re;++rn)for(let On=0;On<oe;++On){const Vn=On-we,$r=Math.max(0,Math.ceil(Vn/Qe)),ii=Math.min(We,(Z+Vn)/Qe);for(let Wi=0;Wi<ye;++Wi){const si=Wi-_e,Zr=Math.max(0,Math.ceil(si/ge)),$i=Math.min(Ke,(Q+si)/ge);let ki=0;for(let To=$r;To<ii;++To){const N_=To*Qe-Vn;for(let bc=Zr;bc<$i;++bc){const fd=xt*mn+At*To+qt*bc,kp=M*(Z-1-N_)+O*(Q-1-(bc*ge-si))+$*rn;for(let R_=0;R_<Ve;++R_)ki+=E[fd+Ht*R_]*A[kp+R_]}}I[it*mn+ht*On+bt*Wi+_t*rn]=ki}}return e.makeTensorInfo(T.shape,T.dtype,T.values)}},uZe={kernelName:gB,backendName:"cpu",kernelFunc:function cZe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:l,dilations:c}=r;nn([i,s],"conv3d");const u=d_(i.shape,s.shape,o,c,l),{filterDepth:f,filterHeight:m,filterWidth:_,dilationDepth:y,dilationHeight:w,dilationWidth:T,padInfo:I}=u,E=I.front,A=I.left,M=I.top,O=new Ds(u.outShape,i.dtype),$=e.data.get(i.dataId).values,V=e.data.get(s.dataId).values,Z=O.values,Q=pn(i.shape),re=pn(s.shape);for(let oe=0;oe<u.batchSize;++oe){const ye=oe*Q[0],Ve=oe*O.strides[0];for(let We=0;We<u.outDepth;++We){const Ke=Ve+We*O.strides[1],Qe=We*u.strideDepth-E;for(let ge=0;ge<f;++ge){const we=Qe+ge*y;if(we<0||we>=u.inDepth)continue;const _e=ge*re[0],ze=ye+we*Q[1];for(let it=0;it<u.outHeight;++it){const ht=Ke+it*O.strides[2],bt=it*u.strideHeight-M;for(let _t=0;_t<m;++_t){const xt=bt+_t*w;if(xt<0||xt>=u.inHeight)continue;const At=_e+_t*re[1],qt=ze+xt*Q[2];for(let Ht=0;Ht<u.outWidth;++Ht){const mn=ht+Ht*u.outChannels,rn=Ht*u.strideWidth-A;for(let On=0;On<_;++On){const Vn=rn+On*T;if(Vn<0||Vn>=u.inWidth)continue;const ii=qt+Vn*u.inChannels;let Wi=At+On*re[2];for(let si=0;si<u.inChannels;++si){const Zr=$[ii+si];for(let $i=0;$i<u.outChannels;++$i)Z[mn+$i]+=Zr*V[Wi+$i];Wi+=u.outChannels}}}}}}}}return e.makeTensorInfo(O.shape,O.dtype,O.values)}},hZe={kernelName:X5,backendName:"cpu",kernelFunc:function dZe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,pad:l,filterShape:c}=r;nn([i,s],"conv3dBackpropFilterV2");const u=pn(i.shape),f=pn(s.shape),m=d_(i.shape,c,o,1,l),_=m.strideDepth,y=m.strideHeight,w=m.strideWidth,T=m.filterDepth,I=m.filterHeight,E=m.filterWidth,A=new Ds(m.filterShape,"float32"),M=A.values,[O,$,V,Z]=A.strides,Q=e.data.get(s.dataId).values,[re,oe,ye,Ve]=f,We=e.data.get(i.dataId).values,[Ke,Qe,ge,we]=u,_e=m.padInfo.front,ze=m.padInfo.left,it=m.padInfo.top;for(let ht=0;ht<T;++ht){const bt=Math.max(0,Math.ceil((_e-ht)/_)),_t=Math.min(m.outDepth,(m.inDepth+_e-ht)/_),xt=ht*O;for(let At=0;At<I;++At){const qt=Math.max(0,Math.ceil((it-At)/y)),Ht=Math.min(m.outHeight,(m.inHeight+it-At)/y),mn=At*$+xt;for(let rn=0;rn<E;++rn){const On=Math.max(0,Math.ceil((ze-rn)/w)),Vn=Math.min(m.outWidth,(m.inWidth+ze-rn)/w),$r=rn*V+mn;for(let ii=0;ii<m.inChannels;++ii){const Wi=ii*Z+$r;for(let si=0;si<m.outChannels;++si){let Zr=0;for(let $i=0;$i<m.batchSize;++$i){const ki=$i*Ke,Dp=$i*re;for(let To=bt;To<_t;++To){const bc=(ht+To*_-_e)*Qe+ki,w0=To*oe+Dp;for(let fd=qt;fd<Ht;++fd){const R_=(At+fd*y-it)*ge+bc,M_=fd*ye+w0;for(let O_=On;O_<Vn;++O_)Zr+=We[(rn+O_*w-ze)*we+R_+ii]*Q[O_*Ve+M_+si]}}}M[Wi+si]=Zr}}}}}return e.makeTensorInfo(A.shape,A.dtype,A.values)}},pZe={kernelName:J5,backendName:"cpu",kernelFunc:function fZe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{pad:o,strides:l,inputShape:c}=r;nn([i],"conv3dBackpropInputV2");const u=pn(i.shape),f=pn(s.shape),m=d_(c,s.shape,l,1,o),_=new Ds(m.inShape,"float32"),y=_.values,[w,T,I,E]=_.strides,A=e.data.get(i.dataId).values,[M,O,$,V]=u,Z=e.data.get(s.dataId).values,[Q,re,oe,ye]=f,{batchSize:Ve,filterDepth:We,filterHeight:Ke,filterWidth:Qe,inChannels:ge,inDepth:we,inHeight:_e,inWidth:ze,outChannels:it,outDepth:ht,outHeight:bt,outWidth:_t,strideDepth:xt,strideHeight:At,strideWidth:qt}=m,Ht=We-1-m.padInfo.front,mn=Ke-1-m.padInfo.top,rn=Qe-1-m.padInfo.left;for(let On=0;On<Ve;++On)for(let Vn=0;Vn<ge;++Vn)for(let $r=0;$r<we;++$r){const ii=$r-Ht,Wi=Math.max(0,Math.ceil(ii/xt)),si=Math.min(ht,(We+ii)/xt);for(let Zr=0;Zr<_e;++Zr){const $i=Zr-mn,ki=Math.max(0,Math.ceil($i/At)),Dp=Math.min(bt,(Ke+$i)/At);for(let To=0;To<ze;++To){const N_=To-rn,bc=Math.max(0,Math.ceil(N_/qt)),w0=Math.min(_t,(Qe+N_)/qt);let fd=0;for(let kp=Wi;kp<si;++kp){const R_=kp*xt-ii;for(let M_=ki;M_<Dp;++M_){const O_=M_*At-$i;for(let MR=bc;MR<w0;++MR){const U9=M*On+O*kp+$*M_+V*MR,Mlt=Q*(We-1-R_)+re*(Ke-1-O_)+oe*(Qe-1-(MR*qt-N_))+ye*Vn;for(let tU=0;tU<it;++tU)fd+=A[U9+tU]*Z[Mlt+tU]}}}y[w*On+T*$r+I*Zr+E*To+Vn]=fd}}}return e.makeTensorInfo(_.shape,_.dtype,_.values)}},mZe=Lr(J1,n=>Math.cos(n)),gZe={kernelName:J1,backendName:"cpu",kernelFunc:mZe},_Ze=Lr(eN,n=>Math.cosh(n)),yZe={kernelName:eN,backendName:"cpu",kernelFunc:_Ze},bZe={kernelName:tZ,backendName:"cpu",kernelFunc:function vZe(n){const{inputs:t,backend:e,attrs:r}=n,{image:i,boxes:s,boxInd:o}=t,{cropSize:l,method:c,extrapolationValue:u}=r,[f,m,_,y]=i.shape,w=s.shape[0],[T,I]=l,E=qn([w,T,I,y],"float32"),A=e.data.get(s.dataId).values,M=e.data.get(o.dataId).values,O=e.data.get(i.dataId).values,$=pn(i.shape),V=pn(E.shape);for(let Z=0;Z<w;Z++){const Q=4*Z,re=A[Q],oe=A[Q+1],ye=A[Q+2],Ve=A[Q+3],We=M[Z];if(We>=f)continue;const Ke=T>1?(ye-re)*(m-1)/(T-1):0,Qe=I>1?(Ve-oe)*(_-1)/(I-1):0;for(let ge=0;ge<T;ge++){const we=T>1?re*(m-1)+ge*Ke:.5*(re+ye)*(m-1);if(we<0||we>m-1)for(let _e=0;_e<I;_e++)for(let ze=0;ze<y;ze++)E.values[ze+_e*V[2]+ge*V[1]+Z*V[0]]=u;else if("bilinear"===c){const _e=Math.floor(we),ze=Math.ceil(we),it=we-_e;for(let ht=0;ht<I;ht++){const bt=I>1?oe*(_-1)+ht*Qe:.5*(oe+Ve)*(_-1);if(bt<0||bt>_-1){for(let qt=0;qt<y;qt++)E.values[qt+ht*V[2]+ge*V[1]+Z*V[0]]=u;continue}const _t=Math.floor(bt),xt=Math.ceil(bt),At=bt-_t;for(let qt=0;qt<y;qt++){let Ht=qt+_t*$[2]+_e*$[1]+We*$[0];const mn=O[Ht];Ht=qt+xt*$[2]+_e*$[1]+We*$[0];const rn=O[Ht];Ht=qt+_t*$[2]+ze*$[1]+We*$[0];const On=O[Ht];Ht=qt+xt*$[2]+ze*$[1]+We*$[0];const Vn=O[Ht],$r=mn+(rn-mn)*At;Ht=qt+ht*V[2]+ge*V[1]+Z*V[0],E.values[Ht]=$r+(On+(Vn-On)*At-$r)*it}}}else for(let _e=0;_e<I;++_e){const ze=I>1?oe*(_-1)+_e*Qe:.5*(oe+Ve)*(_-1);if(ze<0||ze>_-1){for(let bt=0;bt<y;bt++)E.values[bt+_e*V[2]+ge*V[1]+Z*V[0]]=u;continue}const it=Math.round(ze),ht=Math.round(we);for(let bt=0;bt<y;bt++)E.values[bt+_e*V[2]+ge*V[1]+Z*V[0]]=O[bt+it*$[2]+ht*$[1]+We*$[0]]}}}return e.makeTensorInfo(E.shape,E.dtype,E.values)}},CZe={kernelName:eZ,backendName:"cpu",kernelFunc:function wZe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,exclusive:o,reverse:l}=r;nn(i,"cumprod");const c=Pi([s],i.shape.length);let u=i;null!=c&&(u=tl({inputs:{x:i},backend:e,attrs:{perm:c}}));const f=is(1,i.shape.length)[0];if(f!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${f}`);const m=Dl(u.dtype,"int32"),_=U5(Ye(u.shape),m),y=e.data.get(u.dataId).values,w=u.shape[u.shape.length-1],T=l?(E,A)=>E+w-A-1:(E,A)=>E+A;for(let E=0;E<y.length;E+=w)for(let A=0;A<w;A++){const M=T(E,A);if(0===A)_[M]=o?1:y[M];else{const O=T(E,A-1);_[M]=o?y[O]*_[O]:y[M]*_[O]}}const I=e.makeTensorInfo(u.shape,m,_);if(null!=c){const A=tl({inputs:{x:I},backend:e,attrs:{perm:p_(c)}});return e.disposeIntermediateTensorInfo(I),e.disposeIntermediateTensorInfo(u),A}return I}},IZe={kernelName:_B,backendName:"cpu",kernelFunc:function xZe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,exclusive:o,reverse:l}=r;nn(i,"cumsum");const c=Pi([s],i.shape.length);let u=i;null!=c&&(u=tl({inputs:{x:i},backend:e,attrs:{perm:c}}));const f=is(1,i.shape.length)[0];if(f!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${f}`);const m=Dl(u.dtype,"int32"),_=Qo(Ye(u.shape),m),y=e.data.get(u.dataId).values,w=u.shape[u.shape.length-1],T=l?(E,A)=>E+w-A-1:(E,A)=>E+A;for(let E=0;E<y.length;E+=w)for(let A=0;A<w;A++){const M=T(E,A);if(0===A)_[M]=o?0:y[M];else{const O=T(E,A-1);_[M]=o?y[O]+_[O]:y[M]+_[O]}}const I=e.makeTensorInfo(u.shape,m,_);if(null!=c){const A=tl({inputs:{x:I},backend:e,attrs:{perm:p_(c)}});return e.disposeIntermediateTensorInfo(I),e.disposeIntermediateTensorInfo(u),A}return I}},SZe={kernelName:nZ,backendName:"cpu",kernelFunc:function TZe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,weights:s}=t,{size:o,binaryOutput:l}=r;if(1===i.shape.length){const f=m9(e.data.get(i.dataId).values,e.data.get(s.dataId).values,s.dtype,s.shape,o);return e.makeTensorInfo([o],s.dtype,f)}if(2===i.shape.length){const f=Gfe(e.bufferSync(i),e.bufferSync(s),o,l);return e.makeTensorInfo(f.shape,s.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}},DZe={kernelName:rZ,backendName:"cpu",kernelFunc:function EZe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockSize:s,dataFormat:o}=r;G("NHWC"===o,()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const l=i.shape[0],c=i.shape[1],u=i.shape[2],f=i.shape[3],m=c*s,_=u*s,y=f/(s*s),w=e.data.get(i.dataId).values,T=new Float32Array(l*m*_*y);let I=0;for(let E=0;E<l;++E)for(let A=0;A<m;++A){const M=Math.floor(A/s),O=A%s;for(let $=0;$<_;++$){const V=Math.floor($/s),Q=(O*s+$%s)*y;for(let re=0;re<y;++re)T[I++]=w[re+Q+f*(V+u*(M+c*E))]}}return e.makeTensorInfo([l,m,_,y],i.dtype,T)}};function Yfe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:l,dilations:c,dimRoundingMode:u}=r;nn([i,s],"depthwiseConv2DNative");const f=pn(i.shape),m=pn(s.shape);let _=c;null==_&&(_=[1,1]),G(wo(o,_),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${_}'`);const y=Ys(i.shape,s.shape,o,_,l,u,!0),{filterHeight:w,filterWidth:T,dilationHeight:I,dilationWidth:E,padInfo:A}=y,M=A.left,O=A.top,$=y.outChannels/y.inChannels,V=new Ds(y.outShape,i.dtype),Z=e.data.get(i.dataId).values,Q=e.data.get(s.dataId).values,re=V.values;for(let oe=0;oe<y.batchSize;++oe){const ye=oe*f[0],Ve=oe*V.strides[0];for(let We=0;We<y.outHeight;++We){const Ke=Ve+We*V.strides[1],Qe=We*y.strideHeight-O;for(let ge=0;ge<w;++ge){const we=Qe+ge*I;if(we<0||we>=y.inHeight)continue;const _e=ge*m[0],ze=ye+we*f[1];for(let it=0;it<y.outWidth;++it){const ht=Ke+it*V.strides[2],bt=it*y.strideWidth-M;for(let _t=0;_t<T;++_t){const xt=bt+_t*E;if(xt<0||xt>=y.inWidth)continue;const qt=ze+xt*y.inChannels;let Ht=ht,mn=_e+_t*m[1];for(let rn=0;rn<y.inChannels;++rn){const On=Z[qt+rn];for(let Vn=0;Vn<$;++Vn)re[Ht+Vn]+=On*Q[mn+Vn];Ht+=$,mn+=$}}}}}}return e.makeTensorInfo(V.shape,V.dtype,V.values)}const kZe={kernelName:yB,backendName:"cpu",kernelFunc:Yfe},NZe={kernelName:iZ,backendName:"cpu",kernelFunc:function AZe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,dilations:l,pad:c,dimRoundingMode:u,filterShape:f}=r;nn([i,s],"depthwiseConv2dNativeBackpropFilter");const m=Ys(i.shape,f,o,l,c,u,!0),{strideHeight:_,strideWidth:y,filterHeight:w,filterWidth:T}=m,I=new Ds(m.filterShape,"float32"),E=m.padInfo.left,A=m.padInfo.top,M=m.outChannels/m.inChannels,O=e.data.get(i.dataId).values,$=new Ds(i.shape,i.dtype,O),V=e.data.get(s.dataId).values,Z=new Ds(s.shape,s.dtype,V);for(let Q=0;Q<w;++Q){const re=Math.max(0,Math.ceil((A-Q)/_)),oe=Math.min(m.outHeight,(m.inHeight+A-Q)/_);for(let ye=0;ye<T;++ye){const Ve=Math.max(0,Math.ceil((E-ye)/y)),We=Math.min(m.outWidth,(m.inWidth+E-ye)/y);for(let Ke=0;Ke<m.outChannels;++Ke){const Qe=Math.trunc(Ke/M),ge=Ke%M;let we=0;for(let _e=0;_e<m.batchSize;++_e)for(let ze=re;ze<oe;++ze){const it=Q+ze*_-A;for(let ht=Ve;ht<We;++ht)we+=$.get(_e,it,ye+ht*y-E,Qe)*Z.get(_e,ze,ht,Ke)}I.set(we,Q,ye,Qe,ge)}}}return e.makeTensorInfo(I.shape,I.dtype,I.values)}},MZe={kernelName:sZ,backendName:"cpu",kernelFunc:function RZe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{strides:o,dilations:l,pad:c,dimRoundingMode:u,inputShape:f}=r;nn([i,s],"depthwiseConv2DNativeBackpropInput");const m=pn(i.shape),_=pn(s.shape),y=Ys(f,s.shape,o,l,c,u,!0),w=new Ds(y.inShape,"float32"),T=w.values,[I,E,A]=w.strides,M=e.data.get(i.dataId).values,[O,$,V]=m,Z=e.data.get(s.dataId).values,[Q,re,oe]=_,{batchSize:ye,filterHeight:Ve,filterWidth:We,inChannels:Ke,inHeight:Qe,inWidth:ge,outChannels:we,outHeight:_e,outWidth:ze,strideHeight:it,strideWidth:ht}=y,bt=Ve-1-y.padInfo.top,_t=We-1-y.padInfo.left,xt=we/Ke;for(let At=0;At<ye;++At)for(let qt=0;qt<Ke;++qt)for(let Ht=0;Ht<Qe;++Ht){const mn=Ht-bt,rn=Math.max(0,Math.ceil(mn/it)),On=Math.min(_e,(Ve+mn)/it);for(let Vn=0;Vn<ge;++Vn){const $r=Vn-_t,ii=Math.max(0,Math.ceil($r/ht)),Wi=Math.min(ze,(We+$r)/ht);let si=0;for(let Zr=rn;Zr<On;++Zr){const $i=Zr*it-mn;for(let ki=ii;ki<Wi;++ki){const To=O*At+$*Zr+V*ki,N_=Q*(Ve-1-$i)+re*(We-1-(ki*ht-$r))+oe*qt;for(let bc=0;bc<xt;++bc)si+=M[To+(qt*xt+bc)]*Z[N_+bc]}}T[I*At+E*Ht+A*Vn+qt]=si}}return e.makeTensorInfo(w.shape,w.dtype,w.values)}},FZe={kernelName:oZ,backendName:"cpu",kernelFunc:function OZe(n){const{inputs:t,backend:e}=n,{x:r}=t,i=Ye(r.shape),s=e.data.get(r.dataId).values,o=qn([i,i],r.dtype),l=o.values;for(let u=0;u<s.length;u++)l[u*i+u]=s[u];const c=[...r.shape,...r.shape];return e.makeTensorInfo(c,o.dtype,o.values)}},PZe={kernelName:vB,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r,filter:i}=n,{strides:s,pad:o,dilations:l}=e,c=t,u=c.data.get(r.dataId).values,f=r.shape.length,m=c.data.get(i.dataId).values,_=i.shape.length,{batchSize:y,inHeight:w,inWidth:T,inChannels:I,outHeight:E,outWidth:A,padInfo:M,strideHeight:O,strideWidth:$,filterHeight:V,filterWidth:Z,dilationHeight:Q,dilationWidth:re,outShape:oe}=HN(r.shape,i.shape,s,o,"NHWC",l),ye=Ye(oe),Ve=oe.length,We=ns(r.dtype,ye);for(let Qe=0;Qe<y;++Qe)for(let ge=0;ge<E;++ge){const we=ge*O-M.top;for(let _e=0;_e<A;++_e){const ze=_e*$-M.left;for(let it=0;it<I;++it){let ht=Number.MIN_SAFE_INTEGER;for(let _t=0;_t<V;++_t){const xt=we+_t*Q;if(xt>=0&&xt<w)for(let At=0;At<Z;++At){const qt=ze+At*re;if(qt>=0&&qt<T){const Ht=gh([Qe,xt,qt,it],f,pn(r.shape)),mn=gh([_t,At,it],_,pn(i.shape)),rn=u[Ht]+m[mn];rn>ht&&(ht=rn)}}}We[gh([Qe,ge,_e,it],Ve,pn(oe))]=ht}}}return{dataId:c.write(Gb(We,r.dtype),oe,r.dtype),shape:oe,dtype:r.dtype}}},LZe={kernelName:lZ,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r,filter:i,dy:s}=n,{strides:o,pad:l,dilations:c}=e,u=t,f=nu(r.shape,u.data.get(r.dataId).values),m=nu(i.shape,u.data.get(i.dataId).values),{batchSize:_,inHeight:y,inWidth:w,inChannels:T,outHeight:I,outWidth:E,padInfo:A,strideHeight:M,strideWidth:O,filterHeight:$,filterWidth:V,dilationHeight:Z,dilationWidth:Q,outShape:re}=HN(r.shape,i.shape,o,l,"NHWC",c);G(s.rank===re.length,()=>`Error in ${lZ}, dy must have the same rank as output ${re.length}, but got ${s.rank}`);const oe=nu(re,u.data.get(s.dataId).values),ye=Nle(i.shape,i.dtype);for(let We=0;We<_;++We)for(let Ke=0;Ke<I;++Ke){const Qe=Ke*M-A.top;for(let ge=0;ge<E;++ge){const we=ge*O-A.left;for(let _e=0;_e<T;++_e){let ze=Number.MIN_SAFE_INTEGER,it=0,ht=0;for(let bt=0;bt<$;++bt){const _t=Qe+bt*Z;if(_t>=0&&_t<y)for(let xt=0;xt<V;++xt){const At=we+xt*Q;if(At>=0&&At<w){const qt=f[We][_t][At][_e]+m[bt][xt][_e];qt>ze&&(ze=qt,it=bt,ht=xt)}}}ye[it][ht][_e]+=oe[We][Ke][ge][_e]}}}return{dataId:u.write(Gb(ye,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},$Ze={kernelName:aZ,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r,filter:i,dy:s}=n,{strides:o,pad:l,dilations:c}=e,u=t,f=nu(r.shape,u.data.get(r.dataId).values),m=nu(i.shape,u.data.get(i.dataId).values),{batchSize:_,inHeight:y,inWidth:w,inChannels:T,outHeight:I,outWidth:E,padInfo:A,strideHeight:M,strideWidth:O,filterHeight:$,filterWidth:V,dilationHeight:Z,dilationWidth:Q,outShape:re}=HN(r.shape,i.shape,o,l,"NHWC",c);G(s.rank===re.length,()=>`Error in ${aZ}, dy must have the same rank as output ${re.length}, but got ${s.rank}`);const oe=nu(re,u.data.get(s.dataId).values),ye=Nle(r.shape,r.dtype);for(let We=0;We<_;++We)for(let Ke=0;Ke<I;++Ke){const Qe=Ke*M-A.top;for(let ge=0;ge<E;++ge){const we=ge*O-A.left;for(let _e=0;_e<T;++_e){let ze=Number.MIN_SAFE_INTEGER,it=Qe<0?0:Qe,ht=we<0?0:we;for(let bt=0;bt<$;++bt){const _t=Qe+bt*Z;if(_t>=0&&_t<y)for(let xt=0;xt<V;++xt){const At=we+xt*Q;if(At>=0&&At<w){const qt=f[We][_t][At][_e]+m[bt][xt][_e];qt>ze&&(ze=qt,it=_t,ht=At)}}}ye[We][it][ht][_e]+=oe[We][Ke][ge][_e]}}}return{dataId:u.write(Gb(ye,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},VZe={kernelName:"Draw",backendName:"cpu",kernelFunc:function BZe(n){const{inputs:t,backend:e,attrs:r}=n,{image:i}=t,{canvas:s,options:o}=r,{contextOptions:l,imageOptions:c}=o||{},u=c?.alpha||1,f=l?.contextType||"2d";if("2d"!==f)throw new Error(`Context type ${l.contextType} is not supported by the CPU backend.`);const m=s.getContext(f,l?.contextAttributes||{});if(null==m)throw new Error(`Could not get the context with ${f} type.`);const[_,y]=i.shape.slice(0,2),w=2===i.shape.length?1:i.shape[2],T=e.data.get(i.dataId).values,I="float32"===i.dtype?255:1,E=new Uint8ClampedArray(y*_*4);for(let M=0;M<_*y;++M){const O=[0,0,0,255*u];for(let V=0;V<w;V++){const Z=T[M*w+V];if("float32"===i.dtype){if(Z<0||Z>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${Z}.`)}else if("int32"===i.dtype&&(Z<0||Z>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${Z}.`);1===w?(O[0]=Z*I,O[1]=Z*I,O[2]=Z*I):O[V]=Z*I}const $=4*M;E[$+0]=Math.round(O[0]),E[$+1]=Math.round(O[1]),E[$+2]=Math.round(O[2]),E[$+3]=Math.round(O[3])}s.width=y,s.height=_;const A=new ImageData(E,y,_);return m.putImageData(A,0,0),i}},g9=os((n,t)=>n*t),UZe=h9((n,t,e,r)=>({real:n*e-t*r,imag:n*r+t*e})),N3=Ps(yN,g9,UZe),zZe={kernelName:yN,backendName:"cpu",kernelFunc:N3};function CR(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;let l;nn(i,"sum"),l="bool"===i.dtype?S_({inputs:{x:i},backend:e,attrs:{dtype:"int32"}}):Ah({inputs:{x:i},backend:e});const c=l.shape.length,u=Kn(s,l.shape),f=Pi(u,c);let m=u,_=l;null!=f&&(_=tl({inputs:{x:l},backend:e,attrs:{perm:f}}),m=is(m.length,c)),Co("sum",m,_.shape.length);const[y,w]=Ks(_.shape,m);let I=A3(e,y,Dl(_.dtype,"int32"));const E=Ye(w),A=e.data.get(I.dataId).values,M=e.data.get(_.dataId).values;for(let O=0;O<A.length;++O){const $=O*E;let V=0;for(let Z=0;Z<E;++Z)V+=M[$+Z];A[O]=V}if(o){const $=I;I=ri({inputs:{x:I},backend:e,attrs:{shape:rs(I.shape,u)}}),e.disposeIntermediateTensorInfo($)}return e.disposeIntermediateTensorInfo(l),null!=f&&e.disposeIntermediateTensorInfo(_),I}const HZe={kernelName:XB,backendName:"cpu",kernelFunc:CR},WZe={kernelName:uZ,backendName:"cpu",kernelFunc:function GZe(n){const{inputs:t,backend:e,attrs:r}=n,{equation:i}=r,s=t,{allDims:o,summedDims:l,idDims:c}=YY(i,s.length);QY(o.length,c,s);const{path:u,steps:f}=XY(l,c),m=f.length;let _=null,y=o.length;const w=[];for(let T=0;T<m;++T){for(const I of f[T]){const{permutationIndices:E,expandDims:A}=KY(y,c[I]);let M;JY(E)?M=s[I]:(M=tl({inputs:{x:s[I]},backend:e,attrs:{perm:E}}),w.push(M));const O=M.shape.slice();for(let $=0;$<A.length;++$)O.splice(A[$],0,1);dr(M.shape,O)||(M=ri({inputs:{x:M},backend:e,attrs:{shape:O}}),w.push(M)),null===_?_=M:(_=N3({inputs:{a:M,b:_},backend:e}),w.push(_))}T<m-1&&(u[T]>=0&&(_=CR({inputs:{x:_},backend:e,attrs:{axis:u[T]-(o.length-y),keepDims:!1}}),w.push(_)),y--)}for(const T of w)T!==_&&e.disposeIntermediateTensorInfo(T);return _}},qZe={kernelName:dZ,backendName:"cpu",kernelFunc:function jZe(n){const{inputs:t,backend:e}=n,{dy:r,y:i}=t;nn([r,i],"eluGrad");const s=new Float32Array(Ye(i.shape)),o=e.data.get(i.dataId).values,l=e.data.get(r.dataId).values;for(let c=0;c<o.length;++c){const u=o[c];s[c]=u>=0?l[c]:l[c]*(u+1)}return e.makeTensorInfo(i.shape,"float32",s)}},Kfe=os((n,t)=>n===t?1:0),Qfe=Ps(bB,Kfe,null,"bool"),ZZe={kernelName:bB,backendName:"cpu",kernelFunc:Qfe},YZe=UY,KZe=zY,QZe=HY,XZe=GY,JZe=WY,e8e=jY,t8e=Lr(rN,n=>{const t=Math.sign(n),e=Math.abs(n),r=1/(1+YZe*e);return t*(1-((((e8e*r+JZe)*r+XZe)*r+QZe)*r+KZe)*r*Math.exp(-e*e))}),n8e={kernelName:rN,backendName:"cpu",kernelFunc:t8e},Xfe=kh(n=>Math.exp(n)),Jfe=T_(iN,Xfe,"float32"),r8e={kernelName:iN,backendName:"cpu",kernelFunc:Jfe};function R3(n){const{inputs:t,backend:e,attrs:r}=n,{input:i}=t,{dim:s}=r,o=i.shape.length,l=i.shape.slice();let c=s;return s<0&&(G(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+s+1),l.splice(c,0,1),ri({inputs:{x:i},backend:e,attrs:{shape:l}})}const i8e={kernelName:wB,backendName:"cpu",kernelFunc:R3},epe=kh(n=>Math.expm1(n)),s8e=T_(sN,epe),o8e={kernelName:sN,backendName:"cpu",kernelFunc:s8e},a8e=os((n,t)=>n/t),_9=Ps(tN,a8e),y9={kernelName:tN,backendName:"cpu",kernelFunc:_9},tpe=os((n,t)=>n-t),l8e=h9((n,t,e,r)=>({real:n-e,imag:t-r})),v9=Ps(MN,tpe,l8e),c8e={kernelName:MN,backendName:"cpu",kernelFunc:v9};function npe(n,t,e){const r=n.shape,i=r[0],s=r[1],o=e.data.get(n.dataId),l=o.complexTensorInfos.real,c=o.complexTensorInfos.imag,u=[i,s],f=Ye(u),m=vo("float32",f),_=vo("float32",f);for(let I=0;I<i;I++){const E=f0({inputs:{x:l},backend:e,attrs:{begin:[I,0],size:[1,s]}}),A=f0({inputs:{x:c},backend:e,attrs:{begin:[I,0],size:[1,s]}}),M=Pl({inputs:{real:E,imag:A},backend:e}),{real:O,imag:$}=u8e(M,t,e),V=wp(O,$);for(let Z=0;Z<s;Z++){const Q=qY(V,Z);m[I*s+Z]=Q.real,_[I*s+Z]=Q.imag}e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(A),e.disposeIntermediateTensorInfo(M)}const y=e.makeTensorInfo(u,"float32",m),w=e.makeTensorInfo(u,"float32",_),T=Pl({inputs:{real:y,imag:w},backend:e});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(w),T}function u8e(n,t,e){const r=Ye(n.shape),i=e.data.get(n.dataId),s=e.data.get(i.complexTensorInfos.real.dataId).values,o=e.data.get(i.complexTensorInfos.imag.dataId).values;if(function d8e(n){return 0==(n&n-1)}(r)){const l=b9(s,o,r,t,e),c=[n.shape[0],n.shape[1]];if(t){const u=e.makeTensorInfo(c,"float32",l.real),f=e.makeTensorInfo(c,"float32",l.imag),m=e.makeTensorInfo([],"float32",n_(r,"float32")),_=Ah({inputs:{x:m},backend:e}),y=y9.kernelFunc({inputs:{a:u,b:m},backend:e}),w=y9.kernelFunc({inputs:{a:f,b:_},backend:e}),T=e.data.get(y.dataId).values,I=e.data.get(w.dataId).values;return e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(w),{real:T,imag:I}}return l}{const c=function h8e(n,t,e){const r=new Float32Array(2*t);for(let i=0;i<t;i++){let s=0,o=0;for(let l=0;l<t;l++){const c=dde(i*l,t,e),u=qY(n,l);s+=u.real*c.real-u.imag*c.imag,o+=u.real*c.imag+u.imag*c.real}e&&(s/=t,o/=t),cde(r,s,o,i)}return r}(wp(s,o),r,t);return ode(c)}}function b9(n,t,e,r,i){if(1===e)return{real:n,imag:t};const s=wp(n,t),o=e/2,l=ade(s),c=l.real,u=l.imag,f=[c.length],m=i.makeTensorInfo(f,"float32",c),_=i.makeTensorInfo(f,"float32",u),y=Pl({inputs:{real:m,imag:_},backend:i}),w=lde(s),T=w.real,I=w.imag,E=[T.length],A=i.makeTensorInfo(E,"float32",T),M=i.makeTensorInfo(E,"float32",I),O=Pl({inputs:{real:A,imag:M},backend:i}),$=b9(c,u,o,r,i),V=$.real,Z=$.imag,Q=[V.length],re=i.makeTensorInfo(Q,"float32",V),oe=i.makeTensorInfo(Q,"float32",Z),ye=Pl({inputs:{real:re,imag:oe},backend:i}),Ve=b9(T,I,o,r,i),We=Ve.real,Ke=Ve.imag,Qe=[We.length],ge=i.makeTensorInfo(Qe,"float32",We),we=i.makeTensorInfo(Qe,"float32",Ke),_e=Pl({inputs:{real:ge,imag:we},backend:i}),ze=ude(e,r),it=[ze.real.length],ht=i.makeTensorInfo(it,"float32",ze.real),bt=i.makeTensorInfo(it,"float32",ze.imag),_t=Pl({inputs:{real:ht,imag:bt},backend:i}),xt=N3({inputs:{a:_t,b:_e},backend:i}),At=ET({inputs:{a:ye,b:xt},backend:i}),qt=v9({inputs:{a:ye,b:xt},backend:i}),Ht=h0({inputs:{input:At},backend:i}),mn=h0({inputs:{input:qt},backend:i}),rn=DT({inputs:{input:At},backend:i}),On=DT({inputs:{input:qt},backend:i}),Vn=kT({inputs:[Ht,mn],backend:i,attrs:{axis:0}}),$r=kT({inputs:[rn,On],backend:i,attrs:{axis:0}}),ii=i.data.get(Vn.dataId).values,Wi=i.data.get($r.dataId).values;return i.disposeIntermediateTensorInfo(m),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(A),i.disposeIntermediateTensorInfo(M),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(re),i.disposeIntermediateTensorInfo(oe),i.disposeIntermediateTensorInfo(ye),i.disposeIntermediateTensorInfo(ge),i.disposeIntermediateTensorInfo(we),i.disposeIntermediateTensorInfo(_e),i.disposeIntermediateTensorInfo(ht),i.disposeIntermediateTensorInfo(bt),i.disposeIntermediateTensorInfo(_t),i.disposeIntermediateTensorInfo(xt),i.disposeIntermediateTensorInfo(At),i.disposeIntermediateTensorInfo(qt),i.disposeIntermediateTensorInfo(Ht),i.disposeIntermediateTensorInfo(rn),i.disposeIntermediateTensorInfo(mn),i.disposeIntermediateTensorInfo(On),i.disposeIntermediateTensorInfo(Vn),i.disposeIntermediateTensorInfo($r),{real:ii,imag:Wi}}const p8e={kernelName:"FFT",backendName:"cpu",kernelFunc:function f8e(n){const{inputs:t,backend:e}=n,{input:r}=t,i=Ye(r.shape),s=r.shape[r.shape.length-1],l=ri({inputs:{x:r},backend:e,attrs:{shape:[i/s,s]}}),c=npe(l,!1,e),u=ri({inputs:{x:c},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(c),u}};function w9(n){const{backend:t,attrs:e}=n,{shape:r,value:i,dtype:s}=e,o=s||XI(i),l=ns(o,Ye(r));return function g8e(n,t,e){n.fill(t)}(l,i),t.makeTensorInfo(r,o,l)}const m8e={kernelName:fZ,backendName:"cpu",kernelFunc:w9},_8e={kernelName:pZ,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{image:r}=n,i=e,s=vo(r.dtype,Ye(r.shape)),[o,l,c,u]=r.shape,f=i.data.get(r.dataId).values;for(let _=0;_<o;_++){const y=_*c*l*u;for(let w=0;w<l;w++){const T=w*(c*u);for(let I=0;I<c;I++){const E=I*u;for(let A=0;A<u;A++){const M=Math.round(c-I-1),O=y+T+E+A;let $=f[O];M>=0&&M<c&&($=f[y+T+M*u+A]),s[O]=$}}}}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},rpe=kh(n=>Math.floor(n)),y8e=T_(oN,rpe),v8e={kernelName:oN,backendName:"cpu",kernelFunc:y8e},ipe=os((n,t)=>Math.floor(n/t)),b8e=Ps(aN,ipe,null,"int32"),w8e={kernelName:aN,backendName:"cpu",kernelFunc:b8e},x8e={kernelName:aV,backendName:"cpu",kernelFunc:function C8e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:l}=t,{strides:c,pad:u,dataFormat:f,dilations:m,dimRoundingMode:_,activation:y,leakyreluAlpha:w}=r;let T=Zfe({inputs:{x:i,filter:s},backend:e,attrs:{strides:c,pad:u,dataFormat:f,dilations:m,dimRoundingMode:_}});if(o){const I=T;if("NCHW"===f&&1===o.shape.length&&1!==o.shape[0]){const E=ri({inputs:{x:o},backend:e,attrs:{shape:[o.shape[0],1,1]}});T=ET({inputs:{a:T,b:E},backend:e}),e.disposeIntermediateTensorInfo(E)}else T=ET({inputs:{a:T,b:o},backend:e});e.disposeIntermediateTensorInfo(I)}if(y){const I=T;if("NCHW"===f&&"prelu"===y&&1===l.shape.length&&1!==l.shape[0]){const E=ri({inputs:{x:l},backend:e,attrs:{shape:[l.shape[0],1,1]}});T=k3(e,T,y,E,w),e.disposeIntermediateTensorInfo(E)}else T=k3(e,T,y,l,w);e.disposeIntermediateTensorInfo(I)}return T}},T8e={kernelName:lV,backendName:"cpu",kernelFunc:function I8e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:l}=t,{strides:c,pad:u,dataFormat:f,dilations:m,dimRoundingMode:_,activation:y,leakyreluAlpha:w}=r;let T=Yfe({inputs:{x:i,filter:s},backend:e,attrs:{strides:c,pad:u,dataFormat:f,dilations:m,dimRoundingMode:_}});if(o){const I=T;T=ET({inputs:{a:T,b:o},backend:e}),e.disposeIntermediateTensorInfo(I)}if(y){const I=T;T=k3(e,T,y,l,w),e.disposeIntermediateTensorInfo(I)}return T}};function spe(n,t,e,r,i,s,o,l,c){const u=qn([r,s],e);for(let f=0;f<r;f++){const m=[];let _=0;for(let y=0;y<i;y++){const w=n[f*i+y];_+=w*o[y],m.push(w)}if(_<0||_>=c/s)throw new Error(`Invalid indices: ${m} does not index into ${l}`);for(let y=0;y<s;y++)u.values[f*s+y]=t.get(...t.indexToLoc(_*s+y))}return u}const E8e={kernelName:mZ,backendName:"cpu",kernelFunc:function S8e(n){const{inputs:t,backend:e}=n,{params:r,indices:i}=t,s=Ye(r.shape),o=i.shape,l=o[o.length-1],[c,u,f,m]=VY(r,i);if(0===u)return e.makeTensorInfo(c,r.dtype,[]);const w=spe(e.data.get(i.dataId).values,e.bufferSync(r),r.dtype,u,l,f,m,r.shape,s);return e.makeTensorInfo(c,r.dtype,w.values)}};function ope(n,t,e){const r=qn(e,n.dtype);for(let i=0;i<r.size;++i){const o=r.indexToLoc(i).slice(),u=t.locToIndex([o[0],o[2]]);o[2]=t.values[u];const f=n.locToIndex(o);0<=f&&f<n.values.length&&(r.values[i]=n.values[f])}return r}const k8e={kernelName:xB,backendName:"cpu",kernelFunc:function D8e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,indices:s}=t,{axis:o,batchDims:l}=r;nn([i,s],"gatherV2");const c=Kn(o,i.shape)[0],u=e.data.get(s.dataId).values,f=i.shape[c];for(let O=0;O<u.length;++O){const $=u[O];G($<=f-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${f-1}]`)}let m=l;null==l&&(m=0);const _=Ye(s.shape),y=nK(i,s,c,m),w=ri({inputs:{x:i},backend:e,attrs:{shape:[y.batchSize,y.outerSize,y.dimSize,y.sliceSize]}}),T=ri({inputs:{x:s},backend:e,attrs:{shape:[y.batchSize,_/y.batchSize]}}),I=[y.batchSize,y.outerSize,_/y.batchSize,y.sliceSize],E=e.bufferSync(T),M=ope(e.bufferSync(w),E,I);return e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(T),e.makeTensorInfo(y.outputShape,M.dtype,M.values)}},ape=os((n,t)=>n>t?1:0),A8e=Ps(IB,ape,null,"bool"),N8e={kernelName:IB,backendName:"cpu",kernelFunc:A8e},lpe=os((n,t)=>n>=t?1:0),R8e=Ps(lN,lpe,null,"bool"),M8e={kernelName:lN,backendName:"cpu",kernelFunc:R8e},F8e={kernelName:gZ,backendName:"cpu",kernelFunc:function O8e(n){const{inputs:t,backend:e}=n,{input:r}=t,i=Ye(r.shape),s=r.shape[r.shape.length-1],l=ri({inputs:{x:r},backend:e,attrs:{shape:[i/s,s]}}),c=npe(l,!0,e),u=ri({inputs:{x:c},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(c),u}},P8e=Lr(uN,n=>Number.isFinite(n)?1:0,"bool"),L8e={kernelName:uN,backendName:"cpu",kernelFunc:P8e},$8e=Lr(dN,n=>Math.abs(n)===1/0?1:0,"bool"),B8e={kernelName:dN,backendName:"cpu",kernelFunc:$8e},V8e=Lr(hN,n=>Number.isNaN(n)?1:0,"bool"),U8e={kernelName:hN,backendName:"cpu",kernelFunc:V8e},cpe=os((n,t)=>n<t?1:0),z8e=Ps(SB,cpe,null,"bool"),H8e={kernelName:SB,backendName:"cpu",kernelFunc:z8e},upe=os((n,t)=>n<=t?1:0),G8e=Ps(EB,upe,null,"bool"),W8e={kernelName:EB,backendName:"cpu",kernelFunc:G8e};function dpe(n,t,e){const r=(t-n)/(e-1),i=Qo(e,"float32");i[0]=n;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}const q8e={kernelName:yZ,backendName:"cpu",kernelFunc:function j8e(n){const{backend:t,attrs:e}=n,{start:r,stop:i,num:s}=e,o=dpe(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}},hpe=kh(n=>Math.log(n)),Z8e=T_(fN,hpe),Y8e={kernelName:fN,backendName:"cpu",kernelFunc:Z8e},K8e=Lr(pN,n=>Math.log1p(n)),Q8e={kernelName:pN,backendName:"cpu",kernelFunc:K8e},X8e=os((n,t)=>n&&t),J8e=Ps(DB,X8e,null,"bool"),eYe={kernelName:DB,backendName:"cpu",kernelFunc:J8e},tYe=Lr(kB,n=>n?0:1,"bool"),nYe={kernelName:kB,backendName:"cpu",kernelFunc:tYe},rYe=os((n,t)=>n||t),iYe=Ps(AB,rYe,null,"bool"),sYe={kernelName:AB,backendName:"cpu",kernelFunc:iYe},aYe={kernelName:NB,backendName:"cpu",kernelFunc:function oYe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{depthRadius:s,bias:o,alpha:l,beta:c}=r;nn(i,"LRN");const u=i.shape[3],f=u-1,m=e.data.get(i.dataId).values,_=Ye(i.shape),y=new Float32Array(_);function w(T){const I=T%u;let E=T-I+Math.max(0,I-s);const A=T-I+Math.min(I+s,f);let M=0;for(;E<=A;E++){const O=m[E];M+=O*O}return M}for(let T=0;T<_;T++){const I=w(T),E=m[T]*Math.pow(o+l*I,-c);y[T]=E}return e.makeTensorInfo(i.shape,i.dtype,y)}},cYe={kernelName:vZ,backendName:"cpu",kernelFunc:function lYe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,y:s,dy:o}=t,{depthRadius:l,bias:c,alpha:u,beta:f}=r;nn(o,"LRNGrad");const m=Ye(o.shape),_=o.shape[3],y=e.data.get(o.dataId).values,w=e.data.get(i.dataId).values,T=e.data.get(s.dataId).values,I=new Float32Array(m),E=m;for(let A=0;A<E;A++){const M=A%_,O=A-M+Math.max(0,M-l),$=A-M+Math.min(_,M+l+1);let V=0;for(let Z=O;Z<$;Z++)V+=Math.pow(w[Z],2);V=u*V+c;for(let Z=O;Z<$;Z++){let Q=-2*u*f*w[Z]*T[A]/V;A===Z&&(Q+=Math.pow(V,-f)),Q*=y[A],I[Z]+=Q}}return e.makeTensorInfo(o.shape,i.dtype,I)}};function fpe(n,t,e,r){const i=vo(r,Ye(e));for(let s=0;s<i.length;++s){const o=s*t;let l=n[o];for(let c=0;c<t;++c){const u=n[o+c];(Number.isNaN(u)||u>l)&&(l=u)}i[s]=l}return i}function ppe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{reductionIndices:s,keepDims:o}=r,l=e;let c=i.shape;const u=c.length,f=Kn(s,c);let m=f;const _=Pi(m,u);let y=l.data.get(i.dataId).values;if(null!=_){const O=new Array(u);for(let $=0;$<O.length;$++)O[$]=c[_[$]];y=f9(y,c,i.dtype,_,O),m=is(m.length,u),c=O}nn(i,"max"),Co("max",m,u);const[w,T]=Ks(c,m),E=fpe(y,Ye(T),w,i.dtype),A=l.write(E,w,i.dtype);let M=w;return o&&(M=rs(w,f)),{dataId:A,shape:M,dtype:i.dtype}}const uYe={kernelName:RB,backendName:"cpu",kernelFunc:ppe},mpe=os((n,t)=>Math.max(n,t)),dYe=Ps(mN,mpe),hYe={kernelName:mN,backendName:"cpu",kernelFunc:dYe},pYe={kernelName:MB,backendName:"cpu",kernelFunc:function fYe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;nn(i,"maxPool");const{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;G(wo(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const f=ou(i.shape,s,o,1,l,c);let m;if(1===f.filterWidth&&1===f.filterHeight&&dr(f.inShape,f.outShape))m=Ah({inputs:{x:i},backend:e});else{const _=e.data.get(i.dataId).values,y=pn(i.shape),w=p9(_,0,i.dtype,y,f,"max");m=e.makeTensorInfo(f.outShape,i.dtype,w.values)}return m}},gYe={kernelName:OB,backendName:"cpu",kernelFunc:function mYe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=r;nn(i,"maxPool3d");const f=yp(i.shape,s,o,1,l,c,u),_=zfe(e.data.get(i.dataId).values,0,i.dtype,pn(i.shape),f,"max");return e.makeTensorInfo(_.shape,"float32",_.values)}},yYe={kernelName:wZ,backendName:"cpu",kernelFunc:function _Ye(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r;nn([i,s],"maxPool3DGrad");const f=yp(s.shape,o,l,1,c,u),_=function N5e(n,t){const e=qn(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,s=t.strideWidth,o=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,u=t.effectiveFilterDepth,f=t.effectiveFilterHeight,m=t.effectiveFilterWidth,_=t.padInfo.front,y=t.padInfo.top,w=t.padInfo.left;for(let T=0;T<t.batchSize;++T)for(let I=0;I<t.inChannels;++I)for(let E=0;E<t.outDepth;++E){const A=E*r-_;let M=A;for(;M<0;)M+=o;const O=Math.min(t.inDepth,u+A);for(let $=0;$<t.outHeight;++$){const V=$*i-y;let Z=V;for(;Z<0;)Z+=l;const Q=Math.min(t.inHeight,f+V);for(let re=0;re<t.outWidth;++re){const oe=re*s-w;let ye=oe;for(;ye<0;)ye+=c;const Ve=Math.min(t.inWidth,m+oe);let We=Number.NEGATIVE_INFINITY,Ke=-1;for(let Qe=M;Qe<O;Qe+=o){const ge=Qe-A;for(let we=Z;we<Q;we+=l){const _e=we-V;for(let ze=ye;ze<Ve;ze+=c){const it=ze-oe,ht=n.get(T,Qe,we,ze,I);ht>=We&&(We=ht,Ke=ge*f*m+_e*f+it)}}}e.set(Ke,T,E,$,re,I)}}}return e}(e.bufferSync(s),f),y=f.strideDepth,w=f.strideHeight,T=f.strideWidth,I=f.dilationDepth,E=f.dilationHeight,A=f.dilationWidth,M=f.effectiveFilterDepth,O=f.effectiveFilterHeight,$=f.effectiveFilterWidth,V=M-1-f.padInfo.front,Z=$-1-f.padInfo.left,Q=O-1-f.padInfo.top,re=qn(s.shape,"float32"),oe=e.bufferSync(i);for(let ye=0;ye<f.batchSize;++ye)for(let Ve=0;Ve<f.inChannels;++Ve)for(let We=0;We<f.inDepth;++We)for(let Ke=0;Ke<f.inHeight;++Ke)for(let Qe=0;Qe<f.inWidth;++Qe){const ge=We-V,we=Ke-Q,_e=Qe-Z;let ze=0;for(let it=0;it<M;it+=I){const ht=(ge+it)/y;if(!(ht<0||ht>=f.outDepth||Math.floor(ht)!==ht))for(let bt=0;bt<O;bt+=E){const _t=(we+bt)/w;if(!(_t<0||_t>=f.outHeight||Math.floor(_t)!==_t))for(let xt=0;xt<$;xt+=A){const At=(_e+xt)/T;if(At<0||At>=f.outWidth||Math.floor(At)!==At)continue;const mn=M*O*$-1-_.get(ye,ht,_t,At,Ve)===it*O*$+bt*$+xt?1:0;0!==mn&&(ze+=oe.get(ye,ht,_t,At,Ve)*mn)}}}re.set(ze,ye,We,Ke,Qe,Ve)}return e.makeTensorInfo(re.shape,re.dtype,re.values)}},bYe={kernelName:bZ,backendName:"cpu",kernelFunc:function vYe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s,output:o}=t,l=s;nn([s,o],"maxPoolGrad");const{filterSize:c,strides:u,pad:f,dimRoundingMode:m}=r,_=ou(l.shape,c,u,1,f,m),y=e.data.get(l.dataId).values,w=qn(_.outShape,l.dtype,Ufe(y,l.shape,l.dtype,_).values),T=_.strideHeight,I=_.strideWidth,E=_.dilationHeight,A=_.dilationWidth,M=_.effectiveFilterHeight,O=_.effectiveFilterWidth,$=O-1-_.padInfo.left,V=M-1-_.padInfo.top,Z=qn(l.shape,"float32"),Q=e.data.get(i.dataId).values,re=qn(i.shape,"float32",Q);for(let oe=0;oe<_.batchSize;++oe)for(let ye=0;ye<_.inChannels;++ye)for(let Ve=0;Ve<_.inHeight;++Ve)for(let We=0;We<_.inWidth;++We){const Ke=Ve-V,Qe=We-$;let ge=0;for(let we=0;we<M;we+=E){const _e=(Ke+we)/T;if(!(_e<0||_e>=_.outHeight||Math.floor(_e)!==_e))for(let ze=0;ze<O;ze+=A){const it=(Qe+ze)/I;if(it<0||it>=_.outWidth||Math.floor(it)!==it)continue;const _t=M*O-1-w.get(oe,_e,it,ye)===we*O+ze?1:0;0!==_t&&(ge+=re.get(oe,_e,it,ye)*_t)}}Z.set(ge,oe,Ve,We,ye)}return e.makeTensorInfo(Z.shape,Z.dtype,Z.values)}},CYe={kernelName:CZ,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:r}=n,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=t,c=e;nn(r,"MaxPoolWithArgmax");const u=c.data.get(r.dataId).values,f=ou(r.shape,i,s,[1,1],o),[m,_]=function wYe(n,t,e,r,i){const o=p9(n,0,e,pn(t),i,"max"),l=Ufe(n,t,e,i,!0,r);return[o.values,l.values]}(u,r.shape,r.dtype,l,f),y=c.write(m,f.outShape,r.dtype),w=c.write(_,f.outShape,r.dtype);return[{dataId:y,shape:f.outShape,dtype:r.dtype},{dataId:w,shape:f.outShape,dtype:"int32"}]}},IYe={kernelName:FB,backendName:"cpu",kernelFunc:function xYe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,l=Kn(s,i.shape),f=Ye(Ks(i.shape,l)[1]),m=[],_=e.makeTensorInfo([],"float32",new Float32Array([f]));m.push(_);const y=S_({inputs:{x:i},backend:e,attrs:{dtype:"float32"}});m.push(y);const w=_9({inputs:{a:y,b:_},backend:e});m.push(w);const T=CR({inputs:{x:w},backend:e,attrs:{axis:s,keepDims:o}});return m.forEach(I=>e.disposeIntermediateTensorInfo(I)),T}},SYe={kernelName:PB,backendName:"cpu",kernelFunc:function TYe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;nn(i,"min");const l=Kn(s,i.shape);let c=l;const u=Pi(c,i.shape.length);let f=i;null!=u&&(f=tl({inputs:{x:i},backend:e,attrs:{perm:u}}),c=is(c.length,i.shape.length)),Co("min",c,f.shape.length);const[m,_]=Ks(f.shape,c),y=Ye(_),w=Qo(Ye(m),f.dtype),T=e.data.get(f.dataId).values;for(let E=0;E<w.length;++E){const A=E*y;let M=T[A];for(let O=0;O<y;++O){const $=T[A+O];(Number.isNaN($)||$<M)&&(M=$)}w[E]=M}null!=u&&e.disposeIntermediateTensorInfo(f);const I=e.makeTensorInfo(m,f.dtype,w);if(o){const A=ri({inputs:{x:I},backend:e,attrs:{shape:rs(m,l)}});return e.disposeIntermediateTensorInfo(I),A}return I}},gpe=os((n,t)=>Math.min(n,t)),EYe=Ps(gN,gpe),DYe={kernelName:gN,backendName:"cpu",kernelFunc:EYe},AYe={kernelName:LB,backendName:"cpu",kernelFunc:function kYe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{paddings:s,mode:o}=r;nn(i,"mirrorPad");const l=s.map((M,O)=>M[0]+i.shape[O]+M[1]),c=s.map(M=>M[0]),u=s.map((M,O)=>M[0]+i.shape[O]),f="reflect"===o?0:1,m=e.data.get(i.dataId).values,_=i.shape.length,y=pn(i.shape),w=Ye(l),T=l.length,I=pn(l),E=vo(i.dtype,w);for(let M=0;M<w;M++){let O=JI(M,T,I);for(let V=0;V<T;V++)O[V]<c[V]?O[V]=2*c[V]-O[V]-f:O[V]>=u[V]&&(O[V]=2*(u[V]-1)-O[V]+f);O=O.map((V,Z)=>V-c[Z]);const $=gh(O,_,y);E[M]=m[$]}return{dataId:e.write(E,l,i.dtype),shape:l,dtype:i.dtype}}},NYe=os((n,t)=>{const e=n%t;return n<0&&t<0||n>=0&&t>=0?e:(e+t)%t}),RYe=Ps(_N,NYe),MYe={kernelName:_N,backendName:"cpu",kernelFunc:RYe};function _pe(n){const{inputs:t,backend:e,attrs:r}=n,{logits:i}=t,{dim:s}=r,o=i.shape.length;let l=s;if(-1===l&&(l=o-1),l!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${l}`);const c=Kn([l],i.shape),u=ppe({inputs:{x:i},backend:e,attrs:{reductionIndices:c,keepDims:!1}}),f=rs(u.shape,c),m=ri({inputs:{x:u},backend:e,attrs:{shape:f}}),_=v9({inputs:{a:i,b:m},backend:e}),y=Jfe({inputs:{x:_},backend:e}),w=CR({inputs:{x:y},backend:e,attrs:{axis:c,keepDims:!1}}),T=ri({inputs:{x:w},backend:e,attrs:{shape:f}}),I=_9({inputs:{a:y,b:T},backend:e});return e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(T),I}const OYe={kernelName:tV,backendName:"cpu",kernelFunc:_pe},PYe={kernelName:xZ,backendName:"cpu",kernelFunc:function FYe(n){const{inputs:t,backend:e,attrs:r}=n,{logits:i}=t,{numSamples:s,seed:o,normalized:l}=r;nn(i,"multinomial");const c=l?i:_pe({inputs:{logits:i},backend:e,attrs:{dim:-1}}),u=c.shape[0],f=c.shape[1],m=e.data.get(c.dataId).values,_=[u,s],y=Qo(Ye(_),"int32");for(let w=0;w<u;++w){const T=w*f,I=new Float32Array(f-1);I[0]=m[T];for(let M=1;M<I.length;++M)I[M]=I[M-1]+m[T+M];const E=$V.alea(o.toString()),A=w*s;for(let M=0;M<s;++M){const O=E();y[A+M]=I.length;for(let $=0;$<I.length;$++)if(O<I[$]){y[A+M]=$;break}}}return l||e.disposeIntermediateTensorInfo(c),e.makeTensorInfo(_,"int32",y)}};function ype(n,t,e){const r=n_(-1,e);return g9([],t,r,n,e)}const $Ye={kernelName:$B,backendName:"cpu",kernelFunc:function LYe(n){const{inputs:t,backend:e}=n,{x:r}=t;nn(r,"neg");const i=e.data.get(r.dataId).values,[s,o]=ype(i,r.shape,r.dtype);return e.makeTensorInfo(o,r.dtype,s)}},BYe=DY,UYe={kernelName:IZ,backendName:"cpu",kernelFunc:function VYe(n){const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=r;nn(i,"NonMaxSuppression");const u=e.data.get(i.dataId).values,f=e.data.get(s.dataId).values,{selectedIndices:m}=BYe(u,f,o,l,c);return e.makeTensorInfo([m.length],"int32",new Int32Array(m))}},zYe=kY,GYe={kernelName:TZ,backendName:"cpu",kernelFunc:function HYe(n){const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,padToMaxOutputSize:u}=r;nn(i,"NonMaxSuppressionPadded");const f=e.data.get(i.dataId).values,m=e.data.get(s.dataId).values,{selectedIndices:_,validOutputs:y}=zYe(f,m,o,l,c,u);return[e.makeTensorInfo([_.length],"int32",new Int32Array(_)),e.makeTensorInfo([],"int32",new Int32Array([y]))]}},WYe=AY,qYe={kernelName:SZ,backendName:"cpu",kernelFunc:function jYe(n){const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=r;nn(i,"NonMaxSuppressionWithScore");const f=e.data.get(i.dataId).values,m=e.data.get(s.dataId).values,_=o,y=l,w=c,T=u,{selectedIndices:I,selectedScores:E}=WYe(f,m,_,y,w,T);return[e.makeTensorInfo([I.length],"int32",new Int32Array(I)),e.makeTensorInfo([E.length],"float32",new Float32Array(E))]}},vpe=os((n,t)=>n!==t?1:0),ZYe=Ps(BB,vpe,null,"bool"),YYe={kernelName:BB,backendName:"cpu",kernelFunc:ZYe},QYe={kernelName:UB,backendName:"cpu",kernelFunc:function KYe(n){const{inputs:t,backend:e,attrs:r}=n,{indices:i}=t,{dtype:s,depth:o,onValue:l,offValue:c}=r;nn(i,"oneHot");const u=Ye(i.shape),f=new Float32Array(u*o);f.fill(c);const m=e.data.get(i.dataId).values;for(let _=0;_<u;++_)m[_]>=0&&m[_]<o&&(f[_*o+m[_]]=l);return e.makeTensorInfo([...i.shape,o],s,f)}};function M3(n){const{inputs:t,backend:e}=n,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const i=h0({inputs:{input:r},backend:e}),s=M3({inputs:{x:i},backend:e}),o=DT({inputs:{input:r},backend:e}),l=M3({inputs:{x:o},backend:e}),c=Pl({inputs:{real:s,imag:l},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(l),c}return w9({backend:e,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const XYe={kernelName:sV,backendName:"cpu",kernelFunc:M3},JYe={kernelName:VB,backendName:"cpu",kernelFunc:function bpe(n){const{inputs:t,backend:e}=n,{x:r}=t;if("string"===r.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===r.dtype){const i=h0({inputs:{input:r},backend:e}),s=bpe({inputs:{x:i},backend:e}),o=DT({inputs:{input:r},backend:e}),l=M3({inputs:{x:o},backend:e}),c=Pl({inputs:{real:s,imag:l},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(l),c}return w9({backend:e,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}};function wpe(n){const{inputs:t,backend:e,attrs:r}=n,{axis:i}=r;if(1===t.length)return R3({inputs:{input:t[0]},backend:e,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach(f=>{El(s,f.shape,"All tensors passed to stack must have matching shapes"),G(o===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],u=kT({inputs:t.map(f=>{const m=R3({inputs:{input:f},backend:e,attrs:{dim:i}});return l.push(m),m}),backend:e,attrs:{axis:i}});return l.forEach(f=>e.disposeIntermediateTensorInfo(f)),u}const eKe={kernelName:zB,backendName:"cpu",kernelFunc:wpe},Cpe={kernelName:HB,backendName:"cpu",kernelFunc:function tKe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{paddings:s,constantValue:o}=r;nn(i,"pad");const l=s.map((A,M)=>A[0]+i.shape[M]+A[1]),c=s.map(A=>A[0]),u=e.data.get(i.dataId).values,f=Ye(i.shape),m=i.shape.length,_=pn(i.shape),y=Ye(l),w=l.length,T=pn(l),I=vo(i.dtype,y);0!==o&&I.fill(o);for(let A=0;A<f;A++)I[gh(JI(A,m,_).map((V,Z)=>V+c[Z]),w,T)]=u[A];return{dataId:e.write(I,l,i.dtype),shape:l,dtype:i.dtype}}},nKe=os((n,t)=>Math.pow(n,t)),rKe=Ps(vN,nKe),iKe={kernelName:vN,backendName:"cpu",kernelFunc:rKe};function xpe(n,t,e,r){const[i,s]=Ks(n,r),o=Dl(t,"int32"),l=Qo(Ye(i),o),c=Ye(s);for(let u=0;u<l.length;++u){const f=u*c;let m=1;for(let _=0;_<c;++_)m*=e[f+_];l[u]=m}return{outVals:l,outShape:i,outDtype:o}}const oKe={kernelName:WB,backendName:"cpu",kernelFunc:function sKe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;nn(i,"prod");const l=i.shape.length,c=Kn(s,i.shape),u=Pi(c,l);let f=c,m=i;const _=[];null!=u&&(m=tl({inputs:{x:i},backend:e,attrs:{perm:u}}),_.push(m),f=is(f.length,l));const y=e.data.get(m.dataId).values,{outVals:w,outShape:T,outDtype:I}=xpe(m.shape,m.dtype,y,f);let E=T;return o&&(E=rs(T,c)),_.forEach(A=>e.disposeIntermediateTensorInfo(A)),e.makeTensorInfo(E,I,w)}};function Ipe(n,t){const e=n.slice(0,t);for(;e.length<t;)e.push(1);for(let r=t;r<n.length;r++)e[t-1]*=n[r];return e}function Tpe(n,t,e,r,i,s,o,l){if(0===n.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function aKe(n,t,e){n.forEach((r,i)=>{if(r<0||r>=e){const s=JI(i,t.length,pn(t)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${e})`)}})}(s,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:f,valueSlices:m,numValues:_}=function cKe(n,t,e,r){const i=[];let s=0;const l=new Array(t.length-1+e.length).fill(null).map(()=>[0]);!function lKe(n,t){for(let e=0;e<n.length;++e){const r=n[e],i=e===n.length-1?t:n[e+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}(e,r);let c=1;for(let u=0;u<t.length-1;++u){c*=t[u];const f=t[u+1];for(let m=1;m<c+1;++m)l[u].push(m*f)}for(let u=0;u<n.length;++u){let f=n[u],m=n[u]+1;for(let _=0;_<e.length;++_){const y=e[_],w=_+t.length-1;if(w>=0){const T=l[w],I=T[T.length-1]-y[f];for(let E=f;E<m;++E)l[w].push(y[E+1]+I)}f=y[f],m=y[m]}m!==f&&(i.push([f,m]),s+=m-f)}return{outSplits:l,valueSlices:i,numValues:s}}(s,o,n,u),y=function uKe(n){const t=[];for(let e=0;e<n.length;++e){const i=ns("int32",n[e].length);t.push(i),n[e].forEach((s,o)=>i[o]=s)}return t}(f),w=function hKe(n,t,e,r,i){const s=t.slice();s[0]=i;const o=ns(e,Ye(s)),l=n.length;return function dKe(n,t,e,r,i,s){const o=Ipe(t,2)[1],l=Ipe(s,2)[1];let c=0;for(const u of e)for(let f=u[0];f<u[1];++f){for(let m=0;m<r;++m)i[c*l+m]=n[f*o+m];++c}}(n,t,r,0===l?0:l/t[0],o,s),[o,s]}(e,r,i,m,_);return[y,w[0],w[1]]}const pKe={kernelName:EZ,backendName:"cpu",kernelFunc:function fKe(n){const{inputs:t,backend:e,attrs:r}=n,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,c=i.map(E=>e.data.get(E.dataId).values),u=i.map(E=>E.shape),f=e.data.get(s.dataId).values,m=e.data.get(o.dataId).values,[_,y,w]=Tpe(c,u,f,s.shape,s.dtype,m,o.shape),T=_.map(E=>e.makeTensorInfo([E.length],"int32",E)),I=e.makeTensorInfo(w,s.dtype,y);return T.concat([I])}};function Epe(n,t,e,r,i,s,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const l=0===t.length,c=0===i.length,u=0===o.length,f=[];l||f.push(t[0]),c||f.push(i[0]),u||f.push(o[0]);for(let I=1;I<f.length;++I)if(f[I]!==f[I-1])throw new Error("starts, limits, and deltas must have the same shape");const m=0===f.length?1:f[0],_=ns("int32",m+1);_[0]=0;for(let I=0;I<m;++I){const E=l?n[0]:n[I],A=c?r[0]:r[I],M=u?s[0]:s[I];if(0===M)throw new Error("Requires delta != 0");let O;if(M>0&&A<E||M<0&&A>E)O=0;else if(O=Math.ceil(Math.abs((A-E)/M)),O>2147483647)throw new Error("Requires ((limit - start) / delta) <= 2147483647");_[I+1]=_[I]+O}const w=ns(e,_[m]);let T=0;for(let I=0;I<m;++I){const E=_[I+1]-_[I];let A=l?n[0]:n[I];const M=u?s[0]:s[I];for(let O=0;O<E;++O)w[T++]=A,A+=M}return[_,w]}const gKe={kernelName:DZ,backendName:"cpu",kernelFunc:function mKe(n){const{inputs:t,backend:e}=n,{starts:r,limits:i,deltas:s}=t,o=e.data.get(r.dataId).values,l=e.data.get(i.dataId).values,c=e.data.get(s.dataId).values,[u,f]=Epe(o,r.shape,r.dtype,l,i.shape,c,s.shape);return[e.makeTensorInfo([u.length],"int32",u),e.makeTensorInfo([f.length],r.dtype,f)]}};var mu=uu;class O3{constructor(t,e,r,i,s,o,l,c,u,f){this.shape=t,this.shapeShape=e,this.values=r,this.valuesShape=i,this.valuesDType=s,this.defaultValue=o,this.defaultValueShape=l,this.rowPartitionValues=c,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=rde(f),this.raggedRank=ide(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===mu.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===mu.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case mu.VALUE_ROWIDS:return O3.getMaxWidthValueRowID(e);case mu.ROW_SPLITS:return O3.getMaxWidthRowSplit(e);default:throw new Error(`Cannot handle partition type ${mu[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let r=0;for(let i=0;i<e-1;++i){const s=t[i+1]-t[i];s>r&&(r=s)}return r}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let r=0,i=t[0],s=0;for(let o=1;o<e;++o){const l=t[o];l!==i&&(i=l,s=Math.max(o-r,s),r=o)}return Math.max(e-r,s)}tensorShapeFromTensor(t,e,r=!0){if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return kpe(t,r)}calculateOutputSize(t){const e=this.valuesShape;sde(this.defaultValueShape,e);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=nde(this.raggedRank,i,e);o[0]<0&&(o[0]=t);for(let l=1;l<=this.raggedRank;++l)o[l]<0&&(o[l]=this.getMaxWidth(l));return o}calculateFirstParentOutputIndex(t,e,r){const i=Math.min(t,r),s=[];let o=0;for(let l=0;l<i;++l,o+=e)s.push(o);for(let l=i;l<t;++l)s.push(-1);return G(s.length===t,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(t,e,r,i){const s=t.length,o=[];for(let l=0;l<s-1;++l){const c=t[l+1]-t[l];let u=Math.min(i,c),f=e[l];-1===f&&(u=0);for(let m=0;m<u;++m)o.push(f),f+=r;for(let m=0;m<c-u;++m)o.push(-1)}if(s>0&&o.length!==t[s-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,e,r,i){const s=t.length,o=[];if(0===s)return[];let l=0,c=t[0];if(c>=e.length)throw new Error(`Got currentValueRowId=${c}, which is not less than ${e.length}`);let u=e[c];o.push(u);for(let f=1;f<s;++f){const m=t[f];if(m===c)u>=0&&(++l,l<i?u+=r:u=-1);else{if(l=0,c=m,m>=e.length)throw new Error(`Got nextValueRowId=${m} which is not less than ${e.length}`);u=e[m]}o.push(u)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,e,r,i){const s=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case mu.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,e,r,i);case mu.ROW_SPLITS:if(s.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(s,e,r,i);default:throw new Error(`Unsupported partition type: ${mu[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case mu.FIRST_DIM_SIZE:return t[0];case mu.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case mu.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${mu[e]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),r=this.calculateOutputSize(e),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let c=i.length-2;c>=0;--c)i[c]=i[c+1]*r[c+1];const s=kpe(r,!1),o=ns(this.valuesDType,Ye(s));if(i[0]*r[0]>0){let c=this.calculateFirstParentOutputIndex(e,i[0],r[0]);for(let u=1;u<=this.raggedRank;++u)c=this.calculateOutputIndex(u-1,c,i[u],r[u]);this.setOutput(this.raggedRank,c,o,s)}return[s,o]}setOutput(t,e,r,i){if(0===r.length)return;const s=this.values,o=r;let l=i.slice();l=l.slice(t+1);const c=Ye(l),u=e.length;let f=this.defaultValue;if(f.length!==c&&1!==f.length){const w=this.defaultValueShape;Ie(()=>{const T=fe(f,w);f=fT(T,l).dataSync()})}let m=0,_=0,y=0;for(let w=0;w<=u;++w){let T=w<u?e[w]:-1;if(T!==y){if(_<y){const I=s.subarray(m*c);Dpe(o.subarray(_*c),I,(y-_)*c)}if(w>=u&&(T=Math.floor(r.length/c)),T>y)if(1===this.defaultValue.length)o.subarray(y*c,T*c).fill(this.defaultValue[0]),y=T;else for(;T>y;)Dpe(o.slice(y*c),f,c),++y;T<0?(m=w+1,_=y):(m=w,_=y,y=_+1)}else++y}}}function Dpe(n,t,e){for(let r=0;r<e;r++)n[r]=t[r]}function kpe(n,t){const e=[];for(let r of n){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}e.push(r)}return e}function Ape(n,t,e,r,i,s,o,l,c,u){return new O3(n,t,e,r,i,s,o,l,c,u).compute()}const yKe={kernelName:kZ,backendName:"cpu",kernelFunc:function _Ke(n){const{inputs:t,backend:e,attrs:r}=n,{shape:i,values:s,defaultValue:o,rowPartitionTensors:l}=t,{rowPartitionTypes:c}=r,u=e.data.get(i.dataId).values,f=e.data.get(s.dataId).values,m=e.data.get(o.dataId).values,_=l.map(I=>e.data.get(I.dataId).values),y=l.map(I=>I.shape),[w,T]=Ape(u,i.shape,f,s.shape,s.dtype,m,o.shape,_,y,c);return e.makeTensorInfo(w,s.dtype,T)}};function Npe(n,t,e,r){if(n===t||n<t&&e<0||t<n&&e>1)return Qo(0,r);const c=Qo(Math.abs(Math.ceil((t-n)/e)),r);t<n&&1===e&&(e=-1),c[0]=n;for(let u=1;u<c.length;u++)c[u]=c[u-1]+e;return c}const bKe={kernelName:AZ,backendName:"cpu",kernelFunc:function vKe(n){const{backend:t,attrs:e}=n,{start:r,stop:i,dtype:s,step:o}=e,l=Npe(r,i,o,s);return t.makeTensorInfo([l.length],s,l)}},wKe=Lr(bN,n=>1/n),CKe={kernelName:bN,backendName:"cpu",kernelFunc:wKe},IKe={kernelName:ZB,backendName:"cpu",kernelFunc:function xKe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:l}=r;nn(i,"resizeBilinear");const c=pn(i.shape),[u,f]=l,[m,_,y,w]=i.shape,T=e.data.get(i.dataId).values,I=new Float32Array(Ye([m,u,f,w])),E=[s&&u>1?_-1:_,s&&f>1?y-1:y],A=[s&&u>1?u-1:u,s&&f>1?f-1:f];let M=0;const O=E[0]/A[0],$=E[1]/A[1];for(let V=0;V<m;V++)for(let Z=0;Z<u;Z++){let Q;Q=o?O*(Z+.5)-.5:O*Z;const re=Math.max(0,Math.floor(Q)),oe=Q-re,ye=Math.min(_-1,Math.ceil(Q)),Ve=V*c[0]+re*c[1],We=V*c[0]+ye*c[1];for(let Ke=0;Ke<f;Ke++){let Qe;Qe=o?$*(Ke+.5)-.5:$*Ke;const ge=Math.max(0,Math.floor(Qe)),we=Qe-ge,_e=Math.min(y-1,Math.ceil(Qe)),ze=Ve+ge*c[2],it=We+ge*c[2],ht=Ve+_e*c[2],bt=We+_e*c[2];for(let _t=0;_t<w;_t++){const xt=T[ze+_t],At=T[it+_t],mn=xt+(T[ht+_t]-xt)*we;I[M++]=mn+(At+(T[bt+_t]-At)*we-mn)*oe}}}return e.makeTensorInfo([m,u,f,w],"float32",I)}},SKe={kernelName:MZ,backendName:"cpu",kernelFunc:function TKe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i,dy:s}=t,{alignCorners:o}=r;nn([s,i],"resizeBilinearGrad");const l=pn(i.shape),[c,u,f,m]=i.shape,[,_,y]=s.shape,w=new Float32Array(c*u*f*m),T=[o&&_>1?u-1:u,o&&y>1?f-1:f],I=[o&&_>1?_-1:_,o&&y>1?y-1:y],E=T[0]/I[0],A=T[1]/I[1],M=e.data.get(s.dataId).values;let O=0;for(let $=0;$<c;$++){const V=$*l[0];for(let Z=0;Z<_;Z++){const Q=Z*E,re=Math.floor(Q),oe=Math.min(Math.ceil(Q),u-1),ye=V+re*l[1],Ve=V+oe*l[1],We=Q-re,Ke=1-We;for(let Qe=0;Qe<y;Qe++){const ge=Qe*A,we=Math.floor(ge),_e=Math.min(Math.ceil(ge),f-1),ze=ge-we,it=1-ze,ht=ye+we*l[2],bt=ye+_e*l[2],_t=Ve+we*l[2],xt=Ve+_e*l[2],At=Ke*it,qt=Ke*ze,Ht=We*it,mn=We*ze;for(let rn=0;rn<m;rn++){const On=M[O++];w[ht+rn]+=On*At,w[bt+rn]+=On*qt,w[_t+rn]+=On*Ht,w[xt+rn]+=On*mn}}}}return e.makeTensorInfo([c,f,u,m],"float32",w)}},DKe={kernelName:qB,backendName:"cpu",kernelFunc:function EKe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:l}=r;nn(i,"resizeNearestNeighbor");const c=pn(i.shape),[u,f]=l,[m,_,y,w]=i.shape,T=e.data.get(i.dataId).values,I=new Float32Array(m*u*f*w),E=[s&&u>1?_-1:_,s&&f>1?y-1:y],A=[s&&u>1?u-1:u,s&&f>1?f-1:f],M=E[0]/A[0],O=E[1]/A[1];let $=0;for(let V=0;V<m;V++){const Z=V*c[0];for(let Q=0;Q<u;Q++){const re=o?M*(Q+.5):M*Q;let oe=Math.min(_-1,s?Math.round(re):Math.floor(re));o&&(oe=Math.max(0,oe));const ye=Z+oe*c[1];for(let Ve=0;Ve<f;Ve++){const We=o?O*(Ve+.5):O*Ve;let Ke=Math.min(y-1,s?Math.round(We):Math.floor(We));o&&(Ke=Math.max(0,Ke));const Qe=ye+Ke*c[2];for(let ge=0;ge<w;ge++)I[$++]=T[Qe+ge]}}}return e.makeTensorInfo([m,u,f,w],i.dtype,I)}},AKe={kernelName:RZ,backendName:"cpu",kernelFunc:function kKe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i,dy:s}=t,{alignCorners:o}=r;nn([s,i],"resizeNearestNeighborGrad");const l=pn(i.shape),c=pn(s.shape),[u,f,m,_]=i.shape,[,y,w]=s.shape,T=new Float32Array(u*f*m*_),I=e.data.get(s.dataId).values,E=[o&&y>1?f-1:f,o&&w>1?m-1:m],A=[o&&y>1?y-1:y,o&&w>1?w-1:w],M=E[0]/A[0],O=E[1]/A[1],$=1/M,V=1/O,Z=2*Math.ceil($)+2,Q=2*Math.ceil(V)+2;for(let re=0;re<u;re++){const oe=re*l[0];for(let ye=0;ye<f;ye++){const Ve=oe+ye*l[1],We=Math.floor(ye*$),Ke=Math.floor(We-Z/2);for(let Qe=0;Qe<m;Qe++){const ge=Ve+Qe*l[2],we=Math.floor(Qe*V),_e=Math.floor(we-Q/2);for(let ze=0;ze<_;ze++){let it=0;for(let ht=0;ht<Z;ht++){const bt=ht+Ke;if(bt<0||bt>=y)continue;const _t=oe+bt*c[1],xt=bt*M;if(ye===Math.min(f-1,o?Math.round(xt):Math.floor(xt)))for(let qt=0;qt<Q;qt++){const Ht=qt+_e;if(Ht<0||Ht>=w)continue;const mn=_t+Ht*c[2],rn=Ht*O;Qe===Math.min(m-1,o?Math.round(rn):Math.floor(rn))&&(it+=I[mn+ze])}}T[ge+ze]=it}}}}return e.makeTensorInfo(i.shape,i.dtype,T)}},RKe={kernelName:YB,backendName:"cpu",kernelFunc:function NKe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{dims:s}=r;nn(i,"reverse");const o=i.shape.length,l=Kn(s,i.shape);if(0===o)return Ah({inputs:{x:i},backend:e});const c=new Ds(i.shape,i.dtype),u=e.bufferSync(i);for(let f=0;f<c.size;f++){const m=c.indexToLoc(f),_=m.slice();l.forEach(y=>_[y]=i.shape[y]-1-_[y]),c.set(u.get(..._),...m)}return e.makeTensorInfo(c.shape,c.dtype,c.values)}},MKe={kernelName:QZ,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:r}=n,{radians:i,fillValue:s,center:o}=t,l=e,c=vo(r.dtype,Ye(r.shape)),[u,f,m,_]=r.shape,[y,w]=LY(o,f,m),I=Math.sin(i),E=Math.cos(i),A=l.data.get(r.dataId).values;for(let O=0;O<u;O++){const $=O*m*f*_;for(let V=0;V<f;V++){const Z=V*(m*_);for(let Q=0;Q<m;Q++){const re=Q*_;for(let oe=0;oe<_;oe++){const ye=[u,V,Q,oe],Ve=ye[2],We=ye[1];let Ke=(Ve-y)*E-(We-w)*I,Qe=(Ve-y)*I+(We-w)*E;Ke=Math.round(Ke+y),Qe=Math.round(Qe+w);let ge=s;"number"!=typeof s&&(ge=3===oe?255:s[oe]),Ke>=0&&Ke<m&&Qe>=0&&Qe<f&&(ge=A[$+Qe*(m*_)+Ke*_+oe]),c[$+Z+re+oe]=ge}}}}return{dataId:l.write(c,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},OKe=Lr(xN,n=>{const t=Math.floor(n);return n-t<.5?Math.floor(n):n-t>.5?Math.ceil(n):t%2==0?t:t+1}),FKe={kernelName:xN,backendName:"cpu",kernelFunc:OKe},Rpe=kh(n=>1/Math.sqrt(n)),PKe=T_(IN,Rpe),LKe={kernelName:IN,backendName:"cpu",kernelFunc:PKe};function p0(n,t,e,r,i,s,o,l,c,u){const f=[r/i,i],m=n.values,_=t.values;if(0===r)return qn(e,t.dtype);const y=c instanceof Ds?c:qn(f,t.dtype);"string"==typeof c||"number"==typeof c?y.values.fill(c):"boolean"==typeof c&&y.values.fill(+c);for(let w=0;w<s;w++){const T=[];let I=0;for(let E=0;E<o;E++){const A=m[w*o+E];T.push(A),I+=A*l[E]}if(I<0||I>=r/i)throw new Error(`Invalid indices: ${T} does not index into ${e}`);for(let E=0;E<i;E++)u?y.values[I*i+E]+=_[w*i+E]:y.values[I*i+E]=0===t.rank?_[0]:_[w*i+E]}return y}const BKe={kernelName:OZ,backendName:"cpu",kernelFunc:function $Ke(n){const{inputs:t,backend:e,attrs:r}=n,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:f,outputSize:m}=n0(0,i,o),T=p0(e.bufferSync(i),e.bufferSync(s),o,m,u,c,l,f,0,!0);return e.makeTensorInfo(o,T.dtype,T.values)}};function VKe(n,t){let e=0,r=n.length,i=0;for(;e<r;)i=Math.floor((e+r)/2),n[i]<t?e=i+1:r=i;return r}function UKe(n,t){let e=0,r=n.length,i=0;for(;e<r;)i=Math.floor((e+r)/2),n[i]<=t?e=i+1:r=i;return r}const GKe={kernelName:PZ,backendName:"cpu",kernelFunc:function HKe(n){const{inputs:t,backend:e,attrs:r}=n,{sortedSequence:i,values:s}=t,{side:o}=r,u=function zKe(n,t,e,r,i,s){const o=ns("int32",e*i);for(let l=0;l<e;++l){const c=n.slice(l*r,(l+1)*r),u=l*i;for(let f=0;f<i;++f)o[u+f]="left"===s?VKe(c,t[f+u]):UKe(c,t[f+u])}return o}(e.data.get(i.dataId).values,e.data.get(s.dataId).values,i.shape[0],i.shape[1],s.shape[1],o);return e.makeTensorInfo(s.shape,"int32",u)}},jKe={kernelName:KB,backendName:"cpu",kernelFunc:function WKe(n){const{inputs:t,backend:e}=n,{condition:r,t:i,e:s}=t;nn([r,i,s],"select");const o=r.shape.length,l=e.data.get(r.dataId).values,c=e.data.get(i.dataId).values,u=e.data.get(s.dataId).values,f=Dl(i.dtype,s.dtype),m=Qo(Ye(i.shape),f);let _=0;const y=0===o||o>1||1===i.shape.length?1:Ye(i.shape.slice(1));for(let w=0;w<l.length;w++)for(let T=0;T<y;T++)m[_++]=1===l[w]?c[w]:u[w];return e.makeTensorInfo(i.shape,f,m)}},qKe=YV,ZKe=KV,YKe=Lr(TN,n=>n>=0?ZKe*n:qKe*(Math.exp(n)-1)),KKe={kernelName:TN,backendName:"cpu",kernelFunc:YKe},QKe=Lr(DN,n=>n<0?-1:n>0?1:0),XKe={kernelName:DN,backendName:"cpu",kernelFunc:QKe},JKe=Lr(SN,n=>Math.sin(n)),e9e={kernelName:SN,backendName:"cpu",kernelFunc:JKe},t9e=Lr(EN,n=>Math.sinh(n)),n9e={kernelName:EN,backendName:"cpu",kernelFunc:t9e},Mpe=Math.log(1.1920928955078125e-7)+2,r9e=Lr(AN,n=>{const t=n>-Mpe,e=n<Mpe,r=Math.exp(n);let i;return i=e?r:t?n:Math.log(1+r),i}),i9e={kernelName:AN,backendName:"cpu",kernelFunc:r9e},o9e={kernelName:JB,backendName:"cpu",kernelFunc:function s9e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockShape:s,paddings:o}=r;nn([i],"spaceToBatchND");const l=Ye(s),c=[[0,0]];c.push(...o);for(let V=1+s.length;V<i.shape.length;++V)c.push([0,0]);const u=Cpe.kernelFunc({inputs:{x:i},backend:e,attrs:{paddings:c,constantValue:0}}),f=iR(u.shape,s,l,!1),m=sR(f.length,s.length,!1),_=oR(u.shape,s,l,!1),T=ri({inputs:{x:u},backend:e,attrs:{shape:f}}),A=tl({inputs:{x:T},backend:e,attrs:{perm:m}}),$=ri({inputs:{x:A},backend:e,attrs:{shape:_}});return e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(A),$}};function Ope(n,t,e,r,i,s,o){const l=t[0],c=s[0],u=new Array(c),f=new Array(l),m=t[1];if(0===c){if(0!==l)throw new Error(pde(l));return[ns(e,0),[0,m],ns(i,0),u,f]}let _=!0,y=0;const w=new Array(c).fill(0);for(let I=0;I<l;++I){const E=n[I*m];if(E<0)throw new Error(mde(I,E));if(E>=c)throw new Error(gde(I,E,c));++w[E],_=_&&E>=y,y=E}let T=!0;for(let I=0;I<c;++I){const E=0===w[I];u[I]=E,T=T&&!E,w[I]=Math.max(w[I],1),I>0&&(w[I]+=w[I-1])}if(T&&_){const I=n,E=r;for(let A=0;A<l;++A)f[A]=A;return[I,[l,m],E,u,f]}{const I=w[c-1],E=ns(e,I*m),A=ns(i,I),M=new Array(c).fill(0);for(let O=0;O<l;++O){const $=n[O*m],Z=(0===$?0:w[$-1])+M[$];M[$]++;for(let Q=0;Q<m;++Q)E[Z*m+Q]=n[O*m+Q];A[Z]=r[O],f[O]=Z}for(let O=0;O<c;++O)if(0===M[O]){const V=0===O?0:w[O-1];E[V*m+0]=O;for(let Z=1;Z<m;++Z)E[V*m+Z]=0;A[V]=o}return[E,[I,m],A,u,f]}}const l9e={kernelName:LZ,backendName:"cpu",kernelFunc:function a9e(n){const{inputs:t,backend:e}=n,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(1!==s.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${s.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n        ${i.shape}`);if(0!==o.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${o.shape}`);const l=e.data.get(r.dataId).values,c=e.data.get(i.dataId).values,u=e.data.get(s.dataId).values,f=e.data.get(o.dataId).values[0],[m,_,y,w,T]=Ope(l,r.shape,r.dtype,c,i.dtype,u,f);return[e.makeTensorInfo(_,r.dtype,m),e.makeTensorInfo([_[0]],i.dtype,y),e.makeTensorInfo([w.length],"bool",new Uint8Array(w.map(I=>Number(I)))),e.makeTensorInfo([T.length],r.dtype,new Int32Array(T))]}};function Fpe(n,t,e,r,i){const s=Ye(r),o=t[0],l=i.length,c=[];let u=1,f=-1;for(let I=0;I<l;++I){const E=i[I];if(-1===E){if(-1!==f)throw new Error(_de(f,I));f=I,c.push(1)}else{if(E<0)throw new Error(yde(I,E));u*=E,c.push(E)}}if(-1!==f){if(u<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const I=Math.trunc(s/u);if(u*I!==s)throw new Error(bde(r,c));c[f]=I}if(Ye(c)!==s)throw new Error(wde(r,c));const _=r.length,y=[];if(_>0){y[_-1]=1;for(let I=_-2;I>=0;--I)y[I]=y[I+1]*r[I+1]}const w=[];if(l>0){w[l-1]=1;for(let I=l-2;I>=0;--I)w[I]=w[I+1]*c[I+1]}const T=ns(e,o*l);for(let I=0;I<o;++I){let E=0;for(let A=0;A<_;++A)E+=n[I*_+A]*y[A];for(let A=0;A<l;++A)T[I*l+A]=Math.trunc(E/w[A]),E%=w[A]}return[T,[o,l],c]}const u9e={kernelName:$Z,backendName:"cpu",kernelFunc:function c9e(n){const{inputs:t,backend:e}=n,{inputIndices:r,inputShape:i,newShape:s}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${i.shape}`);if(1!==s.shape.length)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(e.data.get(i.dataId).values),l=e.data.get(r.dataId).values,c=Array.from(e.data.get(s.dataId).values),[u,f,m]=Fpe(l,r.shape,r.dtype,o,c);return[e.makeTensorInfo(f,r.dtype,u),e.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}};function C9(n,t,e,r,i,s=!1,o=0){const l=r.length,c=[t[0],n.length/t[0]],u=c[1],m=l>0?i[l-1]+1:0;if(m<0)throw new Error("segment ids must be >= 0");const _=t.slice();_[0]=m;const w=ns(e,_.reduce((M,O)=>M*O,1));if(0===l)return m>0&&w.fill(o),[w,_];if(m<=0)throw new Error("segment ids must be >= 0");let T=0,I=1,E=0,A=i[T];for(;;){let M=0;if(I<l){if(M=i[I],A===M){++I;continue}if(A>=M)throw new Error("segment ids are not increasing")}if(A<0||A>=m)throw new Error(xde(A,m));A>E&&w.fill(o,E*u,A*u);for(let O=T;O<I;++O){const $=r[O];if($<0||$>=c[0])throw new Error(Ide(O,r[O],c[0]));for(let V=0;V<u;V++)w[A*u+V]+=n[$*u+V]}if(s)for(let O=0;O<u;O++)w[A*u+O]/=I-T;if(T=I,++I,E=A+1,A=M,I>l)break}return E<m&&w.fill(o,E*u,m*u),[w,_]}const h9e={kernelName:BZ,backendName:"cpu",kernelFunc:function d9e(n){const{inputs:t,backend:e}=n,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=e.data.get(r.dataId).values,l=e.data.get(i.dataId).values,c=e.data.get(s.dataId).values,[u,f]=C9(o,r.shape,r.dtype,l,c,!0);return e.makeTensorInfo(f,r.dtype,u)}},p9e={kernelName:VZ,backendName:"cpu",kernelFunc:function f9e(n){const{inputs:t,backend:e}=n,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=e.data.get(r.dataId).values,l=e.data.get(i.dataId).values,c=e.data.get(s.dataId).values,[u,f]=C9(o,r.shape,r.dtype,l,c);return e.makeTensorInfo(f,r.dtype,u)}},g9e={kernelName:UZ,backendName:"cpu",kernelFunc:function m9e(n){const{inputs:t,backend:e,attrs:r}=n,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:l}=r,{sliceRank:c,numUpdates:u,sliceSize:f,strides:m,outputSize:_}=n0(0,i,l),y=!1,w=e.bufferSync(i);let T;switch(s.dtype){case"bool":T=p0(w,e.bufferSync(s),l,_,f,u,c,m,Boolean(e.data.get(o.dataId).values[0]),y);break;case"float32":case"int32":T=p0(w,e.bufferSync(s),l,_,f,u,c,m,e.data.get(o.dataId).values[0],y);break;case"string":T=p0(w,e.bufferSync(s),l,_,f,u,c,m,i_(e.data.get(o.dataId).values[0]),y);break;default:throw new Error(`Unsupported type ${s.dtype}`)}return e.makeTensorInfo(l,T.dtype,T.values)}},y9e={kernelName:eV,backendName:"cpu",kernelFunc:function _9e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,l=Kn(o,i.shape)[0],c=eK(i,s,l),u=new Array(i.shape.length).fill(0),f=i.shape.slice();return c.map(m=>{const _=[...f];_[l]=m;const y=f0({inputs:{x:i},backend:e,attrs:{begin:u,size:_}});return u[l]+=m,y})}},v9e=kh(n=>Math.sqrt(n)),b9e=Lr(NN,n=>Math.sqrt(n)),w9e={kernelName:NN,backendName:"cpu",kernelFunc:b9e},C9e={kernelName:zZ,backendName:"cpu",kernelFunc:({inputs:n,backend:t})=>{const{x:e}=n,r=t;nn(e,"square");const i=r.data.get(e.dataId).values,s=new Float32Array(i.length);for(let l=0;l<i.length;++l){const c=i[l];s[l]=c*c}return{dataId:r.write(s,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}},Ppe=os((n,t)=>{const e=n-t;return e*e}),x9e=Ps(RN,Ppe),I9e={kernelName:RN,backendName:"cpu",kernelFunc:x9e},Lpe=kh((n,t)=>{const{pattern:e,replaceGlobal:r,rewrite:i}=t;return n.replace(new RegExp(e,r?"g":""),i)}),T9e=T_(nV,Lpe),S9e={kernelName:nV,backendName:"cpu",kernelFunc:T9e},E9e=Lr(LN,(n,t)=>{const e=t;return isNaN(n)?NaN:n>0?1:e.alpha}),D9e={kernelName:LN,backendName:"cpu",kernelFunc:E9e};function $pe(n,t,e,r){const i=qn(n,t.dtype);for(let s=0;s<i.size;s++){const o=i.indexToLoc(s),l=new Array(o.length);for(let c=0;c<l.length;c++)l[c]=o[c]*e[c]+r[c];i.set(t.get(...l),...o)}return i}const A9e={kernelName:HZ,backendName:"cpu",kernelFunc:function k9e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{begin:s,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:f,newAxisMask:m,shrinkAxisMask:_}=r;nn(i,"stridedSlice");const{finalShapeSparse:y,finalShape:w,isIdentity:T,sliceDim0:I,isSimpleSlice:E,begin:A,end:M,strides:O}=U8(i.shape,s,o,l,c,u,f,m,_);let $;if(T)$=ri({inputs:{x:i},backend:e,attrs:{shape:w}});else if(I||E){G(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const V=$8(A,M,O),Z=f0({inputs:{x:i},backend:e,attrs:{begin:A,size:V}});$=ri({inputs:{x:Z},backend:e,attrs:{shape:w}}),e.disposeIntermediateTensorInfo(Z)}else{const Z=$pe(y,e.bufferSync(i),O,A);$=e.makeTensorInfo(w,Z.dtype,Z.values)}return $}};class N9e{constructor(t,e,r,i,s,o){this.separator=r_(t),this.nGramWidths=e,this.leftPad=r_(r),this.rightPad=r_(i),this.padWidth=s,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const r=this.getPadWidth(e);return Math.max(0,t+2*r-e+1)}createNGrams(t,e,r,i,s,o){for(let l=0;l<s;++l){const c=this.getPadWidth(o),u=Math.max(0,c-l),f=Math.max(0,c-(s-(l+1))),m=o-(u+f),_=e+(u>0?0:l-c);let y=0;y+=u*this.leftPad.length;for(let A=0;A<m;++A)y+=t[_+A].length;y+=f*this.rightPad.length,y+=(u+f+m-1)*this.separator.length,r[i+l]=new Uint8Array(y);const T=r[i+l];let I=0;const E=A=>A.forEach(M=>T[I++]=M);for(let A=0;A<u;++A)E(this.leftPad),E(this.separator);for(let A=0;A<m-1;++A)E(t[_+A]),E(this.separator);if(m>0){E(t[_+m-1]);for(let A=0;A<f;++A)E(this.separator),E(this.rightPad)}else{for(let A=0;A<f-1;++A)E(this.rightPad),E(this.separator);E(this.rightPad)}}}compute(t,e){const r=t.length,i=e.length;if(i>0){let c=e[0];if(0!==c)throw new Error(`First split value must be 0, got ${c}`);for(let u=1;u<i;++u){let f=e[u]>=c;if(f=f&&e[u]<=r,!f)throw new Error(`Invalid split value ${e[u]}, must be in [${c}, ${r}]`);c=e[u]}if(c!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${c}`)}const s=i-1,o=ns("int32",i);if(0===r||0===i){const c=new Array(r);for(let u=0;u<=s;++u)o[u]=0;return[c,o]}o[0]=0;for(let c=1;c<=s;++c){const u=e[c]-e[c-1];let f=0;this.nGramWidths.forEach(m=>{f+=this.getNumNGrams(u,m)}),this.preserveShort&&u>0&&0===f&&(f=1),o[c]=o[c-1]+f}const l=new Array(o[s]);for(let c=0;c<s;++c){const u=e[c];let f=o[c];if(this.nGramWidths.forEach(m=>{const y=this.getNumNGrams(e[c+1]-e[c],m);this.createNGrams(t,u,l,f,y,m),f+=y}),this.preserveShort&&f===o[c]){const m=e[c+1]-e[c];if(0===m)continue;this.createNGrams(t,u,l,f,1,m+2*this.padWidth)}}return[l,o]}}function Bpe(n,t,e,r,i,s,o,l){return new N9e(e,r,i,s,o,l).compute(n,t)}const M9e={kernelName:GZ,backendName:"cpu",kernelFunc:function R9e(n){const{inputs:t,backend:e,attrs:r}=n,{separator:i,nGramWidths:s,leftPad:o,rightPad:l,padWidth:c,preserveShortSequences:u}=r,{data:f,dataSplits:m}=t,_=e.data.get(f.dataId).values,y=e.data.get(m.dataId).values,[w,T]=Bpe(_,y,i,s,o,l,c,u);return[e.makeTensorInfo([w.length],"string",w),e.makeTensorInfo(m.shape,"int32",T)]}};function O9e(n,t,e,r){if(!n.length)return;if(0===t.length){for(let s=0;s<n.length;++s)r.push(n.subarray(s,s+1));return}if(1===t.length){const s=t[0];let o=n.indexOf(s);for(;-1!==o;){const l=n.subarray(0,o);(!e||0!==l.length)&&r.push(l),o=(n=n.subarray(o+1)).indexOf(s)}return void((!e||0!==n.length)&&r.push(n))}let i=0;for(let s=0;s<n.length+1;s++)if(s===n.length||-1!==t.indexOf(n[s])){const o=n.subarray(i,s);(!e||0!==o.length)&&r.push(o),i=s+1}}function Vpe(n,t,e){const r=n.length,i=[];let s=0,o=0;const l=new Array(r);for(let _=0;_<r;++_){const y=i.length;O9e(n[_],t,e,i);const w=i.length-y;l[_]=w,s+=w,o=Math.max(o,w)}const c=ns("int32",2*s),u=new Array(s),f=[r,o];let m=0;for(let _=0;_<r;++_)for(let y=0;y<l[_];++y)c[2*m]=_,c[2*m+1]=y,u[m]=i[m],++m;return[c,u,f]}const P9e={kernelName:WZ,backendName:"cpu",kernelFunc:function F9e(n){const{inputs:t,backend:e,attrs:r}=n,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(0!==o.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const l=e.data.get(s.dataId).values,c=e.data.get(o.dataId).values[0],[u,f,m]=Vpe(l,c,i),_=f.length;return[e.makeTensorInfo([_,2],"int32",u),e.makeTensorInfo([_],"string",f),e.makeTensorInfo([2],"int32",new Int32Array(m))]}};function Upe(n,t){const e=ns("int32",n.length);for(let r=0;r<n.length;++r)e[r]=aLe(n[r]).modulo(t).getLowBitsUnsigned();return e}const $9e={kernelName:jZ,backendName:"cpu",kernelFunc:function L9e(n){const{inputs:t,backend:e,attrs:r}=n,{numBuckets:i}=r,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const l=Upe(e.data.get(s.dataId).values,i);return e.makeTensorInfo(s.shape,"int32",l)}},B9e=Lr(ON,n=>Math.tan(n)),V9e={kernelName:ON,backendName:"cpu",kernelFunc:B9e},U9e=Lr(FN,n=>Math.tanh(n)),G9e={kernelName:FZ,backendName:"cpu",kernelFunc:function H9e(n){const{inputs:t,backend:e}=n,{tensor:r,indices:i,updates:s}=t,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:f}=n0(0,i,r.shape),_=e.bufferSync(i),y=e.bufferSync(s),w=e.bufferSync(r),T=p0(_,y,r.shape,f,c,l,o,u,w,!1);return e.makeTensorInfo(r.shape,T.dtype,T.values)}};function zpe(n,t){const e=new Array(n.rank);for(let i=0;i<e.length;i++)e[i]=n.shape[i]*t[i];const r=qn(e,n.dtype);for(let i=0;i<r.values.length;++i){const s=r.indexToLoc(i),o=new Array(n.rank);for(let c=0;c<o.length;c++)o[c]=s[c]%n.shape[c];const l=n.locToIndex(o);r.values[i]=n.values[l]}return r}const j9e={kernelName:PN,backendName:"cpu",kernelFunc:function W9e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{reps:s}=r;nn(i,"tile");const o=zpe(e.bufferSync(i),s);return e.makeTensorInfo(o.shape,o.dtype,o.values)}},xR=(n,t)=>{const e=t.value-n.value;return 0===e?n.index-t.index:e};function Hpe(n,t,e=0,r=n.length-1){for(;r>e;){if(r-e>600){const l=r-e+1,c=t-e+1,u=Math.log(l),f=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*f*(l-f)/l)*Math.sign(c-l/2);Hpe(n,t,Math.max(e,Math.floor(t-c*f/l+m)),Math.min(r,Math.floor(t+(l-c)*f/l+m)))}const i=n[t];let s=e,o=r;for(Jg(n,e,t),xR(n[r],i)>0&&Jg(n,e,r);s<o;){for(Jg(n,s,o),s++,o--;xR(n[s],i)<0;)s+=1;for(;xR(n[o],i)>0;)o-=1}0===xR(n[e],i)?Jg(n,e,o):(o+=1,Jg(n,o,r)),o<=t&&(e=o+1),t<=o&&(r=o-1)}}function Gpe(n,t,e,r,i){const s=t[t.length-1],[o,l]=[n.length/s,s],c=vo(e,o*r),u=vo("int32",o*r);for(let m=0;m<o;m++){const _=m*l,y=n.subarray(_,_+l);let w=new Array(y.length);y.forEach((A,M)=>w[M]={value:A,index:M}),r<w.length&&(Hpe(w,r),w=w.slice(0,r)),i&&w.sort(xR);const T=m*r,I=c.subarray(T,T+r),E=u.subarray(T,T+r);for(let A=0;A<r;A++)I[A]=w[A].value,E[A]=w[A].index}const f=t.slice();return f[f.length-1]=r,[qn(f,e,c),qn(f,"int32",u)]}const Z9e={kernelName:qZ,backendName:"cpu",kernelFunc:function q9e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{k:s,sorted:o}=r;nn(i,"topk");const l=e.data.get(i.dataId).values,[c,u]=Gpe(l,i.shape,i.dtype,s,o);return[e.makeTensorInfo(c.shape,c.dtype,c.values),e.makeTensorInfo(u.shape,u.dtype,u.values)]}},K9e={kernelName:ZZ,backendName:"cpu",kernelFunc:function Y9e(n){const{inputs:t,attrs:e,backend:r}=n,{image:i,transforms:s}=t,{interpolation:o,fillMode:l,fillValue:c,outputShape:u}=e,[f,m,_,y]=i.shape,[w,T]=u??[m,_],I=[f,w,T,y],E=pn(i.shape),A=E[0],M=E[1],O=E[2],$=pn(I),V=$[0],Z=$[1],Q=$[2],re=vo(i.dtype,Ye(I));re.fill(c);const oe=r.data.get(i.dataId).values,ye=r.data.get(s.dataId).values;for(let We=0;We<f;++We){const Ke=1===s.shape[0]?ye:ye.subarray(8*We,8*We+8);for(let Qe=0;Qe<w;++Qe)for(let ge=0;ge<T;++ge)for(let we=0;we<y;++we){let _e;const ze=Ke[6]*ge+Ke[7]*Qe+1;if(0===ze)continue;const ht=(Ke[3]*ge+Ke[4]*Qe+Ke[5])/ze,bt=Wpe((Ke[0]*ge+Ke[1]*Qe+Ke[2])/ze,_,l),_t=Wpe(ht,m,l);switch(o){case"nearest":_e=t7e(oe,m,_,A,M,O,We,_t,bt,we,c);break;case"bilinear":_e=n7e(oe,m,_,A,M,O,We,_t,bt,we,c);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}re[We*V+Qe*Z+ge*Q+we]=_e}return r.makeTensorInfo(I,i.dtype,re)}return{dataId:r.write(re,I,i.dtype),shape:i.shape,dtype:i.dtype}}};function Wpe(n,t,e){switch(e){case"reflect":return function Q9e(n,t){let e=n;if(e<0)if(t<=1)e=0;else{const r=2*t;e<r&&(e=r*Math.trunc(-e/r)+e),e=e<-t?e+r:-e-1}else if(e>t-1)if(t<=1)e=0;else{const r=2*t;e-=r*Math.trunc(e/r),e>=t&&(e=r-e-1)}return Vb(0,e,t-1)}(n,t);case"wrap":return function X9e(n,t){let e=n;return e<0?t<=1?e=0:e+=t*(Math.trunc(-e/(t-1))+1):e>t-1&&(t<=1?e=0:e-=t*Math.trunc(e/(t-1))),Vb(0,e,t-1)}(n,t);case"nearest":return function e7e(n,t){return Vb(0,n,t-1)}(n,t);default:return function J9e(n,t){return n}(n)}}function IR(n,t,e,r,i,s,o,l,c,u,f){return 0<=l&&l<t&&0<=c&&c<e?n[o*r+l*i+c*s+u]:f}function t7e(n,t,e,r,i,s,o,l,c,u,f){return IR(n,t,e,r,i,s,o,Math.round(l),Math.round(c),u,f)}function n7e(n,t,e,r,i,s,o,l,c,u,f){const m=Math.floor(l),_=Math.floor(c),y=m+1,w=_+1;return(y-l)*((w-c)*IR(n,t,e,r,i,s,o,m,_,u,f)+(c-_)*IR(n,t,e,r,i,s,o,m,w,u,f))+(l-m)*((w-c)*IR(n,t,e,r,i,s,o,y,_,u,f)+(c-_)*IR(n,t,e,r,i,s,o,y,w,u,f))}function jpe(n,t,e,r){const i=Kn(t,e)[0],s=[1,e[0],1];for(let w=0;w<i;w++)s[0]*=e[w];s[1]=e[i];for(let w=i+1;w<e.length;w++)s[2]*=e[w];const o=new Map,l=new Int32Array(e[i]),c=new Ds(s,r,n),u=[],f=1===s[0]&&1===s[2];for(let w=0;w<e[i];w++){let T;if(f)T=n[w].toString();else{const E=[];for(let A=0;A<s[0];A++)for(let M=0;M<s[2];M++)E.push(c.get(A,w,M));T=E.join(",")}const I=o.get(T);if(null!=I)l[w]=I;else{const E=o.size;o.set(T,E),l[w]=E,u.push(w)}}const m=s.slice();m[1]=o.size;const _=new Ds(m,r);u.forEach((w,T)=>{for(let I=0;I<s[0];I++)for(let E=0;E<s[2];E++)_.set(c.get(I,w,E),I,T,E)});const y=e.slice();return y[i]=m[1],{outputValues:_.values,outputShape:y,indices:l}}const i7e={kernelName:YZ,backendName:"cpu",kernelFunc:function r7e(n){const{inputs:t,attrs:e,backend:r}=n,{axis:i}=e,{x:s}=t;nn(s,"unique");const o=r.data.get(s.dataId).values,{outputValues:l,outputShape:c,indices:u}=jpe(o,i,s.shape,s.dtype);return[r.makeTensorInfo(c,s.dtype,l),r.makeTensorInfo([u.length],"int32",u)]}},o7e={kernelName:rV,backendName:"cpu",kernelFunc:function s7e(n){const{inputs:t,backend:e,attrs:r}=n,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i.shape.length,l=i.shape[s],c=new Array(o-1);let u=0;for(let y=0;y<o;y++)y!==s&&(c[u++]=i.shape[y]);const f=new Array(o).fill(0),m=i.shape.slice();m[s]=1;const _=new Array(l);for(let y=0;y<_.length;y++){f[s]=y;const w=f0({inputs:{x:i},backend:e,attrs:{begin:f,size:m}});_[y]=ri({inputs:{x:w},backend:e,attrs:{shape:c}}),e.disposeIntermediateTensorInfo(w)}return _}},l7e={kernelName:iV,backendName:"cpu",kernelFunc:function a7e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,segmentIds:s}=t,{numSegments:o}=r;nn(i,"unsortedSegmentSum");const u=[],f=[],m=i.shape.length-s.shape.length;let _=s;for(let w=0;w<m;++w){const T=R3({inputs:{input:_},backend:e,attrs:{dim:w+1}});_=T,f.push(T)}for(let w=0;w<o;++w){const T=n_(w,"int32"),I=e.makeTensorInfo([],"int32",T),E=Qfe({inputs:{a:I,b:_},backend:e}),A=S_({inputs:{x:E},backend:e,attrs:{dtype:"float32"}}),M=N3({inputs:{a:A,b:i},backend:e}),O=CR({inputs:{x:M},backend:e,attrs:{axis:0,keepDims:!1}});u.push(O),f.push(I),f.push(E),f.push(A),f.push(M),f.push(O)}const y=wpe({inputs:u,backend:e,attrs:{axis:0}});return f.forEach(w=>e.disposeIntermediateTensorInfo(w)),y}},c7e=[r5e,i5e,o5e,l5e,Jqe,u5e,f5e,m5e,_5e,v5e,w5e,x5e,T5e,D5e,A5e,M5e,F5e,L5e,B5e,t5e,U5e,G5e,j5e,Z5e,K5e,Qqe,X5e,eZe,Yqe,tZe,rZe,iZe,oZe,lZe,uZe,hZe,pZe,gZe,yZe,bZe,CZe,IZe,SZe,DZe,kZe,NZe,MZe,FZe,PZe,LZe,$Ze,VZe,WZe,Vqe,qZe,ZZe,n8e,r8e,i8e,o8e,p8e,m8e,_8e,v8e,w8e,x8e,T8e,E8e,k8e,N8e,M8e,Uqe,F8e,nZe,L8e,B8e,U8e,zqe,H8e,W8e,q8e,Y8e,Q8e,eYe,nYe,sYe,aYe,cYe,uYe,hYe,pYe,gYe,yYe,bYe,CYe,IYe,SYe,DYe,AYe,MYe,PYe,zZe,$Ye,UYe,GYe,qYe,YYe,QYe,JYe,eKe,Cpe,iKe,Gqe,oKe,pKe,gKe,yKe,bKe,Kqe,y9,CKe,Wqe,jqe,e5e,IKe,SKe,DKe,AKe,RKe,MKe,FKe,LKe,BKe,GKe,jKe,KKe,Zqe,XKe,e9e,n9e,z5e,OYe,i9e,o9e,l9e,u9e,h9e,p9e,g9e,y9e,w9e,C9e,I9e,S9e,D9e,A9e,M9e,P9e,$9e,c8e,HZe,V9e,{kernelName:FN,backendName:"cpu",kernelFunc:U9e},G9e,j9e,Z9e,K9e,d5e,i7e,o7e,l7e,XYe];for(const n of c7e)JZ(n);const E_={},F3={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function hd(n,t){if(!(n in E_)||null!=t){const r=function h7e(n,t){if(1!==n&&2!==n)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=t??function d7e(n){if(!Me().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&2===n)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return e.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete E_[n]},!1),Me().getBool("SOFTWARE_WEBGL_ENABLED")&&(F3.failIfMajorPerformanceCaveat=!1),1===n?e.getContext("webgl",F3)||e.getContext("experimental-webgl",F3):e.getContext("webgl2",F3)}(n,t);if(null===r)return console.log("Could not get context for WebGL version",n),null;E_[n]=r}const e=E_[n];return null==e||e.isContextLost()?(delete E_[n],hd(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),E_[n])}var AT=(()=>(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"}(AT||(AT={})),AT))(),Ll=(()=>(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"}(Ll||(Ll={})),Ll))(),Xs=(()=>(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Xs||(Xs={})),Xs))();function TR(n,t){return[t,n]}function P3(n){const t=Ye(n);return L5(Math.ceil(t/4))}function NT(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function x9(n,t){const e=n;let r,i,s,o,l,c,u,f,m,_;return 2===Me().getNumber("WEBGL_VERSION")?(r=e.R32F,i=e.R16F,s=e.RGBA16F,o=e.RGBA32F,l=e.RED,u=4,f=1,m=e.HALF_FLOAT,_=e.FLOAT,c=e.RGBA8):(r=n.RGBA,i=n.RGBA,s=n.RGBA,o=e.RGBA,l=n.RGBA,u=4,f=4,m=null!=t?t.HALF_FLOAT_OES:null,_=n.FLOAT,c=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:o,textureFormatFloat:l,downloadTextureFormat:c,downloadUnpackNumChannels:u,defaultNumChannels:f,textureTypeHalfFloat:m,textureTypeFloat:_}}function Bt(n,t){const e=t();return Me().getBool("DEBUG")&&function m7e(n){const t=n.getError();if(t!==n.NO_ERROR)throw new Error("WebGL Error: "+function v7e(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}(n,t))}(n),e}function y7e(n){return!!(Me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===n||5.96e-8<Math.abs(n)&&Math.abs(n)<65504)}function L3(n,t){return Ep(n,()=>n.getExtension(t),'Extension "'+t+'" not supported on this browser.')}const C7e=/ERROR: [0-9]+:([0-9]+):/g;function qpe(n,t){const e=C7e.exec(t);if(null==e)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(n);const r=+e[1],i=n.split("\n"),s=i.length.toString().length+2,o=i.map((m,_)=>QI((_+1).toString(),s)+m);let l=0;for(let m=0;m<o.length;m++)l=Math.max(o[m].length,l);const c=o.slice(0,r-1),u=o.slice(r-1,r),f=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${QI(u[0],l)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}function I9(n,t){if(Bt(n,()=>n.validateProgram(t)),!1===n.getProgramParameter(t,n.VALIDATE_STATUS))throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Zpe(n,t,e,r,i,s,o){const l=n.getAttribLocation(t,e);return-1!==l&&(Bt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),Bt(n,()=>n.vertexAttribPointer(l,i,n.FLOAT,!1,s,o)),Bt(n,()=>n.enableVertexAttribArray(l)),!0)}function M7e(n,t,e,r){Bt(n,()=>function A7e(n,t,e){(function Kpe(n,t){const e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+n.TEXTURE0;if(r<n.TEXTURE0||r>e)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${e}].`)})(n,e),Bt(n,()=>n.activeTexture(n.TEXTURE0+e)),Bt(n,()=>n.bindTexture(n.TEXTURE_2D,t))}(n,t,r)),Bt(n,()=>n.uniform1i(e,r))}function T9(n,t,e){Bt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),Bt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0))}function Ype(n,t){Bt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),Bt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function $3(n){const t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function O7e(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}(n,t))}function Ep(n,t,e){const r=Bt(n,()=>t());if(null==r)throw new Error(e);return r}function RT(n,t=2){return Ye(n.slice(0,n.length-t))}function MT(n){if(0===n.length)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function B3(n){let t=[1,1,1];return 0===n.length||1===n.length&&1===n[0]||(t=[RT(n),...MT(n)]),t}function V3(n){return n%2==0}function U3(n,t){if(dr(n=n.slice(-2),t=t.slice(-2))||!n.length||!t.length||0===n[0]||0===n[1]||0===t[0]||0===t[1])return!0;if(n.length!==t.length){const e=n[n.length-1],r=t[t.length-1];if(e===r||V3(e)&&V3(r)&&(1===n[0]||1===t[0]))return!0}return n[1]===t[1]&&V3(n[0])&&V3(t[0])}let z3,H3;function gu(n,t){return null!=n.getExtension(t)}function Qpe(n){try{if(null!=hd(n))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function S9(n){const t=x9(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const s=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,s),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(s),o}function SR(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{null!=e&&G("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}const sn=Me();function Ia(){let n,t,e,r,i,s,o,l,c,u;return 2===Me().getNumber("WEBGL_VERSION")?(n="#version 300 es",t="in",e="out",r="in",i="texture",s="outputColor",o="out vec4 outputColor;",l=Me().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",c="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(n="",t="attribute",e="varying",r="varying",i="texture2D",s="gl_FragColor",o="",l="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:n,attribute:t,varyingVs:e,varyingFs:r,texture2D:i,output:s,defineOutput:o,defineSpecialNaN:l,defineSpecialInf:c,defineRound:u}}function m0(n,t,e="index"){const r=pn(t);return r.map((i,s)=>`int ${n[s]} = ${e} / ${i}; ${s===r.length-1?`int ${n[s+1]} = ${e} - ${n[s]} * ${i}`:`index -= ${n[s]} * ${i}`};`).join("")}function G3(n,t,e="index"){const r=pn(t);return r.map((i,s)=>`int ${n[s]} = ${e} / outShapeStrides[${s}]; ${s===r.length-1?`int ${n[s+1]} = ${e} - ${n[s]} * outShapeStrides[${s}]`:`index -= ${n[s]} * outShapeStrides[${s}]`};`).join("")}function E9(n){const t=pn(n).map(e=>e.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}sn.registerFlag("HAS_WEBGL",()=>sn.getNumber("WEBGL_VERSION")>0),sn.registerFlag("WEBGL_VERSION",()=>Qpe(2)?2:Qpe(1)?1:0),sn.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),sn.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===sn.get("WEBGL_VERSION")),sn.registerFlag("WEBGL_CPU_FORWARD",()=>!0),sn.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),sn.registerFlag("WEBGL_PACK",()=>sn.getBool("HAS_WEBGL")),sn.registerFlag("WEBGL_PACK_NORMALIZATION",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_PACK_CLIP",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_PACK_REDUCE",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_LAZILY_UNPACK",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_CONV_IM2COL",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>sn.getBool("WEBGL_PACK")),sn.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function P7e(n){if(null==z3){const t=hd(n);z3=t.getParameter(t.MAX_TEXTURE_SIZE)}return z3}(sn.getNumber("WEBGL_VERSION"))),sn.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function L7e(n){if(null==H3){const t=hd(n);H3=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,H3)}(sn.getNumber("WEBGL_VERSION"))),sn.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=sn.getNumber("WEBGL_VERSION");return 0===n?0:function $7e(n){if(0===n)return 0;let t;const e=hd(n);return t=gu(e,"EXT_disjoint_timer_query_webgl2")&&2===n?2:gu(e,"EXT_disjoint_timer_query")?1:0,t}(n)}),sn.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>sn.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Kle()),sn.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function B7e(n){if(0===n)return!1;const t=hd(n);if(1===n){if(!gu(t,"OES_texture_float"))return!1}else if(!gu(t,"EXT_color_buffer_float"))return!1;return S9(t)}(sn.getNumber("WEBGL_VERSION"))),sn.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!sn.getBool("WEBGL_FORCE_F16_TEXTURES")&&sn.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),sn.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>function V7e(n){if(0===n)return!1;const t=hd(n);if(1!==n){if(gu(t,"EXT_color_buffer_float"))return S9(t);const r="EXT_color_buffer_half_float";if(gu(t,r)){const i=t.getExtension(r);return function U7e(n,t){const e=x9(n,t),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatHalfFloat,1,1,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const l=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(o),l}(t,i)}return!1}return!(!gu(t,"OES_texture_float")||!gu(t,"WEBGL_color_buffer_float"))&&S9(t)}(sn.getNumber("WEBGL_VERSION"))),sn.registerFlag("WEBGL_FENCE_API_ENABLED",()=>function z7e(n){return 2===n&&null!=hd(n).fenceSync}(sn.getNumber("WEBGL_VERSION"))),sn.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>sn.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),sn.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if("number"!=typeof n)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&-1!==n)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)}),sn.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Kle()?1:-1,n=>{if("number"!=typeof n)throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&-1!==n)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)}),sn.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),sn.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),sn.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),sn.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),sn.registerFlag("WEBGL_EXP_CONV",()=>!1),sn.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>sn.getBool("IS_TEST")),sn.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),sn.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),sn.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),sn.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);const Xpe="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:Jpe}=je;function W7e(n,t,e){const r=[];if(n.forEach(y=>{const w=Ye(y.shapeInfo.logicalShape);if(y.shapeInfo.isUniform?r.push(`uniform float ${y.name}${w>1?`[${w}]`:""};`):(r.push(`uniform sampler2D ${y.name};`),r.push(`uniform int offset${y.name};`)),e.enableShapeUniforms){const{uniformShape:T}=k9(e.packedInputs,y.shapeInfo.logicalShape,y.shapeInfo.texShape);switch(T.length){case 1:r.push(`uniform int ${y.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${y.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${y.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${y.name}Shape;`)}r.push(`uniform ivec2 ${y.name}TexShape;`)}}),e.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}e.customUniforms&&e.customUniforms.forEach(y=>{r.push(`uniform ${y.type} ${y.name}${y.arrayIndex?`[${y.arrayIndex}]`:""};`)});const i=r.join("\n"),s=n.map(y=>function j7e(n,t,e=!1,r){let i="";return i+=e?eme(n,r):OT(n,r),n.shapeInfo.logicalShape.length<=t.logicalShape.length&&(i+=e?function TQe(n,t){const e=n.name,r=e.charAt(0).toUpperCase()+e.slice(1),i="get"+r+"AtOutCoords",s=n.shapeInfo.logicalShape.length,o=t.logicalShape.length,l=Jpe(n.shapeInfo.logicalShape,t.logicalShape),c=qr(o),u=o-s;let f;const m=["x","y","z","w","u","v"];f=0===s?"":o<2&&l.length>=1?"coords = 0;":l.map(A=>`coords.${m[A+u]} = 0;`).join("\n");let _="";_=o<2&&s>0?"coords":n.shapeInfo.logicalShape.map((A,M)=>`coords.${m[M+u]}`).join(", ");let y="return outputValue;";const T=1===Ye(n.shapeInfo.logicalShape),E=1===Ye(t.logicalShape);if(1!==s||T||E){if(T&&!E)y=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){const A=s-2,M=s-1;l.indexOf(A)>-1&&l.indexOf(M)>-1?y="return vec4(outputValue.x);":l.indexOf(A)>-1?y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(M)>-1&&(y="return vec4(outputValue.xx, outputValue.zz);")}}else y="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${c} coords = getOutputCoords();\n      ${f}\n      vec4 outputValue = get${r}(${_});\n      ${y}\n    }\n  `}(n,t):function SQe(n,t){const e=n.name,r=e.charAt(0).toUpperCase()+e.slice(1),i="get"+r+"AtOutCoords",l=n.shapeInfo.logicalShape.length,c=t.logicalShape.length;if(!n.shapeInfo.isUniform&&l===c&&null==n.shapeInfo.flatOffset&&dr(n.shapeInfo.texShape,t.texShape))return`\n      float ${i}() {\n        return sampleTexture(${e}, resultUV);\n      }\n    `;const u=qr(c),f=Jpe(n.shapeInfo.logicalShape,t.logicalShape),m=c-l;let _;const y=["x","y","z","w","u","v"];_=0===l?"":c<2&&f.length>=1?"coords = 0;":f.map(T=>`coords.${y[T+m]} = 0;`).join("\n");let w="";return w=c<2&&l>0?"coords":n.shapeInfo.logicalShape.map((T,I)=>`coords.${y[I+m]}`).join(", "),`\n    float ${i}() {\n      ${u} coords = getOutputCoords();\n      ${_}\n      return get${r}(${w});\n    }\n  `}(n,t)),i}(y,t,e.packedInputs,e.enableShapeUniforms)).join("\n"),o=t.texShape,l=Ia(),c=function Y7e(n){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${n.texture2D}(textureSampler, uv).r;\n    }\n  `}(l);let u,f,m=function X7e(n){return`${n.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${n.varyingFs} vec2 resultUV;\n    ${n.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${n.defineSpecialNaN}\n    ${n.defineSpecialInf}\n    ${n.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${J7e}\n    ${eQe}\n    ${tQe}\n  `}(l);return t.isPacked?(u=function q7e(n,t,e){switch(n.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function rQe(n,t,e){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===r[0]?e?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `:1===r[1]?e?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `:e?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}(0,t,e);case 2:return function dQe(n,t,e){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(dr(n,t))return e?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const i=Math.ceil(n[1]/2);return e?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(n,t,e);case 3:return function sQe(n,t,e){if(e)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(n[2]/2),s=i*Math.ceil(n[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(n,t,e);default:return function aQe(n,t,e){if(e)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(n[n.length-1]/2),s=i*Math.ceil(n[n.length-2]/2);let o=s,l="",c="b, r, c";for(let u=2;u<n.length-1;u++)o*=n[n.length-u-1],l=`\n      int b${u} = index / ${o};\n      index -= b${u} * ${o};\n    `+l,c=`b${u}, `+c;return`\n    ivec${n.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${l}\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec${n.length}(${c});\n    }\n  `}(n,t,e)}}(t.logicalShape,o,e.enableShapeUniforms),f=function Q7e(n){return`\n    void setOutput(vec4 val) {\n      ${n.output} = val;\n    }\n  `}(l)):(u=function Z7e(n,t,e){switch(n.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function iQe(n,t,e){return 1===t[0]?e?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `:1===t[1]?e?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `:e?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,e);case 2:return function hQe(n,t,e){return dr(n,t)?e?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `:1===n[1]?e?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===n[0]?e?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:e?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${n[1]};\n      int c = index - r * ${n[1]};\n      return ivec2(r, c);\n    }\n  `}(n,t,e);case 3:return function oQe(n,t,e){if(e)return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${G3(["r","c","d"],n)}\n    return ivec3(r, c, d);\n  }\n`;const r=m0(["r","c","d"],n);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}(n,t,e);case 4:return function lQe(n,t,e){if(e)return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${G3(["r","c","d","d2"],n)}\n      return ivec4(r, c, d, d2);\n    }\n  `;const r=m0(["r","c","d","d2"],n);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}(n,t,e);case 5:return function cQe(n,t){const e=m0(["r","c","d","d2","d3"],n);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${e}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(n,t);case 6:return function uQe(n,t){const e=m0(["r","c","d","d2","d3","d4"],n);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${e}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(n,t);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}(t.logicalShape,o,e.enableShapeUniforms),f=function K7e(n){return`\n    void setOutput(float val) {\n      ${n.output} = vec4(val, 0, 0, 0);\n    }\n  `}(l)),e.packedInputs&&(m+=nQe),[m,c,f,i,u,s,e.userCode].join("\n")}function OT(n,t=!1){const e=n.shapeInfo.logicalShape;switch(e.length){case 0:return function pQe(n,t){const e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${e};}`;const[i,s]=n.shapeInfo.texShape;if(1===i&&1===s)return`\n      float ${r}() {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const o=g0(e);if(t)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `;const[l,c]=n.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${l}, ${c}, ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `}(n,t);case 1:return function gQe(n,t){const e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${FT(n)}\n      }\n    `;const i=n.shapeInfo.texShape,s=i[0],o=i[1];if(1===o&&1===s)return`\n      float ${r}(int index) {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const l=g0(e);return 1===o?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / float(${e}TexShape[0]));\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / ${s}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `:1===s?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${l}) + 0.5) / float(${e}TexShape[1]), 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${l}) + 0.5) / ${o}.0, 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:t?`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], index + ${l});\n      return sampleTexture(${e}, uv);\n    }\n  `:`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${s}, ${o}, index + ${l});\n      return sampleTexture(${e}, uv);\n    }\n  `}(n,t);case 2:return function yQe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape;if(null!=s&&dr(e,s))return t?`\n      float ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${s[1]}.0, ${s[0]}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const{newShape:o,keptDims:l}=e_(e);if(o.length<e.length){const y=["row","col"];return`\n      ${OT(PT(n,o),t)}\n      float ${i}(int row, int col) {\n        return ${i}(${LT(y,l)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${i}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));\n        ${FT(n)}\n      }\n    `;const u=s[0],f=s[1],m=g0(r);return 1===f?t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${m}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${m}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `:1===u?t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${m}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${m}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${f}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `:t?`\n      float ${i}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${m};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n  float ${i}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${e[1]} + col + ${m};\n    vec2 uv = uvFromFlat(${u}, ${f}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}(n,t);case 3:return function bQe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e[1]*e[2],o=e[2],{newShape:l,keptDims:c}=e_(e);if(l.length<e.length){const I=["row","col","depth"];return`\n        ${OT(PT(n,l),t)}\n        float ${i}(int row, int col, int depth) {\n          return ${i}(${LT(I,c)});\n        }\n      `}if(n.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${s}, ${o}, 1)));\n        ${FT(n)}\n      }\n    `;const f=n.shapeInfo.texShape,m=f[0],_=f[1],y=n.shapeInfo.flatOffset;if(_===s&&null==y)return t?`\n      float ${i}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${i}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${o}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${_}.0, ${m}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(_===o&&null==y)return t?`\n      float ${i}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${_}.0, ${m}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const w=g0(r);return t?`\n    float ${i}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${w};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `:`\n      float ${i}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${s} + col * ${o} + depth + ${w};\n        vec2 uv = uvFromFlat(${m}, ${_}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}(n,t);case 4:return function CQe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e[3],o=e[2]*s,l=e[1]*o,{newShape:c,keptDims:u}=e_(e);if(c.length<e.length){const M=["row","col","depth","depth2"];return`\n      ${OT(PT(n,c),t)}\n      float ${i}(int row, int col, int depth, int depth2) {\n        return ${i}(${LT(M,u)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${l}, ${o}, ${s}, 1)));\n        ${FT(n)}\n      }\n    `;const f=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,_=m[0],y=m[1],w=`int stride2 = ${r}Shape[3];`,T=`int stride1 = ${r}Shape[2] * stride2;`,I=`int stride0 = ${r}Shape[1] * stride1;`;if(y===l&&null==f)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        ${w}\n        ${T}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${o}, ${s}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${y}.0, ${_}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(y===s&&null==f)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${e[1]*e[2]}, ${e[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${y}.0, ${_}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const E=g0(r);return t?`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${w}\n      ${T}\n      ${I}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${E});\n      return sampleTexture(${r}, uv);\n    }\n  `:`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${l} + col * ${o} +\n          depth * ${s} + depth2;\n      vec2 uv = uvFromFlat(${_}, ${y}, index + ${E});\n      return sampleTexture(${r}, uv);\n    }\n  `}(n,t);case 5:return function xQe(n){const t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),i=t[4],s=t[3]*i,o=t[2]*s,l=t[1]*o,{newShape:c,keptDims:u}=e_(t);if(c.length<t.length){const I=["row","col","depth","depth2","depth3"];return`\n      ${OT(PT(n,c))}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${LT(I,u)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${l}, ${o}, ${s}, ${i})) +\n          depth3;\n        ${FT(n)}\n      }\n    `;const f=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,_=m[0],y=m[1];if(y===l&&null==f)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${o}, ${s}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${y}.0, ${_}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;if(y===i&&null==f)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${y}.0, ${_}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${l} + col * ${o} + depth * ${s} +\n          depth2 * ${i} + depth3 + ${g0(e)};\n      vec2 uv = uvFromFlat(${_}, ${y}, index);\n      return sampleTexture(${e}, uv);\n    }\n  `}(n);case 6:return function IQe(n){const t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:i,keptDims:s}=e_(t);if(i.length<t.length){const E=["row","col","depth","depth2","depth3","depth4"];return`\n      ${OT(PT(n,i))}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${LT(E,s)});\n      }\n    `}const o=t[5],l=t[4]*o,c=t[3]*l,u=t[2]*c,f=t[1]*u;if(n.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${f}, ${u}, ${c}, ${l})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${o}, 1)));\n        ${FT(n)}\n      }\n    `;const m=n.shapeInfo.flatOffset,_=n.shapeInfo.texShape,y=_[0],w=_[1];if(w===f&&null==m)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${u}, ${c}, ${l}, ${o})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${w}.0, ${y}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;if(w===o&&null==m)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${w}.0, ${y}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${f} + col * ${u} + depth * ${c} +\n          depth2 * ${l} + depth3 * ${o} + depth4 + ${g0(e)};\n      vec2 uv = uvFromFlat(${y}, ${w}, index);\n      return sampleTexture(${e}, uv);\n    }\n  `}(n);default:throw new Error(`${e.length}-D input sampling is not yet supported`)}}function eme(n,t){switch(n.shapeInfo.logicalShape.length){case 0:return function fQe(n){const t=n.name;return`\n    vec4 ${"get"+t.charAt(0).toUpperCase()+t.slice(1)}() {\n      return ${Ia().texture2D}(${t}, halfCR);\n    }\n  `}(n);case 1:return function mQe(n,t){const e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),i=n.shapeInfo.texShape,s=Ia();if(t)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${s.texture2D}(${e}, uv);\n    }\n  `;const o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${o[0]}, ${o[1]}, index);\n      return ${s.texture2D}(${e}, uv);\n    }\n  `}(n,t);case 2:return function _Qe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape,o=s[0],l=s[1],c=Ia();if(null!=s&&dr(e,s))return t?`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${c.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${l}.0, ${o}.0);\n\n        return ${c.texture2D}(${r}, uv);\n      }\n    `;if(t)return`\n    vec4 ${i}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${c.texture2D}(${r}, uv);\n    }\n  `;const u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(e[1]/2)}, ${u[0]}, ${u[1]}, row, col);\n      return ${c.texture2D}(${r}, uv);\n    }\n  `}(n,t);case 3:return function vQe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(1===e[0]){const y=[1,2],T=["b","row","col"];return`\n        ${eme(PT(n,e.slice(1)),t)}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${LT(T,y)});\n        }\n      `}const l=Ia();if(t)return`\n    vec4 ${i}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `;const c=o[0],u=o[1],f=Math.ceil(e[2]/2);return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${c}, ${u}, ${f*Math.ceil(e[1]/2)}, ${f}, b, row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `}(n,t);default:return function wQe(n,t){const e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),i=Ia();if(t)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${e}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${e}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${e}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${e}, uv);\n    }\n  `;const s=n.shapeInfo.logicalShape,o=s.length,l=n.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],u=c[0],f=c[1],m=Math.ceil(s[o-1]/2);let _=m*Math.ceil(s[o-2]/2),y="int b, int row, int col",w=`b * ${_} + (row / 2) * ${m} + (col / 2)`;for(let T=2;T<o-1;T++)y=`int b${T}, `+y,_*=s[o-T-1],w=`b${T} * ${_} + `+w;return`\n    vec4 ${r}(${y}) {\n      int index = ${w};\n      int texR = index / ${f};\n      int texC = index - texR * ${f};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}, ${u});\n      return ${i.texture2D}(${e}, uv);\n    }\n  `}(n,t)}}const J7e="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",eQe="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",tQe="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",nQe="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function g0(n){return`offset${n}`}function FT(n){const t=n.name,e=Ye(n.shapeInfo.logicalShape);return e<2?`return ${t};`:`\n    for (int i = 0; i < ${e}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function qr(n){if(n<=1)return"int";if(2===n)return"ivec2";if(3===n)return"ivec3";if(4===n)return"ivec4";if(5===n)return"ivec5";if(6===n)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function k9(n,t,e){const{newShape:r,keptDims:i}=e_(t),s=t.length,o=n&&3===s&&1===t[0],l=o?t.slice(1):r,c=!n&&s>1&&!dr(t,e)&&r.length<s||o;return{useSqueezeShape:c,uniformShape:c?l:t,keptDims:i}}function PT(n,t){const e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function LT(n,t){return t.map(e=>n[e]).join(", ")}function nme(n,t,e){const r=[],i=[];let s,o,l,c=null,u=null;u=n.getUniformLocation(e,"NAN",!1),1===Me().getNumber("WEBGL_VERSION")&&(c=n.getUniformLocation(e,"INFINITY",!1));const f=!1;for(const m of t.variableNames){const _={name:m,uniform:n.getUniformLocation(e,m,f),offset:n.getUniformLocation(e,`offset${m}`,f)};t.enableShapeUniforms&&(_.shape=n.getUniformLocation(e,`${m}Shape`,f),_.texShape=n.getUniformLocation(e,`${m}TexShape`,f)),r.push(_)}if(t.enableShapeUniforms&&(s=n.getUniformLocation(e,"outShape",f),l=n.getUniformLocation(e,"outShapeStrides",f),o=n.getUniformLocation(e,"outTexShape",f)),t.customUniforms)for(const m of t.customUniforms)i.push(n.getUniformLocation(e,m.name,f));return{variablesLocations:r,customUniformLocations:i,infLoc:c,nanLoc:u,outShapeLocation:s,outShapeStridesLocation:l,outTexShapeLocation:o}}function rme(n,t){if(n.length!==t.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${t.length} inputs`);n.forEach((e,r)=>{const i=e.logicalShape,s=t[r],o=s.shape;if(!dr(i,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${o} must match`);if(e.isUniform&&s.isUniform)return;const l=e.texShape,c=s.isUniform?null:s.texData.texShape;if(!dr(l,c))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${l} and ${c} must match`)})}function ea(n){return Me().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}class AQe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=AT.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=Ia();this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?G3(["r","c","d"],t):m0(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${e.output} = result;\n      }\n    `}}class NQe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=AT.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=Ia();this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?G3(["r","c","d"],t):m0(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${e.output} = result;\n      }\n    `}}class RQe{constructor(t){this.variableNames=["A"],this.outTexUsage=Ll.DOWNLOAD;const e=Ia();this.outputShape=t,this.userCode=`\n      ${Xpe}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}class MQe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ll.DOWNLOAD;const e=Ia();this.outputShape=t,this.userCode=`\n      ${Xpe}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}const OQe={R:0,G:1,B:2,A:3};class ime{constructor(t,e=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=Ia();this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length);let s="result";e&&(s="floor(result * 255. + 0.5)");let o="";for(let l=0;l<r.length;l++)o+=`\n          if(offset == ${l}) {\n            result = values[${OQe[r[l]]}];\n          }`;this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":E9(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ${r.length});\n\n        flatIndex = idiv(flatIndex, ${r.length}, 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ${i.texture2D}(A, uv);\n          ${o}\n        }\n        ${i.output} = vec4(${s}, 0., 0., 0.);\n      }\n    `}}class FQe{constructor(t,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Ia();this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length);let i="",s="result";e&&(s="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let l=0;l<=1;l++){const c=2*o+l;i+=`\n          localCoords = coords;\n          if(localCoords[2] + ${l} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {\n          localCoords[2] += ${l};\n          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {\n            localCoords[1] += ${o};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${r.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${c}] = values[0];\n            } else if (offset == 1) {\n              result[${c}] = values[1];\n            } else if (offset == 2) {\n              result[${c}] = values[2];\n            } else {\n              result[${c}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":E9(t)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${i}\n\n          ${r.output} = ${s};\n        }\n    `}}function ER(n,t,e,r,i,s){!function D7e(n,t){const e=Me().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0)throw new Error(`Requested texture size [${n}x${t}] is invalid.`);if(n>e||t>e)throw new Error(`Requested texture size [${n}x${t}] greater than WebGL maximum on this browser / GPU [${e}x${e}].`)}(t,e);const o=function E7e(n){return Ep(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}(n),l=n.TEXTURE_2D;return Bt(n,()=>n.bindTexture(l,o)),Bt(n,()=>n.texParameteri(l,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),Bt(n,()=>n.texParameteri(l,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),Bt(n,()=>n.texParameteri(l,n.TEXTURE_MIN_FILTER,n.NEAREST)),Bt(n,()=>n.texParameteri(l,n.TEXTURE_MAG_FILTER,n.NEAREST)),1===Me().getNumber("WEBGL_VERSION")?Bt(n,()=>n.texImage2D(l,0,r,t,e,0,i,s,null)):Bt(n,()=>n.texStorage2D(l,1,r,t,e)),Bt(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:o,texShape:[e,t]}}function sme(n){return n.internalFormatFloat}function ome(n){return n.internalFormatHalfFloat}function ame(n){return n.downloadTextureFormat}function lme(n){return n.internalFormatPackedFloat}function cme(n){return n.internalFormatPackedHalfFloat}class A9{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=Me().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function u7e(n,t){E_[n]=t}(e,t)):this.gl=hd(e),t=this.gl,2===Me().getNumber("WEBGL_VERSION")){const s=t;this.createVertexArray=()=>Bt(s,()=>s.createVertexArray()),this.bindVertexArray=o=>Bt(s,()=>s.bindVertexArray(o)),this.deleteVertexArray=o=>Bt(s,()=>s.deleteVertexArray(o)),this.getVertexArray=()=>Bt(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(null!=t){const s=t.getExtension("OES_vertex_array_object");if(null==s)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Bt(t,()=>s.createVertexArrayOES()),this.bindVertexArray=o=>Bt(t,()=>s.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Bt(t,()=>s.deleteVertexArrayOES(o)),this.getVertexArray=()=>Bt(t,()=>t.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===Me().getNumber("WEBGL_VERSION")){const o="OES_texture_half_float";if(this.textureFloatExtension=L3(this.gl,"OES_texture_float"),gu(this.gl,o))this.textureHalfFloatExtension=L3(this.gl,o);else if(Me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),gu(this.gl,i))this.colorBufferHalfFloatExtension=L3(this.gl,i);else if(Me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",gu(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!gu(this.gl,i))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(i)}this.vertexBuffer=function LQe(n){return function T7e(n,t){const e=Ep(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Bt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),Bt(n,()=>n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)),e}(n,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl),this.indexBuffer=function $Qe(n){return function S7e(n,t){const e=Ep(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Bt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e)),Bt(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)),e}(n,new Uint16Array([0,1,2,2,1,3]))}(this.gl),this.framebuffer=function k7e(n){return Ep(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=x9(this.gl,this.textureHalfFloatExtension)}get debug(){return Me().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Bt(t,()=>t.finish()),Bt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Bt(t,()=>t.deleteFramebuffer(this.framebuffer)),Bt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Bt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Bt(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function BQe(n,t,e,r){const[i,s]=TR(t,e);return ER(n,i,s,sme(r),r.textureFormatFloat,n.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function VQe(n,t,e,r){const[i,s]=TR(t,e);return ER(n,i,s,ome(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function UQe(n,t,e,r){const[i,s]=TR(t,e);return ER(n,i,s,ame(r),n.RGBA,n.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function jQe(n,t,e){Bt(n,()=>n.bindTexture(n.TEXTURE_2D,t)),e.data instanceof Uint8Array?2===Me().getNumber("WEBGL_VERSION")?Bt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.width,e.height,n.RGBA,n.UNSIGNED_BYTE,e.data)):Bt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,e.data)):2===Me().getNumber("WEBGL_VERSION")?Bt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,e)):Bt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e)),Bt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,r,i){this.throwIfDisposed(),function WQe(n,t,e,r,i,s){let o,l,c;Bt(n,()=>n.bindTexture(n.TEXTURE_2D,t)),i instanceof Uint8Array?(o=new Uint8Array(e*r*4),l=n.UNSIGNED_BYTE,c=n.RGBA):(o=new Float32Array(e*r*4),l=n.FLOAT,c=s.internalFormatPackedFloat),o.set(i),2===Me().getNumber("WEBGL_VERSION")?Bt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,r,n.RGBA,l,o)):Bt(n,()=>n.texImage2D(n.TEXTURE_2D,0,c,e,r,0,n.RGBA,l,o)),Bt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}(this.gl,t,e,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function HQe(n,t,e,r){const[i,s]=NT(t,e);return ER(n,i,s,cme(r),n.RGBA,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function zQe(n,t,e,r){const[i,s]=NT(t,e);return ER(n,i,s,lme(r),n.RGBA,n.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(Ype(this.gl,this.framebuffer),this.outputTexture=null),Bt(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,r){return this.downloadMatrixDriver(t,()=>function YQe(n,t,e,r){const[i,s]=TR(t,e),l=new Uint8Array(function f7e(n,t){return n*t}(t*e,4));return Bt(n,()=>n.readPixels(0,0,i,s,r.downloadTextureFormat,n.UNSIGNED_BYTE,l)),new Float32Array(l.buffer)}(this.gl,e,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,r,i,s,o){return function KQe(n,t,e,r,i,s,o,l){const c=n,u=new Float32Array(function p7e(n,t){const[e,r]=NT(n,t);return e*r*4}(s,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,u),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),u}(this.gl,t,0,0,0,s,o)}downloadFloat32MatrixFromBuffer(t,e){return function ZQe(n,t,e){const r=n,i=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}(this.gl,t,e)}createBufferFromTexture(t,e,r){this.bindTextureToFrameBuffer(t);const i=function qQe(n,t,e,r){const i=n.createBuffer();Bt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,i));const l=16*t*e;return Bt(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,l,n.STREAM_READ)),Bt(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,0)),Bt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),i}(this.gl,e,r);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,r;if(Me().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{const o=i.clientWaitSync(s,0,0);return o===i.ALREADY_SIGNALED||o===i.CONDITION_SATISFIED},e=s}else Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(e,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:e,isFencePassed:r}}downloadMatrixFromPackedTexture(t,e,r){return this.downloadMatrixDriver(t,()=>function QQe(n,t,e){const r=new Float32Array(t*e*4);return Bt(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,r)),r}(this.gl,e,r))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=function PQe(n){const t=Ia();return function b7e(n,t){const e=Ep(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Bt(n,()=>n.shaderSource(e,t)),Bt(n,()=>n.compileShader(e)),!1===n.getShaderParameter(e,n.COMPILE_STATUS))throw console.log(n.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}(n,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}(e));const r=function x7e(n){return Ep(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}(e);Bt(e,()=>e.attachShader(r,this.vertexShader)),Bt(e,()=>e.attachShader(r,t)),function I7e(n,t){if(Bt(n,()=>n.linkProgram(t)),!Me().get("ENGINE_COMPILE_ONLY")&&!1===n.getProgramParameter(t,n.LINK_STATUS))throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(e,r);const i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&I9(e,i),i}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const e=this.gl;Bt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),function GQe(n,t,e){Bt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),Zpe(n,t,"clipSpacePos",e,3,20,0)&&Zpe(n,t,"uv",e,2,20,12)}(e,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&(Bt(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&I9(this.gl,this.program),Bt(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,r=!0){return this.throwIfDisposed(),r?function N7e(n,t,e){return Ep(n,()=>n.getUniformLocation(t,e),'uniform "'+e+'" not present in program.')}(this.gl,t,e):function R7e(n,t,e){return n.getUniformLocation(t,e)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),Bt(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),M7e(this.gl,t,e,r)}setOutputMatrixTexture(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)}setOutputPackedMatrixTexture(t,e,r){this.throwIfDisposed();const[i,s]=NT(e,r);this.setOutputMatrixTextureDriver(t,i,s)}setOutputMatrixWriteRegion(t,e,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,e)}setOutputPackedMatrixWriteRegion(t,e,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&I9(this.gl,this.program),$3(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Bt(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Bt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=L3(this.gl,2===Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,s),s}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,r=this.getQueryTimerExtensionWebGL2();return void e.endQuery(r.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(t){var e=this;return(0,q.Z)(function*(){return yield Ele(()=>e.disposed||e.isQueryAvailable(t,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),e.getQueryTime(t,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})()}getQueryTime(t,e){if(0===e)return null;if(2===e){const r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function XQe(n){let t=0;for(;t<n.length&&n[t]();++t);return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:r}=this.itemsToPoll[e];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Me().platform&&(r=Me().platform.setTimeoutCustom.bind(Me().platform)),Ele(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,r)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),T9(this.gl,t,this.framebuffer),this.debug&&$3(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(T9(this.gl,this.outputTexture,this.framebuffer),this.debug&&$3(this.gl)):Ype(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const r=e();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,e,r){this.throwIfDisposed();const i=this.gl;T9(i,t,this.framebuffer),this.debug&&$3(i),this.outputTexture=t,Bt(i,()=>i.viewport(0,0,e,r)),Bt(i,()=>i.scissor(0,0,e,r))}setOutputMatrixWriteRegionDriver(t,e,r,i){this.throwIfDisposed(),Bt(this.gl,()=>this.gl.scissor(t,e,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{addImpl:JQe,bincountImpl:ume,bincountReduceImpl:eXe,bitwiseAndImpl:tXe,castImpl:nXe,ceilImpl:rXe,concatImpl:iXe,equalImpl:sXe,expImpl:oXe,expm1Impl:aXe,floorImpl:lXe,gatherNdImpl:cXe,gatherV2Impl:uXe,greaterImpl:dXe,greaterEqualImpl:hXe,lessImpl:fXe,lessEqualImpl:pXe,linSpaceImpl:mXe,logImpl:gXe,maxImpl:_Xe,maximumImpl:yXe,minimumImpl:vXe,multiplyImpl:bXe,negImpl:wXe,notEqualImpl:CXe,prodImpl:xXe,raggedGatherImpl:IXe,raggedRangeImpl:TXe,raggedTensorToTensorImpl:SXe,rangeImpl:EXe,rsqrtImpl:DXe,scatterImpl:kXe,sigmoidImpl:AXe,simpleAbsImpl:dme,sliceImpl:NXe,sparseFillEmptyRowsImpl:RXe,sparseReshapeImpl:MXe,sparseSegmentReductionImpl:hme,sqrtImpl:OXe,staticRegexReplaceImpl:FXe,stridedSliceImpl:PXe,stringNGramsImpl:LXe,stringSplitImpl:$Xe,stringToHashBucketFastImpl:BXe,subImpl:VXe,tileImpl:UXe,topKImpl:zXe,transposeImpl:N9,uniqueImpl:HXe}=J;function fme(n,t){return["x","y","z","w","u","v"].slice(0,t).map(e=>`${n}.${e}`)}function Ta(n,t){return 1===t?[n]:fme(n,t)}class WXe{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=ea(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=Ta("rc",this.rank),r=qr(this.rank),i=this.getOutOfBoundsCondition(e),s=this.getSetup(e),o=this.getOutput(e);this.userCode=`\n        void main() {\n          ${r} rc = getOutputCoords();\n\n          if(${i}) {\n            setOutput(vec4(0));\n          } else {\n            ${s}\n\n            setOutput(vec4(${o}));\n          }\n        }\n      `}}getSourceCoordsArr(t){const e=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let s=`${0===r?"r":"rp1"}, ${0===i?"c":"cp1"}`;for(let o=2;o<this.rank;o++)s=`${t[t.length-1-o]},`+s;e.push(s)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let e="";for(let r=this.rank-2;r<this.rank;r++)e+=`${t[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2);return`\n      int r = ${e[0]};\n      int c = ${e[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1]};\n      bool rEdge = rp1 >= ${this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2]};\n    `}getOutput(t){const e=this.getSourceCoordsArr(t);return 1===this.rank?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${e[0]}),\n            cEdge ? 0. : getA(${e[1]}),\n            rEdge ? 0. : getA(${e[2]}),\n            rEdge || cEdge ? 0. : getA(${e[3]})`}}class pme{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length);let r="";for(let i=0;i<4;i++){let s="thisRC = rc;";i%2==1&&(s+="thisRC.z += 1;"),i>1&&(s+="thisRC.y += 1;"),r+=`\n        ${s}\n        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${i}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${i>0?"}":""}\n      `}this.userCode=`\n      ${function jXe(n,t){return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${t?function G7e(n,t,e="index"){const i=function H7e(n,t){const e=n.length,r=n.map(s=>`${t}[${s}]`),i=new Array(e-1);i[e-2]=r[e-1];for(let s=e-3;s>=0;--s)i[s]=`(${i[s+1]} * ${r[s+1]})`;return i}(n.map((s,o)=>o),t);return i.map((s,o)=>`int ${n[o]} = ${e} / ${i[o]}; ${o===i.length-1?`int ${n[o+1]} = ${e} - ${n[o]} * ${i[o]}`:`index -= ${n[o]} * ${i[o]}`};`).join("")}(["r","c","d"],"inputShape"):m0(["r","c","d"],n)}\n      return ivec3(r, c, d);\n    }\n  `}(e,this.enableShapeUniforms)}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":E9(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};\n\n        ${r}\n\n        setOutput(result);\n      }\n    `}}class qXe{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,r){const i=gme(e,r),s=_me(t,i,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const o=mme(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const c=this.freeTextures[s].pop();return this.usedTextures[s].push(c),c}let l;return i===Xs.PACKED_2X2_FLOAT32?l=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Xs.PACKED_2X2_FLOAT16?l=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Xs.UNPACKED_FLOAT32?l=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Xs.UNPACKED_FLOAT16?l=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Xs.PACKED_4X1_UNSIGNED_BYTE&&(l=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(l),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),l}releaseTexture(t,e,r,i){if(null==this.freeTextures)return;const s=gme(r,i),o=_me(e,s,i);o in this.freeTextures||(this.freeTextures[o]=[]);const l=mme(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,i),c=Me().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==c&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=l):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=l),this.numUsedTextures--;const u=this.usedTextures[o],f=u&&u.indexOf(t);if(null==f||f<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[f]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${this.numFreeTextures+this.numUsedTextures})`);const e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function mme(n,t,e,r,i){const s=function YXe(n,t){switch(n){case Xs.PACKED_2X2_FLOAT32:return lme(t);case Xs.PACKED_2X2_FLOAT16:return cme(t);case Xs.UNPACKED_FLOAT32:return sme(t);case Xs.UNPACKED_FLOAT16:return ome(t);case Xs.PACKED_4X1_UNSIGNED_BYTE:return ame(t);default:throw new Error(`Unknown physical texture type ${n}`)}}(t,r);let o;if(i){const[c,u]=NT(n[0],n[1]);o=c*u}else{const[c,u]=TR(n[0],n[1]);o=c*u}const l=function ZXe(n,t){if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===n.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(e,s);return o*l}function gme(n,t){if(n===Ll.UPLOAD)return Xs.PACKED_2X2_FLOAT32;if(n===Ll.RENDER||null==n)return function KXe(n){return Me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Xs.PACKED_2X2_FLOAT32:Xs.UNPACKED_FLOAT32:n?Xs.PACKED_2X2_FLOAT16:Xs.UNPACKED_FLOAT16}(t);if(n===Ll.DOWNLOAD||n===Ll.PIXELS)return Xs.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function _me(n,t,e){return`${n[0]}_${n[1]}_${t}_${e}`}class Nh{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const yme="return abs(x);",D_="return x;";class k_{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class aJe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length);const e=t.length,r=Ta("rc",e),i=qr(e),s=function GXe(n,t){if(1===n)return"rc";let e="";for(let r=0;r<n;r++)e+=t[r],r<n-1&&(e+=",");return e}(e,r),o=r.slice(-2),l=e<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`\n      void main() {\n        ${i} rc = getOutputCoords();\n        vec4 packedInput = getA(${s});\n\n        setOutput(getChannel(packedInput, ${l}));\n      }\n    `}}const lJe=wY,j3={},hJe=Me().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");let mJe=(()=>{class n extends F5{nextDataId(){return n.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Me().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let r;if(null!=e){if(e instanceof A9)r=e;else{const i=hd(Me().getNumber("WEBGL_VERSION"),e);r=new A9(i)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const i=hd(Me().getNumber("WEBGL_VERSION"));r=new A9(i),this.binaryCache=function dJe(n){return n in j3||(j3[n]={}),j3[n]}(Me().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=r,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new qXe(this.gpgpu),this.numMBBeforeWarning=function pJe(){return null==Me().global.screen?1024:Me().global.screen.height*Me().global.screen.width*window.devicePixelRatio*600/1024/1024}(),this.texData=new Tle(this,_h())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,r,i,s,o,l){const c=this.makeTensorInfo(r,i),u=this.texData.get(c.dataId);u.isPacked=!1,u.texture={texture:e,texShape:[s,o]},u.texShape=[s,o];const f=B3(r),m=new ime(f,!1,l),_=this.runWebGLProgram(m,[c],i,[[s,o]]);return _.shape=r,u.texture=null,this.disposeIntermediateTensorInfo(c),_.dataId}write(e,r,i){if((Me().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Me().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===i&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:r,dtype:i,values:e,usage:Ll.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){this.texData.has(e)&&this.texData.get(e).refCount--}move(e,r,i,s,o){if(Me().getBool("DEBUG")&&this.checkNumericalProblems(r),"complex64"===s)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:i,dtype:s,values:r,usage:Ll.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const r=this.texData.get(e),{values:i,dtype:s,complexTensorInfos:o,slice:l,shape:c,isPacked:u}=r;if(null!=l){let y;y=u?new k_(c,D_):new Nh(c,D_);const w=this.runWebGLProgram(y,[{dataId:e,shape:c,dtype:s}],s),T=this.readSync(w.dataId);return this.disposeIntermediateTensorInfo(w),T}if(null!=i)return this.convertAndCacheOnCPU(e);if("string"===s)return i;const f=null!=this.activeTimers;let m,_;return f&&(m=Qa()),_="complex64"===s?wp(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.getValuesFromTexture(e),f&&(this.downloadWaitMs+=Qa()-m),this.convertAndCacheOnCPU(e,_)}read(e){var r=this;return(0,q.Z)(function*(){if(r.pendingRead.has(e)){const I=r.pendingRead.get(e);return new Promise(E=>I.push(E))}const i=r.texData.get(e),{values:s,shape:o,slice:l,dtype:c,complexTensorInfos:u,isPacked:f}=i;if(null!=l){let I;I=f?new k_(o,D_):new Nh(o,D_);const E=r.runWebGLProgram(I,[{dataId:e,shape:o,dtype:c}],c),A=r.read(E.dataId);return r.disposeIntermediateTensorInfo(E),A}if(null!=s)return r.convertAndCacheOnCPU(e);if(Me().getBool("DEBUG")&&!Me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Me().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let _,y,m=null;if("complex64"!==c&&Me().get("WEBGL_BUFFER_SUPPORTED")){_=r.decode(e);const I=r.texData.get(_.dataId);m=r.gpgpu.createBufferFromTexture(I.texture.texture,...P3(o))}if(r.pendingRead.set(e,[]),"complex64"!==c&&(yield r.gpgpu.createAndWaitForFence()),"complex64"===c){const I=yield Promise.all([r.read(u.real.dataId),r.read(u.imag.dataId)]);y=wp(I[0],I[1])}else if(null==m)y=r.getValuesFromTexture(e);else{const I=Ye(o);y=r.gpgpu.downloadFloat32MatrixFromBuffer(m,I)}if(null!=_&&r.disposeIntermediateTensorInfo(_),null!=m){const I=r.gpgpu.gl;Bt(I,()=>I.deleteBuffer(m))}const w=r.convertAndCacheOnCPU(e,y),T=r.pendingRead.get(e);return r.pendingRead.delete(e),T.forEach(I=>I(w)),r.pendingDisposal.has(e)&&(r.pendingDisposal.delete(e),r.disposeData(e)&&_h().removeDataId(e,r),r.pendingDeletes--),w})()}readToGPU(e,r={}){const i=this.texData.get(e),{values:s,shape:o,slice:l,dtype:c,isPacked:u,texture:f}=i;if("complex64"===c)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=l){let w;w=u?new k_(o,D_):new Nh(o,D_);const T=this.runWebGLProgram(w,[{dataId:e,shape:o,dtype:c}],c),I=this.readToGPU(T,r);return this.disposeIntermediateTensorInfo(T),I}if(null==f)throw null!=s?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const m=this.decode(e,r.customTexShape),_=_h().makeTensorFromTensorInfo(m),y=this.texData.get(m.dataId);return Object.assign({tensorRef:_},y.texture)}bufferSync(e){const r=this.readSync(e.dataId);if("string"===e.dtype)try{const i=r.map(s=>i_(s));return qn(e.shape,e.dtype,i)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qn(e.shape,e.dtype,r)}checkNumericalProblems(e){if(null!=e)for(let r=0;r<e.length;r++){const i=e[r];if(!y7e(i))throw Me().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${i} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${i} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:r,dtype:i,isPacked:s}=this.texData.get(e),o=Ye(r);if(Me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const y=this.decode(e),w=this.texData.get(y.dataId),T=this.gpgpu.downloadMatrixFromPackedTexture(w.texture.texture,...P3(r)).subarray(0,o);return this.disposeIntermediateTensorInfo(y),T}const l=Me().getBool("WEBGL_PACK")&&!0===s,c=l?B3(r):r,u=l?new MQe(c):new RQe(c),f=this.runWebGLProgram(u,[{shape:c,dtype:i,dataId:e}],"float32"),m=this.texData.get(f.dataId),_=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture.texture,m.texShape[0],m.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(f),_}timerAvailable(){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){var r=this;const i=this.activeTimers,s=[];let o=!1;null==this.programTimersStack?(this.programTimersStack=s,o=!0):this.activeTimers.push(s),this.activeTimers=s,e();const l=Wb(this.activeTimers.map(f=>f.query)).filter(f=>null!=f),c=Wb(this.activeTimers.map(f=>f.name)).filter(f=>null!=f);this.activeTimers=i,o&&(this.programTimersStack=null);const u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(0,q.Z)(function*(){if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const f=yield Promise.all(l);u.kernelMs=function B2e(n){let t=0;for(let e=0;e<n.length;e++)t+=n[e];return t}(f),u.getExtraProfileInfo=()=>f.map((m,_)=>({name:c[_],ms:m})).map(m=>`${m.name}: ${m.ms}`).join(", ")}else u.kernelMs={error:"WebGL query timers are not supported in this environment."};return r.uploadWaitMs=0,r.downloadWaitMs=0,u})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Qa(),endMs:null}}endTimer(e){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Qa(),e)}getQueryTime(e){var r=this;return(0,q.Z)(function*(){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?r.gpgpu.waitForQueryAndGetTime(e):e.endMs-e.startMs})()}disposeData(e,r=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(r?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!r&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:i}=this.texData.get(e);return null!=i&&(this.disposeData(i.real.dataId,r),this.disposeData(i.imag.dataId,r)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:r,dtype:i,texShape:s,usage:o,isPacked:l,slice:c}=this.texData.get(e),u=c&&c.origDataId||e,f=this.dataRefCount.get(u);f>1?this.dataRefCount.set(u,f-1):(this.dataRefCount.delete(u),null!=r&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(r,s,o,l)));const m=this.texData.get(e);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,r=hJe){return Me().getBool("WEBGL_CPU_FORWARD")&&e.every(i=>null==this.texData.get(i.dataId).texture&&Ye(i.shape)<r)}getGPGPUContext(){return this.gpgpu}where(e){hc("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const r=e.dataSync();return lJe(e.shape,r)}packedUnaryOp(e,r,i){const s=new k_(e.shape,r),o=this.compileAndRun(s,[e],i);return _h().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const s=dme(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(Me().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,yme,e.dtype);const r=new Nh(e.shape,yme),i=this.compileAndRun(r,[e]);return _h().makeTensorFromTensorInfo(i)}makeTensorInfo(e,r,i){let s;if("string"===r&&null!=i&&i.length>0&&z1(i[0])){const o=i.map(l=>r_(l));s=this.write(o,e,r)}else s=this.write(i,e,r);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:r}}makeOutput(e,r,i){return _h().makeTensorFromTensorInfo(this.makeTensorInfo(e,r,i),this)}unpackTensor(e){const r=new aJe(e.shape);return this.runWebGLProgram(r,[e],e.dtype)}packTensor(e){const r=new WXe(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)}packedReshape(e,r){const i=[RT(e.shape),...MT(e.shape)],s={dtype:e.dtype,shape:i,dataId:e.dataId},o=[RT(r),...MT(r)],l=new pme(o,i),f=this.runWebGLProgram(l,[s],e.dtype,[i],!0);return{dataId:f.dataId,shape:r,dtype:f.dtype}}decode(e,r){const i=this.texData.get(e),{isPacked:s,shape:o,dtype:l}=i;null!=r&&G(Ye(o)<=r[0]*r[1]*4,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.");const c=B3(o);let u;u=s?new NQe(c):new AQe(c);const m=[r??P3(c)];return{dtype:l,shape:o,dataId:this.runWebGLProgram(u,[{shape:c,dtype:l,dataId:e}],l,m,!0,r).dataId}}runWebGLProgram(e,r,i,s,o=!1,l){const c=this.makeTensorInfo(e.outputShape,i),u=this.texData.get(c.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===AT.DENSE){const A=l??P3(e.outputShape);u.texShape=A.map(M=>2*M)}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===Ye(c.shape))return u.values=vo(c.dtype,0),c;const f=[],m=r.map(A=>{if("complex64"===A.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let M=this.texData.get(A.dataId);if(null==M.texture){if(!e.packedInputs&&Ye(A.shape)<=Me().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:A.shape,texData:null,isUniform:!0,uniformValues:M.values};e.packedInputs&&(M.isPacked=!0,M.shape=A.shape)}if(this.uploadToGPU(A.dataId),!!M.isPacked!=!!e.packedInputs)A=M.isPacked?this.unpackTensor(A):this.packTensor(A),f.push(A),M=this.texData.get(A.dataId);else if(M.isPacked&&!U3(M.shape,A.shape)){const O=A,$=A.shape;A.shape=M.shape,A=this.packedReshape(A,$),f.push(A),M=this.texData.get(A.dataId),O.shape=$}return{shape:A.shape,texData:M,isUniform:!1}});this.uploadToGPU(c.dataId);const _={shape:c.shape,texData:u,isUniform:!1},y=function kQe(n,t,e){let r="";t.concat(e).forEach(o=>{const l=null!=o.texData&&null!=o.texData.slice&&o.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!o.isUniform){const c=o.texData.texShape,{useSqueezeShape:u,uniformShape:f,keptDims:m}=k9(n.packedInputs,o.shape,c);let _="",y="",w="";if(1===f.length&&n.packedInputs){const $=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];_=`${$[0]>1}_${$[1]>1}`}else if(2!==f.length||n.packedInputs){if(f.length>2&&!n.packedInputs){const $=pn(f);w=`${$[0]===c[1]}_${$[$.length-1]===c[1]}`}}else y=`${f[0]>1}_${f[1]>1}`;const T=o.shape.length,I=2===f.length&&dr(o.shape,c),E=1===Ye(o.shape),A=uT(o.shape,e.shape),M=!n.packedInputs&&T===e.shape.length&&dr(c,e.texData.texShape);r+=`${T}_${M}_${u?m:""}_${f.length}_${E}_${A}_${I}_${_}_${y}_${w}_${n.packedInputs||f.length>2?"":`${c[0]>1}_${c[1]>1}`}_${l}`}else r+=`${o.shape}_${o.isUniform?"uniform":o.texData.texShape}_${l}`});let s=n.constructor.name;return s+="_"+r+"_"+n.userCode+`${Me().getNumber("WEBGL_VERSION")}`,s}(e,m,_),w=this.getAndSaveBinary(y,()=>function EQe(n,t,e,r){const i=e.map((f,m)=>{const _={logicalShape:f.shape,texShape:f.isUniform?null:f.texData.texShape,isUniform:f.isUniform,isPacked:!f.isUniform&&f.texData.isPacked,flatOffset:null};return null!=f.texData&&null!=f.texData.slice&&f.texData.slice.flatOffset>0&&(_.flatOffset=f.texData.slice.flatOffset),{name:t.variableNames[m],shapeInfo:_}}),s=i.map(f=>f.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},l=W7e(i,o,t),c=function w7e(n,t){const e=Ep(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Bt(n,()=>n.shaderSource(e,t)),Bt(n,()=>n.compileShader(e)),Me().get("ENGINE_COMPILE_ONLY"))return e;if(!1===n.getShaderParameter(e,n.COMPILE_STATUS))throw qpe(t,n.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}(n.gl,l),u=n.createProgram(c);return Me().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:c,source:l,webGLProgram:u,inShapeInfos:s,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(u),Object.assign({program:t,fragmentShader:c,source:l,webGLProgram:u,inShapeInfos:s,outShapeInfo:o},nme(n,t,u)))}(this.gpgpu,e,m,_)),T=null!=this.activeTimers;let I;T&&(I=this.startTimer()),Me().get("ENGINE_COMPILE_ONLY")||function DQe(n,t,e,r,i){t.program.enableShapeUniforms||(rme(t.inShapeInfos,e),rme([t.outShapeInfo],[r]));const s=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(s.texture,o[0],o[1]):n.setOutputMatrixTexture(s.texture,o[0],o[1]),n.setProgram(t.webGLProgram),n.bindVertexArray(t.webGLProgram.vao),1===Me().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&n.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&n.gl.uniform1f(t.nanLoc,NaN);for(let c=0;c<e.length;++c){const u=e[c],{uniform:f,offset:m,shape:_,texShape:y}=t.variablesLocations[c];if(_){const{uniformShape:w}=k9(t.program.packedInputs,u.shape,u.texData.texShape);switch(w.length){case 1:n.gl.uniform1iv(_,new Int32Array(w));break;case 2:n.gl.uniform2iv(_,new Int32Array(w));break;case 3:n.gl.uniform3iv(_,new Int32Array(w));break;case 4:n.gl.uniform4iv(_,new Int32Array(w))}}if(y&&n.gl.uniform2i(y,u.texData.texShape[0],u.texData.texShape[1]),null!=f){if(u.isUniform){if(Ye(u.shape)<2)n.gl.uniform1f(f,u.uniformValues[0]);else{let w=u.uniformValues;w instanceof Float32Array||(w=new Float32Array(w)),n.gl.uniform1fv(f,w)}continue}null!=u.texData.slice&&null!=m&&n.gl.uniform1i(m,u.texData.slice.flatOffset),n.setInputMatrixTexture(u.texData.texture.texture,f,c)}}const l=t.outShapeLocation;if(l)switch(r.shape.length){case 1:n.gl.uniform1iv(l,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(l,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(l,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(l,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const c=pn(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(c));break;case 3:n.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(c));break;case 4:n.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(c))}}if(t.outTexShapeLocation&&n.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let c=0;c<t.program.customUniforms.length;++c){const u=t.program.customUniforms[c],f=t.customUniformLocations[c],m=i[c];if("float"===u.type)n.gl.uniform1fv(f,m);else if("vec2"===u.type)n.gl.uniform2fv(f,m);else if("vec3"===u.type)n.gl.uniform3fv(f,m);else if("vec4"===u.type)n.gl.uniform4fv(f,m);else if("int"===u.type)n.gl.uniform1iv(f,m);else if("ivec2"===u.type)n.gl.uniform2iv(f,m);else if("ivec3"===u.type)n.gl.uniform3iv(f,m);else{if("ivec4"!==u.type)throw Error(`uniform type ${u.type} is not supported yet.`);n.gl.uniform4iv(f,m)}}n.executeProgram()}(this.gpgpu,w,m,_,s),f.forEach(A=>this.disposeIntermediateTensorInfo(A)),T&&(I=this.endTimer(I),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(I)}));const E=Me().getNumber("WEBGL_FLUSH_THRESHOLD");if(E>0){const A=Qa();A-this.lastGlFlushTime>E&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=A)}if(!Me().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===o){const A=this.unpackTensor(c);return this.disposeIntermediateTensorInfo(c),A}return c}compileAndRun(e,r,i,s,o=!1){return this.runWebGLProgram(e,r,i=i||r[0].dtype,s,o)}getAndSaveBinary(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Me().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(r=>{this.gpgpu.deleteProgram(this.binaryCache[r].webGLProgram),delete this.binaryCache[r]}),this.textureManager.dispose(),null!=this.canvas&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Ie(()=>{if(!Me().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Me().getBool("DEBUG");Me().set("DEBUG",!1);const r=this.abs(gn(1e-8)).dataSync()[0];if(Me().set("DEBUG",e),r>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const r=this.texData.get(e),{shape:i,dtype:s,values:o,texture:l,usage:c,isPacked:u}=r;if(null!=l)return;const f=null!=this.activeTimers;let m;f&&(m=Qa());let _=r.texShape;if(null==_&&(_=function F7e(n,t=!1){let e=Me().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Me().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Me().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=e/2),t&&(e*=2,r*=2,1===(n=n.map((l,c)=>c>=n.length-2?P5(n[c]):n[c])).length&&(n=[2,n[0]])),2!==n.length&&(n=e_(n).newShape);let i=Ye(n),s=null;n.length<=1&&i<=e?s=[1,i]:2===n.length&&n[0]<=e&&n[1]<=e?s=n:3===n.length&&n[0]*n[1]<=e&&n[2]<=e?s=[n[0]*n[1],n[2]]:3===n.length&&n[0]<=e&&n[1]*n[2]<=e?s=[n[0],n[1]*n[2]]:4===n.length&&n[0]*n[1]*n[2]<=e&&n[3]<=e?s=[n[0]*n[1]*n[2],n[3]]:4===n.length&&n[0]<=e&&n[1]*n[2]*n[3]<=e&&(s=[n[0],n[1]*n[2]*n[3]]);const o=null!=s&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(null==s||o)if(t){const l=RT(n);let c=2,u=2;n.length&&([c,u]=MT(n)),i=l*(c/2)*(u/2),s=L5(i).map(f=>2*f)}else s=L5(i);return s}(i,u),r.texShape=_),null!=o){const y=B3(i);let w,T=_[1],I=_[0];const E=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(u||!E)&&([T,I]=NT(_[0],_[1])),w=u?new FQe(y,E):new ime(y,E);const A=E?[I,T]:_,M=this.makeTensorInfo(A,s),O=this.texData.get(M.dataId);O.usage=E?Ll.PIXELS:Ll.UPLOAD,O.texShape=A,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(M.dataId),T,I,o);const Z=this.runWebGLProgram(w,[M],s,[[I,T]],!0),Q=this.texData.get(Z.dataId);r.texShape=Q.texShape,r.isPacked=Q.isPacked,r.usage=Q.usage,Me().get("ENGINE_COMPILE_ONLY")?this.disposeData(Z.dataId):(r.texture=Q.texture,r.values=null,this.texData.delete(Z.dataId)),this.disposeIntermediateTensorInfo(M),f&&(this.uploadWaitMs+=Qa()-m)}else{const y=this.acquireTexture(_,c,s,u);r.texture=y}}convertAndCacheOnCPU(e,r){const i=this.texData.get(e),{dtype:s}=i;return null!=r&&(i.values=function gJe(n,t){if("float32"===t||"complex64"===t)return n;if("int32"===t||"bool"===t){const e="int32"===t?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<e.length;++r)e[r]=Math.round(n[r]);return e}throw new Error(`Unknown dtype ${t}`)}(r,s)),i.values}acquireTexture(e,r,i,s){if(this.numBytesInGPU+=this.computeBytes(e,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,r,s)}computeBytes(e,r){return e[0]*e[1]*nB(r)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}checkCompileCompletionAsync(){var e=this;return(0,q.Z)(function*(){const r=[];if(e.gpgpu.parallelCompilationExtension){for(const[,i]of Object.entries(e.binaryCache))r.push(e.checkCompletionAsync_(i));return Promise.all(r)}for(const[,i]of Object.entries(e.binaryCache)){const s=new Promise(o=>{try{e.checkCompletion_(i),o(!0)}catch(l){throw l}});r.push(s)}return Promise.all(r)})()}checkCompletionAsync_(e){var r=this;return(0,q.Z)(function*(){return r.gpgpu.gl.getProgramParameter(e.webGLProgram,r.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?r.checkCompletion_(e):(yield tde(),r.checkCompletionAsync_(e))})()}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS))throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)?(qpe(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:r,customUniformLocations:i,infLoc:s,nanLoc:o,outShapeLocation:l,outShapeStridesLocation:c,outTexShapeLocation:u}=nme(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=r,e.customUniformLocations=i,e.infLoc=s,e.nanLoc=o,e.outShapeLocation=l,e.outShapeStridesLocation=c,e.outTexShapeLocation=u}}createTensorFromGPUData(e,r,i){e.channels=e.channels||"RGBA";const{texture:s,height:o,width:l,channels:c}=e,u=_h().backend;if(!u.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const f=u.writeTexture(s,r,i,o,l,c);return _h().makeTensorFromDataId(f,r,i,u)}}return n.nextDataId=0,n})();Qle()&&tce("webgl",()=>new mJe,2);class _0{constructor(t,e,r){this.variableNames=["A","B"],this.outputShape=Bn(e,r),this.enableShapeUniforms=ea(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const y0="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class $T{constructor(t,e,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Bn(e,r);const s=this.outputShape.length;this.enableShapeUniforms=ea(s);let o="";if(i)if(0===s||1===Ye(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o=`\n          ${qr(s)} coords = getOutputCoords();\n        `,1===s)o+=this.enableShapeUniforms?"\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const c=Ta("coords",s);o+=this.enableShapeUniforms?`\n            bool nextRowOutOfBounds =\n              (${c[s-2]} + 1) >= outShape[${s} - 2];\n            bool nextColOutOfBounds =\n              (${c[s-1]} + 1) >= outShape[${s} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:`\n            bool nextRowOutOfBounds =\n              (${c[s-2]} + 1) >= ${this.outputShape[s-2]};\n            bool nextColOutOfBounds =\n              (${c[s-1]} + 1) >= ${this.outputShape[s-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${o}\n\n        setOutput(result);\n      }\n    `}}function $l(n){const{inputs:t,backend:e}=n,{x:r}=t;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const vJe={kernelName:cN,backendName:"webgl",kernelFunc:$l};function A_(n){const{inputs:t,backend:e}=n,{real:r,imag:i}=t,s=e.makeTensorInfo(r.shape,"complex64"),o=e.texData.get(s.dataId),l=$l({inputs:{x:r},backend:e}),c=$l({inputs:{x:i},backend:e});return o.complexTensorInfos={real:l,imag:c},s}const bJe={kernelName:K5,backendName:"webgl",kernelFunc:A_},vme="return (a < 0.) ? b * a : a;",bme="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",CJe={kernelName:TB,backendName:"webgl",kernelFunc:function wJe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{alpha:s}=r,o=e.makeTensorInfo([],"float32",n_(s,"float32")),l=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $T(bme,i.shape,o.shape):new _0(vme,i.shape,o.shape),c=e.runWebGLProgram(l,[i,o],"float32");return e.disposeIntermediateTensorInfo(o),c}},wme="return (a < 0.) ? b * a : a;",Cme="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",IJe={kernelName:GB,backendName:"webgl",kernelFunc:function xJe(n){const{inputs:t,backend:e}=n,{x:r,alpha:i}=t,s=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $T(Cme,r.shape,i.shape):new _0(wme,r.shape,i.shape);return e.runWebGLProgram(s,[r,i],"float32")}};function br({opSnippet:n,packedOpSnippet:t,cpuKernelImpl:e,dtype:r}){return({inputs:i,backend:s})=>{const{x:o}=i,l=s,c=r||o.dtype;if(l.shouldExecuteOnCPU([o])&&null!=e){const m=l.texData.get(o.dataId),_=e(m.values,c);return l.makeTensorInfo(o.shape,c,_)}let f;return f=Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t?new k_(o.shape,t):new Nh(o.shape,n),l.runWebGLProgram(f,[o],c)}}function Io({opSnippet:n,packedOpSnippet:t,checkOutOfBounds:e=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}){return({inputs:o,backend:l})=>{const{a:c,b:u}=o,f=l;if(r&&"complex64"===c.dtype){const w=f.texData.get(c.dataId),T=f.texData.get(u.dataId),[I,E]=[[w.complexTensorInfos.real,T.complexTensorInfos.real],[w.complexTensorInfos.imag,T.complexTensorInfos.imag]].map(M=>{const[O,$]=M,V={dataId:O.dataId,dtype:O.dtype,shape:c.shape},Z={dataId:$.dataId,dtype:$.dtype,shape:u.shape},Q=new _0(n,c.shape,u.shape);return f.runWebGLProgram(Q,[V,Z],Dl(O.dtype,$.dtype))}),A=A_({inputs:{real:I,imag:E},backend:f});return f.disposeIntermediateTensorInfo(I),f.disposeIntermediateTensorInfo(E),A}const m=s||Dl(c.dtype,u.dtype);if(("string"===c.dtype||"string"===u.dtype||f.shouldExecuteOnCPU([c,u]))&&null!=i){const w=f.texData.get(c.dataId).values,T=f.texData.get(u.dataId).values,I="string"===c.dtype?Cp(w):w,E="string"===c.dtype?Cp(T):T,[A,M]=i(c.shape,u.shape,I,E,m),O=f.makeTensorInfo(M,m);return f.texData.get(O.dataId).values=A,O}let y;return y=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t?new $T(t,c.shape,u.shape,e):new _0(n,c.shape,u.shape),f.runWebGLProgram(y,[c,u],m)}}function DR(n,t=!1){if("linear"===n)return"return x;";if("relu"===n)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n";if("elu"===n)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===n)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n";if("prelu"===n)return t?Cme:wme;if("leakyrelu"===n)return t?bme:vme;if("sigmoid"===n)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}class xme{constructor(t,e,r,i=!1,s=!1,o=!1,l=null,c=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=ea(this.outputShape.length);const m=Math.ceil((i?t[1]:t[2])/2),_=i?"i * 2, rc.y":"rc.y, i * 2",y=s?"rc.z, i * 2":"i * 2, rc.z",w=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],T=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let I="",E="";l&&(I=c?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${l}\n        }`:u?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${l}\n        }`:`vec4 activation(vec4 x) {\n          ${l}\n        }`,E="result = activation(result);");const A=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let M="rc.x",O="rc.x";t[0]<e[0]?M=`imod(rc.x, ${t[0]})`:e[0]<t[0]&&(O=`imod(rc.x, ${e[0]})`),this.userCode=`\n      ${I}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${m}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ${M};\n        int batchB = ${O};\n        for (int i = 0; i < ${m}; i++) {\n          vec4 a = getMatrixA(batchA, ${_});\n          vec4 b = getMatrixB(batchB, ${y});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${w[0]} * ${T[0]});\n          result += (${w[1]} * ${T[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${A}\n\n        ${E}\n\n        setOutput(result);\n      }\n    `}}class Tme{constructor(t,e,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Bn(e,r),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const Sme="return a * b;";function M9(n){const{inputs:t,backend:e}=n,{a:r,b:i}=t,s=Dl(r.dtype,i.dtype);if("complex64"===r.dtype){const l=e.texData.get(r.dataId),c=e.texData.get(i.dataId),u=new Tme("return areal * breal - aimag * bimag;",r.shape,i.shape),f=new Tme("return areal * bimag + aimag * breal;",r.shape,i.shape),m=[{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:i.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:i.shape}],_=e.runWebGLProgram(u,m,"float32"),y=e.runWebGLProgram(f,m,"float32"),w=A_({inputs:{real:_,imag:y},backend:e});return e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(y),w}if(e.shouldExecuteOnCPU([r,i])){const l=e.texData.get(r.dataId),c=e.texData.get(i.dataId),[u,f]=bXe(r.shape,i.shape,l.values,c.values,s),m=e.makeTensorInfo(f,s);return e.texData.get(m.dataId).values=u,m}let o;return o=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $T(Sme,r.shape,i.shape):new _0(Sme,r.shape,i.shape),e.runWebGLProgram(o,[r,i],s)}const TJe={kernelName:yN,backendName:"webgl",kernelFunc:M9};function Lt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{shape:s}=r,o=e,l=Ye(i.shape),c=Dle(s,l),u=Ye(c);G(l===u,()=>`The new shape (${c}) has ${u} elements and the old shape (${i.shape}) has ${l} elements. The new shape and old shape must have the same number of elements.`);const f=o.texData.get(i.dataId);return!f.isPacked||U3(i.shape,c)||null!==f.texture&&U3(f.shape,c)?(o.incRef(i.dataId),{dataId:i.dataId,shape:c,dtype:i.dtype}):function SJe(n,t,e){const r=[RT(n.shape),...MT(n.shape)],i={dtype:n.dtype,shape:r,dataId:n.dataId},s=[RT(t),...MT(t)],o=new pme(s,r),u=e.runWebGLProgram(o,[i],n.dtype,[r],!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(i,c,o)}const EJe={kernelName:jB,backendName:"webgl",kernelFunc:Lt};class Eme{constructor(t,e){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];const l=4*Math.floor(r/4),c=r%4;let u="sumValue += dot(values, ones);";if(null!=e){const m=1/e;u=`sumValue += dot(values * ${KI(m)?m.toPrecision(2):m}, ones);`}let f="";s%r>0&&(f=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${f}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${l}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${l};\n        if (${1===c}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${u}\n        } else if (${2===c}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${u}\n        } else if (${3===c}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}class DJe{constructor(t,e){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];let l="0.0",c="";"prod"===e?l="1.0":"min"===e?(l="1.0 / 1e-20",c="min"):"max"===e&&(l="-1.0 / 1e-20",c="max");let u=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");const f=4*Math.floor(r/4),m=r%4;let _=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${c}(values, minMaxValue);\n        if (${"min"===e} || ${"max"===e}) {\n          minMaxValue = ${c}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,y="vec4";"all"===e?(l="1.0",_="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",y="bvec4"):"any"===e&&(l="0.0",_="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",y="bvec4");let w="";s%r>0&&(w=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${l};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${w}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        vec4 minMaxValue = vec4(${l});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${f}; i += 4) {\n          int inIdx = inOffset + i;\n          ${y} values = ${y}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${_}\n        }\n\n        int inIdx = inOffset + ${f};\n        if (${1===m}) {\n          ${y} values = ${y}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${_}\n        } else if (${2===m}) {\n          ${y} values = ${y}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${_}\n        } else if (${3===m}) {\n          ${y} values = ${y}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${_}\n        }\n        setOutput(${u});\n      }\n    `}}function v0(n,t,e,r){const i=function kJe(n){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const e=t.length?t[t.length-1].outSize:n[1],r=ZV(e);t.push({inSize:e,windowSize:r,outSize:Math.ceil(e/r)})}return t}(n.shape);let s=n;for(let o=0;o<i.length;o++){const{inSize:l,windowSize:c,outSize:u}=i[o];let f,m;f="mean"===e?0===o?new Eme({windowSize:c,inSize:l,batchSize:n.shape[0],outSize:u},l):new Eme({windowSize:c,inSize:l,batchSize:n.shape[0],outSize:u}):new DJe({windowSize:c,inSize:l,batchSize:n.shape[0],outSize:u},e),m=s,s=r.runWebGLProgram(f,[s],t),m.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(m)}return s}class AJe{constructor(t,e){this.variableNames=["A"];const r=new Array(t.length);for(let o=0;o<r.length;o++)r[o]=t[e[o]];this.outputShape=r,this.rank=r.length;const i=qr(this.rank),s=function NJe(n){const t=n.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<n.length;i++)r[n[i]]=e[i];return r.join()}(e);this.userCode=`\n    void main() {\n      ${i} resRC = getOutputCoords();\n      setOutput(getA(${s}));\n    }\n    `}}class RJe{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(t.length);for(let f=0;f<r.length;f++)r[f]=t[e[f]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=qr(this.rank),s=fme("rc",this.rank),o=new Array(this.rank);for(let f=0;f<e.length;f++)o[e[f]]=s[f];const l=`vec2(${o.slice(-2).join()})`,c=`++${s[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${l})`;this.userCode=`\n    void main() {\n      ${i} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${u};\n      if(${c}) {\n        result[1] = ${u};\n      }\n      --${s[this.rank-1]};\n      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {\n        result[2] = ${u};\n        if(${c}) {\n          result[3] = ${u};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function q3(n,t,e){const r=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new RJe(n.shape,t):new AJe(n.shape,t);return e.runWebGLProgram(r,[n],n.dtype)}function Z3(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;return function MJe(n,t,e,r){const s=n.shape.length,o=Kn(t,n.shape);let l=o;const c=Pi(l,s),u=null!=c;let f=n;u&&(f=q3(n,c,r),l=is(l.length,s)),Co("sum",l,s);const[m,_]=Ks(f.shape,l);let y=m;e&&(y=rs(m,o));const w=Ye(_),E=Lt({inputs:{x:f},attrs:{shape:[Ye(n.shape)/w,w]},backend:r}),M=v0(E,r8(n.dtype),"sum",r),O=Lt({inputs:{x:M},attrs:{shape:y},backend:r});return r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(M),u&&r.disposeIntermediateTensorInfo(f),O}(i,s,o,e)}const OJe={kernelName:XB,backendName:"webgl",kernelFunc:Z3};function Sa(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{perm:s}=r,o=e,c=new Array(i.shape.length);for(let f=0;f<c.length;f++)c[f]=i.shape[s[f]];let u;if(o.shouldExecuteOnCPU([i])){const m=o.texData.get(i.dataId).values,_=N9(m,i.shape,i.dtype,s,c);u=o.makeTensorInfo(c,i.dtype),o.texData.get(u.dataId).values=_}else u=q3(i,s,o);return u}const FJe={kernelName:tT,backendName:"webgl",kernelFunc:Sa};function Y3({a:n,b:t,transposeA:e,transposeB:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:c=null}){const u=n.shape.length,f=t.shape.length,m=e?n.shape[u-2]:n.shape[u-1],_=r?t.shape[f-1]:t.shape[f-2],y=e?n.shape[u-1]:n.shape[u-2],w=r?t.shape[f-2]:t.shape[f-1],T=n.shape.slice(0,-2),I=t.shape.slice(0,-2),E=Ye(T),A=Ye(I),O=Bn(n.shape.slice(0,-2),t.shape.slice(0,-2)).concat([y,w]);G(m===_,()=>`Error in matMul: inner shapes (${m}) and (${_}) of Tensors with shapes ${n.shape} and ${t.shape} and transposeA=${e} and transposeB=${r} must match.`);const $=e?[E,m,y]:[E,y,m],V=r?[A,w,_]:[A,_,w],Z=Lt({inputs:{x:n},backend:i,attrs:{shape:$}}),Q=Lt({inputs:{x:t},backend:i,attrs:{shape:V}}),re=[Z,Q],oe=Math.max(E,A),ye=e?Z.shape[1]:Z.shape[2],Ve=null!=s,We=null!=o,Ke="leakyrelu"===c,Qe=null!=c?DR(c,!0):null;let we;if((1===y||1===w)&&ye>1e3&&!1===(Ve||We||Ke||null!=Qe)){let ze=Z,it=Q;e&&(ze=Sa({inputs:{x:Z},backend:i,attrs:{perm:[0,2,1]}}),re.push(ze)),r&&(it=Sa({inputs:{x:Q},backend:i,attrs:{perm:[0,2,1]}}),re.push(it));const bt=1===w;let _t=ze;1!==w&&(_t=Lt({inputs:{x:ze},backend:i,attrs:{shape:[oe,ye,1]}}),re.push(_t));const xt=1===w?2:1;let At=it;bt&&(At=Lt({inputs:{x:it},backend:i,attrs:{shape:[oe,1,ye]}}),re.push(At));const qt=M9({inputs:{a:_t,b:At},backend:i});we=Z3({inputs:{x:qt},backend:i,attrs:{axis:xt,keepDims:!0}}),re.push(qt)}else{const ze=Dl(n.dtype,t.dtype),it=new xme($,V,[oe,y,w],e,r,Ve,Qe,We,Ke),ht=[Z,Q];if(null!=s&&ht.push(s),We&&ht.push(o),Ke){const bt=i.makeTensorInfo([],"float32",n_(l,"float32"));ht.push(bt),re.push(bt)}we=i.runWebGLProgram(it,ht,ze)}const _e=Lt({inputs:{x:we},backend:i,attrs:{shape:O}});re.push(we);for(const ze of re)i.disposeIntermediateTensorInfo(ze);return _e}const LJe={kernelName:oV,backendName:"webgl",kernelFunc:function PJe(n){const{inputs:t,backend:e,attrs:r}=n,{a:i,b:s,bias:o,preluActivationWeights:l}=t,{transposeA:c,transposeB:u,activation:f,leakyreluAlpha:m}=r;return Y3({a:i,b:s,transposeA:c,transposeB:u,backend:e,bias:o,preluActivationWeights:l,leakyreluAlpha:m,activation:f})}},kme="return abs(x);",BJe={kernelName:rB,backendName:"webgl",kernelFunc:function $Je(n){const{inputs:t,backend:e}=n,{x:r}=t;if(e.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const s=e.texData.get(r.dataId),o=dme(s.values);return e.makeTensorInfo(r.shape,r.dtype,o)}let i;return i=Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new k_(r.shape,kme):new Nh(r.shape,kme),e.runWebGLProgram(i,[r],r.dtype)}},UJe=br({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),zJe={kernelName:H1,backendName:"webgl",kernelFunc:UJe},GJe=br({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),WJe={kernelName:G1,backendName:"webgl",kernelFunc:GJe},Ame="return a + b;",jJe=Io({opSnippet:Ame,packedOpSnippet:Ame,supportsComplex:!0,cpuKernelImpl:JQe}),qJe={kernelName:eT,backendName:"webgl",kernelFunc:jJe};class ZJe{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`\n      void main() {\n        ${r.join("\n        ")}\n\n        float result = ${i};\n        setOutput(result);\n      }\n    `}}class YJe{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`\n      void main() {\n        ${r.join("\n        ")}\n\n        vec4 result = ${i};\n        setOutput(result);\n      }\n    `}}const KJe={kernelName:iB,backendName:"webgl",kernelFunc:function K3(n){const{inputs:t,backend:e}=n,r=t;if(1===r.length)return $l({inputs:{x:r[0]},backend:e});if(r.length>Me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const c=Math.floor(r.length/2),u=K3({inputs:r.slice(0,c),backend:e}),f=K3({inputs:r.slice(c),backend:e});return K3({inputs:[u,f],backend:e})}const i=r.map(c=>c.dtype).reduce((c,u)=>Dl(c,u)),s=r.map(c=>c.shape),l=Me().getBool("WEBGL_PACK")?new YJe(r[0].shape,s):new ZJe(r[0].shape,s);return e.runWebGLProgram(l,r,i)}},XJe={kernelName:"All",backendName:"webgl",kernelFunc:function QJe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,l=i.shape.length,c=Kn(s,i.shape);let u=c;const f=Pi(u,l);let m=i;null!=f&&(m=Sa({inputs:{x:i},backend:e,attrs:{perm:f}}),u=is(u.length,l)),Co("all",u,l);const[_,y]=Ks(m.shape,u),T=Lt({inputs:{x:m},backend:e,attrs:{shape:[-1,Ye(y)]}}),I=v0(T,T.dtype,"all",e);let E;return E=Lt(o?{inputs:{x:I},backend:e,attrs:{shape:rs(_,c)}}:{inputs:{x:I},backend:e,attrs:{shape:_}}),e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(I),null!=f&&e.disposeIntermediateTensorInfo(m),E}},eet={kernelName:"Any",backendName:"webgl",kernelFunc:function JJe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,l=i.shape.length,c=Kn(s,i.shape);let u=c;const f=Pi(u,l);let m=i;null!=f&&(m=Sa({inputs:{x:i},backend:e,attrs:{perm:f}}),u=is(u.length,l)),Co("any",u,l);const[_,y]=Ks(m.shape,u),T=Lt({inputs:{x:m},backend:e,attrs:{shape:[-1,Ye(y)]}}),I=v0(T,T.dtype,"any",e);let E;return E=Lt(o?{inputs:{x:I},backend:e,attrs:{shape:rs(_,c)}}:{inputs:{x:I},backend:e,attrs:{shape:_}}),e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(I),null!=f&&e.disposeIntermediateTensorInfo(m),E}};class tet{constructor(t,e,r){this.variableNames=["A"];const{windowSize:i,batchSize:s,outSize:o}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,o],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${i};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${i}; i++) {\n          int inIdx = ${r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));"};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${"max"===e?">":"<"} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class net{constructor(t,e,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,G(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");const l=this.outputShape,c=l.length,u=qr(c),f=Ta("coords",c);let m,_;if(1===o){_=c+1;const Q=qr(_);m=`\n        ${Q} sourceLocR = ${Q}(${f.join()}, 0);\n        ++${f[c-1]};\n        ${Q} sourceLocG = ${Q}(${f.join()}, 0);\n        ++${f[c-2]};\n        ${Q} sourceLocA = ${Q}(${f.join()}, 0);\n        --${f[c-1]};\n        ${Q} sourceLocB = ${Q}(${f.join()}, 0);\n        --${f[c-2]};`}else _=c,m=`\n        ${u} sourceLocR = coords;\n        ++${f[c-1]};\n        ${u} sourceLocG = coords;\n        ++${f[c-2]};\n        ${u} sourceLocA = coords;\n        --${f[c-1]};\n        ${u} sourceLocB = coords;\n        --${f[c-2]};`;const y=["x","y","z","w","u","v"].slice(0,_),w="."+y[_-1],T=y.map(Q=>"int "+Q),I=Ta("sourceLocR",_-1).concat("inIdx.r"),E=Ta("sourceLocG",_-1).concat("inIdx.g"),A=Ta("sourceLocB",_-1).concat("inIdx.b"),M=Ta("sourceLocA",_-1).concat("inIdx.a"),O="max"===r?"greaterThan":"lessThan",$=i?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${I.join()}),\n                             getBestIndicesAChannel(${E.join()}),\n                             getBestIndicesAChannel(${A.join()}),\n                             getBestIndicesAChannel(${M.join()})));`,V=`vec4(\n            getAChannel(${I.join()}),\n            hasNextCol ? getAChannel(${E.join()}) : 0.,\n            hasNextRow ? getAChannel(${A.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${M.join()}) : 0.)`,Z=i?"":`\n      float getBestIndicesAChannel(${T.join()}) {\n        return getChannel(getBestIndicesA(${y.join()}),\n                                          vec2(${y.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${T.join()}) {\n        return getChannel(getA(${y.join()}),\n                               vec2(${y.slice(-2).join()}));\n      }\n      ${Z}\n      void main() {\n        ${u} coords = getOutputCoords();\n        bool hasNextCol = ${f[c-1]} < ${l[c-1]-1};\n        bool hasNextRow = ${f[c-2]} < ${l[c-2]-1};\n        ${m}\n        ivec4 srcIdx = ivec4(sourceLocR${w}, sourceLocG${w},\n          sourceLocB${w}, sourceLocA${w}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${V};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${$}\n          vec4 candidate = ${V};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${O}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function Nme(n,t,e,r=null){let i=t.shape[0],s=t.shape[1];null!=r&&(i=r.shape[0],s=r.shape[1]);const o=ZV(s),l={windowSize:o,inSize:s,batchSize:i,outSize:Math.ceil(s/o)},c=new tet(l,e,null==r),u=[t];null!=r&&u.push(r);const f=n.runWebGLProgram(c,u,"int32");if(1===f.shape[1])return f;const m=Nme(n,t,e,f);return n.disposeIntermediateTensorInfo(f),m}function Rme(n,t,e,r=null){const i=null!=r?r.shape:t.shape,o=ZV(i[i.length-1]),l=new net(i,o,e,null==r),u=n.runWebGLProgram(l,null==r?[t]:[t,r],"int32");if(u.shape.length===t.shape.length){const f=Rme(n,t,e,u);return n.disposeIntermediateTensorInfo(u),f}return u}function Mme(n,t,e,r){const i=[e];if(Co("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!Me().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const s=[],o=n.texData.get(t.dataId);let c=t;null!==o&&o.isPacked&&(c=n.unpackTensor(t),s.push(c));const[u,f]=Ks(c.shape,i),m=Ye(f),_=Lt({inputs:{x:c},backend:n,attrs:{shape:[-1,m]}});s.push(_);const y=Nme(n,_,r);s.push(y);const w=Lt({inputs:{x:y},backend:n,attrs:{shape:u}});return s.forEach(T=>n.disposeIntermediateTensorInfo(T)),w}return Rme(n,t,r)}const iet={kernelName:sB,backendName:"webgl",kernelFunc:function ret(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s}=r;let o=Kn(s,i.shape);const l=Pi(o,i.shape.length);let c=i;const u=[];null!=l&&(c=Sa({inputs:{x:i},backend:e,attrs:{perm:l}}),u.push(c),o=is(o.length,c.shape.length)),Co("argMax",[o[0]],c.shape.length);const f=Mme(e,c,o[0],"max");return u.forEach(m=>e.disposeIntermediateTensorInfo(m)),f}},oet={kernelName:oB,backendName:"webgl",kernelFunc:function set(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s}=r;let o=Kn(s,i.shape);const l=Pi(o,i.shape.length);let c=i;const u=[];null!=l&&(c=Sa({inputs:{x:i},backend:e,attrs:{perm:l}}),u.push(c),o=is(o.length,c.shape.length)),Co("argMin",[o[0]],c.shape.length);const f=Mme(e,c,o[0],"min");return u.forEach(m=>e.disposeIntermediateTensorInfo(m)),f}},cet=br({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),uet={kernelName:W1,backendName:"webgl",kernelFunc:cet},het=br({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),fet={kernelName:j1,backendName:"webgl",kernelFunc:het},met=br({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),get={kernelName:q1,backendName:"webgl",kernelFunc:met},vet=Io({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),bet={kernelName:Y1,backendName:"webgl",kernelFunc:vet},Cet=br({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),xet={kernelName:Z1,backendName:"webgl",kernelFunc:Cet};class kR{constructor(t,e,r,i=!1,s=!1){if(this.variableNames=["x"],"avg"===e&&r)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,l=t.strideHeight,c=t.strideWidth,u=t.dilationHeight,f=t.dilationWidth,m=t.effectiveFilterHeight,_=t.effectiveFilterWidth,y=t.padInfo.top,w=t.padInfo.left;this.outputShape=t.outShape;const T="avg"===e;let A="0.0";if(T||(A="-1.0 / 1e-20"),r)return void(this.userCode=`\n        const ivec2 strides = ivec2(${l}, ${c});\n        const ivec2 pads = ivec2(${y}, ${w});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${m};\n              wR += ${u}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${_};\n                wC += ${f}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${i?s?`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`:`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`:`wR * ${_} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let O=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(O="avgValue / max(count, 1.0)");const $=4*Math.floor(o/4),V=o%4,Z=`\n      if (${T}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${l}, ${c});\n      const ivec2 pads = ivec2(${y}, ${w});\n      const float initializationValue = ${A};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${A});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${m};\n            wR += ${u}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${$}; wC += 4) {\n            int xC = xCCorner + wC * ${f};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${f}, d),\n              getValue(batch, xR, xC + 2 * ${f}, d),\n              getValue(batch, xR, xC + 3 * ${f}, d)\n            );\n\n            ${Z}\n          }\n\n          int xC = xCCorner + ${$};\n          if (${1===V}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${Z}\n          } else if (${2===V}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${f}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${Z}\n          } else if (${3===V}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${f}, d),\n              getValue(batch, xR, xC + 2 * ${f}, d),\n              initializationValue\n            );\n\n            ${Z}\n          }\n        }\n        setOutput(${O});\n      }\n    `}}class O9{constructor(t,e,r,i=!1,s=!1){if(this.variableNames=["x"],"avg"===e&&r)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,l=t.strideDepth,c=t.strideHeight,u=t.strideWidth,f=t.dilationDepth,m=t.dilationHeight,_=t.dilationWidth,y=t.effectiveFilterDepth,w=t.effectiveFilterHeight,T=t.effectiveFilterWidth,I=t.padInfo.front,E=t.padInfo.top,A=t.padInfo.left;this.outputShape=t.outShape;const M="avg"===e;let O="0.0";if(M||(O="-1.0 / 1e-20"),r)return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${l}, ${c}, ${u});\n        const ivec3 pads = ivec3(${I}, ${E}, ${A});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${y};\n              wD += ${f}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${w};\n                wR += ${m}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${T};\n                  wC += ${_}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${i?s?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${w} * ${T} +\n                      wR * ${T} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let V=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(V="avgValue / max(count, 1.0)");const Z=4*Math.floor(o/4),Q=o%4,re=`\n      if (${M}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${l}, ${c}, ${u});\n      const ivec3 pads = ivec3(${I}, ${E}, ${A});\n      const float initializationValue = ${O};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${O});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${y};\n            wD += ${f}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${w};\n            wR += ${m}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${Z}; wC += 4) {\n              int xC = xCCorner + wC * ${_};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${_}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${_}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${_}, ch)\n              );\n\n              ${re}\n            }\n\n            int xC = xCCorner + ${Z};\n            if (${1===Q}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${re}\n            } else if (${2===Q}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${_}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${re}\n            } else if (${3===Q}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${_}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${_}, ch),\n                initializationValue\n              );\n\n              ${re}\n            }\n          }\n        }\n        setOutput(${V});\n      }\n    `}}const Tet={kernelName:aB,backendName:"webgl",kernelFunc:function Iet(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;SR(i,"avgPool");const{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;G(wo(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const f=ou(i.shape,s,o,1,l,c);if(1===f.filterWidth&&1===f.filterHeight&&dr(f.inShape,f.outShape))return $l({inputs:{x:i},backend:e});const m=new kR(f,"avg",!1);return e.runWebGLProgram(m,[i],"float32")}},Det={kernelName:lB,backendName:"webgl",kernelFunc:function Eet(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=r,m=yp(i.shape,s,o,[1,1,1],l,c,u),_=new O9(m,"avg",!1);return e.runWebGLProgram(_,[i],"float32")}};class ket{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const c=t.effectiveFilterHeight,u=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${c-1-t.padInfo.top}, ${u-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${c};\n            wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${u};\n            wC+= ${t.dilationWidth}) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Aet{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const m=t.effectiveFilterDepth,_=t.effectiveFilterHeight,y=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${m-1-t.padInfo.front}, ${_-1-t.padInfo.top}, ${y-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterDepth*t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${m};\n            wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${_};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${y};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Ret={kernelName:q5,backendName:"webgl",kernelFunc:function Net(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,o=s,{filterSize:l,strides:c,pad:u,dimRoundingMode:f}=r,_=yp(o.shape,l,c,[1,1,1],u,f),y=new Aet(_);return e.runWebGLProgram(y,[i],o.dtype)}},Oet={kernelName:j5,backendName:"webgl",kernelFunc:function Met(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,o=s;SR([i,s],"avgPoolGrad");const{filterSize:l,strides:c,pad:u}=r,f=ou(o.shape,l,c,1,u),m=new ket(f);return e.runWebGLProgram(m,[i],o.dtype)}},Pet={kernelName:cB,backendName:"webgl",kernelFunc:function Fet(n){const{inputs:t,backend:e,attrs:r}=n,{a:i,b:s}=t,{transposeA:o,transposeB:l}=r;return Y3({a:i,b:s,transposeA:o,transposeB:l,backend:e})}};class Let{constructor(t,e,r,i,s,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Bn(t,e),Bn(t,r);let l="0.0";null!=i&&(Bn(t,i),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let c="1.0";null!=s&&(Bn(t,s),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${l};\n        float scale = ${c};\n        float inv = scale * inversesqrt(variance + float(${o}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class $et{constructor(t,e,r,i,s,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Bn(t,e),Bn(t,r);let l="vec4(0.0)";null!=i&&(Bn(t,i),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let c="vec4(1.0)";null!=s&&(Bn(t,s),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${l};\n        vec4 scale = ${c};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${o}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}const Bet={kernelName:CB,backendName:"webgl",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r,mean:i,variance:s,offset:o,scale:l}=n;G(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),G(null==o||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),G(null==l||i.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=e;null==c&&(c=.001);const u=[r,i,s];let f=null;null!=o&&(f=o.shape,u.push(o));let m=null;null!=l&&(m=l.shape,u.push(l));const _=Me().getBool("WEBGL_PACK_NORMALIZATION")?new $et(r.shape,i.shape,s.shape,f,m,c):new Let(r.shape,i.shape,s.shape,f,m,c);return t.runWebGLProgram(_,u,u[0].dtype)}};class Vet{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=qr(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=function Uet(n){if(1===n)return"sourceLoc";if(n<=6)return F9.slice(0,n).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}(this.rank);let i;i=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${t.map((o,l)=>`sourceLoc.${F9[l]} = start[${l}] + coords.${F9[l]};`).join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${i}\n        setOutput(getSource(${r}));\n      }\n    `}}const F9=["x","y","z","w","u","v"];class zet{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=qr(this.rank),r=Ta("coords",this.rank),i=Ta("sourceLoc",this.rank),s=1===this.rank?"sourceLoc":`vec2(${i.slice(-2).join()})`,o=`getChannel(getSource(${i.join()}), ${s})`,l=`\n      result.x = ${o};\n      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${i[this.rank-1]};\n        result.y = ${o};\n        --${i[this.rank-1]};\n      }\n    `,c=1===this.rank?"":`\n      --${r[this.rank-1]};\n      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${i[this.rank-2]};\n        result.z = ${o};\n        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${i[this.rank-1]};\n          result.w = ${o};\n        }\n      }\n    `,u=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((f,m)=>`start[${m}]`).join()});`:t.map((f,m)=>`${i[m]} = ${r[m]} + start[${m}];`).join("\n");this.userCode=`\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${u}\n        vec4 result = vec4(0.);\n        ${l}\n        ${c}\n        setOutput(result);\n      }\n    `}}function VT(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{begin:s,size:o}=r,[l,c]=CV(i,s,o);if(L8(i,l,c),0===Ye(c))return e.makeTensorInfo(c,i.dtype,[]);if(e.shouldExecuteOnCPU([i])||"string"===i.dtype){const m=e.texData.get(i.dataId),_=NXe(m.values,l,c,i.shape,i.dtype);return e.makeTensorInfo(c,i.dtype,_)}const{isPacked:u}=e.texData.get(i.dataId),f=B8(i.shape,l,c);if(u||!f){const m=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zet(c):new Vet(c);return e.runWebGLProgram(m,[i],i.dtype,[l])}return e.uploadToGPU(i.dataId),function Het(n,t,e,r){const i=r.texData.get(n.dataId),s=r.makeTensorInfo(e,n.dtype),o=r.texData.get(s.dataId);Object.assign(o,i),o.refCount=1,o.shape=e,o.dtype=n.dtype;let l=V8(t,pn(n.shape));i.slice&&(l+=i.slice.flatOffset),o.slice={flatOffset:l,origDataId:i.slice&&i.slice.origDataId||n.dataId};const c=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,c+1),s}(i,l,c,e)}const Get={kernelName:QB,backendName:"webgl",kernelFunc:VT},Wet={kernelName:uB,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockShape:s,crops:o}=r;G(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const l=s.reduce((A,M)=>A*M),c=iR(i.shape,s,l),u=sR(c.length,s.length),f=oR(i.shape,s,l),m=$Y(o,s.length),_=BY(f,o,s.length),y=[],w=Lt({inputs:{x:i},backend:e,attrs:{shape:c}}),T=Sa({inputs:{x:w},backend:e,attrs:{perm:u}}),I=Lt({inputs:{x:T},backend:e,attrs:{shape:f}}),E=VT({inputs:{x:I},backend:e,attrs:{begin:m,size:_}});return y.push(w),y.push(T),y.push(I),y.forEach(A=>e.disposeIntermediateTensorInfo(A)),E}},qet={kernelName:Z5,backendName:"webgl",kernelFunc:function jet(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,weights:s}=t,{size:o}=r,l=e.readSync(i.dataId),c=e.readSync(s.dataId),u=ume(l,c,s.dtype,s.shape,o);return e.makeTensorInfo([o],s.dtype,u)}},Qet={kernelName:dB,backendName:"webgl",kernelFunc:function Ket(n){const{inputs:t,backend:e}=n,{a:r,b:i}=t,s=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=Me().getNumber("WEBGL_VERSION");if(e.shouldExecuteOnCPU([r,i])||1===o){const c=e.texData.get(r.dataId).values,u=e.texData.get(i.dataId).values,[f,m]=tXe(r.shape,i.shape,c,u,r.dtype),_=e.makeTensorInfo(m,r.dtype);return e.texData.get(_.dataId).values=f,_}let l;return l=s?new $T("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,i.shape,!1):new _0("\n  return float(int(a.r) & int(b.r));\n",r.shape,i.shape),e.runWebGLProgram(l,[r,i],r.dtype)}},Jet={kernelName:Y5,backendName:"webgl",kernelFunc:function Xet(n){const{inputs:t,backend:e}=n,{s0:r,s1:i}=t,s=e.readSync(r.dataId),o=e.readSync(i.dataId),l=Bn(Array.from(s),Array.from(o));return e.makeTensorInfo([l.length],"int32",Int32Array.from(l))}},Ome=Io({opSnippet:"return float(a != b);",cpuKernelImpl:CXe,dtype:"bool"}),ett={kernelName:BB,backendName:"webgl",kernelFunc:Ome};function AR(n){const{inputs:t,backend:e}=n,{input:r}=t;return $l({inputs:{x:e.texData.get(r.dataId).complexTensorInfos.real},backend:e})}const ttt={kernelName:NZ,backendName:"webgl",kernelFunc:AR},itt={kernelName:K1,backendName:"webgl",kernelFunc:function P9(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{dtype:s}=r;if("complex64"===s){if("complex64"===i.dtype)return $l({inputs:{x:i},backend:e});const o=Ns(i.shape),l=P9({inputs:{x:i},backend:e,attrs:{dtype:"float32"}}),c=A_({inputs:{real:l,imag:o},backend:e});return o.dispose(),e.disposeIntermediateTensorInfo(l),c}if("complex64"===i.dtype){const o=AR({inputs:{input:i},backend:e}),l=P9({inputs:{x:o},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(o),l}if(!kle(i.dtype,s)){const o=$l({inputs:{x:i},backend:e});return{dataId:o.dataId,shape:o.shape,dtype:s}}if(e.shouldExecuteOnCPU([i])){const o=e.texData.get(i.dataId).values,[l,c,u]=nXe(o,i.shape,i.dtype,s);return e.makeTensorInfo(l,c,u)}if("int32"===s)return function rtt(n,t){const e=new Nh(n.shape,"return float(int(x));"),r=t.runWebGLProgram(e,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,e);if("bool"===s){const o=e.makeTensorInfo([],"bool",vo("bool",1)),c=Ome({inputs:{a:i,b:o},backend:e});return e.disposeIntermediateTensorInfo(o),c}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}},Fme="return ceil(x);",stt=br({opSnippet:Fme,packedOpSnippet:Fme,cpuKernelImpl:rXe}),ott={kernelName:Q1,backendName:"webgl",kernelFunc:stt};class att{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class ltt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const utt={kernelName:X1,backendName:"webgl",kernelFunc:function ctt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{clipValueMin:s,clipValueMax:o}=r;let l;return l=Me().getBool("WEBGL_PACK_CLIP")?new ltt(i.shape):new att(i.shape),e.runWebGLProgram(l,[i],i.dtype,[[s],[o]])}};class dtt{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function Pme(n,t){return{dataId:t.dataId,dtype:t.dtype,shape:n.shape}}const ftt={kernelName:hB,backendName:"webgl",kernelFunc:function htt(n){const{inputs:t,backend:e}=n,{x:r}=t,i=e.texData.get(r.dataId),s=new dtt(r.shape),o=[Pme(r,i.complexTensorInfos.real),Pme(r,i.complexTensorInfos.imag)];return e.runWebGLProgram(s,o,o[0].dtype)}};class ptt{constructor(t){this.outputShape=[],this.outputShape=Ch(t,1),this.variableNames=t.map((o,l)=>`T${l}`);const e=new Array(t.length-1);e[0]=t[0][1];for(let o=1;o<e.length;o++)e[o]=e[o-1]+t[o][1];const r=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<e.length;o++)r.push(`else if (yC < ${e[o]}) setOutput(getT${o}(yR, yC-${e[o-1]}));`);r.push(`else setOutput(getT${e.length}(yR, yC-${e[e.length-1]}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${r.join("\n        ")}\n      }\n    `}}class mtt{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ch(t,e);const r=this.outputShape,i=r.length,s=qr(i),o=Ta("coords",i),l=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((T,I)=>`T${I}`);const c=new Array(t.length-1);c[0]=t[0][e];for(let T=1;T<c.length;T++)c[T]=c[T-1]+t[T][e];const u=l[e],f=l.slice(-2),m=l.join();let _=`if (${u} < ${c[0]}) {\n        return getChannel(\n            getT0(${m}), vec2(${f.join()}));\n        }`;for(let T=1;T<c.length;T++){const I=c[T-1];_+=`\n        if (${u} < ${c[T]}  && ${u} >= ${c[T-1]}) {\n          return getChannel(\n            getT${T}(${Q3(l,u,I)}),\n            vec2(${Q3(f,u,I)}));\n        }`}const w=c[c.length-1];_+=`\n        return getChannel(\n          getT${c.length}(${Q3(l,u,w)}),\n          vec2(${Q3(f,u,w)}));`,this.userCode=`\n      float getValue(${l.map(T=>"int "+T)}) {\n        ${_}\n      }\n\n      void main() {\n        ${s} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${o}), 0., 0., 0.);\n\n        ${o[i-1]} = ${o[i-1]} + 1;\n        if (${o[i-1]} < ${r[i-1]}) {\n          result.g = getValue(${o});\n        }\n\n        ${o[i-2]} = ${o[i-2]} + 1;\n        if (${o[i-2]} < ${r[i-2]}) {\n          result.a = getValue(${o});\n        }\n\n        ${o[i-1]} = ${o[i-1]} - 1;\n        if (${o[i-2]} < ${r[i-2]} &&\n            ${o[i-1]} < ${r[i-1]}) {\n          result.b = getValue(${o});\n        }\n        setOutput(result);\n      }\n    `}}function Q3(n,t,e){const r=n.indexOf(t);return n.map((s,o)=>o===r?`${s} - ${e}`:s).join()}function X3(n){const{inputs:t,backend:e}=n,{input:r}=t;return $l({inputs:{x:e.texData.get(r.dataId).complexTensorInfos.imag},backend:e})}const gtt={kernelName:_Z,backendName:"webgl",kernelFunc:X3};function NR(n,t,e){const r=n[0].dtype;if("complex64"===r){const y=n.map(A=>AR({inputs:{input:A},backend:e})),w=n.map(A=>X3({inputs:{input:A},backend:e})),T=NR(y,t,e),I=NR(w,t,e),E=A_({inputs:{real:T,imag:I},backend:e});return y.forEach(A=>e.disposeIntermediateTensorInfo(A)),w.forEach(A=>e.disposeIntermediateTensorInfo(A)),e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(I),E}let i=e.shouldExecuteOnCPU(n);if("string"===r&&(i=!0),i){const y=n.map(O=>{const $=Ye(O.shape.slice(t));return Lt({inputs:{x:O},backend:e,attrs:{shape:[-1,$]}})}),w=y.map(O=>({vals:e.readSync(O.dataId),shape:O.shape})),T=Ch(y.map(O=>O.shape),1),E=iXe(w,T,r,1===y[0].shape[0]),A=Ch(n.map(O=>O.shape),t),M=e.makeTensorInfo(A,r,E);return y.forEach(O=>e.disposeIntermediateTensorInfo(O)),M}const s=n.filter(y=>Ye(y.shape)>0),o=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(1===s.length){const y=o?new Nh(n[0].shape,D_):new k_(n[0].shape,D_);return e.runWebGLProgram(y,n,r)}const l=Me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>l){const y=[];for(let T=0;T<s.length;T+=l){const I=s.slice(T,T+l);y.push(NR(I,t,e))}const w=NR(y,t,e);for(const T of y)e.disposeIntermediateTensorInfo(T);return w}if(o){const y=new mtt(s.map(w=>w.shape),t);return e.runWebGLProgram(y,s,r)}const{tensors2D:c,outShape:u}=function _tt(n,t,e){const r=Ch(n.map(s=>s.shape),t);return{tensors2D:n.map(s=>Lt({inputs:{x:s},attrs:{shape:[-1,Ye(s.shape.slice(t))]},backend:e})),outShape:r}}(s,t,e),f=new ptt(c.map(y=>y.shape)),m=e.runWebGLProgram(f,c,r);c.forEach(y=>e.disposeIntermediateTensorInfo(y));const _=Lt({inputs:{x:m},attrs:{shape:u},backend:e});return e.disposeIntermediateTensorInfo(m),_}function Lme(n){const{inputs:t,backend:e,attrs:r}=n,{axis:i}=r,s=Kn(i,t[0].shape)[0];FY(t.map(u=>u.shape),s);const l=Ch(t.map(u=>u.shape),s);if(0===Ye(l))return e.makeTensorInfo(l,t[0].dtype,[]);const c=t.filter(u=>Ye(u.shape)>0);return 1===c.length?$l({inputs:{x:c[0]},backend:e}):NR(c,s,e)}const ytt={kernelName:fB,backendName:"webgl",kernelFunc:Lme};class $me{constructor(t,e=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,l=t.padInfo.left,c=t.strideHeight,u=t.strideWidth,f=t.dilationHeight,m=t.dilationWidth,_=t.filterHeight,y=t.filterWidth,w=4*Math.floor(t.inChannels/4),T=t.inChannels%4,I="channelsLast"===t.dataFormat,E=I?1:2,A=I?2:3,M=I?3:1;let O="",$="";r&&(O=i?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:s?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`\n          float activation(float x) {\n            ${r}\n          }\n        `,$="result = activation(result);");const V=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${O}\n\n      const ivec2 strides = ivec2(${c}, ${u});\n      const ivec2 pads = ivec2(${o}, ${l});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${M}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${E}], coords[${A}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${_}; wR++) {\n          int xR = xRCorner + wR * ${f};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${y}; wC++) {\n            int xC = xCCorner + wC * ${m};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${w}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${I}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===T}) {\n\n              if (${I}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${w}) *\n                    getW(wR, wC, ${w}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${w}, xR, xC) *\n                    getW(wR, wC, ${w}, d2);\n              }\n\n            } else if (${2===T}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${w}, d2),\n                getW(wR, wC, ${w} + 1, d2)\n              );\n\n              if (${I}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${w}),\n                  getX(batch, xR, xC, ${w} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${w}, xR, xC),\n                  getX(batch, ${w} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===T}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${w}, d2),\n                getW(wR, wC, ${w} + 1, d2),\n                getW(wR, wC, ${w} + 2, d2)\n              );\n\n              if (${I}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${w}),\n                  getX(batch, xR, xC, ${w} + 1),\n                  getX(batch, xR, xC, ${w} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${w}, xR, xC),\n                  getX(batch, ${w} + 1, xR, xC),\n                  getX(batch, ${w} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${V}\n        ${$}\n        setOutput(result);\n      }\n    `}}class vtt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,s=t.strideDepth,o=t.strideHeight,l=t.strideWidth,c=t.dilationDepth,u=t.dilationHeight,f=t.dilationWidth,m=t.filterDepth,_=t.filterHeight,y=t.filterWidth,w=4*Math.floor(t.inChannels/4),T=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${s}, ${o}, ${l});\n      const ivec3 pads = ivec3(${e}, ${r}, ${i});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${m}; wF++) {\n          int xF = xFCorner + wF * ${c};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${_}; wR++) {\n            int xR = xRCorner + wR * ${u};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${y}; wC++) {\n              int xC = xCCorner + wC * ${f};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${w}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===T}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${w}) *\n                  getW(wF, wR, wC, ${w}, d2);\n              } else if (${2===T}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${w}),\n                  getX(batch, xF, xR, xC, ${w} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${w}, d2),\n                  getW(wF, wR, wC, ${w} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===T}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${w}),\n                  getX(batch, xF, xR, xC, ${w} + 1),\n                  getX(batch, xF, xR, xC, ${w} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${w}, d2),\n                  getW(wF, wR, wC, ${w} + 1, d2),\n                  getW(wF, wR, wC, ${w} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Bme{constructor(t,e=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ea(this.outputShape.length);const o=t.padInfo.left,l=t.strideWidth,c=t.dilationWidth,u=t.filterHeight,f=t.filterWidth,m=f;let _="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let I=0;I<f;I++)_+=`\n           vec4 xTexelC${2*I};\n           int xTexelC${2*I}Ready;\n           vec4 xTexelC${2*I+1};\n           int xTexelC${2*I+1}Ready;\n           vec4 xC${I};`;_+=`\n     for (int r = 0; r < ${u}; r++) {\n      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {\n       `;for(let I=0;I<f;I++)_+=`\n           xTexelC${2*I} = vec4(0.0);\n           xTexelC${2*I}Ready = 0;\n           xTexelC${2*I+1} = vec4(0.0);\n           xTexelC${2*I+1}Ready = 0;\n           xC${I} = vec4(0.0);`;_+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let I=0;I<(m+1)/2;I++){const E=2*I;if(_+=`\n           xC = xCCorner + ${E*c};\n           `,1===l){if(E<f&&(o%2==1?(_+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E}Ready == 0) {\n                   xTexelC${E} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${E}.zw = vec2(0.0);\n                   }\n                   xTexelC${E}Ready = 1;\n                 }\n               `,_+=1===c&&E>0?`\n                 xC${E} = vec4(xTexelC${E-2}.zw, xTexelC${E}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${E} = vec4(previous.zw, xTexelC${E}.xy);\n                   } else {\n                     xC${E} = vec4(0.0, 0.0, xTexelC${E}.xy);\n                   }\n                   `):_+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${E}Ready == 0) {\n                   xTexelC${E} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${E}.zw = vec2(0.0);\n                   }\n                   xTexelC${E}Ready = 1;\n                 }\n\n                 xC${E} = xTexelC${E};\n                 `,E+1<f)){const A=o%2==0?P5(c):c;c%2==0&&o%2==1||c%2!=0&&o%2!=1?(_+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${A};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {\n                     xTexelC${E+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${E+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${E+1}Ready = 1;\n                   }\n                   `,_+=c>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${E+1} = vec4(previous.zw, xTexelC${E+1}.xy);\n                     } else {\n                      xC${E+1} = vec4(0.0, 0.0, xTexelC${E+1}.xy);\n                     }\n                     `:`\n                     xC${E+1} = vec4(xTexelC${E}.zw, xTexelC${E+1}.xy);\n                     `):_+=1===A?`\n                     xC${E+1} = xTexelC${E};\n                     `:`\n                     xCOffset = xC + ${A};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {\n                       xTexelC${E+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${E+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${E+1}Ready = 1;\n                     }\n\n                     xC${E+1} = xTexelC${E+1};\n                     `}}else E<f&&(o%2==1?(_+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E}Ready == 0) {\n                   xTexelC${E} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${E}.zw = vec2(0.0);\n                   }\n                   xTexelC${E}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${E+1}Ready == 0) {\n                   xTexelC${E+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${E+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${E+1}Ready = 1;\n                 }\n\n                 xC${E} = vec4(xTexelC${E}.zw, xTexelC${E+1}.zw);\n               `,E+1<f&&(_+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${E+1} = vec4(xTexelC${E+1}.xy, final.xy);\n                 `)):(_+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${E}Ready == 0) {\n                   xTexelC${E} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${E}.zw = vec2(0.0);\n                   }\n                   xTexelC${E}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {\n                   xTexelC${E+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${E+1}.zw = vec2(0.);\n                   }\n                   xTexelC${E+1}Ready = 1;\n                 }\n\n                 xC${E} = vec4(\n                   xTexelC${E}.xy, xTexelC${E+1}.xy);\n               `,E+1<f&&(_+=`\n                   xC${E+1} = vec4(xTexelC${E}.zw, xTexelC${E+1}.zw);\n                 `)));E<f&&(_+=`\n             wTexel = getW(r, ${E}, d1, d2);\n             dotProd += xC${E}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${t.inChannels}) {\n               dotProd += xC${E}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,E+1<f&&(_+=`\n               wTexel = getW(r, ${E+1}, d1, d2);\n               dotProd += xC${E+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${t.inChannels}) {\n                 dotProd += xC${E+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}_+="\n     }\n   ",_+="\n     }\n   ",_+="\n     }\n   ";let y="",w="";r&&(y=i?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${r}\n         }`:s?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${r}\n         }`:`vec4 activation(vec4 x) {\n           ${r}\n         }`,w="result = activation(result);");const T=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${y}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${_}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${T}\n         ${w}\n         setOutput(result);\n       }\n     `}}class btt{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=ea(this.outputShape.length);const{dataFormat:r}=e,i=Ia(),s="channelsLast"===r,o=s?1:2,l=s?2:3,c=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let u="";for(let f=0;f<=1;f++)for(let m=0;m<=1;m++)u+=`\n          blockIndex = rc.z + ${m};\n          pos = rc.y + ${f};\n\n          ${c}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${o}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${l}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${s}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*f+m}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*f+m}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${u}\n\n        ${i.output} = result;\n      }\n    `}}function J3(n,t){const e=n.length;return e>=3?t?[...n.slice(0,-3),n[e-3]*n[e-2],n[e-1]]:[...n.slice(0,-3),n[e-3],n[e-2]*n[e-1]]:!t&&1===e&&n[0]>1?[n[0],1]:null}function Vme({x:n,filter:t,convInfo:e,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){const c=n.shape,u=r.texData.get(n.dataId),f=e.inChannels,m=c[0]*c[1]*c[2],_=e.outChannels,y="channelsLast"===e.dataFormat;let I;const E=[];if(null!=s){const O=J3(s.shape,y);null!=O&&(s=Lt({inputs:{x:s},backend:r,attrs:{shape:O}}),E.push(s))}if(null!=i){const O=J3(i.shape,y);null!=O&&(i=Lt({inputs:{x:i},backend:r,attrs:{shape:O}}),E.push(i))}if((1!==m&&1!==_||!(f>1e3))&&u.isPacked&&y&&null!=u.texture&&c[2]%2!=0&&dr(u.shape.slice(-3),c.slice(-3))){const $={dataId:n.dataId,shape:[1,c[0]*c[1]*(c[2]+1),e.inChannels],dtype:n.dtype},V=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,G(U3(u.shape,$.shape),()=>`packed reshape ${u.shape} to ${$.shape} isn't free`);const Z=Lt({inputs:{x:t},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}});E.push(Z);const Q=Y3({a:$,b:Z,backend:r,transposeA:!1,transposeB:!1,bias:i,activation:l,preluActivationWeights:s,leakyreluAlpha:o}),re=r.texData.get(Q.dataId);G(re.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=V,re.shape=e.outShape,I=$l({inputs:{x:Q},backend:r}),I.shape=e.outShape,E.push(Q)}else{const O=e.outHeight*e.outWidth,$=Lt({inputs:{x:n},backend:r,attrs:{shape:y?[e.batchSize,O,e.inChannels]:[e.batchSize,e.inChannels,O]}}),V=Lt({inputs:{x:t},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}}),Z=Y3({a:y?$:V,b:y?V:$,transposeA:!y,transposeB:!1,backend:r,bias:i,activation:l,preluActivationWeights:s,leakyreluAlpha:o});I=Lt({inputs:{x:Z},backend:r,attrs:{shape:e.outShape}}),E.push($),E.push(V),E.push(Z)}for(const O of E)r.disposeIntermediateTensorInfo(O);return I}function Ume({x:n,filter:t,convInfo:e,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){const{filterWidth:c,filterHeight:u,inChannels:f,outWidth:m,outHeight:_,dataFormat:y}=e,w="channelsLast"===y,T=c*u*f,I=_*m,E=[e.batchSize,T,I],O=[];if(null!=s){const _e=J3(s.shape,w);null!=_e&&(s=Lt({inputs:{x:s},backend:r,attrs:{shape:_e}}),O.push(s))}if(null!=i){const _e=J3(i.shape,w);null!=_e&&(i=Lt({inputs:{x:i},backend:r,attrs:{shape:_e}}),O.push(i))}const $=Lt({inputs:{x:t},backend:r,attrs:{shape:[1,T,Ye(t.shape)/T]}});O.push($);const V=new btt(E,e),Q=r.runWebGLProgram(V,[n],"float32",[n.shape,[e.padInfo.top,e.padInfo.left],[e.strideHeight,e.strideWidth],[e.dilationHeight,e.dilationWidth],[e.inChannels],[e.filterWidth*e.inChannels],[e.outWidth]]),re=Lt({inputs:{x:Q},backend:r,attrs:{shape:E}});O.push(Q),O.push(re);const oe=null!=i,ye=null!=s,Ve="leakyrelu"===l,We=l?DR(l,!0):null,Ke=new xme(w?re.shape:$.shape,w?$.shape:re.shape,w?[e.batchSize,I,e.outChannels]:[e.batchSize,e.outChannels,I],!0,!1,oe,We,ye,Ve),Qe=w?[re,$]:[$,re];if(i&&Qe.push(i),ye&&Qe.push(s),Ve){const _e=r.makeTensorInfo([],"float32",n_(o,"float32"));Qe.push(_e),O.push(_e)}const ge=r.runWebGLProgram(Ke,Qe,"float32"),we=Lt({inputs:{x:ge},backend:r,attrs:{shape:e.outShape}});O.push(ge);for(const _e of O)r.disposeIntermediateTensorInfo(_e);return we}const Ctt={kernelName:pB,backendName:"webgl",kernelFunc:function wtt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:l,dataFormat:c,dilations:u,dimRoundingMode:f}=r,m=vp(c),_=Ys(i.shape,s.shape,o,u,l,f,!1,m);let y;if(1!==_.filterHeight||1!==_.filterWidth||1!==_.dilationHeight||1!==_.dilationWidth||1!==_.strideHeight||1!==_.strideWidth||"SAME"!==_.padInfo.type&&"VALID"!==_.padInfo.type)if(_.strideWidth<=2&&"channelsLast"===m&&Me().getBool("WEBGL_EXP_CONV")){const T=new Bme(_);y=e.runWebGLProgram(T,[i,s],"float32",[[_.padInfo.top,_.padInfo.left],[_.strideHeight,_.strideWidth],[_.dilationHeight,_.dilationWidth],[_.inHeight,_.inWidth]])}else if(Me().getBool("WEBGL_CONV_IM2COL"))y=Ume({x:i,filter:s,convInfo:_,backend:e});else{const T=new $me(_);y=e.runWebGLProgram(T,[i,s],"float32")}else y=Vme({x:i,filter:s,convInfo:_,backend:e});const w=Lt({inputs:{x:y},backend:e,attrs:{shape:_.outShape}});return e.disposeIntermediateTensorInfo(y),w}};class xtt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              ${"channelsLast"===t.dataFormat?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);"}\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Itt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,r=t.filterWidth,o="channelsLast"===t.dataFormat;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${o?3:1}];\n\n        ivec2 dyCorner = ivec2(coords[${o?1:2}], coords[${o?2:3}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${r} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${o}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Ttt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${t.strideDepth} - ${t.padInfo.front};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Stt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,r=t.filterHeight,i=t.filterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${r-1-t.padInfo.top}, ${i-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${t.strideDepth}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${r}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${r} - 1 - wR;\n\n            for (int wC = 0; wC < ${i}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${i} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Dtt={kernelName:Q5,backendName:"webgl",kernelFunc:function Ett(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,pad:l,dataFormat:c,dimRoundingMode:u,filterShape:f}=r,m=vp(c),_=Ys(i.shape,f,o,1,l,u,!1,m),y=new xtt(_);return e.runWebGLProgram(y,[i,s],"float32")}};class ktt{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=ea(this.outputShape.length);const e=t.filterHeight,r=t.filterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            int wCPerm = ${r} - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    `}}const Ntt={kernelName:mB,backendName:"webgl",kernelFunc:function Att(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{inputShape:o,strides:l,pad:c,dataFormat:u,dimRoundingMode:f}=r,m=vp(u),_=Ys(o,s.shape,l,1,c,f,!1,m);if(Me().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===m){const y=[[_.strideHeight,_.strideWidth]],w=new ktt(_);return e.runWebGLProgram(w,[i,s],"float32",y)}{const y=new Itt(_);return e.runWebGLProgram(y,[i,s],"float32")}}},Mtt={kernelName:gB,backendName:"webgl",kernelFunc:function Rtt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:l,dilations:c}=r,u=d_(i.shape,s.shape,o,c,l),f=new vtt(u);return e.runWebGLProgram(f,[i,s],"float32")}},Ftt={kernelName:X5,backendName:"webgl",kernelFunc:function Ott(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,pad:l,filterShape:c}=r,u=d_(i.shape,c,o,1,l),f=new Ttt(u);return e.runWebGLProgram(f,[i,s],"float32")}},Ltt={kernelName:J5,backendName:"webgl",kernelFunc:function Ptt(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{pad:o,strides:l,inputShape:c}=r,u=d_(c,s.shape,l,1,o),f=new Stt(u);return e.runWebGLProgram(f,[i,s],"float32")}},Vtt=br({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n",packedOpSnippet:`\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ${y0}\n  return result;\n`}),Utt={kernelName:J1,backendName:"webgl",kernelFunc:Vtt},ztt=br({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),Htt={kernelName:eN,backendName:"webgl",kernelFunc:ztt};class Gtt{constructor(t,e,r,i,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,l,c,u]=t,[f]=e,[m,_]=r;this.outputShape=[f,m,_,u];const y="bilinear"===i?1:0,[w,T]=[l-1+".0",c-1+".0"],[I,E,A]=m>1?[""+(l-1)/(m-1),"(y2-y1) * height_ratio",`y1*${w} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${w}`],[M,O,$]=_>1?[""+(c-1)/(_-1),"(x2-x1) * width_ratio",`x1*${T} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${T}`];this.userCode=`\n      const float height_ratio = float(${I});\n      const float width_ratio = float(${M});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${o}) {\n          return;\n        }\n\n        float height_scale = ${E};\n        float width_scale = ${O};\n\n        float in_y = ${A};\n        if( in_y < 0.0 || in_y > ${w} ) {\n          setOutput(float(${s}));\n          return;\n        }\n        float in_x = ${$};\n        if( in_x < 0.0 || in_x > ${T} ) {\n          setOutput(float(${s}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${y} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const Wtt={kernelName:tZ,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{image:i,boxes:s,boxInd:o}=t,{cropSize:l,method:c,extrapolationValue:u}=r,f=new Gtt(i.shape,s.shape,l,c,u);return e.runWebGLProgram(f,[i,s,o],"float32")}};var UT=(()=>(function(n){n.Prod="*",n.Sum="+"}(UT||(UT={})),UT))();class zme{constructor(t,e,r,i){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,l=r?this.op===UT.Prod?"1.0":"0.0":`getX(${Hme(s,"coords",this.op)})`,c=this.outputShape[this.outputShape.length-1];let u="",f="";r?(u=i?"end != "+(c-1):"end != 0",f=i?"end + 1":"end - 1"):(u=i?`end + pow2 < ${c}`:"end >= pow2",f=i?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${qr(s)} coords = getOutputCoords();\n        int end = ${Gme(s,"coords",this.op)};\n        float val = ${l};\n        int pow2 = int(pow(2.0, index));\n        if (${u}) {\n          int idx = ${f};\n          ${Gme(s,"coords",this.op)} = idx;\n          val ${this.op}= getX(${Hme(s,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function Hme(n,t,e){if(1===n)return`${t}`;if(2===n)return`${t}.x, ${t}.y`;if(3===n)return`${t}.x, ${t}.y, ${t}.z`;if(4===n)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}function Gme(n,t,e){if(1===n)return`${t}`;if(2===n)return`${t}.y`;if(3===n)return`${t}.z`;if(4===n)return`${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}function Wme(n,t,e,r,i,s){const o=t.shape.length,l=Pi([r],o);let c=t;null!=l&&(c=Sa({inputs:{x:t},backend:e,attrs:{perm:l}}));const u=is(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const f=c.shape[u];let m=$l({inputs:{x:c},backend:e});for(let _=0;_<=Math.ceil(Math.log2(f))-1;_++){const y=new zme(n,c.shape,!1,s),T=m;m=e.runWebGLProgram(y,[m],m.dtype,[[_]]),e.disposeIntermediateTensorInfo(T)}if(i){const _=new zme(n,c.shape,i,s),y=m;m=e.runWebGLProgram(_,[m],m.dtype),e.disposeIntermediateTensorInfo(y)}if(null!=l){const y=Sa({inputs:{x:m},backend:e,attrs:{perm:p_(l)}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(c),y}return m}const qtt={kernelName:eZ,backendName:"webgl",kernelFunc:function jtt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,exclusive:o,reverse:l}=r;return Wme(UT.Prod,i,e,s,o,l)}},Ytt={kernelName:_B,backendName:"webgl",kernelFunc:function Ztt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,exclusive:o,reverse:l}=r;return Wme(UT.Sum,i,e,s,o,l)}},Qtt={kernelName:nZ,backendName:"webgl",kernelFunc:function Ktt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,weights:s}=t,{size:o,binaryOutput:l}=r;if(1===i.shape.length){const c=e.readSync(i.dataId),u=e.readSync(s.dataId),f=ume(c,u,s.dtype,s.shape,o);return e.makeTensorInfo([o],s.dtype,f)}if(2===i.shape.length){const c=e.bufferSync(i),u=e.bufferSync(s),f=eXe(c,u,o,l);return e.makeTensorInfo(f.shape,s.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}};class Xtt{constructor(t,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=r,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const ent={kernelName:rZ,backendName:"webgl",kernelFunc:function Jtt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockSize:s,dataFormat:o}=r,l=i.shape[0],m=("NHWC"===o?i.shape[1]:i.shape[2])*s,_=("NHWC"===o?i.shape[2]:i.shape[3])*s,y=("NHWC"===o?i.shape[3]:i.shape[1])/(s*s),T=new Xtt("NHWC"===o?[l,m,_,y]:[l,y,m,_],s,o);return e.runWebGLProgram(T,[i],i.dtype)}};class jme{constructor(t,e=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ea(this.outputShape.length);const o=t.filterHeight,l=t.filterWidth,c=t.outChannels/t.inChannels;let u="",f="";r&&(u=i?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:s?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`\n          float activation(float x) {\n            ${r}\n          }\n        `,f="result = activation(result);");const m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${u}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${c};\n        int q = d2 - d1 * ${c};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${o}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${l}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${m}\n        ${f}\n        setOutput(result);\n      }\n    `}}class qme{constructor(t,e=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ea(this.outputShape.length);const o=t.outChannels/t.inChannels,l=t.padInfo.left,c=t.strideWidth,u=t.dilationWidth,f=t.filterHeight,m=t.filterWidth,_=m;let y="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let E=0;E<m;E++)y+=`\n          vec4 xTexelC${2*E};\n          int xTexelC${2*E}Ready;\n          vec4 xTexelC${2*E+1};\n          int xTexelC${2*E+1}Ready;\n          vec4 xC${E};`;y+=`\n    for (int r = 0; r < ${f}; r++) {\n      `;for(let E=0;E<m;E++)y+=`\n          xTexelC${2*E} = vec4(0.0);\n          xTexelC${2*E}Ready = 0;\n          xTexelC${2*E+1} = vec4(0.0);\n          xTexelC${2*E+1}Ready = 0;\n          xC${E} = vec4(0.0);`;y+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let E=0;E<(_+1)/2;E++){const A=2*E;if(y+=`\n          xC = xCCorner + ${A*u};\n          `,1===c){if(A<m&&(l%2==1?(y+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A}Ready == 0) {\n                  xTexelC${A} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${A}.zw = vec2(0.0);\n                  }\n                  xTexelC${A}Ready = 1;\n                }\n              `,y+=1===u&&A>0?`\n                xC${A} = vec4(xTexelC${A-2}.zw, xTexelC${A}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${A} = vec4(previous.zw, xTexelC${A}.xy);\n                  } else {\n                    xC${A} = vec4(0.0, 0.0, xTexelC${A}.xy);\n                  }\n                  `):y+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${A}Ready == 0) {\n                  xTexelC${A} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${A}.zw = vec2(0.0);\n                  }\n                  xTexelC${A}Ready = 1;\n                }\n\n                xC${A} = xTexelC${A};\n                `,A+1<m)){const M=l%2==0?P5(u):u;u%2==0&&l%2==1||u%2!=0&&l%2!=1?(y+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${M};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A+1}Ready == 0) {\n                    xTexelC${A+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${A+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${A+1}Ready = 1;\n                  }\n                  `,y+=u>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${A+1} = vec4(previous.zw, xTexelC${A+1}.xy);\n                    } else {\n                     xC${A+1} = vec4(0.0, 0.0, xTexelC${A+1}.xy);\n                    }\n                    `:`\n                    xC${A+1} = vec4(xTexelC${A}.zw, xTexelC${A+1}.xy);\n                    `):y+=1===M?`\n                    xC${A+1} = xTexelC${A};\n                    `:`\n                    xCOffset = xC + ${M};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A+1}Ready == 0) {\n                      xTexelC${A+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${A+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${A+1}Ready = 1;\n                    }\n\n                    xC${A+1} = xTexelC${A+1};\n                    `}}else A<m&&(l%2==1?(y+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A}Ready == 0) {\n                  xTexelC${A} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${A}.zw = vec2(0.0);\n                  }\n                  xTexelC${A}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${A+1}Ready == 0) {\n                  xTexelC${A+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${A+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${A+1}Ready = 1;\n                }\n\n                xC${A} = vec4(xTexelC${A}.zw, xTexelC${A+1}.zw);\n              `,A+1<m&&(y+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${A+1} = vec4(xTexelC${A+1}.xy, final.xy);\n                `)):(y+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${A}Ready == 0) {\n                  xTexelC${A} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${A}.zw = vec2(0.0);\n                  }\n                  xTexelC${A}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A+1}Ready == 0) {\n                  xTexelC${A+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${A+1}.zw = vec2(0.);\n                  }\n                  xTexelC${A+1}Ready = 1;\n                }\n\n                xC${A} = vec4(\n                  xTexelC${A}.xy, xTexelC${A+1}.xy);\n              `,A+1<m&&(y+=`\n                  xC${A+1} = vec4(xTexelC${A}.zw, xTexelC${A+1}.zw);\n                `)));A<m&&(y+=`\n            wTexel = getW(r, ${A}, d1, q);\n            dotProd += xC${A} * vec4(wTexel.xz, wTexel.xz);\n          `,A+1<m&&(y+=`\n              wTexel = getW(r, ${A+1}, d1, q);\n              dotProd += xC${A+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}y+="\n    }\n  ",y+="\n      }\n    ";let w="",T="";r&&(w=i?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:s?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`vec4 activation(vec4 x) {\n          ${r}\n        }`,T="result = activation(result);");const I=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${w}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${y}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${I}\n        ${T}\n        setOutput(result);\n      }\n    `}}const nnt={kernelName:yB,backendName:"webgl",kernelFunc:function tnt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:l,dilations:c,dimRoundingMode:u}=r;let f=c;null==f&&(f=[1,1]),G(wo(o,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${f}'`);const m=Ys(i.shape,s.shape,o,f,l,u,!0);let _;return _=Me().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels==1?new qme(m):new jme(m),e.runWebGLProgram(_,[i,s],"float32",[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]])}};class rnt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${t.outChannels/t.inChannels} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class int{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,r=t.filterWidth,c=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${r} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${c}; dm++) {\n              int d2 = d1 * ${c} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const ont={kernelName:iZ,backendName:"webgl",kernelFunc:function snt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,dilations:l,pad:c,dimRoundingMode:u,filterShape:f}=r,m=Ys(i.shape,f,o,l,c,u,!0),_=new rnt(m);return e.runWebGLProgram(_,[i,s],"float32")}},lnt={kernelName:sZ,backendName:"webgl",kernelFunc:function ant(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{strides:o,dilations:l,pad:c,dimRoundingMode:u,inputShape:f}=r,m=Ys(f,s.shape,o,l,c,u,!0),_=new int(m);return e.runWebGLProgram(_,[i,s],"float32")}};class cnt{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const dnt={kernelName:oZ,backendName:"webgl",kernelFunc:function unt(n){const{inputs:t,backend:e}=n,{x:r}=t,i=[...r.shape,...r.shape],s=Ye(r.shape),o=Lt({inputs:{x:r},backend:e,attrs:{shape:[s]}}),l=new cnt(s),c=e.runWebGLProgram(l,[o],o.dtype),u=Lt({inputs:{x:c},backend:e,attrs:{shape:i}});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(c),u}};class hnt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:r,padInfo:i,strideHeight:s,strideWidth:o,filterHeight:l,filterWidth:c,dilationHeight:u,dilationWidth:f}=t,{top:m,left:_}=i;this.userCode=`\n      const ivec2 strides = ivec2(${s}, ${o});\n      const ivec2 pads = ivec2(${m}, ${_});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${l}; h++) {\n          int hIn = hBeg + h * ${u};\n\n          if (hIn >= 0 && hIn < ${e}) {\n            for (int w = 0; w < ${c}; w++) {\n              int wIn = wBeg + w * ${f};\n\n              if (wIn >= 0 && wIn < ${r}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}const pnt={kernelName:vB,backendName:"webgl",kernelFunc:function fnt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:l,dilations:c}=r,u=HN(i.shape,s.shape,o,l,"NHWC",c);let f;const m=new hnt(u);f=e.runWebGLProgram(m,[i,s],"float32");const _=Lt({inputs:{x:f},backend:e,attrs:{shape:u.outShape}});return e.disposeIntermediateTensorInfo(f),_}},gnt={kernelName:uZ,backendName:"webgl",kernelFunc:function mnt(n){const{inputs:t,backend:e,attrs:r}=n,{equation:i}=r,s=t,{allDims:o,summedDims:l,idDims:c}=YY(i,s.length);QY(o.length,c,s);const{path:u,steps:f}=XY(l,c),m=f.length;let _=null,y=o.length;const w=[];for(let T=0;T<m;++T){for(const I of f[T]){const{permutationIndices:E,expandDims:A}=KY(y,c[I]);let M;JY(E)?M=s[I]:(M=Sa({inputs:{x:s[I]},backend:e,attrs:{perm:E}}),w.push(M));const O=M.shape.slice();for(let $=0;$<A.length;++$)O.splice(A[$],0,1);dr(M.shape,O)||(M=Lt({inputs:{x:M},backend:e,attrs:{shape:O}}),w.push(M)),null===_?_=M:(_=M9({inputs:{a:M,b:_},backend:e}),w.push(_))}T<m-1&&(u[T]>=0&&(_=Z3({inputs:{x:_},backend:e,attrs:{axis:u[T]-(o.length-y),keepDims:!1}}),w.push(_)),y--)}for(const T of w)T!==_&&e.disposeIntermediateTensorInfo(T);return _}},_nt=br({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),ynt={kernelName:nN,backendName:"webgl",kernelFunc:_nt},wnt={kernelName:dZ,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e}=n,{dy:r,y:i}=t,s=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $T("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,i.shape):new _0("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,i.shape);return e.runWebGLProgram(s,[r,i],r.dtype)}},Cnt=Io({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:sXe}),xnt={kernelName:bB,backendName:"webgl",kernelFunc:Cnt},Tnt=br({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${UY};\n  float a1 = ${zY};\n  float a2 = ${HY};\n  float a3 = ${GY};\n  float a4 = ${WY};\n  float a5 = ${jY};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),Snt={kernelName:rN,backendName:"webgl",kernelFunc:Tnt},Zme=br({opSnippet:"if (isnan(x)) return x;\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:oXe,dtype:"float32"}),Dnt={kernelName:iN,backendName:"webgl",kernelFunc:Zme};function L9(n){const{inputs:t,attrs:e,backend:r}=n,{dim:i}=e,{input:s}=t,o=s.shape.length,l=s.shape.slice();let c=i;return i<0&&(G(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+i+1),l.splice(c,0,1),Lt({inputs:{x:s},backend:r,attrs:{shape:l}})}const knt={kernelName:wB,backendName:"webgl",kernelFunc:L9},Yme="return exp(x) - 1.0;",Ant=br({opSnippet:Yme,packedOpSnippet:Yme,cpuKernelImpl:aXe}),Nnt={kernelName:sN,backendName:"webgl",kernelFunc:Ant};class Kme{constructor(t,e,r){this.variableNames=["real","imag"];const i=e[1];this.outputShape=e;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${i}.0`:"1.0";let l;if("real"===t)l="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);l="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${s};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${l}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${i});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${i}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${o};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}function Qme(n,t,e){const r=e.texData.get(n.dataId),i=Ye(n.shape),s=n.shape[n.shape.length-1],l=Lt({inputs:{x:n},backend:e,attrs:{shape:[i/s,s]}}),c=l.shape,u=new Kme("real",c,t),f=new Kme("imag",c,t),m=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],_=e.runWebGLProgram(u,m,"float32"),y=e.runWebGLProgram(f,m,"float32"),w=A_({inputs:{real:_,imag:y},backend:e});e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(y);const T=Lt({inputs:{x:w},backend:e,attrs:{shape:n.shape}});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(w),T}const Mnt={kernelName:"FFT",backendName:"webgl",kernelFunc:function Rnt(n){const{inputs:t,backend:e}=n,{input:r}=t;return Qme(r,!1,e)}};class Ont{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function RR(n){const{backend:t,attrs:e}=n,{shape:r,value:i}=e;let{dtype:s}=e;if(s=s||XI(i),"string"===s){const o=ns(s,Ye(r));return o.fill(i),t.makeTensorInfo(r,s,o)}{const o=new Ont(r,i);return t.runWebGLProgram(o,[],s,[[i]])}}const Fnt={kernelName:fZ,backendName:"webgl",kernelFunc:RR};class Pnt{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${e} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${e}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const Lnt={kernelName:pZ,backendName:"webgl",kernelFunc:({inputs:n,backend:t})=>{const{image:e}=n,r=t,i=new Pnt(e.shape);return r.runWebGLProgram(i,[e],e.dtype)}},Xme="return floor(x);",$nt=br({opSnippet:Xme,packedOpSnippet:Xme,cpuKernelImpl:lXe}),Bnt={kernelName:oN,backendName:"webgl",kernelFunc:$nt},Vnt=Io({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Unt={kernelName:aN,backendName:"webgl",kernelFunc:Vnt};class znt{constructor(t){this.variableNames=["A"];const e=Ia(),[r,i]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class Hnt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=Ia(),[r,i]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${i}.0, ${r}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}const Gnt={kernelName:KZ,backendName:"webgl",kernelFunc:function Wnt(n){const{inputs:t,backend:e,attrs:r}=n;let{pixels:i}=t;const{numChannels:s}=r,o=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[c,u]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],f=[u,c],m=[u,c,s];if(l||o){const T=Me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==zT||T!==$9)&&($9=T,zT=document.createElement("canvas").getContext("2d",{willReadFrequently:$9})),zT.canvas.width=c,zT.canvas.height=u,zT.drawImage(i,0,0,c,u),i=zT.canvas}const _=e.makeTensorInfo(f,"int32");e.texData.get(_.dataId).usage=Ll.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(_.dataId),i);const y=Me().getBool("WEBGL_PACK")?new Hnt(m):new znt(m),w=e.runWebGLProgram(y,[_],"int32");return e.disposeData(_.dataId),w}};let zT,$9=Me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const qnt={kernelName:aV,backendName:"webgl",kernelFunc:function jnt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:l}=t,{strides:c,pad:u,dataFormat:f,dilations:m,dimRoundingMode:_,activation:y,leakyreluAlpha:w}=r,T=vp(f),I=Ys(i.shape,s.shape,c,m,u,_,!1,T);let E;const A=[],M=null!=o,O=null!=l,$="leakyrelu"===y,V=()=>{const Q=[i,s],re=(oe,ye)=>{if("NCHW"===ye&&1===oe.shape.length&&1!==oe.shape[0]){const Ve=Lt({inputs:{x:oe},backend:e,attrs:{shape:[oe.shape[0],1,1]}});return A.push(Ve),Ve}return oe};if(M&&Q.push(re(o,f)),O&&Q.push(re(l,f)),$){const oe=e.makeTensorInfo([],"float32",n_(w,"float32"));Q.push(oe),A.push(oe)}return Q};if(1!==I.filterHeight||1!==I.filterWidth||1!==I.dilationHeight||1!==I.dilationWidth||1!==I.strideHeight||1!==I.strideWidth||"SAME"!==I.padInfo.type&&"VALID"!==I.padInfo.type)if(I.strideWidth<=2&&"channelsLast"===T&&Me().getBool("WEBGL_EXP_CONV")){const Q=y?DR(y,!0):null,re=new Bme(I,M,Q,O,$),oe=[[I.padInfo.top,I.padInfo.left],[I.strideHeight,I.strideWidth],[I.dilationHeight,I.dilationWidth],[I.inHeight,I.inWidth]],ye=V();E=e.runWebGLProgram(re,ye,"float32",oe)}else if(Me().getBool("WEBGL_CONV_IM2COL"))E=Ume({x:i,filter:s,convInfo:I,backend:e,bias:o,activation:y,preluActivationWeights:l,leakyreluAlpha:w});else{const Q=y?DR(y,!1):null,re=new $me(I,M,Q,O,$),oe=V();E=e.runWebGLProgram(re,oe,"float32")}else E=Vme({x:i,filter:s,convInfo:I,backend:e,bias:o,activation:y,preluActivationWeights:l,leakyreluAlpha:w});const Z=Lt({inputs:{x:E},backend:e,attrs:{shape:I.outShape}});return A.push(E),A.forEach(Q=>e.disposeIntermediateTensorInfo(Q)),Z}},Ynt={kernelName:lV,backendName:"webgl",kernelFunc:function Znt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:l}=t,{strides:c,pad:u,dilations:f,dimRoundingMode:m,activation:_,leakyreluAlpha:y}=r,w=[];let T=f;null==T&&(T=[1,1]),G(wo(c,T),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${T}'`);const I=Ys(i.shape,s.shape,c,T,u,m,!0),E=Me().getBool("WEBGL_PACK_DEPTHWISECONV")&&I.strideWidth<=2&&I.outChannels/I.inChannels==1,A=_?DR(_,E):null,M=[i,s],O=null!=o,$=null!=l,V="leakyrelu"===_;if(O&&M.push(o),$&&M.push(l),V){const oe=e.makeTensorInfo([],"float32",n_(y,"float32"));M.push(oe),w.push(oe)}let Z;Z=E?new qme(I,O,A,$,V):new jme(I,O,A,$,V);const re=e.runWebGLProgram(Z,M,"float32",[[I.padInfo.top,I.padInfo.left],[I.strideHeight,I.strideWidth],[I.dilationHeight,I.dilationWidth],[I.inHeight,I.inWidth]]);return w.forEach(oe=>e.disposeIntermediateTensorInfo(oe)),re}};class Knt{constructor(t,e,r,i){this.sliceDim=t,this.strides=e,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const s=qr(r.length);let o="\n    int index;";for(let l=0;l<this.sliceDim;l++)o+=`\n          index = round(getIndices(coords[0], ${l}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[l]};\n          flattenIndex += index * ${this.strides[l]};`;this.userCode=`\n         void main() {\n          ${s} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${o}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}const Xnt={kernelName:mZ,backendName:"webgl",kernelFunc:function Qnt(n){const{inputs:t,backend:e}=n,{params:r,indices:i}=t,s=i.shape,o=s[s.length-1],l=Ye(r.shape),[c,u,f,m]=VY(r,i),_=Lt({inputs:{x:i},backend:e,attrs:{shape:[u,o]}}),y=Lt({inputs:{x:r},backend:e,attrs:{shape:[Ye(r.shape)/f,f]}});if(e.shouldExecuteOnCPU([r,i])||"string"===r.dtype){const E=e.readSync(i.dataId),A=e.bufferSync(r),M=cXe(E,A,r.dtype,u,o,f,m,r.shape,l);return e.makeTensorInfo(c,r.dtype,M.values)}const w=new Knt(o,m,[u,f],r.shape),T=e.runWebGLProgram(w,[y,_],y.dtype),I=Lt({inputs:{x:T},backend:e,attrs:{shape:c}});return e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(T),I}};class Jnt{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const r=qr(this.rank),i=function ert(n,t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<n.length;i++)r.push(2===i?"index":`${e[i]}`);return r.join()}(t);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${i}));\n      }\n    `}}function Jme(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,indices:s}=t,{axis:o,batchDims:l}=r,c=Kn(o,i.shape)[0];if(Me().get("DEBUG")){const A=e.readSync(s.dataId),M=i.shape[c];for(let O=0;O<A.length;++O){const $=A[O];G($<=M-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${M-1}]`)}}const u=nK(i,s,c,l),f=Ye(s.shape),m=[],_=Lt({inputs:{x:i},backend:e,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),y=Lt({inputs:{x:s},backend:e,attrs:{shape:[u.batchSize,f/u.batchSize]}});m.push(_),m.push(y);const w=[u.batchSize,u.outerSize,f/u.batchSize,u.sliceSize];if(e.shouldExecuteOnCPU([i,s])||"string"===i.dtype){const A=e.bufferSync(y),M=e.bufferSync(_),O=uXe(M,A,w);return m.forEach($=>e.disposeIntermediateTensorInfo($)),e.makeTensorInfo(u.outputShape,O.dtype,O.values)}const T=new Jnt(_.shape,w),I=e.runWebGLProgram(T,[_,y],_.dtype);m.push(I);const E=Lt({inputs:{x:I},backend:e,attrs:{shape:u.outputShape}});return m.forEach(A=>e.disposeIntermediateTensorInfo(A)),E}const trt={kernelName:xB,backendName:"webgl",kernelFunc:Jme},nrt=Io({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:dXe,dtype:"bool"}),rrt={kernelName:IB,backendName:"webgl",kernelFunc:nrt},irt=Io({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:hXe}),srt={kernelName:lN,backendName:"webgl",kernelFunc:irt},art={kernelName:gZ,backendName:"webgl",kernelFunc:function ort(n){const{inputs:t,backend:e}=n,{input:r}=t;return Qme(r,!0,e)}},lrt=br({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),crt={kernelName:uN,backendName:"webgl",kernelFunc:lrt},urt=br({opSnippet:"return float(isinf(x));",dtype:"bool"}),drt={kernelName:dN,backendName:"webgl",kernelFunc:urt},hrt=br({opSnippet:"return float(isnan(x));",dtype:"bool"}),frt={kernelName:hN,backendName:"webgl",kernelFunc:hrt},prt=Io({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:fXe,dtype:"bool"}),mrt={kernelName:SB,backendName:"webgl",kernelFunc:prt},grt=Io({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:pXe,dtype:"bool"}),_rt={kernelName:EB,backendName:"webgl",kernelFunc:grt},vrt={kernelName:yZ,backendName:"webgl",kernelFunc:function yrt(n){const{backend:t,attrs:e}=n,{start:r,stop:i,num:s}=e,o=mXe(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}},wrt=br({opSnippet:"if (isnan(x)) return x;\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:gXe}),Crt={kernelName:fN,backendName:"webgl",kernelFunc:wrt},Irt=br({opSnippet:"if (isnan(x)) return x;\n  return log(1.0 + x);\n"}),Trt={kernelName:pN,backendName:"webgl",kernelFunc:Irt},Srt=Io({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),Ert={kernelName:DB,backendName:"webgl",kernelFunc:Srt},Drt=br({opSnippet:"return float(!(x >= 1.0));"}),krt={kernelName:kB,backendName:"webgl",kernelFunc:Drt},Art=Io({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),Nrt={kernelName:AB,backendName:"webgl",kernelFunc:Art};class Rrt{constructor(t,e,r,i,s){this.variableNames=["x"],this.outputShape=[];const o=e,l=t[3]-1;let c;this.outputShape=t;const u=`float(${r}) + float(${i}) * sum`;c=.5===s?`inversesqrt(${u})`:1===s?`1.0/(${u})`:`exp(log(${u}) * float(-${s}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${o}; j <= ${o}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${l}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${c};\n        setOutput(val);\n      }\n    `}}class Mrt{constructor(t,e,r,i,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=e,l=t[3]-1;let c;this.outputShape=t;const u=`float(${r}) + float(${i}) * sum`;c=.5===s?`inversesqrt(${u})`:1===s?`1.0/(${u})`:`exp(log(${u}) * float(-${s}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${o};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${o}; j <= ${o}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${l}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${c};\n        setOutput(result);\n      }\n    `}}const Ort={kernelName:NB,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{depthRadius:s,bias:o,alpha:l,beta:c}=r,u=Me().getBool("WEBGL_PACK_NORMALIZATION")?new Mrt(i.shape,s,o,l,c):new Rrt(i.shape,s,o,l,c);return e.runWebGLProgram(u,[i],i.dtype)}};class Frt{constructor(t,e,r,i,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=r,this.alpha=i,this.beta=s,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${i}) * norm + float(${r});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${i})\n                * float(${s})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${s});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}const Prt={kernelName:vZ,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i,y:s,dy:o}=t,{depthRadius:l,bias:c,alpha:u,beta:f}=r,m=new Frt(i.shape,l,c,u,f);return e.runWebGLProgram(m,[i,s,o],i.dtype)}};function ege(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{reductionIndices:s,keepDims:o}=r,l=i.shape.length,c=Kn(s,i.shape);let u=c;const f=Pi(u,l),m=null!=f,_=e.shouldExecuteOnCPU([i]);let y=i;if(m){if(_){const M=e.texData.get(y.dataId).values,O=new Array(l);for(let Z=0;Z<O.length;Z++)O[Z]=i.shape[f[Z]];const $=N9(M,i.shape,i.dtype,f,O);y=e.makeTensorInfo(O,i.dtype),e.texData.get(y.dataId).values=$}else y=q3(i,f,e);u=is(u.length,l)}Co("max",u,l);const[w,T]=Ks(y.shape,u);let E,I=w;if(o&&(I=rs(w,c)),_){const M=e.texData.get(y.dataId).values,O=_Xe(M,Ye(T),I,i.dtype);E=e.makeTensorInfo(I,i.dtype),e.texData.get(E.dataId).values=O}else E=function Lrt(n,t,e,r){const i=Ye(t),l=Lt({inputs:{x:n},attrs:{shape:[Ye(n.shape)/i,i]},backend:r}),c=v0(l,n.dtype,"max",r),u=Lt({inputs:{x:c},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(l),r.disposeIntermediateTensorInfo(c),u}(y,T,I,e);return m&&e.disposeIntermediateTensorInfo(y),E}const $rt={kernelName:RB,backendName:"webgl",kernelFunc:ege},Urt=Io({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:yXe}),zrt={kernelName:mN,backendName:"webgl",kernelFunc:Urt},Grt={kernelName:MB,backendName:"webgl",kernelFunc:function Hrt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;SR(i,"maxPool");const{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;G(wo(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const f=ou(i.shape,s,o,1,l,c);if(1===f.filterWidth&&1===f.filterHeight&&dr(f.inShape,f.outShape))return $l({inputs:{x:i},backend:e});const m=new kR(f,"max",!1);return e.runWebGLProgram(m,[i],i.dtype)}},jrt={kernelName:OB,backendName:"webgl",kernelFunc:function Wrt(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{filterSize:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r,m=yp(i.shape,s,o,[1,1,1],l,u,c),_=new O9(m,"max",!1);return e.runWebGLProgram(_,[i],i.dtype)}};class qrt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const s=t.effectiveFilterHeight,o=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${s-1-t.padInfo.top}, ${o-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${s};\n          wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${o}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${s*o-1} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${o} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Zrt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,f=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${c-1-t.padInfo.front}, ${u-1-t.padInfo.top}, ${f-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${c};\n           wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${u};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${f};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${c*u*f-1} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${u} * ${f} +\n                  wR * ${f} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Krt={kernelName:wZ,backendName:"webgl",kernelFunc:function Yrt(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,o=s,{filterSize:l,strides:c,pad:u,dimRoundingMode:f}=r,_=yp(o.shape,l,c,[1,1,1],u,f),y=new O9(_,"max",!0),w=e.runWebGLProgram(y,[o],o.dtype),T=new Zrt(_),I=e.runWebGLProgram(T,[i,w],o.dtype);return e.disposeIntermediateTensorInfo(w),I}},Xrt={kernelName:bZ,backendName:"webgl",kernelFunc:function Qrt(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s,output:o}=t,l=s;SR([s,o],"maxPoolGrad");const{filterSize:c,strides:u,pad:f,dimRoundingMode:m}=r,_=ou(l.shape,c,u,1,f,m),w=new kR(_,"max",!0),T=e.runWebGLProgram(w,[l],l.dtype),I=new qrt(_),E=e.runWebGLProgram(I,[i,T],l.dtype);return e.disposeIntermediateTensorInfo(T),E}},eit={kernelName:CZ,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:r}=n,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=t,c=e;G(4===r.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];G(wo(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const f=ou(r.shape,i,s,u,o),[m,_]=function Jrt(n,t,e,r){let i=new kR(e,"max",!1);const s=r.runWebGLProgram(i,[n],"float32");return i=new kR(e,"max",!0,!0,t),[s,r.runWebGLProgram(i,[n],"float32")]}(r,l,f,c);return[m,_]}},nit={kernelName:FB,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:r}=n,{keepDims:i,axis:s}=t,o=e,l=r.shape.length,c=Kn(s,r.shape);let u=c;const f=Pi(u,l),m=null!=f,_=o.shouldExecuteOnCPU([r]),y=[];let w=r;if(m){if(_){const O=o.texData.get(w.dataId).values,$=new Array(l);for(let Q=0;Q<$.length;Q++)$[Q]=r.shape[f[Q]];const V=N9(O,r.shape,r.dtype,f,$);w=o.makeTensorInfo($,r.dtype),o.texData.get(w.dataId).values=V}else w=q3(r,f,o);y.push(w),u=is(u.length,l)}Co("sum",u,l);const[T,I]=Ks(w.shape,u);let E=T;i&&(E=rs(T,c));const A=function tit(n,t,e,r){const i=Ye(t),l=Lt({inputs:{x:n},attrs:{shape:[Ye(n.shape)/i,i]},backend:r}),c=v0(l,"float32","mean",r),u=Lt({inputs:{x:c},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(l),r.disposeIntermediateTensorInfo(c),u}(w,I,E,o);for(const M of y)o.disposeIntermediateTensorInfo(M);return A}},iit={kernelName:PB,backendName:"webgl",kernelFunc:function rit(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,l=i.shape.length,c=Kn(s,i.shape);let u=c;const f=Pi(u,l);let m=i;null!=f&&(m=Sa({inputs:{x:i},backend:e,attrs:{perm:f}}),u=is(u.length,i.shape.length)),Co("min",u,l);const[_,y]=Ks(m.shape,u),T=Lt({inputs:{x:m},backend:e,attrs:{shape:[-1,Ye(y)]}}),I=v0(T,T.dtype,"min",e);let E;return E=Lt(o?{inputs:{x:I},backend:e,attrs:{shape:rs(_,c)}}:{inputs:{x:I},backend:e,attrs:{shape:_}}),e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(I),null!=f&&e.disposeIntermediateTensorInfo(m),E}},ait=Io({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:vXe}),lit={kernelName:gN,backendName:"webgl",kernelFunc:ait};class cit{constructor(t,e,r){this.variableNames=["x"],this.outputShape=e.map((f,m)=>f[0]+t[m]+f[1]);const i=t.length,s=qr(i),o=e.map(f=>f[0]).join(","),l=e.map((f,m)=>f[0]+t[m]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),u="reflect"===r?0:1;this.userCode=1!==i?`\n      ${s} start = ${s}(${o});\n      ${s} end = ${s}(${l});\n\n      void main() {\n        ${s} outC = getOutputCoords();\n        for (int i = 0; i < ${i}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${u};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};\n          }\n        }\n        ${s} coords = outC - start;\n        setOutput(getX(${c}));\n      }\n    `:`\n        int start = ${o};\n        int end = ${l};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${u};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${u};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}class uit{constructor(t,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((w,T)=>w[0]+t[T]+w[1]);const i=t.length,s=qr(i),o=e.map(w=>w[0]).join(","),l=e.map((w,T)=>w[0]+t[T]).join(","),c=Ta("rc",i),u=Ta("source",i),f=`${c[i-1]} < ${this.outputShape[i-1]}`,m=1===i?"source":`vec2(${u.slice(-2).join()})`,_="reflect"===r?0:1;let y="";if(1===i){const w=`\n        ${s} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${_};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${_};\n        }\n        source -= start;\n      `;y=`\n        ${s} rc = outputLoc;\n        ${w}\n        result[0] = getChannel(getX(${u.join()}), ${m});\n        ${c[i-1]} += 1;\n        if(${f}) {\n          ${w}\n          result[1] = getChannel(getX(${u.join()}), ${m});\n        }\n      `}else{const w=`\n        ${s} source = rc;\n        ${s} lt = ${s}(lessThan(source, start));\n        ${s} gte = ${s}(greaterThanEqual(source, end));\n        ${s} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${_}) +\n                gte * ((end - 1) * 2 - source + ${_});\n        source -= start;\n      `;y=`\n        ${s} rc = outputLoc;\n        ${w}\n        result[0] = getChannel(getX(${u.join()}), ${m});\n        ${c[i-1]} += 1;\n        if(${f}) {\n          ${w}\n          result[1] = getChannel(getX(${u.join()}), ${m});\n        }\n        rc = outputLoc;\n        ${c[i-2]} += 1;\n        if(${c[i-2]} < ${this.outputShape[i-2]}) {\n          ${w}\n          result[2] = getChannel(getX(${u.join()}), ${m});\n          ${c[i-1]} += 1;\n          if(${f}) {\n            ${w}\n            result[3] = getChannel(getX(${u.join()}), ${m});\n          }\n        }\n      `}this.userCode=`\n      const ${s} start = ${s}(${o});\n      const ${s} end = ${s}(${l});\n\n      void main() {\n        ${s} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${y}\n        setOutput(result);\n      }\n    `}}const dit={kernelName:LB,backendName:"webgl",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r}=n,{paddings:i,mode:s}=e,o=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uit(r.shape,i,s):new cit(r.shape,i,s);return t.runWebGLProgram(o,[r],r.dtype)}},pit=Io({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),mit={kernelName:_N,backendName:"webgl",kernelFunc:pit};class git{constructor(t,e,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}}const tge=Io({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),_it={kernelName:tN,backendName:"webgl",kernelFunc:tge},nge="return a - b;",rge=Io({opSnippet:nge,packedOpSnippet:nge,supportsComplex:!0,cpuKernelImpl:VXe}),yit={kernelName:MN,backendName:"webgl",kernelFunc:rge};function ige(n){const{inputs:t,backend:e,attrs:r}=n,{logits:i}=t,{dim:s}=r,o=Kn([s],i.shape),l=ege({inputs:{x:i},backend:e,attrs:{reductionIndices:o,keepDims:!1}}),c=rs(l.shape,o),u=Lt({inputs:{x:l},backend:e,attrs:{shape:c}}),f=rge({inputs:{a:i,b:u},backend:e}),m=Zme({inputs:{x:f},backend:e}),_=Z3({inputs:{x:m},backend:e,attrs:{axis:o,keepDims:!1}}),y=Lt({inputs:{x:_},backend:e,attrs:{shape:c}}),w=tge({inputs:{a:m,b:y},backend:e});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(y),w}const vit={kernelName:tV,backendName:"webgl",kernelFunc:ige},wit={kernelName:xZ,backendName:"webgl",kernelFunc:function bit(n){const{inputs:t,backend:e,attrs:r}=n,{logits:i}=t,{numSamples:s,seed:o,normalized:l}=r,c=l?i:ige({inputs:{logits:i},backend:e,attrs:{dim:i.shape.length-1}}),m=new git(c.shape[0],c.shape[1],s),y=e.runWebGLProgram(m,[c],"int32",[[o]]);return l||e.disposeIntermediateTensorInfo(c),y}},Tit={kernelName:$B,backendName:"webgl",kernelFunc:function Iit(n){const{inputs:t,backend:e}=n,{x:r}=t;if(e.shouldExecuteOnCPU([r])){const s=e.texData.get(r.dataId),[o,l]=wXe(s.values,r.shape,r.dtype);return e.makeTensorInfo(l,r.dtype,o)}let i;return i=Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new k_(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new Nh(r.shape,"if (isnan(x)) return x;\n  return -x;\n"),e.runWebGLProgram(i,[r],r.dtype)}},Sit=DY,Dit={kernelName:IZ,backendName:"webgl",kernelFunc:function Eit(n){hc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=r,u=e.readSync(i.dataId),f=e.readSync(s.dataId),{selectedIndices:m}=Sit(u,f,o,l,c);return e.makeTensorInfo([m.length],"int32",new Int32Array(m))}},kit=kY,Nit={kernelName:TZ,backendName:"webgl",kernelFunc:function Ait(n){hc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,padToMaxOutputSize:u}=r,f=e.readSync(i.dataId),m=e.readSync(s.dataId),{selectedIndices:_,validOutputs:y}=kit(f,m,o,l,c,u);return[e.makeTensorInfo([_.length],"int32",new Int32Array(_)),e.makeTensorInfo([],"int32",new Int32Array([y]))]}},Rit=AY,Oit={kernelName:SZ,backendName:"webgl",kernelFunc:function Mit(n){hc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=r,f=e.readSync(i.dataId),m=e.readSync(s.dataId),_=o,y=l,w=c,T=u,{selectedIndices:I,selectedScores:E}=Rit(f,m,_,y,w,T);return[e.makeTensorInfo([I.length],"int32",new Int32Array(I)),e.makeTensorInfo([E.length],"float32",new Float32Array(E))]}};class Fit{constructor(t,e,r,i){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${i}), float(${r}),\n                      float(index == coords.y)));\n      }\n    `}}const Pit={kernelName:UB,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{indices:i}=t,{dtype:s,depth:o,onValue:l,offValue:c}=r,u=Ye(i.shape),f=new Fit(u,o,l,c),m=Lt({inputs:{x:i},backend:e,attrs:{shape:[u]}}),_=e.runWebGLProgram(f,[m],s);e.disposeIntermediateTensorInfo(m);const w=Lt({inputs:{x:_},backend:e,attrs:{shape:[...i.shape,o]}});return e.disposeIntermediateTensorInfo(_),w}};function eU(n){const{inputs:t,backend:e}=n,{x:r}=t;if("complex64"===r.dtype){const i=AR({inputs:{input:r},backend:e}),s=eU({inputs:{x:i},backend:e}),o=X3({inputs:{input:r},backend:e}),l=eU({inputs:{x:o},backend:e}),c=A_({inputs:{real:s,imag:l},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(l),c}return RR({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:e})}const Lit={kernelName:sV,backendName:"webgl",kernelFunc:eU},$it={kernelName:VB,backendName:"webgl",kernelFunc:function sge(n){const{inputs:t,backend:e}=n,{x:r}=t;if("string"===r.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===r.dtype){const i=AR({inputs:{input:r},backend:e}),s=sge({inputs:{x:i},backend:e}),o=X3({inputs:{input:r},backend:e}),l=eU({inputs:{x:o},backend:e}),c=A_({inputs:{real:s,imag:l},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(l),c}return RR({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:e})}},Vit={kernelName:zB,backendName:"webgl",kernelFunc:function Bit(n){const{inputs:t,backend:e,attrs:r}=n,{axis:i}=r;if(1===t.length)return L9({inputs:{input:t[0]},backend:e,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach(f=>{El(s,f.shape,"All tensors passed to stack must have matching shapes"),G(o===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],u=Lme({inputs:t.map(f=>{const m=L9({inputs:{input:f},backend:e,attrs:{dim:i}});return l.push(m),m}),backend:e,attrs:{axis:i}});return l.forEach(f=>e.disposeIntermediateTensorInfo(f)),u}};class Uit{constructor(t,e,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((u,f)=>u[0]+t[f]+u[1]);const i=t.length,s=qr(i),o=e.map(u=>u[0]).join(","),l=e.map((u,f)=>u[0]+t[f]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);this.userCode=1!==i?`\n      ${s} start = ${s}(${o});\n      ${s} end = ${s}(${l});\n\n      void main() {\n        ${s} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${s} coords = outC - start;\n          setOutput(getX(${c}));\n        }\n      }\n    `:`\n        int start = ${o};\n        int end = ${l};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class zit{constructor(t,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((T,I)=>T[0]+t[I]+T[1]);const i=t.length,s=qr(i),o=e.map(T=>T[0]).join(","),l=e.map((T,I)=>T[0]+t[I]).join(","),c=Ta("rc",i),u=Ta("source",i),f=`${c[i-1]} < ${this.outputShape[i-1]}`,m=1===i?"source":`vec2(${u.slice(-2).join()})`,_=[`${s} rc = outputLoc;`,`${c[i-1]} += 1;\n       if(${f}) {\n      `,1===i?"":`}\n       rc = outputLoc;\n       ${c[i-2]} += 1;\n       if(${c[i-2]} < ${this.outputShape[i-2]}) {`,1===i?"":`  ${c[i-1]} += 1;\n         if(${f}) {`],y=1===i?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let w="";for(let T=0,I=1===i?2:4;T<I;T++)w+=`\n        ${_[T]}\n        if (${y}) {\n          result[${T}] = float(value);\n        } else {\n          ${s} source = rc - start;\n          result[${T}] = getChannel(getX(${u.join()}), ${m});\n        }\n      `;w+=1===i?"} ":"}}",this.userCode=`\n      const ${s} start = ${s}(${o});\n      const ${s} end = ${s}(${l});\n\n      void main() {\n        ${s} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${w}\n        setOutput(result);\n      }\n    `}}const oge=n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{paddings:s,constantValue:o}=r;if(0===Ye(i.shape))return RR({backend:e,attrs:{shape:s.map((f,m)=>f[0]+i.shape[m]+f[1]),value:o,dtype:i.dtype}});const l=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zit(i.shape,s,o):new Uit(i.shape,s,o);return e.runWebGLProgram(l,[i],i.dtype,[[o]])},Hit={kernelName:HB,backendName:"webgl",kernelFunc:oge},jit=Io({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),qit={kernelName:vN,backendName:"webgl",kernelFunc:jit},Yit={kernelName:WB,backendName:"webgl",kernelFunc:function Zit(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,l=i.shape.length,c=[],u=Kn(s,i.shape);let f=u;const m=Pi(f,l);let y,_=i;if(null!=m&&(_=Sa({inputs:{x:i},backend:e,attrs:{perm:m}}),f=is(f.length,l),c.push(_)),Co("prod",f,l),e.shouldExecuteOnCPU([_])){const w=e.texData.get(_.dataId).values,{outVals:T,outShape:I,outDtype:E}=xXe(_.shape,_.dtype,w,f);y=e.makeTensorInfo(I,E,T)}else{const[w,T]=Ks(_.shape,f),I=Ye(T),E=Lt({inputs:{x:_},backend:e,attrs:{shape:[-1,I]}}),M=v0(E,r8(i.dtype),"prod",e);y=Lt({inputs:{x:M},backend:e,attrs:{shape:w}}),c.push(E),c.push(M)}if(o){c.push(y);const w=rs(y.shape,u);y=Lt({inputs:{x:y},backend:e,attrs:{shape:w}})}return c.forEach(w=>e.disposeIntermediateTensorInfo(w)),y}},Qit={kernelName:EZ,backendName:"webgl",kernelFunc:function Kit(n){const{inputs:t,backend:e,attrs:r}=n,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,{outputRaggedRank:l}=r,c=i.map(E=>e.readSync(E.dataId)),u=i.map(E=>E.shape),f=e.readSync(s.dataId),m=e.readSync(o.dataId),[_,y,w]=IXe(c,u,f,s.shape,s.dtype,m,o.shape,l),T=_.map(E=>e.makeTensorInfo([E.length],"int32",E)),I=e.makeTensorInfo(w,s.dtype,y);return T.concat([I])}},Jit={kernelName:DZ,backendName:"webgl",kernelFunc:function Xit(n){const{inputs:t,backend:e}=n,{starts:r,limits:i,deltas:s}=t,o=e.readSync(r.dataId),l=e.readSync(i.dataId),c=e.readSync(s.dataId),[u,f]=TXe(o,r.shape,r.dtype,l,i.shape,c,s.shape);return[e.makeTensorInfo([u.length],"int32",u),e.makeTensorInfo([f.length],r.dtype,f)]}},tst={kernelName:kZ,backendName:"webgl",kernelFunc:function est(n){const{inputs:t,backend:e,attrs:r}=n,{shape:i,values:s,defaultValue:o,rowPartitionTensors:l}=t,{rowPartitionTypes:c}=r,u=e.readSync(i.dataId),f=e.readSync(s.dataId),m=e.readSync(o.dataId),_=l.map(I=>e.readSync(I.dataId)),y=l.map(I=>I.shape),[w,T]=SXe(u,i.shape,f,s.shape,s.dtype,m,o.shape,_,y,c);return e.makeTensorInfo(w,s.dtype,T)}},age=n=>{const{backend:t,attrs:e}=n,{start:r,stop:i,step:s,dtype:o}=e,l=EXe(r,i,s,o);return t.makeTensorInfo([l.length],o,l)},nst={kernelName:AZ,backendName:"webgl",kernelFunc:age},rst=br({opSnippet:"return 1.0 / x;"}),ist={kernelName:bN,backendName:"webgl",kernelFunc:rst},ost=br({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),ast={kernelName:wN,backendName:"webgl",kernelFunc:ost},cst=br({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),ust={kernelName:CN,backendName:"webgl",kernelFunc:cst};class dst{constructor(t,e,r,i,s){this.variableNames=["A"],this.outputShape=[];const[o,l,c,u]=t;this.outputShape=[o,e,r,u];const f=[i&&e>1?l-1:l,i&&r>1?c-1:c],m=[i&&e>1?e-1:e,i&&r>1?r-1:r];let _;_=s?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${f[0]/m[0]},\n          ${f[1]/m[1]});\n      const vec2 inputShapeRC = vec2(${l}.0, ${c}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${_};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class hst{constructor(t,e,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,l,c,u]=t;this.outputShape=[o,e,r,u];const f=[i&&e>1?l-1:l,i&&r>1?c-1:c],m=[i&&e>1?e-1:e,i&&r>1?r-1:r];let _;_=s?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${f[0]/m[0]},\n          ${f[1]/m[1]},\n          ${f[1]/m[1]});\n      const vec3 inputShapeRC = vec3(${l}.0, ${c}.0,\n                                     ${c}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${_};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${u-1};\n        bool hasNextRow = coords.z < ${r-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const pst={kernelName:ZB,backendName:"webgl",kernelFunc:function fst(n){const{inputs:t,backend:e,attrs:r}=n,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:l}=r,[c,u]=l,f=Me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new hst(i.shape,c,u,s,o):new dst(i.shape,c,u,s,o);return e.runWebGLProgram(f,[i],"float32")}};class mst{constructor(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,i,s]=e,[,o,l]=t,c=[r&&o>1?i-1:i,r&&l>1?s-1:s],u=[r&&o>1?o-1:o,r&&l>1?l-1:l],f=c[0]/u[0],m=c[1]/u[1],_=1/f,y=1/m,w=2*Math.ceil(_)+2,T=2*Math.ceil(y)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${f});\n        const float widthScale = float(${m});\n\n        const float invHeightScale = float(${_});\n        const float invWidthScale = float(${y});\n\n        const int winHeight = int(${w});\n        const int winWidth = int(${T});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${l}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const _st={kernelName:MZ,backendName:"webgl",kernelFunc:function gst(n){const{inputs:t,backend:e,attrs:r}=n,{images:i,dy:s}=t,{alignCorners:o}=r,l=new mst(s.shape,i.shape,o);return e.runWebGLProgram(l,[s],s.dtype)}};class yst{constructor(t,e,r,i,s){this.variableNames=["A"],this.outputShape=[];const[o,l,c,u]=t;this.outputShape=[o,e,r,u];const f=[i&&e>1?l-1:l,i&&r>1?c-1:c],m=[i&&e>1?e-1:e,i&&r>1?r-1:r];let y;y=s?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${f[0]/m[0]},\n          ${f[1]/m[1]});\n      const vec2 inputShapeRC = vec2(${l}.0, ${c}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${y};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${i?"0.5":"0.0"})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class vst{constructor(t,e,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,l,c,u]=t;this.outputShape=[o,e,r,u];const f=[i&&e>1?l-1:l,i&&r>1?c-1:c],m=[i&&e>1?e-1:e,i&&r>1?r-1:r];let y;y=s?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${f[0]/m[0]},\n          ${f[1]/m[1]},\n          ${f[1]/m[1]});\n      const vec3 inputShapeRC = vec3(${l}.0, ${c}.0,\n                                     ${c}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${y};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${i?"0.5":"0.0"})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${u-1};\n        bool hasNextRow = coords.z < ${r-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}const wst={kernelName:qB,backendName:"webgl",kernelFunc:function bst(n){const{inputs:t,backend:e,attrs:r}=n,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:l}=r,[c,u]=l,f=Me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new vst(i.shape,c,u,s,o):new yst(i.shape,c,u,s,o);return e.runWebGLProgram(f,[i],i.dtype)}};class Cst{constructor(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,i,s]=e,[,o,l]=t,c=[r&&o>1?i-1:i,r&&l>1?s-1:s],u=[r&&o>1?o-1:o,r&&l>1?l-1:l],f=c[0]/u[0],m=c[1]/u[1],_=1/f,y=1/m,w=2*Math.ceil(_)+2,T=2*Math.ceil(y)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${f});\n        const float widthScale = float(${m});\n\n        const float invHeightScale = float(${_});\n        const float invWidthScale = float(${y});\n\n        const int winHeight = int(${w});\n        const int winWidth = int(${T});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${l}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${c[0]}) *\n                (float(dyR) / float(${u[0]}));\n\n            float sourceFracCol =\n                float(${c[1]}) *\n                  (float(dyC) / float(${u[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${i}) - 1),\n                ${r} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${s}) - 1),\n                ${r} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const Ist={kernelName:RZ,backendName:"webgl",kernelFunc:function xst(n){const{inputs:t,backend:e,attrs:r}=n,{images:i,dy:s}=t,{alignCorners:o}=r,l=new Cst(s.shape,i.shape,o);return e.runWebGLProgram(l,[s],s.dtype)}};class Tst{constructor(t,e){this.variableNames=["x"];const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,1===r)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const s=t.map((l,c)=>(l=>-1!==e.indexOf(l)&&1!==t[l]?`${t[l]} - coords[${l}] - 1`:`coords[${l}]`)(c)).join(","),o=qr(r);this.userCode=`\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${s}));\n      }\n    `}}class Sst{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;const i=Ta("rc",r),s=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,l=qr(r);function _(w){const T=t.map((A,M)=>function y(w,T){return-1!==e.indexOf(w)&&1!==t[w]?`${t[w]} - ${T[w]} - 1`:`${T[w]}`}(M,w));return`getChannel(getX(${T.join(",")}), vec2(${T.slice(-2).join(",")}))`}this.userCode=1===r?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${s}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${l} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function c(w){return _(w)}(i.slice())};\n          if(${s}){\n            result.g = ${function u(w){return w[r-1]="("+w[r-1]+" + 1)",_(w)}(i.slice())};\n          }\n          if(${o}) {\n            result.b = ${function f(w){return w[r-2]="("+w[r-2]+" + 1)",_(w)}(i.slice())};\n            if(${s}) {\n              result.a = ${function m(w){return w[r-1]="("+w[r-1]+" + 1)",w[r-2]="("+w[r-2]+" + 1)",_(w)}(i.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const Dst={kernelName:YB,backendName:"webgl",kernelFunc:function Est(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{dims:s}=r,o=i.shape.length,l=Kn(s,i.shape);if(0===o)return $l({inputs:{x:i},backend:e});const c=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sst(i.shape,l):new Tst(i.shape,l);return e.runWebGLProgram(c,[i],i.dtype)}};class kst{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=t[1],i=t[2];this.outputShape=t;let s="";s="number"==typeof e?`float outputValue = ${e.toFixed(2)};`:`\n        vec3 fill = vec3(${e.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${s}\n          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const Ast={kernelName:QZ,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:r}=n,{radians:i,fillValue:s,center:o}=t,l=e,c=new kst(r.shape,s),[u,f]=LY(o,r.shape[1],r.shape[2]),m=[[u,f,Math.sin(i),Math.cos(i)]];return l.runWebGLProgram(c,[r],r.dtype,m)}},Nst=br({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),Rst={kernelName:xN,backendName:"webgl",kernelFunc:Nst},Mst=br({opSnippet:"return inversesqrt(x);",cpuKernelImpl:DXe}),Ost={kernelName:IN,backendName:"webgl",kernelFunc:Mst};class B9{constructor(t,e,r,i,s,o,l=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=qr(s.length),f=qr(o.length);let m="";1===r?m="i":2===r&&(m="i, j");let y="";1===i?y="i":2===i&&(y="i, coords[1]");let T="";c&&(T="coords[0], coords[1]"),this.userCode=`\n        ${u} strides = ${u}(${s});\n\n        void main() {\n          ${f} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(getIndices(${m}));\n              flattenedIndex += index * ${e>1?"strides[j]":"strides"};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates(${y});\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(${T}), sum, float(found)));\n        }\n      `}}class Fst{constructor(t,e,r,i,s,o,l=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=qr(s.length),f=qr(o.length);let m="";1===r?m="i":2===r&&(m="i, j");let y="";1===i?y="i":2===i&&(y="i, coords[1]");let T="";c&&(T="coords[0], coords[1]"),this.userCode=`\n        ${u} strides = ${u}(${s});\n\n        void main() {\n          ${f} coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ${t}; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ${e}; j+=2) {\n              ivec4 index = round(getIndices(${m}));\n              flattenedIndex += index.xz * ${e>1?"strides[j]":"strides"};\n              if (j + 1 < ${e}) {\n                flattenedIndex += index.yw * ${e>1?"strides[j + 1]":"strides"};\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = getUpdates(${y});\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(getDefaultValue(${T}), sum, found));\n        }\n      `}}const Lst={kernelName:OZ,backendName:"webgl",kernelFunc:function Pst(n){const{inputs:t,backend:e,attrs:r}=n,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:f,outputSize:m}=n0(0,i,o),_=[m/u,u];if(0===m)return e.makeTensorInfo(o,i.dtype);const y=Lt({inputs:{x:i},backend:e,attrs:{shape:[c,l]}}),w=Lt({inputs:{x:s},backend:e,attrs:{shape:[c,u]}}),T=e.makeTensorInfo([],"float32",new Float32Array([0]));let I;I=Me().getBool("WEBGL_PACK")?new Fst(c,l,y.shape.length,w.shape.length,f,_):new B9(c,l,y.shape.length,w.shape.length,f,_);const E=e.runWebGLProgram(I,[w,y,T],w.dtype),A=Lt({inputs:{x:E},backend:e,attrs:{shape:o}});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(T),A}};class $st{constructor(t,e,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];const o=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,l=2===Me().getNumber("WEBGL_VERSION")?"while (left < right) {":o;this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${l}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${"left"===i?"<":"<="} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}const Vst={kernelName:PZ,backendName:"webgl",kernelFunc:function Bst(n){const{inputs:t,backend:e,attrs:r}=n,{sortedSequence:i,values:s}=t,{side:o}=r,l=new $st(i.shape[0],i.shape[1],s.shape[1],o);return e.runWebGLProgram(l,[i,s],"int32",[[i.shape[1]]])}};class Ust{constructor(t,e,r){let i,s;if(this.variableNames=["c","a","b"],this.outputShape=e,r>4)throw Error(`Where for rank ${r} is not yet supported`);if(1===r)s="resRC",i="resRC";else{const l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],u=[];for(let f=0;f<e.length;f++)u.push(`${l[f]}`),f<t&&c.push(`${l[f]}`);i=c.join(),s=u.join()}const o=qr(r);this.userCode=`\n      void main() {\n        ${o} resRC = getOutputCoords();\n        float cVal = getC(${i});\n        if (cVal >= 1.0) {\n          setOutput(getA(${s}));\n        } else {\n          setOutput(getB(${s}));\n        }\n      }\n    `}}const Hst={kernelName:KB,backendName:"webgl",kernelFunc:function zst(n){const{inputs:t,backend:e}=n,{condition:r,t:i,e:s}=t,o=new Ust(r.shape.length,i.shape,i.shape.length);return e.runWebGLProgram(o,[r,i,s],Dl(i.dtype,s.dtype))}},Wst=br({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${YV};\n  float scale = ${KV};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),jst={kernelName:TN,backendName:"webgl",kernelFunc:Wst},Zst=br({opSnippet:"if (isnan(x)) return x;\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:AXe}),Yst={kernelName:kN,backendName:"webgl",kernelFunc:Zst},Kst=br({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),Qst={kernelName:DN,backendName:"webgl",kernelFunc:Kst},eot=br({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n",packedOpSnippet:`\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ${y0}\n  return result;\n`}),tot={kernelName:SN,backendName:"webgl",kernelFunc:eot},not=br({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),rot={kernelName:EN,backendName:"webgl",kernelFunc:not},iot=br({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),sot={kernelName:AN,backendName:"webgl",kernelFunc:iot},oot={kernelName:JB,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockShape:s,paddings:o}=r;G(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const l=s.reduce((E,A)=>E*A),c=[[0,0]];c.push(...o);for(let E=1+s.length;E<i.shape.length;++E)c.push([0,0]);const u=[],f=oge({inputs:{x:i},backend:e,attrs:{paddings:c,constantValue:0}}),m=iR(f.shape,s,l,!1),_=sR(m.length,s.length,!1),y=oR(f.shape,s,l,!1),w=Lt({inputs:{x:f},backend:e,attrs:{shape:m}}),T=Sa({inputs:{x:w},backend:e,attrs:{perm:_}}),I=Lt({inputs:{x:T},backend:e,attrs:{shape:y}});return u.push(f),u.push(w),u.push(T),u.forEach(E=>e.disposeIntermediateTensorInfo(E)),I}},lot={kernelName:LZ,backendName:"webgl",kernelFunc:function aot(n){const{inputs:t,backend:e}=n,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(1!==s.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${s.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n         ${i.shape}`);if(0!==o.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${o.shape}`);const l=e.readSync(r.dataId),c=e.readSync(i.dataId),u=e.readSync(s.dataId),f=e.readSync(o.dataId)[0],[m,_,y,w,T]=RXe(l,r.shape,r.dtype,c,i.dtype,u,f);return[e.makeTensorInfo(_,r.dtype,m),e.makeTensorInfo([_[0]],i.dtype,y),e.makeTensorInfo([w.length],"bool",new Uint8Array(w.map(I=>Number(I)))),e.makeTensorInfo([T.length],r.dtype,new Int32Array(T))]}},uot={kernelName:$Z,backendName:"webgl",kernelFunc:function cot(n){const{inputs:t,backend:e}=n,{inputIndices:r,inputShape:i,newShape:s}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(1!==s.shape.length)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(e.readSync(i.dataId)),l=e.readSync(r.dataId),c=Array.from(e.readSync(s.dataId)),[u,f,m]=MXe(l,r.shape,r.dtype,o,c);return[e.makeTensorInfo(f,r.dtype,u),e.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}},hot={kernelName:BZ,backendName:"webgl",kernelFunc:function dot(n){const{inputs:t,backend:e}=n,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${s.shape}`);const o=e.readSync(r.dataId),l=e.readSync(i.dataId),c=e.readSync(s.dataId),[u,f]=hme(o,r.shape,r.dtype,l,c,!0);return e.makeTensorInfo(f,r.dtype,u)}},pot={kernelName:VZ,backendName:"webgl",kernelFunc:function fot(n){const{inputs:t,backend:e}=n,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${s.shape}`);const o=e.readSync(r.dataId),l=e.readSync(i.dataId),c=e.readSync(s.dataId),[u,f]=hme(o,r.shape,r.dtype,l,c);return e.makeTensorInfo(f,r.dtype,u)}},got={kernelName:UZ,backendName:"webgl",kernelFunc:function mot(n){const{inputs:t,backend:e,attrs:r}=n,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:l}=r,{sliceRank:c,numUpdates:u,sliceSize:f,strides:m,outputSize:_}=n0(0,i,l);if("string"===s.dtype){const E=e.bufferSync(i),A=e.bufferSync(s),M=i_(e.readSync(o.dataId)[0]),O=kXe(E,A,l,_,f,u,c,m,M,!1);return e.makeTensorInfo(l,O.dtype,O.values)}const w=new B9(u,c,i.shape.length,s.shape.length,m,[_,1],!1),T=e.runWebGLProgram(w,[s,i,o],s.dtype),I=Lt({inputs:{x:T},backend:e,attrs:{shape:l}});return e.disposeIntermediateTensorInfo(T),I}},yot={kernelName:eV,backendName:"webgl",kernelFunc:function _ot(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,l=Kn(o,i.shape)[0],c=eK(i,s,l),f=new Array(i.shape.length).fill(0),m=i.shape.slice();return c.map(_=>{const y=[...m];y[l]=_;const w=VT({inputs:{x:i},backend:e,attrs:{begin:f,size:y}});return f[l]+=_,w})}},lge="return sqrt(x);",vot=br({opSnippet:lge,packedOpSnippet:lge,cpuKernelImpl:OXe}),bot={kernelName:NN,backendName:"webgl",kernelFunc:vot},Cot={kernelName:zZ,backendName:"webgl",kernelFunc:br({opSnippet:"return x * x;"})},cge="return (a - b) * (a - b);",xot=Io({opSnippet:cge,packedOpSnippet:cge}),Iot={kernelName:RN,backendName:"webgl",kernelFunc:xot},Sot={kernelName:nV,backendName:"webgl",kernelFunc:function Tot(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");const o=Cp(e.readSync(i.dataId)),l=FXe(o,"string",r);return e.makeTensorInfo(i.shape,"string",l)}},kot={kernelName:LN,backendName:"webgl",kernelFunc:function Eot({inputs:n,attrs:t,backend:e}){const{x:r}=n,s=new Nh(r.shape,`if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float(${t.alpha});\n  `);return e.runWebGLProgram(s,[r],r.dtype)}};class Aot{constructor(t,e,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,s=qr(r.length),o=qr(r.length);let l="";if(1===i)l="coords * strides + begin";else{let c=0;l=r.map((u,f)=>(c++,1===r.length?`coords * strides[${f}] + begin[${f}]`:`coords[${c-1}] * strides[${f}] + begin[${f}]`)).join(",")}this.userCode=`\n      ${s} begin = ${s}(${t});\n      ${s} strides = ${s}(${e});\n\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${l}));\n      }\n    `}}const Rot={kernelName:HZ,backendName:"webgl",kernelFunc:function Not(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{begin:s,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:f,newAxisMask:m,shrinkAxisMask:_}=r,{finalShapeSparse:y,finalShape:w,isIdentity:T,sliceDim0:I,isSimpleSlice:E,begin:A,end:M,strides:O}=U8(i.shape,s,o,l,c,u,f,m,_);let $;if(T)$=Lt({inputs:{x:i},backend:e,attrs:{shape:w}});else if(I||E){G(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const Z=$8(A,M,O),Q=VT({inputs:{x:i},backend:e,attrs:{begin:A,size:Z}});$=Lt({inputs:{x:Q},backend:e,attrs:{shape:w}}),e.disposeIntermediateTensorInfo(Q)}else if(e.shouldExecuteOnCPU([i])){const Q=e.readSync(i.dataId),re=qn(i.shape,i.dtype,Q),oe=PXe(y,re,O,A);$=e.makeTensorInfo(w,i.dtype,oe.values)}else{const Q=new Aot(A,O,y);$=e.runWebGLProgram(Q,[i],i.dtype)}const V=Lt({inputs:{x:$},backend:e,attrs:{shape:w}});return e.disposeIntermediateTensorInfo($),V}},Oot={kernelName:GZ,backendName:"webgl",kernelFunc:function Mot(n){const{inputs:t,backend:e,attrs:r}=n,{separator:i,nGramWidths:s,leftPad:o,rightPad:l,padWidth:c,preserveShortSequences:u}=r,{data:f,dataSplits:m}=t,_=e.readSync(f.dataId),y=e.readSync(m.dataId),[w,T]=LXe(_,y,i,s,o,l,c,u);return[e.makeTensorInfo([w.length],"string",w),e.makeTensorInfo(m.shape,"int32",T)]}},Pot={kernelName:WZ,backendName:"webgl",kernelFunc:function Fot(n){const{inputs:t,backend:e,attrs:r}=n,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(0!==o.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const l=e.readSync(s.dataId),c=e.readSync(o.dataId)[0],[u,f,m]=$Xe(l,c,i),_=f.length;return[e.makeTensorInfo([_,2],"int32",u),e.makeTensorInfo([_],"string",f),e.makeTensorInfo([2],"int32",new Int32Array(m))]}},$ot={kernelName:jZ,backendName:"webgl",kernelFunc:function Lot(n){const{inputs:t,backend:e,attrs:r}=n,{numBuckets:i}=r,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=e.readSync(s.dataId),l=BXe(o,i);return e.makeTensorInfo(s.shape,"int32",l)}},Bot=br({opSnippet:"return tan(x);"}),Vot={kernelName:ON,backendName:"webgl",kernelFunc:Bot},Uot=br({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),zot={kernelName:FN,backendName:"webgl",kernelFunc:Uot},Got={kernelName:FZ,backendName:"webgl",kernelFunc:function Hot(n){const{inputs:t,backend:e}=n,{tensor:i,indices:s,updates:o}=t,{sliceRank:l,numUpdates:c,sliceSize:u,strides:f,outputSize:m}=n0(0,s,i.shape),_=[m/u,u];if(0===m)return e.makeTensorInfo(i.shape,s.dtype);const y=Lt({inputs:{x:s},backend:e,attrs:{shape:[c,l]}}),w=Lt({inputs:{x:o},backend:e,attrs:{shape:[c,u]}}),T=Lt({inputs:{x:i},backend:e,attrs:{shape:_}}),I=new B9(c,l,y.shape.length,w.shape.length,f,_,!1,!0),E=e.runWebGLProgram(I,[w,y,T],T.dtype),A=Lt({inputs:{x:E},backend:e,attrs:{shape:i.shape}});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(E),A}};class Wot{constructor(t,e){this.variableNames=["A"];const r=new Array(t.length);for(let o=0;o<r.length;o++)r[o]=t[o]*e[o];this.outputShape=r,this.rank=r.length;const i=qr(this.rank),s=function jot(n){const t=n.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${n[0]})`;const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<n.length;i++)r.push(`imod(${e[i]}, ${n[i]})`);return r.join()}(t);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        setOutput(getA(${s}));\n      }\n    `}}function uge(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{reps:s}=r;if("string"===i.dtype||i.shape.length>5){const c=e.readSync(i.dataId),u="string"===i.dtype?c.map(_=>i_(_)):c,f=qn(i.shape,i.dtype,u),m=UXe(f,s);return e.makeTensorInfo(m.shape,m.dtype,m.values)}const o=new Wot(i.shape,s);return e.runWebGLProgram(o,[i],i.dtype)}const qot={kernelName:PN,backendName:"webgl",kernelFunc:uge};class Zot{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class Yot{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function b0(n,t){null!==t&&n.disposeIntermediateTensorInfo(t)}function dge(n){let t=1;for(;t<n;)t*=2;return t}const Qot={kernelName:qZ,backendName:"webgl",kernelFunc:function Kot(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{k:s,sorted:o}=r,l=Me().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=Me().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=i.shape,f=u[u.length-1];if(e.shouldExecuteOnCPU([i])||f<l||s>c){const oe=e.readSync(i.dataId),[ye,Ve]=zXe(oe,u,i.dtype,s,o);return[e.makeTensorInfo(ye.shape,ye.dtype,ye.values),e.makeTensorInfo(Ve.shape,Ve.dtype,Ve.values)]}if(0===s)return u[u.length-1]=0,[e.makeTensorInfo(u,i.dtype,[]),e.makeTensorInfo(u,"int32",[])];if(1===f)return[i,RR({attrs:{shape:u,dtype:"int32",value:0},backend:e})];const m=e.texData.get(i.dataId),_=null!==m&&m.isPacked,y=_?e.unpackTensor(i):i,T=Ye(u)/f,I=Lt({inputs:{x:y},attrs:{shape:[T,f]},backend:e});_&&b0(e,y);const E=dge(s),A=dge(f);let M=null;const O=()=>null===M?[I,I]:[I,M],$=(oe,ye,Ve)=>{const We=O(),Ke=new Zot(Ve),we=M;M=e.runWebGLProgram(Ke,We,"int32",[[f],[null===M?1:0],[Number.NEGATIVE_INFINITY],[oe],[ye]]),b0(e,we)};for(let oe=1;oe<E;oe*=2){const ye=2*oe;for(let Ve=oe;Ve>=1;Ve/=2)$(ye,Ve,[T,A])}for(let oe=A;oe>E;oe/=2){const ye=O(),Ve=new Yot([T,oe/2]),Qe=M;M=e.runWebGLProgram(Ve,ye,"int32",[[f],[null===M?1:0],[E]]),b0(e,Qe);const ge=E/2,we=2*ge;for(let _e=ge;_e>=1;_e/=2)$(we,_e,M.shape)}let V=M;M=VT({inputs:{x:M},backend:e,attrs:{begin:0,size:[T,s]}}),b0(e,V);let Z=Jme({inputs:{x:I,indices:M},backend:e,attrs:{axis:1,batchDims:1}});b0(e,I);const Q=u.slice(0,-1);Q.push(s),V=M,M=Lt({inputs:{x:M},attrs:{shape:Q},backend:e}),b0(e,V);const re=Z;return Z=Lt({inputs:{x:Z},attrs:{shape:Q},backend:e}),b0(e,re),[Z,M]}};class Xot{constructor(t,e,r,i,s,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const l="nearest"===r?1:2;let c;switch(i){case"constant":default:c=1;break;case"reflect":c=2;break;case"wrap":c=3;break;case"nearest":c=4}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${c} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${c} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${c} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${e}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${s});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${s});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${e}));\n                float mapY = mapCoord(inY, float(${t}));\n\n                if (${l} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}const eat={kernelName:ZZ,backendName:"webgl",kernelFunc:function Jot(n){const{inputs:t,backend:e,attrs:r}=n,{image:i,transforms:s}=t,{interpolation:o,fillMode:l,fillValue:c,outputShape:u}=r,[f,m,_,y]=i.shape,[w,T]=u??[m,_],E=new Xot(m,_,o,l,c,[f,w,T,y]);return e.runWebGLProgram(E,[i,s],"float32")}},nat={kernelName:YZ,backendName:"webgl",kernelFunc:function tat(n){const{inputs:t,attrs:e,backend:r}=n,{axis:i}=e,{x:s}=t;SR(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(s.dataId),{outputValues:l,outputShape:c,indices:u}=HXe(o,i,s.shape,s.dtype);return[r.makeTensorInfo(c,s.dtype,l),r.makeTensorInfo([u.length],"int32",u)]}},iat={kernelName:rV,backendName:"webgl",kernelFunc:function rat(n){const{inputs:t,backend:e,attrs:r}=n,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i,l=o.shape.length,c=i.shape[s],u=new Array(l-1);let f=0;for(let T=0;T<l;T++)T!==s&&(u[f++]=o.shape[T]);const m=[],_=new Array(l).fill(0),y=o.shape.slice();y[s]=1;const w=new Array(c);for(let T=0;T<w.length;T++){_[s]=T;const I=VT({inputs:{x:o},backend:e,attrs:{begin:_,size:y}}),E=Lt({inputs:{x:I},backend:e,attrs:{shape:u}});w[T]=E,m.push(I)}return m.forEach(T=>e.disposeIntermediateTensorInfo(T)),w}};class sat{constructor(t,e){this.variableNames=["x","segmentIds"];const r=t.windowSize,i=t.batchSize,s=t.inSize,o=t.numSegments,l=o*Math.ceil(s/r);this.outputShape=[i,l];const f=4*Math.floor(r/4),m=r%4,_="\n        sumValue += dot(values, segFilter);\n    ";let y="";s%r>0&&(y=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return initializationValue;\n        }\n      `);let w="";s%r>0&&(w=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${y}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${w}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${o})) * float(${r}));\n        int currentSeg = int(mod(float(outIdx), float(${o})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${f}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${_}\n        }\n\n        int inIdx = inOffset + ${f};\n        if (${1===m}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${_}\n        } else if (${2===m}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${_}\n        } else if (${3===m}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${_}\n        }\n        setOutput(sumValue);\n      }\n    `}}const aat={kernelName:iV,backendName:"webgl",kernelFunc:function oat(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,segmentIds:s}=t,{numSegments:o}=r,l=i.shape.length,c=[];let u=0;const f=Pi([u],l);let m=i;null!=f&&(m=Sa({inputs:{x:i},backend:e,attrs:{perm:f}}),c.push(m),u=is(1,l)[0]);const _=Sde(m.shape,u,o),y=Ye([m.shape[u]]),w=Lt({inputs:{x:m},backend:e,attrs:{shape:[-1,y]}});c.push(w);const T=r8(i.dtype),I=(O,$,V,Z,Q)=>{const re=O.shape[0],oe=O.shape[1],ye=Tde(oe,Q),We=new sat({windowSize:ye,inSize:oe,batchSize:re,numSegments:Q},$),Ke=e.compileAndRun(We,[O,V],Z);if(c.push(Ke),Ke.shape[1]===Q)return Ke;const Qe=age({backend:e,attrs:{start:0,stop:Q,step:1,dtype:"float32"}}),ge=uge({inputs:{x:Qe},backend:e,attrs:{reps:[oe/ye]}});return c.push(Qe),c.push(ge),I(Ke,$,ge,Z,Q)},A=Lt({inputs:{x:I(w,"unsortedSegmentSum",s,T,o)},backend:e,attrs:{shape:_}});let M=A;if(null!=f){c.push(A);const O=p_(f);M=Sa({inputs:{x:M},backend:e,attrs:{perm:O}})}return c.forEach(O=>e.disposeIntermediateTensorInfo(O)),M}},lat=[LJe,BJe,zJe,WJe,qJe,KJe,XJe,eet,iet,oet,uet,fet,get,bet,xet,Tet,Det,Ret,Oet,Pet,Bet,Wet,qet,Qet,Jet,itt,ott,utt,bJe,ftt,ytt,Ctt,Dtt,Ntt,Mtt,Ftt,Ltt,Utt,Htt,Wtt,qtt,Ytt,Qtt,ent,nnt,ont,lnt,dnt,pnt,gnt,ynt,wnt,xnt,Snt,Dnt,knt,Nnt,Mnt,Fnt,Lnt,Bnt,Unt,Gnt,qnt,Ynt,Xnt,trt,rrt,srt,vJe,art,gtt,crt,drt,frt,CJe,mrt,_rt,vrt,Crt,Trt,Ert,krt,Nrt,Ort,Prt,$rt,zrt,Grt,jrt,Krt,Xrt,eit,nit,iit,lit,dit,mit,wit,TJe,Tit,Dit,Nit,Oit,ett,Pit,$it,Vit,Hit,qit,IJe,Yit,Qit,Jit,tst,nst,ttt,_it,ist,ast,ust,EJe,pst,_st,wst,Ist,Dst,Ast,Rst,Ost,Lst,Vst,Hst,jst,Yst,Qst,tot,rot,Get,vit,sot,oot,lot,uot,hot,pot,got,yot,bot,Cot,Iot,Sot,kot,Rot,Oot,Pot,$ot,yit,OJe,Vot,zot,Got,qot,Qot,eat,FJe,nat,iat,aat,Lit];for(const n of lat)JZ(n);let hge=(()=>{class n{constructor(){this.realResults=[{name:"Actinic keratosis and intraepithelial carcinoma / Bowen's disease",shortName:"akiec",value:0,description:"Actinic Keratoses (AKs), also known as Solar Keratoses, are precancerous skin lesions that typically develop on areas of the skin that have been exposed to the sun over time. If left untreated, some AKs may progress to intraepithelial Carcinoma, also known as Bowen's disease.",needsConsult:!0},{name:"Basal cell carcinoma",shortName:"bcc",value:0,description:"Basal cell carcinoma (BCC) is the most common type of skin cancer, accounting for about 80% of all skin cancer cases. It typically develops in areas of the skin that have been exposed to the sun, such as the face, neck, ears, scalp, shoulders, and back. BCC arises from the basal cells, which are found in the deepest layer of the epidermis, the outermost layer of the skin.",needsConsult:!0},{name:"Benign keratosis-like lesion",shortName:"bkl",value:0,description:"Benign keratosis-like lesions, also known as seborrheic keratoses, are common non-cancerous growths that appear on the skin, especially in older adults. They are usually painless and do not pose any health risks.",needsConsult:!1},{name:"Dermatofibroma",shortName:"df",value:0,description:"Dermatofibroma is a common benign skin lesion, often referred to as a fibrous histiocytoma. They are usually harmless and don't require treatment unless they become symptomatic or cosmetically bothersome.",needsConsult:!1},{name:"Melanoma",shortName:"mel",value:0,description:"Melanoma is a type of skin cancer that originates in melanocytes, the cells responsible for producing melanin, the pigment that gives skin its color. Melanoma is a potentially serious form of skin cancer that requires prompt diagnosis and treatment for the best outcome.",needsConsult:!0},{name:"Melanocytic nevus",shortName:"nv",value:0,description:"Melanocytic nevi, commonly known as moles, are benign growths on the skin that develop when melanocytes (pigment-producing cells) grow in clusters. Although most moles are benign, it's essential to monitor them for any changes that could indicate skin cancer, such as melanoma.",needsConsult:!1},{name:"Vascular lesion",shortName:"vasc",value:0,description:"Vascular lesions are abnormalities in the blood vessels that can occur anywhere in the body. These lesions can vary in size, shape, and severity, and they may present as visible abnormalities on the skin or within deeper tissues.",needsConsult:!0}],this.modelLoadingStatusSubject=new Zo(!1),this.modelLoadedStatus$=this.modelLoadingStatusSubject.asObservable(),this.predictionStatusSubject=new Zo(!1),this.predictionStatus$=this.predictionStatusSubject.asObservable(),this.isProcessingSubject=new Zo(!1),this.isProcessing$=this.isProcessingSubject.asObservable(),function kLe(n){ce.setBackend(n)}("webgl")}loadModel(){var e=this;return(0,q.Z)(function*(){e.model=yield function lqe(n){return s9.apply(this,arguments)}("/assets/resnet50/model.json"),e.modelLoadingStatusSubject.next(!0),e.predictionStatusSubject.next(!1)})()}predict(e){this.isProcessingSubject.next(!0),this.predictionStatusSubject.next(!1),setTimeout(()=>{Ie(()=>{console.log("start of predict"),console.time("totalTimer"),console.time("startTimer");let i=W$e(e);i=sd.resizeBilinear(i,[224,224]),i=Pt(i,"float32"),console.timeEnd("startTimer"),console.log("after resize & cast"),console.time("timer");const s=iu([103.939,116.779,123.68]);i=i.sub(s),i=mc(i,2),i=i.expandDims(),console.timeEnd("timer"),console.log("after preprocessing"),console.time("timer");const o=this.model.predict(i);console.timeEnd("timer"),console.log("after predict"),console.time("timer"),this.predictions=Array.from(o.dataSync()),console.timeEnd("timer"),console.timeEnd("totalTimer"),console.log("end")});for(let i=0;i<this.realResults.length;i++)console.log(this.realResults[i].name),this.realResults[i].value=this.predictions[i];this.predictionStatusSubject.next(!0),this.isProcessingSubject.next(!1)},100)}predictFromImageUrl(e){this.isProcessingSubject.next(!0),this.predictionStatusSubject.next(!1);const r=new Image;r.onload=()=>{this.predict(r)},r.onerror=()=>{console.error("Failed to load image from URL:",e)},r.src=e,r.crossOrigin="Anonymous"}resetPredictionStatus(){this.predictionStatusSubject.next(!1)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function uat(n,t){if(1&n&&(a.TgZ(0,"div",1)(1,"div",15)(2,"span"),a._uU(3),a.TgZ(4,"strong"),a._uU(5),a.ALo(6,"number"),a.qZA()()()()),2&n){const e=t.$implicit;a.xp6(3),a.AsE(" ",e.name," (",e.shortName,"): "),a.xp6(2),a.hij("",a.xi3(6,3,100*e.value,"1.0-2"),"%")}}function dat(n,t){if(1&n&&(a.ynx(0),a._UZ(1,"mat-divider",10),a.TgZ(2,"div",1)(3,"div",11)(4,"div",1)(5,"h4"),a._uU(6,"Predictions:"),a.qZA()(),a.YNc(7,uat,7,6,"div",12),a.qZA()(),a.TgZ(8,"div",13)(9,"p",14)(10,"strong"),a._uU(11,"These predictions should not be used for a diagnosis!"),a.qZA(),a._uU(12," The model that powers this web page is not 100% accurate. It may produce "),a.TgZ(13,"strong"),a._uU(14,"false"),a.qZA(),a._uU(15," results with a "),a.TgZ(16,"strong"),a._uU(17,"high"),a.qZA(),a._uU(18," confidence. This model should only be used for informational purposes. Always use your own professional judgement when diagnosing a patient. "),a.qZA()(),a.BQk()),2&n){const e=a.oxw(2);a.xp6(7),a.Q6J("ngForOf",e.getTopResults())}}function hat(n,t){if(1&n&&(a.ynx(0),a._UZ(1,"mat-divider",2),a.TgZ(2,"div",1)(3,"h5"),a._uU(4,"Uploaded Image:"),a.qZA()(),a.TgZ(5,"div",1),a._UZ(6,"img",9),a.qZA(),a.YNc(7,dat,19,1,"ng-container",7),a.BQk()),2&n){const e=a.oxw();a.xp6(6),a.Q6J("src",e.data.appointment.imgUrl,a.LSH),a.xp6(1),a.Q6J("ngIf",e.predictionMade)}}function fat(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",16)(1,"button",17),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onGetAnalysisClick())}),a._uU(2,"Get AI analysis"),a.qZA()()}}function pat(n,t){1&n&&(a.ynx(0),a.TgZ(1,"div",18),a._UZ(2,"mat-progress-bar",19),a.qZA(),a.BQk())}function mat(n,t){if(1&n&&(a.ynx(0),a.YNc(1,pat,3,0,"ng-container",7),a.BQk()),2&n){const e=a.oxw();a.xp6(1),a.Q6J("ngIf",(!e.modelLoaded||e.isProcessing)&&!e.predictionMade)}}let gat=(()=>{class n{constructor(e,r,i){this.data=e,this.datePipe=r,this.lesionClassificationService=i,this.mockAnalysisClicked=!1,this.predictionStatusSubscription=new kn.w0,this.predictionMade=!1,this.modelLoaded=!1,this.isProcessingSubscription=new kn.w0,this.isProcessing=!1,this.buttonClicked=!1,this.modelLoadedStatusSubscription=new kn.w0}ngOnInit(){this.predictionStatusSubscription=this.lesionClassificationService.predictionStatus$.subscribe(e=>{this.predictionMade=e}),this.isProcessingSubscription=this.lesionClassificationService.isProcessing$.subscribe(e=>{this.isProcessing=e,console.log(e)}),this.modelLoadedStatusSubscription=this.lesionClassificationService.modelLoadedStatus$.subscribe(e=>{this.modelLoaded=e})}ngOnDestroy(){this.predictionStatusSubscription.unsubscribe(),this.isProcessingSubscription.unsubscribe(),this.modelLoadedStatusSubscription.unsubscribe(),this.lesionClassificationService.resetPredictionStatus()}getAppointmentTimesAsString(e){const r=new Date(e);return r.setMinutes(r.getMinutes()+this.data.appointmentDuration),`${this.datePipe.transform(e,"HH:mm")} - ${this.datePipe.transform(r,"HH:mm")}`}getTopResults(){return[...this.lesionClassificationService.realResults].sort((r,i)=>i.value-r.value).slice(0,3)}onGetAnalysisClick(){this.buttonClicked=!0,this.modelLoaded?this.data.appointment.imgUrl&&(this.lesionClassificationService.predictFromImageUrl(this.data.appointment.imgUrl),this.modelLoaded=!0):this.lesionClassificationService.loadModel().then(()=>{this.data.appointment.imgUrl&&(this.lesionClassificationService.predictFromImageUrl(this.data.appointment.imgUrl),this.modelLoaded=!0)})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(Rq),a.Y36(ra),a.Y36(hge))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-schedule-details"]],decls:52,vars:14,consts:[["mat-dialog-content","",1,"container"],[1,"row"],[1,"mt-2","mb-2"],[1,"detail-row"],[1,"m-0"],[1,"mt-2","mb-sm-2"],[2,"margin","0"],[4,"ngIf"],["mat-dialog-actions","",4,"ngIf"],["alt","Appointment Image",3,"src"],[1,"mt-3","mb-3"],[1,"results-div","p-4","ps-5","col-10","offset-1"],["class","row",4,"ngFor","ngForOf"],[1,"row","mt-3"],[1,"disclaimer-content"],[1,"d-flex","gap-2","fs-5","align-items-center"],["mat-dialog-actions",""],["mat-raised-button","","color","accent",3,"click"],[1,"row","m-5"],["mode","indeterminate",2,"margin","auto"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0)(1,"div",1)(2,"h2"),a._uU(3,"Appointment Details"),a.qZA()(),a.TgZ(4,"div",1)(5,"h6"),a._uU(6),a.ALo(7,"date"),a.qZA()(),a._UZ(8,"mat-divider",2),a.TgZ(9,"div",1)(10,"h5"),a._uU(11,"Patient Info"),a.qZA()(),a.TgZ(12,"div",1)(13,"div",3)(14,"h6",4),a._uU(15,"Name:"),a.qZA(),a.TgZ(16,"span"),a._uU(17),a.qZA()()(),a.TgZ(18,"div",1)(19,"div",3)(20,"h6",4),a._uU(21,"Age:"),a.qZA(),a.TgZ(22,"span"),a._uU(23),a.qZA()()(),a.TgZ(24,"div",1)(25,"div",3)(26,"h6",4),a._uU(27,"Sex:"),a.qZA(),a.TgZ(28,"span"),a._uU(29),a.qZA()()(),a.TgZ(30,"div",1)(31,"div",3)(32,"h6",4),a._uU(33,"Email:"),a.qZA(),a.TgZ(34,"span"),a._uU(35),a.qZA()()(),a.TgZ(36,"div",1)(37,"div",3)(38,"h6",4),a._uU(39,"Phone number:"),a.qZA(),a.TgZ(40,"span"),a._uU(41),a.qZA()()(),a._UZ(42,"mat-divider",5),a.TgZ(43,"div",1)(44,"h5"),a._uU(45,"Reason for appointment"),a.qZA()(),a.TgZ(46,"div",1)(47,"p",6),a._uU(48),a.qZA()(),a.YNc(49,hat,8,2,"ng-container",7),a.YNc(50,fat,3,0,"div",8),a.YNc(51,mat,2,1,"ng-container",7),a.qZA()),2&e&&(a.xp6(6),a.AsE("",a.lcZ(7,12,r.data.appointment.datetime),": ",r.getAppointmentTimesAsString(r.data.appointment.datetime),""),a.xp6(11),a.AsE("",r.data.appointment.lastName," ",r.data.appointment.firstName,""),a.xp6(6),a.Oqu(r.data.appointment.age),a.xp6(6),a.Oqu(r.data.appointment.sex),a.xp6(6),a.Oqu(r.data.appointment.email),a.xp6(6),a.hij("+40",r.data.appointment.telephone,""),a.xp6(7),a.Oqu(r.data.appointment.comment?r.data.appointment.comment:"No reason given"),a.xp6(1),a.Q6J("ngIf",r.data.appointment.imgUrl),a.xp6(1),a.Q6J("ngIf",r.data.appointment.imgUrl&&!r.predictionMade&&!r.isProcessing&&!r.buttonClicked),a.xp6(1),a.Q6J("ngIf",r.buttonClicked))},dependencies:[Na,Ur,js,f1e,p1e,Kg,w$,Wl,ra],styles:[".detail-row[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.results-div[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff;border-radius:24px}.disclaimer-content[_ngcontent-%COMP%]{color:gray;font-style:italic;font-size:14px;margin:0}"]}),n})();function _at(n,t){1&n&&(a.TgZ(0,"div",2),a._UZ(1,"mat-progress-bar",3),a.qZA())}function yat(n,t){1&n&&(a.TgZ(0,"th",11),a._uU(1,"Hour"),a.qZA())}function vat(n,t){if(1&n&&(a.TgZ(0,"td",12),a._uU(1),a.qZA()),2&n){const e=t.$implicit;a.xp6(1),a.hij("",e.hour,":00")}}const bat=function(n){return{active:n}};function wat(n,t){if(1&n&&(a.TgZ(0,"th",15),a._uU(1),a.qZA()),2&n){const e=a.oxw().$implicit,r=a.oxw(2);a.Q6J("ngClass",a.VKq(2,bat,r.isCurrentDay(e))),a.xp6(1),a.Oqu(e)}}function Cat(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",19),a.NdJ("click",function(){a.CHM(e);const i=a.oxw().$implicit,s=a.oxw(4);return a.KtG(s.onAppointmentClick(i))}),a.TgZ(1,"span",20),a._uU(2),a.qZA(),a.TgZ(3,"span")(4,"strong"),a._uU(5),a.qZA()(),a.TgZ(6,"span")(7,"strong"),a._uU(8,"Age:"),a.qZA(),a._uU(9),a.qZA(),a.TgZ(10,"span")(11,"strong"),a._uU(12,"Sex:"),a.qZA(),a._uU(13),a.qZA()()}if(2&n){const e=a.oxw(),r=e.index,i=e.$implicit,s=a.oxw(4);a.Udp("background-color",s.getBgColor(r+i.datetime.getDay())),a.Q6J("matTooltip",s.getTooltipText(i)),a.xp6(2),a.Oqu(s.getAppointmentTimeDisplay(i)),a.xp6(3),a.AsE("",i.lastName," ",i.firstName,""),a.xp6(4),a.hij(" ",i.age,""),a.xp6(4),a.hij(" ",i.sex,"")}}function xat(n,t){1&n&&a._UZ(0,"div",21)}function Iat(n,t){if(1&n&&(a.ynx(0),a.YNc(1,Cat,14,8,"div",17),a.YNc(2,xat,1,0,"div",18),a.BQk()),2&n){const e=t.$implicit,r=a.oxw(4);a.xp6(1),a.Q6J("ngIf",r.isAppointment(e)),a.xp6(1),a.Q6J("ngIf",!r.isAppointment(e))}}function Tat(n,t){if(1&n&&(a.TgZ(0,"td",12),a.YNc(1,Iat,3,2,"ng-container",16),a.qZA()),2&n){const e=t.$implicit,r=a.oxw().$implicit,i=a.oxw(2);a.xp6(1),a.Q6J("ngForOf",e[i.getShortDay(r)])}}function Sat(n,t){1&n&&(a.ynx(0,13),a.YNc(1,wat,2,4,"th",14),a.YNc(2,Tat,2,1,"td",7),a.BQk()),2&n&&a.Q6J("matColumnDef",t.$implicit)}function Eat(n,t){1&n&&a._UZ(0,"tr",22)}function Dat(n,t){1&n&&a._UZ(0,"tr",23)}const fge=function(){return["hour"]};function kat(n,t){if(1&n&&(a.TgZ(0,"table",4),a.ynx(1,5),a.YNc(2,yat,2,0,"th",6),a.YNc(3,vat,2,1,"td",7),a.BQk(),a.YNc(4,Sat,3,1,"ng-container",8),a.YNc(5,Eat,1,0,"tr",9),a.YNc(6,Dat,1,0,"tr",10),a.qZA()),2&n){const e=a.oxw();a.Q6J("dataSource",e.appointmentTableData),a.xp6(1),a.Q6J("sticky",!0),a.xp6(3),a.Q6J("ngForOf",e.displayedWeekColumns),a.xp6(1),a.Q6J("matHeaderRowDef",a.DdM(6,fge).concat(e.displayedWeekColumns))("matHeaderRowDefSticky",!0),a.xp6(1),a.Q6J("matRowDefColumns",a.DdM(7,fge).concat(e.displayedWeekColumns))}}let Aat=(()=>{class n{constructor(e,r,i,s,o){this.appointmentService=e,this.authService=r,this.medicService=i,this.datePipe=s,this.dialog=o,this.week=[],this.displayedWeekColumns=[],this.hoursArray=[],this.minutesArray=[],this.appointmentTableData=[],this.dataLoaded=!1,this.startHour=8,this.endHour=16,this.appointmentDuration=20,this.backgroundColors=["var(--primary)","var(--pastel)","var(--accent)"],this.subscription=new kn.w0}ngOnChanges(e){(e.startDate||e.endDate)&&(this.dataLoaded=!1,this.initWeek(),this.startDate&&this.endDate&&this.subscription.add(this.getAppointmentsForWeek(this.startDate,this.endDate).subscribe(r=>{this.createTableData(r),this.dataLoaded=!0})))}ngOnInit(){this.setUpHoursAndMinutesArray()}ngOnDestroy(){this.subscription.unsubscribe()}initWeek(){this.startDate&&this.createWeek(this.startDate)}createWeek(e){this.week=[],this.displayedWeekColumns=[];for(let r=0;r<5;r++){const i=new Date(e);i.setDate(e.getDate()+r),this.week.push(i)}this.displayedWeekColumns=this.formatDates(this.week)}formatDates(e){return e.map(r=>this.datePipe.transform(r,"EEE, d")||"")}setUpHoursAndMinutesArray(){this.hoursArray=[];for(let e=this.startHour;e<this.endHour;e++)this.hoursArray.push(e);this.minutesArray=[];for(let e=0;e<60;e+=this.appointmentDuration)this.minutesArray.push(e)}getAppointmentsForWeek(e,r){return this.authService.user.pipe(wn(i=>i?.id?this.medicService.getMedicByUserId(i?.id).pipe(ts(s=>(console.error("Error fetching medic:",s),Ga.E))):Ga.E),wn(i=>i?.id&&this.startDate&&this.endDate?this.appointmentService.getMedicWeekAppointments(i.id,e,r).pipe(ts(s=>(console.error("Error fetching medic week appointments:",s),Ga.E))):Ga.E))}createTableData(e){this.resetTableDate();for(let r of this.week){const i=r.toString().slice(0,3).toLowerCase();for(let s of this.hoursArray){const o=this.appointmentTableData[s-8][i],l=60/this.appointmentDuration;if(Array.isArray(o)&&l===o.length)break;for(let c=0;c<60;c+=this.appointmentDuration){let u=!1;for(let f of e)if(Array.isArray(o)&&this.doesAppointmentMatch(f,r,s,c)){o.push(f),u=!0;break}if(Array.isArray(o)&&!u){const f=new Date;f.setHours(s),f.setMinutes(c),o.push(f)}}}}}doesAppointmentMatch(e,r,i,s){return e.datetime.getDay()===r.getDay()&&e.datetime.getHours()===i&&e.datetime.getMinutes()===s}resetTableDate(){this.appointmentTableData=[];for(let e of this.hoursArray)this.appointmentTableData.push({hour:e,mon:[],tue:[],wed:[],thu:[],fri:[]})}getShortDay(e){return e.slice(0,3).toLowerCase()}isAppointment(e){return!(e instanceof Date)}getAppointmentTimeDisplay(e){const r=new Date(e.datetime);return r.setMinutes(r.getMinutes()+this.appointmentDuration),`${this.datePipe.transform(e.datetime,"HH:mm")} - ${this.datePipe.transform(r,"HH:mm")}`}getBgColor(e){return this.backgroundColors[e%this.backgroundColors.length]}getTooltipText(e){return`Name: ${e.lastName} ${e.firstName}, \n    Age: ${e.age}, \n    Sex: ${e.sex}, \n    Reason: ${this.getReasonTrimmed(e.comment)}`}getReasonTrimmed(e){return e?e.length<100?e:e.substring(0,100).concat("..."):"-"}onAppointmentClick(e){this.dialog.open(gat,{data:{appointment:e,appointmentDuration:this.appointmentDuration},width:"800px"})}isCurrentDay(e){if(this.startDate){const r=+e.slice(-2),i=new Date(this.startDate);r<i.getDate()&&i.setMonth(i.getMonth()+1),i.setDate(r);const s=new Date;return i.toDateString()===s.toDateString()}return!1}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(tB),a.Y36(tu),a.Y36(U1),a.Y36(ra),a.Y36(Mq))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-schedule-table"]],inputs:{startDate:"startDate",endDate:"endDate"},features:[a.TTD],decls:2,vars:2,consts:[["class","mt-3",4,"ngIf"],["mat-table","","class","mat-elevation-z8",3,"dataSource",4,"ngIf"],[1,"mt-3"],["mode","query"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","hour",3,"sticky"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"matColumnDef"],["mat-header-cell","",3,"ngClass",4,"matHeaderCellDef"],["mat-header-cell","",3,"ngClass"],[4,"ngFor","ngForOf"],["class","filled-appointment","matTooltipShowDelay","400","matTooltipClass","appointment-tooltip","matTooltipPosition","right",3,"background-color","matTooltip","click",4,"ngIf"],["class","empty-appointment",4,"ngIf"],["matTooltipShowDelay","400","matTooltipClass","appointment-tooltip","matTooltipPosition","right",1,"filled-appointment",3,"matTooltip","click"],[1,"time-span"],[1,"empty-appointment"],["mat-header-row",""],["mat-row",""]],template:function(e,r){1&e&&(a.YNc(0,_at,2,0,"div",0),a.YNc(1,kat,7,8,"table",1)),2&e&&(a.Q6J("ngIf",!r.dataLoaded),a.xp6(1),a.Q6J("ngIf",r.dataLoaded))},dependencies:[Aa,Na,Ur,w$,Koe,n5,Qoe,r5,t5,Xoe,s5,o5,Joe,eae,S1],styles:["table[_ngcontent-%COMP%]{overflow:scroll;white-space:nowrap;width:100%;table-layout:fixed}.mat-column-hour[_ngcontent-%COMP%]{border-right:1px solid lightgray;text-align:center;padding-right:24px}.mat-header-cell[_ngcontent-%COMP%]{text-align:center;font-weight:700}.mat-cell[_ngcontent-%COMP%]:not(:first-child), .mat-header-cell[_ngcontent-%COMP%]:not(:first-child){width:18%}.mat-cell[_ngcontent-%COMP%]:first-child, .mat-header-cell[_ngcontent-%COMP%]:first-child{width:10%}.mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{box-sizing:border-box}.mat-cell[_ngcontent-%COMP%]{border:1px solid #ccc}.mat-table-sticky[_ngcontent-%COMP%]{background:#f0f0f0;opacity:1}.filled-appointment[_ngcontent-%COMP%]{color:#fff;height:100px;cursor:pointer;border:1px solid #ccc;padding:.3rem;box-sizing:border-box;overflow:hidden;display:flex;flex-direction:column}.empty-appointment[_ngcontent-%COMP%]{height:100px;background-color:#fff;border:1px solid #ccc}th.mat-header-cell[_ngcontent-%COMP%]:last-of-type, td.mat-cell[_ngcontent-%COMP%]:last-of-type, td.mat-footer-cell[_ngcontent-%COMP%]:last-of-type{padding-right:0}th.mat-header-cell[_ngcontent-%COMP%]:last-of-type{border-right:1px solid #ccc}.time-span[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600}.active[_ngcontent-%COMP%]{color:var(--primary)}"]}),n})();function Nat(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",2)(1,"div",3)(2,"h1"),a._uU(3,"Please set up your medic page before checking your schedule!"),a.qZA(),a.TgZ(4,"h4"),a._uU(5,"You can do this from your profile."),a.qZA()(),a.TgZ(6,"div",4)(7,"div",5)(8,"button",6),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onProfileButtonClick())}),a._uU(9," Click here to go to your profile "),a.qZA()()()()}}function Rat(n,t){1&n&&(a.TgZ(0,"mat-icon"),a._uU(1,"expand_more"),a.qZA())}function Mat(n,t){1&n&&(a.TgZ(0,"mat-icon"),a._uU(1,"expand_less"),a.qZA())}function Oat(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",7)(1,"div",8)(2,"div",9)(3,"button",10),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onPrevClick())}),a.TgZ(4,"mat-icon"),a._uU(5,"chevron_left"),a.qZA()(),a.TgZ(6,"button",10),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onNextClick())}),a.TgZ(7,"mat-icon"),a._uU(8,"chevron_right"),a.qZA()(),a.TgZ(9,"input",11),a.NdJ("dateChange",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onDateChange(i))}),a.qZA(),a._UZ(10,"mat-datepicker",12,13),a.TgZ(12,"button",14),a.NdJ("click",function(){a.CHM(e);const i=a.MAs(11);return a.KtG(i.open())}),a._uU(13),a.ALo(14,"date"),a.ALo(15,"date"),a.YNc(16,Rat,2,0,"mat-icon",15),a.YNc(17,Mat,2,0,"mat-icon",15),a.qZA()(),a.TgZ(18,"div",16)(19,"button",17),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onTodayClick())}),a._uU(20," Today "),a.qZA()()(),a.TgZ(21,"div",18),a._UZ(22,"app-schedule-table",19),a.qZA()()}if(2&n){const e=a.MAs(11),r=a.oxw();a.xp6(9),a.Q6J("matDatepicker",e)("matDatepickerFilter",r.weekendFilter),a.xp6(4),a.AsE(" ",a.lcZ(14,9,r.selectedStartOfWeek)," - ",a.lcZ(15,11,r.selectedEndOfWeek)," "),a.xp6(3),a.Q6J("ngIf",!e.opened),a.xp6(1),a.Q6J("ngIf",e.opened),a.xp6(2),a.Q6J("disabled",r.isCurrentWeekSelected()),a.xp6(3),a.Q6J("startDate",r.selectedStartOfWeek)("endDate",r.selectedEndOfWeek)}}let Fat=(()=>{class n{constructor(e,r,i){this.authService=e,this.medicService=r,this.router=i,this.selectedDate=new Date,this.selectedStartOfWeek=new Date,this.selectedEndOfWeek=new Date,this.week=[],this.medicPageExists=!1,this.isLoadingMedicInfo=!1,this.weekendFilter=s=>{const o=(s||new Date).getDay();return 0!==o&&6!==o}}ngOnInit(){this.isLoadingMedicInfo=!0,this.authService.user.pipe(wn(e=>e?(this.userId=e.id,this.medicService.getMedicByUserId(e.id)):(this.medicPageExists=!1,this.isLoadingMedicInfo=!1,Ga.E))).subscribe(e=>{e?(this.selectedDate.setHours(0,0,0,0),this.handleWeekStartAndEnd(),this.medicPageExists=!0):this.medicPageExists=!1,this.isLoadingMedicInfo=!1})}getStartOfWeek(e){const r=e.getDay(),i=new Date(e);return i.setDate(i.getDate()-r+1),i.setHours(0,0,0,0),i}getEndOfWeek(e){const r=e.getDay(),i=new Date(e);return i.setDate(e.getDate()+(5-r)),i.setHours(23,59,59,999),i}onDateChange(e){const r=e.value;r&&(this.selectedDate=r,this.handleWeekStartAndEnd())}onPrevClick(){this.selectedDate.setDate(this.selectedDate.getDate()-7),this.handleWeekStartAndEnd()}onNextClick(){this.selectedDate.setDate(this.selectedDate.getDate()+7),this.handleWeekStartAndEnd()}onTodayClick(){this.selectedDate=new Date,this.selectedDate.setHours(0,0,0,0),this.handleWeekStartAndEnd()}handleWeekStartAndEnd(){this.selectedStartOfWeek=this.getStartOfWeek(this.selectedDate),this.selectedEndOfWeek=this.getEndOfWeek(this.selectedDate)}isCurrentWeekSelected(){const e=new Date,r=new Date(this.selectedStartOfWeek);return r.setDate(this.selectedStartOfWeek.getDate()+7),e.getTime()>this.selectedStartOfWeek.getTime()&&e.getTime()<r.getTime()}onProfileButtonClick(){this.router.navigate(["/profile",this.userId])}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(tu),a.Y36(U1),a.Y36(jr))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-schedule"]],decls:2,vars:2,consts:[["class","container mt-5",4,"ngIf"],["class","container pt-5 pb-5",4,"ngIf"],[1,"container","mt-5"],[1,"row","text-center"],[1,"row","mt-4"],[1,"text-center"],["mat-raised-button","","color","primary",3,"click"],[1,"container","pt-5","pb-5"],[1,"row"],[1,"col"],["mat-icon-button","","color","primary",3,"click"],["disabled","",1,"position-absolute","opacity-0",2,"height","36px",3,"matDatepicker","matDatepickerFilter","dateChange"],["disabled","false"],["picker",""],["mat-button","","color","primary",3,"click"],[4,"ngIf"],[1,"col","d-flex","justify-content-end"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"table-div"],[3,"startDate","endDate"]],template:function(e,r){1&e&&(a.YNc(0,Nat,10,0,"div",0),a.YNc(1,Oat,23,13,"div",1)),2&e&&(a.Q6J("ngIf",!r.medicPageExists&&!r.isLoadingMedicInfo),a.xp6(1),a.Q6J("ngIf",r.medicPageExists))},dependencies:[Ur,js,kq,g1,td,Aat,ra],styles:[".table-div[_ngcontent-%COMP%]{height:60vh;overflow-y:scroll;border:1px solid #ccc;margin-top:1rem}"]}),n})(),Pat=(()=>{class n{constructor(e,r,i){this.authService=e,this.userService=r,this.router=i}canActivate(e,r){return this.authService.waitForAuthStateInitialization().pipe(wn(()=>this.authService.user.pipe(nr(1),wn(i=>i?this.userService.getUserData(i.id).pipe(wn(s=>St("patient"!==s.role||this.router.createUrlTree(["/not-authorized"])))):St(this.router.createUrlTree(["/not-authorized"]))))))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(tu),a.LFG(Xg),a.LFG(jr))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Lat=["Bucure\u015fti","Cluj-Napoca","Timi\u015foara","Bra\u015fov","Ia\u015fi","Constan\u0163a","Craiova","Gala\u0163i","Ploie\u015fti","Oradea","Br\u0103ila","Arad","Pite\u015fti","Sibiu","Bac\u0103u","T\xe2rgu-Mure\u015f","Baia Mare","Buz\u0103u","Boto\u015fani","Satu Mare","R\xe2mnicu V\xe2lcea","Drobeta-Turnu Severin","Suceava","Piatra Neam\u0163","Re\u015fi\u0163a","T\xe2rgu Jiu","T\xe2rgovi\u015fte","Foc\u015fani","Bistri\u0163a","Tulcea","Slatina","C\u0103l\u0103ra\u015fi","Alba Iulia","Vaslui","Giurgiu","Deva","Hunedoara","Zal\u0103u","Sf\xe2ntu-Gheorghe","B\xe2rlad"];function $at(n,t){1&n&&(a.TgZ(0,"div",4),a._UZ(1,"mat-spinner"),a.qZA())}function Bat(n,t){1&n&&(a.TgZ(0,"h6"),a._uU(1,"After you complete this form, your information will be available in the medics page"),a.qZA())}function Vat(n,t){if(1&n&&(a.ynx(0),a.TgZ(1,"div",5)(2,"h2"),a._uU(3),a.qZA()(),a.TgZ(4,"div",5),a.YNc(5,Bat,2,0,"h6",2),a.qZA(),a.BQk()),2&n){const e=a.oxw();a.xp6(3),a.hij("",e.firstCreation?"Set up":"Edit"," your medic page"),a.xp6(2),a.Q6J("ngIf",e.firstCreation)}}function Uat(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function zat(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function Hat(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function Gat(n,t){if(1&n&&(a.TgZ(0,"mat-option",33),a._uU(1),a.qZA()),2&n){const e=t.$implicit;a.Q6J("value",e),a.xp6(1),a.Oqu(e)}}function Wat(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1,"Please select your city"),a.qZA())}function jat(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function qat(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input a valid email "),a.qZA())}function Zat(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," This field is required "),a.qZA())}function Yat(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input a valid phone number "),a.qZA())}function Kat(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"form",6),a.NdJ("ngSubmit",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onSubmit())}),a.TgZ(1,"div",7)(2,"div",8),a._UZ(3,"img",9),a.TgZ(4,"button",10),a.NdJ("click",function(){a.CHM(e);const i=a.MAs(8);return a.KtG(i.click())}),a.TgZ(5,"mat-icon"),a._uU(6,"add_a_photo"),a.qZA()(),a.TgZ(7,"input",11,12),a.NdJ("change",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onFileSelected(i))}),a.qZA()(),a.TgZ(9,"div",13)(10,"div",14)(11,"h1"),a._uU(12),a.qZA()(),a.TgZ(13,"div",14)(14,"h5"),a._uU(15),a.qZA()()()(),a._UZ(16,"mat-divider"),a.TgZ(17,"div",15)(18,"h3"),a._uU(19,"Medic information"),a.qZA()(),a.TgZ(20,"div",14)(21,"mat-form-field",16)(22,"mat-label"),a._uU(23,"Last Name"),a.qZA(),a._UZ(24,"input",17),a.qZA(),a.TgZ(25,"mat-form-field",16)(26,"mat-label"),a._uU(27,"First Name"),a.qZA(),a._UZ(28,"input",18),a.qZA()(),a.TgZ(29,"div",14)(30,"mat-form-field",19)(31,"mat-label"),a._uU(32,"Specialty"),a.qZA(),a.TgZ(33,"input",20),a.NdJ("input",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onMedicDetailsChange())}),a.qZA(),a.YNc(34,Uat,2,0,"mat-error",2),a.qZA()(),a.TgZ(35,"div",14)(36,"mat-form-field",21)(37,"mat-label"),a._uU(38,"Title"),a.qZA(),a.TgZ(39,"input",22),a.NdJ("input",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onMedicDetailsChange())}),a.qZA(),a.YNc(40,zat,2,0,"mat-error",2),a.qZA(),a.TgZ(41,"mat-form-field",21)(42,"mat-label"),a._uU(43,"Short Title"),a.qZA(),a.TgZ(44,"input",23),a.NdJ("input",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onMedicDetailsChange())}),a.qZA(),a.YNc(45,Hat,2,0,"mat-error",2),a.qZA()(),a._UZ(46,"mat-divider"),a.TgZ(47,"div",15)(48,"h3"),a._uU(49,"Doctor's office information"),a.qZA()(),a.TgZ(50,"div",14)(51,"mat-form-field",19)(52,"mat-label"),a._uU(53,"City"),a.qZA(),a.TgZ(54,"mat-select",24),a.YNc(55,Gat,2,2,"mat-option",25),a.qZA(),a.YNc(56,Wat,2,0,"mat-error",2),a.qZA()(),a.TgZ(57,"div",14)(58,"mat-form-field",19)(59,"mat-label"),a._uU(60,"Work Email"),a.qZA(),a._UZ(61,"input",26),a.YNc(62,jat,2,0,"mat-error",2),a.YNc(63,qat,2,0,"mat-error",2),a.qZA()(),a.TgZ(64,"div",14)(65,"mat-form-field",19)(66,"mat-label"),a._uU(67,"Phone Number"),a.qZA(),a.TgZ(68,"span",27),a._uU(69,"+40 \xa0"),a.qZA(),a._UZ(70,"input",28),a.YNc(71,Zat,2,0,"mat-error",2),a.YNc(72,Yat,2,0,"mat-error",2),a.qZA()(),a._UZ(73,"mat-divider"),a.TgZ(74,"div",29)(75,"h6"),a._uU(76),a.qZA()(),a.TgZ(77,"div",30)(78,"button",31),a._uU(79," Update "),a.qZA(),a.TgZ(80,"button",32),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.toggleMedicVisibility())}),a._uU(81),a.qZA()()()}if(2&n){const e=a.oxw();let r,i,s,o,l,c,u,f;a.Q6J("formGroup",e.medicPageForm),a.xp6(3),a.Q6J("src",e.imageUrl,a.LSH),a.xp6(9),a.lnq("",e.medicDetail.shortTitle," ",e.medicDetail.lastName," ",e.medicDetail.firstName,""),a.xp6(3),a.AsE("",e.medicDetail.title," in ",e.medicDetail.specialty,""),a.xp6(19),a.Q6J("ngIf",(null==(r=e.medicPageForm.get("specialty"))?null:r.hasError("required"))&&(null==(r=e.medicPageForm.get("specialty"))?null:r.touched)),a.xp6(6),a.Q6J("ngIf",(null==(i=e.medicPageForm.get("title"))?null:i.hasError("required"))&&(null==(i=e.medicPageForm.get("title"))?null:i.touched)),a.xp6(5),a.Q6J("ngIf",(null==(s=e.medicPageForm.get("shortTitle"))?null:s.hasError("required"))&&(null==(s=e.medicPageForm.get("shortTitle"))?null:s.touched)),a.xp6(10),a.Q6J("ngForOf",e.cityNames),a.xp6(1),a.Q6J("ngIf",null==(o=e.medicPageForm.get("city"))?null:o.hasError("required")),a.xp6(6),a.Q6J("ngIf",(null==(l=e.medicPageForm.get("email"))?null:l.hasError("required"))&&(null==(l=e.medicPageForm.get("email"))?null:l.touched)),a.xp6(1),a.Q6J("ngIf",(null==(c=e.medicPageForm.get("email"))?null:c.hasError("email"))&&(null==(c=e.medicPageForm.get("email"))?null:c.touched)),a.xp6(8),a.Q6J("ngIf",(null==(u=e.medicPageForm.get("telephone"))?null:u.hasError("required"))&&(null==(u=e.medicPageForm.get("telephone"))?null:u.touched)),a.xp6(1),a.Q6J("ngIf",(null==(f=e.medicPageForm.get("telephone"))?null:f.hasError("pattern"))&&(null==(f=e.medicPageForm.get("telephone"))?null:f.touched)),a.xp6(4),a.hij("Your page is currently ",e.isCurrentlyVisible?"visible":"hidden",""),a.xp6(2),a.Q6J("disabled",e.medicPageForm.invalid||!e.isFormChanged&&!e.imageChanged),a.xp6(2),a.Q6J("disabled",e.firstCreation||e.isFormChanged||e.imageChanged)("color",e.isCurrentlyVisible?"warn":"accent")("matTooltipDisabled",!e.firstCreation&&!e.isFormChanged&&!e.imageChanged),a.xp6(1),a.hij(" ",e.isCurrentlyVisible?"Hide your page from the medic list":"Make your page visible"," ")}}let Qat=(()=>{class n{constructor(e,r,i,s,o){this.route=e,this.formBuilder=r,this.userService=i,this.medicService=s,this._snackBar=o,this.isLoaded=!1,this.subscription=new kn.w0,this.isFormChanged=!1,this.cityNames=[],this.firstCreation=!1,this.isCurrentlyVisible=!1,this.imageUrl="",this.imageChanged=!1,this.medicDetail={},this.userId=this.route.snapshot.paramMap.get("userId")||""}ngOnInit(){this.isLoaded=!1,this.cityNames=Lat.sort((e,r)=>e.localeCompare(r,"ro")),this.subscription=DI([this.userService.getUserData(this.userId),this.medicService.getMedicByUserId(this.userId)]).subscribe(([e,r])=>{this.firstCreation=!r,this.createMedicPageForm(e,r),this.medicDetail={firstName:e.firstName,lastName:e.lastName,specialty:r?r.specialty:"",title:r?r.title:"",shortTitle:r?r.shortTitle:""},r&&(this.isCurrentlyVisible=r.isVisible,r.photoUrl?(this.imageUrl=r.photoUrl,this.isLoaded=!0):this.medicService.getDefaulImgUrl().subscribe(i=>{this.imageUrl=i,this.isLoaded=!0})),this.medicPageForm.valueChanges.subscribe(i=>{this.isFormChanged=!this.isEqual(i,this.initialFormValue)})})}ngOnDestroy(){this.subscription.unsubscribe()}createMedicPageForm(e,r){this.medicPageForm=this.formBuilder.group({lastName:[{value:e.lastName,disabled:!0}],firstName:[{value:e.firstName,disabled:!0}],specialty:[r?.specialty||"",[cn.required]],title:[r?.title||"",[cn.required]],shortTitle:[r?.shortTitle||"",[cn.required]],email:[r?.email||"",[cn.required,cn.email]],city:[r?.city||"",[cn.required]],telephone:[r?.phoneNumber||"",[cn.required,cn.pattern("^[23467](\\d){8}$")]]}),this.initialFormValue=this.medicPageForm.value}onMedicDetailsChange(){this.medicDetail.specialty=this.medicPageForm.get("specialty")?.value,this.medicDetail.title=this.medicPageForm.get("title")?.value,this.medicDetail.shortTitle=this.medicPageForm.get("shortTitle")?.value}isEqual(e,r){return JSON.stringify(e)===JSON.stringify(r)}onSubmit(){const e={firstName:this.medicPageForm.get("firstName")?.value,lastName:this.medicPageForm.get("lastName")?.value,email:this.medicPageForm.get("email")?.value,specialty:this.medicPageForm.get("specialty")?.value,title:this.medicPageForm.get("title")?.value,shortTitle:this.medicPageForm.get("shortTitle")?.value,city:this.medicPageForm.get("city")?.value,phoneNumber:this.medicPageForm.get("telephone")?.value,isVisible:!1,userId:this.userId,photoUrl:this.imageUrl};this.handleMedicSave(e)}handleMedicSave(e){this.firstCreation?this.medicService.addMedic(e).pipe(Qr(()=>{this.openEditSnackbar("Successfully set up your medic page. If you want your page to appear in the medics list, make sure to set your page to visible!"),this.handleImageUpload()})).subscribe():this.medicService.editMedicByUserId(this.userId,e).pipe(Qr(()=>{this.openEditSnackbar("Successfully edited your medic page. If you want your page to appear in the medics list, make sure to set your page to visible!"),this.handleImageUpload()})).subscribe()}handleImageUpload(){console.log(this.imageChanged,this.uploadedFile),this.imageChanged&&this.uploadedFile?this.medicService.uploadImage(this.userId,this.uploadedFile,"medic-images").pipe(wn(e=>(console.log("Setting medic image"),this.medicService.setMedicImageUrl(this.userId,e)))).subscribe(()=>{this.firstCreation=!1,this.isFormChanged=!1,this.imageChanged=!1}):(this.firstCreation=!1,this.isFormChanged=!1,this.imageChanged=!1)}toggleMedicVisibility(){this.medicService.updateMedicVisibility(this.userId,!this.isCurrentlyVisible).subscribe(()=>{this.openVisibilitySnackbar(this.isCurrentlyVisible?"Your page is now visible":"Your page is now hidden")})}openEditSnackbar(e){this._snackBar.open(e,void 0,{duration:1e4})}openVisibilitySnackbar(e){this._snackBar.open(e,"Undo",{duration:5e3,verticalPosition:"top"}).onAction().subscribe(()=>{this.medicService.updateMedicVisibility(this.userId,!this.isCurrentlyVisible).subscribe()})}onFileSelected(e){const r=e.target.files[0];if(r){const i=new FileReader;i.readAsDataURL(r),i.onload=()=>{this.imageUrl=i.result,this.imageChanged=!0,this.uploadedFile=r}}}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(mh),a.Y36(Nf),a.Y36(Xg),a.Y36(U1),a.Y36(I$))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-medic-profile"]],decls:4,vars:3,consts:[[1,"col-12","col-md-6","offset-md-3","p-4"],["class","d-flex justify-content-center mt-5",4,"ngIf"],[4,"ngIf"],["class","w-100 mt-3",3,"formGroup","ngSubmit",4,"ngIf"],[1,"d-flex","justify-content-center","mt-5"],[1,"row","text-center"],[1,"w-100","mt-3",3,"formGroup","ngSubmit"],[1,"row","profile-header-div","position-relative"],[1,"img-div","col","me-4"],["alt","Profile picture",3,"src"],["type","button","mat-fab","","color","accent",1,"add-photo-button",3,"click"],["hidden","","type","file","id","file","accept","image/*",3,"change"],["fileInput",""],[1,"col"],[1,"row"],[1,"row","p-1","mt-1"],["appearance","outline",1,"col-md-6","col-12"],["matInput","","type","text","formControlName","lastName"],["matInput","","type","text","formControlName","firstName"],["appearance","outline"],["matInput","","formControlName","specialty","placeholder","Ex. Dermatology","maxlength","30",3,"input"],["appearance","outline",1,"col"],["matInput","","formControlName","title","placeholder","Ex. Professor, Primary Doctor","maxlength","50",3,"input"],["matInput","","formControlName","shortTitle","placeholder","Ex. Prof. Dr.","maxlength","20",3,"input"],["formControlName","city"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","email"],["matPrefix",""],["matInput","","type","tel","formControlName","telephone","placeholder","720123456","maxlength","9"],[1,"row","text-center","mt-3"],[1,"row","d-flex","gap-3"],["type","submit","mat-raised-button","","color","primary","type","submit",1,"p-1","col",3,"disabled"],["mat-raised-button","","type","button","matTooltip","You cannot change your visibility while you have unsaved changes. Please save or discard your changes and try again!","matTooltipPosition","above",1,"col",3,"disabled","color","matTooltipDisabled","click"],[3,"value"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0),a.YNc(1,$at,2,0,"div",1),a.YNc(2,Vat,6,2,"ng-container",2),a.YNc(3,Kat,82,22,"form",3),a.qZA()),2&e&&(a.xp6(1),a.Q6J("ngIf",!r.isLoaded),a.xp6(1),a.Q6J("ngIf",r.isLoaded),a.xp6(1),a.Q6J("ngIf",r.isLoaded))},dependencies:[Na,Ur,js,Kg,d1,h1,Mb,bq,td,f1,Jc,Hq,r$,S1,Mm,bf,Cf,av,Pm,Jl,Fm],styles:[".profile-header-div[_ngcontent-%COMP%]{height:25vh;display:flex;align-items:center;padding:2rem}.img-div[_ngcontent-%COMP%]{border:2px solid var(--accent);aspect-ratio:1;background-size:cover;flex:0 0 156px;box-sizing:border-box;position:relative;padding:0}.img-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:cover}.add-photo-button[_ngcontent-%COMP%]{position:absolute;bottom:-20px;right:-20px}"]}),n})();function Xat(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",11)(1,"button",12),a.NdJ("click",function(){a.CHM(e);const i=a.oxw();return a.KtG(i.onLogoutClick())}),a._uU(2,"Logout"),a.qZA()()}}let Jat=(()=>{class n{constructor(e,r){this.authService=e,this.router=r,this.currentUser=null,this.userSub=new kn.w0}ngOnInit(){this.userSub=this.authService.user.subscribe(e=>{this.currentUser=e})}onLogoutClick(){this.authService.logout(),this.router.navigate(["/"])}onReturnToMainPageClick(){this.router.navigate(["/"])}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(tu),a.Y36(jr))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-not-authorized"]],decls:22,vars:4,consts:[[1,"container","p-5"],[1,"row","mt-4"],[1,"col","icon-div","d-flex","align-items-center","justify-content-center"],[1,"block-icon"],[1,"row","text-center","mt-5"],[1,"row","text-center","mt-4"],[1,"text"],[1,"row","text-center"],["class","col-2 offset-4",4,"ngIf"],[1,"col-2",3,"ngClass"],["mat-button","","color","primary",3,"click"],[1,"col-2","offset-4"],["mat-button","","color","warn",3,"click"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),a._uU(4,"block"),a.qZA()()(),a.TgZ(5,"div",4)(6,"h1"),a._uU(7,"You are not authorized to access this page"),a.qZA()(),a.TgZ(8,"div",5)(9,"p",6),a._uU(10),a.qZA()(),a.TgZ(11,"div",7)(12,"p",6),a._uU(13),a.qZA()(),a.TgZ(14,"div",5)(15,"p",6),a._uU(16,"If you believe this is a mistake, please contact your administrator."),a.qZA()(),a.TgZ(17,"div",1),a.YNc(18,Xat,3,0,"div",8),a.TgZ(19,"div",9)(20,"button",10),a.NdJ("click",function(){return r.onReturnToMainPageClick()}),a._uU(21,"Return to Main Page"),a.qZA()()()()),2&e&&(a.xp6(10),a.hij(" It seems like ",r.currentUser?"your current account doesn't":"you don't"," have permission to access this page. "),a.xp6(3),a.hij("Please sign in ",r.currentUser?"with a different account":""," and try again."),a.xp6(5),a.Q6J("ngIf",r.currentUser),a.xp6(1),a.Q6J("ngClass",r.currentUser?"":"offset-5"))},dependencies:[Aa,Ur,js,td],styles:["[_nghost-%COMP%]{--icon-scale: 6}.block-icon[_ngcontent-%COMP%]{transform:scale(var(--icon-scale))}.icon-div[_ngcontent-%COMP%]{height:calc(var(--icon-scale) * 24px);box-sizing:border-box}.text[_ngcontent-%COMP%]{color:gray;margin:0}"]}),n})(),elt=(()=>{class n{constructor(e,r,i){this.authService=e,this.userService=r,this.router=i}canActivate(e,r){return this.authService.user.pipe(nr(1),wn(i=>{if(i){const s=i.id,o=e.paramMap.get("userId");return this.userService.getUserData(i.id).pipe(nr(1),(0,Ot.U)(l=>l&&"medic"===l.role?s===o||this.router.createUrlTree(["medic-page",i.id]):this.router.createUrlTree(["not-authorized"])))}return St(this.router.createUrlTree(["not-authorized"]))}))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(tu),a.LFG(Xg),a.LFG(jr))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),tlt=(()=>{class n{constructor(e){this.firestore=e}addContactData(e){const r=this.firestore.collection("contact");return(0,Dn.D)(r.add(e))}}return n.\u0275fac=function(e){return new(e||n)(a.LFG(xI))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function nlt(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input your name "),a.qZA())}function rlt(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input your name "),a.qZA())}function ilt(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input your email "),a.qZA())}function slt(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input a valid email address "),a.qZA())}function olt(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input your phone number "),a.qZA())}function alt(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input a valid phone number "),a.qZA())}function llt(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please input a message "),a.qZA())}function clt(n,t){1&n&&(a.TgZ(0,"mat-error"),a._uU(1," Please tell us a bit more about the problem "),a.qZA())}let ult=(()=>{class n{constructor(e,r,i){this.formBuilder=e,this.contactService=r,this._snackBar=i,this.contactForm=this.formBuilder.group({})}ngOnInit(){this.createContactForm()}createContactForm(){this.contactForm=this.formBuilder.group({firstName:["",cn.required],lastName:["",cn.required],email:["",[cn.required,cn.email]],phoneNumber:["",[cn.required,cn.pattern("^[23467](\\d){8}$")]],message:["",[cn.required,cn.minLength(50)]],medicProblem:[!1],appointmentProblem:[!1],scheduleProblem:[!1],accountProblem:[!1],otherProblem:[!1],medicJoin:[!1],otherReason:[!1]})}onSubmit(){if(this.contactForm.valid){const e={firstName:this.contactForm.get("firstName")?.value,lastName:this.contactForm.get("lastName")?.value,email:this.contactForm.get("email")?.value,phoneNumber:this.contactForm.get("phoneNumber")?.value,message:this.contactForm.get("message")?.value,medicProblem:this.contactForm.get("medicProblem")?.value,appointmentProblem:this.contactForm.get("appointmentProblem")?.value,scheduleProblem:this.contactForm.get("scheduleProblem")?.value,accountProblem:this.contactForm.get("accountProblem")?.value,otherProblem:this.contactForm.get("otherProblem")?.value,medicJoin:this.contactForm.get("medicJoin")?.value,otherReason:this.contactForm.get("otherReason")?.value};this.contactService.addContactData(e).subscribe({next:()=>{this.contactForm.reset(),this.openSnackBar("Successfully sent your message. A member of our team will review it as soon as possible")},error:r=>{console.error(r),this.openSnackBar("There was an error sending your request. Please try again")}})}}openSnackBar(e){this._snackBar.open(e,void 0,{duration:1e4})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(Nf),a.Y36(tlt),a.Y36(I$))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-contact"]],decls:124,vars:15,consts:[[1,"container","p-4"],[1,"row","text-center","mt-5"],[1,"row","text-center"],[1,"col-12","col-md-6","offset-md-3","form-subtitle"],[1,"row"],[1,"col-8"],[1,"p-4","me-4",3,"formGroup","ngSubmit"],["appearance","outline",1,"col-6",3,"floatLabel"],["matInput","","formControlName","firstName","placeholder","First name"],[4,"ngIf"],["matInput","","formControlName","lastName","placeholder","Last name"],["appearance","outline",3,"floatLabel"],["matInput","","formControlName","email","placeholder","you@example.com"],["matPrefix",""],["matInput","","type","tel","formControlName","phoneNumber","placeholder","777-777-777","maxlength","9"],["rows","7","matInput","","formControlName","message","placeholder","Leave us a message..."],[1,"row","ps-3","pt-3"],[1,"row","ps-3"],[1,"col-5"],["formControlName","medicProblem","color","primary"],[1,"col"],["formControlName","accountProblem","color","primary"],[1,"row","mt-2","ps-3"],["formControlName","appointmentProblem","color","primary"],["formControlName","scheduleProblem","color","primary"],[1,"row","mt-2","mb-2","ps-3"],["formControlName","otherProblem","color","primary"],["formControlName","medicJoin","color","primary"],["formControlName","otherReason","color","primary"],[1,"row","ps-4","mt-4","me-1"],["mat-raised-button","","color","primary","type","submit",1,"p-1","fs-6",3,"disabled"],[1,"col-4","mt-4","pe-4"],[1,"form-subtitle"],[1,"row","mt-4"],["mat-button","","href","mailto:stefan.ro95@gmail.com"],["mat-button","","href","tel:+40723254030"],["mat-button","","href","https://maps.app.goo.gl/D27PT2GQs2UAb58e9"]],template:function(e,r){if(1&e&&(a.TgZ(0,"div",0)(1,"div",1)(2,"h1"),a._uU(3,"Contact us"),a.qZA()(),a.TgZ(4,"div",2)(5,"div",3)(6,"h6"),a._uU(7," Got any question about our website or our services? Please fill the following form and we will try to reach you as soon as we can. "),a.qZA()()(),a.TgZ(8,"div",4)(9,"div",5)(10,"form",6),a.NdJ("ngSubmit",function(){return r.onSubmit()}),a.TgZ(11,"div",4)(12,"mat-form-field",7)(13,"mat-label"),a._uU(14,"First name"),a.qZA(),a._UZ(15,"input",8),a.YNc(16,nlt,2,0,"mat-error",9),a.qZA(),a.TgZ(17,"mat-form-field",7)(18,"mat-label"),a._uU(19,"Last name"),a.qZA(),a._UZ(20,"input",10),a.YNc(21,rlt,2,0,"mat-error",9),a.qZA()(),a.TgZ(22,"div",4)(23,"mat-form-field",11)(24,"mat-label"),a._uU(25,"Email"),a.qZA(),a._UZ(26,"input",12),a.YNc(27,ilt,2,0,"mat-error",9),a.YNc(28,slt,2,0,"mat-error",9),a.qZA()(),a.TgZ(29,"div",4)(30,"mat-form-field",11)(31,"mat-label"),a._uU(32,"Phone Number"),a.qZA(),a.TgZ(33,"span",13),a._uU(34,"+40 \xa0"),a.qZA(),a._UZ(35,"input",14),a.YNc(36,olt,2,0,"mat-error",9),a.YNc(37,alt,2,0,"mat-error",9),a.qZA()(),a.TgZ(38,"div",4)(39,"mat-form-field",11)(40,"mat-label"),a._uU(41,"Message"),a.qZA(),a._UZ(42,"textarea",15),a.TgZ(43,"mat-hint"),a._uU(44,"Please be as descriptive as possible"),a.qZA(),a.YNc(45,llt,2,0,"mat-error",9),a.YNc(46,clt,2,0,"mat-error",9),a.qZA()(),a.TgZ(47,"div",16)(48,"h6"),a._uU(49,"Please select all that apply"),a.qZA()(),a.TgZ(50,"div",17)(51,"div",18)(52,"mat-checkbox",19),a._uU(53,"Medic page issues"),a.qZA()(),a.TgZ(54,"div",20)(55,"mat-checkbox",21),a._uU(56,"Account issues"),a.qZA()()(),a.TgZ(57,"div",22)(58,"div",18)(59,"mat-checkbox",23),a._uU(60,"Appointment issues"),a.qZA()(),a.TgZ(61,"div",20)(62,"mat-checkbox",24),a._uU(63," Schedule issues "),a.TgZ(64,"em"),a._uU(65,"(only for medic accounts)"),a.qZA()()()(),a.TgZ(66,"div",25)(67,"div",18)(68,"mat-checkbox",26),a._uU(69,"Other issues"),a.qZA()()(),a._UZ(70,"mat-divider"),a.TgZ(71,"div",22)(72,"div",18)(73,"mat-checkbox",27),a._uU(74,"I am a medic and want to join"),a.qZA()(),a.TgZ(75,"div",20)(76,"mat-checkbox",28),a._uU(77,"Other"),a.qZA()()(),a.TgZ(78,"div",29)(79,"button",30),a._uU(80," Send message "),a.qZA()()()(),a.TgZ(81,"div",31)(82,"div",4)(83,"h2"),a._uU(84,"Contact Information"),a.qZA()(),a.TgZ(85,"div",4)(86,"p",32),a._uU(87,"If you prefer, you can speak directly to us through one of the following channels"),a.qZA()(),a.TgZ(88,"div",33)(89,"h4"),a._uU(90,"Email us"),a.qZA()(),a.TgZ(91,"div",4)(92,"p",32),a._uU(93," Our inbox is open 24/7. Shoot us a mail and we will get back to you as soon as possible. "),a.qZA()(),a.TgZ(94,"div",4)(95,"div",20)(96,"a",34)(97,"mat-icon"),a._uU(98,"outgoing_mail"),a.qZA(),a._uU(99," stefan.ro95@gmail.com"),a.qZA()()(),a.TgZ(100,"div",33)(101,"h4"),a._uU(102,"Call us"),a.qZA()(),a.TgZ(103,"div",4)(104,"p",32),a._uU(105,"Call our team Mon-Fri from 8am to 5pm"),a.qZA()(),a.TgZ(106,"div",4)(107,"div",20)(108,"a",35)(109,"mat-icon"),a._uU(110,"phone_in_talk"),a.qZA(),a._uU(111," +40-723-254-030"),a.qZA()()(),a.TgZ(112,"div",33)(113,"h4"),a._uU(114,"Visit us"),a.qZA()(),a.TgZ(115,"div",4)(116,"p",32),a._uU(117,"If you want to chat with us in person, you can find us here:"),a.qZA()(),a.TgZ(118,"div",4)(119,"div",20)(120,"a",36)(121,"mat-icon"),a._uU(122,"location_on"),a.qZA(),a._uU(123," Strada Clinicii 7, Etajul 2, Bra\u0219ov, Rom\xe2nia "),a.qZA()()()()()()),2&e){let i,s,o,l,c,u,f,m;a.xp6(10),a.Q6J("formGroup",r.contactForm),a.xp6(2),a.Q6J("floatLabel","always"),a.xp6(4),a.Q6J("ngIf",(null==(i=r.contactForm.get("firstName"))?null:i.hasError("required"))&&(null==(i=r.contactForm.get("firstName"))?null:i.touched)),a.xp6(1),a.Q6J("floatLabel","always"),a.xp6(4),a.Q6J("ngIf",(null==(s=r.contactForm.get("firstName"))?null:s.hasError("required"))&&(null==(s=r.contactForm.get("firstName"))?null:s.touched)),a.xp6(2),a.Q6J("floatLabel","always"),a.xp6(4),a.Q6J("ngIf",(null==(o=r.contactForm.get("email"))?null:o.hasError("required"))&&(null==(o=r.contactForm.get("email"))?null:o.touched)),a.xp6(1),a.Q6J("ngIf",(null==(l=r.contactForm.get("email"))?null:l.hasError("email"))&&(null==(l=r.contactForm.get("email"))?null:l.touched)),a.xp6(2),a.Q6J("floatLabel","always"),a.xp6(6),a.Q6J("ngIf",(null==(c=r.contactForm.get("phoneNumber"))?null:c.hasError("required"))&&(null==(c=r.contactForm.get("phoneNumber"))?null:c.touched)),a.xp6(1),a.Q6J("ngIf",(null==(u=r.contactForm.get("phoneNumber"))?null:u.hasError("pattern"))&&(null==(u=r.contactForm.get("phoneNumber"))?null:u.touched)),a.xp6(2),a.Q6J("floatLabel","always"),a.xp6(6),a.Q6J("ngIf",(null==(f=r.contactForm.get("message"))?null:f.hasError("required"))&&(null==(f=r.contactForm.get("message"))?null:f.touched)),a.xp6(1),a.Q6J("ngIf",(null==(m=r.contactForm.get("message"))?null:m.hasError("minlength"))&&(null==(m=r.contactForm.get("message"))?null:m.touched)),a.xp6(33),a.Q6J("disabled",r.contactForm.invalid)}},dependencies:[Ur,js,fse,gse,Kg,d1,h1,u$,Mb,bq,td,f1,Mm,bf,Cf,av,Pm,Jl,Fm],styles:[".form-subtitle[_ngcontent-%COMP%]{color:#2f4f4f}p.form-subtitle[_ngcontent-%COMP%]{margin:0 0 8px}"]}),n})(),dlt=(()=>{class n{constructor(e){this.elementRef=e}ngOnInit(){}onArrowClick(){const e=this.elementRef.nativeElement.querySelector("#vision");e&&e.scrollIntoView({behavior:"smooth",block:"start"})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(a.SBq))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-about"]],decls:34,vars:0,consts:[[1,"image-container"],[1,"gradient"],["src","../../../assets/images/aditya-romansa-5zp0jym2w9M-unsplash.jpg","alt","https://unsplash.com/photos/person-holding-babys-index-finger-5zp0jym2w9M?utm_content=creditShareLink&utm_medium=referral&utm_source=unsplash"],[1,"container","image-text"],[1,"row","text-center"],[1,"image-title"],[1,"col-10","offset-1"],[1,"image-content"],[1,"row"],[1,"col","text-center"],["mat-icon-button","",1,"arrow-icon",3,"click"],["id","vision",1,"div-container"],[1,"container","text-center","text-container"],[1,"row","mt-4"],[1,"text-content"],[1,"div-container"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0),a._UZ(1,"div",1)(2,"img",2),a.TgZ(3,"div",3)(4,"div",4)(5,"h1",5),a._uU(6,"About MedVision"),a.qZA()(),a.TgZ(7,"div",4)(8,"div",6)(9,"p",7),a._uU(10," We are a clinic full of passionate people who truly believe that the happiness of our patients should be the first priority. "),a.qZA()()(),a.TgZ(11,"div",8)(12,"div",9)(13,"button",10),a.NdJ("click",function(){return r.onArrowClick()}),a.TgZ(14,"mat-icon"),a._uU(15,"keyboard_double_arrow_down"),a.qZA()()()()()(),a.TgZ(16,"div",11)(17,"div",12)(18,"div",8)(19,"h1"),a._uU(20,"Our Vision"),a.qZA()(),a.TgZ(21,"div",13)(22,"div",6)(23,"p",14),a._uU(24," Our vision is to revolutionize the way people interact with and think about the medical system. We are firm believers that technology is the key to building a powerful and accessible platform, one that empowers people to navigate health concerns with knowledge and confidence. By working hand-in-hand with the medical staff and combining their needs with those of the patients, we strive to contribute to a more efficient medical future, a future where every single person gets the medical care they need. "),a.qZA()()()()(),a.TgZ(25,"div",15)(26,"div",12)(27,"div",8)(28,"h1"),a._uU(29,"Our Mission"),a.qZA()(),a.TgZ(30,"div",13)(31,"div",6)(32,"p",14),a._uU(33," Putting healthcare at your fingertips. Our platform empowers medics, nurses, and patients with a fast and easy-to-use tool regardless of age, background or technical expertise. All of our efforts go into providing a better service for, to get the care needed to the people that need it as soon as possible. "),a.qZA()()()()())},dependencies:[js,td],styles:[".image-container[_ngcontent-%COMP%]{position:relative;height:80vh;max-width:100%;display:flex;justify-content:center}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;object-position:center;height:100%;width:100%}.gradient[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;background-image:linear-gradient(transparent 0%,rgba(0,0,0,.6) 40%,rgba(0,0,0,.6));z-index:2}.image-text[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;z-index:3;color:#fff;overflow-y:hidden;display:flex;flex-direction:column;justify-content:flex-end;padding-bottom:4%}.image-title[_ngcontent-%COMP%]{font-size:64px;font-weight:500;margin-bottom:4%}.image-content[_ngcontent-%COMP%]{font-size:32px;margin-bottom:4%}.div-container[_ngcontent-%COMP%]{padding:100px 200px 0;display:flex;justify-content:center;align-items:center}.div-container[_ngcontent-%COMP%]:last-child{padding-bottom:100px}.text-container[_ngcontent-%COMP%]{background-color:#f8f8f8;padding-top:100px;padding-bottom:100px;border-radius:24px}.text-content[_ngcontent-%COMP%]{color:#222;font-size:20px;line-height:2}.arrow-icon[_ngcontent-%COMP%]{transform:scale(2.5)}"]}),n})(),hlt=(()=>{class n{constructor(e,r){this.dialogRef=e,this.data=r}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(ioe),a.Y36(Rq))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-description-dialog"]],decls:7,vars:5,consts:[[1,"mt-3","mb-3"]],template:function(e,r){1&e&&(a.TgZ(0,"h2"),a._uU(1),a.qZA(),a.TgZ(2,"h5"),a._uU(3),a.qZA(),a._UZ(4,"mat-divider",0),a.TgZ(5,"p"),a._uU(6),a.qZA()),2&e&&(a.xp6(1),a.Oqu(r.data.name),a.xp6(1),a.Udp("color",r.data.needsConsult?" red":"orange"),a.xp6(1),a.hij(" ",r.data.needsConsult?"SETTING UP A CONSULT IS HIGHLY RECOMMENDED!":"Setting up a consult is recommended if the lesion is bothersome or changes in any way","\n"),a.xp6(3),a.Oqu(r.data.description))},dependencies:[Kg]}),n})(),flt=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-help-dialog"]],decls:9,vars:0,consts:[[1,"mt-3","mb-3"],[1,"image-div"],["src","../../../../assets/images/sample-lesion-pic.jpg","alt","Sample lesion image"]],template:function(e,r){1&e&&(a.TgZ(0,"h2"),a._uU(1,"How to use the Skin Lesion Analyser"),a.qZA(),a._UZ(2,"mat-divider",0),a.TgZ(3,"p"),a._uU(4," To get the best results please use a clear, close-up picture of the lesion. Make sure the whole lesion is in frame and that nothing else appears in the photo.\n"),a.qZA(),a.TgZ(5,"h6"),a._uU(6,"Example:"),a.qZA(),a.TgZ(7,"div",1),a._UZ(8,"img",2),a.qZA())},dependencies:[Kg],styles:[".image-div[_ngcontent-%COMP%]{width:60%}.image-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}"]}),n})(),plt=(()=>{class n{constructor(){this.filesChangeEmiter=new a.vpe,this.background="#eee",this.borderStyle="2px dashed",this.borderColor="#696D7D",this.borderRadius="5px"}onDragOver(e){e.preventDefault(),e.stopPropagation(),this.background="lightgray",this.borderColor="cadetblue",this.borderStyle="3px solid"}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.background="#eee",this.borderColor="#696D7D",this.borderStyle="2px dashed"}onDrop(e){e.preventDefault(),e.stopPropagation(),this.background="#eee",this.borderColor="#696D7D",this.borderStyle="2px dashed",this.filesChangeEmiter.emit(e.dataTransfer.files)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.lG2({type:n,selectors:[["","appFileDragNDropDirective",""]],hostVars:8,hostBindings:function(e,r){1&e&&a.NdJ("dragover",function(s){return r.onDragOver(s)})("dragleave",function(s){return r.onDragLeave(s)})("drop",function(s){return r.onDrop(s)}),2&e&&a.Udp("background",r.background)("border",r.borderStyle)("border-color",r.borderColor)("border-radius",r.borderRadius)},outputs:{filesChangeEmiter:"filesChangeEmiter"}}),n})();function mlt(n,t){1&n&&(a.ynx(0),a.TgZ(1,"div",8)(2,"div",13)(3,"h3"),a._uU(4,"Loading model..."),a.qZA()()(),a.TgZ(5,"div",14)(6,"div",15),a._UZ(7,"mat-progress-bar",16),a.qZA()(),a.BQk())}function glt(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",17)(1,"div",15)(2,"div",18),a.NdJ("filesChangeEmiter",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onFileDrop(i))}),a.TgZ(3,"input",19,20),a.NdJ("change",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onFileChange(i))}),a.qZA(),a.TgZ(5,"button",21),a.NdJ("click",function(){a.CHM(e);const i=a.MAs(4);return a.KtG(i.click())}),a.TgZ(6,"mat-icon"),a._uU(7,"upload_file"),a.qZA(),a._uU(8," Select your file "),a.qZA(),a.TgZ(9,"label",22),a._uU(10," or Drop it here! "),a.qZA()()()()}}function _lt(n,t){1&n&&(a.ynx(0),a.TgZ(1,"div",14)(2,"div",15),a._UZ(3,"mat-progress-bar",16),a.qZA()(),a.BQk())}function ylt(n,t){if(1&n){const e=a.EpF();a.TgZ(0,"div",27)(1,"div",29)(2,"span",30),a.NdJ("click",function(){const s=a.CHM(e).$implicit,o=a.oxw(2);return a.KtG(o.openDescription(s.name,s.description,s.needsConsult))}),a._uU(3),a.TgZ(4,"strong"),a._uU(5),a.ALo(6,"number"),a.qZA()(),a.TgZ(7,"button",31),a.NdJ("click",function(){const s=a.CHM(e).$implicit,o=a.oxw(2);return a.KtG(o.openDescription(s.name,s.description,s.needsConsult))}),a.TgZ(8,"mat-icon"),a._uU(9,"read_more"),a.qZA()()()()}if(2&n){const e=t.$implicit;a.xp6(3),a.AsE(" ",e.name," (",e.shortName,"): "),a.xp6(2),a.hij("",a.xi3(6,3,100*e.value,"1.0-2"),"%")}}function vlt(n,t){if(1&n){const e=a.EpF();a.ynx(0),a.TgZ(1,"div",23)(2,"div",15),a._UZ(3,"img",24),a.qZA()(),a.TgZ(4,"div",17)(5,"div",13)(6,"input",19,20),a.NdJ("change",function(i){a.CHM(e);const s=a.oxw();return a.KtG(s.onFileChange(i))}),a.qZA(),a.TgZ(8,"button",21),a.NdJ("click",function(){a.CHM(e);const i=a.MAs(7);return a.KtG(i.click())}),a.TgZ(9,"mat-icon"),a._uU(10,"upload_file"),a.qZA(),a._uU(11," Upload a different file "),a.qZA()()(),a._UZ(12,"mat-divider",25),a.TgZ(13,"div",17)(14,"div",15)(15,"div",26)(16,"div",27)(17,"h4"),a._uU(18,"Predictions:"),a.qZA()(),a.YNc(19,ylt,10,6,"div",28),a.qZA()()(),a.BQk()}if(2&n){const e=a.oxw();a.xp6(3),a.Q6J("src",e.imageUrl,a.LSH),a.xp6(16),a.Q6J("ngForOf",e.getTopResults())}}const blt=[{path:"",title:"Ditama Clinic - Home",component:pPe},{path:"authenticate",title:"Ditama Clinic - Authenticate",component:PPe,canActivate:[XPe]},{path:"medics",title:"Ditama Clinic - Medics",component:wPe},{path:"medic-page/:userId",title:"Ditama Clinic - Set up your medic page",component:Qat,canActivate:[elt]},{path:"medic-page",redirectTo:"medic-page/ "},{path:"appointments/:city/:specialty/:medicId",title:"Ditama Clinic - Appointments",component:xle,canActivate:[Ile]},{path:"appointments",title:"Ditama Clinic - Appointments",component:xle,canActivate:[Ile]},{path:"schedule",title:"Ditama Clinic - Medic Schedule",component:Fat,canActivate:[Pat]},{path:"profile/:userId",title:"Ditama Clinic - User Profile",component:KPe,canActivate:[QPe]},{path:"profile",redirectTo:"profile/ "},{path:"contact",title:"Ditama Clinic - Contact",component:ult},{path:"about",title:"Ditama Clinic - About",component:dlt},{path:"ai-photo-check",title:"Ditama Clinic - Skin Lesion Analyser",component:(()=>{class n{constructor(e,r){this.dialog=e,this.lesionClassificationService=r,this.imageUrl=null,this.predictionMade=!1,this.modelLoaded=!1,this.modelLoadedStatusSubscription=new kn.w0,this.predictionStatusSubscription=new kn.w0,this.isProcessingSubscription=new kn.w0,this.isProcessing=!1}ngOnInit(){this.predictionStatusSubscription=this.lesionClassificationService.predictionStatus$.subscribe(e=>{this.predictionMade=e}),this.isProcessingSubscription=this.lesionClassificationService.isProcessing$.subscribe(e=>{this.isProcessing=e,console.log(e)}),this.modelLoadedStatusSubscription=this.lesionClassificationService.modelLoadedStatus$.subscribe(e=>{this.modelLoaded=e}),this.modelLoaded||this.lesionClassificationService.loadModel().then(()=>{this.modelLoaded=!0})}ngOnDestroy(){this.predictionStatusSubscription.unsubscribe(),this.isProcessingSubscription.unsubscribe(),this.modelLoadedStatusSubscription.unsubscribe(),this.lesionClassificationService.resetPredictionStatus()}onFileChange(e){this.uploadedFile=e.target.files[0],this.handleFile(this.uploadedFile)}onFileDrop(e){this.uploadedFile=e[0],this.handleFile(this.uploadedFile)}handleFile(e){const r=new FileReader,i=new Image;r.onload=s=>{this.imageUrl=r.result,i.onload=()=>{this.lesionClassificationService.predict(i)},i.src=r.result},e&&r.readAsDataURL(e)}getTopResults(){return[...this.lesionClassificationService.realResults].sort((r,i)=>i.value-r.value).slice(0,3)}openDescription(e,r,i){this.dialog.open(hlt,{width:"600px",data:{name:e,description:r,needsConsult:i}})}openHelpDialog(){this.dialog.open(flt,{width:"600px"})}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(Mq),a.Y36(hge))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-ai-photo-check"]],decls:32,vars:4,consts:[[1,"container","mt-5"],[1,"row","text-center"],[1,"row","mt-2"],[1,"col","text-center"],[1,"help","d-inline-block",3,"click"],[1,"d-flex","align-items-center","gap-1"],[4,"ngIf"],["class","row mt-3",4,"ngIf"],[1,"row","mt-5"],[1,"col-10","offset-1"],[1,"disclaimer-title"],[1,"row","mb-5"],[1,"disclaimer-content"],[1,"col-6","offset-3","text-center"],[1,"row","mt-5","mb-5"],[1,"col-6","offset-3"],["mode","indeterminate",2,"margin","auto"],[1,"row","mt-3"],["ngClass","","appFileDragNDropDirective","",1,"dropzone",3,"filesChangeEmiter"],["type","file","name","file","id","file","accept","image/*",3,"change"],["fileInput",""],["mat-raised-button","","color","accent",2,"font-size","large",3,"click"],["for","file"],[1,"row","mt-5","text-center"],[1,"image",3,"src"],[1,"mt-3"],[1,"results-div","p-4","ps-5"],[1,"row"],["class","row",4,"ngFor","ngForOf"],[1,"d-flex","gap-2","fs-5","align-items-center"],[2,"cursor","pointer",3,"click"],["mat-icon-button","",2,"margin-left","auto",3,"click"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0)(1,"div",1)(2,"h1"),a._uU(3,"Do you have a spot, bump or lesion on your skin?"),a.qZA()(),a.TgZ(4,"div",1)(5,"h5"),a._uU(6,"Upload a photo of it and our cutting edge AI will attempt to tell you what it is!"),a.qZA()(),a.TgZ(7,"div",2)(8,"div",3)(9,"h6",4),a.NdJ("click",function(){return r.openHelpDialog()}),a.TgZ(10,"div",5)(11,"span"),a._uU(12,"How to use this feature"),a.qZA(),a.TgZ(13,"mat-icon"),a._uU(14,"help"),a.qZA()()()()(),a.YNc(15,mlt,8,0,"ng-container",6),a.YNc(16,glt,11,0,"div",7),a.YNc(17,_lt,4,0,"ng-container",6),a.YNc(18,vlt,20,2,"ng-container",6),a.TgZ(19,"div",8)(20,"div",9)(21,"p",10),a._uU(22,"Not intended for medical purposes"),a.qZA()()(),a.TgZ(23,"div",11)(24,"div",9)(25,"p",12),a._uU(26," This feature is not intended to diagnose any medical condition and should not be relied on for any medical purposes. It is intended to provide information that can help you manage your well-being. The model that powers this web page is not 100% accurate. It may produce false results with a "),a.TgZ(27,"strong"),a._uU(28,"high"),a.qZA(),a._uU(29," confidence. This model should only be used for informational purposes. If you have any concerns about your health, or if a skin lesion is bothersome or changes in any way, "),a.TgZ(30,"strong"),a._uU(31,"PLEASE CONTACT YOUR MEDICAL PROVIDER!"),a.qZA()()()()()),2&e&&(a.xp6(15),a.Q6J("ngIf",!r.modelLoaded),a.xp6(1),a.Q6J("ngIf",!r.imageUrl&&r.modelLoaded&&!r.isProcessing),a.xp6(1),a.Q6J("ngIf",r.isProcessing),a.xp6(1),a.Q6J("ngIf",r.predictionMade&&!r.isProcessing))},dependencies:[Aa,Na,Ur,js,Kg,td,w$,plt,Wl],styles:[".dropzone[_ngcontent-%COMP%]{height:200px;display:flex;width:100%;background-color:#eee;border:dotted 2px #aaa;border-radius:24px;align-items:center;justify-content:center;gap:12px}input[type=file][_ngcontent-%COMP%]{display:none}.image[_ngcontent-%COMP%]{max-width:100%;max-height:200px}.results-div[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff;border-radius:24px}.disclaimer-title[_ngcontent-%COMP%]{color:gray;font-size:16px;font-weight:600;margin:0}.disclaimer-content[_ngcontent-%COMP%]{color:gray;font-style:italic;font-size:14px;margin:0}.help[_ngcontent-%COMP%]{font-style:italic;border-bottom:dotted 1px var(--primary);color:var(--primary);opacity:.75;cursor:pointer;padding-left:1px}.help[_ngcontent-%COMP%]:hover{border-bottom:solid 1px var(--primary);opacity:1}"]}),n})()},{path:"not-authorized",title:"Ditama Clinic - Unauthorized Access",component:Jat},{path:"**",redirectTo:""}];let wlt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[vle.forRoot(blt),vle]}),n})();function Clt(n,t){1&n&&(a.ynx(0),a.TgZ(1,"a",12),a._uU(2,"Schedule"),a.qZA(),a.BQk())}function xlt(n,t){if(1&n&&(a.ynx(0),a.YNc(1,Clt,3,0,"ng-container",5),a.TgZ(2,"a",11),a._uU(3,"Appointments"),a.qZA(),a.BQk()),2&n){const e=t.ngIf;a.xp6(1),a.Q6J("ngIf","medic"===e.role)}}function Ilt(n,t){if(1&n&&(a.ynx(0),a.YNc(1,xlt,4,1,"ng-container",5),a.ALo(2,"async"),a.BQk()),2&n){const e=a.oxw();a.xp6(1),a.Q6J("ngIf",a.lcZ(2,1,e.userData$))}}function Tlt(n,t){1&n&&(a.TgZ(0,"a",13)(1,"span"),a._uU(2,"Login"),a.qZA(),a.TgZ(3,"mat-icon"),a._uU(4,"login"),a.qZA()())}const Slt=function(n){return["/profile",n]};function Elt(n,t){if(1&n){const e=a.EpF();a.ynx(0),a.TgZ(1,"span",14),a._uU(2),a.qZA(),a.TgZ(3,"button",15)(4,"mat-icon"),a._uU(5,"account_circle"),a.qZA()(),a.TgZ(6,"mat-menu",null,16)(8,"button",17),a._uU(9),a.qZA(),a.TgZ(10,"button",18),a._uU(11," Profile "),a.qZA(),a.TgZ(12,"button",19),a.NdJ("click",function(){a.CHM(e);const i=a.oxw(2);return a.KtG(i.logout())}),a._uU(13,"Log out"),a.qZA()(),a.BQk()}if(2&n){const e=t.ngIf,r=a.MAs(7),i=a.oxw(2);a.xp6(2),a.hij("",i.capitalizeFirstLetter(e.role)," account"),a.xp6(1),a.Q6J("matMenuTriggerFor",r),a.xp6(6),a.hij(" ",i.getUserFullName(e.firstName,e.lastName)," "),a.xp6(1),a.Q6J("routerLink",a.VKq(4,Slt,i.userId))}}function Dlt(n,t){if(1&n&&(a.ynx(0),a.YNc(1,Elt,14,6,"ng-container",5),a.ALo(2,"async"),a.BQk()),2&n){const e=a.oxw();a.xp6(1),a.Q6J("ngIf",a.lcZ(2,1,e.userData$))}}let klt=(()=>{class n{constructor(e,r,i){this.authService=e,this.userService=r,this.router=i,this.isAuthenticated=!1,this.userId=null,this.userSub=new kn.w0,this.userData$=new Cr.y}ngOnInit(){this.userSub=this.authService.user.subscribe(e=>{this.isAuthenticated=!!e,this.userId=e?e.id:null,this.userId&&(this.userData$=this.userService.getUserData(this.userId))})}ngOnDestroy(){this.userSub.unsubscribe()}logout(){this.authService.logout(),this.router.navigate([""])}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}getUserFullName(e,r){return e&&r&&e.length>0&&r.length>0?`${r} ${e}`:"Add your name in your profile"}}return n.\u0275fac=function(e){return new(e||n)(a.Y36(tu),a.Y36(Xg),a.Y36(jr))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-navbar"]],decls:25,vars:3,consts:[["color","primary"],[1,"container","d-flex"],["mat-button","","routerLink","/",1,"fs-4"],[1,"me-1"],["mat-button","","routerLink","medics"],[4,"ngIf"],["mat-button","","routerLink","about"],[1,"spacer"],["mat-button","","routerLink","ai-photo-check"],["mat-button","","routerLink","contact"],["mat-button","","routerLink","authenticate",4,"ngIf"],["mat-button","","routerLink","appointments"],["mat-button","","routerLink","schedule"],["mat-button","","routerLink","authenticate"],[1,"user-info"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","","disabled",""],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"]],template:function(e,r){1&e&&(a.TgZ(0,"mat-toolbar",0)(1,"div",1)(2,"a",2)(3,"mat-icon",3),a._uU(4,"monitor_heart"),a.qZA(),a.TgZ(5,"span"),a._uU(6,"MedVision"),a.qZA()(),a.TgZ(7,"a",4),a._uU(8,"Medics"),a.qZA(),a.YNc(9,Ilt,3,3,"ng-container",5),a.TgZ(10,"a",6),a._uU(11,"About"),a.qZA(),a._UZ(12,"span",7),a.TgZ(13,"a",8)(14,"span"),a._uU(15,"Skin Lesion Analyser"),a.qZA(),a.TgZ(16,"mat-icon"),a._uU(17,"cloud_upload"),a.qZA()(),a.TgZ(18,"a",9)(19,"span"),a._uU(20,"Contact"),a.qZA(),a.TgZ(21,"mat-icon"),a._uU(22,"call"),a.qZA()(),a.YNc(23,Tlt,5,0,"a",10),a.YNc(24,Dlt,3,3,"ng-container",5),a.qZA()()),2&e&&(a.xp6(9),a.Q6J("ngIf",r.isAuthenticated),a.xp6(14),a.Q6J("ngIf",!r.isAuthenticated),a.xp6(1),a.Q6J("ngIf",r.isAuthenticated))},dependencies:[Ur,X$,V1,js,fse,td,Doe,w1,Noe,MMe,Oh],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.container[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{border-radius:2px;display:flex;align-items:center;justify-content:center}mat-icon[_ngcontent-%COMP%]{font-size:inherit;display:inline-flex;align-items:center;justify-content:center}.user-info[_ngcontent-%COMP%]{color:color-mix(in srgb,#fff 60%,transparent);font-size:.8rem;line-height:37px;display:flex;align-items:center;font-style:italic}"]}),n})(),Alt=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-footer"]],decls:19,vars:0,consts:[[1,"container"],[1,"d-flex","justify-content-between","align-items-center"],[1,"col-md-4","text-start"],[1,"col-md-4","text-wrap"],[1,"col-md-4","d-flex","gap-2","justify-content-end"],["routerLink","/"],["routerLink","medics"],["routerLink","appointments"],["routerLink","contact"],["routerLink","about"]],template:function(e,r){1&e&&(a.TgZ(0,"footer")(1,"div",0),a._UZ(2,"hr"),a.TgZ(3,"div",1)(4,"p",2),a._uU(5,"\xa9 2024 Popescu Stefan-Tudor"),a.qZA(),a.TgZ(6,"p",3),a._uU(7," MedVision - Revolutionizing Healthcare with AI-Driven Skin Cancer Detection and Seamless Appointments "),a.qZA(),a.TgZ(8,"div",4)(9,"a",5),a._uU(10,"Home"),a.qZA(),a.TgZ(11,"a",6),a._uU(12,"Medics"),a.qZA(),a.TgZ(13,"a",7),a._uU(14,"Appointments"),a.qZA(),a.TgZ(15,"a",8),a._uU(16,"Contact"),a.qZA(),a.TgZ(17,"a",9),a._uU(18,"About"),a.qZA()()()()())},dependencies:[V1],styles:["footer[_ngcontent-%COMP%]{background-color:var(--primary);color:color-mix(in srgb,#fff 80%,transparent);padding:20px 0;text-align:center;bottom:0;width:100%}a[_ngcontent-%COMP%]{text-decoration:none;color:inherit}a[_ngcontent-%COMP%]:hover{color:#fff;transition:all .1s ease-in-out}"]}),n})(),Nlt=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-root"]],decls:6,vars:0,consts:[["id","page-container"],["id","content-wrap"],["id","footer-div"]],template:function(e,r){1&e&&(a.TgZ(0,"div",0)(1,"div",1),a._UZ(2,"app-navbar")(3,"router-outlet"),a.qZA(),a.TgZ(4,"div",2),a._UZ(5,"app-footer"),a.qZA()())},dependencies:[C5,klt,Alt],styles:["#page-container[_ngcontent-%COMP%]{position:relative;min-height:100vh}#content-wrap[_ngcontent-%COMP%]{padding-bottom:8.5rem}#footer-div[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%;height:8.5rem}"]}),n})(),Rlt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n,bootstrap:[Nlt]}),n.\u0275inj=a.cJS({providers:[{provide:nse,useValue:"en-GB"},{provide:n$,useClass:gDe},ra,{provide:Ki.Dh,useValue:VL.firebase}],imports:[rm,wlt,yU,jMe,vE,nz,tO,vE,jbe,xTe,dEe,kbe(()=>{const t=new bG(VL.recaptchaV3SiteKey);return Abe(void 0,{provider:t,isTokenAutoRefreshEnabled:!0})}),Pve(()=>Lve(VL.firebase))]}),n})();VL.production&&(0,a.G48)(),WR().bootstrapModule(Rlt).catch(n=>console.error(n))},7658:kt=>{kt.exports=z;var et=null;try{et=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function z(he,J,a){this.low=0|he,this.high=0|J,this.unsigned=!!a}function B(he){return!0===(he&&he.__isLong__)}Object.defineProperty(z.prototype,"__isLong__",{value:!0}),z.isLong=B;var Ee={},te={};function He(he,J){var a,Ft,Wt;return J?(Wt=0<=(he>>>=0)&&he<256)&&(Ft=te[he])?Ft:(a=Re(he,(0|he)<0?-1:0,!0),Wt&&(te[he]=a),a):(Wt=-128<=(he|=0)&&he<128)&&(Ft=Ee[he])?Ft:(a=Re(he,he<0?-1:0,!1),Wt&&(Ee[he]=a),a)}function je(he,J){if(isNaN(he))return J?$e:Dt;if(J){if(he<0)return $e;if(he>=Ce)return Pe}else{if(he<=-Ue)return Oe;if(he+1>=Ue)return nt}return he<0?je(-he,J).neg():Re(he%X|0,he/X|0,J)}function Re(he,J,a){return new z(he,J,a)}z.fromInt=He,z.fromNumber=je,z.fromBits=Re;var tt=Math.pow;function Ne(he,J,a){if(0===he.length)throw Error("empty string");if("NaN"===he||"Infinity"===he||"+Infinity"===he||"-Infinity"===he)return Dt;if("number"==typeof J?(a=J,J=!1):J=!!J,(a=a||10)<2||36<a)throw RangeError("radix");var Ft;if((Ft=he.indexOf("-"))>0)throw Error("interior hyphen");if(0===Ft)return Ne(he.substring(1),J,a).neg();for(var Wt=je(tt(a,8)),bn=Dt,Gn=0;Gn<he.length;Gn+=8){var Sr=Math.min(8,he.length-Gn),Nt=parseInt(he.substring(Gn,Gn+Sr),a);if(Sr<8){var Or=je(tt(a,Sr));bn=bn.mul(Or).add(je(Nt))}else bn=(bn=bn.mul(Wt)).add(je(Nt))}return bn.unsigned=J,bn}function ne(he,J){return"number"==typeof he?je(he,J):"string"==typeof he?Ne(he,J):Re(he.low,he.high,"boolean"==typeof J?J:he.unsigned)}z.fromString=Ne,z.fromValue=ne;var X=4294967296,Ce=X*X,Ue=Ce/2,Ae=He(1<<24),Dt=He(0);z.ZERO=Dt;var $e=He(0,!0);z.UZERO=$e;var Je=He(1);z.ONE=Je;var Gt=He(1,!0);z.UONE=Gt;var an=He(-1);z.NEG_ONE=an;var nt=Re(-1,2147483647,!1);z.MAX_VALUE=nt;var Pe=Re(-1,-1,!0);z.MAX_UNSIGNED_VALUE=Pe;var Oe=Re(0,-2147483648,!1);z.MIN_VALUE=Oe;var be=z.prototype;be.toInt=function(){return this.unsigned?this.low>>>0:this.low},be.toNumber=function(){return this.unsigned?(this.high>>>0)*X+(this.low>>>0):this.high*X+(this.low>>>0)},be.toString=function(J){if((J=J||10)<2||36<J)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Oe)){var a=je(J),Ft=this.div(a),Wt=Ft.mul(a).sub(this);return Ft.toString(J)+Wt.toInt().toString(J)}return"-"+this.neg().toString(J)}for(var bn=je(tt(J,6),this.unsigned),Gn=this,Sr="";;){var Nt=Gn.div(bn),vr=(Gn.sub(Nt.mul(bn)).toInt()>>>0).toString(J);if((Gn=Nt).isZero())return vr+Sr;for(;vr.length<6;)vr="0"+vr;Sr=""+vr+Sr}},be.getHighBits=function(){return this.high},be.getHighBitsUnsigned=function(){return this.high>>>0},be.getLowBits=function(){return this.low},be.getLowBitsUnsigned=function(){return this.low>>>0},be.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Oe)?64:this.neg().getNumBitsAbs();for(var J=0!=this.high?this.high:this.low,a=31;a>0&&0==(J&1<<a);a--);return 0!=this.high?a+33:a+1},be.isZero=function(){return 0===this.high&&0===this.low},be.eqz=be.isZero,be.isNegative=function(){return!this.unsigned&&this.high<0},be.isPositive=function(){return this.unsigned||this.high>=0},be.isOdd=function(){return 1==(1&this.low)},be.isEven=function(){return 0==(1&this.low)},be.equals=function(J){return B(J)||(J=ne(J)),(this.unsigned===J.unsigned||this.high>>>31!=1||J.high>>>31!=1)&&this.high===J.high&&this.low===J.low},be.eq=be.equals,be.notEquals=function(J){return!this.eq(J)},be.neq=be.notEquals,be.ne=be.notEquals,be.lessThan=function(J){return this.comp(J)<0},be.lt=be.lessThan,be.lessThanOrEqual=function(J){return this.comp(J)<=0},be.lte=be.lessThanOrEqual,be.le=be.lessThanOrEqual,be.greaterThan=function(J){return this.comp(J)>0},be.gt=be.greaterThan,be.greaterThanOrEqual=function(J){return this.comp(J)>=0},be.gte=be.greaterThanOrEqual,be.ge=be.greaterThanOrEqual,be.compare=function(J){if(B(J)||(J=ne(J)),this.eq(J))return 0;var a=this.isNegative(),Ft=J.isNegative();return a&&!Ft?-1:!a&&Ft?1:this.unsigned?J.high>>>0>this.high>>>0||J.high===this.high&&J.low>>>0>this.low>>>0?-1:1:this.sub(J).isNegative()?-1:1},be.comp=be.compare,be.negate=function(){return!this.unsigned&&this.eq(Oe)?Oe:this.not().add(Je)},be.neg=be.negate,be.add=function(J){B(J)||(J=ne(J));var vr=0,sr=0,un=0,ke=0;return un+=(ke+=(65535&this.low)+(65535&J.low))>>>16,sr+=(un+=(this.low>>>16)+(J.low>>>16))>>>16,vr+=(sr+=(65535&this.high)+(65535&J.high))>>>16,vr+=(this.high>>>16)+(J.high>>>16),Re((un&=65535)<<16|(ke&=65535),(vr&=65535)<<16|(sr&=65535),this.unsigned)},be.subtract=function(J){return B(J)||(J=ne(J)),this.add(J.neg())},be.sub=be.subtract,be.multiply=function(J){if(this.isZero())return Dt;if(B(J)||(J=ne(J)),et)return Re(et.mul(this.low,this.high,J.low,J.high),et.get_high(),this.unsigned);if(J.isZero())return Dt;if(this.eq(Oe))return J.isOdd()?Oe:Dt;if(J.eq(Oe))return this.isOdd()?Oe:Dt;if(this.isNegative())return J.isNegative()?this.neg().mul(J.neg()):this.neg().mul(J).neg();if(J.isNegative())return this.mul(J.neg()).neg();if(this.lt(Ae)&&J.lt(Ae))return je(this.toNumber()*J.toNumber(),this.unsigned);var Wt=65535&this.high,bn=this.low>>>16,Gn=65535&this.low,Nt=65535&J.high,Or=J.low>>>16,vr=65535&J.low,sr=0,un=0,ke=0,qe=0;return ke+=(qe+=Gn*vr)>>>16,un+=(ke+=bn*vr)>>>16,ke&=65535,un+=(ke+=Gn*Or)>>>16,sr+=(un+=Wt*vr)>>>16,un&=65535,sr+=(un+=bn*Or)>>>16,un&=65535,sr+=(un+=Gn*Nt)>>>16,sr+=(this.high>>>16)*vr+Wt*Or+bn*Nt+Gn*(J.high>>>16),Re((ke&=65535)<<16|(qe&=65535),(sr&=65535)<<16|(un&=65535),this.unsigned)},be.mul=be.multiply,be.divide=function(J){if(B(J)||(J=ne(J)),J.isZero())throw Error("division by zero");var Ft,Wt,bn;if(et)return this.unsigned||-2147483648!==this.high||-1!==J.low||-1!==J.high?Re((this.unsigned?et.div_u:et.div_s)(this.low,this.high,J.low,J.high),et.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?$e:Dt;if(this.unsigned){if(J.unsigned||(J=J.toUnsigned()),J.gt(this))return $e;if(J.gt(this.shru(1)))return Gt;bn=$e}else{if(this.eq(Oe))return J.eq(Je)||J.eq(an)?Oe:J.eq(Oe)?Je:(Ft=this.shr(1).div(J).shl(1)).eq(Dt)?J.isNegative()?Je:an:(Wt=this.sub(J.mul(Ft)),bn=Ft.add(Wt.div(J)));if(J.eq(Oe))return this.unsigned?$e:Dt;if(this.isNegative())return J.isNegative()?this.neg().div(J.neg()):this.neg().div(J).neg();if(J.isNegative())return this.div(J.neg()).neg();bn=Dt}for(Wt=this;Wt.gte(J);){Ft=Math.max(1,Math.floor(Wt.toNumber()/J.toNumber()));for(var Sr=Math.ceil(Math.log(Ft)/Math.LN2),Nt=Sr<=48?1:tt(2,Sr-48),Or=je(Ft),vr=Or.mul(J);vr.isNegative()||vr.gt(Wt);)vr=(Or=je(Ft-=Nt,this.unsigned)).mul(J);Or.isZero()&&(Or=Je),bn=bn.add(Or),Wt=Wt.sub(vr)}return bn},be.div=be.divide,be.modulo=function(J){return B(J)||(J=ne(J)),et?Re((this.unsigned?et.rem_u:et.rem_s)(this.low,this.high,J.low,J.high),et.get_high(),this.unsigned):this.sub(this.div(J).mul(J))},be.mod=be.modulo,be.rem=be.modulo,be.not=function(){return Re(~this.low,~this.high,this.unsigned)},be.and=function(J){return B(J)||(J=ne(J)),Re(this.low&J.low,this.high&J.high,this.unsigned)},be.or=function(J){return B(J)||(J=ne(J)),Re(this.low|J.low,this.high|J.high,this.unsigned)},be.xor=function(J){return B(J)||(J=ne(J)),Re(this.low^J.low,this.high^J.high,this.unsigned)},be.shiftLeft=function(J){return B(J)&&(J=J.toInt()),0==(J&=63)?this:J<32?Re(this.low<<J,this.high<<J|this.low>>>32-J,this.unsigned):Re(0,this.low<<J-32,this.unsigned)},be.shl=be.shiftLeft,be.shiftRight=function(J){return B(J)&&(J=J.toInt()),0==(J&=63)?this:J<32?Re(this.low>>>J|this.high<<32-J,this.high>>J,this.unsigned):Re(this.high>>J-32,this.high>=0?0:-1,this.unsigned)},be.shr=be.shiftRight,be.shiftRightUnsigned=function(J){if(B(J)&&(J=J.toInt()),0==(J&=63))return this;var a=this.high;return J<32?Re(this.low>>>J|a<<32-J,a>>>J,this.unsigned):Re(32===J?a:a>>>J-32,0,this.unsigned)},be.shru=be.shiftRightUnsigned,be.shr_u=be.shiftRightUnsigned,be.toSigned=function(){return this.unsigned?Re(this.low,this.high,!1):this},be.toUnsigned=function(){return this.unsigned?this:Re(this.low,this.high,!0)},be.toBytes=function(J){return J?this.toBytesLE():this.toBytesBE()},be.toBytesLE=function(){var J=this.high,a=this.low;return[255&a,a>>>8&255,a>>>16&255,a>>>24,255&J,J>>>8&255,J>>>16&255,J>>>24]},be.toBytesBE=function(){var J=this.high,a=this.low;return[J>>>24,J>>>16&255,J>>>8&255,255&J,a>>>24,a>>>16&255,a>>>8&255,255&a]},z.fromBytes=function(J,a,Ft){return Ft?z.fromBytesLE(J,a):z.fromBytesBE(J,a)},z.fromBytesLE=function(J,a){return new z(J[0]|J[1]<<8|J[2]<<16|J[3]<<24,J[4]|J[5]<<8|J[6]<<16|J[7]<<24,a)},z.fromBytesBE=function(J,a){return new z(J[4]<<24|J[5]<<16|J[6]<<8|J[7],J[0]<<24|J[1]<<16|J[2]<<8|J[3],a)}},9751:(kt,et,z)=>{"use strict";z.d(et,{y:()=>Ne});var B=z(930),Ee=z(727),te=z(8822),He=z(9635),je=z(2416),Re=z(576),tt=z(2806);let Ne=(()=>{class X{constructor(Ue){Ue&&(this._subscribe=Ue)}lift(Ue){const Ae=new X;return Ae.source=this,Ae.operator=Ue,Ae}subscribe(Ue,Ae,Dt){const $e=function ee(X){return X&&X instanceof B.Lv||function K(X){return X&&(0,Re.m)(X.next)&&(0,Re.m)(X.error)&&(0,Re.m)(X.complete)}(X)&&(0,Ee.Nn)(X)}(Ue)?Ue:new B.Hp(Ue,Ae,Dt);return(0,tt.x)(()=>{const{operator:Je,source:Gt}=this;$e.add(Je?Je.call($e,Gt):Gt?this._subscribe($e):this._trySubscribe($e))}),$e}_trySubscribe(Ue){try{return this._subscribe(Ue)}catch(Ae){Ue.error(Ae)}}forEach(Ue,Ae){return new(Ae=ne(Ae))((Dt,$e)=>{const Je=new B.Hp({next:Gt=>{try{Ue(Gt)}catch(an){$e(an),Je.unsubscribe()}},error:$e,complete:Dt});this.subscribe(Je)})}_subscribe(Ue){var Ae;return null===(Ae=this.source)||void 0===Ae?void 0:Ae.subscribe(Ue)}[te.L](){return this}pipe(...Ue){return(0,He.U)(Ue)(this)}toPromise(Ue){return new(Ue=ne(Ue))((Ae,Dt)=>{let $e;this.subscribe(Je=>$e=Je,Je=>Dt(Je),()=>Ae($e))})}}return X.create=Ce=>new X(Ce),X})();function ne(X){var Ce;return null!==(Ce=X??je.v.Promise)&&void 0!==Ce?Ce:Promise}},7579:(kt,et,z)=>{"use strict";z.d(et,{x:()=>tt});var B=z(9751),Ee=z(727);const He=(0,z(3888).d)(ne=>function(){ne(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var je=z(8737),Re=z(2806);let tt=(()=>{class ne extends B.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ee){const X=new Ne(this,this);return X.operator=ee,X}_throwIfClosed(){if(this.closed)throw new He}next(ee){(0,Re.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const X of this.currentObservers)X.next(ee)}})}error(ee){(0,Re.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ee;const{observers:X}=this;for(;X.length;)X.shift().error(ee)}})}complete(){(0,Re.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ee}=this;for(;ee.length;)ee.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var ee;return(null===(ee=this.observers)||void 0===ee?void 0:ee.length)>0}_trySubscribe(ee){return this._throwIfClosed(),super._trySubscribe(ee)}_subscribe(ee){return this._throwIfClosed(),this._checkFinalizedStatuses(ee),this._innerSubscribe(ee)}_innerSubscribe(ee){const{hasError:X,isStopped:Ce,observers:Ue}=this;return X||Ce?Ee.Lc:(this.currentObservers=null,Ue.push(ee),new Ee.w0(()=>{this.currentObservers=null,(0,je.P)(Ue,ee)}))}_checkFinalizedStatuses(ee){const{hasError:X,thrownError:Ce,isStopped:Ue}=this;X?ee.error(Ce):Ue&&ee.complete()}asObservable(){const ee=new B.y;return ee.source=this,ee}}return ne.create=(K,ee)=>new Ne(K,ee),ne})();class Ne extends tt{constructor(K,ee){super(),this.destination=K,this.source=ee}next(K){var ee,X;null===(X=null===(ee=this.destination)||void 0===ee?void 0:ee.next)||void 0===X||X.call(ee,K)}error(K){var ee,X;null===(X=null===(ee=this.destination)||void 0===ee?void 0:ee.error)||void 0===X||X.call(ee,K)}complete(){var K,ee;null===(ee=null===(K=this.destination)||void 0===K?void 0:K.complete)||void 0===ee||ee.call(K)}_subscribe(K){var ee,X;return null!==(X=null===(ee=this.source)||void 0===ee?void 0:ee.subscribe(K))&&void 0!==X?X:Ee.Lc}}},930:(kt,et,z)=>{"use strict";z.d(et,{Hp:()=>Dt,Lv:()=>X});var B=z(576),Ee=z(727),te=z(2416),He=z(7849),je=z(5032);const Re=ne("C",void 0,void 0);function ne(nt,Pe,Oe){return{kind:nt,value:Pe,error:Oe}}var K=z(3410),ee=z(2806);class X extends Ee.w0{constructor(Pe){super(),this.isStopped=!1,Pe?(this.destination=Pe,(0,Ee.Nn)(Pe)&&Pe.add(this)):this.destination=an}static create(Pe,Oe,be){return new Dt(Pe,Oe,be)}next(Pe){this.isStopped?Gt(function Ne(nt){return ne("N",nt,void 0)}(Pe),this):this._next(Pe)}error(Pe){this.isStopped?Gt(function tt(nt){return ne("E",void 0,nt)}(Pe),this):(this.isStopped=!0,this._error(Pe))}complete(){this.isStopped?Gt(Re,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Pe){this.destination.next(Pe)}_error(Pe){try{this.destination.error(Pe)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ce=Function.prototype.bind;function Ue(nt,Pe){return Ce.call(nt,Pe)}class Ae{constructor(Pe){this.partialObserver=Pe}next(Pe){const{partialObserver:Oe}=this;if(Oe.next)try{Oe.next(Pe)}catch(be){$e(be)}}error(Pe){const{partialObserver:Oe}=this;if(Oe.error)try{Oe.error(Pe)}catch(be){$e(be)}else $e(Pe)}complete(){const{partialObserver:Pe}=this;if(Pe.complete)try{Pe.complete()}catch(Oe){$e(Oe)}}}class Dt extends X{constructor(Pe,Oe,be){let he;if(super(),(0,B.m)(Pe)||!Pe)he={next:Pe??void 0,error:Oe??void 0,complete:be??void 0};else{let J;this&&te.v.useDeprecatedNextContext?(J=Object.create(Pe),J.unsubscribe=()=>this.unsubscribe(),he={next:Pe.next&&Ue(Pe.next,J),error:Pe.error&&Ue(Pe.error,J),complete:Pe.complete&&Ue(Pe.complete,J)}):he=Pe}this.destination=new Ae(he)}}function $e(nt){te.v.useDeprecatedSynchronousErrorHandling?(0,ee.O)(nt):(0,He.h)(nt)}function Gt(nt,Pe){const{onStoppedNotification:Oe}=te.v;Oe&&K.z.setTimeout(()=>Oe(nt,Pe))}const an={closed:!0,next:je.Z,error:function Je(nt){throw nt},complete:je.Z}},727:(kt,et,z)=>{"use strict";z.d(et,{Lc:()=>Re,w0:()=>je,Nn:()=>tt});var B=z(576);const te=(0,z(3888).d)(ne=>function(ee){ne(this),this.message=ee?`${ee.length} errors occurred during unsubscription:\n${ee.map((X,Ce)=>`${Ce+1}) ${X.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ee});var He=z(8737);class je{constructor(K){this.initialTeardown=K,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let K;if(!this.closed){this.closed=!0;const{_parentage:ee}=this;if(ee)if(this._parentage=null,Array.isArray(ee))for(const Ue of ee)Ue.remove(this);else ee.remove(this);const{initialTeardown:X}=this;if((0,B.m)(X))try{X()}catch(Ue){K=Ue instanceof te?Ue.errors:[Ue]}const{_finalizers:Ce}=this;if(Ce){this._finalizers=null;for(const Ue of Ce)try{Ne(Ue)}catch(Ae){K=K??[],Ae instanceof te?K=[...K,...Ae.errors]:K.push(Ae)}}if(K)throw new te(K)}}add(K){var ee;if(K&&K!==this)if(this.closed)Ne(K);else{if(K instanceof je){if(K.closed||K._hasParent(this))return;K._addParent(this)}(this._finalizers=null!==(ee=this._finalizers)&&void 0!==ee?ee:[]).push(K)}}_hasParent(K){const{_parentage:ee}=this;return ee===K||Array.isArray(ee)&&ee.includes(K)}_addParent(K){const{_parentage:ee}=this;this._parentage=Array.isArray(ee)?(ee.push(K),ee):ee?[ee,K]:K}_removeParent(K){const{_parentage:ee}=this;ee===K?this._parentage=null:Array.isArray(ee)&&(0,He.P)(ee,K)}remove(K){const{_finalizers:ee}=this;ee&&(0,He.P)(ee,K),K instanceof je&&K._removeParent(this)}}je.EMPTY=(()=>{const ne=new je;return ne.closed=!0,ne})();const Re=je.EMPTY;function tt(ne){return ne instanceof je||ne&&"closed"in ne&&(0,B.m)(ne.remove)&&(0,B.m)(ne.add)&&(0,B.m)(ne.unsubscribe)}function Ne(ne){(0,B.m)(ne)?ne():ne.unsubscribe()}},2416:(kt,et,z)=>{"use strict";z.d(et,{v:()=>B});const B={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(kt,et,z)=>{"use strict";z.d(et,{E:()=>Ee});const Ee=new(z(9751).y)(je=>je.complete())},8996:(kt,et,z)=>{"use strict";z.d(et,{D:()=>Pe});var B=z(8421),Ee=z(5363),te=z(9468),Re=z(9751),Ne=z(2202),ne=z(576),K=z(9672);function X(Oe,be){if(!Oe)throw new Error("Iterable cannot be null");return new Re.y(he=>{(0,K.f)(he,be,()=>{const J=Oe[Symbol.asyncIterator]();(0,K.f)(he,be,()=>{J.next().then(a=>{a.done?he.complete():he.next(a.value)})},0,!0)})})}var Ce=z(3670),Ue=z(8239),Ae=z(1144),Dt=z(6495),$e=z(2206),Je=z(4532),Gt=z(3260);function Pe(Oe,be){return be?function nt(Oe,be){if(null!=Oe){if((0,Ce.c)(Oe))return function He(Oe,be){return(0,B.Xf)(Oe).pipe((0,te.R)(be),(0,Ee.Q)(be))}(Oe,be);if((0,Ae.z)(Oe))return function tt(Oe,be){return new Re.y(he=>{let J=0;return be.schedule(function(){J===Oe.length?he.complete():(he.next(Oe[J++]),he.closed||this.schedule())})})}(Oe,be);if((0,Ue.t)(Oe))return function je(Oe,be){return(0,B.Xf)(Oe).pipe((0,te.R)(be),(0,Ee.Q)(be))}(Oe,be);if((0,$e.D)(Oe))return X(Oe,be);if((0,Dt.T)(Oe))return function ee(Oe,be){return new Re.y(he=>{let J;return(0,K.f)(he,be,()=>{J=Oe[Ne.h](),(0,K.f)(he,be,()=>{let a,Ft;try{({value:a,done:Ft}=J.next())}catch(Wt){return void he.error(Wt)}Ft?he.complete():he.next(a)},0,!0)}),()=>(0,ne.m)(J?.return)&&J.return()})}(Oe,be);if((0,Gt.L)(Oe))return function an(Oe,be){return X((0,Gt.Q)(Oe),be)}(Oe,be)}throw(0,Je.z)(Oe)}(Oe,be):(0,B.Xf)(Oe)}},8421:(kt,et,z)=>{"use strict";z.d(et,{Xf:()=>Ce});var B=z(7582),Ee=z(1144),te=z(8239),He=z(9751),je=z(3670),Re=z(2206),tt=z(4532),Ne=z(6495),ne=z(3260),K=z(576),ee=z(7849),X=z(8822);function Ce(nt){if(nt instanceof He.y)return nt;if(null!=nt){if((0,je.c)(nt))return function Ue(nt){return new He.y(Pe=>{const Oe=nt[X.L]();if((0,K.m)(Oe.subscribe))return Oe.subscribe(Pe);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(nt);if((0,Ee.z)(nt))return function Ae(nt){return new He.y(Pe=>{for(let Oe=0;Oe<nt.length&&!Pe.closed;Oe++)Pe.next(nt[Oe]);Pe.complete()})}(nt);if((0,te.t)(nt))return function Dt(nt){return new He.y(Pe=>{nt.then(Oe=>{Pe.closed||(Pe.next(Oe),Pe.complete())},Oe=>Pe.error(Oe)).then(null,ee.h)})}(nt);if((0,Re.D)(nt))return Je(nt);if((0,Ne.T)(nt))return function $e(nt){return new He.y(Pe=>{for(const Oe of nt)if(Pe.next(Oe),Pe.closed)return;Pe.complete()})}(nt);if((0,ne.L)(nt))return function Gt(nt){return Je((0,ne.Q)(nt))}(nt)}throw(0,tt.z)(nt)}function Je(nt){return new He.y(Pe=>{(function an(nt,Pe){var Oe,be,he,J;return(0,B.mG)(this,void 0,void 0,function*(){try{for(Oe=(0,B.KL)(nt);!(be=yield Oe.next()).done;)if(Pe.next(be.value),Pe.closed)return}catch(a){he={error:a}}finally{try{be&&!be.done&&(J=Oe.return)&&(yield J.call(Oe))}finally{if(he)throw he.error}}Pe.complete()})})(nt,Pe).catch(Oe=>Pe.error(Oe))})}},6451:(kt,et,z)=>{"use strict";z.d(et,{T:()=>Re});var B=z(8189),Ee=z(8421),te=z(515),He=z(3269),je=z(8996);function Re(...tt){const Ne=(0,He.yG)(tt),ne=(0,He._6)(tt,1/0),K=tt;return K.length?1===K.length?(0,Ee.Xf)(K[0]):(0,B.J)(ne)((0,je.D)(K,Ne)):te.E}},5403:(kt,et,z)=>{"use strict";z.d(et,{x:()=>Ee});var B=z(930);function Ee(He,je,Re,tt,Ne){return new te(He,je,Re,tt,Ne)}class te extends B.Lv{constructor(je,Re,tt,Ne,ne,K){super(je),this.onFinalize=ne,this.shouldUnsubscribe=K,this._next=Re?function(ee){try{Re(ee)}catch(X){je.error(X)}}:super._next,this._error=Ne?function(ee){try{Ne(ee)}catch(X){je.error(X)}finally{this.unsubscribe()}}:super._error,this._complete=tt?function(){try{tt()}catch(ee){je.error(ee)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var je;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Re}=this;super.unsubscribe(),!Re&&(null===(je=this.onFinalize)||void 0===je||je.call(this))}}}},4004:(kt,et,z)=>{"use strict";z.d(et,{U:()=>te});var B=z(4482),Ee=z(5403);function te(He,je){return(0,B.e)((Re,tt)=>{let Ne=0;Re.subscribe((0,Ee.x)(tt,ne=>{tt.next(He.call(je,ne,Ne++))}))})}},8189:(kt,et,z)=>{"use strict";z.d(et,{J:()=>te});var B=z(5577),Ee=z(4671);function te(He=1/0){return(0,B.z)(Ee.y,He)}},5577:(kt,et,z)=>{"use strict";z.d(et,{z:()=>Ne});var B=z(4004),Ee=z(8421),te=z(4482),He=z(9672),je=z(5403),tt=z(576);function Ne(ne,K,ee=1/0){return(0,tt.m)(K)?Ne((X,Ce)=>(0,B.U)((Ue,Ae)=>K(X,Ue,Ce,Ae))((0,Ee.Xf)(ne(X,Ce))),ee):("number"==typeof K&&(ee=K),(0,te.e)((X,Ce)=>function Re(ne,K,ee,X,Ce,Ue,Ae,Dt){const $e=[];let Je=0,Gt=0,an=!1;const nt=()=>{an&&!$e.length&&!Je&&K.complete()},Pe=be=>Je<X?Oe(be):$e.push(be),Oe=be=>{Ue&&K.next(be),Je++;let he=!1;(0,Ee.Xf)(ee(be,Gt++)).subscribe((0,je.x)(K,J=>{Ce?.(J),Ue?Pe(J):K.next(J)},()=>{he=!0},void 0,()=>{if(he)try{for(Je--;$e.length&&Je<X;){const J=$e.shift();Ae?(0,He.f)(K,Ae,()=>Oe(J)):Oe(J)}nt()}catch(J){K.error(J)}}))};return ne.subscribe((0,je.x)(K,Pe,()=>{an=!0,nt()})),()=>{Dt?.()}}(X,Ce,ne,ee)))}},5363:(kt,et,z)=>{"use strict";z.d(et,{Q:()=>He});var B=z(9672),Ee=z(4482),te=z(5403);function He(je,Re=0){return(0,Ee.e)((tt,Ne)=>{tt.subscribe((0,te.x)(Ne,ne=>(0,B.f)(Ne,je,()=>Ne.next(ne),Re),()=>(0,B.f)(Ne,je,()=>Ne.complete(),Re),ne=>(0,B.f)(Ne,je,()=>Ne.error(ne),Re)))})}},3099:(kt,et,z)=>{"use strict";z.d(et,{B:()=>je});var B=z(8421),Ee=z(7579),te=z(930),He=z(4482);function je(tt={}){const{connector:Ne=(()=>new Ee.x),resetOnError:ne=!0,resetOnComplete:K=!0,resetOnRefCountZero:ee=!0}=tt;return X=>{let Ce,Ue,Ae,Dt=0,$e=!1,Je=!1;const Gt=()=>{Ue?.unsubscribe(),Ue=void 0},an=()=>{Gt(),Ce=Ae=void 0,$e=Je=!1},nt=()=>{const Pe=Ce;an(),Pe?.unsubscribe()};return(0,He.e)((Pe,Oe)=>{Dt++,!Je&&!$e&&Gt();const be=Ae=Ae??Ne();Oe.add(()=>{Dt--,0===Dt&&!Je&&!$e&&(Ue=Re(nt,ee))}),be.subscribe(Oe),!Ce&&Dt>0&&(Ce=new te.Hp({next:he=>be.next(he),error:he=>{Je=!0,Gt(),Ue=Re(an,ne,he),be.error(he)},complete:()=>{$e=!0,Gt(),Ue=Re(an,K),be.complete()}}),(0,B.Xf)(Pe).subscribe(Ce))})(X)}}function Re(tt,Ne,...ne){if(!0===Ne)return void tt();if(!1===Ne)return;const K=new te.Hp({next:()=>{K.unsubscribe(),tt()}});return Ne(...ne).subscribe(K)}},9468:(kt,et,z)=>{"use strict";z.d(et,{R:()=>Ee});var B=z(4482);function Ee(te,He=0){return(0,B.e)((je,Re)=>{Re.add(te.schedule(()=>je.subscribe(Re),He))})}},3410:(kt,et,z)=>{"use strict";z.d(et,{z:()=>B});const B={setTimeout(Ee,te,...He){const{delegate:je}=B;return je?.setTimeout?je.setTimeout(Ee,te,...He):setTimeout(Ee,te,...He)},clearTimeout(Ee){const{delegate:te}=B;return(te?.clearTimeout||clearTimeout)(Ee)},delegate:void 0}},2202:(kt,et,z)=>{"use strict";z.d(et,{h:()=>Ee});const Ee=function B(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(kt,et,z)=>{"use strict";z.d(et,{L:()=>B});const B="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(kt,et,z)=>{"use strict";z.d(et,{_6:()=>Re,jO:()=>He,yG:()=>je});var B=z(576),Ee=z(3532);function te(tt){return tt[tt.length-1]}function He(tt){return(0,B.m)(te(tt))?tt.pop():void 0}function je(tt){return(0,Ee.K)(te(tt))?tt.pop():void 0}function Re(tt,Ne){return"number"==typeof te(tt)?tt.pop():Ne}},8737:(kt,et,z)=>{"use strict";function B(Ee,te){if(Ee){const He=Ee.indexOf(te);0<=He&&Ee.splice(He,1)}}z.d(et,{P:()=>B})},3888:(kt,et,z)=>{"use strict";function B(Ee){const He=Ee(je=>{Error.call(je),je.stack=(new Error).stack});return He.prototype=Object.create(Error.prototype),He.prototype.constructor=He,He}z.d(et,{d:()=>B})},2806:(kt,et,z)=>{"use strict";z.d(et,{O:()=>He,x:()=>te});var B=z(2416);let Ee=null;function te(je){if(B.v.useDeprecatedSynchronousErrorHandling){const Re=!Ee;if(Re&&(Ee={errorThrown:!1,error:null}),je(),Re){const{errorThrown:tt,error:Ne}=Ee;if(Ee=null,tt)throw Ne}}else je()}function He(je){B.v.useDeprecatedSynchronousErrorHandling&&Ee&&(Ee.errorThrown=!0,Ee.error=je)}},9672:(kt,et,z)=>{"use strict";function B(Ee,te,He,je=0,Re=!1){const tt=te.schedule(function(){He(),Re?Ee.add(this.schedule(null,je)):this.unsubscribe()},je);if(Ee.add(tt),!Re)return tt}z.d(et,{f:()=>B})},4671:(kt,et,z)=>{"use strict";function B(Ee){return Ee}z.d(et,{y:()=>B})},1144:(kt,et,z)=>{"use strict";z.d(et,{z:()=>B});const B=Ee=>Ee&&"number"==typeof Ee.length&&"function"!=typeof Ee},2206:(kt,et,z)=>{"use strict";z.d(et,{D:()=>Ee});var B=z(576);function Ee(te){return Symbol.asyncIterator&&(0,B.m)(te?.[Symbol.asyncIterator])}},576:(kt,et,z)=>{"use strict";function B(Ee){return"function"==typeof Ee}z.d(et,{m:()=>B})},3670:(kt,et,z)=>{"use strict";z.d(et,{c:()=>te});var B=z(8822),Ee=z(576);function te(He){return(0,Ee.m)(He[B.L])}},6495:(kt,et,z)=>{"use strict";z.d(et,{T:()=>te});var B=z(2202),Ee=z(576);function te(He){return(0,Ee.m)(He?.[B.h])}},8239:(kt,et,z)=>{"use strict";z.d(et,{t:()=>Ee});var B=z(576);function Ee(te){return(0,B.m)(te?.then)}},3260:(kt,et,z)=>{"use strict";z.d(et,{L:()=>He,Q:()=>te});var B=z(7582),Ee=z(576);function te(je){return(0,B.FC)(this,arguments,function*(){const tt=je.getReader();try{for(;;){const{value:Ne,done:ne}=yield(0,B.qq)(tt.read());if(ne)return yield(0,B.qq)(void 0);yield yield(0,B.qq)(Ne)}}finally{tt.releaseLock()}})}function He(je){return(0,Ee.m)(je?.getReader)}},3532:(kt,et,z)=>{"use strict";z.d(et,{K:()=>Ee});var B=z(576);function Ee(te){return te&&(0,B.m)(te.schedule)}},4482:(kt,et,z)=>{"use strict";z.d(et,{A:()=>Ee,e:()=>te});var B=z(576);function Ee(He){return(0,B.m)(He?.lift)}function te(He){return je=>{if(Ee(je))return je.lift(function(Re){try{return He(Re,this)}catch(tt){this.error(tt)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(kt,et,z)=>{"use strict";function B(){}z.d(et,{Z:()=>B})},9635:(kt,et,z)=>{"use strict";z.d(et,{U:()=>te,z:()=>Ee});var B=z(4671);function Ee(...He){return te(He)}function te(He){return 0===He.length?B.y:1===He.length?He[0]:function(Re){return He.reduce((tt,Ne)=>Ne(tt),Re)}}},7849:(kt,et,z)=>{"use strict";z.d(et,{h:()=>te});var B=z(2416),Ee=z(3410);function te(He){Ee.z.setTimeout(()=>{const{onUnhandledError:je}=B.v;if(!je)throw He;je(He)})}},4532:(kt,et,z)=>{"use strict";function B(Ee){return new TypeError(`You provided ${null!==Ee&&"object"==typeof Ee?"an invalid object":`'${Ee}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}z.d(et,{z:()=>B})},340:(kt,et,z)=>{var B=z(9471),Ee=z(2992),te=z(7657),He=z(5583),je=z(1929),Re=z(8083),tt=z(3818);tt.alea=B,tt.xor128=Ee,tt.xorwow=te,tt.xorshift7=He,tt.xor4096=je,tt.tychei=Re,kt.exports=tt},9471:function(kt,et,z){var B;!function(Ee,te,He){function je(ne){var K=this,ee=function Ne(){var ne=4022871197;return function(ee){ee=String(ee);for(var X=0;X<ee.length;X++){var Ce=.02519603282416938*(ne+=ee.charCodeAt(X));Ce-=ne=Ce>>>0,ne=(Ce*=ne)>>>0,ne+=4294967296*(Ce-=ne)}return 2.3283064365386963e-10*(ne>>>0)}}();K.next=function(){var X=2091639*K.s0+2.3283064365386963e-10*K.c;return K.s0=K.s1,K.s1=K.s2,K.s2=X-(K.c=0|X)},K.c=1,K.s0=ee(" "),K.s1=ee(" "),K.s2=ee(" "),K.s0-=ee(ne),K.s0<0&&(K.s0+=1),K.s1-=ee(ne),K.s1<0&&(K.s1+=1),K.s2-=ee(ne),K.s2<0&&(K.s2+=1),ee=null}function Re(ne,K){return K.c=ne.c,K.s0=ne.s0,K.s1=ne.s1,K.s2=ne.s2,K}function tt(ne,K){var ee=new je(ne),X=K&&K.state,Ce=ee.next;return Ce.int32=function(){return 4294967296*ee.next()|0},Ce.double=function(){return Ce()+11102230246251565e-32*(2097152*Ce()|0)},Ce.quick=Ce,X&&("object"==typeof X&&Re(X,ee),Ce.state=function(){return Re(ee,{})}),Ce}te&&te.exports?te.exports=tt:z.amdD&&z.amdO?void 0!==(B=function(){return tt}.call(et,z,et,te))&&(te.exports=B):this.alea=tt}(0,kt=z.nmd(kt))},8083:function(kt,et,z){var B;!function(Ee,te,He){function je(Ne){var ne=this,K="";ne.next=function(){var X=ne.b,Ce=ne.c,Ue=ne.d,Ae=ne.a;return X=X<<25^X>>>7^Ce,Ce=Ce-Ue|0,Ue=Ue<<24^Ue>>>8^Ae,Ae=Ae-X|0,ne.b=X=X<<20^X>>>12^Ce,ne.c=Ce=Ce-Ue|0,ne.d=Ue<<16^Ce>>>16^Ae,ne.a=Ae-X|0},ne.a=0,ne.b=0,ne.c=-1640531527,ne.d=1367130551,Ne===Math.floor(Ne)?(ne.a=Ne/4294967296|0,ne.b=0|Ne):K+=Ne;for(var ee=0;ee<K.length+20;ee++)ne.b^=0|K.charCodeAt(ee),ne.next()}function Re(Ne,ne){return ne.a=Ne.a,ne.b=Ne.b,ne.c=Ne.c,ne.d=Ne.d,ne}function tt(Ne,ne){var K=new je(Ne),ee=ne&&ne.state,X=function(){return(K.next()>>>0)/4294967296};return X.double=function(){do{var Ae=((K.next()>>>11)+(K.next()>>>0)/4294967296)/(1<<21)}while(0===Ae);return Ae},X.int32=K.next,X.quick=X,ee&&("object"==typeof ee&&Re(ee,K),X.state=function(){return Re(K,{})}),X}te&&te.exports?te.exports=tt:z.amdD&&z.amdO?void 0!==(B=function(){return tt}.call(et,z,et,te))&&(te.exports=B):this.tychei=tt}(0,kt=z.nmd(kt))},2992:function(kt,et,z){var B;!function(Ee,te,He){function je(Ne){var ne=this,K="";ne.x=0,ne.y=0,ne.z=0,ne.w=0,ne.next=function(){var X=ne.x^ne.x<<11;return ne.x=ne.y,ne.y=ne.z,ne.z=ne.w,ne.w^=ne.w>>>19^X^X>>>8},Ne===(0|Ne)?ne.x=Ne:K+=Ne;for(var ee=0;ee<K.length+64;ee++)ne.x^=0|K.charCodeAt(ee),ne.next()}function Re(Ne,ne){return ne.x=Ne.x,ne.y=Ne.y,ne.z=Ne.z,ne.w=Ne.w,ne}function tt(Ne,ne){var K=new je(Ne),ee=ne&&ne.state,X=function(){return(K.next()>>>0)/4294967296};return X.double=function(){do{var Ae=((K.next()>>>11)+(K.next()>>>0)/4294967296)/(1<<21)}while(0===Ae);return Ae},X.int32=K.next,X.quick=X,ee&&("object"==typeof ee&&Re(ee,K),X.state=function(){return Re(K,{})}),X}te&&te.exports?te.exports=tt:z.amdD&&z.amdO?void 0!==(B=function(){return tt}.call(et,z,et,te))&&(te.exports=B):this.xor128=tt}(0,kt=z.nmd(kt))},1929:function(kt,et,z){var B;!function(Ee,te,He){function je(Ne){var ne=this;ne.next=function(){var Ue,Ae,ee=ne.w,X=ne.X,Ce=ne.i;return ne.w=ee=ee+1640531527|0,Ae=X[Ce+34&127],Ue=X[Ce=Ce+1&127],Ae^=Ae<<13,Ue^=Ue<<17,Ae=X[Ce]=(Ae^=Ae>>>15)^(Ue^=Ue>>>12),ne.i=Ce,Ae+(ee^ee>>>16)|0},function K(ee,X){var Ce,Ue,Ae,Dt,$e,Je=[],Gt=128;for(X===(0|X)?(Ue=X,X=null):(X+="\0",Ue=0,Gt=Math.max(Gt,X.length)),Ae=0,Dt=-32;Dt<Gt;++Dt)X&&(Ue^=X.charCodeAt((Dt+32)%X.length)),0===Dt&&($e=Ue),Ue^=Ue<<10,Ue^=Ue>>>15,Ue^=Ue<<4,Ue^=Ue>>>13,Dt>=0&&(Ae=0==(Ce=Je[127&Dt]^=Ue+($e=$e+1640531527|0))?Ae+1:0);for(Ae>=128&&(Je[127&(X&&X.length||0)]=-1),Ae=127,Dt=512;Dt>0;--Dt)Ue=Je[Ae+34&127],Ce=Je[Ae=Ae+1&127],Ue^=Ue<<13,Ce^=Ce<<17,Je[Ae]=(Ue^=Ue>>>15)^(Ce^=Ce>>>12);ee.w=$e,ee.X=Je,ee.i=Ae}(ne,Ne)}function Re(Ne,ne){return ne.i=Ne.i,ne.w=Ne.w,ne.X=Ne.X.slice(),ne}function tt(Ne,ne){null==Ne&&(Ne=+new Date);var K=new je(Ne),ee=ne&&ne.state,X=function(){return(K.next()>>>0)/4294967296};return X.double=function(){do{var Ae=((K.next()>>>11)+(K.next()>>>0)/4294967296)/(1<<21)}while(0===Ae);return Ae},X.int32=K.next,X.quick=X,ee&&(ee.X&&Re(ee,K),X.state=function(){return Re(K,{})}),X}te&&te.exports?te.exports=tt:z.amdD&&z.amdO?void 0!==(B=function(){return tt}.call(et,z,et,te))&&(te.exports=B):this.xor4096=tt}(0,kt=z.nmd(kt))},5583:function(kt,et,z){var B;!function(Ee,te,He){function je(Ne){var ne=this;ne.next=function(){var Ce,Ue,ee=ne.x,X=ne.i;return Ce=ee[X],Ue=(Ce^=Ce>>>7)^Ce<<24,Ue^=(Ce=ee[X+1&7])^Ce>>>10,Ue^=(Ce=ee[X+3&7])^Ce>>>3,Ue^=(Ce=ee[X+4&7])^Ce<<7,Ce=ee[X+7&7],ee[X]=Ue^=(Ce^=Ce<<13)^Ce<<9,ne.i=X+1&7,Ue},function K(ee,X){var Ce,Ae=[];if(X===(0|X))Ae[0]=X;else for(X=""+X,Ce=0;Ce<X.length;++Ce)Ae[7&Ce]=Ae[7&Ce]<<15^X.charCodeAt(Ce)+Ae[Ce+1&7]<<13;for(;Ae.length<8;)Ae.push(0);for(Ce=0;Ce<8&&0===Ae[Ce];++Ce);for(8==Ce&&(Ae[7]=-1),ee.x=Ae,ee.i=0,Ce=256;Ce>0;--Ce)ee.next()}(ne,Ne)}function Re(Ne,ne){return ne.x=Ne.x.slice(),ne.i=Ne.i,ne}function tt(Ne,ne){null==Ne&&(Ne=+new Date);var K=new je(Ne),ee=ne&&ne.state,X=function(){return(K.next()>>>0)/4294967296};return X.double=function(){do{var Ae=((K.next()>>>11)+(K.next()>>>0)/4294967296)/(1<<21)}while(0===Ae);return Ae},X.int32=K.next,X.quick=X,ee&&(ee.x&&Re(ee,K),X.state=function(){return Re(K,{})}),X}te&&te.exports?te.exports=tt:z.amdD&&z.amdO?void 0!==(B=function(){return tt}.call(et,z,et,te))&&(te.exports=B):this.xorshift7=tt}(0,kt=z.nmd(kt))},7657:function(kt,et,z){var B;!function(Ee,te,He){function je(Ne){var ne=this,K="";ne.next=function(){var X=ne.x^ne.x>>>2;return ne.x=ne.y,ne.y=ne.z,ne.z=ne.w,ne.w=ne.v,(ne.d=ne.d+362437|0)+(ne.v=ne.v^ne.v<<4^X^X<<1)|0},ne.x=0,ne.y=0,ne.z=0,ne.w=0,ne.v=0,Ne===(0|Ne)?ne.x=Ne:K+=Ne;for(var ee=0;ee<K.length+64;ee++)ne.x^=0|K.charCodeAt(ee),ee==K.length&&(ne.d=ne.x<<10^ne.x>>>4),ne.next()}function Re(Ne,ne){return ne.x=Ne.x,ne.y=Ne.y,ne.z=Ne.z,ne.w=Ne.w,ne.v=Ne.v,ne.d=Ne.d,ne}function tt(Ne,ne){var K=new je(Ne),ee=ne&&ne.state,X=function(){return(K.next()>>>0)/4294967296};return X.double=function(){do{var Ae=((K.next()>>>11)+(K.next()>>>0)/4294967296)/(1<<21)}while(0===Ae);return Ae},X.int32=K.next,X.quick=X,ee&&("object"==typeof ee&&Re(ee,K),X.state=function(){return Re(K,{})}),X}te&&te.exports?te.exports=tt:z.amdD&&z.amdO?void 0!==(B=function(){return tt}.call(et,z,et,te))&&(te.exports=B):this.xorwow=tt}(0,kt=z.nmd(kt))},3818:function(kt,et,z){var B;!function(Ee,te,He){var Ce,je=256,ne=He.pow(je,6),K=He.pow(2,52),ee=2*K,X=255;function Ue(nt,Pe,Oe){var be=[],he=Je($e((Pe=1==Pe?{entropy:!0}:Pe||{}).entropy?[nt,an(te)]:nt??function Gt(){try{var nt;return Ce&&(nt=Ce.randomBytes)?nt=nt(je):(nt=new Uint8Array(je),(Ee.crypto||Ee.msCrypto).getRandomValues(nt)),an(nt)}catch{var Pe=Ee.navigator,Oe=Pe&&Pe.plugins;return[+new Date,Ee,Oe,Ee.screen,an(te)]}}(),3),be),J=new Ae(be),a=function(){for(var Ft=J.g(6),Wt=ne,bn=0;Ft<K;)Ft=(Ft+bn)*je,Wt*=je,bn=J.g(1);for(;Ft>=ee;)Ft/=2,Wt/=2,bn>>>=1;return(Ft+bn)/Wt};return a.int32=function(){return 0|J.g(4)},a.quick=function(){return J.g(4)/4294967296},a.double=a,Je(an(J.S),te),(Pe.pass||Oe||function(Ft,Wt,bn,Gn){return Gn&&(Gn.S&&Dt(Gn,J),Ft.state=function(){return Dt(J,{})}),bn?(He.random=Ft,Wt):Ft})(a,he,"global"in Pe?Pe.global:this==He,Pe.state)}function Ae(nt){var Pe,Oe=nt.length,be=this,he=0,J=be.i=be.j=0,a=be.S=[];for(Oe||(nt=[Oe++]);he<je;)a[he]=he++;for(he=0;he<je;he++)a[he]=a[J=X&J+nt[he%Oe]+(Pe=a[he])],a[J]=Pe;(be.g=function(Ft){for(var Wt,bn=0,Gn=be.i,Sr=be.j,Nt=be.S;Ft--;)Wt=Nt[Gn=X&Gn+1],bn=bn*je+Nt[X&(Nt[Gn]=Nt[Sr=X&Sr+Wt])+(Nt[Sr]=Wt)];return be.i=Gn,be.j=Sr,bn})(je)}function Dt(nt,Pe){return Pe.i=nt.i,Pe.j=nt.j,Pe.S=nt.S.slice(),Pe}function $e(nt,Pe){var he,Oe=[],be=typeof nt;if(Pe&&"object"==be)for(he in nt)try{Oe.push($e(nt[he],Pe-1))}catch{}return Oe.length?Oe:"string"==be?nt:nt+"\0"}function Je(nt,Pe){for(var be,Oe=nt+"",he=0;he<Oe.length;)Pe[X&he]=X&(be^=19*Pe[X&he])+Oe.charCodeAt(he++);return an(Pe)}function an(nt){return String.fromCharCode.apply(0,nt)}if(Je(He.random(),te),kt.exports){kt.exports=Ue;try{Ce=z(5042)}catch{}}else void 0!==(B=function(){return Ue}.call(et,z,et,kt))&&(kt.exports=B)}(typeof self<"u"?self:this,[],Math)},5410:()=>{},8628:()=>{},1601:()=>{},7792:()=>{},4977:()=>{},5042:()=>{},4650:(kt,et,z)=>{"use strict";z.d(et,{$8M:()=>Ed,$Z:()=>YS,AFp:()=>$4,ALo:()=>fD,AaK:()=>Ne,AsE:()=>Vu,BQk:()=>$u,CHM:()=>Z_,CRH:()=>lx,CZH:()=>gx,CqO:()=>An,D6c:()=>J4,DdM:()=>hF,EJc:()=>P7,EiD:()=>ev,EpF:()=>vC,F$t:()=>SE,F4k:()=>cO,FYo:()=>gM,FiY:()=>Iu,G48:()=>ug,Gf:()=>xF,GfV:()=>yM,GkF:()=>CE,Gpc:()=>ee,Gre:()=>Cv,HOy:()=>FC,Hsn:()=>hO,Ikx:()=>HC,JOm:()=>al,JVY:()=>Rw,KtG:()=>Y_,L6k:()=>xS,LAX:()=>Ky,LFG:()=>gi,LSH:()=>Pw,Lbi:()=>GD,Lck:()=>rD,MAs:()=>bv,MMx:()=>Mv,NdJ:()=>IE,O4$:()=>ry,OlP:()=>wr,Oqu:()=>RC,PXZ:()=>QD,Q6J:()=>Fc,QGY:()=>xE,QP$:()=>yt,QbO:()=>WD,Qsj:()=>vU,R0b:()=>vl,RDi:()=>Ew,Rgc:()=>Km,SBq:()=>Dn,Sil:()=>rg,Suo:()=>IF,TTD:()=>Ra,TgZ:()=>Gm,Udp:()=>nc,VKq:()=>ix,W1O:()=>EF,WFA:()=>TE,WLB:()=>cD,X6Q:()=>JF,XFs:()=>Mt,Xpm:()=>gs,Xts:()=>DS,Y36:()=>Pu,YKP:()=>Yd,YNc:()=>yC,Yjl:()=>me,Yz7:()=>Te,Z0I:()=>Fn,ZZ4:()=>ak,_Bn:()=>rF,_UZ:()=>wE,_Vd:()=>zw,_c5:()=>dg,_uU:()=>SO,aQg:()=>Hc,c2e:()=>jD,cJS:()=>ct,cg1:()=>HE,d8E:()=>zE,dDg:()=>Hf,dqk:()=>Pr,eBb:()=>Yy,eFA:()=>YF,ekj:()=>EC,eoX:()=>bx,f3M:()=>sm,g9A:()=>zf,h0i:()=>Ym,hGG:()=>fP,hij:()=>MC,iGM:()=>CF,ifc:()=>Eo,ip1:()=>BF,jDz:()=>ex,kL8:()=>PO,kcU:()=>iy,lG2:()=>ie,lcZ:()=>ox,lnq:()=>OC,lqb:()=>_f,lri:()=>jF,mCW:()=>k,n5z:()=>Yr,n_E:()=>Lv,oAB:()=>Ic,oxw:()=>uO,pB0:()=>IS,q3G:()=>vi,q4F:()=>Ru,qLn:()=>ov,qOj:()=>pC,qZA:()=>wn,qzn:()=>dl,rWj:()=>KD,sBO:()=>H4,sIi:()=>Bm,s_b:()=>Qm,soG:()=>ng,tb:()=>_x,tp0:()=>Nc,uIk:()=>yE,vHH:()=>Ae,vpe:()=>Lc,wAp:()=>vn,xi3:()=>_F,xp6:()=>US,ynx:()=>Pc,z2F:()=>xx,z3N:()=>Ri,zSh:()=>RS,zs3:()=>co});var B=z(7579),Ee=z(727),te=z(9751),He=z(6451),je=z(3099);function Re(d){for(let h in d)if(d[h]===Re)return h;throw Error("Could not find renamed property on target object.")}function tt(d,h){for(const p in h)h.hasOwnProperty(p)&&!d.hasOwnProperty(p)&&(d[p]=h[p])}function Ne(d){if("string"==typeof d)return d;if(Array.isArray(d))return"["+d.map(Ne).join(", ")+"]";if(null==d)return""+d;if(d.overriddenName)return`${d.overriddenName}`;if(d.name)return`${d.name}`;const h=d.toString();if(null==h)return""+h;const p=h.indexOf("\n");return-1===p?h:h.substring(0,p)}function ne(d,h){return null==d||""===d?null===h?"":h:null==h||""===h?d:d+" "+h}const K=Re({__forward_ref__:Re});function ee(d){return d.__forward_ref__=ee,d.toString=function(){return Ne(this())},d}function X(d){return Ce(d)?d():d}function Ce(d){return"function"==typeof d&&d.hasOwnProperty(K)&&d.__forward_ref__===ee}class Ae extends Error{constructor(h,p){super(function Dt(d,h){return`NG0${Math.abs(d)}${h?": "+h.trim():""}`}(h,p)),this.code=h}}function $e(d){return"string"==typeof d?d:null==d?"":String(d)}function Pe(d,h){throw new Ae(-201,!1)}function sr(d,h){null==d&&function un(d,h,p,g){throw new Error(`ASSERTION ERROR: ${d}`+(null==g?"":` [Expected=> ${p} ${g} ${h} <=Actual]`))}(h,d,null,"!=")}function Te(d){return{token:d.token,providedIn:d.providedIn||null,factory:d.factory,value:void 0}}function ct(d){return{providers:d.providers||[],imports:d.imports||[]}}function Qt(d){return kr(d,Ls)||kr(d,lr)}function Fn(d){return null!==Qt(d)}function kr(d,h){return d.hasOwnProperty(h)?d[h]:null}function Ar(d){return d&&(d.hasOwnProperty(Jn)||d.hasOwnProperty(Wn))?d[Jn]:null}const Ls=Re({\u0275prov:Re}),Jn=Re({\u0275inj:Re}),lr=Re({ngInjectableDef:Re}),Wn=Re({ngInjectorDef:Re});var Mt=(()=>((Mt=Mt||{})[Mt.Default=0]="Default",Mt[Mt.Host=1]="Host",Mt[Mt.Self=2]="Self",Mt[Mt.SkipSelf=4]="SkipSelf",Mt[Mt.Optional=8]="Optional",Mt))();let fn;function en(d){const h=fn;return fn=d,h}function Rh(d,h,p){const g=Qt(d);return g&&"root"==g.providedIn?void 0===g.value?g.value=g.factory():g.value:p&Mt.Optional?null:void 0!==h?h:void Pe(Ne(d))}function Js(d){return{toString:d}.toString()}var Br=(()=>((Br=Br||{})[Br.OnPush=0]="OnPush",Br[Br.Default=1]="Default",Br))(),Eo=(()=>{return(d=Eo||(Eo={}))[d.Emulated=0]="Emulated",d[d.None=2]="None",d[d.ShadowDom=3]="ShadowDom",Eo;var d})();const Pr=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Ai={},In=[],ji=Re({\u0275cmp:Re}),xc=Re({\u0275dir:Re}),pd=Re({\u0275pipe:Re}),md=Re({\u0275mod:Re}),Do=Re({\u0275fac:Re}),Ea=Re({__NG_ELEMENT_ID__:Re});let il=0;function gs(d){return Js(()=>{const p=!0===d.standalone,g={},v={type:d.type,providersResolver:null,decls:d.decls,vars:d.vars,factory:null,template:d.template||null,consts:d.consts||null,ngContentSelectors:d.ngContentSelectors,hostBindings:d.hostBindings||null,hostVars:d.hostVars||0,hostAttrs:d.hostAttrs||null,contentQueries:d.contentQueries||null,declaredInputs:g,inputs:null,outputs:null,exportAs:d.exportAs||null,onPush:d.changeDetection===Br.OnPush,directiveDefs:null,pipeDefs:null,standalone:p,dependencies:p&&d.dependencies||null,getStandaloneInjector:null,selectors:d.selectors||In,viewQuery:d.viewQuery||null,features:d.features||null,data:d.data||{},encapsulation:d.encapsulation||Eo.Emulated,id:"c"+il++,styles:d.styles||In,_:null,setInput:null,schemas:d.schemas||null,tView:null},x=d.dependencies,D=d.features;return v.inputs=ae(d.inputs,g),v.outputs=ae(d.outputs),D&&D.forEach(N=>N(v)),v.directiveDefs=x?()=>("function"==typeof x?x():x).map(gd).filter(Dr):null,v.pipeDefs=x?()=>("function"==typeof x?x():x).map(wt).filter(Dr):null,v})}function gd(d){return Ge(d)||Se(d)}function Dr(d){return null!==d}function Ic(d){return Js(()=>({type:d.type,bootstrap:d.bootstrap||In,declarations:d.declarations||In,imports:d.imports||In,exports:d.exports||In,transitiveCompileScopes:null,schemas:d.schemas||null,id:d.id||null}))}function ae(d,h){if(null==d)return Ai;const p={};for(const g in d)if(d.hasOwnProperty(g)){let v=d[g],x=v;Array.isArray(v)&&(x=v[1],v=v[0]),p[v]=g,h&&(h[v]=x)}return p}const ie=gs;function me(d){return{type:d.type,name:d.name,factory:null,pure:!1!==d.pure,standalone:!0===d.standalone,onDestroy:d.type.prototype.ngOnDestroy||null}}function Ge(d){return d[ji]||null}function Se(d){return d[xc]||null}function wt(d){return d[pd]||null}function yt(d){const h=Ge(d)||Se(d)||wt(d);return null!==h&&h.standalone}function Rt(d,h){const p=d[md]||null;if(!p&&!0===h)throw new Error(`Type ${Ne(d)} does not have '\u0275mod' property.`);return p}function vs(d){return Array.isArray(d)&&"object"==typeof d[1]}function ka(d){return Array.isArray(d)&&!0===d[1]}function yd(d){return 0!=(8&d.flags)}function Op(d){return 2==(2&d.flags)}function Ul(d){return 1==(1&d.flags)}function na(d){return null!==d.template}function Mh(d){return 0!=(256&d[2])}function ko(d,h){return d.hasOwnProperty(Do)?d[Do]:null}class T0{constructor(h,p,g){this.previousValue=h,this.currentValue=p,this.firstChange=g}isFirstChange(){return this.firstChange}}function Ra(){return H_}function H_(d){return d.type.prototype.ngOnChanges&&(d.setInput=S0),G_}function G_(){const d=qT(this),h=d?.current;if(h){const p=d.previous;if(p===Ai)d.previous=h;else for(let g in h)p[g]=h[g];d.current=null,this.ngOnChanges(h)}}function S0(d,h,p,g){const v=qT(d)||function Ao(d,h){return d[Lp]=h}(d,{previous:Ai,current:null}),x=v.current||(v.current={}),D=v.previous,N=this.declaredInputs[p],R=D[N];x[N]=new T0(R&&R.currentValue,h,D===Ai),d[g]=h}Ra.ngInherit=!0;const Lp="__ngSimpleChanges__";function qT(d){return d[Lp]||null}function oi(d){for(;Array.isArray(d);)d=d[0];return d}function Gl(d,h){return oi(h[d])}function so(d,h){return oi(h[d.index])}function $p(d,h){return d.data[h]}function bd(d,h){return d[h]}function qi(d,h){const p=h[d];return vs(p)?p:p[0]}function Wl(d){return 64==(64&d[2])}function Ma(d,h){return null==h?null:d[h]}function wd(d){d[18]=0}function bs(d,h){d[5]+=h;let p=d,g=d[3];for(;null!==g&&(1===h&&1===p[5]||-1===h&&0===p[5]);)g[5]+=h,p=g,g=g[3]}const Tn={lFrame:P0(null),bindingsEnabled:!0};function R0(){return Tn.bindingsEnabled}function st(){return Tn.lFrame.lView}function Yn(){return Tn.lFrame.tView}function Z_(d){return Tn.lFrame.contextLView=d,d[8]}function Y_(d){return Tn.lFrame.contextLView=null,d}function mi(){let d=Bp();for(;null!==d&&64===d.type;)d=d.parent;return d}function Bp(){return Tn.lFrame.currentTNode}function ia(d,h){const p=Tn.lFrame;p.currentTNode=d,p.isParent=h}function Cd(){return Tn.lFrame.isParent}function K_(){Tn.lFrame.isParent=!1}function as(){const d=Tn.lFrame;let h=d.bindingRootIndex;return-1===h&&(h=d.bindingRootIndex=d.tView.bindingStartIndex),h}function sa(){return Tn.lFrame.bindingIndex}function Ro(){return Tn.lFrame.bindingIndex++}function Oa(d){const h=Tn.lFrame,p=h.bindingIndex;return h.bindingIndex=h.bindingIndex+d,p}function QT(d,h){const p=Tn.lFrame;p.bindingIndex=p.bindingRootIndex=d,J_(h)}function J_(d){Tn.lFrame.currentDirectiveIndex=d}function $h(d){const h=Tn.lFrame.currentDirectiveIndex;return-1===h?null:d[h]}function XT(){return Tn.lFrame.currentQueryIndex}function Bh(d){Tn.lFrame.currentQueryIndex=d}function F0(d){const h=d[1];return 2===h.type?h.declTNode:1===h.type?d[6]:null}function zp(d,h,p){if(p&Mt.SkipSelf){let v=h,x=d;for(;!(v=v.parent,null!==v||p&Mt.Host||(v=F0(x),null===v||(x=x[15],10&v.type))););if(null===v)return!1;h=v,d=x}const g=Tn.lFrame=ty();return g.currentTNode=h,g.lView=d,!0}function ey(d){const h=ty(),p=d[1];Tn.lFrame=h,h.currentTNode=p.firstChild,h.lView=d,h.tView=p,h.contextLView=d,h.bindingIndex=p.bindingStartIndex,h.inI18n=!1}function ty(){const d=Tn.lFrame,h=null===d?null:d.child;return null===h?P0(d):h}function P0(d){const h={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:d,child:null,inI18n:!1};return null!==d&&(d.child=h),h}function Hp(){const d=Tn.lFrame;return Tn.lFrame=d.parent,d.currentTNode=null,d.lView=null,d}const L0=Hp;function ny(){const d=Hp();d.isParent=!0,d.tView=null,d.selectedIndex=-1,d.contextLView=null,d.elementDepthCount=0,d.currentDirectiveIndex=-1,d.currentNamespace=null,d.bindingRootIndex=-1,d.bindingIndex=-1,d.currentQueryIndex=0}function tr(){return Tn.lFrame.selectedIndex}function jl(d){Tn.lFrame.selectedIndex=d}function ai(){const d=Tn.lFrame;return $p(d.tView,d.selectedIndex)}function ry(){Tn.lFrame.currentNamespace="svg"}function iy(){!function PR(){Tn.lFrame.currentNamespace=null}()}function Vh(d,h){for(let p=h.directiveStart,g=h.directiveEnd;p<g;p++){const x=d.data[p].type.prototype,{ngAfterContentInit:D,ngAfterContentChecked:N,ngAfterViewInit:R,ngAfterViewChecked:F,ngOnDestroy:H}=x;D&&(d.contentHooks||(d.contentHooks=[])).push(-p,D),N&&((d.contentHooks||(d.contentHooks=[])).push(p,N),(d.contentCheckHooks||(d.contentCheckHooks=[])).push(p,N)),R&&(d.viewHooks||(d.viewHooks=[])).push(-p,R),F&&((d.viewHooks||(d.viewHooks=[])).push(p,F),(d.viewCheckHooks||(d.viewCheckHooks=[])).push(p,F)),null!=H&&(d.destroyHooks||(d.destroyHooks=[])).push(p,H)}}function oy(d,h,p){Gp(d,h,3,p)}function vu(d,h,p,g){(3&d[2])===p&&Gp(d,h,p,g)}function ay(d,h){let p=d[2];(3&p)===h&&(p&=2047,p+=1,d[2]=p)}function Gp(d,h,p,g){const x=g??-1,D=h.length-1;let N=0;for(let R=void 0!==g?65535&d[18]:0;R<D;R++)if("number"==typeof h[R+1]){if(N=h[R],null!=g&&N>=g)break}else h[R]<0&&(d[18]+=65536),(N<x||-1==x)&&(ly(d,p,h,R),d[18]=(4294901760&d[18])+R+2),R++}function ly(d,h,p,g){const v=p[g]<0,x=p[g+1],N=d[v?-p[g]:p[g]];if(v){if(d[2]>>11<d[18]>>16&&(3&d[2])===h){d[2]+=2048;try{x.call(N)}finally{}}}else try{x.call(N)}finally{}}class Uh{constructor(h,p,g){this.factory=h,this.resolving=!1,this.canSeeViewProviders=p,this.injectImpl=g}}function uy(d,h,p){let g=0;for(;g<p.length;){const v=p[g];if("number"==typeof v){if(0!==v)break;g++;const x=p[g++],D=p[g++],N=p[g++];d.setAttribute(h,D,N,x)}else{const x=v,D=p[++g];VR(x)?d.setProperty(h,x,D):d.setAttribute(h,x,D),g++}}return g}function BR(d){return 3===d||4===d||6===d}function VR(d){return 64===d.charCodeAt(0)}function dy(d,h){if(null!==h&&0!==h.length)if(null===d||0===d.length)d=h.slice();else{let p=-1;for(let g=0;g<h.length;g++){const v=h[g];"number"==typeof v?p=v:0===p||nS(d,p,v,null,-1===p||2===p?h[++g]:null)}}return d}function nS(d,h,p,g,v){let x=0,D=d.length;if(-1===h)D=-1;else for(;x<d.length;){const N=d[x++];if("number"==typeof N){if(N===h){D=-1;break}if(N>h){D=x-1;break}}}for(;x<d.length;){const N=d[x];if("number"==typeof N)break;if(N===p){if(null===g)return void(null!==v&&(d[x+1]=v));if(g===d[x+1])return void(d[x+2]=v)}x++,null!==g&&x++,null!==v&&x++}-1!==D&&(d.splice(D,0,h),x=D+1),d.splice(x++,0,p),null!==g&&d.splice(x++,0,g),null!==v&&d.splice(x++,0,v)}function UR(d){return-1!==d}function Wp(d){return 32767&d}function jp(d,h){let p=function iU(d){return d>>16}(d),g=h;for(;p>0;)g=g[15],p--;return g}let U0=!0;function zh(d){const h=U0;return U0=d,h}let zR=0;const ql={};function Zp(d,h){const p=Yp(d,h);if(-1!==p)return p;const g=h[1];g.firstCreatePass&&(d.injectorIndex=h.length,z0(g.data,d),z0(h,null),z0(g.blueprint,null));const v=Hh(d,h),x=d.injectorIndex;if(UR(v)){const D=Wp(v),N=jp(v,h),R=N[1].data;for(let F=0;F<8;F++)h[x+F]=N[D+F]|R[D+F]}return h[x+8]=v,x}function z0(d,h){d.push(0,0,0,0,0,0,0,0,h)}function Yp(d,h){return-1===d.injectorIndex||d.parent&&d.parent.injectorIndex===d.injectorIndex||null===h[d.injectorIndex+8]?-1:d.injectorIndex}function Hh(d,h){if(d.parent&&-1!==d.parent.injectorIndex)return d.parent.injectorIndex;let p=0,g=null,v=h;for(;null!==v;){if(g=Sd(v),null===g)return-1;if(p++,v=v[15],-1!==g.injectorIndex)return g.injectorIndex|p<<16}return-1}function hy(d,h,p){!function sU(d,h,p){let g;"string"==typeof p?g=p.charCodeAt(0)||0:p.hasOwnProperty(Ea)&&(g=p[Ea]),null==g&&(g=p[Ea]=zR++);const v=255&g;h.data[d+(v>>5)]|=1<<v}(d,h,p)}function py(d,h,p){if(p&Mt.Optional||void 0!==d)return d;Pe()}function Kp(d,h,p,g){if(p&Mt.Optional&&void 0===g&&(g=null),0==(p&(Mt.Self|Mt.Host))){const v=d[9],x=en(void 0);try{return v?v.get(h,g,p&Mt.Optional):Rh(h,g,p&Mt.Optional)}finally{en(x)}}return py(g,0,p)}function Td(d,h,p,g=Mt.Default,v){if(null!==d){if(1024&h[2]){const D=function Jp(d,h,p,g,v){let x=d,D=h;for(;null!==x&&null!==D&&1024&D[2]&&!(256&D[2]);){const N=H0(x,D,p,g|Mt.Self,ql);if(N!==ql)return N;let R=x.parent;if(!R){const F=D[21];if(F){const H=F.get(p,ql,g);if(H!==ql)return H}R=Sd(D),D=D[15]}x=R}return v}(d,h,p,g,ql);if(D!==ql)return D}const x=H0(d,h,p,g,ql);if(x!==ql)return x}return Kp(h,p,g,v)}function H0(d,h,p,g,v){const x=function Sc(d){if("string"==typeof d)return d.charCodeAt(0)||0;const h=d.hasOwnProperty(Ea)?d[Ea]:void 0;return"number"==typeof h?h>=0?255&h:Qp:h}(p);if("function"==typeof x){if(!zp(h,d,g))return g&Mt.Host?py(v,0,g):Kp(h,p,g,v);try{const D=x(g);if(null!=D||g&Mt.Optional)return D;Pe()}finally{L0()}}else if("number"==typeof x){let D=null,N=Yp(d,h),R=-1,F=g&Mt.Host?h[16][6]:null;for((-1===N||g&Mt.SkipSelf)&&(R=-1===N?Hh(d,h):h[N+8],-1!==R&&W0(g,!1)?(D=h[1],N=Wp(R),h=jp(R,h)):N=-1);-1!==N;){const H=h[1];if(G0(x,N,H.data)){const Y=my(N,h,p,D,g,F);if(Y!==ql)return Y}R=h[N+8],-1!==R&&W0(g,h[1].data[N+8]===F)&&G0(x,N,h)?(D=H,N=Wp(R),h=jp(R,h)):N=-1}}return v}function my(d,h,p,g,v,x){const D=h[1],N=D.data[d+8],H=bu(N,D,p,null==g?Op(N)&&U0:g!=D&&0!=(3&N.type),v&Mt.Host&&x===N);return null!==H?Gh(h,D,H,N):ql}function bu(d,h,p,g,v){const x=d.providerIndexes,D=h.data,N=1048575&x,R=d.directiveStart,H=x>>20,de=v?N+H:d.directiveEnd;for(let De=g?N:N+H;De<de;De++){const rt=D[De];if(De<R&&p===rt||De>=R&&rt.type===p)return De}if(v){const De=D[R];if(De&&na(De)&&De.type===p)return R}return null}function Gh(d,h,p,g){let v=d[p];const x=h.data;if(function B0(d){return d instanceof Uh}(v)){const D=v;D.resolving&&function Gt(d,h){const p=h?`. Dependency path: ${h.join(" > ")} > ${d}`:"";throw new Ae(-200,`Circular dependency in DI detected for ${d}${p}`)}(function Je(d){return"function"==typeof d?d.name||d.toString():"object"==typeof d&&null!=d&&"function"==typeof d.type?d.type.name||d.type.toString():$e(d)}(x[p]));const N=zh(D.canSeeViewProviders);D.resolving=!0;const R=D.injectImpl?en(D.injectImpl):null;zp(d,g,Mt.Default);try{v=d[p]=D.factory(void 0,x,d,g),h.firstCreatePass&&p>=g.directiveStart&&function LR(d,h,p){const{ngOnChanges:g,ngOnInit:v,ngDoCheck:x}=h.type.prototype;if(g){const D=H_(h);(p.preOrderHooks||(p.preOrderHooks=[])).push(d,D),(p.preOrderCheckHooks||(p.preOrderCheckHooks=[])).push(d,D)}v&&(p.preOrderHooks||(p.preOrderHooks=[])).push(0-d,v),x&&((p.preOrderHooks||(p.preOrderHooks=[])).push(d,x),(p.preOrderCheckHooks||(p.preOrderCheckHooks=[])).push(d,x))}(p,x[p],h)}finally{null!==R&&en(R),zh(N),D.resolving=!1,L0()}}return v}function G0(d,h,p){return!!(p[h+(d>>5)]&1<<d)}function W0(d,h){return!(d&Mt.Self||d&Mt.Host&&h)}class ol{constructor(h,p){this._tNode=h,this._lView=p}get(h,p,g){return Td(this._tNode,this._lView,h,g,p)}}function Qp(){return new ol(mi(),st())}function Yr(d){return Js(()=>{const h=d.prototype.constructor,p=h[Do]||Xp(h),g=Object.prototype;let v=Object.getPrototypeOf(d.prototype).constructor;for(;v&&v!==g;){const x=v[Do]||Xp(v);if(x&&x!==p)return x;v=Object.getPrototypeOf(v)}return x=>new x})}function Xp(d){return Ce(d)?()=>{const h=Xp(X(d));return h&&h()}:ko(d)}function Sd(d){const h=d[1],p=h.type;return 2===p?h.declTNode:1===p?d[6]:null}function Ed(d){return function fy(d,h){if("class"===h)return d.classes;if("style"===h)return d.styles;const p=d.attrs;if(p){const g=p.length;let v=0;for(;v<g;){const x=p[v];if(BR(x))break;if(0===x)v+=2;else if("number"==typeof x)for(v++;v<g&&"string"==typeof p[v];)v++;else{if(x===h)return p[v+1];v+=2}}}return null}(mi(),d)}const Dc="__parameters__";function wu(d,h,p){return Js(()=>{const g=function Dd(d){return function(...p){if(d){const g=d(...p);for(const v in g)this[v]=g[v]}}}(h);function v(...x){if(this instanceof v)return g.apply(this,x),this;const D=new v(...x);return N.annotation=D,N;function N(R,F,H){const Y=R.hasOwnProperty(Dc)?R[Dc]:Object.defineProperty(R,Dc,{value:[]})[Dc];for(;Y.length<=H;)Y.push(null);return(Y[H]=Y[H]||[]).push(D),R}}return p&&(v.prototype=Object.create(p.prototype)),v.prototype.ngMetadataName=d,v.annotationCls=v,v})}class wr{constructor(h,p){this._desc=h,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof p?this.__NG_ELEMENT_ID__=p:void 0!==p&&(this.\u0275prov=Te({token:this,providedIn:p.providedIn||"root",factory:p.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function $s(d,h){void 0===h&&(h=d);for(let p=0;p<d.length;p++){let g=d[p];Array.isArray(g)?(h===d&&(h=d.slice(0,p)),$s(g,h)):h!==d&&h.push(g)}return h}function Ac(d,h){d.forEach(p=>Array.isArray(p)?Ac(p,h):h(p))}function by(d,h,p){h>=d.length?d.push(p):d.splice(h,0,p)}function wy(d,h){return h>=d.length-1?d.pop():d.splice(h,1)[0]}function Cu(d,h){const p=[];for(let g=0;g<d;g++)p.push(h);return p}function oo(d,h,p){let g=Yh(d,h);return g>=0?d[1|g]=p:(g=~g,function K0(d,h,p,g){let v=d.length;if(v==h)d.push(p,g);else if(1===v)d.push(g,d[0]),d[0]=p;else{for(v--,d.push(d[v-1],d[v]);v>h;)d[v]=d[v-2],v--;d[h]=p,d[h+1]=g}}(d,g,h,p)),g}function rm(d,h){const p=Yh(d,h);if(p>=0)return d[1|p]}function Yh(d,h){return function aS(d,h,p){let g=0,v=d.length>>p;for(;v!==g;){const x=g+(v-g>>1),D=d[x<<p];if(h===D)return x<<p;D>h?v=x:g=x+1}return~(v<<p)}(d,h,1)}const Zl={},La="__NG_DI_FLAG__",xu="ngTempTokenPath",qR=/\n/gm,im="__source";let Kh;function Qh(d){const h=Kh;return Kh=d,h}function YR(d,h=Mt.Default){if(void 0===Kh)throw new Ae(-203,!1);return null===Kh?Rh(d,void 0,h):Kh.get(d,h&Mt.Optional?null:void 0,h)}function gi(d,h=Mt.Default){return(function hr(){return fn}()||YR)(X(d),h)}function sm(d,h=Mt.Default){return"number"!=typeof h&&(h=0|(h.optional&&8)|(h.host&&1)|(h.self&&2)|(h.skipSelf&&4)),gi(d,h)}function tw(d){const h=[];for(let p=0;p<d.length;p++){const g=X(d[p]);if(Array.isArray(g)){if(0===g.length)throw new Ae(900,!1);let v,x=Mt.Default;for(let D=0;D<g.length;D++){const N=g[D],R=nw(N);"number"==typeof R?-1===R?v=N.token:x|=R:v=N}h.push(gi(v,x))}else h.push(gi(g))}return h}function Ad(d,h){return d[La]=h,d.prototype[La]=h,d}function nw(d){return d[La]}const Iu=Ad(wu("Optional"),8),Nc=Ad(wu("SkipSelf"),4);var al=(()=>((al=al||{})[al.Important=1]="Important",al[al.DashCase=2]="DashCase",al))();const Ay=new Map;let pS=0;const pm="__ngContext__";function Zi(d,h){vs(h)?(d[pm]=h[20],function gS(d){Ay.set(d[20],d)}(h)):d[pm]=h}function sf(d,h){return undefined(d,h)}function $a(d){const h=d[3];return ka(h)?h[3]:h}function _w(d){return Ql(d[13])}function yw(d){return Ql(d[4])}function Ql(d){for(;null!==d&&!ka(d);)d=d[4];return d}function af(d,h,p,g,v){if(null!=g){let x,D=!1;ka(g)?x=g:vs(g)&&(D=!0,g=g[0]);const N=oi(g);0===d&&null!==p?null==v?Va(h,p,N):ll(h,p,N,v||null,!0):1===d&&null!==p?ll(h,p,N,v||null,!0):2===d?function Uy(d,h,p){const g=cl(d,h);g&&function Cw(d,h,p,g){d.removeChild(h,p,g)}(d,g,h,p)}(h,N,D):3===d&&h.destroyNode(N),null!=x&&function zy(d,h,p,g,v){const x=p[7];x!==oi(p)&&af(h,d,g,x,v);for(let N=10;N<p.length;N++){const R=p[N];Fd(R[1],R,d,h,g,x)}}(h,d,x,p,v)}}function ym(d,h,p){return d.createElement(h,p)}function wm(d,h){const p=d[9],g=p.indexOf(h),v=h[3];512&h[2]&&(h[2]&=-513,bs(v,-1)),p.splice(g,1)}function Ba(d,h){if(d.length<=10)return;const p=10+h,g=d[p];if(g){const v=g[17];null!==v&&v!==d&&wm(v,g),h>0&&(d[p-1][4]=g[4]);const x=wy(d,10+h);!function CS(d,h){Fd(d,h,h[11],2,null,null),h[0]=null,h[6]=null}(g[1],g);const D=x[19];null!==D&&D.detachView(x[1]),g[3]=null,g[4]=null,g[2]&=-65}return g}function Cm(d,h){if(!(128&h[2])){const p=h[11];p.destroyNode&&Fd(d,h,p,3,null,null),function bm(d){let h=d[13];if(!h)return Od(d[1],d);for(;h;){let p=null;if(vs(h))p=h[13];else{const g=h[10];g&&(p=g)}if(!p){for(;h&&!h[4]&&h!==d;)vs(h)&&Od(h[1],h),h=h[3];null===h&&(h=d),vs(h)&&Od(h[1],h),p=h&&h[4]}h=p}}(h)}}function Od(d,h){if(!(128&h[2])){h[2]&=-65,h[2]|=128,function Du(d,h){let p;if(null!=d&&null!=(p=d.destroyHooks))for(let g=0;g<p.length;g+=2){const v=h[p[g]];if(!(v instanceof Uh)){const x=p[g+1];if(Array.isArray(x))for(let D=0;D<x.length;D+=2){const N=v[x[D]],R=x[D+1];try{R.call(N)}finally{}}else try{x.call(v)}finally{}}}}(d,h),function bw(d,h){const p=d.cleanup,g=h[7];let v=-1;if(null!==p)for(let x=0;x<p.length-1;x+=2)if("string"==typeof p[x]){const D=p[x+1],N="function"==typeof D?D(h):oi(h[D]),R=g[v=p[x+2]],F=p[x+3];"boolean"==typeof F?N.removeEventListener(p[x],R,F):F>=0?g[v=F]():g[v=-F].unsubscribe(),x+=2}else{const D=g[v=p[x+1]];p[x].call(D)}if(null!==g){for(let x=v+1;x<g.length;x++)(0,g[x])();h[7]=null}}(d,h),1===h[1].type&&h[11].destroy();const p=h[17];if(null!==p&&ka(h[3])){p!==h[3]&&wm(p,h);const g=h[19];null!==g&&g.detachView(d)}!function _S(d){Ay.delete(d[20])}(h)}}function $y(d,h,p){return function ww(d,h,p){let g=h;for(;null!==g&&40&g.type;)g=(h=g).parent;if(null===g)return p[0];if(2&g.flags){const v=d.data[g.directiveStart].encapsulation;if(v===Eo.None||v===Eo.Emulated)return null}return so(g,p)}(d,h.parent,p)}function ll(d,h,p,g,v){d.insertBefore(h,p,g,v)}function Va(d,h,p){d.appendChild(h,p)}function By(d,h,p,g,v){null!==g?ll(d,h,p,g,v):Va(d,h,p)}function cl(d,h){return d.parentNode(h)}function xw(d,h,p){return Vy(d,h,p)}let hf,Bd,Vy=function uf(d,h,p){return 40&d.type?so(d,p):null};function xm(d,h,p,g){const v=$y(d,g,h),x=h[11],N=xw(g.parent||h[6],g,h);if(null!=v)if(Array.isArray(p))for(let R=0;R<p.length;R++)By(x,v,p[R],N,!1);else By(x,v,p,N,!1)}function ul(d,h){if(null!==h){const p=h.type;if(3&p)return so(h,d);if(4&p)return Im(-1,d[h.index]);if(8&p){const g=h.child;if(null!==g)return ul(d,g);{const v=d[h.index];return ka(v)?Im(-1,v):oi(v)}}if(32&p)return sf(h,d)()||oi(d[h.index]);{const g=Iw(d,h);return null!==g?Array.isArray(g)?g[0]:ul($a(d[16]),g):ul(d,h.next)}}return null}function Iw(d,h){return null!==h?d[16][6].projection[h.projection]:null}function Im(d,h){const p=10+d+1;if(p<h.length){const g=h[p],v=g[1].firstChild;if(null!==v)return ul(g,v)}return h[7]}function Us(d,h,p,g,v,x,D){for(;null!=p;){const N=g[p.index],R=p.type;if(D&&0===h&&(N&&Zi(oi(N),g),p.flags|=4),64!=(64&p.flags))if(8&R)Us(d,h,p.child,g,v,x,!1),af(h,d,v,N,x);else if(32&R){const F=sf(p,g);let H;for(;H=F();)af(h,d,v,H,x);af(h,d,v,N,x)}else 16&R?Pd(d,h,g,p,v,x):af(h,d,v,N,x);p=D?p.projectionNext:p.next}}function Fd(d,h,p,g,v,x){Us(p,g,d.firstChild,h,v,x,!1)}function Pd(d,h,p,g,v,x){const D=p[16],R=D[6].projection[g.projection];if(Array.isArray(R))for(let F=0;F<R.length;F++)af(h,d,v,R[F],x);else Us(d,h,R,D[3],v,x,!0)}function Gy(d,h,p){d.setAttribute(h,"style",p)}function Tw(d,h,p){""===p?d.removeAttribute(h,"class"):d.setAttribute(h,"class",p)}function Bi(d){return function Ld(){if(void 0===hf&&(hf=null,Pr.trustedTypes))try{hf=Pr.trustedTypes.createPolicy("angular",{createHTML:d=>d,createScript:d=>d,createScriptURL:d=>d})}catch{}return hf}()?.createHTML(d)||d}function Ew(d){Bd=d}class Au{constructor(h){this.changingThisBreaksApplicationSecurity=h}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Aw extends Au{getTypeName(){return"HTML"}}class ao extends Au{getTypeName(){return"Style"}}class Xl extends Au{getTypeName(){return"Script"}}class pf extends Au{getTypeName(){return"URL"}}class Zy extends Au{getTypeName(){return"ResourceURL"}}function Ri(d){return d instanceof Au?d.changingThisBreaksApplicationSecurity:d}function dl(d,h){const p=function Nw(d){return d instanceof Au&&d.getTypeName()||null}(d);if(null!=p&&p!==h){if("ResourceURL"===p&&"URL"===h)return!0;throw new Error(`Required a safe ${h}, got a ${p} (see https://g.co/ng/security#xss)`)}return p===h}function Rw(d){return new Aw(d)}function xS(d){return new ao(d)}function Yy(d){return new Xl(d)}function Ky(d){return new pf(d)}function IS(d){return new Zy(d)}class Qy{constructor(h){this.inertDocumentHelper=h}getInertBodyElement(h){h="<body><remove></remove>"+h;try{const p=(new window.DOMParser).parseFromString(Bi(h),"text/html").body;return null===p?this.inertDocumentHelper.getInertBodyElement(h):(p.removeChild(p.firstChild),p)}catch{return null}}}class S{constructor(h){if(this.defaultDoc=h,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const p=this.inertDocument.createElement("html");this.inertDocument.appendChild(p);const g=this.inertDocument.createElement("body");p.appendChild(g)}}getInertBodyElement(h){const p=this.inertDocument.createElement("template");if("content"in p)return p.innerHTML=Bi(h),p;const g=this.inertDocument.createElement("body");return g.innerHTML=Bi(h),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(g),g}stripCustomNsAttrs(h){const p=h.attributes;for(let v=p.length-1;0<v;v--){const D=p.item(v).name;("xmlns:ns1"===D||0===D.indexOf("ns1:"))&&h.removeAttribute(D)}let g=h.firstChild;for(;g;)g.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(g),g=g.nextSibling}}const C=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function k(d){return(d=String(d)).match(C)?d:"unsafe:"+d}function L(d){const h={};for(const p of d.split(","))h[p]=!0;return h}function U(...d){const h={};for(const p of d)for(const g in p)p.hasOwnProperty(g)&&(h[g]=!0);return h}const le=L("area,br,col,hr,img,wbr"),xe=L("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),at=L("rp,rt"),Kr=U(le,U(xe,L("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),U(at,L("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),U(at,xe)),Oo=L("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Sm=U(Oo,L("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),L("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Mw=L("script,style,template");class Ow{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(h){let p=h.firstChild,g=!0;for(;p;)if(p.nodeType===Node.ELEMENT_NODE?g=this.startElement(p):p.nodeType===Node.TEXT_NODE?this.chars(p.nodeValue):this.sanitizedSomething=!0,g&&p.firstChild)p=p.firstChild;else for(;p;){p.nodeType===Node.ELEMENT_NODE&&this.endElement(p);let v=this.checkClobberedElement(p,p.nextSibling);if(v){p=v;break}p=this.checkClobberedElement(p,p.parentNode)}return this.buf.join("")}startElement(h){const p=h.nodeName.toLowerCase();if(!Kr.hasOwnProperty(p))return this.sanitizedSomething=!0,!Mw.hasOwnProperty(p);this.buf.push("<"),this.buf.push(p);const g=h.attributes;for(let v=0;v<g.length;v++){const x=g.item(v),D=x.name,N=D.toLowerCase();if(!Sm.hasOwnProperty(N)){this.sanitizedSomething=!0;continue}let R=x.value;Oo[N]&&(R=k(R)),this.buf.push(" ",D,'="',Jy(R),'"')}return this.buf.push(">"),!0}endElement(h){const p=h.nodeName.toLowerCase();Kr.hasOwnProperty(p)&&!le.hasOwnProperty(p)&&(this.buf.push("</"),this.buf.push(p),this.buf.push(">"))}chars(h){this.buf.push(Jy(h))}checkClobberedElement(h,p){if(p&&(h.compareDocumentPosition(p)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${h.outerHTML}`);return p}}const Em=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Fw=/([^\#-~ |!])/g;function Jy(d){return d.replace(/&/g,"&amp;").replace(Em,function(h){return"&#"+(1024*(h.charCodeAt(0)-55296)+(h.charCodeAt(1)-56320)+65536)+";"}).replace(Fw,function(h){return"&#"+h.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Nu;function ev(d,h){let p=null;try{Nu=Nu||function mf(d){const h=new S(d);return function b(){try{return!!(new window.DOMParser).parseFromString(Bi(""),"text/html")}catch{return!1}}()?new Qy(h):h}(d);let g=h?String(h):"";p=Nu.getInertBodyElement(g);let v=5,x=g;do{if(0===v)throw new Error("Failed to sanitize html because the input is unstable");v--,g=x,x=p.innerHTML,p=Nu.getInertBodyElement(g)}while(g!==x);return Bi((new Ow).sanitizeChildren(gf(p)||p))}finally{if(p){const g=gf(p)||p;for(;g.firstChild;)g.removeChild(g.firstChild)}}}function gf(d){return"content"in d&&function tv(d){return d.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===d.nodeName}(d)?d.content:null}var vi=(()=>((vi=vi||{})[vi.NONE=0]="NONE",vi[vi.HTML=1]="HTML",vi[vi.STYLE=2]="STYLE",vi[vi.SCRIPT=3]="SCRIPT",vi[vi.URL=4]="URL",vi[vi.RESOURCE_URL=5]="RESOURCE_URL",vi))();function Pw(d){const h=function rv(){const d=st();return d&&d[12]}();return h?h.sanitize(vi.URL,d)||"":dl(d,"URL")?Ri(d):k($e(d))}const DS=new wr("ENVIRONMENT_INITIALIZER"),iv=new wr("INJECTOR",-1),lM=new wr("INJECTOR_DEF_TYPES");class kS{get(h,p=Zl){if(p===Zl){const g=new Error(`NullInjectorError: No provider for ${Ne(h)}!`);throw g.name="NullInjectorError",g}return p}}function cM(...d){return{\u0275providers:AS(0,d)}}function AS(d,...h){const p=[],g=new Set;let v;return Ac(h,x=>{const D=x;Ud(D,p,[],g)&&(v||(v=[]),v.push(D))}),void 0!==v&&za(v,p),p}function za(d,h){for(let p=0;p<d.length;p++){const{providers:v}=d[p];Ac(v,x=>{h.push(x)})}}function Ud(d,h,p,g){if(!(d=X(d)))return!1;let v=null,x=Ar(d);const D=!x&&Ge(d);if(x||D){if(D&&!D.standalone)return!1;v=d}else{const R=d.ngModule;if(x=Ar(R),!x)return!1;v=R}const N=g.has(v);if(D){if(N)return!1;if(g.add(v),D.dependencies){const R="function"==typeof D.dependencies?D.dependencies():D.dependencies;for(const F of R)Ud(F,h,p,g)}}else{if(!x)return!1;{if(null!=x.imports&&!N){let F;g.add(v);try{Ac(x.imports,H=>{Ud(H,h,p,g)&&(F||(F=[]),F.push(H))})}finally{}void 0!==F&&za(F,h)}if(!N){const F=ko(v)||(()=>new v);h.push({provide:v,useFactory:F,deps:In},{provide:lM,useValue:v,multi:!0},{provide:DS,useValue:()=>gi(v),multi:!0})}const R=x.providers;null==R||N||Ac(R,H=>{h.push(H)})}}return v!==d&&void 0!==d.providers}const uU=Re({provide:String,useValue:Re});function Lw(d){return null!==d&&"object"==typeof d&&uU in d}function Rc(d){return"function"==typeof d}const RS=new wr("Set Injector scope."),Dm={},hU={};let $w;function Bw(){return void 0===$w&&($w=new kS),$w}class _f{}class dM extends _f{constructor(h,p,g,v){super(),this.parent=p,this.source=g,this.scopes=v,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,FS(h,D=>this.processProvider(D)),this.records.set(iv,km(void 0,this)),v.has("environment")&&this.records.set(_f,km(void 0,this));const x=this.records.get(RS);null!=x&&"string"==typeof x.value&&this.scopes.add(x.value),this.injectorDefTypes=new Set(this.get(lM.multi,In,Mt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const h of this._ngOnDestroyHooks)h.ngOnDestroy();for(const h of this._onDestroyHooks)h()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(h){this._onDestroyHooks.push(h)}runInContext(h){this.assertNotDestroyed();const p=Qh(this),g=en(void 0);try{return h()}finally{Qh(p),en(g)}}get(h,p=Zl,g=Mt.Default){this.assertNotDestroyed();const v=Qh(this),x=en(void 0);try{if(!(g&Mt.SkipSelf)){let N=this.records.get(h);if(void 0===N){const R=function pU(d){return"function"==typeof d||"object"==typeof d&&d instanceof wr}(h)&&Qt(h);N=R&&this.injectableDefInScope(R)?km(MS(h),Dm):null,this.records.set(h,N)}if(null!=N)return this.hydrate(h,N)}return(g&Mt.Self?Bw():this.parent).get(h,p=g&Mt.Optional&&p===Zl?null:p)}catch(D){if("NullInjectorError"===D.name){if((D[xu]=D[xu]||[]).unshift(Ne(h)),v)throw D;return function KR(d,h,p,g){const v=d[xu];throw h[im]&&v.unshift(h[im]),d.message=function om(d,h,p,g=null){d=d&&"\n"===d.charAt(0)&&"\u0275"==d.charAt(1)?d.slice(2):d;let v=Ne(h);if(Array.isArray(h))v=h.map(Ne).join(" -> ");else if("object"==typeof h){let x=[];for(let D in h)if(h.hasOwnProperty(D)){let N=h[D];x.push(D+":"+("string"==typeof N?JSON.stringify(N):Ne(N)))}v=`{${x.join(", ")}}`}return`${p}${g?"("+g+")":""}[${v}]: ${d.replace(qR,"\n  ")}`}("\n"+d.message,v,p,g),d.ngTokenPath=v,d[xu]=null,d}(D,h,"R3InjectorError",this.source)}throw D}finally{en(x),Qh(v)}}resolveInjectorInitializers(){const h=Qh(this),p=en(void 0);try{const g=this.get(DS.multi,In,Mt.Self);for(const v of g)v()}finally{Qh(h),en(p)}}toString(){const h=[],p=this.records;for(const g of p.keys())h.push(Ne(g));return`R3Injector[${h.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ae(205,!1)}processProvider(h){let p=Rc(h=X(h))?h:X(h&&h.provide);const g=function Vw(d){return Lw(d)?km(void 0,d.useValue):km(OS(d),Dm)}(h);if(Rc(h)||!0!==h.multi)this.records.get(p);else{let v=this.records.get(p);v||(v=km(void 0,Dm,!0),v.factory=()=>tw(v.multi),this.records.set(p,v)),p=h,v.multi.push(h)}this.records.set(p,g)}hydrate(h,p){return p.value===Dm&&(p.value=hU,p.value=p.factory()),"object"==typeof p.value&&p.value&&function fU(d){return null!==d&&"object"==typeof d&&"function"==typeof d.ngOnDestroy}(p.value)&&this._ngOnDestroyHooks.add(p.value),p.value}injectableDefInScope(h){if(!h.providedIn)return!1;const p=X(h.providedIn);return"string"==typeof p?"any"===p||this.scopes.has(p):this.injectorDefTypes.has(p)}}function MS(d){const h=Qt(d),p=null!==h?h.factory:ko(d);if(null!==p)return p;if(d instanceof wr)throw new Ae(204,!1);if(d instanceof Function)return function hM(d){const h=d.length;if(h>0)throw Cu(h,"?"),new Ae(204,!1);const p=function _n(d){const h=d&&(d[Ls]||d[lr]);if(h){const p=function Fr(d){if(d.hasOwnProperty("name"))return d.name;const h=(""+d).match(/^function\s*([^\s(]+)/);return null===h?"":h[1]}(d);return console.warn(`DEPRECATED: DI is instantiating a token "${p}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${p}" class.`),h}return null}(d);return null!==p?()=>p.factory(d):()=>new d}(d);throw new Ae(204,!1)}function OS(d,h,p){let g;if(Rc(d)){const v=X(d);return ko(v)||MS(v)}if(Lw(d))g=()=>X(d.useValue);else if(function NS(d){return!(!d||!d.useFactory)}(d))g=()=>d.useFactory(...tw(d.deps||[]));else if(function uM(d){return!(!d||!d.useExisting)}(d))g=()=>gi(X(d.useExisting));else{const v=X(d&&(d.useClass||d.provide));if(!function fM(d){return!!d.deps}(d))return ko(v)||MS(v);g=()=>new v(...tw(d.deps))}return g}function km(d,h,p=!1){return{factory:d,value:h,multi:p?[]:void 0}}function mU(d){return!!d.\u0275providers}function FS(d,h){for(const p of d)Array.isArray(p)?FS(p,h):mU(p)?FS(p.\u0275providers,h):h(p)}class pM{}class yU{resolveComponentFactory(h){throw function mM(d){const h=Error(`No component factory found for ${Ne(d)}. Did you add it to @NgModule.entryComponents?`);return h.ngComponent=d,h}(h)}}let zw=(()=>{class d{}return d.NULL=new yU,d})();function G9(){return sv(mi(),st())}function sv(d,h){return new Dn(so(d,h))}let Dn=(()=>{class d{constructor(p){this.nativeElement=p}}return d.__NG_ELEMENT_ID__=G9,d})();function Cr(d){return d instanceof Dn?d.nativeElement:d}class gM{}let vU=(()=>{class d{}return d.__NG_ELEMENT_ID__=()=>function bU(){const d=st(),p=qi(mi().index,d);return(vs(p)?p:d)[11]}(),d})(),_M=(()=>{class d{}return d.\u0275prov=Te({token:d,providedIn:"root",factory:()=>null}),d})();class yM{constructor(h){this.full=h,this.major=h.split(".")[0],this.minor=h.split(".")[1],this.patch=h.split(".").slice(2).join(".")}}const Ru=new yM("14.3.0"),Mu={};function PS(d){return d.ngOriginalError}class ov{constructor(){this._console=console}handleError(h){const p=this._findOriginalError(h);this._console.error("ERROR",h),p&&this._console.error("ORIGINAL ERROR",p)}_findOriginalError(h){let p=h&&PS(h);for(;p&&PS(p);)p=PS(p);return p||null}}function Ou(d){return d instanceof Function?d():d}function ls(d,h,p){let g=d.length;for(;;){const v=d.indexOf(h,p);if(-1===v)return v;if(0===v||d.charCodeAt(v-1)<=32){const x=h.length;if(v+x===g||d.charCodeAt(v+x)<=32)return v}p=v+1}}const CM="ng-template";function cn(d,h,p){let g=0;for(;g<d.length;){let v=d[g++];if(p&&"class"===v){if(v=d[g],-1!==ls(v.toLowerCase(),h,0))return!0}else if(1===v){for(;g<d.length&&"string"==typeof(v=d[g++]);)if(v.toLowerCase()===h)return!0;return!1}}return!1}function $S(d){return 4===d.type&&d.value!==CM}function xM(d,h,p){return h===(4!==d.type||p?d.value:CM)}function IM(d,h,p){let g=4;const v=d.attrs||[],x=function EM(d){for(let h=0;h<d.length;h++)if(BR(d[h]))return h;return d.length}(v);let D=!1;for(let N=0;N<h.length;N++){const R=h[N];if("number"!=typeof R){if(!D)if(4&g){if(g=2|1&g,""!==R&&!xM(d,R,p)||""===R&&1===h.length){if(fl(g))return!1;D=!0}}else{const F=8&g?R:h[++N];if(8&g&&null!==d.attrs){if(!cn(d.attrs,F,p)){if(fl(g))return!1;D=!0}continue}const Y=TM(8&g?"class":R,v,$S(d),p);if(-1===Y){if(fl(g))return!1;D=!0;continue}if(""!==F){let de;de=Y>x?"":v[Y+1].toLowerCase();const De=8&g?de:null;if(De&&-1!==ls(De,F,0)||2&g&&F!==de){if(fl(g))return!1;D=!0}}}}else{if(!D&&!fl(g)&&!fl(R))return!1;if(D&&fl(R))continue;D=!1,g=R|1&g}}return fl(g)||D}function fl(d){return 0==(1&d)}function TM(d,h,p,g){if(null===h)return-1;let v=0;if(g||!p){let x=!1;for(;v<h.length;){const D=h[v];if(D===d)return v;if(3===D||6===D)x=!0;else{if(1===D||2===D){let N=h[++v];for(;"string"==typeof N;)N=h[++v];continue}if(4===D)break;if(0===D){v+=4;continue}}v+=x?1:2}return-1}return function Hw(d,h){let p=d.indexOf(4);if(p>-1)for(p++;p<d.length;){const g=d[p];if("number"==typeof g)return-1;if(g===h)return p;p++}return-1}(h,d)}function BS(d,h,p=!1){for(let g=0;g<h.length;g++)if(IM(d,h[g],p))return!0;return!1}function DM(d,h){e:for(let p=0;p<h.length;p++){const g=h[p];if(d.length===g.length){for(let v=0;v<d.length;v++)if(d[v]!==g[v])continue e;return!0}}return!1}function VS(d,h){return d?":not("+h.trim()+")":h}function kM(d){let h=d[0],p=1,g=2,v="",x=!1;for(;p<d.length;){let D=d[p];if("string"==typeof D)if(2&g){const N=d[++p];v+="["+D+(N.length>0?'="'+N+'"':"")+"]"}else 8&g?v+="."+D:4&g&&(v+=" "+D);else""!==v&&!fl(D)&&(h+=VS(x,v),v=""),g=D,x=x||!fl(g);p++}return""!==v&&(h+=VS(x,v)),h}const Mn={};function US(d){Gw(Yn(),st(),tr()+d,!1)}function Gw(d,h,p,g){if(!g)if(3==(3&h[2])){const x=d.preOrderCheckHooks;null!==x&&oy(h,x,p)}else{const x=d.preOrderHooks;null!==x&&vu(h,x,0,p)}jl(p)}function WS(d,h=null,p=null,g){const v=lo(d,h,p,g);return v.resolveInjectorInitializers(),v}function lo(d,h=null,p=null,g,v=new Set){const x=[p||In,cM(d)];return g=g||("object"==typeof d?void 0:Ne(d)),new dM(x,h||Bw(),g||null,v)}let co=(()=>{class d{static create(p,g){if(Array.isArray(p))return WS({name:""},g,p,"");{const v=p.name??"";return WS({name:v},p.parent,p.providers,v)}}}return d.THROW_IF_NOT_FOUND=Zl,d.NULL=new kS,d.\u0275prov=Te({token:d,providedIn:"any",factory:()=>gi(iv)}),d.__NG_ELEMENT_ID__=-1,d})();function Pu(d,h=Mt.Default){const p=st();return null===p?gi(d,h):Td(mi(),p,X(d),h)}function YS(){throw new Error("invalid")}function Tf(d,h){return d<<17|h<<2}function Fo(d){return d>>17&32767}function Kw(d){return 2|d}function zd(d){return(131068&d)>>2}function Am(d,h){return-131069&d|h<<2}function Rm(d){return 1|d}function iE(d,h){const p=d.contentQueries;if(null!==p)for(let g=0;g<p.length;g+=2){const v=p[g],x=p[g+1];if(-1!==x){const D=d.data[x];Bh(v),D.contentQueries(2,h[x],x)}}}function rC(d,h,p,g,v,x,D,N,R,F,H){const Y=h.blueprint.slice();return Y[0]=v,Y[2]=76|g,(null!==H||d&&1024&d[2])&&(Y[2]|=1024),wd(Y),Y[3]=Y[15]=d,Y[8]=p,Y[10]=D||d&&d[10],Y[11]=N||d&&d[11],Y[12]=R||d&&d[12]||null,Y[9]=F||d&&d[9]||null,Y[6]=x,Y[20]=function mS(){return pS++}(),Y[21]=H,Y[16]=2==h.type?d[16]:Y,Y}function Df(d,h,p,g,v){let x=d.data[h];if(null===x)x=function fv(d,h,p,g,v){const x=Bp(),D=Cd(),R=d.data[h]=function KU(d,h,p,g,v,x){return{type:p,index:g,insertBeforeIndex:null,injectorIndex:h?h.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:v,attrs:x,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:h,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,D?x:x&&x.parent,p,h,g,v);return null===d.firstChild&&(d.firstChild=R),null!==x&&(D?null==x.child&&null!==R.parent&&(x.child=R):null===x.next&&(x.next=R)),R}(d,h,p,g,v),function Q_(){return Tn.lFrame.inI18n}()&&(x.flags|=64);else if(64&x.type){x.type=p,x.value=g,x.attrs=v;const D=function yu(){const d=Tn.lFrame,h=d.currentTNode;return d.isParent?h:h.parent}();x.injectorIndex=null===D?-1:D.injectorIndex}return ia(x,!0),x}function Om(d,h,p,g){if(0===p)return-1;const v=h.length;for(let x=0;x<p;x++)h.push(g),d.blueprint.push(g),d.data.push(null);return v}function iC(d,h,p){ey(h);try{const g=d.viewQuery;null!==g&&Nf(1,g,p);const v=d.template;null!==v&&Jl(d,h,v,1,p),d.firstCreatePass&&(d.firstCreatePass=!1),d.staticContentQueries&&iE(d,h),d.staticViewQueries&&Nf(2,d.viewQuery,p);const x=d.components;null!==x&&function jM(d,h){for(let p=0;p<h.length;p++)nz(d,h[p])}(h,x)}catch(g){throw d.firstCreatePass&&(d.incompleteFirstPass=!0,d.firstCreatePass=!1),g}finally{h[2]&=-5,ny()}}function sC(d,h,p,g){const v=h[2];if(128!=(128&v)){ey(h);try{wd(h),function Up(d){return Tn.lFrame.bindingIndex=d}(d.bindingStartIndex),null!==p&&Jl(d,h,p,2,g);const D=3==(3&v);if(D){const F=d.preOrderCheckHooks;null!==F&&oy(h,F,null)}else{const F=d.preOrderHooks;null!==F&&vu(h,F,0,null),ay(h,0)}if(function o7(d){for(let h=_w(d);null!==h;h=yw(h)){if(!h[2])continue;const p=h[9];for(let g=0;g<p.length;g++){const v=p[g],x=v[3];0==(512&v[2])&&bs(x,1),v[2]|=512}}}(h),function s7(d){for(let h=_w(d);null!==h;h=yw(h))for(let p=10;p<h.length;p++){const g=h[p],v=g[1];Wl(g)&&sC(v,g,v.template,g[8])}}(h),null!==d.contentQueries&&iE(d,h),D){const F=d.contentCheckHooks;null!==F&&oy(h,F)}else{const F=d.contentHooks;null!==F&&vu(h,F,1),ay(h,1)}!function t7(d,h){const p=d.hostBindingOpCodes;if(null!==p)try{for(let g=0;g<p.length;g++){const v=p[g];if(v<0)jl(~v);else{const x=v,D=p[++g],N=p[++g];QT(D,x),N(2,h[x])}}}finally{jl(-1)}}(d,h);const N=d.components;null!==N&&function qU(d,h){for(let p=0;p<h.length;p++)a7(d,h[p])}(h,N);const R=d.viewQuery;if(null!==R&&Nf(2,R,g),D){const F=d.viewCheckHooks;null!==F&&oy(h,F)}else{const F=d.viewHooks;null!==F&&vu(h,F,2),ay(h,2)}!0===d.firstUpdatePass&&(d.firstUpdatePass=!1),h[2]&=-41,512&h[2]&&(h[2]&=-513,bs(h[3],-1))}finally{ny()}}}function Jl(d,h,p,g,v){const x=tr(),D=2&g;try{jl(-1),D&&h.length>22&&Gw(d,h,22,!1),p(g,v)}finally{jl(x)}}function qM(d,h,p){if(yd(h)){const v=h.directiveEnd;for(let x=h.directiveStart;x<v;x++){const D=d.data[x];D.contentQueries&&D.contentQueries(1,p[x],x)}}}function kf(d,h,p){!R0()||(function JU(d,h,p,g){const v=p.directiveStart,x=p.directiveEnd;d.firstCreatePass||Zp(p,h),Zi(g,h);const D=p.initialInputs;for(let N=v;N<x;N++){const R=d.data[N],F=na(R);F&&eO(h,p,R);const H=Gh(h,d,N,p);Zi(H,h),null!==D&&tz(0,N-v,H,R,0,D),F&&(qi(p.index,h)[8]=H)}}(d,h,p,so(p,h)),128==(128&p.flags)&&function lE(d,h,p){const g=p.directiveStart,v=p.directiveEnd,x=p.index,D=function X_(){return Tn.lFrame.currentDirectiveIndex}();try{jl(x);for(let N=g;N<v;N++){const R=d.data[N],F=h[N];J_(N),(null!==R.hostBindings||0!==R.hostVars||null!==R.hostAttrs)&&QM(R,F)}}finally{jl(-1),J_(D)}}(d,h,p))}function sE(d,h,p=so){const g=h.localNames;if(null!==g){let v=h.index+1;for(let x=0;x<g.length;x+=2){const D=g[x+1],N=-1===D?p(h,d):d[D];d[v++]=N}}}function oC(d){const h=d.tView;return null===h||h.incompleteFirstPass?d.tView=aC(1,null,d.template,d.decls,d.vars,d.directiveDefs,d.pipeDefs,d.viewQuery,d.schemas,d.consts):h}function aC(d,h,p,g,v,x,D,N,R,F){const H=22+g,Y=H+v,de=function ZU(d,h){const p=[];for(let g=0;g<h;g++)p.push(g<d?null:Mn);return p}(H,Y),De="function"==typeof F?F():F;return de[1]={type:d,blueprint:de,template:p,queries:null,viewQuery:N,declTNode:h,data:de.slice().fill(null,H),bindingStartIndex:H,expandoStartIndex:Y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof x?x():x,pipeRegistry:"function"==typeof D?D():D,firstChild:null,schemas:R,consts:De,incompleteFirstPass:!1}}function oE(d,h,p,g){const v=iz(h);null===p?v.push(g):(v.push(p),d.firstCreatePass&&sz(d).push(g,v.length-1))}function lC(d,h,p){for(let g in d)if(d.hasOwnProperty(g)){const v=d[g];(p=null===p?{}:p).hasOwnProperty(g)?p[g].push(h,v):p[g]=[h,v]}return p}function ZM(d,h){const g=h.directiveEnd,v=d.data,x=h.attrs,D=[];let N=null,R=null;for(let F=h.directiveStart;F<g;F++){const H=v[F],Y=H.inputs,de=null===x||$S(h)?null:Pm(Y,x);D.push(de),N=lC(Y,F,N),R=lC(H.outputs,F,R)}null!==N&&(N.hasOwnProperty("class")&&(h.flags|=16),N.hasOwnProperty("style")&&(h.flags|=32)),h.initialInputs=D,h.inputs=N,h.outputs=R}function la(d,h,p,g,v,x,D,N){const R=so(h,p);let H,F=h.inputs;!N&&null!=F&&(H=F[g])?(Po(d,p,H,g,v),Op(h)&&YM(p,h.index)):3&h.type&&(g=function QU(d){return"class"===d?"className":"for"===d?"htmlFor":"formaction"===d?"formAction":"innerHtml"===d?"innerHTML":"readonly"===d?"readOnly":"tabindex"===d?"tabIndex":d}(g),v=null!=D?D(v,h.value||"",g):v,x.setProperty(R,g,v))}function YM(d,h){const p=qi(h,d);16&p[2]||(p[2]|=32)}function cC(d,h,p,g){let v=!1;if(R0()){const x=function cE(d,h,p){const g=d.directiveRegistry;let v=null;if(g)for(let x=0;x<g.length;x++){const D=g[x];BS(p,D.selectors,!1)&&(v||(v=[]),hy(Zp(p,h),d,D.type),na(D)?(XM(d,p),v.unshift(D)):v.push(D))}return v}(d,h,p),D=null===g?null:{"":-1};if(null!==x){v=!0,uC(p,d.data.length,x.length);for(let H=0;H<x.length;H++){const Y=x[H];Y.providersResolver&&Y.providersResolver(Y)}let N=!1,R=!1,F=Om(d,h,x.length,null);for(let H=0;H<x.length;H++){const Y=x[H];p.mergedAttrs=dy(p.mergedAttrs,Y.hostAttrs),JM(d,p,h,F,Y),uE(F,Y,D),null!==Y.contentQueries&&(p.flags|=8),(null!==Y.hostBindings||null!==Y.hostAttrs||0!==Y.hostVars)&&(p.flags|=128);const de=Y.type.prototype;!N&&(de.ngOnChanges||de.ngOnInit||de.ngDoCheck)&&((d.preOrderHooks||(d.preOrderHooks=[])).push(p.index),N=!0),!R&&(de.ngOnChanges||de.ngDoCheck)&&((d.preOrderCheckHooks||(d.preOrderCheckHooks=[])).push(p.index),R=!0),F++}ZM(d,p)}D&&function ez(d,h,p){if(h){const g=d.localNames=[];for(let v=0;v<h.length;v+=2){const x=p[h[v+1]];if(null==x)throw new Ae(-301,!1);g.push(h[v],x)}}}(p,g,D)}return p.mergedAttrs=dy(p.mergedAttrs,p.attrs),v}function aE(d,h,p,g,v,x){const D=x.hostBindings;if(D){let N=d.hostBindingOpCodes;null===N&&(N=d.hostBindingOpCodes=[]);const R=~h.index;(function Af(d){let h=d.length;for(;h>0;){const p=d[--h];if("number"==typeof p&&p<0)return p}return 0})(N)!=R&&N.push(R),N.push(g,v,D)}}function QM(d,h){null!==d.hostBindings&&d.hostBindings(1,h)}function XM(d,h){h.flags|=2,(d.components||(d.components=[])).push(h.index)}function uE(d,h,p){if(p){if(h.exportAs)for(let g=0;g<h.exportAs.length;g++)p[h.exportAs[g]]=d;na(h)&&(p[""]=d)}}function uC(d,h,p){d.flags|=1,d.directiveStart=h,d.directiveEnd=h+p,d.providerIndexes=h}function JM(d,h,p,g,v){d.data[g]=v;const x=v.factory||(v.factory=ko(v.type)),D=new Uh(x,na(v),Pu);d.blueprint[g]=D,p[g]=D,aE(d,h,0,g,Om(d,p,v.hostVars,Mn),v)}function eO(d,h,p){const g=so(h,d),v=oC(p),x=d[10],D=pv(d,rC(d,v,null,p.onPush?32:16,g,h,x,x.createRenderer(g,p),null,null,null));d[h.index]=D}function Mc(d,h,p,g,v,x){const D=so(d,h);!function dC(d,h,p,g,v,x,D){if(null==x)d.removeAttribute(h,v,p);else{const N=null==D?$e(x):D(x,g||"",v);d.setAttribute(h,v,N,p)}}(h[11],D,x,d.value,p,g,v)}function tz(d,h,p,g,v,x){const D=x[h];if(null!==D){const N=g.setInput;for(let R=0;R<D.length;){const F=D[R++],H=D[R++],Y=D[R++];null!==N?g.setInput(p,Y,F,H):p[H]=Y}}}function Pm(d,h){let p=null,g=0;for(;g<h.length;){const v=h[g];if(0!==v)if(5!==v){if("number"==typeof v)break;d.hasOwnProperty(v)&&(null===p&&(p=[]),p.push(v,d[v],h[g+1])),g+=2}else g+=2;else g+=4}return p}function dE(d,h,p,g){return new Array(d,!0,!1,h,null,0,g,p,null,null)}function a7(d,h){const p=qi(h,d);if(Wl(p)){const g=p[1];48&p[2]?sC(g,p,g.template,p[8]):p[5]>0&&hC(p)}}function hC(d){for(let g=_w(d);null!==g;g=yw(g))for(let v=10;v<g.length;v++){const x=g[v];if(Wl(x))if(512&x[2]){const D=x[1];sC(D,x,D.template,x[8])}else x[5]>0&&hC(x)}const p=d[1].components;if(null!==p)for(let g=0;g<p.length;g++){const v=qi(p[g],d);Wl(v)&&v[5]>0&&hC(v)}}function nz(d,h){const p=qi(h,d),g=p[1];(function tO(d,h){for(let p=h.length;p<d.blueprint.length;p++)h.push(d.blueprint[p])})(g,p),iC(g,p,p[8])}function pv(d,h){return d[13]?d[14][4]=h:d[13]=h,d[14]=h,h}function nO(d){for(;d;){d[2]|=32;const h=$a(d);if(Mh(d)&&!h)return d;d=h}return null}function hE(d,h,p,g=!0){const v=h[10];v.begin&&v.begin();try{sC(d,h,d.template,p)}catch(D){throw g&&Cs(h,D),D}finally{v.end&&v.end()}}function Nf(d,h,p){Bh(0),h(d,p)}function iz(d){return d[7]||(d[7]=[])}function sz(d){return d.cleanup||(d.cleanup=[])}function St(d,h,p){return(null===d||na(d))&&(p=function Hl(d){for(;Array.isArray(d);){if("object"==typeof d[1])return d;d=d[0]}return null}(p[h.index])),p[11]}function Cs(d,h){const p=d[9],g=p?p.get(ov,null):null;g&&g.handleError(h)}function Po(d,h,p,g,v){for(let x=0;x<p.length;){const D=p[x++],N=p[x++],R=h[D],F=d.data[D];null!==F.setInput?F.setInput(R,v,g,N):R[N]=v}}function uo(d,h,p){const g=Gl(h,d);!function _m(d,h,p){d.setValue(h,p)}(d[11],g,p)}function ti(d,h,p){let g=p?d.styles:null,v=p?d.classes:null,x=0;if(null!==h)for(let D=0;D<h.length;D++){const N=h[D];"number"==typeof N?x=N:1==x?v=ne(v,N):2==x&&(g=ne(g,N+": "+h[++D]+";"))}p?d.styles=g:d.stylesWithoutHost=g,p?d.classes=v:d.classesWithoutHost=v}function cr(d,h,p,g,v=!1){for(;null!==p;){const x=h[p.index];if(null!==x&&g.push(oi(x)),ka(x))for(let N=10;N<x.length;N++){const R=x[N],F=R[1].firstChild;null!==F&&cr(R[1],R,F,g)}const D=p.type;if(8&D)cr(d,h,p.child,g);else if(32&D){const N=sf(p,h);let R;for(;R=N();)g.push(R)}else if(16&D){const N=Iw(h,p);if(Array.isArray(N))g.push(...N);else{const R=$a(h[16]);cr(R[1],R,N,g,!0)}}p=v?p.projectionNext:p.next}return g}class Lm{constructor(h,p){this._lView=h,this._cdRefInjectingView=p,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const h=this._lView,p=h[1];return cr(p,h,p.firstChild,[])}get context(){return this._lView[8]}set context(h){this._lView[8]=h}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const h=this._lView[3];if(ka(h)){const p=h[8],g=p?p.indexOf(this):-1;g>-1&&(Ba(h,g),wy(p,g))}this._attachedToViewContainer=!1}Cm(this._lView[1],this._lView)}onDestroy(h){oE(this._lView[1],this._lView,null,h)}markForCheck(){nO(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){hE(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ae(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function vm(d,h){Fd(d,h,h[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(h){if(this._attachedToViewContainer)throw new Ae(902,!1);this._appRef=h}}class rO extends Lm{constructor(h){super(h),this._view=h}detectChanges(){const h=this._view;hE(h[1],h,h[8],!1)}checkNoChanges(){}get context(){return null}}class ec extends zw{constructor(h){super(),this.ngModule=h}resolveComponentFactory(h){const p=Ge(h);return new mv(p,this.ngModule)}}function oz(d){const h=[];for(let p in d)d.hasOwnProperty(p)&&h.push({propName:d[p],templateName:p});return h}class lz{constructor(h,p){this.injector=h,this.parentInjector=p}get(h,p,g){const v=this.injector.get(h,Mu,g);return v!==Mu||p===Mu?v:this.parentInjector.get(h,p,g)}}class mv extends pM{constructor(h,p){super(),this.componentDef=h,this.ngModule=p,this.componentType=h.type,this.selector=function AM(d){return d.map(kM).join(",")}(h.selectors),this.ngContentSelectors=h.ngContentSelectors?h.ngContentSelectors:[],this.isBoundToModule=!!p}get inputs(){return oz(this.componentDef.inputs)}get outputs(){return oz(this.componentDef.outputs)}create(h,p,g,v){let x=(v=v||this.ngModule)instanceof _f?v:v?.injector;x&&null!==this.componentDef.getStandaloneInjector&&(x=this.componentDef.getStandaloneInjector(x)||x);const D=x?new lz(h,x):h,N=D.get(gM,null);if(null===N)throw new Ae(407,!1);const R=D.get(_M,null),F=N.createRenderer(null,this.componentDef),H=this.componentDef.selectors[0][0]||"div",Y=g?function YU(d,h,p){return d.selectRootElement(h,p===Eo.ShadowDom)}(F,g,this.componentDef.encapsulation):ym(F,H,function az(d){const h=d.toLowerCase();return"svg"===h?"svg":"math"===h?"math":null}(H)),de=this.componentDef.onPush?288:272,De=aC(0,null,null,1,0,null,null,null,null,null),rt=rC(null,De,null,de,null,null,N,F,R,D,null);let Tt,mt;ey(rt);try{const gt=function l7(d,h,p,g,v,x){const D=p[1];p[22]=d;const R=Df(D,22,2,"#host",null),F=R.mergedAttrs=h.hostAttrs;null!==F&&(ti(R,F,!0),null!==d&&(uy(v,d,F),null!==R.classes&&Tw(v,d,R.classes),null!==R.styles&&Gy(v,d,R.styles)));const H=g.createRenderer(d,h),Y=rC(p,oC(h),null,h.onPush?32:16,p[22],R,g,H,x||null,null,null);return D.firstCreatePass&&(hy(Zp(R,p),D,h.type),XM(D,R),uC(R,p.length,1)),pv(p,Y),p[22]=Y}(Y,this.componentDef,rt,N,F);if(Y)if(g)uy(F,Y,["ng-version",Ru.full]);else{const{attrs:Yt,classes:lt}=function TU(d){const h=[],p=[];let g=1,v=2;for(;g<d.length;){let x=d[g];if("string"==typeof x)2===v?""!==x&&h.push(x,d[++g]):8===v&&p.push(x);else{if(!fl(v))break;v=x}g++}return{attrs:h,classes:p}}(this.componentDef.selectors[0]);Yt&&uy(F,Y,Yt),lt&&lt.length>0&&Tw(F,Y,lt.join(" "))}if(mt=$p(De,22),void 0!==p){const Yt=mt.projection=[];for(let lt=0;lt<this.ngContentSelectors.length;lt++){const Cn=p[lt];Yt.push(null!=Cn?Array.from(Cn):null)}}Tt=function dz(d,h,p,g){const v=p[1],x=function XU(d,h,p){const g=mi();d.firstCreatePass&&(p.providersResolver&&p.providersResolver(p),JM(d,g,h,Om(d,h,1,null),p),ZM(d,g));const v=Gh(h,d,g.directiveStart,g);Zi(v,h);const x=so(g,h);return x&&Zi(x,h),v}(v,p,h);if(d[8]=p[8]=x,null!==g)for(const N of g)N(x,h);if(h.contentQueries){const N=mi();h.contentQueries(1,x,N.directiveStart)}const D=mi();return!v.firstCreatePass||null===h.hostBindings&&null===h.hostAttrs||(jl(D.index),aE(p[1],D,0,D.directiveStart,D.directiveEnd,h),QM(h,x)),x}(gt,this.componentDef,rt,[hz]),iC(De,rt,null)}finally{ny()}return new fC(this.componentType,Tt,sv(mt,rt),rt,mt)}}class fC extends class gU{}{constructor(h,p,g,v,x){super(),this.location=g,this._rootLView=v,this._tNode=x,this.instance=p,this.hostView=this.changeDetectorRef=new rO(v),this.componentType=h}setInput(h,p){const g=this._tNode.inputs;let v;if(null!==g&&(v=g[h])){const x=this._rootLView;Po(x[1],x,v,h,p),YM(x,this._tNode.index)}}get injector(){return new ol(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(h){this.hostView.onDestroy(h)}}function hz(){const d=mi();Vh(st()[1],d)}function pC(d){let h=function fE(d){return Object.getPrototypeOf(d.prototype).constructor}(d.type),p=!0;const g=[d];for(;h;){let v;if(na(d))v=h.\u0275cmp||h.\u0275dir;else{if(h.\u0275cmp)throw new Ae(903,!1);v=h.\u0275dir}if(v){if(p){g.push(v);const D=d;D.inputs=pE(d.inputs),D.declaredInputs=pE(d.declaredInputs),D.outputs=pE(d.outputs);const N=v.hostBindings;N&&mE(d,N);const R=v.viewQuery,F=v.contentQueries;if(R&&gv(d,R),F&&Yi(d,F),tt(d.inputs,v.inputs),tt(d.declaredInputs,v.declaredInputs),tt(d.outputs,v.outputs),na(v)&&v.data.animation){const H=d.data;H.animation=(H.animation||[]).concat(v.data.animation)}}const x=v.features;if(x)for(let D=0;D<x.length;D++){const N=x[D];N&&N.ngInherit&&N(d),N===pC&&(p=!1)}}h=Object.getPrototypeOf(h)}!function iO(d){let h=0,p=null;for(let g=d.length-1;g>=0;g--){const v=d[g];v.hostVars=h+=v.hostVars,v.hostAttrs=dy(v.hostAttrs,p=dy(p,v.hostAttrs))}}(g)}function pE(d){return d===Ai?{}:d===In?[]:d}function gv(d,h){const p=d.viewQuery;d.viewQuery=p?(g,v)=>{h(g,v),p(g,v)}:h}function Yi(d,h){const p=d.contentQueries;d.contentQueries=p?(g,v,x)=>{h(g,v,x),p(g,v,x)}:h}function mE(d,h){const p=d.hostBindings;d.hostBindings=p?(g,v)=>{h(g,v),p(g,v)}:h}let $m=null;function Oc(){if(!$m){const d=Pr.Symbol;if(d&&d.iterator)$m=d.iterator;else{const h=Object.getOwnPropertyNames(Map.prototype);for(let p=0;p<h.length;++p){const g=h[p];"entries"!==g&&"size"!==g&&Map.prototype[g]===Map.prototype.entries&&($m=g)}}}return $m}function Bm(d){return!!oO(d)&&(Array.isArray(d)||!(d instanceof Map)&&Oc()in d)}function oO(d){return null!==d&&("function"==typeof d||"object"==typeof d)}function Lu(d,h,p){return d[h]=p}function Lo(d,h,p){return!Object.is(d[h],p)&&(d[h]=p,!0)}function Vm(d,h,p,g){const v=Lo(d,h,p);return Lo(d,h+1,g)||v}function yE(d,h,p,g){const v=st();return Lo(v,Ro(),h)&&(Yn(),Mc(ai(),v,d,h,p,g)),yE}function Mf(d,h,p,g){return Lo(d,Ro(),p)?h+$e(p)+g:Mn}function Wd(d,h,p,g,v,x,D,N){const F=function _E(d,h,p,g,v){const x=Vm(d,h,p,g);return Lo(d,h+2,v)||x}(d,sa(),p,v,D);return Oa(3),F?h+$e(p)+g+$e(v)+x+$e(D)+N:Mn}function Of(d,h,p,g,v,x,D,N,R,F){const Y=function tc(d,h,p,g,v,x){const D=Vm(d,h,p,g);return Vm(d,h+2,v,x)||D}(d,sa(),p,v,D,R);return Oa(4),Y?h+$e(p)+g+$e(v)+x+$e(D)+N+$e(R)+F:Mn}function yC(d,h,p,g,v,x,D,N){const R=st(),F=Yn(),H=d+22,Y=F.firstCreatePass?function _C(d,h,p,g,v,x,D,N,R){const F=h.consts,H=Df(h,d,4,D||null,Ma(F,N));cC(h,p,H,Ma(F,R)),Vh(h,H);const Y=H.tViews=aC(2,H,g,v,x,h.directiveRegistry,h.pipeRegistry,null,h.schemas,F);return null!==h.queries&&(h.queries.template(h,H),Y.queries=h.queries.embeddedTView(H)),H}(H,F,R,h,p,g,v,x,D):F.data[H];ia(Y,!1);const de=R[11].createComment("");xm(F,R,de,Y),Zi(de,R),pv(R,R[H]=dE(de,R,de,Y)),Ul(Y)&&kf(F,R,Y),null!=D&&sE(R,Y,N)}function bv(d){return bd(function KT(){return Tn.lFrame.contextLView}(),22+d)}function Fc(d,h,p){const g=st();return Lo(g,Ro(),h)&&la(Yn(),ai(),g,d,h,g[11],p,!1),Fc}function bE(d,h,p,g,v){const D=v?"class":"style";Po(d,p,h.inputs[D],D,g)}function Gm(d,h,p,g){const v=st(),x=Yn(),D=22+d,N=v[11],R=v[D]=ym(N,h,function sy(){return Tn.lFrame.currentNamespace}()),F=x.firstCreatePass?function cs(d,h,p,g,v,x,D){const N=h.consts,F=Df(h,d,2,v,Ma(N,x));return cC(h,p,F,Ma(N,D)),null!==F.attrs&&ti(F,F.attrs,!1),null!==F.mergedAttrs&&ti(F,F.mergedAttrs,!0),null!==h.queries&&h.queries.elementStart(h,F),F}(D,x,v,0,h,p,g):x.data[D];ia(F,!0);const H=F.mergedAttrs;null!==H&&uy(N,R,H);const Y=F.classes;null!==Y&&Tw(N,R,Y);const de=F.styles;return null!==de&&Gy(N,R,de),64!=(64&F.flags)&&xm(x,v,R,F),0===function Ph(){return Tn.lFrame.elementDepthCount}()&&Zi(R,v),function A0(){Tn.lFrame.elementDepthCount++}(),Ul(F)&&(kf(x,v,F),qM(x,F,v)),null!==g&&sE(v,F),Gm}function wn(){let d=mi();Cd()?K_():(d=d.parent,ia(d,!1));const h=d;!function N0(){Tn.lFrame.elementDepthCount--}();const p=Yn();return p.firstCreatePass&&(Vh(p,d),yd(d)&&p.queries.elementEnd(d)),null!=h.classesWithoutHost&&function $R(d){return 0!=(16&d.flags)}(h)&&bE(p,h,st(),h.classesWithoutHost,!0),null!=h.stylesWithoutHost&&function eS(d){return 0!=(32&d.flags)}(h)&&bE(p,h,st(),h.stylesWithoutHost,!1),wn}function wE(d,h,p,g){return Gm(d,h,p,g),wn(),wE}function Pc(d,h,p){const g=st(),v=Yn(),x=d+22,D=v.firstCreatePass?function Ff(d,h,p,g,v){const x=h.consts,D=Ma(x,g),N=Df(h,d,8,"ng-container",D);return null!==D&&ti(N,D,!0),cC(h,p,N,Ma(x,v)),null!==h.queries&&h.queries.elementStart(h,N),N}(x,v,g,h,p):v.data[x];ia(D,!0);const N=g[x]=g[11].createComment("");return xm(v,g,N,D),Zi(N,g),Ul(D)&&(kf(v,g,D),qM(v,D,g)),null!=p&&sE(g,D),Pc}function $u(){let d=mi();const h=Yn();return Cd()?K_():(d=d.parent,ia(d,!1)),h.firstCreatePass&&(Vh(h,d),yd(d)&&h.queries.elementEnd(d)),$u}function CE(d,h,p){return Pc(d,h,p),$u(),CE}function vC(){return st()}function xE(d){return!!d&&"function"==typeof d.then}function cO(d){return!!d&&"function"==typeof d.subscribe}const An=cO;function IE(d,h,p,g){const v=st(),x=Yn(),D=mi();return W(x,v,v[11],D,d,h,0,g),IE}function TE(d,h){const p=mi(),g=st(),v=Yn();return W(v,g,St($h(v.data),p,g),p,d,h),TE}function W(d,h,p,g,v,x,D,N){const R=Ul(g),H=d.firstCreatePass&&sz(d),Y=h[8],de=iz(h);let De=!0;if(3&g.type||N){const mt=so(g,h),gt=N?N(mt):mt,Yt=de.length,lt=N?Un=>N(oi(Un[g.index])):g.index;let Cn=null;if(!N&&R&&(Cn=function q(d,h,p,g){const v=d.cleanup;if(null!=v)for(let x=0;x<v.length-1;x+=2){const D=v[x];if(D===p&&v[x+1]===g){const N=h[7],R=v[x+2];return N.length>R?N[R]:null}"string"==typeof D&&(x+=2)}return null}(d,h,v,g.index)),null!==Cn)(Cn.__ngLastListenerFn__||Cn).__ngNextListenerFn__=x,Cn.__ngLastListenerFn__=x,De=!1;else{x=$o(g,h,Y,x,!1);const Un=p.listen(gt,v,x);de.push(x,Un),H&&H.push(v,lt,Yt,Yt+1)}}else x=$o(g,h,Y,x,!1);const rt=g.outputs;let Tt;if(De&&null!==rt&&(Tt=rt[v])){const mt=Tt.length;if(mt)for(let gt=0;gt<mt;gt+=2){const li=h[Tt[gt]][Tt[gt+1]].subscribe(x),Gf=de.length;de.push(x,li),H&&H.push(v,g.index,Gf,-(Gf+1))}}}function us(d,h,p,g){try{return!1!==p(g)}catch(v){return Cs(d,v),!1}}function $o(d,h,p,g,v){return function x(D){if(D===Function)return g;nO(2&d.flags?qi(d.index,h):h);let R=us(h,0,g,D),F=x.__ngNextListenerFn__;for(;F;)R=us(h,0,F,D)&&R,F=F.__ngNextListenerFn__;return v&&!1===R&&(D.preventDefault(),D.returnValue=!1),R}}function uO(d=1){return function $0(d){return(Tn.lFrame.contextLView=function JT(d,h){for(;d>0;)h=h[15],d--;return h}(d,Tn.lFrame.contextLView))[8]}(d)}function dO(d,h){let p=null;const g=function SM(d){const h=d.attrs;if(null!=h){const p=h.indexOf(5);if(0==(1&p))return h[p+1]}return null}(d);for(let v=0;v<h.length;v++){const x=h[v];if("*"!==x){if(null===g?BS(d,x,!0):DM(g,x))return v}else p=v}return p}function SE(d){const h=st()[16][6];if(!h.projection){const g=h.projection=Cu(d?d.length:1,null),v=g.slice();let x=h.child;for(;null!==x;){const D=d?dO(x,d):0;null!==D&&(v[D]?v[D].projectionNext=x:g[D]=x,v[D]=x),x=x.next}}}function hO(d,h=0,p){const g=st(),v=Yn(),x=Df(v,22+d,16,null,p||null);null===x.projection&&(x.projection=h),K_(),64!=(64&x.flags)&&function Tm(d,h,p){Pd(h[11],0,h,p,$y(d,p,h),xw(p.parent||h[6],p,h))}(v,g,x)}function TC(d,h,p,g,v){const x=d[p+1],D=null===h;let N=g?Fo(x):zd(x),R=!1;for(;0!==N&&(!1===R||D);){const H=d[N+1];bz(d[N],h)&&(R=!0,d[N+1]=g?Rm(H):Kw(H)),N=g?Fo(H):zd(H)}R&&(d[p+1]=g?Kw(x):Rm(x))}function bz(d,h){return null===d||null==h||(Array.isArray(d)?d[1]:d)===h||!(!Array.isArray(d)||"string"!=typeof h)&&Yh(d,h)>=0}const xs={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function _O(d){return d.substring(xs.key,xs.keyEnd)}function kE(d,h){const p=xs.textEnd;return p===h?-1:(h=xs.keyEnd=function vO(d,h,p){for(;h<p&&d.charCodeAt(h)>32;)h++;return h}(d,xs.key=h,p),Pf(d,h,p))}function Pf(d,h,p){for(;h<p&&d.charCodeAt(h)<=32;)h++;return h}function nc(d,h,p){return gl(d,h,p,!1),nc}function EC(d,h){return gl(d,h,null,!0),EC}function ml(d,h){for(let p=function DE(d){return function AE(d){xs.key=0,xs.keyEnd=0,xs.value=0,xs.valueEnd=0,xs.textEnd=d.length}(d),kE(d,Pf(d,0,xs.textEnd))}(h);p>=0;p=kE(h,p))oo(d,_O(h),!0)}function gl(d,h,p,g){const v=st(),x=Yn(),D=Oa(2);x.firstUpdatePass&&kC(x,d,D,g),h!==Mn&&Lo(v,D,h)&&xO(x,x.data[tr()],v,v[11],d,v[D+1]=function IO(d,h){return null==d||("string"==typeof h?d+=h:"object"==typeof d&&(d=Ne(Ri(d)))),d}(h,p),g,D)}function DC(d,h){return h>=d.expandoStartIndex}function kC(d,h,p,g){const v=d.data;if(null===v[p+1]){const x=v[tr()],D=DC(d,p);TO(x,g)&&null===h&&!D&&(h=!1),h=function Iz(d,h,p,g){const v=$h(d);let x=g?h.residualClasses:h.residualStyles;if(null===v)0===(g?h.classBindings:h.styleBindings)&&(p=wv(p=AC(null,d,h,p,g),h.attrs,g),x=null);else{const D=h.directiveStylingLast;if(-1===D||d[D]!==v)if(p=AC(v,d,h,p,g),null===x){let R=function Tz(d,h,p){const g=p?h.classBindings:h.styleBindings;if(0!==zd(g))return d[Fo(g)]}(d,h,g);void 0!==R&&Array.isArray(R)&&(R=AC(null,d,h,R[1],g),R=wv(R,h.attrs,g),function Sz(d,h,p,g){d[Fo(p?h.classBindings:h.styleBindings)]=g}(d,h,g,R))}else x=function RE(d,h,p){let g;const v=h.directiveEnd;for(let x=1+h.directiveStylingLast;x<v;x++)g=wv(g,d[x].hostAttrs,p);return wv(g,h.attrs,p)}(d,h,g)}return void 0!==x&&(g?h.residualClasses=x:h.residualStyles=x),p}(v,x,h,g),function vz(d,h,p,g,v,x){let D=x?h.classBindings:h.styleBindings,N=Fo(D),R=zd(D);d[g]=p;let H,F=!1;if(Array.isArray(p)){const Y=p;H=Y[1],(null===H||Yh(Y,H)>0)&&(F=!0)}else H=p;if(v)if(0!==R){const de=Fo(d[N+1]);d[g+1]=Tf(de,N),0!==de&&(d[de+1]=Am(d[de+1],g)),d[N+1]=function Q9(d,h){return 131071&d|h<<17}(d[N+1],g)}else d[g+1]=Tf(N,0),0!==N&&(d[N+1]=Am(d[N+1],g)),N=g;else d[g+1]=Tf(R,0),0===N?N=g:d[R+1]=Am(d[R+1],g),R=g;F&&(d[g+1]=Kw(d[g+1])),TC(d,H,g,!0),TC(d,H,g,!1),function qd(d,h,p,g,v){const x=v?d.residualClasses:d.residualStyles;null!=x&&"string"==typeof h&&Yh(x,h)>=0&&(p[g+1]=Rm(p[g+1]))}(h,H,d,g,x),D=Tf(N,R),x?h.classBindings=D:h.styleBindings=D}(v,x,h,p,D,g)}}function AC(d,h,p,g,v){let x=null;const D=p.directiveEnd;let N=p.directiveStylingLast;for(-1===N?N=p.directiveStart:N++;N<D&&(x=h[N],g=wv(g,x.hostAttrs,v),x!==d);)N++;return null!==d&&(p.directiveStylingLast=N),g}function wv(d,h,p){const g=p?1:2;let v=-1;if(null!==h)for(let x=0;x<h.length;x++){const D=h[x];"number"==typeof D?v=D:v===g&&(Array.isArray(d)||(d=void 0===d?[]:["",d]),oo(d,D,!!p||h[++x]))}return void 0===d?null:d}function xO(d,h,p,g,v,x,D,N){if(!(3&h.type))return;const R=d.data,F=R[N+1];Bu(function Nm(d){return 1==(1&d)}(F)?Lf(R,h,p,v,zd(F),D):void 0)||(Bu(x)||function FU(d){return 2==(2&d)}(F)&&(x=Lf(R,null,p,v,N,D)),function Hy(d,h,p,g,v){if(h)v?d.addClass(p,g):d.removeClass(p,g);else{let x=-1===g.indexOf("-")?void 0:al.DashCase;null==v?d.removeStyle(p,g,x):("string"==typeof v&&v.endsWith("!important")&&(v=v.slice(0,-10),x|=al.Important),d.setStyle(p,g,v,x))}}(g,D,Gl(tr(),p),v,x))}function Lf(d,h,p,g,v,x){const D=null===h;let N;for(;v>0;){const R=d[v],F=Array.isArray(R),H=F?R[1]:R,Y=null===H;let de=p[v+1];de===Mn&&(de=Y?In:void 0);let De=Y?rm(de,g):H===g?de:void 0;if(F&&!Bu(De)&&(De=rm(R,g)),Bu(De)&&(N=De,D))return N;const rt=d[v+1];v=D?Fo(rt):zd(rt)}if(null!==h){let R=x?h.residualClasses:h.residualStyles;null!=R&&(N=rm(R,g))}return N}function Bu(d){return void 0!==d}function TO(d,h){return 0!=(d.flags&(h?16:32))}function SO(d,h=""){const p=st(),g=Yn(),v=d+22,x=g.firstCreatePass?Df(g,v,1,h,null):g.data[v],D=p[v]=function Rd(d,h){return d.createText(h)}(p[11],h);xm(g,p,D,x),ia(x,!1)}function RC(d){return MC("",d,""),RC}function MC(d,h,p){const g=st(),v=Mf(g,d,h,p);return v!==Mn&&uo(g,tr(),v),MC}function Vu(d,h,p,g,v){const x=st(),D=function Gd(d,h,p,g,v,x){const N=Vm(d,sa(),p,v);return Oa(2),N?h+$e(p)+g+$e(v)+x:Mn}(x,d,h,p,g,v);return D!==Mn&&uo(x,tr(),D),Vu}function OC(d,h,p,g,v,x,D){const N=st(),R=Wd(N,d,h,p,g,v,x,D);return R!==Mn&&uo(N,tr(),R),OC}function FC(d,h,p,g,v,x,D,N,R){const F=st(),H=Of(F,d,h,p,g,v,x,D,N,R);return H!==Mn&&uo(F,tr(),H),FC}function Cv(d,h,p){!function _l(d,h,p,g){const v=Yn(),x=Oa(2);v.firstUpdatePass&&kC(v,null,x,g);const D=st();if(p!==Mn&&Lo(D,x,p)){const N=v.data[tr()];if(TO(N,g)&&!DC(v,x)){let R=g?N.classesWithoutHost:N.stylesWithoutHost;null!==R&&(p=ne(R,p||"")),bE(v,N,D,p,g)}else!function Dz(d,h,p,g,v,x,D,N){v===Mn&&(v=In);let R=0,F=0,H=0<v.length?v[0]:null,Y=0<x.length?x[0]:null;for(;null!==H||null!==Y;){const de=R<v.length?v[R+1]:void 0,De=F<x.length?x[F+1]:void 0;let Tt,rt=null;H===Y?(R+=2,F+=2,de!==De&&(rt=Y,Tt=De)):null===Y||null!==H&&H<Y?(R+=2,rt=H):(F+=2,rt=Y,Tt=De),null!==rt&&xO(d,h,p,g,rt,Tt,D,N),H=R<v.length?v[R]:null,Y=F<x.length?x[F]:null}}(v,N,D,D[11],D[x+1],D[x+1]=function Ez(d,h,p){if(null==p||""===p)return In;const g=[],v=Ri(p);if(Array.isArray(v))for(let x=0;x<v.length;x++)d(g,v[x],!0);else if("object"==typeof v)for(const x in v)v.hasOwnProperty(x)&&d(g,x,v[x]);else"string"==typeof v&&h(g,v);return g}(d,h,p),g,x)}}(oo,ml,Mf(st(),d,h,p),!0)}function HC(d,h,p){const g=st();return Lo(g,Ro(),h)&&la(Yn(),ai(),g,d,h,g[11],p,!0),HC}function zE(d,h,p){const g=st();if(Lo(g,Ro(),h)){const x=Yn(),D=ai();la(x,D,g,d,h,St($h(x.data),D,g),p,!0)}return zE}const $f=void 0;var Pz=["en",[["a","p"],["AM","PM"],$f],[["AM","PM"],$f,$f],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],$f,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],$f,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",$f,"{1} 'at' {0}",$f],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Fz(d){const p=Math.floor(Math.abs(d)),g=d.toString().replace(/^[^.]*\.?/,"").length;return 1===p&&0===g?1:5}];let Wm={};function HE(d){const h=function Lz(d){return d.toLowerCase().replace(/_/g,"-")}(d);let p=GC(h);if(p)return p;const g=h.split("-")[0];if(p=GC(g),p)return p;if("en"===g)return Pz;throw new Ae(701,!1)}function PO(d){return HE(d)[vn.PluralCase]}function GC(d){return d in Wm||(Wm[d]=Pr.ng&&Pr.ng.common&&Pr.ng.common.locales&&Pr.ng.common.locales[d]),Wm[d]}var vn=(()=>((vn=vn||{})[vn.LocaleId=0]="LocaleId",vn[vn.DayPeriodsFormat=1]="DayPeriodsFormat",vn[vn.DayPeriodsStandalone=2]="DayPeriodsStandalone",vn[vn.DaysFormat=3]="DaysFormat",vn[vn.DaysStandalone=4]="DaysStandalone",vn[vn.MonthsFormat=5]="MonthsFormat",vn[vn.MonthsStandalone=6]="MonthsStandalone",vn[vn.Eras=7]="Eras",vn[vn.FirstDayOfWeek=8]="FirstDayOfWeek",vn[vn.WeekendRange=9]="WeekendRange",vn[vn.DateFormat=10]="DateFormat",vn[vn.TimeFormat=11]="TimeFormat",vn[vn.DateTimeFormat=12]="DateTimeFormat",vn[vn.NumberSymbols=13]="NumberSymbols",vn[vn.NumberFormats=14]="NumberFormats",vn[vn.CurrencyCode=15]="CurrencyCode",vn[vn.CurrencySymbol=16]="CurrencySymbol",vn[vn.CurrencyName=17]="CurrencyName",vn[vn.Currencies=18]="Currencies",vn[vn.Directionality=19]="Directionality",vn[vn.PluralCase=20]="PluralCase",vn[vn.ExtraData=21]="ExtraData",vn))();const Iv="en-US";let LO=Iv;function rc(d,h,p,g,v){if(d=X(d),Array.isArray(d))for(let x=0;x<d.length;x++)rc(d[x],h,p,g,v);else{const x=Yn(),D=st();let N=Rc(d)?d:X(d.provide),R=OS(d);const F=mi(),H=1048575&F.providerIndexes,Y=F.directiveStart,de=F.providerIndexes>>20;if(Rc(d)||!d.multi){const De=new Uh(R,v,Pu),rt=nD(N,h,v?H:H+de,Y);-1===rt?(hy(Zp(F,D),x,N),tD(x,d,h.length),h.push(N),F.directiveStart++,F.directiveEnd++,v&&(F.providerIndexes+=1048576),p.push(De),D.push(De)):(p[rt]=De,D[rt]=De)}else{const De=nD(N,h,H+de,Y),rt=nD(N,h,H,H+de),Tt=De>=0&&p[De],mt=rt>=0&&p[rt];if(v&&!mt||!v&&!Tt){hy(Zp(F,D),x,N);const gt=function h4(d,h,p,g,v){const x=new Uh(d,p,Pu);return x.multi=[],x.index=h,x.componentProviders=0,JC(x,v,g&&!p),x}(v?d4:nF,p.length,v,g,R);!v&&mt&&(p[rt].providerFactory=gt),tD(x,d,h.length,0),h.push(N),F.directiveStart++,F.directiveEnd++,v&&(F.providerIndexes+=1048576),p.push(gt),D.push(gt)}else tD(x,d,De>-1?De:rt,JC(p[v?rt:De],R,!v&&g));!v&&g&&mt&&p[rt].componentProviders++}}}function tD(d,h,p,g){const v=Rc(h),x=function dU(d){return!!d.useClass}(h);if(v||x){const R=(x?X(h.useClass):h).prototype.ngOnDestroy;if(R){const F=d.destroyHooks||(d.destroyHooks=[]);if(!v&&h.multi){const H=F.indexOf(p);-1===H?F.push(p,[g,R]):F[H+1].push(g,R)}else F.push(p,R)}}}function JC(d,h,p){return p&&d.componentProviders++,d.multi.push(h)-1}function nD(d,h,p,g){for(let v=p;v<g;v++)if(h[v]===d)return v;return-1}function nF(d,h,p,g){return Nv(this.multi,[])}function d4(d,h,p,g){const v=this.multi;let x;if(this.providerFactory){const D=this.providerFactory.componentProviders,N=Gh(p,p[1],this.providerFactory.index,g);x=N.slice(0,D),Nv(v,x);for(let R=D;R<N.length;R++)x.push(N[R])}else x=[],Nv(v,x);return x}function Nv(d,h){for(let p=0;p<d.length;p++)h.push((0,d[p])());return h}function rF(d,h=[]){return p=>{p.providersResolver=(g,v)=>function Zm(d,h,p){const g=Yn();if(g.firstCreatePass){const v=na(d);rc(p,g.data,g.blueprint,v,!0),rc(h,g.data,g.blueprint,v,!1)}}(g,v?v(d):d,h)}}class Ym{}class Yd{}function rD(d,h){return new iD(d,h??null)}class iD extends Ym{constructor(h,p){super(),this._parent=p,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ec(this);const g=Rt(h);this._bootstrapComponents=Ou(g.bootstrap),this._r3Injector=lo(h,p,[{provide:Ym,useValue:this},{provide:zw,useValue:this.componentFactoryResolver}],Ne(h),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(h)}get injector(){return this._r3Injector}destroy(){const h=this._r3Injector;!h.destroyed&&h.destroy(),this.destroyCbs.forEach(p=>p()),this.destroyCbs=null}onDestroy(h){this.destroyCbs.push(h)}}class Rv extends Yd{constructor(h){super(),this.moduleType=h}create(h){return new iD(this.moduleType,h)}}class sD extends Ym{constructor(h,p,g){super(),this.componentFactoryResolver=new ec(this),this.instance=null;const v=new dM([...h,{provide:Ym,useValue:this},{provide:zw,useValue:this.componentFactoryResolver}],p||Bw(),g,new Set(["environment"]));this.injector=v,v.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(h){this.injector.onDestroy(h)}}function Mv(d,h,p=null){return new sD(d,h,p).injector}let f4=(()=>{class d{constructor(p){this._injector=p,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(p){if(!p.standalone)return null;if(!this.cachedInjectors.has(p.id)){const g=AS(0,p.type),v=g.length>0?Mv([g],this._injector,`Standalone[${p.type.name}]`):null;this.cachedInjectors.set(p.id,v)}return this.cachedInjectors.get(p.id)}ngOnDestroy(){try{for(const p of this.cachedInjectors.values())null!==p&&p.destroy()}finally{this.cachedInjectors.clear()}}}return d.\u0275prov=Te({token:d,providedIn:"environment",factory:()=>new d(gi(_f))}),d})();function ex(d){d.getStandaloneInjector=h=>h.get(f4).getOrCreateStandaloneInjector(d)}function hF(d,h,p){const g=as()+d,v=st();return v[g]===Mn?Lu(v,g,p?h.call(p):h()):function gC(d,h){return d[h]}(v,g)}function ix(d,h,p,g){return pF(st(),as(),d,h,p,g)}function cD(d,h,p,g,v){return hD(st(),as(),d,h,p,g,v)}function Fv(d,h){const p=d[h];return p===Mn?void 0:p}function pF(d,h,p,g,v,x){const D=h+p;return Lo(d,D,v)?Lu(d,D+1,x?g.call(x,v):g(v)):Fv(d,D+1)}function hD(d,h,p,g,v,x,D){const N=h+p;return Vm(d,N,v,x)?Lu(d,N+2,D?g.call(D,v,x):g(v,x)):Fv(d,N+2)}function fD(d,h){const p=Yn();let g;const v=d+22;p.firstCreatePass?(g=function pD(d,h){if(h)for(let p=h.length-1;p>=0;p--){const g=h[p];if(d===g.name)return g}}(h,p.pipeRegistry),p.data[v]=g,g.onDestroy&&(p.destroyHooks||(p.destroyHooks=[])).push(v,g.onDestroy)):g=p.data[v];const x=g.factory||(g.factory=ko(g.type)),D=en(Pu);try{const N=zh(!1),R=x();return zh(N),function vv(d,h,p,g){p>=d.data.length&&(d.data[p]=null,d.blueprint[p]=null),h[p]=g}(p,st(),v,R),R}finally{en(D)}}function ox(d,h,p){const g=d+22,v=st(),x=bd(v,g);return Pv(v,g)?pF(v,as(),h,x.transform,p,x):x.transform(p)}function _F(d,h,p,g){const v=d+22,x=st(),D=bd(x,v);return Pv(x,v)?hD(x,as(),h,D.transform,p,g,D):D.transform(p,g)}function Pv(d,h){return d[1].data[h].pure}function yD(d){return h=>{setTimeout(d,void 0,h)}}const Lc=class _D extends B.x{constructor(h=!1){super(),this.__isAsync=h}emit(h){super.next(h)}subscribe(h,p,g){let v=h,x=p||(()=>null),D=g;if(h&&"object"==typeof h){const R=h;v=R.next?.bind(R),x=R.error?.bind(R),D=R.complete?.bind(R)}this.__isAsync&&(x=yD(x),v&&(v=yD(v)),D&&(D=yD(D)));const N=super.subscribe({next:v,error:x,complete:D});return h instanceof Ee.w0&&h.add(N),N}};function vD(){return this._results[Oc()]()}class Lv{constructor(h=!1){this._emitDistinctChangesOnly=h,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const p=Oc(),g=Lv.prototype;g[p]||(g[p]=vD)}get changes(){return this._changes||(this._changes=new Lc)}get(h){return this._results[h]}map(h){return this._results.map(h)}filter(h){return this._results.filter(h)}find(h){return this._results.find(h)}reduce(h,p){return this._results.reduce(h,p)}forEach(h){this._results.forEach(h)}some(h){return this._results.some(h)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(h,p){const g=this;g.dirty=!1;const v=$s(h);(this._changesDetected=!function vy(d,h,p){if(d.length!==h.length)return!1;for(let g=0;g<d.length;g++){let v=d[g],x=h[g];if(p&&(v=p(v),x=p(x)),x!==v)return!1}return!0}(g._results,v,p))&&(g._results=v,g.length=v.length,g.last=v[this.length-1],g.first=v[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Km=(()=>{class d{}return d.__NG_ELEMENT_ID__=C4,d})();const b4=Km,w4=class extends b4{constructor(h,p,g){super(),this._declarationLView=h,this._declarationTContainer=p,this.elementRef=g}createEmbeddedView(h,p){const g=this._declarationTContainer.tViews,v=rC(this._declarationLView,g,h,16,null,g.declTNode,null,null,null,null,p||null);v[17]=this._declarationLView[this._declarationTContainer.index];const D=this._declarationLView[19];return null!==D&&(v[19]=D.createEmbeddedView(g)),iC(g,v,h),new Lm(v)}};function C4(){return $v(mi(),st())}function $v(d,h){return 4&d.type?new w4(h,d,sv(d,h)):null}let Qm=(()=>{class d{}return d.__NG_ELEMENT_ID__=x4,d})();function x4(){return ax(mi(),st())}const bD=Qm,vF=class extends bD{constructor(h,p,g){super(),this._lContainer=h,this._hostTNode=p,this._hostLView=g}get element(){return sv(this._hostTNode,this._hostLView)}get injector(){return new ol(this._hostTNode,this._hostLView)}get parentInjector(){const h=Hh(this._hostTNode,this._hostLView);if(UR(h)){const p=jp(h,this._hostLView),g=Wp(h);return new ol(p[1].data[g+8],p)}return new ol(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(h){const p=I4(this._lContainer);return null!==p&&p[h]||null}get length(){return this._lContainer.length-10}createEmbeddedView(h,p,g){let v,x;"number"==typeof g?v=g:null!=g&&(v=g.index,x=g.injector);const D=h.createEmbeddedView(p||{},x);return this.insert(D,v),D}createComponent(h,p,g,v,x){const D=h&&!function Zh(d){return"function"==typeof d}(h);let N;if(D)N=p;else{const Y=p||{};N=Y.index,g=Y.injector,v=Y.projectableNodes,x=Y.environmentInjector||Y.ngModuleRef}const R=D?h:new mv(Ge(h)),F=g||this.parentInjector;if(!x&&null==R.ngModule){const de=(D?F:this.parentInjector).get(_f,null);de&&(x=de)}const H=R.create(F,v,void 0,x);return this.insert(H.hostView,N),H}insert(h,p){const g=h._lView,v=g[1];if(function k0(d){return ka(d[3])}(g)){const H=this.indexOf(h);if(-1!==H)this.detach(H);else{const Y=g[3],de=new vF(Y,Y[6],Y[3]);de.detach(de.indexOf(h))}}const x=this._adjustIndex(p),D=this._lContainer;!function Md(d,h,p,g){const v=10+g,x=p.length;g>0&&(p[v-1][4]=h),g<x-10?(h[4]=p[v],by(p,10+g,h)):(p.push(h),h[4]=null),h[3]=p;const D=h[17];null!==D&&p!==D&&function vw(d,h){const p=d[9];h[16]!==h[3][3][16]&&(d[2]=!0),null===p?d[9]=[h]:p.push(h)}(D,h);const N=h[19];null!==N&&N.insertView(d),h[2]|=64}(v,g,D,x);const N=Im(x,D),R=g[11],F=cl(R,D[7]);return null!==F&&function lf(d,h,p,g,v,x){g[0]=v,g[6]=h,Fd(d,g,p,1,v,x)}(v,D[6],R,g,F,N),h.attachToViewContainerRef(),by(bF(D),x,h),h}move(h,p){return this.insert(h,p)}indexOf(h){const p=I4(this._lContainer);return null!==p?p.indexOf(h):-1}remove(h){const p=this._adjustIndex(h,-1),g=Ba(this._lContainer,p);g&&(wy(bF(this._lContainer),p),Cm(g[1],g))}detach(h){const p=this._adjustIndex(h,-1),g=Ba(this._lContainer,p);return g&&null!=wy(bF(this._lContainer),p)?new Lm(g):null}_adjustIndex(h,p=0){return h??this.length+p}};function I4(d){return d[8]}function bF(d){return d[8]||(d[8]=[])}function ax(d,h){let p;const g=h[d.index];if(ka(g))p=g;else{let v;if(8&d.type)v=oi(g);else{const x=h[11];v=x.createComment("");const D=so(d,h);ll(x,cl(x,D),v,function cf(d,h){return d.nextSibling(h)}(x,D),!1)}h[d.index]=p=dE(g,h,v,d),pv(h,p)}return new vF(p,d,h)}class CD{constructor(h){this.queryList=h,this.matches=null}clone(){return new CD(this.queryList)}setDirty(){this.queryList.setDirty()}}class xD{constructor(h=[]){this.queries=h}createEmbeddedView(h){const p=h.queries;if(null!==p){const g=null!==h.contentQueries?h.contentQueries[0]:p.length,v=[];for(let x=0;x<g;x++){const D=p.getByIndex(x);v.push(this.queries[D.indexInDeclarationView].clone())}return new xD(v)}return null}insertView(h){this.dirtyQueriesWithMatches(h)}detachView(h){this.dirtyQueriesWithMatches(h)}dirtyQueriesWithMatches(h){for(let p=0;p<this.queries.length;p++)null!==SF(h,p).matches&&this.queries[p].setDirty()}}class wF{constructor(h,p,g=null){this.predicate=h,this.flags=p,this.read=g}}class ID{constructor(h=[]){this.queries=h}elementStart(h,p){for(let g=0;g<this.queries.length;g++)this.queries[g].elementStart(h,p)}elementEnd(h){for(let p=0;p<this.queries.length;p++)this.queries[p].elementEnd(h)}embeddedTView(h){let p=null;for(let g=0;g<this.length;g++){const v=null!==p?p.length:0,x=this.getByIndex(g).embeddedTView(h,v);x&&(x.indexInDeclarationView=g,null!==p?p.push(x):p=[x])}return null!==p?new ID(p):null}template(h,p){for(let g=0;g<this.queries.length;g++)this.queries[g].template(h,p)}getByIndex(h){return this.queries[h]}get length(){return this.queries.length}track(h){this.queries.push(h)}}class Bv{constructor(h,p=-1){this.metadata=h,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=p}elementStart(h,p){this.isApplyingToNode(p)&&this.matchTNode(h,p)}elementEnd(h){this._declarationNodeIndex===h.index&&(this._appliesToNextNode=!1)}template(h,p){this.elementStart(h,p)}embeddedTView(h,p){return this.isApplyingToNode(h)?(this.crossesNgTemplate=!0,this.addMatch(-h.index,p),new Bv(this.metadata)):null}isApplyingToNode(h){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const p=this._declarationNodeIndex;let g=h.parent;for(;null!==g&&8&g.type&&g.index!==p;)g=g.parent;return p===(null!==g?g.index:-1)}return this._appliesToNextNode}matchTNode(h,p){const g=this.metadata.predicate;if(Array.isArray(g))for(let v=0;v<g.length;v++){const x=g[v];this.matchTNodeWithReadOption(h,p,Ts(p,x)),this.matchTNodeWithReadOption(h,p,bu(p,h,x,!1,!1))}else g===Km?4&p.type&&this.matchTNodeWithReadOption(h,p,-1):this.matchTNodeWithReadOption(h,p,bu(p,h,g,!1,!1))}matchTNodeWithReadOption(h,p,g){if(null!==g){const v=this.metadata.read;if(null!==v)if(v===Dn||v===Qm||v===Km&&4&p.type)this.addMatch(p.index,-2);else{const x=bu(p,h,v,!1,!1);null!==x&&this.addMatch(p.index,x)}else this.addMatch(p.index,g)}}addMatch(h,p){null===this.matches?this.matches=[h,p]:this.matches.push(h,p)}}function Ts(d,h){const p=d.localNames;if(null!==p)for(let g=0;g<p.length;g+=2)if(p[g]===h)return p[g+1];return null}function Bo(d,h,p,g){return-1===p?function T4(d,h){return 11&d.type?sv(d,h):4&d.type?$v(d,h):null}(h,d):-2===p?function S4(d,h,p){return p===Dn?sv(h,d):p===Km?$v(h,d):p===Qm?ax(h,d):void 0}(d,h,g):Gh(d,d[1],p,h)}function TD(d,h,p,g){const v=h[19].queries[g];if(null===v.matches){const x=d.data,D=p.matches,N=[];for(let R=0;R<D.length;R+=2){const F=D[R];N.push(F<0?null:Bo(h,x[F],D[R+1],p.metadata.read))}v.matches=N}return v.matches}function SD(d,h,p,g){const v=d.queries.getByIndex(p),x=v.matches;if(null!==x){const D=TD(d,h,v,p);for(let N=0;N<x.length;N+=2){const R=x[N];if(R>0)g.push(D[N/2]);else{const F=x[N+1],H=h[-R];for(let Y=10;Y<H.length;Y++){const de=H[Y];de[17]===de[3]&&SD(de[1],de,F,g)}if(null!==H[9]){const Y=H[9];for(let de=0;de<Y.length;de++){const De=Y[de];SD(De[1],De,F,g)}}}}}return g}function CF(d){const h=st(),p=Yn(),g=XT();Bh(g+1);const v=SF(p,g);if(d.dirty&&function D0(d){return 4==(4&d[2])}(h)===(2==(2&v.metadata.flags))){if(null===v.matches)d.reset([]);else{const x=v.crossesNgTemplate?SD(p,h,g,[]):TD(p,h,v,g);d.reset(x,Cr),d.notifyOnChanges()}return!0}return!1}function xF(d,h,p){const g=Yn();g.firstCreatePass&&(TF(g,new wF(d,h,p),-1),2==(2&h)&&(g.staticViewQueries=!0)),cx(g,st(),h)}function IF(d,h,p,g){const v=Yn();if(v.firstCreatePass){const x=mi();TF(v,new wF(h,p,g),x.index),function D4(d,h){const p=d.contentQueries||(d.contentQueries=[]);h!==(p.length?p[p.length-1]:-1)&&p.push(d.queries.length-1,h)}(v,d),2==(2&p)&&(v.staticContentQueries=!0)}cx(v,st(),p)}function lx(){return function E4(d,h){return d[19].queries[h].queryList}(st(),XT())}function cx(d,h,p){const g=new Lv(4==(4&p));oE(d,h,g,g.destroy),null===h[19]&&(h[19]=new xD),h[19].queries.push(new CD(g))}function TF(d,h,p){null===d.queries&&(d.queries=new ID),d.queries.track(new Bv(h,p))}function SF(d,h){return d.queries.getByIndex(h)}function EF(d,h){return $v(d,h)}function mx(...d){}const BF=new wr("Application Initializer");let gx=(()=>{class d{constructor(p){this.appInits=p,this.resolve=mx,this.reject=mx,this.initialized=!1,this.done=!1,this.donePromise=new Promise((g,v)=>{this.resolve=g,this.reject=v})}runInitializers(){if(this.initialized)return;const p=[],g=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let v=0;v<this.appInits.length;v++){const x=this.appInits[v]();if(xE(x))p.push(x);else if(An(x)){const D=new Promise((N,R)=>{x.subscribe({complete:N,error:R})});p.push(D)}}Promise.all(p).then(()=>{g()}).catch(v=>{this.reject(v)}),0===p.length&&g(),this.initialized=!0}}return d.\u0275fac=function(p){return new(p||d)(gi(BF,8))},d.\u0275prov=Te({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();const $4=new wr("AppId",{providedIn:"root",factory:function Qr(){return`${Uf()}${Uf()}${Uf()}`}});function Uf(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const zf=new wr("Platform Initializer"),GD=new wr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),_x=new wr("appBootstrapListener"),WD=new wr("AnimationModuleType");let jD=(()=>{class d{log(p){console.log(p)}warn(p){console.warn(p)}}return d.\u0275fac=function(p){return new(p||d)},d.\u0275prov=Te({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})();const ng=new wr("LocaleId",{providedIn:"root",factory:()=>sm(ng,Mt.Optional|Mt.SkipSelf)||function qD(){return typeof $localize<"u"&&$localize.locale||Iv}()}),P7=new wr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class B4{constructor(h,p){this.ngModuleFactory=h,this.componentFactories=p}}let rg=(()=>{class d{compileModuleSync(p){return new Rv(p)}compileModuleAsync(p){return Promise.resolve(this.compileModuleSync(p))}compileModuleAndAllComponentsSync(p){const g=this.compileModuleSync(p),x=Ou(Rt(p).declarations).reduce((D,N)=>{const R=Ge(N);return R&&D.push(new mv(R)),D},[]);return new B4(g,x)}compileModuleAndAllComponentsAsync(p){return Promise.resolve(this.compileModuleAndAllComponentsSync(p))}clearCache(){}clearCacheFor(p){}getModuleId(p){}}return d.\u0275fac=function(p){return new(p||d)},d.\u0275prov=Te({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();const B7=(()=>Promise.resolve(0))();function wi(d){typeof Zone>"u"?B7.then(()=>{d&&d.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",d)}class vl{constructor({enableLongStackTrace:h=!1,shouldCoalesceEventChangeDetection:p=!1,shouldCoalesceRunChangeDetection:g=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Lc(!1),this.onMicrotaskEmpty=new Lc(!1),this.onStable=new Lc(!1),this.onError=new Lc(!1),typeof Zone>"u")throw new Ae(908,!1);Zone.assertZonePatched();const v=this;if(v._nesting=0,v._outer=v._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const x=Zone.AsyncStackTaggingZoneSpec;v._inner=v._inner.fork(new x("Angular"))}Zone.TaskTrackingZoneSpec&&(v._inner=v._inner.fork(new Zone.TaskTrackingZoneSpec)),h&&Zone.longStackTraceZoneSpec&&(v._inner=v._inner.fork(Zone.longStackTraceZoneSpec)),v.shouldCoalesceEventChangeDetection=!g&&p,v.shouldCoalesceRunChangeDetection=g,v.lastRequestAnimationFrameId=-1,v.nativeRequestAnimationFrame=function V4(){let d=Pr.requestAnimationFrame,h=Pr.cancelAnimationFrame;if(typeof Zone<"u"&&d&&h){const p=d[Zone.__symbol__("OriginalDelegate")];p&&(d=p);const g=h[Zone.__symbol__("OriginalDelegate")];g&&(h=g)}return{nativeRequestAnimationFrame:d,nativeCancelAnimationFrame:h}}().nativeRequestAnimationFrame,function WF(d){const h=()=>{!function ZD(d){d.isCheckStableRunning||-1!==d.lastRequestAnimationFrameId||(d.lastRequestAnimationFrameId=d.nativeRequestAnimationFrame.call(Pr,()=>{d.fakeTopEventTask||(d.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{d.lastRequestAnimationFrameId=-1,yx(d),d.isCheckStableRunning=!0,GF(d),d.isCheckStableRunning=!1},void 0,()=>{},()=>{})),d.fakeTopEventTask.invoke()}),yx(d))}(d)};d._inner=d._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(p,g,v,x,D,N)=>{try{return vx(d),p.invokeTask(v,x,D,N)}finally{(d.shouldCoalesceEventChangeDetection&&"eventTask"===x.type||d.shouldCoalesceRunChangeDetection)&&h(),YD(d)}},onInvoke:(p,g,v,x,D,N,R)=>{try{return vx(d),p.invoke(v,x,D,N,R)}finally{d.shouldCoalesceRunChangeDetection&&h(),YD(d)}},onHasTask:(p,g,v,x)=>{p.hasTask(v,x),g===v&&("microTask"==x.change?(d._hasPendingMicrotasks=x.microTask,yx(d),GF(d)):"macroTask"==x.change&&(d.hasPendingMacrotasks=x.macroTask))},onHandleError:(p,g,v,x)=>(p.handleError(v,x),d.runOutsideAngular(()=>d.onError.emit(x)),!1)})}(v)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vl.isInAngularZone())throw new Ae(909,!1)}static assertNotInAngularZone(){if(vl.isInAngularZone())throw new Ae(909,!1)}run(h,p,g){return this._inner.run(h,p,g)}runTask(h,p,g,v){const x=this._inner,D=x.scheduleEventTask("NgZoneEvent: "+v,h,HF,mx,mx);try{return x.runTask(D,p,g)}finally{x.cancelTask(D)}}runGuarded(h,p,g){return this._inner.runGuarded(h,p,g)}runOutsideAngular(h){return this._outer.run(h)}}const HF={};function GF(d){if(0==d._nesting&&!d.hasPendingMicrotasks&&!d.isStable)try{d._nesting++,d.onMicrotaskEmpty.emit(null)}finally{if(d._nesting--,!d.hasPendingMicrotasks)try{d.runOutsideAngular(()=>d.onStable.emit(null))}finally{d.isStable=!0}}}function yx(d){d.hasPendingMicrotasks=!!(d._hasPendingMicrotasks||(d.shouldCoalesceEventChangeDetection||d.shouldCoalesceRunChangeDetection)&&-1!==d.lastRequestAnimationFrameId)}function vx(d){d._nesting++,d.isStable&&(d.isStable=!1,d.onUnstable.emit(null))}function YD(d){d._nesting--,GF(d)}class U4{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Lc,this.onMicrotaskEmpty=new Lc,this.onStable=new Lc,this.onError=new Lc}run(h,p,g){return h.apply(p,g)}runGuarded(h,p,g){return h.apply(p,g)}runOutsideAngular(h){return h()}runTask(h,p,g,v){return h.apply(p,g)}}const jF=new wr(""),KD=new wr("");let wx,Hf=(()=>{class d{constructor(p,g,v){this._ngZone=p,this.registry=g,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,wx||(function og(d){wx=d}(v),v.addToWindow(g)),this._watchAngularEvents(),p.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vl.assertNotInAngularZone(),wi(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())wi(()=>{for(;0!==this._callbacks.length;){let p=this._callbacks.pop();clearTimeout(p.timeoutId),p.doneCb(this._didWork)}this._didWork=!1});else{let p=this.getPendingTasks();this._callbacks=this._callbacks.filter(g=>!g.updateCb||!g.updateCb(p)||(clearTimeout(g.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(p=>({source:p.source,creationLocation:p.creationLocation,data:p.data})):[]}addCallback(p,g,v){let x=-1;g&&g>0&&(x=setTimeout(()=>{this._callbacks=this._callbacks.filter(D=>D.timeoutId!==x),p(this._didWork,this.getPendingTasks())},g)),this._callbacks.push({doneCb:p,timeoutId:x,updateCb:v})}whenStable(p,g,v){if(v&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(p,g,v),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(p){this.registry.registerApplication(p,this)}unregisterApplication(p){this.registry.unregisterApplication(p)}findProviders(p,g,v){return[]}}return d.\u0275fac=function(p){return new(p||d)(gi(vl),gi(bx),gi(KD))},d.\u0275prov=Te({token:d,factory:d.\u0275fac}),d})(),bx=(()=>{class d{constructor(){this._applications=new Map}registerApplication(p,g){this._applications.set(p,g)}unregisterApplication(p){this._applications.delete(p)}unregisterAllApplications(){this._applications.clear()}getTestability(p){return this._applications.get(p)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(p,g=!0){return wx?.findTestabilityInTree(this,p,g)??null}}return d.\u0275fac=function(p){return new(p||d)},d.\u0275prov=Te({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})(),zu=null;const ag=new wr("AllowMultipleToken"),Hu=new wr("PlatformDestroyListeners");class QD{constructor(h,p){this.name=h,this.token=p}}function YF(d,h,p=[]){const g=`Platform: ${h}`,v=new wr(g);return(x=[])=>{let D=JD();if(!D||D.injector.get(ag,!1)){const N=[...p,...x,{provide:v,useValue:!0}];d?d(N):function Uc(d){if(zu&&!zu.get(ag,!1))throw new Ae(400,!1);zu=d;const h=d.get(cg);(function ZF(d){const h=d.get(zf,null);h&&h.forEach(p=>p())})(d)}(function zc(d=[],h){return co.create({name:h,providers:[{provide:RS,useValue:"platform"},{provide:Hu,useValue:new Set([()=>zu=null])},...d]})}(N,g))}return function Xd(d){const h=JD();if(!h)throw new Ae(401,!1);return h}()}}function JD(){return zu?.get(cg)??null}let cg=(()=>{class d{constructor(p){this._injector=p,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(p,g){const v=function ek(d,h){let p;return p="noop"===d?new U4:("zone.js"===d?void 0:d)||new vl(h),p}(g?.ngZone,function Cx(d){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!d||!d.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!d||!d.ngZoneRunCoalescing)||!1}}(g)),x=[{provide:vl,useValue:v}];return v.run(()=>{const D=co.create({providers:x,parent:this.injector,name:p.moduleType.name}),N=p.create(D),R=N.injector.get(ov,null);if(!R)throw new Ae(402,!1);return v.runOutsideAngular(()=>{const F=v.onError.subscribe({next:H=>{R.handleError(H)}});N.onDestroy(()=>{Ix(this._modules,N),F.unsubscribe()})}),function ds(d,h,p){try{const g=p();return xE(g)?g.catch(v=>{throw h.runOutsideAngular(()=>d.handleError(v)),v}):g}catch(g){throw h.runOutsideAngular(()=>d.handleError(g)),g}}(R,v,()=>{const F=N.injector.get(gx);return F.runInitializers(),F.donePromise.then(()=>(function $O(d){sr(d,"Expected localeId to be defined"),"string"==typeof d&&(LO=d.toLowerCase().replace(/_/g,"-"))}(N.injector.get(ng,Iv)||Iv),this._moduleDoBootstrap(N),N))})})}bootstrapModule(p,g=[]){const v=tk({},g);return function qF(d,h,p){const g=new Rv(p);return Promise.resolve(g)}(0,0,p).then(x=>this.bootstrapModuleFactory(x,v))}_moduleDoBootstrap(p){const g=p.injector.get(xx);if(p._bootstrapComponents.length>0)p._bootstrapComponents.forEach(v=>g.bootstrap(v));else{if(!p.instance.ngDoBootstrap)throw new Ae(403,!1);p.instance.ngDoBootstrap(g)}this._modules.push(p)}onDestroy(p){this._destroyListeners.push(p)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ae(404,!1);this._modules.slice().forEach(g=>g.destroy()),this._destroyListeners.forEach(g=>g());const p=this._injector.get(Hu,null);p&&(p.forEach(g=>g()),p.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return d.\u0275fac=function(p){return new(p||d)(gi(co))},d.\u0275prov=Te({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})();function tk(d,h){return Array.isArray(h)?h.reduce(tk,d):{...d,...h}}let xx=(()=>{class d{constructor(p,g,v){this._zone=p,this._injector=g,this._exceptionHandler=v,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const x=new te.y(N=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{N.next(this._stable),N.complete()})}),D=new te.y(N=>{let R;this._zone.runOutsideAngular(()=>{R=this._zone.onStable.subscribe(()=>{vl.assertNotInAngularZone(),wi(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,N.next(!0))})})});const F=this._zone.onUnstable.subscribe(()=>{vl.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{N.next(!1)}))});return()=>{R.unsubscribe(),F.unsubscribe()}});this.isStable=(0,He.T)(x,D.pipe((0,je.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(p,g){const v=p instanceof pM;if(!this._injector.get(gx).done)throw!v&&yt(p),new Ae(405,false);let D;D=v?p:this._injector.get(zw).resolveComponentFactory(p),this.componentTypes.push(D.componentType);const N=function Vv(d){return d.isBoundToModule}(D)?void 0:this._injector.get(Ym),F=D.create(co.NULL,[],g||D.selector,N),H=F.location.nativeElement,Y=F.injector.get(jF,null);return Y?.registerApplication(H),F.onDestroy(()=>{this.detachView(F.hostView),Ix(this.components,F),Y?.unregisterApplication(H)}),this._loadComponent(F),F}tick(){if(this._runningTick)throw new Ae(101,!1);try{this._runningTick=!0;for(let p of this._views)p.detectChanges()}catch(p){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(p))}finally{this._runningTick=!1}}attachView(p){const g=p;this._views.push(g),g.attachToAppRef(this)}detachView(p){const g=p;Ix(this._views,g),g.detachFromAppRef()}_loadComponent(p){this.attachView(p.hostView),this.tick(),this.components.push(p),this._injector.get(_x,[]).concat(this._bootstrapListeners).forEach(v=>v(p))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(p=>p()),this._views.slice().forEach(p=>p.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(p){return this._destroyListeners.push(p),()=>Ix(this._destroyListeners,p)}destroy(){if(this._destroyed)throw new Ae(406,!1);const p=this._injector;p.destroy&&!p.destroyed&&p.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return d.\u0275fac=function(p){return new(p||d)(gi(vl),gi(_f),gi(ov))},d.\u0275prov=Te({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();function Ix(d,h){const p=d.indexOf(h);p>-1&&d.splice(p,1)}let QF=!0,XF=!1;function JF(){return XF=!0,QF}function ug(){if(XF)throw new Error("Cannot enable prod mode after platform setup.");QF=!1}let H4=(()=>{class d{}return d.__NG_ELEMENT_ID__=Uv,d})();function Uv(d){return function Sx(d,h,p){if(Op(d)&&!p){const g=qi(d.index,h);return new Lm(g,g)}return 47&d.type?new Lm(h[16],h):null}(mi(),st(),16==(16&d))}class iP{constructor(){}supports(h){return Bm(h)}create(h){return new oP(h)}}const sP=(d,h)=>h;class oP{constructor(h){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=h||sP}forEachItem(h){let p;for(p=this._itHead;null!==p;p=p._next)h(p)}forEachOperation(h){let p=this._itHead,g=this._removalsHead,v=0,x=null;for(;p||g;){const D=!g||p&&p.currentIndex<cP(g,v,x)?p:g,N=cP(D,v,x),R=D.currentIndex;if(D===g)v--,g=g._nextRemoved;else if(p=p._next,null==D.previousIndex)v++;else{x||(x=[]);const F=N-v,H=R-v;if(F!=H){for(let de=0;de<F;de++){const De=de<x.length?x[de]:x[de]=0,rt=De+de;H<=rt&&rt<F&&(x[de]=De+1)}x[D.previousIndex]=H-F}}N!==R&&h(D,N,R)}}forEachPreviousItem(h){let p;for(p=this._previousItHead;null!==p;p=p._nextPrevious)h(p)}forEachAddedItem(h){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)h(p)}forEachMovedItem(h){let p;for(p=this._movesHead;null!==p;p=p._nextMoved)h(p)}forEachRemovedItem(h){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)h(p)}forEachIdentityChange(h){let p;for(p=this._identityChangesHead;null!==p;p=p._nextIdentityChange)h(p)}diff(h){if(null==h&&(h=[]),!Bm(h))throw new Ae(900,!1);return this.check(h)?this:null}onDestroy(){}check(h){this._reset();let v,x,D,p=this._itHead,g=!1;if(Array.isArray(h)){this.length=h.length;for(let N=0;N<this.length;N++)x=h[N],D=this._trackByFn(N,x),null!==p&&Object.is(p.trackById,D)?(g&&(p=this._verifyReinsertion(p,x,D,N)),Object.is(p.item,x)||this._addIdentityChange(p,x)):(p=this._mismatch(p,x,D,N),g=!0),p=p._next}else v=0,function c7(d,h){if(Array.isArray(d))for(let p=0;p<d.length;p++)h(d[p]);else{const p=d[Oc()]();let g;for(;!(g=p.next()).done;)h(g.value)}}(h,N=>{D=this._trackByFn(v,N),null!==p&&Object.is(p.trackById,D)?(g&&(p=this._verifyReinsertion(p,N,D,v)),Object.is(p.item,N)||this._addIdentityChange(p,N)):(p=this._mismatch(p,N,D,v),g=!0),p=p._next,v++}),this.length=v;return this._truncate(p),this.collection=h,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let h;for(h=this._previousItHead=this._itHead;null!==h;h=h._next)h._nextPrevious=h._next;for(h=this._additionsHead;null!==h;h=h._nextAdded)h.previousIndex=h.currentIndex;for(this._additionsHead=this._additionsTail=null,h=this._movesHead;null!==h;h=h._nextMoved)h.previousIndex=h.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(h,p,g,v){let x;return null===h?x=this._itTail:(x=h._prev,this._remove(h)),null!==(h=null===this._unlinkedRecords?null:this._unlinkedRecords.get(g,null))?(Object.is(h.item,p)||this._addIdentityChange(h,p),this._reinsertAfter(h,x,v)):null!==(h=null===this._linkedRecords?null:this._linkedRecords.get(g,v))?(Object.is(h.item,p)||this._addIdentityChange(h,p),this._moveAfter(h,x,v)):h=this._addAfter(new aP(p,g),x,v),h}_verifyReinsertion(h,p,g,v){let x=null===this._unlinkedRecords?null:this._unlinkedRecords.get(g,null);return null!==x?h=this._reinsertAfter(x,h._prev,v):h.currentIndex!=v&&(h.currentIndex=v,this._addToMoves(h,v)),h}_truncate(h){for(;null!==h;){const p=h._next;this._addToRemovals(this._unlink(h)),h=p}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(h,p,g){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(h);const v=h._prevRemoved,x=h._nextRemoved;return null===v?this._removalsHead=x:v._nextRemoved=x,null===x?this._removalsTail=v:x._prevRemoved=v,this._insertAfter(h,p,g),this._addToMoves(h,g),h}_moveAfter(h,p,g){return this._unlink(h),this._insertAfter(h,p,g),this._addToMoves(h,g),h}_addAfter(h,p,g){return this._insertAfter(h,p,g),this._additionsTail=null===this._additionsTail?this._additionsHead=h:this._additionsTail._nextAdded=h,h}_insertAfter(h,p,g){const v=null===p?this._itHead:p._next;return h._next=v,h._prev=p,null===v?this._itTail=h:v._prev=h,null===p?this._itHead=h:p._next=h,null===this._linkedRecords&&(this._linkedRecords=new lP),this._linkedRecords.put(h),h.currentIndex=g,h}_remove(h){return this._addToRemovals(this._unlink(h))}_unlink(h){null!==this._linkedRecords&&this._linkedRecords.remove(h);const p=h._prev,g=h._next;return null===p?this._itHead=g:p._next=g,null===g?this._itTail=p:g._prev=p,h}_addToMoves(h,p){return h.previousIndex===p||(this._movesTail=null===this._movesTail?this._movesHead=h:this._movesTail._nextMoved=h),h}_addToRemovals(h){return null===this._unlinkedRecords&&(this._unlinkedRecords=new lP),this._unlinkedRecords.put(h),h.currentIndex=null,h._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=h,h._prevRemoved=null):(h._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=h),h}_addIdentityChange(h,p){return h.item=p,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=h:this._identityChangesTail._nextIdentityChange=h,h}}class aP{constructor(h,p){this.item=h,this.trackById=p,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class K4{constructor(){this._head=null,this._tail=null}add(h){null===this._head?(this._head=this._tail=h,h._nextDup=null,h._prevDup=null):(this._tail._nextDup=h,h._prevDup=this._tail,h._nextDup=null,this._tail=h)}get(h,p){let g;for(g=this._head;null!==g;g=g._nextDup)if((null===p||p<=g.currentIndex)&&Object.is(g.trackById,h))return g;return null}remove(h){const p=h._prevDup,g=h._nextDup;return null===p?this._head=g:p._nextDup=g,null===g?this._tail=p:g._prevDup=p,null===this._head}}class lP{constructor(){this.map=new Map}put(h){const p=h.trackById;let g=this.map.get(p);g||(g=new K4,this.map.set(p,g)),g.add(h)}get(h,p){const v=this.map.get(h);return v?v.get(h,p):null}remove(h){const p=h.trackById;return this.map.get(p).remove(h)&&this.map.delete(p),h}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function cP(d,h,p){const g=d.previousIndex;if(null===g)return g;let v=0;return p&&g<p.length&&(v=p[g]),g+h+v}class uP{constructor(){}supports(h){return h instanceof Map||oO(h)}create(){return new Q4}}class Q4{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(h){let p;for(p=this._mapHead;null!==p;p=p._next)h(p)}forEachPreviousItem(h){let p;for(p=this._previousMapHead;null!==p;p=p._nextPrevious)h(p)}forEachChangedItem(h){let p;for(p=this._changesHead;null!==p;p=p._nextChanged)h(p)}forEachAddedItem(h){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)h(p)}forEachRemovedItem(h){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)h(p)}diff(h){if(h){if(!(h instanceof Map||oO(h)))throw new Ae(900,!1)}else h=new Map;return this.check(h)?this:null}onDestroy(){}check(h){this._reset();let p=this._mapHead;if(this._appendAfter=null,this._forEach(h,(g,v)=>{if(p&&p.key===v)this._maybeAddToChanges(p,g),this._appendAfter=p,p=p._next;else{const x=this._getOrCreateRecordForKey(v,g);p=this._insertBeforeOrAppend(p,x)}}),p){p._prev&&(p._prev._next=null),this._removalsHead=p;for(let g=p;null!==g;g=g._nextRemoved)g===this._mapHead&&(this._mapHead=null),this._records.delete(g.key),g._nextRemoved=g._next,g.previousValue=g.currentValue,g.currentValue=null,g._prev=null,g._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(h,p){if(h){const g=h._prev;return p._next=h,p._prev=g,h._prev=p,g&&(g._next=p),h===this._mapHead&&(this._mapHead=p),this._appendAfter=h,h}return this._appendAfter?(this._appendAfter._next=p,p._prev=this._appendAfter):this._mapHead=p,this._appendAfter=p,null}_getOrCreateRecordForKey(h,p){if(this._records.has(h)){const v=this._records.get(h);this._maybeAddToChanges(v,p);const x=v._prev,D=v._next;return x&&(x._next=D),D&&(D._prev=x),v._next=null,v._prev=null,v}const g=new dP(h);return this._records.set(h,g),g.currentValue=p,this._addToAdditions(g),g}_reset(){if(this.isDirty){let h;for(this._previousMapHead=this._mapHead,h=this._previousMapHead;null!==h;h=h._next)h._nextPrevious=h._next;for(h=this._changesHead;null!==h;h=h._nextChanged)h.previousValue=h.currentValue;for(h=this._additionsHead;null!=h;h=h._nextAdded)h.previousValue=h.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(h,p){Object.is(p,h.currentValue)||(h.previousValue=h.currentValue,h.currentValue=p,this._addToChanges(h))}_addToAdditions(h){null===this._additionsHead?this._additionsHead=this._additionsTail=h:(this._additionsTail._nextAdded=h,this._additionsTail=h)}_addToChanges(h){null===this._changesHead?this._changesHead=this._changesTail=h:(this._changesTail._nextChanged=h,this._changesTail=h)}_forEach(h,p){h instanceof Map?h.forEach(p):Object.keys(h).forEach(g=>p(h[g],g))}}class dP{constructor(h){this.key=h,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ok(){return new ak([new iP])}let ak=(()=>{class d{constructor(p){this.factories=p}static create(p,g){if(null!=g){const v=g.factories.slice();p=p.concat(v)}return new d(p)}static extend(p){return{provide:d,useFactory:g=>d.create(p,g||ok()),deps:[[d,new Nc,new Iu]]}}find(p){const g=this.factories.find(v=>v.supports(p));if(null!=g)return g;throw new Ae(901,!1)}}return d.\u0275prov=Te({token:d,providedIn:"root",factory:ok}),d})();function hP(){return new Hc([new uP])}let Hc=(()=>{class d{constructor(p){this.factories=p}static create(p,g){if(g){const v=g.factories.slice();p=p.concat(v)}return new d(p)}static extend(p){return{provide:d,useFactory:g=>d.create(p,g||hP()),deps:[[d,new Nc,new Iu]]}}find(p){const g=this.factories.find(v=>v.supports(p));if(g)return g;throw new Ae(901,!1)}}return d.\u0275prov=Te({token:d,providedIn:"root",factory:hP}),d})();const dg=YF(null,"core",[]);let fP=(()=>{class d{constructor(p){}}return d.\u0275fac=function(p){return new(p||d)(gi(xx))},d.\u0275mod=Ic({type:d}),d.\u0275inj=ct({}),d})();function J4(d){return"boolean"==typeof d?d:null!=d&&"false"!==d}},3942:(kt,et,z)=>{"use strict";z.d(et,{Z:()=>Ae});var B=z(2090),Ee=z(4859),te=z(6881),He=z(1877);class je{constructor($e,Je){this._delegate=$e,this.firebase=Je,(0,te._addComponent)($e,new Ee.wA("app-compat",()=>this,"PUBLIC")),this.container=$e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled($e){this._delegate.automaticDataCollectionEnabled=$e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise($e=>{this._delegate.checkDestroyed(),$e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,te.deleteApp)(this._delegate)))}_getService($e,Je=te._DEFAULT_ENTRY_NAME){var Gt;this._delegate.checkDestroyed();const an=this._delegate.container.getProvider($e);return!an.isInitialized()&&"EXPLICIT"===(null===(Gt=an.getComponent())||void 0===Gt?void 0:Gt.instantiationMode)&&an.initialize(),an.getImmediate({identifier:Je})}_removeServiceInstance($e,Je=te._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider($e).clearInstance(Je)}_addComponent($e){(0,te._addComponent)(this._delegate,$e)}_addOrOverwriteComponent($e){(0,te._addOrOverwriteComponent)(this._delegate,$e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const tt=new B.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),K=function ne(){const Dt=function Ne(Dt){const $e={},Je={__esModule:!0,initializeApp:function nt(he,J={}){const a=te.initializeApp(he,J);if((0,B.r3)($e,a.name))return $e[a.name];const Ft=new Dt(a,Je);return $e[a.name]=Ft,Ft},app:an,registerVersion:te.registerVersion,setLogLevel:te.setLogLevel,onLog:te.onLog,apps:null,SDK_VERSION:te.SDK_VERSION,INTERNAL:{registerComponent:function Oe(he){const J=he.name,a=J.replace("-compat","");if(te._registerComponent(he)&&"PUBLIC"===he.type){const Ft=(Wt=an())=>{if("function"!=typeof Wt[a])throw tt.create("invalid-app-argument",{appName:J});return Wt[a]()};void 0!==he.serviceProps&&(0,B.ZB)(Ft,he.serviceProps),Je[a]=Ft,Dt.prototype[a]=function(...Wt){return this._getService.bind(this,J).apply(this,he.multipleInstances?Wt:[])}}return"PUBLIC"===he.type?Je[a]:null},removeApp:function Gt(he){delete $e[he]},useAsService:function be(he,J){return"serverAuth"===J?null:J},modularAPIs:te}};function an(he){if(!(0,B.r3)($e,he=he||te._DEFAULT_ENTRY_NAME))throw tt.create("no-app",{appName:he});return $e[he]}return Je.default=Je,Object.defineProperty(Je,"apps",{get:function Pe(){return Object.keys($e).map(he=>$e[he])}}),an.App=Dt,Je}(je);return Dt.INTERNAL=Object.assign(Object.assign({},Dt.INTERNAL),{createFirebaseNamespace:ne,extendNamespace:function $e(Je){(0,B.ZB)(Dt,Je)},createSubscribe:B.ne,ErrorFactory:B.LL,deepExtend:B.ZB}),Dt}(),ee=new He.Yd("@firebase/app-compat");if((0,B.jU)()&&void 0!==self.firebase){ee.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Dt=self.firebase.SDK_VERSION;Dt&&Dt.indexOf("LITE")>=0&&ee.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Ae=K;!function Ue(Dt){(0,te.registerVersion)("@firebase/app-compat","0.2.13",Dt)}()},6881:(kt,et,z)=>{"use strict";z.r(et),z.d(et,{FirebaseError:()=>He.ZR,SDK_VERSION:()=>pd,_DEFAULT_ENTRY_NAME:()=>nl,_addComponent:()=>So,_addOrOverwriteComponent:()=>Eo,_apps:()=>Br,_clearComponents:()=>Ai,_components:()=>wc,_getProvider:()=>rl,_registerComponent:()=>Pr,_removeServiceInstance:()=>Cc,deleteApp:()=>il,getApp:()=>Do,getApps:()=>Ea,initializeApp:()=>md,onLog:()=>gd,registerVersion:()=>eo,setLogLevel:()=>Dr});var B=z(5861),Ee=z(4859),te=z(1877),He=z(2090);let Re,tt;const K=new WeakMap,ee=new WeakMap,X=new WeakMap,Ce=new WeakMap,Ue=new WeakMap;let $e={get(ve,Fe,ut){if(ve instanceof IDBTransaction){if("done"===Fe)return ee.get(ve);if("objectStoreNames"===Fe)return ve.objectStoreNames||X.get(ve);if("store"===Fe)return ut.objectStoreNames[1]?void 0:ut.objectStore(ut.objectStoreNames[0])}return nt(ve[Fe])},set:(ve,Fe,ut)=>(ve[Fe]=ut,!0),has:(ve,Fe)=>ve instanceof IDBTransaction&&("done"===Fe||"store"===Fe)||Fe in ve};function an(ve){return"function"==typeof ve?function Gt(ve){return ve!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ne(){return tt||(tt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(ve)?function(...Fe){return ve.apply(Pe(this),Fe),nt(K.get(this))}:function(...Fe){return nt(ve.apply(Pe(this),Fe))}:function(Fe,...ut){const vt=ve.call(Pe(this),Fe,...ut);return X.set(vt,Fe.sort?Fe.sort():[Fe]),nt(vt)}}(ve):(ve instanceof IDBTransaction&&function Dt(ve){if(ee.has(ve))return;const Fe=new Promise((ut,vt)=>{const yn=()=>{ve.removeEventListener("complete",Rn),ve.removeEventListener("error",fr),ve.removeEventListener("abort",fr)},Rn=()=>{ut(),yn()},fr=()=>{vt(ve.error||new DOMException("AbortError","AbortError")),yn()};ve.addEventListener("complete",Rn),ve.addEventListener("error",fr),ve.addEventListener("abort",fr)});ee.set(ve,Fe)}(ve),((ve,Fe)=>Fe.some(ut=>ve instanceof ut))(ve,function Ne(){return Re||(Re=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(ve,$e):ve)}function nt(ve){if(ve instanceof IDBRequest)return function Ae(ve){const Fe=new Promise((ut,vt)=>{const yn=()=>{ve.removeEventListener("success",Rn),ve.removeEventListener("error",fr)},Rn=()=>{ut(nt(ve.result)),yn()},fr=()=>{vt(ve.error),yn()};ve.addEventListener("success",Rn),ve.addEventListener("error",fr)});return Fe.then(ut=>{ut instanceof IDBCursor&&K.set(ut,ve)}).catch(()=>{}),Ue.set(Fe,ve),Fe}(ve);if(Ce.has(ve))return Ce.get(ve);const Fe=an(ve);return Fe!==ve&&(Ce.set(ve,Fe),Ue.set(Fe,ve)),Fe}const Pe=ve=>Ue.get(ve),he=["get","getKey","getAll","getAllKeys","count"],J=["put","add","delete","clear"],a=new Map;function Ft(ve,Fe){if(!(ve instanceof IDBDatabase)||Fe in ve||"string"!=typeof Fe)return;if(a.get(Fe))return a.get(Fe);const ut=Fe.replace(/FromIndex$/,""),vt=Fe!==ut,yn=J.includes(ut);if(!(ut in(vt?IDBIndex:IDBObjectStore).prototype)||!yn&&!he.includes(ut))return;const Rn=function(){var fr=(0,B.Z)(function*(Vr,...Zn){const _s=this.transaction(Vr,yn?"readwrite":"readonly");let Da=_s.store;return vt&&(Da=Da.index(Zn.shift())),(yield Promise.all([Da[ut](...Zn),yn&&_s.done]))[0]});return function(Zn){return fr.apply(this,arguments)}}();return a.set(Fe,Rn),Rn}!function Je(ve){$e=ve($e)}(ve=>({...ve,get:(Fe,ut,vt)=>Ft(Fe,ut)||ve.get(Fe,ut,vt),has:(Fe,ut)=>!!Ft(Fe,ut)||ve.has(Fe,ut)}));class Wt{constructor(Fe){this.container=Fe}getPlatformInfoString(){return this.container.getProviders().map(ut=>{if(function bn(ve){return"VERSION"===ve.getComponent()?.type}(ut)){const vt=ut.getImmediate();return`${vt.library}/${vt.version}`}return null}).filter(ut=>ut).join(" ")}}const Gn="@firebase/app",Nt=new te.Yd("@firebase/app"),nl="[DEFAULT]",Js={[Gn]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Br=new Map,wc=new Map;function So(ve,Fe){try{ve.container.addComponent(Fe)}catch(ut){Nt.debug(`Component ${Fe.name} failed to register with FirebaseApp ${ve.name}`,ut)}}function Eo(ve,Fe){ve.container.addOrOverwriteComponent(Fe)}function Pr(ve){const Fe=ve.name;if(wc.has(Fe))return Nt.debug(`There were multiple attempts to register component ${Fe}.`),!1;wc.set(Fe,ve);for(const ut of Br.values())So(ut,ve);return!0}function rl(ve,Fe){const ut=ve.container.getProvider("heartbeat").getImmediate({optional:!0});return ut&&ut.triggerHeartbeat(),ve.container.getProvider(Fe)}function Cc(ve,Fe,ut=nl){rl(ve,Fe).clearInstance(ut)}function Ai(){wc.clear()}const ji=new He.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class xc{constructor(Fe,ut,vt){this._isDeleted=!1,this._options=Object.assign({},Fe),this._config=Object.assign({},ut),this._name=ut.name,this._automaticDataCollectionEnabled=ut.automaticDataCollectionEnabled,this._container=vt,this.container.addComponent(new Ee.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Fe){this.checkDestroyed(),this._automaticDataCollectionEnabled=Fe}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Fe){this._isDeleted=Fe}checkDestroyed(){if(this.isDeleted)throw ji.create("app-deleted",{appName:this._name})}}const pd="9.23.0";function md(ve,Fe={}){let ut=ve;"object"!=typeof Fe&&(Fe={name:Fe});const vt=Object.assign({name:nl,automaticDataCollectionEnabled:!1},Fe),yn=vt.name;if("string"!=typeof yn||!yn)throw ji.create("bad-app-name",{appName:String(yn)});if(ut||(ut=(0,He.aH)()),!ut)throw ji.create("no-options");const Rn=Br.get(yn);if(Rn){if((0,He.vZ)(ut,Rn.options)&&(0,He.vZ)(vt,Rn.config))return Rn;throw ji.create("duplicate-app",{appName:yn})}const fr=new Ee.H0(yn);for(const Zn of wc.values())fr.addComponent(Zn);const Vr=new xc(ut,vt,fr);return Br.set(yn,Vr),Vr}function Do(ve=nl){const Fe=Br.get(ve);if(!Fe&&ve===nl&&(0,He.aH)())return md();if(!Fe)throw ji.create("no-app",{appName:ve});return Fe}function Ea(){return Array.from(Br.values())}function il(ve){return gs.apply(this,arguments)}function gs(){return(gs=(0,B.Z)(function*(ve){const Fe=ve.name;Br.has(Fe)&&(Br.delete(Fe),yield Promise.all(ve.container.getProviders().map(ut=>ut.delete())),ve.isDeleted=!0)})).apply(this,arguments)}function eo(ve,Fe,ut){var vt;let yn=null!==(vt=Js[ve])&&void 0!==vt?vt:ve;ut&&(yn+=`-${ut}`);const Rn=yn.match(/\s|\//),fr=Fe.match(/\s|\//);if(Rn||fr){const Vr=[`Unable to register library "${yn}" with version "${Fe}":`];return Rn&&Vr.push(`library name "${yn}" contains illegal characters (whitespace or "/")`),Rn&&fr&&Vr.push("and"),fr&&Vr.push(`version name "${Fe}" contains illegal characters (whitespace or "/")`),void Nt.warn(Vr.join(" "))}Pr(new Ee.wA(`${yn}-version`,()=>({library:yn,version:Fe}),"VERSION"))}function gd(ve,Fe){if(null!==ve&&"function"!=typeof ve)throw ji.create("invalid-log-argument");(0,te.Am)(ve,Fe)}function Dr(ve){(0,te.Ub)(ve)}const ae="firebase-heartbeat-store";let ie=null;function me(){return ie||(ie=function Oe(ve,Fe,{blocked:ut,upgrade:vt,blocking:yn,terminated:Rn}={}){const fr=indexedDB.open(ve,Fe),Vr=nt(fr);return vt&&fr.addEventListener("upgradeneeded",Zn=>{vt(nt(fr.result),Zn.oldVersion,Zn.newVersion,nt(fr.transaction),Zn)}),ut&&fr.addEventListener("blocked",Zn=>ut(Zn.oldVersion,Zn.newVersion,Zn)),Vr.then(Zn=>{Rn&&Zn.addEventListener("close",()=>Rn()),yn&&Zn.addEventListener("versionchange",_s=>yn(_s.oldVersion,_s.newVersion,_s))}).catch(()=>{}),Vr}("firebase-heartbeat-database",1,{upgrade:(ve,Fe)=>{0===Fe&&ve.createObjectStore(ae)}}).catch(ve=>{throw ji.create("idb-open",{originalErrorMessage:ve.message})})),ie}function Se(){return(Se=(0,B.Z)(function*(ve){try{return yield(yield me()).transaction(ae).objectStore(ae).get(Rt(ve))}catch(Fe){if(Fe instanceof He.ZR)Nt.warn(Fe.message);else{const ut=ji.create("idb-get",{originalErrorMessage:Fe?.message});Nt.warn(ut.message)}}})).apply(this,arguments)}function wt(ve,Fe){return yt.apply(this,arguments)}function yt(){return(yt=(0,B.Z)(function*(ve,Fe){try{const vt=(yield me()).transaction(ae,"readwrite");yield vt.objectStore(ae).put(Fe,Rt(ve)),yield vt.done}catch(ut){if(ut instanceof He.ZR)Nt.warn(ut.message);else{const vt=ji.create("idb-set",{originalErrorMessage:ut?.message});Nt.warn(vt.message)}}})).apply(this,arguments)}function Rt(ve){return`${ve.name}!${ve.options.appId}`}class Zt{constructor(Fe){this.container=Fe,this._heartbeatsCache=null;const ut=this.container.getProvider("app").getImmediate();this._storage=new to(ut),this._heartbeatsCachePromise=this._storage.read().then(vt=>(this._heartbeatsCache=vt,vt))}triggerHeartbeat(){var Fe=this;return(0,B.Z)(function*(){const vt=Fe.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),yn=on();if(null===Fe._heartbeatsCache&&(Fe._heartbeatsCache=yield Fe._heartbeatsCachePromise),Fe._heartbeatsCache.lastSentHeartbeatDate!==yn&&!Fe._heartbeatsCache.heartbeats.some(Rn=>Rn.date===yn))return Fe._heartbeatsCache.heartbeats.push({date:yn,agent:vt}),Fe._heartbeatsCache.heartbeats=Fe._heartbeatsCache.heartbeats.filter(Rn=>{const fr=new Date(Rn.date).valueOf();return Date.now()-fr<=2592e6}),Fe._storage.overwrite(Fe._heartbeatsCache)})()}getHeartbeatsHeader(){var Fe=this;return(0,B.Z)(function*(){if(null===Fe._heartbeatsCache&&(yield Fe._heartbeatsCachePromise),null===Fe._heartbeatsCache||0===Fe._heartbeatsCache.heartbeats.length)return"";const ut=on(),{heartbeatsToSend:vt,unsentEntries:yn}=function er(ve,Fe=1024){const ut=[];let vt=ve.slice();for(const yn of ve){const Rn=ut.find(fr=>fr.agent===yn.agent);if(Rn){if(Rn.dates.push(yn.date),Nn(ut)>Fe){Rn.dates.pop();break}}else if(ut.push({agent:yn.agent,dates:[yn.date]}),Nn(ut)>Fe){ut.pop();break}vt=vt.slice(1)}return{heartbeatsToSend:ut,unsentEntries:vt}}(Fe._heartbeatsCache.heartbeats),Rn=(0,He.L)(JSON.stringify({version:2,heartbeats:vt}));return Fe._heartbeatsCache.lastSentHeartbeatDate=ut,yn.length>0?(Fe._heartbeatsCache.heartbeats=yn,yield Fe._storage.overwrite(Fe._heartbeatsCache)):(Fe._heartbeatsCache.heartbeats=[],Fe._storage.overwrite(Fe._heartbeatsCache)),Rn})()}}function on(){return(new Date).toISOString().substring(0,10)}class to{constructor(Fe){this.app=Fe,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,B.Z)(function*(){return!!(0,He.hl)()&&(0,He.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Fe=this;return(0,B.Z)(function*(){return(yield Fe._canUseIndexedDBPromise)&&(yield function Ge(ve){return Se.apply(this,arguments)}(Fe.app))||{heartbeats:[]}})()}overwrite(Fe){var ut=this;return(0,B.Z)(function*(){var vt;if(yield ut._canUseIndexedDBPromise){const Rn=yield ut.read();return wt(ut.app,{lastSentHeartbeatDate:null!==(vt=Fe.lastSentHeartbeatDate)&&void 0!==vt?vt:Rn.lastSentHeartbeatDate,heartbeats:Fe.heartbeats})}})()}add(Fe){var ut=this;return(0,B.Z)(function*(){var vt;if(yield ut._canUseIndexedDBPromise){const Rn=yield ut.read();return wt(ut.app,{lastSentHeartbeatDate:null!==(vt=Fe.lastSentHeartbeatDate)&&void 0!==vt?vt:Rn.lastSentHeartbeatDate,heartbeats:[...Rn.heartbeats,...Fe.heartbeats]})}})()}}function Nn(ve){return(0,He.L)(JSON.stringify({version:2,heartbeats:ve})).length}!function Bl(ve){Pr(new Ee.wA("platform-logger",Fe=>new Wt(Fe),"PRIVATE")),Pr(new Ee.wA("heartbeat",Fe=>new Zt(Fe),"PRIVATE")),eo(Gn,"0.9.13",ve),eo(Gn,"0.9.13","esm2017"),eo("fire-js","")}("")},4859:(kt,et,z)=>{"use strict";z.d(et,{H0:()=>Ne,wA:()=>te,zt:()=>je});var B=z(5861),Ee=z(2090);class te{constructor(K,ee,X){this.name=K,this.instanceFactory=ee,this.type=X,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(K){return this.instantiationMode=K,this}setMultipleInstances(K){return this.multipleInstances=K,this}setServiceProps(K){return this.serviceProps=K,this}setInstanceCreatedCallback(K){return this.onInstanceCreated=K,this}}const He="[DEFAULT]";class je{constructor(K,ee){this.name=K,this.container=ee,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(K){const ee=this.normalizeInstanceIdentifier(K);if(!this.instancesDeferred.has(ee)){const X=new Ee.BH;if(this.instancesDeferred.set(ee,X),this.isInitialized(ee)||this.shouldAutoInitialize())try{const Ce=this.getOrInitializeService({instanceIdentifier:ee});Ce&&X.resolve(Ce)}catch{}}return this.instancesDeferred.get(ee).promise}getImmediate(K){var ee;const X=this.normalizeInstanceIdentifier(K?.identifier),Ce=null!==(ee=K?.optional)&&void 0!==ee&&ee;if(!this.isInitialized(X)&&!this.shouldAutoInitialize()){if(Ce)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:X})}catch(Ue){if(Ce)return null;throw Ue}}getComponent(){return this.component}setComponent(K){if(K.name!==this.name)throw Error(`Mismatching Component ${K.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=K,this.shouldAutoInitialize()){if(function tt(ne){return"EAGER"===ne.instantiationMode}(K))try{this.getOrInitializeService({instanceIdentifier:He})}catch{}for(const[ee,X]of this.instancesDeferred.entries()){const Ce=this.normalizeInstanceIdentifier(ee);try{const Ue=this.getOrInitializeService({instanceIdentifier:Ce});X.resolve(Ue)}catch{}}}}clearInstance(K=He){this.instancesDeferred.delete(K),this.instancesOptions.delete(K),this.instances.delete(K)}delete(){var K=this;return(0,B.Z)(function*(){const ee=Array.from(K.instances.values());yield Promise.all([...ee.filter(X=>"INTERNAL"in X).map(X=>X.INTERNAL.delete()),...ee.filter(X=>"_delete"in X).map(X=>X._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(K=He){return this.instances.has(K)}getOptions(K=He){return this.instancesOptions.get(K)||{}}initialize(K={}){const{options:ee={}}=K,X=this.normalizeInstanceIdentifier(K.instanceIdentifier);if(this.isInitialized(X))throw Error(`${this.name}(${X}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Ce=this.getOrInitializeService({instanceIdentifier:X,options:ee});for(const[Ue,Ae]of this.instancesDeferred.entries())X===this.normalizeInstanceIdentifier(Ue)&&Ae.resolve(Ce);return Ce}onInit(K,ee){var X;const Ce=this.normalizeInstanceIdentifier(ee),Ue=null!==(X=this.onInitCallbacks.get(Ce))&&void 0!==X?X:new Set;Ue.add(K),this.onInitCallbacks.set(Ce,Ue);const Ae=this.instances.get(Ce);return Ae&&K(Ae,Ce),()=>{Ue.delete(K)}}invokeOnInitCallbacks(K,ee){const X=this.onInitCallbacks.get(ee);if(X)for(const Ce of X)try{Ce(K,ee)}catch{}}getOrInitializeService({instanceIdentifier:K,options:ee={}}){let X=this.instances.get(K);if(!X&&this.component&&(X=this.component.instanceFactory(this.container,{instanceIdentifier:(ne=K,ne===He?void 0:ne),options:ee}),this.instances.set(K,X),this.instancesOptions.set(K,ee),this.invokeOnInitCallbacks(X,K),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,K,X)}catch{}var ne;return X||null}normalizeInstanceIdentifier(K=He){return this.component?this.component.multipleInstances?K:He:K}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ne{constructor(K){this.name=K,this.providers=new Map}addComponent(K){const ee=this.getProvider(K.name);if(ee.isComponentSet())throw new Error(`Component ${K.name} has already been registered with ${this.name}`);ee.setComponent(K)}addOrOverwriteComponent(K){this.getProvider(K.name).isComponentSet()&&this.providers.delete(K.name),this.addComponent(K)}getProvider(K){if(this.providers.has(K))return this.providers.get(K);const ee=new je(K,this);return this.providers.set(K,ee),ee}getProviders(){return Array.from(this.providers.values())}}},1877:(kt,et,z)=>{"use strict";z.d(et,{Am:()=>ne,Ub:()=>Ne,Yd:()=>tt,in:()=>Ee});const B=[];var Ee=(()=>{return(K=Ee||(Ee={}))[K.DEBUG=0]="DEBUG",K[K.VERBOSE=1]="VERBOSE",K[K.INFO=2]="INFO",K[K.WARN=3]="WARN",K[K.ERROR=4]="ERROR",K[K.SILENT=5]="SILENT",Ee;var K})();const te={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},He=Ee.INFO,je={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},Re=(K,ee,...X)=>{if(ee<K.logLevel)return;const Ce=(new Date).toISOString(),Ue=je[ee];if(!Ue)throw new Error(`Attempted to log a message with an invalid logType (value: ${ee})`);console[Ue](`[${Ce}]  ${K.name}:`,...X)};class tt{constructor(ee){this.name=ee,this._logLevel=He,this._logHandler=Re,this._userLogHandler=null,B.push(this)}get logLevel(){return this._logLevel}set logLevel(ee){if(!(ee in Ee))throw new TypeError(`Invalid value "${ee}" assigned to \`logLevel\``);this._logLevel=ee}setLogLevel(ee){this._logLevel="string"==typeof ee?te[ee]:ee}get logHandler(){return this._logHandler}set logHandler(ee){if("function"!=typeof ee)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=ee}get userLogHandler(){return this._userLogHandler}set userLogHandler(ee){this._userLogHandler=ee}debug(...ee){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...ee),this._logHandler(this,Ee.DEBUG,...ee)}log(...ee){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...ee),this._logHandler(this,Ee.VERBOSE,...ee)}info(...ee){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...ee),this._logHandler(this,Ee.INFO,...ee)}warn(...ee){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...ee),this._logHandler(this,Ee.WARN,...ee)}error(...ee){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...ee),this._logHandler(this,Ee.ERROR,...ee)}}function Ne(K){B.forEach(ee=>{ee.setLogLevel(K)})}function ne(K,ee){for(const X of B){let Ce=null;ee&&ee.level&&(Ce=te[ee.level]),X.userLogHandler=null===K?null:(Ue,Ae,...Dt)=>{const $e=Dt.map(Je=>{if(null==Je)return null;if("string"==typeof Je)return Je;if("number"==typeof Je||"boolean"==typeof Je)return Je.toString();if(Je instanceof Error)return Je.message;try{return JSON.stringify(Je)}catch{return null}}).filter(Je=>Je).join(" ");Ae>=(Ce??Ue.logLevel)&&K({level:Ee[Ae].toLowerCase(),message:$e,args:Dt,type:Ue.name})}}}},9260:(kt,et,z)=>{"use strict";z.d(et,{Z:()=>B.Z});var B=z(3942);B.Z.registerVersion("firebase","9.23.0","app-compat")},2644:(kt,et,z)=>{"use strict";z.r(et);var B=z(5861),Ee=z(3942),te=z(2090),He=z(6881),je=z(7582),Re=z(1877),tt=z(4859);const Ae=function Ce(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},Dt=function Ue(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},$e=new te.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Gt=new Re.Yd("@firebase/auth");function nt(S,...b){Gt.logLevel<=Re.in.ERROR&&Gt.error(`Auth (${He.SDK_VERSION}): ${S}`,...b)}function Pe(S,...b){throw J(S,...b)}function Oe(S,...b){return J(S,...b)}function be(S,b,C){const k=Object.assign(Object.assign({},Dt()),{[b]:C});return new te.LL("auth","Firebase",k).create(b,{appName:S.name})}function he(S,b,C){if(!(b instanceof C))throw C.name!==b.constructor.name&&Pe(S,"argument-error"),be(S,"argument-error",`Type of ${b.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function J(S,...b){if("string"!=typeof S){const C=b[0],k=[...b.slice(1)];return k[0]&&(k[0].appName=S.name),S._errorFactory.create(C,...k)}return $e.create(S,...b)}function a(S,b,...C){if(!S)throw J(b,...C)}function Ft(S){const b="INTERNAL ASSERTION FAILED: "+S;throw nt(b),new Error(b)}function Wt(S,b){S||Ft(b)}function bn(){var S;return typeof self<"u"&&(null===(S=self.location)||void 0===S?void 0:S.href)||""}function Gn(){return"http:"===Sr()||"https:"===Sr()}function Sr(){var S;return typeof self<"u"&&(null===(S=self.location)||void 0===S?void 0:S.protocol)||null}class vr{constructor(b,C){this.shortDelay=b,this.longDelay=C,Wt(C>b,"Short delay should be less than long delay!"),this.isMobile=(0,te.uI)()||(0,te.b$)()}get(){return function Nt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Gn()||(0,te.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function sr(S,b){Wt(S.emulator,"Emulator should always be set here");const{url:C}=S.emulator;return b?`${C}${b.startsWith("/")?b.slice(1):b}`:C}class un{static initialize(b,C,k){this.fetchImpl=b,C&&(this.headersImpl=C),k&&(this.responseImpl=k)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Ft("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Ft("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Ft("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ke={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},qe=new vr(3e4,6e4);function Le(S,b){return S.tenantId&&!b.tenantId?Object.assign(Object.assign({},b),{tenantId:S.tenantId}):b}function Te(S,b,C,k){return ft.apply(this,arguments)}function ft(){return(ft=(0,B.Z)(function*(S,b,C,k,L={}){return ct(S,L,(0,B.Z)(function*(){let U={},le={};k&&("GET"===b?le=k:U={body:JSON.stringify(k)});const xe=(0,te.xO)(Object.assign({key:S.config.apiKey},le)).slice(1),at=yield S._getAdditionalHeaders();return at["Content-Type"]="application/json",S.languageCode&&(at["X-Firebase-Locale"]=S.languageCode),un.fetch()(_n(S,S.config.apiHost,C,xe),Object.assign({method:b,headers:at,referrerPolicy:"no-referrer"},U))}))})).apply(this,arguments)}function ct(S,b,C){return Qt.apply(this,arguments)}function Qt(){return(Qt=(0,B.Z)(function*(S,b,C){S._canInitEmulator=!1;const k=Object.assign(Object.assign({},ke),b);try{const L=new Fr(S),U=yield Promise.race([C(),L.promise]);L.clearNetworkTimeout();const le=yield U.json();if("needConfirmation"in le)throw Ar(S,"account-exists-with-different-credential",le);if(U.ok&&!("errorMessage"in le))return le;{const xe=U.ok?le.errorMessage:le.error.message,[at,Et]=xe.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===at)throw Ar(S,"credential-already-in-use",le);if("EMAIL_EXISTS"===at)throw Ar(S,"email-already-in-use",le);if("USER_DISABLED"===at)throw Ar(S,"user-disabled",le);const Ut=k[at]||at.toLowerCase().replace(/[_\s]+/g,"-");if(Et)throw be(S,Ut,Et);Pe(S,Ut)}}catch(L){if(L instanceof te.ZR)throw L;Pe(S,"network-request-failed",{message:String(L)})}})).apply(this,arguments)}function Fn(S,b,C,k){return kr.apply(this,arguments)}function kr(){return(kr=(0,B.Z)(function*(S,b,C,k,L={}){const U=yield Te(S,b,C,k,L);return"mfaPendingCredential"in U&&Pe(S,"multi-factor-auth-required",{_serverResponse:U}),U})).apply(this,arguments)}function _n(S,b,C,k){const L=`${b}${C}?${k}`;return S.config.emulator?sr(S.config,L):`${S.config.apiScheme}://${L}`}class Fr{constructor(b){this.auth=b,this.timer=null,this.promise=new Promise((C,k)=>{this.timer=setTimeout(()=>k(Oe(this.auth,"network-request-failed")),qe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ar(S,b,C){const k={appName:S.name};C.email&&(k.email=C.email),C.phoneNumber&&(k.phoneNumber=C.phoneNumber);const L=Oe(S,b,k);return L.customData._tokenResponse=C,L}function Jn(){return(Jn=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:delete",b)})).apply(this,arguments)}function lr(S,b){return Wn.apply(this,arguments)}function Wn(){return(Wn=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:update",b)})).apply(this,arguments)}function Mt(S,b){return fn.apply(this,arguments)}function fn(){return(fn=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:lookup",b)})).apply(this,arguments)}function hr(S){if(S)try{const b=new Date(Number(S));if(!isNaN(b.getTime()))return b.toUTCString()}catch{}}function nl(){return(nl=(0,B.Z)(function*(S,b=!1){const C=(0,te.m9)(S),k=yield C.getIdToken(b),L=Br(k);a(L&&L.exp&&L.auth_time&&L.iat,C.auth,"internal-error");const U="object"==typeof L.firebase?L.firebase:void 0,le=U?.sign_in_provider;return{claims:L,token:k,authTime:hr(Js(L.auth_time)),issuedAtTime:hr(Js(L.iat)),expirationTime:hr(Js(L.exp)),signInProvider:le||null,signInSecondFactor:U?.sign_in_second_factor||null}})).apply(this,arguments)}function Js(S){return 1e3*Number(S)}function Br(S){const[b,C,k]=S.split(".");if(void 0===b||void 0===C||void 0===k)return nt("JWT malformed, contained fewer than 3 sections"),null;try{const L=(0,te.tV)(C);return L?JSON.parse(L):(nt("Failed to decode base64 JWT payload"),null)}catch(L){return nt("Caught error parsing JWT payload as JSON",L?.toString()),null}}function So(S,b){return Eo.apply(this,arguments)}function Eo(){return(Eo=(0,B.Z)(function*(S,b,C=!1){if(C)return b;try{return yield b}catch(k){throw k instanceof te.ZR&&Pr(k)&&S.auth.currentUser===S&&(yield S.auth.signOut()),k}})).apply(this,arguments)}function Pr({code:S}){return"auth/user-disabled"===S||"auth/user-token-expired"===S}class rl{constructor(b){this.user=b,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(b){var C;if(b){const k=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),k}{this.errorBackoff=3e4;const L=(null!==(C=this.user.stsTokenManager.expirationTime)&&void 0!==C?C:0)-Date.now()-3e5;return Math.max(0,L)}}schedule(b=!1){var C=this;if(!this.isRunning)return;const k=this.getInterval(b);this.timerId=setTimeout((0,B.Z)(function*(){yield C.iteration()}),k)}iteration(){var b=this;return(0,B.Z)(function*(){try{yield b.user.getIdToken(!0)}catch(C){return void("auth/network-request-failed"===C?.code&&b.schedule(!0))}b.schedule()})()}}class Cc{constructor(b,C){this.createdAt=b,this.lastLoginAt=C,this._initializeTime()}_initializeTime(){this.lastSignInTime=hr(this.lastLoginAt),this.creationTime=hr(this.createdAt)}_copy(b){this.createdAt=b.createdAt,this.lastLoginAt=b.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Ai(S){return In.apply(this,arguments)}function In(){return(In=(0,B.Z)(function*(S){var b;const C=S.auth,k=yield S.getIdToken(),L=yield So(S,Mt(C,{idToken:k}));a(L?.users.length,C,"internal-error");const U=L.users[0];S._notifyReloadListener(U);const le=null!==(b=U.providerUserInfo)&&void 0!==b&&b.length?md(U.providerUserInfo):[],xe=pd(S.providerData,le),Ut=!!S.isAnonymous&&!(S.email&&U.passwordHash||xe?.length),jt={uid:U.localId,displayName:U.displayName||null,photoURL:U.photoUrl||null,email:U.email||null,emailVerified:U.emailVerified||!1,phoneNumber:U.phoneNumber||null,tenantId:U.tenantId||null,providerData:xe,metadata:new Cc(U.createdAt,U.lastLoginAt),isAnonymous:Ut};Object.assign(S,jt)})).apply(this,arguments)}function xc(){return(xc=(0,B.Z)(function*(S){const b=(0,te.m9)(S);yield Ai(b),yield b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)})).apply(this,arguments)}function pd(S,b){return[...S.filter(k=>!b.some(L=>L.providerId===k.providerId)),...b]}function md(S){return S.map(b=>{var{providerId:C}=b,k=(0,je._T)(b,["providerId"]);return{providerId:C,uid:k.rawId||"",displayName:k.displayName||null,email:k.email||null,phoneNumber:k.phoneNumber||null,photoURL:k.photoUrl||null}})}function Ea(){return(Ea=(0,B.Z)(function*(S,b){const C=yield ct(S,{},(0,B.Z)(function*(){const k=(0,te.xO)({grant_type:"refresh_token",refresh_token:b}).slice(1),{tokenApiHost:L,apiKey:U}=S.config,le=_n(S,L,"/v1/token",`key=${U}`),xe=yield S._getAdditionalHeaders();return xe["Content-Type"]="application/x-www-form-urlencoded",un.fetch()(le,{method:"POST",headers:xe,body:k})}));return{accessToken:C.access_token,expiresIn:C.expires_in,refreshToken:C.refresh_token}})).apply(this,arguments)}class il{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(b){a(b.idToken,"internal-error"),a(typeof b.idToken<"u","internal-error"),a(typeof b.refreshToken<"u","internal-error");const C="expiresIn"in b&&typeof b.expiresIn<"u"?Number(b.expiresIn):function wc(S){const b=Br(S);return a(b,"internal-error"),a(typeof b.exp<"u","internal-error"),a(typeof b.iat<"u","internal-error"),Number(b.exp)-Number(b.iat)}(b.idToken);this.updateTokensAndExpiration(b.idToken,b.refreshToken,C)}getToken(b,C=!1){var k=this;return(0,B.Z)(function*(){return a(!k.accessToken||k.refreshToken,b,"user-token-expired"),C||!k.accessToken||k.isExpired?k.refreshToken?(yield k.refresh(b,k.refreshToken),k.accessToken):null:k.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(b,C){var k=this;return(0,B.Z)(function*(){const{accessToken:L,refreshToken:U,expiresIn:le}=yield function Do(S,b){return Ea.apply(this,arguments)}(b,C);k.updateTokensAndExpiration(L,U,Number(le))})()}updateTokensAndExpiration(b,C,k){this.refreshToken=C||null,this.accessToken=b||null,this.expirationTime=Date.now()+1e3*k}static fromJSON(b,C){const{refreshToken:k,accessToken:L,expirationTime:U}=C,le=new il;return k&&(a("string"==typeof k,"internal-error",{appName:b}),le.refreshToken=k),L&&(a("string"==typeof L,"internal-error",{appName:b}),le.accessToken=L),U&&(a("number"==typeof U,"internal-error",{appName:b}),le.expirationTime=U),le}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(b){this.accessToken=b.accessToken,this.refreshToken=b.refreshToken,this.expirationTime=b.expirationTime}_clone(){return Object.assign(new il,this.toJSON())}_performRefresh(){return Ft("not implemented")}}function gs(S,b){a("string"==typeof S||typeof S>"u","internal-error",{appName:b})}class eo{constructor(b){var{uid:C,auth:k,stsTokenManager:L}=b,U=(0,je._T)(b,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new rl(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=C,this.auth=k,this.stsTokenManager=L,this.accessToken=L.accessToken,this.displayName=U.displayName||null,this.email=U.email||null,this.emailVerified=U.emailVerified||!1,this.phoneNumber=U.phoneNumber||null,this.photoURL=U.photoURL||null,this.isAnonymous=U.isAnonymous||!1,this.tenantId=U.tenantId||null,this.providerData=U.providerData?[...U.providerData]:[],this.metadata=new Cc(U.createdAt||void 0,U.lastLoginAt||void 0)}getIdToken(b){var C=this;return(0,B.Z)(function*(){const k=yield So(C,C.stsTokenManager.getToken(C.auth,b));return a(k,C.auth,"internal-error"),C.accessToken!==k&&(C.accessToken=k,yield C.auth._persistUserIfCurrent(C),C.auth._notifyListenersIfCurrent(C)),k})()}getIdTokenResult(b){return function Rh(S){return nl.apply(this,arguments)}(this,b)}reload(){return function ji(S){return xc.apply(this,arguments)}(this)}_assign(b){this!==b&&(a(this.uid===b.uid,this.auth,"internal-error"),this.displayName=b.displayName,this.photoURL=b.photoURL,this.email=b.email,this.emailVerified=b.emailVerified,this.phoneNumber=b.phoneNumber,this.isAnonymous=b.isAnonymous,this.tenantId=b.tenantId,this.providerData=b.providerData.map(C=>Object.assign({},C)),this.metadata._copy(b.metadata),this.stsTokenManager._assign(b.stsTokenManager))}_clone(b){const C=new eo(Object.assign(Object.assign({},this),{auth:b,stsTokenManager:this.stsTokenManager._clone()}));return C.metadata._copy(this.metadata),C}_onReload(b){a(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=b,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(b){this.reloadListener?this.reloadListener(b):this.reloadUserInfo=b}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(b,C=!1){var k=this;return(0,B.Z)(function*(){let L=!1;b.idToken&&b.idToken!==k.stsTokenManager.accessToken&&(k.stsTokenManager.updateFromServerResponse(b),L=!0),C&&(yield Ai(k)),yield k.auth._persistUserIfCurrent(k),L&&k.auth._notifyListenersIfCurrent(k)})()}delete(){var b=this;return(0,B.Z)(function*(){const C=yield b.getIdToken();return yield So(b,function Ls(S,b){return Jn.apply(this,arguments)}(b.auth,{idToken:C})),b.stsTokenManager.clearRefreshToken(),b.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(b=>Object.assign({},b)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(b,C){var k,L,U,le,xe,at,Et,Ut;const jt=null!==(k=C.displayName)&&void 0!==k?k:void 0,Kr=null!==(L=C.email)&&void 0!==L?L:void 0,Oo=null!==(U=C.phoneNumber)&&void 0!==U?U:void 0,Xy=null!==(le=C.photoURL)&&void 0!==le?le:void 0,TS=null!==(xe=C.tenantId)&&void 0!==xe?xe:void 0,Sm=null!==(at=C._redirectEventId)&&void 0!==at?at:void 0,Mw=null!==(Et=C.createdAt)&&void 0!==Et?Et:void 0,Ow=null!==(Ut=C.lastLoginAt)&&void 0!==Ut?Ut:void 0,{uid:Em,emailVerified:Fw,isAnonymous:Jy,providerData:Nu,stsTokenManager:ev}=C;a(Em&&ev,b,"internal-error");const gf=il.fromJSON(this.name,ev);a("string"==typeof Em,b,"internal-error"),gs(jt,b.name),gs(Kr,b.name),a("boolean"==typeof Fw,b,"internal-error"),a("boolean"==typeof Jy,b,"internal-error"),gs(Oo,b.name),gs(Xy,b.name),gs(TS,b.name),gs(Sm,b.name),gs(Mw,b.name),gs(Ow,b.name);const tv=new eo({uid:Em,auth:b,email:Kr,emailVerified:Fw,displayName:jt,isAnonymous:Jy,photoURL:Xy,phoneNumber:Oo,tenantId:TS,stsTokenManager:gf,createdAt:Mw,lastLoginAt:Ow});return Nu&&Array.isArray(Nu)&&(tv.providerData=Nu.map(vi=>Object.assign({},vi))),Sm&&(tv._redirectEventId=Sm),tv}static _fromIdTokenResponse(b,C,k=!1){return(0,B.Z)(function*(){const L=new il;L.updateFromServerResponse(C);const U=new eo({uid:C.localId,auth:b,stsTokenManager:L,isAnonymous:k});return yield Ai(U),U})()}}const gd=new Map;function Dr(S){Wt(S instanceof Function,"Expected a class definition");let b=gd.get(S);return b?(Wt(b instanceof S,"Instance stored in cache mismatched with class"),b):(b=new S,gd.set(S,b),b)}const sl=(()=>{class S{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,B.Z)(function*(){return!0})()}_set(C,k){var L=this;return(0,B.Z)(function*(){L.storage[C]=k})()}_get(C){var k=this;return(0,B.Z)(function*(){const L=k.storage[C];return void 0===L?null:L})()}_remove(C){var k=this;return(0,B.Z)(function*(){delete k.storage[C]})()}_addListener(C,k){}_removeListener(C,k){}}return S.type="NONE",S})();function ae(S,b,C){return`firebase:${S}:${b}:${C}`}class ie{constructor(b,C,k){this.persistence=b,this.auth=C,this.userKey=k;const{config:L,name:U}=this.auth;this.fullUserKey=ae(this.userKey,L.apiKey,U),this.fullPersistenceKey=ae("persistence",L.apiKey,U),this.boundEventHandler=C._onStorageEvent.bind(C),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(b){return this.persistence._set(this.fullUserKey,b.toJSON())}getCurrentUser(){var b=this;return(0,B.Z)(function*(){const C=yield b.persistence._get(b.fullUserKey);return C?eo._fromJSON(b.auth,C):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(b){var C=this;return(0,B.Z)(function*(){if(C.persistence===b)return;const k=yield C.getCurrentUser();return yield C.removeCurrentUser(),C.persistence=b,k?C.setCurrentUser(k):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(b,C,k="authUser"){return(0,B.Z)(function*(){if(!C.length)return new ie(Dr(sl),b,k);const L=(yield Promise.all(C.map(function(){var Et=(0,B.Z)(function*(Ut){if(yield Ut._isAvailable())return Ut});return function(Ut){return Et.apply(this,arguments)}}()))).filter(Et=>Et);let U=L[0]||Dr(sl);const le=ae(k,b.config.apiKey,b.name);let xe=null;for(const Et of C)try{const Ut=yield Et._get(le);if(Ut){const jt=eo._fromJSON(b,Ut);Et!==U&&(xe=jt),U=Et;break}}catch{}const at=L.filter(Et=>Et._shouldAllowMigration);return U._shouldAllowMigration&&at.length?(U=at[0],xe&&(yield U._set(le,xe.toJSON())),yield Promise.all(C.map(function(){var Et=(0,B.Z)(function*(Ut){if(Ut!==U)try{yield Ut._remove(le)}catch{}});return function(Ut){return Et.apply(this,arguments)}}())),new ie(U,b,k)):new ie(U,b,k)})()}}function me(S){const b=S.toLowerCase();if(b.includes("opera/")||b.includes("opr/")||b.includes("opios/"))return"Opera";if(yt(b))return"IEMobile";if(b.includes("msie")||b.includes("trident/"))return"IE";if(b.includes("edge/"))return"Edge";if(Ge(b))return"Firefox";if(b.includes("silk/"))return"Silk";if(Nr(b))return"Blackberry";if(It(b))return"Webos";if(Se(b))return"Safari";if((b.includes("chrome/")||wt(b))&&!b.includes("edge/"))return"Chrome";if(Rt(b))return"Android";{const k=S.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===k?.length)return k[1]}return"Other"}function Ge(S=(0,te.z$)()){return/firefox\//i.test(S)}function Se(S=(0,te.z$)()){const b=S.toLowerCase();return b.includes("safari/")&&!b.includes("chrome/")&&!b.includes("crios/")&&!b.includes("android")}function wt(S=(0,te.z$)()){return/crios\//i.test(S)}function yt(S=(0,te.z$)()){return/iemobile/i.test(S)}function Rt(S=(0,te.z$)()){return/android/i.test(S)}function Nr(S=(0,te.z$)()){return/blackberry/i.test(S)}function It(S=(0,te.z$)()){return/webos/i.test(S)}function Zt(S=(0,te.z$)()){return/iphone|ipad|ipod/i.test(S)||/macintosh/i.test(S)&&/mobile/i.test(S)}function Nn(S=(0,te.z$)()){return Zt(S)||Rt(S)||It(S)||Nr(S)||/windows phone/i.test(S)||yt(S)}function ve(S,b=[]){let C;switch(S){case"Browser":C=me((0,te.z$)());break;case"Worker":C=`${me((0,te.z$)())}-${S}`;break;default:C=S}const k=b.length?b.join(","):"FirebaseCore-web";return`${C}/JsCore/${He.SDK_VERSION}/${k}`}function ut(){return(ut=(0,B.Z)(function*(S){return(yield Te(S,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function vt(S,b){return yn.apply(this,arguments)}function yn(){return(yn=(0,B.Z)(function*(S,b){return Te(S,"GET","/v2/recaptchaConfig",Le(S,b))})).apply(this,arguments)}function Rn(S){return void 0!==S&&void 0!==S.getResponse}function fr(S){return void 0!==S&&void 0!==S.enterprise}class Vr{constructor(b){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===b.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=b.recaptchaKey.split("/")[3],this.emailPasswordEnabled=b.recaptchaEnforcementState.some(C=>"EMAIL_PASSWORD_PROVIDER"===C.provider&&"OFF"!==C.enforcementState)}}function _s(S){return new Promise((b,C)=>{const k=document.createElement("script");k.setAttribute("src",S),k.onload=b,k.onerror=L=>{const U=Oe("internal-error");U.customData=L,C(U)},k.type="text/javascript",k.charset="UTF-8",function Zn(){var S,b;return null!==(b=null===(S=document.getElementsByTagName("head"))||void 0===S?void 0:S[0])&&void 0!==b?b:document}().appendChild(k)})}function Da(S){return`__${S}${Math.floor(1e6*Math.random())}`}class Rr{constructor(b){this.type="recaptcha-enterprise",this.auth=Er(b)}verify(b="verify",C=!1){var k=this;return(0,B.Z)(function*(){function U(){return U=(0,B.Z)(function*(xe){if(!C){if(null==xe.tenantId&&null!=xe._agentRecaptchaConfig)return xe._agentRecaptchaConfig.siteKey;if(null!=xe.tenantId&&void 0!==xe._tenantRecaptchaConfigs[xe.tenantId])return xe._tenantRecaptchaConfigs[xe.tenantId].siteKey}return new Promise(function(){var at=(0,B.Z)(function*(Et,Ut){vt(xe,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(jt=>{if(void 0!==jt.recaptchaKey){const Kr=new Vr(jt);return null==xe.tenantId?xe._agentRecaptchaConfig=Kr:xe._tenantRecaptchaConfigs[xe.tenantId]=Kr,Et(Kr.siteKey)}Ut(new Error("recaptcha Enterprise site key undefined"))}).catch(jt=>{Ut(jt)})});return function(Et,Ut){return at.apply(this,arguments)}}())}),U.apply(this,arguments)}function le(xe,at,Et){const Ut=window.grecaptcha;fr(Ut)?Ut.enterprise.ready(()=>{Ut.enterprise.execute(xe,{action:b}).then(jt=>{at(jt)}).catch(()=>{at("NO_RECAPTCHA")})}):Et(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((xe,at)=>{(function L(xe){return U.apply(this,arguments)})(k.auth).then(Et=>{if(!C&&fr(window.grecaptcha))le(Et,xe,at);else{if(typeof window>"u")return void at(new Error("RecaptchaVerifier is only supported in browser"));_s("https://www.google.com/recaptcha/enterprise.js?render="+Et).then(()=>{le(Et,xe,at)}).catch(Ut=>{at(Ut)})}}).catch(Et=>{at(Et)})})})()}}function Tc(S,b,C){return Ap.apply(this,arguments)}function Ap(){return(Ap=(0,B.Z)(function*(S,b,C,k=!1){const L=new Rr(S);let U;try{U=yield L.verify(C)}catch{U=yield L.verify(C,!0)}const le=Object.assign({},b);return Object.assign(le,k?{captchaResp:U}:{captchaResponse:U}),Object.assign(le,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(le,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),le})).apply(this,arguments)}class Np{constructor(b){this.auth=b,this.queue=[]}pushCallback(b,C){const k=U=>new Promise((le,xe)=>{try{le(b(U))}catch(at){xe(at)}});k.onAbort=C,this.queue.push(k);const L=this.queue.length-1;return()=>{this.queue[L]=()=>Promise.resolve()}}runMiddleware(b){var C=this;return(0,B.Z)(function*(){if(C.auth.currentUser===b)return;const k=[];try{for(const L of C.queue)yield L(b),L.onAbort&&k.push(L.onAbort)}catch(L){k.reverse();for(const U of k)try{U()}catch{}throw C.auth._errorFactory.create("login-blocked",{originalMessage:L?.message})}})()}}class Rp{constructor(b,C,k,L){this.app=b,this.heartbeatServiceProvider=C,this.appCheckServiceProvider=k,this.config=L,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Vl(this),this.idTokenSubscription=new Vl(this),this.beforeStateQueue=new Np(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$e,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=b.name,this.clientVersion=L.sdkClientVersion}_initializeWithPersistence(b,C){var k=this;return C&&(this._popupRedirectResolver=Dr(C)),this._initializationPromise=this.queue((0,B.Z)(function*(){var L,U;if(!k._deleted&&(k.persistenceManager=yield ie.create(k,b),!k._deleted)){if(null!==(L=k._popupRedirectResolver)&&void 0!==L&&L._shouldInitProactively)try{yield k._popupRedirectResolver._initialize(k)}catch{}yield k.initializeCurrentUser(C),k.lastNotifiedUid=(null===(U=k.currentUser)||void 0===U?void 0:U.uid)||null,!k._deleted&&(k._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var b=this;return(0,B.Z)(function*(){if(b._deleted)return;const C=yield b.assertedPersistence.getCurrentUser();if(b.currentUser||C){if(b.currentUser&&C&&b.currentUser.uid===C.uid)return b._currentUser._assign(C),void(yield b.currentUser.getIdToken());yield b._updateCurrentUser(C,!0)}})()}initializeCurrentUser(b){var C=this;return(0,B.Z)(function*(){var k;const L=yield C.assertedPersistence.getCurrentUser();let U=L,le=!1;if(b&&C.config.authDomain){yield C.getOrInitRedirectPersistenceManager();const xe=null===(k=C.redirectUser)||void 0===k?void 0:k._redirectEventId,at=U?._redirectEventId,Et=yield C.tryRedirectSignIn(b);(!xe||xe===at)&&Et?.user&&(U=Et.user,le=!0)}if(!U)return C.directlySetCurrentUser(null);if(!U._redirectEventId){if(le)try{yield C.beforeStateQueue.runMiddleware(U)}catch(xe){U=L,C._popupRedirectResolver._overrideRedirectResult(C,()=>Promise.reject(xe))}return U?C.reloadAndSetCurrentUserOrClear(U):C.directlySetCurrentUser(null)}return a(C._popupRedirectResolver,C,"argument-error"),yield C.getOrInitRedirectPersistenceManager(),C.redirectUser&&C.redirectUser._redirectEventId===U._redirectEventId?C.directlySetCurrentUser(U):C.reloadAndSetCurrentUserOrClear(U)})()}tryRedirectSignIn(b){var C=this;return(0,B.Z)(function*(){let k=null;try{k=yield C._popupRedirectResolver._completeRedirectFn(C,b,!0)}catch{yield C._setRedirectUser(null)}return k})()}reloadAndSetCurrentUserOrClear(b){var C=this;return(0,B.Z)(function*(){try{yield Ai(b)}catch(k){if("auth/network-request-failed"!==k?.code)return C.directlySetCurrentUser(null)}return C.directlySetCurrentUser(b)})()}useDeviceLanguage(){this.languageCode=function Or(){if(typeof navigator>"u")return null;const S=navigator;return S.languages&&S.languages[0]||S.language||null}()}_delete(){var b=this;return(0,B.Z)(function*(){b._deleted=!0})()}updateCurrentUser(b){var C=this;return(0,B.Z)(function*(){const k=b?(0,te.m9)(b):null;return k&&a(k.auth.config.apiKey===C.config.apiKey,C,"invalid-user-token"),C._updateCurrentUser(k&&k._clone(C))})()}_updateCurrentUser(b,C=!1){var k=this;return(0,B.Z)(function*(){if(!k._deleted)return b&&a(k.tenantId===b.tenantId,k,"tenant-id-mismatch"),C||(yield k.beforeStateQueue.runMiddleware(b)),k.queue((0,B.Z)(function*(){yield k.directlySetCurrentUser(b),k.notifyAuthListeners()}))})()}signOut(){var b=this;return(0,B.Z)(function*(){return yield b.beforeStateQueue.runMiddleware(null),(b.redirectPersistenceManager||b._popupRedirectResolver)&&(yield b._setRedirectUser(null)),b._updateCurrentUser(null,!0)})()}setPersistence(b){var C=this;return this.queue((0,B.Z)(function*(){yield C.assertedPersistence.setPersistence(Dr(b))}))}initializeRecaptchaConfig(){var b=this;return(0,B.Z)(function*(){const C=yield vt(b,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),k=new Vr(C);null==b.tenantId?b._agentRecaptchaConfig=k:b._tenantRecaptchaConfigs[b.tenantId]=k,k.emailPasswordEnabled&&new Rr(b).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(b){this._errorFactory=new te.LL("auth","Firebase",b())}onAuthStateChanged(b,C,k){return this.registerStateListener(this.authStateSubscription,b,C,k)}beforeAuthStateChanged(b,C){return this.beforeStateQueue.pushCallback(b,C)}onIdTokenChanged(b,C,k){return this.registerStateListener(this.idTokenSubscription,b,C,k)}toJSON(){var b;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(b=this._currentUser)||void 0===b?void 0:b.toJSON()}}_setRedirectUser(b,C){var k=this;return(0,B.Z)(function*(){const L=yield k.getOrInitRedirectPersistenceManager(C);return null===b?L.removeCurrentUser():L.setCurrentUser(b)})()}getOrInitRedirectPersistenceManager(b){var C=this;return(0,B.Z)(function*(){if(!C.redirectPersistenceManager){const k=b&&Dr(b)||C._popupRedirectResolver;a(k,C,"argument-error"),C.redirectPersistenceManager=yield ie.create(C,[Dr(k._redirectPersistence)],"redirectUser"),C.redirectUser=yield C.redirectPersistenceManager.getCurrentUser()}return C.redirectPersistenceManager})()}_redirectUserForId(b){var C=this;return(0,B.Z)(function*(){var k,L;return C._isInitialized&&(yield C.queue((0,B.Z)(function*(){}))),(null===(k=C._currentUser)||void 0===k?void 0:k._redirectEventId)===b?C._currentUser:(null===(L=C.redirectUser)||void 0===L?void 0:L._redirectEventId)===b?C.redirectUser:null})()}_persistUserIfCurrent(b){var C=this;return(0,B.Z)(function*(){if(b===C.currentUser)return C.queue((0,B.Z)(function*(){return C.directlySetCurrentUser(b)}))})()}_notifyListenersIfCurrent(b){b===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var b,C;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const k=null!==(C=null===(b=this.currentUser)||void 0===b?void 0:b.uid)&&void 0!==C?C:null;this.lastNotifiedUid!==k&&(this.lastNotifiedUid=k,this.authStateSubscription.next(this.currentUser))}registerStateListener(b,C,k,L){if(this._deleted)return()=>{};const U="function"==typeof C?C:C.next.bind(C),le=this._isInitialized?Promise.resolve():this._initializationPromise;return a(le,this,"internal-error"),le.then(()=>U(this.currentUser)),"function"==typeof C?b.addObserver(C,k,L):b.addObserver(C)}directlySetCurrentUser(b){var C=this;return(0,B.Z)(function*(){C.currentUser&&C.currentUser!==b&&C._currentUser._stopProactiveRefresh(),b&&C.isProactiveRefreshEnabled&&b._startProactiveRefresh(),C.currentUser=b,b?yield C.assertedPersistence.setCurrentUser(b):yield C.assertedPersistence.removeCurrentUser()})()}queue(b){return this.operations=this.operations.then(b,b),this.operations}get assertedPersistence(){return a(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(b){!b||this.frameworks.includes(b)||(this.frameworks.push(b),this.frameworks.sort(),this.clientVersion=ve(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var b=this;return(0,B.Z)(function*(){var C;const k={"X-Client-Version":b.clientVersion};b.app.options.appId&&(k["X-Firebase-gmpid"]=b.app.options.appId);const L=yield null===(C=b.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===C?void 0:C.getHeartbeatsHeader();L&&(k["X-Firebase-Client"]=L);const U=yield b._getAppCheckToken();return U&&(k["X-Firebase-AppCheck"]=U),k})()}_getAppCheckToken(){var b=this;return(0,B.Z)(function*(){var C;const k=yield null===(C=b.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===C?void 0:C.getToken();return k?.error&&function an(S,...b){Gt.logLevel<=Re.in.WARN&&Gt.warn(`Auth (${He.SDK_VERSION}): ${S}`,...b)}(`Error while retrieving App Check token: ${k.error}`),k?.token})()}}function Er(S){return(0,te.m9)(S)}class Vl{constructor(b){this.auth=b,this.observer=null,this.addObserver=(0,te.ne)(C=>this.observer=C)}get next(){return a(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function vs(S){const b=S.indexOf(":");return b<0?"":S.substr(0,b+1)}function yd(S){if(!S)return null;const b=Number(S);return isNaN(b)?null:b}class Ul{constructor(b,C){this.providerId=b,this.signInMethod=C}toJSON(){return Ft("not implemented")}_getIdTokenResponse(b){return Ft("not implemented")}_linkToIdToken(b,C){return Ft("not implemented")}_getReauthenticationResolver(b){return Ft("not implemented")}}function na(S,b){return Mh.apply(this,arguments)}function Mh(){return(Mh=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:resetPassword",Le(S,b))})).apply(this,arguments)}function HT(S,b){return F_.apply(this,arguments)}function F_(){return(F_=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:update",b)})).apply(this,arguments)}function GT(S,b){return Fp.apply(this,arguments)}function Fp(){return(Fp=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:update",Le(S,b))})).apply(this,arguments)}function Pp(S,b){return P_.apply(this,arguments)}function P_(){return(P_=(0,B.Z)(function*(S,b){return Fn(S,"POST","/v1/accounts:signInWithPassword",Le(S,b))})).apply(this,arguments)}function L_(S,b){return WT.apply(this,arguments)}function WT(){return(WT=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:sendOobCode",Le(S,b))})).apply(this,arguments)}function jT(S,b){return Aa.apply(this,arguments)}function Aa(){return(Aa=(0,B.Z)(function*(S,b){return L_(S,b)})).apply(this,arguments)}function x0(S,b){return $_.apply(this,arguments)}function $_(){return($_=(0,B.Z)(function*(S,b){return L_(S,b)})).apply(this,arguments)}function B_(S,b){return I0.apply(this,arguments)}function I0(){return(I0=(0,B.Z)(function*(S,b){return L_(S,b)})).apply(this,arguments)}function Na(S,b){return V_.apply(this,arguments)}function V_(){return(V_=(0,B.Z)(function*(S,b){return L_(S,b)})).apply(this,arguments)}function Ur(){return(Ur=(0,B.Z)(function*(S,b){return Fn(S,"POST","/v1/accounts:signInWithEmailLink",Le(S,b))})).apply(this,arguments)}function z_(){return(z_=(0,B.Z)(function*(S,b){return Fn(S,"POST","/v1/accounts:signInWithEmailLink",Le(S,b))})).apply(this,arguments)}class vd extends Ul{constructor(b,C,k,L=null){super("password",k),this._email=b,this._password=C,this._tenantId=L}static _fromEmailAndPassword(b,C){return new vd(b,C,"password")}static _fromEmailAndCode(b,C,k=null){return new vd(b,C,"emailLink",k)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(b){const C="string"==typeof b?JSON.parse(b):b;if(C?.email&&C?.password){if("password"===C.signInMethod)return this._fromEmailAndPassword(C.email,C.password);if("emailLink"===C.signInMethod)return this._fromEmailAndCode(C.email,C.password,C.tenantId)}return null}_getIdTokenResponse(b){var C=this;return(0,B.Z)(function*(){var k;switch(C.signInMethod){case"password":const L={returnSecureToken:!0,email:C._email,password:C._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(k=b._getRecaptchaConfig())&&void 0!==k&&k.emailPasswordEnabled){const U=yield Tc(b,L,"signInWithPassword");return Pp(b,U)}return Pp(b,L).catch(function(){var U=(0,B.Z)(function*(le){if("auth/missing-recaptcha-token"===le.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const xe=yield Tc(b,L,"signInWithPassword");return Pp(b,xe)}return Promise.reject(le)});return function(le){return U.apply(this,arguments)}}());case"emailLink":return function OR(S,b){return Ur.apply(this,arguments)}(b,{email:C._email,oobCode:C._password});default:Pe(b,"internal-error")}})()}_linkToIdToken(b,C){var k=this;return(0,B.Z)(function*(){switch(k.signInMethod){case"password":return HT(b,{idToken:C,returnSecureToken:!0,email:k._email,password:k._password});case"emailLink":return function U_(S,b){return z_.apply(this,arguments)}(b,{idToken:C,email:k._email,oobCode:k._password});default:Pe(b,"internal-error")}})()}_getReauthenticationResolver(b){return this._getIdTokenResponse(b)}}function no(S,b){return ko.apply(this,arguments)}function ko(){return(ko=(0,B.Z)(function*(S,b){return Fn(S,"POST","/v1/accounts:signInWithIdp",Le(S,b))})).apply(this,arguments)}class Ra extends Ul{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(b){const C=new Ra(b.providerId,b.signInMethod);return b.idToken||b.accessToken?(b.idToken&&(C.idToken=b.idToken),b.accessToken&&(C.accessToken=b.accessToken),b.nonce&&!b.pendingToken&&(C.nonce=b.nonce),b.pendingToken&&(C.pendingToken=b.pendingToken)):b.oauthToken&&b.oauthTokenSecret?(C.accessToken=b.oauthToken,C.secret=b.oauthTokenSecret):Pe("argument-error"),C}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(b){const C="string"==typeof b?JSON.parse(b):b,{providerId:k,signInMethod:L}=C,U=(0,je._T)(C,["providerId","signInMethod"]);if(!k||!L)return null;const le=new Ra(k,L);return le.idToken=U.idToken||void 0,le.accessToken=U.accessToken||void 0,le.secret=U.secret,le.nonce=U.nonce,le.pendingToken=U.pendingToken||null,le}_getIdTokenResponse(b){return no(b,this.buildRequest())}_linkToIdToken(b,C){const k=this.buildRequest();return k.idToken=C,no(b,k)}_getReauthenticationResolver(b){const C=this.buildRequest();return C.autoCreate=!1,no(b,C)}buildRequest(){const b={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)b.pendingToken=this.pendingToken;else{const C={};this.idToken&&(C.id_token=this.idToken),this.accessToken&&(C.access_token=this.accessToken),this.secret&&(C.oauth_token_secret=this.secret),C.providerId=this.providerId,this.nonce&&!this.pendingToken&&(C.nonce=this.nonce),b.postBody=(0,te.xO)(C)}return b}}function H_(S,b){return G_.apply(this,arguments)}function G_(){return(G_=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:sendVerificationCode",Le(S,b))})).apply(this,arguments)}function Lp(){return(Lp=(0,B.Z)(function*(S,b){return Fn(S,"POST","/v1/accounts:signInWithPhoneNumber",Le(S,b))})).apply(this,arguments)}function Ao(){return(Ao=(0,B.Z)(function*(S,b){const C=yield Fn(S,"POST","/v1/accounts:signInWithPhoneNumber",Le(S,b));if(C.temporaryProof)throw Ar(S,"account-exists-with-different-credential",C);return C})).apply(this,arguments)}const W_={USER_NOT_FOUND:"user-not-found"};function ro(){return(ro=(0,B.Z)(function*(S,b){return Fn(S,"POST","/v1/accounts:signInWithPhoneNumber",Le(S,Object.assign(Object.assign({},b),{operation:"REAUTH"})),W_)})).apply(this,arguments)}class zl extends Ul{constructor(b){super("phone","phone"),this.params=b}static _fromVerification(b,C){return new zl({verificationId:b,verificationCode:C})}static _fromTokenResponse(b,C){return new zl({phoneNumber:b,temporaryProof:C})}_getIdTokenResponse(b){return function S0(S,b){return Lp.apply(this,arguments)}(b,this._makeVerificationRequest())}_linkToIdToken(b,C){return function qT(S,b){return Ao.apply(this,arguments)}(b,Object.assign({idToken:C},this._makeVerificationRequest()))}_getReauthenticationResolver(b){return function ZT(S,b){return ro.apply(this,arguments)}(b,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:b,phoneNumber:C,verificationId:k,verificationCode:L}=this.params;return b&&C?{temporaryProof:b,phoneNumber:C}:{sessionInfo:k,code:L}}toJSON(){const b={providerId:this.providerId};return this.params.phoneNumber&&(b.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(b.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(b.verificationCode=this.params.verificationCode),this.params.verificationId&&(b.verificationId=this.params.verificationId),b}static fromJSON(b){"string"==typeof b&&(b=JSON.parse(b));const{verificationId:C,verificationCode:k,phoneNumber:L,temporaryProof:U}=b;return k||C||L||U?new zl({verificationId:C,verificationCode:k,phoneNumber:L,temporaryProof:U}):null}}class Fh{constructor(b){var C,k,L,U,le,xe;const at=(0,te.zd)((0,te.pd)(b)),Et=null!==(C=at.apiKey)&&void 0!==C?C:null,Ut=null!==(k=at.oobCode)&&void 0!==k?k:null,jt=function Oh(S){switch(S){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(L=at.mode)&&void 0!==L?L:null);a(Et&&Ut&&jt,"argument-error"),this.apiKey=Et,this.operation=jt,this.code=Ut,this.continueUrl=null!==(U=at.continueUrl)&&void 0!==U?U:null,this.languageCode=null!==(le=at.languageCode)&&void 0!==le?le:null,this.tenantId=null!==(xe=at.tenantId)&&void 0!==xe?xe:null}static parseLink(b){const C=function j_(S){const b=(0,te.zd)((0,te.pd)(S)).link,C=b?(0,te.zd)((0,te.pd)(b)).deep_link_id:null,k=(0,te.zd)((0,te.pd)(S)).deep_link_id;return(k?(0,te.zd)((0,te.pd)(k)).link:null)||k||C||b||S}(b);try{return new Fh(C)}catch{return null}}}let oi=(()=>{class S{constructor(){this.providerId=S.PROVIDER_ID}static credential(C,k){return vd._fromEmailAndPassword(C,k)}static credentialWithLink(C,k){const L=Fh.parseLink(k);return a(L,"argument-error"),vd._fromEmailAndCode(C,L.code,L.tenantId)}}return S.PROVIDER_ID="password",S.EMAIL_PASSWORD_SIGN_IN_METHOD="password",S.EMAIL_LINK_SIGN_IN_METHOD="emailLink",S})();class Hl{constructor(b){this.providerId=b,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(b){this.defaultLanguageCode=b}setCustomParameters(b){return this.customParameters=b,this}getCustomParameters(){return this.customParameters}}class ra extends Hl{constructor(){super(...arguments),this.scopes=[]}addScope(b){return this.scopes.includes(b)||this.scopes.push(b),this}getScopes(){return[...this.scopes]}}class Gl extends ra{static credentialFromJSON(b){const C="string"==typeof b?JSON.parse(b):b;return a("providerId"in C&&"signInMethod"in C,"argument-error"),Ra._fromParams(C)}credential(b){return this._credential(Object.assign(Object.assign({},b),{nonce:b.rawNonce}))}_credential(b){return a(b.idToken||b.accessToken,"argument-error"),Ra._fromParams(Object.assign(Object.assign({},b),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(b){return Gl.oauthCredentialFromTaggedObject(b)}static credentialFromError(b){return Gl.oauthCredentialFromTaggedObject(b.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{oauthIdToken:C,oauthAccessToken:k,oauthTokenSecret:L,pendingToken:U,nonce:le,providerId:xe}=b;if(!k&&!L&&!C&&!U||!xe)return null;try{return new Gl(xe)._credential({idToken:C,accessToken:k,nonce:le,pendingToken:U})}catch{return null}}}let so=(()=>{class S extends ra{constructor(){super("facebook.com")}static credential(C){return Ra._fromParams({providerId:S.PROVIDER_ID,signInMethod:S.FACEBOOK_SIGN_IN_METHOD,accessToken:C})}static credentialFromResult(C){return S.credentialFromTaggedObject(C)}static credentialFromError(C){return S.credentialFromTaggedObject(C.customData||{})}static credentialFromTaggedObject({_tokenResponse:C}){if(!C||!("oauthAccessToken"in C)||!C.oauthAccessToken)return null;try{return S.credential(C.oauthAccessToken)}catch{return null}}}return S.FACEBOOK_SIGN_IN_METHOD="facebook.com",S.PROVIDER_ID="facebook.com",S})(),E0=(()=>{class S extends ra{constructor(){super("google.com"),this.addScope("profile")}static credential(C,k){return Ra._fromParams({providerId:S.PROVIDER_ID,signInMethod:S.GOOGLE_SIGN_IN_METHOD,idToken:C,accessToken:k})}static credentialFromResult(C){return S.credentialFromTaggedObject(C)}static credentialFromError(C){return S.credentialFromTaggedObject(C.customData||{})}static credentialFromTaggedObject({_tokenResponse:C}){if(!C)return null;const{oauthIdToken:k,oauthAccessToken:L}=C;if(!k&&!L)return null;try{return S.credential(k,L)}catch{return null}}}return S.GOOGLE_SIGN_IN_METHOD="google.com",S.PROVIDER_ID="google.com",S})(),$p=(()=>{class S extends ra{constructor(){super("github.com")}static credential(C){return Ra._fromParams({providerId:S.PROVIDER_ID,signInMethod:S.GITHUB_SIGN_IN_METHOD,accessToken:C})}static credentialFromResult(C){return S.credentialFromTaggedObject(C)}static credentialFromError(C){return S.credentialFromTaggedObject(C.customData||{})}static credentialFromTaggedObject({_tokenResponse:C}){if(!C||!("oauthAccessToken"in C)||!C.oauthAccessToken)return null;try{return S.credential(C.oauthAccessToken)}catch{return null}}}return S.GITHUB_SIGN_IN_METHOD="github.com",S.PROVIDER_ID="github.com",S})();class qi extends Ul{constructor(b,C){super(b,b),this.pendingToken=C}_getIdTokenResponse(b){return no(b,this.buildRequest())}_linkToIdToken(b,C){const k=this.buildRequest();return k.idToken=C,no(b,k)}_getReauthenticationResolver(b){const C=this.buildRequest();return C.autoCreate=!1,no(b,C)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(b){const C="string"==typeof b?JSON.parse(b):b,{providerId:k,signInMethod:L,pendingToken:U}=C;return k&&L&&U&&k===L?new qi(k,U):null}static _create(b,C){return new qi(b,C)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Wl extends Hl{constructor(b){a(b.startsWith("saml."),"argument-error"),super(b)}static credentialFromResult(b){return Wl.samlCredentialFromTaggedObject(b)}static credentialFromError(b){return Wl.samlCredentialFromTaggedObject(b.customData||{})}static credentialFromJSON(b){const C=qi.fromJSON(b);return a(C,"argument-error"),C}static samlCredentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{pendingToken:C,providerId:k}=b;if(!C||!k)return null;try{return qi._create(k,C)}catch{return null}}}let k0=(()=>{class S extends ra{constructor(){super("twitter.com")}static credential(C,k){return Ra._fromParams({providerId:S.PROVIDER_ID,signInMethod:S.TWITTER_SIGN_IN_METHOD,oauthToken:C,oauthTokenSecret:k})}static credentialFromResult(C){return S.credentialFromTaggedObject(C)}static credentialFromError(C){return S.credentialFromTaggedObject(C.customData||{})}static credentialFromTaggedObject({_tokenResponse:C}){if(!C)return null;const{oauthAccessToken:k,oauthTokenSecret:L}=C;if(!k||!L)return null;try{return S.credential(k,L)}catch{return null}}}return S.TWITTER_SIGN_IN_METHOD="twitter.com",S.PROVIDER_ID="twitter.com",S})();function Ma(S,b){return wd.apply(this,arguments)}function wd(){return(wd=(0,B.Z)(function*(S,b){return Fn(S,"POST","/v1/accounts:signUp",Le(S,b))})).apply(this,arguments)}class bs{constructor(b){this.user=b.user,this.providerId=b.providerId,this._tokenResponse=b._tokenResponse,this.operationType=b.operationType}static _fromIdTokenResponse(b,C,k,L=!1){return(0,B.Z)(function*(){const U=yield eo._fromIdTokenResponse(b,k,L),le=Tn(k);return new bs({user:U,providerId:le,_tokenResponse:k,operationType:C})})()}static _forOperation(b,C,k){return(0,B.Z)(function*(){yield b._updateTokensIfNecessary(k,!0);const L=Tn(k);return new bs({user:b,providerId:L,_tokenResponse:k,operationType:C})})()}}function Tn(S){return S.providerId?S.providerId:"phoneNumber"in S?"phone":null}function No(){return(No=(0,B.Z)(function*(S){var b;const C=Er(S);if(yield C._initializationPromise,null!==(b=C.currentUser)&&void 0!==b&&b.isAnonymous)return new bs({user:C.currentUser,providerId:null,operationType:"signIn"});const k=yield Ma(C,{returnSecureToken:!0}),L=yield bs._fromIdTokenResponse(C,"signIn",k,!0);return yield C._updateCurrentUser(L.user),L})).apply(this,arguments)}class Ph extends te.ZR{constructor(b,C,k,L){var U;super(C.code,C.message),this.operationType=k,this.user=L,Object.setPrototypeOf(this,Ph.prototype),this.customData={appName:b.name,tenantId:null!==(U=b.tenantId)&&void 0!==U?U:void 0,_serverResponse:C.customData._serverResponse,operationType:k}}static _fromErrorAndOperation(b,C,k,L){return new Ph(b,C,k,L)}}function A0(S,b,C,k){return("reauthenticate"===b?C._getReauthenticationResolver(S):C._getIdTokenResponse(S)).catch(U=>{throw"auth/multi-factor-auth-required"===U.code?Ph._fromErrorAndOperation(S,U,b,k):U})}function N0(S){return new Set(S.map(({providerId:b})=>b).filter(b=>!!b))}function q_(){return(q_=(0,B.Z)(function*(S,b){const C=(0,te.m9)(S);yield Yn(!0,C,b);const{providerUserInfo:k}=yield lr(C.auth,{idToken:yield C.getIdToken(),deleteProvider:[b]}),L=N0(k||[]);return C.providerData=C.providerData.filter(U=>L.has(U.providerId)),L.has("phone")||(C.phoneNumber=null),yield C.auth._persistUserIfCurrent(C),C})).apply(this,arguments)}function Lh(S,b){return st.apply(this,arguments)}function st(){return(st=(0,B.Z)(function*(S,b,C=!1){const k=yield So(S,b._linkToIdToken(S.auth,yield S.getIdToken()),C);return bs._forOperation(S,"link",k)})).apply(this,arguments)}function Yn(S,b,C){return Z_.apply(this,arguments)}function Z_(){return(Z_=(0,B.Z)(function*(S,b,C){yield Ai(b);const L=!1===S?"provider-already-linked":"no-such-provider";a(N0(b.providerData).has(C)===S,b.auth,L)})).apply(this,arguments)}function Y_(S,b){return mi.apply(this,arguments)}function mi(){return(mi=(0,B.Z)(function*(S,b,C=!1){const{auth:k}=S,L="reauthenticate";try{const U=yield So(S,A0(k,L,b,S),C);a(U.idToken,k,"internal-error");const le=Br(U.idToken);a(le,k,"internal-error");const{sub:xe}=le;return a(S.uid===xe,k,"user-mismatch"),bs._forOperation(S,L,U)}catch(U){throw"auth/user-not-found"===U?.code&&Pe(k,"user-mismatch"),U}})).apply(this,arguments)}function Bp(S,b){return yu.apply(this,arguments)}function yu(){return(yu=(0,B.Z)(function*(S,b,C=!1){const k="signIn",L=yield A0(S,k,b),U=yield bs._fromIdTokenResponse(S,k,L);return C||(yield S._updateCurrentUser(U.user)),U})).apply(this,arguments)}function ia(S,b){return Cd.apply(this,arguments)}function Cd(){return(Cd=(0,B.Z)(function*(S,b){return Bp(Er(S),b)})).apply(this,arguments)}function K_(S,b){return Vp.apply(this,arguments)}function Vp(){return(Vp=(0,B.Z)(function*(S,b){const C=(0,te.m9)(S);return yield Yn(!1,C,b.providerId),Lh(C,b)})).apply(this,arguments)}function KT(S,b){return M0.apply(this,arguments)}function M0(){return(M0=(0,B.Z)(function*(S,b){return Y_((0,te.m9)(S),b)})).apply(this,arguments)}function O0(S,b){return as.apply(this,arguments)}function as(){return(as=(0,B.Z)(function*(S,b){return Fn(S,"POST","/v1/accounts:signInWithCustomToken",Le(S,b))})).apply(this,arguments)}function Up(){return(Up=(0,B.Z)(function*(S,b){const C=Er(S),k=yield O0(C,{token:b,returnSecureToken:!0}),L=yield bs._fromIdTokenResponse(C,"signIn",k);return yield C._updateCurrentUser(L.user),L})).apply(this,arguments)}class Ro{constructor(b,C){this.factorId=b,this.uid=C.mfaEnrollmentId,this.enrollmentTime=new Date(C.enrolledAt).toUTCString(),this.displayName=C.displayName}static _fromServerResponse(b,C){return"phoneInfo"in C?Oa._fromServerResponse(b,C):"totpInfo"in C?Q_._fromServerResponse(b,C):Pe(b,"internal-error")}}class Oa extends Ro{constructor(b){super("phone",b),this.phoneNumber=b.phoneInfo}static _fromServerResponse(b,C){return new Oa(C)}}class Q_ extends Ro{constructor(b){super("totp",b)}static _fromServerResponse(b,C){return new Q_(C)}}function xd(S,b,C){var k;a((null===(k=C.url)||void 0===k?void 0:k.length)>0,S,"invalid-continue-uri"),a(typeof C.dynamicLinkDomain>"u"||C.dynamicLinkDomain.length>0,S,"invalid-dynamic-link-domain"),b.continueUrl=C.url,b.dynamicLinkDomain=C.dynamicLinkDomain,b.canHandleCodeInApp=C.handleCodeInApp,C.iOS&&(a(C.iOS.bundleId.length>0,S,"missing-ios-bundle-id"),b.iOSBundleId=C.iOS.bundleId),C.android&&(a(C.android.packageName.length>0,S,"missing-android-pkg-name"),b.androidInstallApp=C.android.installApp,b.androidMinimumVersionCode=C.android.minimumVersion,b.androidPackageName=C.android.packageName)}function X_(){return X_=(0,B.Z)(function*(S,b,C){var k;const L=Er(S),U={requestType:"PASSWORD_RESET",email:b,clientType:"CLIENT_TYPE_WEB"};if(null!==(k=L._getRecaptchaConfig())&&void 0!==k&&k.emailPasswordEnabled){const le=yield Tc(L,U,"getOobCode",!0);C&&xd(L,le,C),yield x0(L,le)}else C&&xd(L,U,C),yield x0(L,U).catch(function(){var le=(0,B.Z)(function*(xe){if("auth/missing-recaptcha-token"!==xe.code)return Promise.reject(xe);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const at=yield Tc(L,U,"getOobCode",!0);C&&xd(L,at,C),yield x0(L,at)}});return function(xe){return le.apply(this,arguments)}}())}),X_.apply(this,arguments)}function $h(){return($h=(0,B.Z)(function*(S,b,C){yield na((0,te.m9)(S),{oobCode:b,newPassword:C})})).apply(this,arguments)}function Bh(){return(Bh=(0,B.Z)(function*(S,b){yield GT((0,te.m9)(S),{oobCode:b})})).apply(this,arguments)}function F0(S,b){return zp.apply(this,arguments)}function zp(){return(zp=(0,B.Z)(function*(S,b){const C=(0,te.m9)(S),k=yield na(C,{oobCode:b}),L=k.requestType;switch(a(L,C,"internal-error"),L){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":a(k.newEmail,C,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":a(k.mfaInfo,C,"internal-error");default:a(k.email,C,"internal-error")}let U=null;return k.mfaInfo&&(U=Ro._fromServerResponse(Er(C),k.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===k.requestType?k.newEmail:k.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===k.requestType?k.email:k.newEmail)||null,multiFactorInfo:U},operation:L}})).apply(this,arguments)}function ty(){return(ty=(0,B.Z)(function*(S,b){const{data:C}=yield F0((0,te.m9)(S),b);return C.email})).apply(this,arguments)}function Hp(){return Hp=(0,B.Z)(function*(S,b,C){var k;const L=Er(S),U={returnSecureToken:!0,email:b,password:C,clientType:"CLIENT_TYPE_WEB"};let le;if(null!==(k=L._getRecaptchaConfig())&&void 0!==k&&k.emailPasswordEnabled){const Et=yield Tc(L,U,"signUpPassword");le=Ma(L,Et)}else le=Ma(L,U).catch(function(){var Et=(0,B.Z)(function*(Ut){if("auth/missing-recaptcha-token"===Ut.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const jt=yield Tc(L,U,"signUpPassword");return Ma(L,jt)}return Promise.reject(Ut)});return function(Ut){return Et.apply(this,arguments)}}());const xe=yield le.catch(Et=>Promise.reject(Et)),at=yield bs._fromIdTokenResponse(L,"signIn",xe);return yield L._updateCurrentUser(at.user),at}),Hp.apply(this,arguments)}function $0(){return $0=(0,B.Z)(function*(S,b,C){var k;const L=Er(S),U={requestType:"EMAIL_SIGNIN",email:b,clientType:"CLIENT_TYPE_WEB"};function le(xe,at){a(at.handleCodeInApp,L,"argument-error"),at&&xd(L,xe,at)}if(null!==(k=L._getRecaptchaConfig())&&void 0!==k&&k.emailPasswordEnabled){const xe=yield Tc(L,U,"getOobCode",!0);le(xe,C),yield B_(L,xe)}else le(U,C),yield B_(L,U).catch(function(){var xe=(0,B.Z)(function*(at){if("auth/missing-recaptcha-token"!==at.code)return Promise.reject(at);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const Et=yield Tc(L,U,"getOobCode",!0);le(Et,C),yield B_(L,Et)}});return function(at){return xe.apply(this,arguments)}}())}),$0.apply(this,arguments)}function jl(){return(jl=(0,B.Z)(function*(S,b,C){const k=(0,te.m9)(S),L=oi.credentialWithLink(b,C||bn());return a(L._tenantId===(k.tenantId||null),k,"tenant-id-mismatch"),ia(k,L)})).apply(this,arguments)}function ai(S,b){return ry.apply(this,arguments)}function ry(){return(ry=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:createAuthUri",Le(S,b))})).apply(this,arguments)}function iy(){return(iy=(0,B.Z)(function*(S,b){const k={identifier:b,continueUri:Gn()?bn():"http://localhost"},{signinMethods:L}=yield ai((0,te.m9)(S),k);return L||[]})).apply(this,arguments)}function sy(){return(sy=(0,B.Z)(function*(S,b){const C=(0,te.m9)(S),L={requestType:"VERIFY_EMAIL",idToken:yield S.getIdToken()};b&&xd(C.auth,L,b);const{email:U}=yield jT(C.auth,L);U!==S.email&&(yield S.reload())})).apply(this,arguments)}function Vh(){return(Vh=(0,B.Z)(function*(S,b,C){const k=(0,te.m9)(S),U={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield S.getIdToken(),newEmail:b};C&&xd(k.auth,U,C);const{email:le}=yield Na(k.auth,U);le!==S.email&&(yield S.reload())})).apply(this,arguments)}function oy(S,b){return vu.apply(this,arguments)}function vu(){return(vu=(0,B.Z)(function*(S,b){return Te(S,"POST","/v1/accounts:update",b)})).apply(this,arguments)}function Gp(){return(Gp=(0,B.Z)(function*(S,{displayName:b,photoURL:C}){if(void 0===b&&void 0===C)return;const k=(0,te.m9)(S),U={idToken:yield k.getIdToken(),displayName:b,photoUrl:C,returnSecureToken:!0},le=yield So(k,oy(k.auth,U));k.displayName=le.displayName||null,k.photoURL=le.photoUrl||null;const xe=k.providerData.find(({providerId:at})=>"password"===at);xe&&(xe.displayName=k.displayName,xe.photoURL=k.photoURL),yield k._updateTokensIfNecessary(le)})).apply(this,arguments)}function Uh(S,b,C){return B0.apply(this,arguments)}function B0(){return(B0=(0,B.Z)(function*(S,b,C){const{auth:k}=S,U={idToken:yield S.getIdToken(),returnSecureToken:!0};b&&(U.email=b),C&&(U.password=C);const le=yield So(S,HT(k,U));yield S._updateTokensIfNecessary(le,!0)})).apply(this,arguments)}class Fa{constructor(b,C,k={}){this.isNewUser=b,this.providerId=C,this.profile=k}}class cy extends Fa{constructor(b,C,k,L){super(b,C,k),this.username=L}}class $R extends Fa{constructor(b,C){super(b,"facebook.com",C)}}class eS extends cy{constructor(b,C){super(b,"github.com",C,"string"==typeof C?.login?C?.login:null)}}class tS extends Fa{constructor(b,C){super(b,"google.com",C)}}class rU extends cy{constructor(b,C,k){super(b,"twitter.com",C,k)}}function uy(S){const{user:b,_tokenResponse:C}=S;return b.isAnonymous&&!C?{providerId:null,isNewUser:!1,profile:null}:function V0(S){var b,C;if(!S)return null;const{providerId:k}=S,L=S.rawUserInfo?JSON.parse(S.rawUserInfo):{},U=S.isNewUser||"identitytoolkit#SignupNewUserResponse"===S.kind;if(!k&&S?.idToken){const le=null===(C=null===(b=Br(S.idToken))||void 0===b?void 0:b.firebase)||void 0===C?void 0:C.sign_in_provider;if(le)return new Fa(U,"anonymous"!==le&&"custom"!==le?le:null)}if(!k)return null;switch(k){case"facebook.com":return new $R(U,L);case"github.com":return new eS(U,L);case"google.com":return new tS(U,L);case"twitter.com":return new rU(U,L,S.screenName||null);case"custom":case"anonymous":return new Fa(U,null);default:return new Fa(U,k,L)}}(C)}class Id{constructor(b,C,k){this.type=b,this.credential=C,this.auth=k}static _fromIdtoken(b,C){return new Id("enroll",b,C)}static _fromMfaPendingCredential(b){return new Id("signin",b)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(b){var C,k;if(b?.multiFactorSession){if(null!==(C=b.multiFactorSession)&&void 0!==C&&C.pendingCredential)return Id._fromMfaPendingCredential(b.multiFactorSession.pendingCredential);if(null!==(k=b.multiFactorSession)&&void 0!==k&&k.idToken)return Id._fromIdtoken(b.multiFactorSession.idToken)}return null}}class qp{constructor(b,C,k){this.session=b,this.hints=C,this.signInResolver=k}static _fromError(b,C){const k=Er(b),L=C.customData._serverResponse,U=(L.mfaInfo||[]).map(xe=>Ro._fromServerResponse(k,xe));a(L.mfaPendingCredential,k,"internal-error");const le=Id._fromMfaPendingCredential(L.mfaPendingCredential);return new qp(le,U,function(){var xe=(0,B.Z)(function*(at){const Et=yield at._process(k,le);delete L.mfaInfo,delete L.mfaPendingCredential;const Ut=Object.assign(Object.assign({},L),{idToken:Et.idToken,refreshToken:Et.refreshToken});switch(C.operationType){case"signIn":const jt=yield bs._fromIdTokenResponse(k,C.operationType,Ut);return yield k._updateCurrentUser(jt.user),jt;case"reauthenticate":return a(C.user,k,"internal-error"),bs._forOperation(C.user,C.operationType,Ut);default:Pe(k,"internal-error")}});return function(at){return xe.apply(this,arguments)}}())}resolveSignIn(b){var C=this;return(0,B.Z)(function*(){return C.signInResolver(b)})()}}function zR(S,b){return Te(S,"POST","/v2/accounts/mfaEnrollment:start",Le(S,b))}class Yp{constructor(b){this.user=b,this.enrolledFactors=[],b._onReload(C=>{C.mfaInfo&&(this.enrolledFactors=C.mfaInfo.map(k=>Ro._fromServerResponse(b.auth,k)))})}static _fromUser(b){return new Yp(b)}getSession(){var b=this;return(0,B.Z)(function*(){return Id._fromIdtoken(yield b.user.getIdToken(),b.user.auth)})()}enroll(b,C){var k=this;return(0,B.Z)(function*(){const L=b,U=yield k.getSession(),le=yield So(k.user,L._process(k.user.auth,U,C));return yield k.user._updateTokensIfNecessary(le),k.user.reload()})()}unenroll(b){var C=this;return(0,B.Z)(function*(){const k="string"==typeof b?b:b.uid,L=yield C.user.getIdToken();try{const U=yield So(C.user,function z0(S,b){return Te(S,"POST","/v2/accounts/mfaEnrollment:withdraw",Le(S,b))}(C.user.auth,{idToken:L,mfaEnrollmentId:k}));C.enrolledFactors=C.enrolledFactors.filter(({uid:le})=>le!==k),yield C.user._updateTokensIfNecessary(U),yield C.user.reload()}catch(U){throw U}})()}}const Hh=new WeakMap,fy="__sak";class py{constructor(b,C){this.storageRetriever=b,this.type=C}_isAvailable(){try{return this.storage?(this.storage.setItem(fy,"1"),this.storage.removeItem(fy),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(b,C){return this.storage.setItem(b,JSON.stringify(C)),Promise.resolve()}_get(b){const C=this.storage.getItem(b);return Promise.resolve(C?JSON.parse(C):null)}_remove(b){return this.storage.removeItem(b),Promise.resolve()}get storage(){return this.storageRetriever()}}const bu=(()=>{class S extends py{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(C,k)=>this.onStorageEvent(C,k),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Kp(){const S=(0,te.z$)();return Se(S)||Zt(S)}()&&function Bl(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Nn(),this._shouldAllowMigration=!0}forAllChangedKeys(C){for(const k of Object.keys(this.listeners)){const L=this.storage.getItem(k),U=this.localCache[k];L!==U&&C(k,U,L)}}onStorageEvent(C,k=!1){if(!C.key)return void this.forAllChangedKeys((xe,at,Et)=>{this.notifyListeners(xe,Et)});const L=C.key;if(k?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const xe=this.storage.getItem(L);if(C.newValue!==xe)null!==C.newValue?this.storage.setItem(L,C.newValue):this.storage.removeItem(L);else if(this.localCache[L]===C.newValue&&!k)return}const U=()=>{const xe=this.storage.getItem(L);!k&&this.localCache[L]===xe||this.notifyListeners(L,xe)},le=this.storage.getItem(L);!function to(){return(0,te.w1)()&&10===document.documentMode}()||le===C.newValue||C.newValue===C.oldValue?U():setTimeout(U,10)}notifyListeners(C,k){this.localCache[C]=k;const L=this.listeners[C];if(L)for(const U of Array.from(L))U(k&&JSON.parse(k))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((C,k,L)=>{this.onStorageEvent(new StorageEvent("storage",{key:C,oldValue:k,newValue:L}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(C,k){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[C]||(this.listeners[C]=new Set,this.localCache[C]=this.storage.getItem(C)),this.listeners[C].add(k)}_removeListener(C,k){this.listeners[C]&&(this.listeners[C].delete(k),0===this.listeners[C].size&&delete this.listeners[C]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(C,k){var L=()=>super._set,U=this;return(0,B.Z)(function*(){yield L().call(U,C,k),U.localCache[C]=JSON.stringify(k)})()}_get(C){var k=()=>super._get,L=this;return(0,B.Z)(function*(){const U=yield k().call(L,C);return L.localCache[C]=JSON.stringify(U),U})()}_remove(C){var k=()=>super._remove,L=this;return(0,B.Z)(function*(){yield k().call(L,C),delete L.localCache[C]})()}}return S.type="LOCAL",S})(),Sc=(()=>{class S extends py{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(C,k){}_removeListener(C,k){}}return S.type="SESSION",S})();let W0=(()=>{class S{constructor(C){this.eventTarget=C,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(C){const k=this.receivers.find(U=>U.isListeningto(C));if(k)return k;const L=new S(C);return this.receivers.push(L),L}isListeningto(C){return this.eventTarget===C}handleEvent(C){var k=this;return(0,B.Z)(function*(){const L=C,{eventId:U,eventType:le,data:xe}=L.data,at=k.handlersMap[le];if(!at?.size)return;L.ports[0].postMessage({status:"ack",eventId:U,eventType:le});const Et=Array.from(at).map(function(){var jt=(0,B.Z)(function*(Kr){return Kr(L.origin,xe)});return function(Kr){return jt.apply(this,arguments)}}()),Ut=yield function G0(S){return Promise.all(S.map(function(){var b=(0,B.Z)(function*(C){try{return{fulfilled:!0,value:yield C}}catch(k){return{fulfilled:!1,reason:k}}});return function(C){return b.apply(this,arguments)}}()))}(Et);L.ports[0].postMessage({status:"done",eventId:U,eventType:le,response:Ut})})()}_subscribe(C,k){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[C]||(this.handlersMap[C]=new Set),this.handlersMap[C].add(k)}_unsubscribe(C,k){this.handlersMap[C]&&k&&this.handlersMap[C].delete(k),(!k||0===this.handlersMap[C].size)&&delete this.handlersMap[C],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return S.receivers=[],S})();function ol(S="",b=10){let C="";for(let k=0;k<b;k++)C+=Math.floor(10*Math.random());return S+C}class Qp{constructor(b){this.target=b,this.handlers=new Set}removeMessageHandler(b){b.messageChannel&&(b.messageChannel.port1.removeEventListener("message",b.onMessage),b.messageChannel.port1.close()),this.handlers.delete(b)}_send(b,C,k=50){var L=this;return(0,B.Z)(function*(){const U=typeof MessageChannel<"u"?new MessageChannel:null;if(!U)throw new Error("connection_unavailable");let le,xe;return new Promise((at,Et)=>{const Ut=ol("",20);U.port1.start();const jt=setTimeout(()=>{Et(new Error("unsupported_event"))},k);xe={messageChannel:U,onMessage(Kr){const Oo=Kr;if(Oo.data.eventId===Ut)switch(Oo.data.status){case"ack":clearTimeout(jt),le=setTimeout(()=>{Et(new Error("timeout"))},3e3);break;case"done":clearTimeout(le),at(Oo.data.response);break;default:clearTimeout(jt),clearTimeout(le),Et(new Error("invalid_response"))}}},L.handlers.add(xe),U.port1.addEventListener("message",xe.onMessage),L.target.postMessage({eventType:b,eventId:Ut,data:C},[U.port2])}).finally(()=>{xe&&L.removeMessageHandler(xe)})})()}}function Yr(){return window}function Jp(){return typeof Yr().WorkerGlobalScope<"u"&&"function"==typeof Yr().importScripts}function Ed(){return(Ed=(0,B.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const kc="firebaseLocalStorageDb",Dd="firebaseLocalStorage",wu="fbase_key";class em{constructor(b){this.request=b}toPromise(){return new Promise((b,C)=>{this.request.addEventListener("success",()=>{b(this.request.result)}),this.request.addEventListener("error",()=>{C(this.request.error)})})}}function tm(S,b){return S.transaction([Dd],b?"readwrite":"readonly").objectStore(Dd)}function _y(){const S=indexedDB.open(kc,1);return new Promise((b,C)=>{S.addEventListener("error",()=>{C(S.error)}),S.addEventListener("upgradeneeded",()=>{const k=S.result;try{k.createObjectStore(Dd,{keyPath:wu})}catch(L){C(L)}}),S.addEventListener("success",(0,B.Z)(function*(){const k=S.result;k.objectStoreNames.contains(Dd)?b(k):(k.close(),yield function wr(){const S=indexedDB.deleteDatabase(kc);return new em(S).toPromise()}(),b(yield _y()))}))})}function HR(S,b,C){return Wh.apply(this,arguments)}function Wh(){return(Wh=(0,B.Z)(function*(S,b,C){const k=tm(S,!0).put({[wu]:b,value:C});return new em(k).toPromise()})).apply(this,arguments)}function q0(){return(q0=(0,B.Z)(function*(S,b){const C=tm(S,!1).get(b),k=yield new em(C).toPromise();return void 0===k?null:k.value})).apply(this,arguments)}function Z0(S,b){const C=tm(S,!0).delete(b);return new em(C).toPromise()}const qh=(()=>{class S{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var C=this;return(0,B.Z)(function*(){return C.db||(C.db=yield _y()),C.db})()}_withRetries(C){var k=this;return(0,B.Z)(function*(){let L=0;for(;;)try{const U=yield k._openDb();return yield C(U)}catch(U){if(L++>3)throw U;k.db&&(k.db.close(),k.db=void 0)}})()}initializeServiceWorkerMessaging(){var C=this;return(0,B.Z)(function*(){return Jp()?C.initializeReceiver():C.initializeSender()})()}initializeReceiver(){var C=this;return(0,B.Z)(function*(){C.receiver=W0._getInstance(function Dc(){return Jp()?self:null}()),C.receiver._subscribe("keyChanged",function(){var k=(0,B.Z)(function*(L,U){return{keyProcessed:(yield C._poll()).includes(U.key)}});return function(L,U){return k.apply(this,arguments)}}()),C.receiver._subscribe("ping",function(){var k=(0,B.Z)(function*(L,U){return["keyChanged"]});return function(L,U){return k.apply(this,arguments)}}())})()}initializeSender(){var C=this;return(0,B.Z)(function*(){var k,L;if(C.activeServiceWorker=yield function Sd(){return Ed.apply(this,arguments)}(),!C.activeServiceWorker)return;C.sender=new Qp(C.activeServiceWorker);const U=yield C.sender._send("ping",{},800);!U||(null===(k=U[0])||void 0===k?void 0:k.fulfilled)&&(null===(L=U[0])||void 0===L?void 0:L.value.includes("keyChanged"))&&(C.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(C){var k=this;return(0,B.Z)(function*(){if(k.sender&&k.activeServiceWorker&&function Ec(){var S;return(null===(S=navigator?.serviceWorker)||void 0===S?void 0:S.controller)||null}()===k.activeServiceWorker)try{yield k.sender._send("keyChanged",{key:C},k.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,B.Z)(function*(){try{if(!indexedDB)return!1;const C=yield _y();return yield HR(C,fy,"1"),yield Z0(C,fy),!0}catch{}return!1})()}_withPendingWrite(C){var k=this;return(0,B.Z)(function*(){k.pendingWrites++;try{yield C()}finally{k.pendingWrites--}})()}_set(C,k){var L=this;return(0,B.Z)(function*(){return L._withPendingWrite((0,B.Z)(function*(){return yield L._withRetries(U=>HR(U,C,k)),L.localCache[C]=k,L.notifyServiceWorker(C)}))})()}_get(C){var k=this;return(0,B.Z)(function*(){const L=yield k._withRetries(U=>function j0(S,b){return q0.apply(this,arguments)}(U,C));return k.localCache[C]=L,L})()}_remove(C){var k=this;return(0,B.Z)(function*(){return k._withPendingWrite((0,B.Z)(function*(){return yield k._withRetries(L=>Z0(L,C)),delete k.localCache[C],k.notifyServiceWorker(C)}))})()}_poll(){var C=this;return(0,B.Z)(function*(){const k=yield C._withRetries(le=>{const xe=tm(le,!1).getAll();return new em(xe).toPromise()});if(!k)return[];if(0!==C.pendingWrites)return[];const L=[],U=new Set;for(const{fbase_key:le,value:xe}of k)U.add(le),JSON.stringify(C.localCache[le])!==JSON.stringify(xe)&&(C.notifyListeners(le,xe),L.push(le));for(const le of Object.keys(C.localCache))C.localCache[le]&&!U.has(le)&&(C.notifyListeners(le,null),L.push(le));return L})()}notifyListeners(C,k){this.localCache[C]=k;const L=this.listeners[C];if(L)for(const U of Array.from(L))U(k)}startPolling(){var C=this;this.stopPolling(),this.pollTimer=setInterval((0,B.Z)(function*(){return C._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(C,k){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[C]||(this.listeners[C]=new Set,this._get(C)),this.listeners[C].add(k)}_removeListener(C,k){this.listeners[C]&&(this.listeners[C].delete(k),0===this.listeners[C].size&&delete this.listeners[C]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return S.type="LOCAL",S})();function Ni(S,b){return Te(S,"POST","/v2/accounts/mfaSignIn:start",Le(S,b))}const $s=1e12;class Ac{constructor(b){this.auth=b,this.counter=$s,this._widgets=new Map}render(b,C){const k=this.counter;return this._widgets.set(k,new by(b,this.auth.name,C||{})),this.counter++,k}reset(b){var C;const k=b||$s;null===(C=this._widgets.get(k))||void 0===C||C.delete(),this._widgets.delete(k)}getResponse(b){var C;return(null===(C=this._widgets.get(b||$s))||void 0===C?void 0:C.getResponse())||""}execute(b){var C=this;return(0,B.Z)(function*(){var k;return null===(k=C._widgets.get(b||$s))||void 0===k||k.execute(),""})()}}class by{constructor(b,C,k){this.params=k,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const L="string"==typeof b?document.getElementById(b):b;a(L,"argument-error",{appName:C}),this.container=L,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function wy(S){const b=[],C="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let k=0;k<S;k++)b.push(C.charAt(Math.floor(Math.random()*C.length)));return b.join("")}(50);const{callback:b,"expired-callback":C}=this.params;if(b)try{b(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,C)try{C()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Cu=Da("rcb"),Y0=new vr(3e4,6e4);class K0{constructor(){var b;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(b=Yr().grecaptcha)||void 0===b||!b.render)}load(b,C=""){return a(function WR(S){return S.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(S)}(C),b,"argument-error"),this.shouldResolveImmediately(C)&&Rn(Yr().grecaptcha)?Promise.resolve(Yr().grecaptcha):new Promise((k,L)=>{const U=Yr().setTimeout(()=>{L(Oe(b,"network-request-failed"))},Y0.get());Yr()[Cu]=()=>{Yr().clearTimeout(U),delete Yr()[Cu];const xe=Yr().grecaptcha;if(!xe||!Rn(xe))return void L(Oe(b,"internal-error"));const at=xe.render;xe.render=(Et,Ut)=>{const jt=at(Et,Ut);return this.counter++,jt},this.hostLanguage=C,k(xe)},_s(`https://www.google.com/recaptcha/api.js??${(0,te.xO)({onload:Cu,render:"explicit",hl:C})}`).catch(()=>{clearTimeout(U),L(Oe(b,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(b){var C;return!(null===(C=Yr().grecaptcha)||void 0===C||!C.render)&&(b===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class oS{load(b){return(0,B.Z)(function*(){return new Ac(b)})()}clearedOneInstance(){}}const nm="recaptcha",oo={theme:"light",type:"image"};class rm{constructor(b,C=Object.assign({},oo),k){this.parameters=C,this.type=nm,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Er(k),this.isInvisible="invisible"===this.parameters.size,a(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const L="string"==typeof b?document.getElementById(b):b;a(L,this.auth,"argument-error"),this.container=L,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new oS:new K0,this.validateStartingState()}verify(){var b=this;return(0,B.Z)(function*(){b.assertNotDestroyed();const C=yield b.render(),k=b.getAssertedRecaptcha();return k.getResponse(C)||new Promise(U=>{const le=xe=>{!xe||(b.tokenChangeListeners.delete(le),U(xe))};b.tokenChangeListeners.add(le),b.isInvisible&&k.execute(C)})})()}render(){try{this.assertNotDestroyed()}catch(b){return Promise.reject(b)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(b=>{throw this.renderPromise=null,b})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(b=>{this.container.removeChild(b)})}validateStartingState(){a(!this.parameters.sitekey,this.auth,"argument-error"),a(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),a(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(b){return C=>{if(this.tokenChangeListeners.forEach(k=>k(C)),"function"==typeof b)b(C);else if("string"==typeof b){const k=Yr()[b];"function"==typeof k&&k(C)}}}assertNotDestroyed(){a(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var b=this;return(0,B.Z)(function*(){if(yield b.init(),!b.widgetId){let C=b.container;if(!b.isInvisible){const k=document.createElement("div");C.appendChild(k),C=k}b.widgetId=b.getAssertedRecaptcha().render(C,b.parameters)}return b.widgetId})()}init(){var b=this;return(0,B.Z)(function*(){a(Gn()&&!Jp(),b.auth,"internal-error"),yield function Yh(){let S=null;return new Promise(b=>{"complete"!==document.readyState?(S=()=>b(),window.addEventListener("load",S)):b()}).catch(b=>{throw S&&window.removeEventListener("load",S),b})}(),b.recaptcha=yield b._recaptchaLoader.load(b.auth,b.auth.languageCode||void 0);const C=yield function Fe(S){return ut.apply(this,arguments)}(b.auth);a(C,b.auth,"internal-error"),b.parameters.sitekey=C})()}getAssertedRecaptcha(){return a(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Q0{constructor(b,C){this.verificationId=b,this.onConfirmation=C}confirm(b){const C=zl._fromVerification(this.verificationId,b);return this.onConfirmation(C)}}function Cy(){return(Cy=(0,B.Z)(function*(S,b,C){const k=Er(S),L=yield Iy(k,b,(0,te.m9)(C));return new Q0(L,U=>ia(k,U))})).apply(this,arguments)}function xy(){return(xy=(0,B.Z)(function*(S,b,C){const k=(0,te.m9)(S);yield Yn(!1,k,"phone");const L=yield Iy(k.auth,b,(0,te.m9)(C));return new Q0(L,U=>K_(k,U))})).apply(this,arguments)}function J0(){return(J0=(0,B.Z)(function*(S,b,C){const k=(0,te.m9)(S),L=yield Iy(k.auth,b,(0,te.m9)(C));return new Q0(L,U=>KT(k,U))})).apply(this,arguments)}function Iy(S,b,C){return kd.apply(this,arguments)}function kd(){return(kd=(0,B.Z)(function*(S,b,C){var k;const L=yield C.verify();try{let U;if(a("string"==typeof L,S,"argument-error"),a(C.type===nm,S,"argument-error"),U="string"==typeof b?{phoneNumber:b}:b,"session"in U){const le=U.session;if("phoneNumber"in U)return a("enroll"===le.type,S,"internal-error"),(yield zR(S,{idToken:le.credential,phoneEnrollmentInfo:{phoneNumber:U.phoneNumber,recaptchaToken:L}})).phoneSessionInfo.sessionInfo;{a("signin"===le.type,S,"internal-error");const xe=(null===(k=U.multiFactorHint)||void 0===k?void 0:k.uid)||U.multiFactorUid;return a(xe,S,"missing-multi-factor-info"),(yield Ni(S,{mfaPendingCredential:le.credential,mfaEnrollmentId:xe,phoneSignInInfo:{recaptchaToken:L}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:le}=yield H_(S,{phoneNumber:U.phoneNumber,recaptchaToken:L});return le}}finally{C._reset()}})).apply(this,arguments)}function ew(){return(ew=(0,B.Z)(function*(S,b){yield Lh((0,te.m9)(S),b)})).apply(this,arguments)}let Zl=(()=>{class S{constructor(C){this.providerId=S.PROVIDER_ID,this.auth=Er(C)}verifyPhoneNumber(C,k){return Iy(this.auth,C,(0,te.m9)(k))}static credential(C,k){return zl._fromVerification(C,k)}static credentialFromResult(C){return S.credentialFromTaggedObject(C)}static credentialFromError(C){return S.credentialFromTaggedObject(C.customData||{})}static credentialFromTaggedObject({_tokenResponse:C}){if(!C)return null;const{phoneNumber:k,temporaryProof:L}=C;return k&&L?zl._fromTokenResponse(k,L):null}}return S.PROVIDER_ID="phone",S.PHONE_SIGN_IN_METHOD="phone",S})();function La(S,b){return b?Dr(b):(a(S._popupRedirectResolver,S,"argument-error"),S._popupRedirectResolver)}class xu extends Ul{constructor(b){super("custom","custom"),this.params=b}_getIdTokenResponse(b){return no(b,this._buildIdpRequest())}_linkToIdToken(b,C){return no(b,this._buildIdpRequest(C))}_getReauthenticationResolver(b){return no(b,this._buildIdpRequest())}_buildIdpRequest(b){const C={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return b&&(C.idToken=b),C}}function jR(S){return Bp(S.auth,new xu(S),S.bypassAuthState)}function qR(S){const{auth:b,user:C}=S;return a(C,b,"internal-error"),Y_(C,new xu(S),S.bypassAuthState)}function ZR(S){return im.apply(this,arguments)}function im(){return(im=(0,B.Z)(function*(S){const{auth:b,user:C}=S;return a(C,b,"internal-error"),Lh(C,new xu(S),S.bypassAuthState)})).apply(this,arguments)}class Kh{constructor(b,C,k,L,U=!1){this.auth=b,this.resolver=k,this.user=L,this.bypassAuthState=U,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(C)?C:[C]}execute(){var b=this;return new Promise(function(){var C=(0,B.Z)(function*(k,L){b.pendingPromise={resolve:k,reject:L};try{b.eventManager=yield b.resolver._initialize(b.auth),yield b.onExecution(),b.eventManager.registerConsumer(b)}catch(U){b.reject(U)}});return function(k,L){return C.apply(this,arguments)}}())}onAuthEvent(b){var C=this;return(0,B.Z)(function*(){const{urlResponse:k,sessionId:L,postBody:U,tenantId:le,error:xe,type:at}=b;if(xe)return void C.reject(xe);const Et={auth:C.auth,requestUri:k,sessionId:L,tenantId:le||void 0,postBody:U||void 0,user:C.user,bypassAuthState:C.bypassAuthState};try{C.resolve(yield C.getIdpTask(at)(Et))}catch(Ut){C.reject(Ut)}})()}onError(b){this.reject(b)}getIdpTask(b){switch(b){case"signInViaPopup":case"signInViaRedirect":return jR;case"linkViaPopup":case"linkViaRedirect":return ZR;case"reauthViaPopup":case"reauthViaRedirect":return qR;default:Pe(this.auth,"internal-error")}}resolve(b){Wt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(b),this.unregisterAndCleanUp()}reject(b){Wt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(b),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Qh=new vr(2e3,1e4);function gi(){return(gi=(0,B.Z)(function*(S,b,C){const k=Er(S);he(S,b,Hl);const L=La(k,C);return new nw(k,"signInViaPopup",b,L).executeNotNull()})).apply(this,arguments)}function sm(){return(sm=(0,B.Z)(function*(S,b,C){const k=(0,te.m9)(S);he(k.auth,b,Hl);const L=La(k.auth,C);return new nw(k.auth,"reauthViaPopup",b,L,k).executeNotNull()})).apply(this,arguments)}function Ad(){return(Ad=(0,B.Z)(function*(S,b,C){const k=(0,te.m9)(S);he(k.auth,b,Hl);const L=La(k.auth,C);return new nw(k.auth,"linkViaPopup",b,L,k).executeNotNull()})).apply(this,arguments)}let nw=(()=>{class S extends Kh{constructor(C,k,L,U,le){super(C,k,U,le),this.provider=L,this.authWindow=null,this.pollId=null,S.currentPopupAction&&S.currentPopupAction.cancel(),S.currentPopupAction=this}executeNotNull(){var C=this;return(0,B.Z)(function*(){const k=yield C.execute();return a(k,C.auth,"internal-error"),k})()}onExecution(){var C=this;return(0,B.Z)(function*(){Wt(1===C.filter.length,"Popup operations only handle one event");const k=ol();C.authWindow=yield C.resolver._openPopup(C.auth,C.provider,C.filter[0],k),C.authWindow.associatedEvent=k,C.resolver._originValidation(C.auth).catch(L=>{C.reject(L)}),C.resolver._isIframeWebStorageSupported(C.auth,L=>{L||C.reject(Oe(C.auth,"web-storage-unsupported"))}),C.pollUserCancellation()})()}get eventId(){var C;return(null===(C=this.authWindow)||void 0===C?void 0:C.associatedEvent)||null}cancel(){this.reject(Oe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,S.currentPopupAction=null}pollUserCancellation(){const C=()=>{var k,L;this.pollId=null!==(L=null===(k=this.authWindow)||void 0===k?void 0:k.window)&&void 0!==L&&L.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Oe(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(C,Qh.get())};C()}}return S.currentPopupAction=null,S})();const om=new Map;class rw extends Kh{constructor(b,C,k=!1){super(b,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],C,void 0,k),this.eventId=null}execute(){var b=()=>super.execute,C=this;return(0,B.Z)(function*(){let k=om.get(C.auth._key());if(!k){try{const U=(yield function Iu(S,b){return am.apply(this,arguments)}(C.resolver,C.auth))?yield b().call(C):null;k=()=>Promise.resolve(U)}catch(L){k=()=>Promise.reject(L)}om.set(C.auth._key(),k)}return C.bypassAuthState||om.set(C.auth._key(),()=>Promise.resolve(null)),k()})()}onAuthEvent(b){var C=()=>super.onAuthEvent,k=this;return(0,B.Z)(function*(){if("signInViaRedirect"===b.type)return C().call(k,b);if("unknown"!==b.type){if(b.eventId){const L=yield k.auth._redirectUserForId(b.eventId);if(L)return k.user=L,C().call(k,b);k.resolve(null)}}else k.resolve(null)})()}onExecution(){return(0,B.Z)(function*(){})()}cleanUp(){}}function am(){return(am=(0,B.Z)(function*(S,b){const C=Bs(b),k=Mo(S);if(!(yield k._isAvailable()))return!1;const L="true"===(yield k._get(C));return yield k._remove(C),L})).apply(this,arguments)}function Nc(S,b){return iw.apply(this,arguments)}function iw(){return(iw=(0,B.Z)(function*(S,b){return Mo(S)._set(Bs(b),"true")})).apply(this,arguments)}function Tu(S,b){om.set(S._key(),b)}function Mo(S){return Dr(S._redirectPersistence)}function Bs(S){return ae("pendingRedirect",S.config.apiKey,S.name)}function Yl(){return(Yl=(0,B.Z)(function*(S,b,C){const k=Er(S);he(S,b,Hl),yield k._initializationPromise;const L=La(k,C);return yield Nc(L,k),L._openRedirect(k,b,"signInViaRedirect")})).apply(this,arguments)}function lm(){return(lm=(0,B.Z)(function*(S,b,C){const k=(0,te.m9)(S);he(k.auth,b,Hl),yield k.auth._initializationPromise;const L=La(k.auth,C);yield Nc(L,k.auth);const U=yield Eu(k);return L._openRedirect(k.auth,b,"reauthViaRedirect",U)})).apply(this,arguments)}function cm(){return(cm=(0,B.Z)(function*(S,b,C){const k=(0,te.m9)(S);he(k.auth,b,Hl),yield k.auth._initializationPromise;const L=La(k.auth,C);yield Yn(!1,k,b.providerId),yield Nc(L,k.auth);const U=yield Eu(k);return L._openRedirect(k.auth,b,"linkViaRedirect",U)})).apply(this,arguments)}function Xh(){return(Xh=(0,B.Z)(function*(S,b){return yield Er(S)._initializationPromise,Sy(S,b,!1)})).apply(this,arguments)}function Sy(S,b){return Su.apply(this,arguments)}function Su(){return(Su=(0,B.Z)(function*(S,b,C=!1){const k=Er(S),L=La(k,b),le=yield new rw(k,L,C).execute();return le&&!C&&(delete le.user._redirectEventId,yield k._persistUserIfCurrent(le.user),yield k._setRedirectUser(null,b)),le})).apply(this,arguments)}function Eu(S){return um.apply(this,arguments)}function um(){return(um=(0,B.Z)(function*(S){const b=ol(`${S.uid}:::`);return S._redirectEventId=b,yield S.auth._setRedirectUser(S),yield S.auth._persistUserIfCurrent(S),b})).apply(this,arguments)}class JR{constructor(b){this.auth=b,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(b){this.consumers.add(b),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,b)&&(this.sendToConsumer(this.queuedRedirectEvent,b),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(b){this.consumers.delete(b)}onEvent(b){if(this.hasEventBeenHandled(b))return!1;let C=!1;return this.consumers.forEach(k=>{this.isEventForConsumer(b,k)&&(C=!0,this.sendToConsumer(b,k),this.saveEventToCache(b))}),this.hasHandledPotentialRedirect||!function dS(S){switch(S.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uS(S);default:return!1}}(b)||(this.hasHandledPotentialRedirect=!0,C||(this.queuedRedirectEvent=b,C=!0)),C}sendToConsumer(b,C){var k;if(b.error&&!uS(b)){const L=(null===(k=b.error.code)||void 0===k?void 0:k.split("auth/")[1])||"internal-error";C.onError(Oe(this.auth,L))}else C.onAuthEvent(b)}isEventForConsumer(b,C){const k=null===C.eventId||!!b.eventId&&b.eventId===C.eventId;return C.filter.includes(b.type)&&k}hasEventBeenHandled(b){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(hm(b))}saveEventToCache(b){this.cachedEventUids.add(hm(b)),this.lastProcessedEventTime=Date.now()}}function hm(S){return[S.type,S.eventId,S.sessionId,S.tenantId].filter(b=>b).join("-")}function uS({type:S,error:b}){return"unknown"===S&&"auth/no-auth-event"===b?.code}function ow(S){return Jh.apply(this,arguments)}function Jh(){return(Jh=(0,B.Z)(function*(S,b={}){return Te(S,"GET","/v1/projects",b)})).apply(this,arguments)}const eM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tM=/^https?/;function aw(){return(aw=(0,B.Z)(function*(S){if(S.config.emulator)return;const{authorizedDomains:b}=yield ow(S);for(const C of b)try{if(nM(C))return}catch{}Pe(S,"unauthorized-domain")})).apply(this,arguments)}function nM(S){const b=bn(),{protocol:C,hostname:k}=new URL(b);if(S.startsWith("chrome-extension://")){const le=new URL(S);return""===le.hostname&&""===k?"chrome-extension:"===C&&S.replace("chrome-extension://","")===b.replace("chrome-extension://",""):"chrome-extension:"===C&&le.hostname===k}if(!tM.test(C))return!1;if(eM.test(S))return k===S;const L=S.replace(/\./g,"\\.");return new RegExp("^(.+\\."+L+"|"+L+")$","i").test(k)}const rM=new vr(3e4,6e4);function iM(){const S=Yr().___jsl;if(S?.H)for(const b of Object.keys(S.H))if(S.H[b].r=S.H[b].r||[],S.H[b].L=S.H[b].L||[],S.H[b].r=[...S.H[b].L],S.CP)for(let C=0;C<S.CP.length;C++)S.CP[C]=null}let fm=null;function lw(S){return fm=fm||function sM(S){return new Promise((b,C)=>{var k,L,U;function le(){iM(),gapi.load("gapi.iframes",{callback:()=>{b(gapi.iframes.getContext())},ontimeout:()=>{iM(),C(Oe(S,"network-request-failed"))},timeout:rM.get()})}if(null!==(L=null===(k=Yr().gapi)||void 0===k?void 0:k.iframes)&&void 0!==L&&L.Iframe)b(gapi.iframes.getContext());else{if(null===(U=Yr().gapi)||void 0===U||!U.load){const xe=Da("iframefcb");return Yr()[xe]=()=>{gapi.load?le():C(Oe(S,"network-request-failed"))},_s(`https://apis.google.com/js/api.js?onload=${xe}`).catch(at=>C(at))}le()}}).catch(b=>{throw fm=null,b})}(S),fm}const Dy=new vr(5e3,15e3),dw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},al=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hS(S){const b=S.config;a(b.authDomain,S,"auth-domain-config-required");const C=b.emulator?sr(b,"emulator/auth/iframe"):`https://${S.config.authDomain}/__/auth/iframe`,k={apiKey:b.apiKey,appName:S.name,v:He.SDK_VERSION},L=al.get(S.config.apiHost);L&&(k.eid=L);const U=S._getFrameworks();return U.length&&(k.fw=U.join(",")),`${C}?${(0,te.xO)(k).slice(1)}`}function ky(){return ky=(0,B.Z)(function*(S){const b=yield lw(S),C=Yr().gapi;return a(C,S,"internal-error"),b.open({where:document.body,url:hS(S),messageHandlersFilter:C.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dw,dontclear:!0},k=>new Promise(function(){var L=(0,B.Z)(function*(U,le){yield k.restyle({setHideOnLeave:!1});const xe=Oe(S,"network-request-failed"),at=Yr().setTimeout(()=>{le(xe)},Dy.get());function Et(){Yr().clearTimeout(at),U(k)}k.ping(Et).then(Et,()=>{le(xe)})});return function(U,le){return L.apply(this,arguments)}}()))}),ky.apply(this,arguments)}const hw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ny{constructor(b){this.window=b,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const fw=encodeURIComponent("fac");function pm(S,b,C,k,L,U){return Zi.apply(this,arguments)}function Zi(){return(Zi=(0,B.Z)(function*(S,b,C,k,L,U){a(S.config.authDomain,S,"auth-domain-config-required"),a(S.config.apiKey,S,"invalid-api-key");const le={apiKey:S.config.apiKey,appName:S.name,authType:C,redirectUrl:k,v:He.SDK_VERSION,eventId:L};if(b instanceof Hl){b.setDefaultLanguage(S.languageCode),le.providerId=b.providerId||"",(0,te.xb)(b.getCustomParameters())||(le.customParameters=JSON.stringify(b.getCustomParameters()));for(const[Ut,jt]of Object.entries(U||{}))le[Ut]=jt}if(b instanceof ra){const Ut=b.getScopes().filter(jt=>""!==jt);Ut.length>0&&(le.scopes=Ut.join(","))}S.tenantId&&(le.tid=S.tenantId);const xe=le;for(const Ut of Object.keys(xe))void 0===xe[Ut]&&delete xe[Ut];const at=yield S._getAppCheckToken(),Et=at?`#${fw}=${encodeURIComponent(at)}`:"";return`${ef(S)}?${(0,te.xO)(xe).slice(1)}${Et}`})).apply(this,arguments)}function ef({config:S}){return S.emulator?sr(S,"emulator/auth/handler"):`https://${S.authDomain}/__/auth/handler`}const mm="webStorageSupport";class nf extends class Oy{constructor(b){this.factorId=b}_process(b,C,k){switch(C.type){case"enroll":return this._finalizeEnroll(b,C.credential,k);case"signin":return this._finalizeSignIn(b,C.credential);default:return Ft("unexpected MultiFactorSessionType")}}}{constructor(b){super("phone"),this.credential=b}static _fromCredential(b){return new nf(b)}_finalizeEnroll(b,C,k){return function ql(S,b){return Te(S,"POST","/v2/accounts/mfaEnrollment:finalize",Le(S,b))}(b,{idToken:C,displayName:k,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(b,C){return function yy(S,b){return Te(S,"POST","/v2/accounts/mfaSignIn:finalize",Le(S,b))}(b,{mfaPendingCredential:C,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let gm=(()=>{class S{constructor(){}static assertion(C){return nf._fromCredential(C)}}return S.FACTOR_ID="phone",S})();var rf="@firebase/auth";class Py{constructor(b){this.auth=b,this.internalListeners=new Map}getUid(){var b;return this.assertAuthConfigured(),(null===(b=this.auth.currentUser)||void 0===b?void 0:b.uid)||null}getToken(b){var C=this;return(0,B.Z)(function*(){return C.assertAuthConfigured(),yield C.auth._initializationPromise,C.auth.currentUser?{accessToken:yield C.auth.currentUser.getIdToken(b)}:null})()}addAuthTokenListener(b){if(this.assertAuthConfigured(),this.internalListeners.has(b))return;const C=this.auth.onIdTokenChanged(k=>{b(k?.stsTokenManager.accessToken||null)});this.internalListeners.set(b,C),this.updateProactiveRefresh()}removeAuthTokenListener(b){this.assertAuthConfigured();const C=this.internalListeners.get(b);!C||(this.internalListeners.delete(b),C(),this.updateProactiveRefresh())}assertAuthConfigured(){a(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ql(){return window}function Rd(){return(Rd=(0,B.Z)(function*(S,b,C){var k;const{BuildInfo:L}=Ql();Wt(b.sessionId,"AuthEvent did not contain a session ID");const U=yield bm(b.sessionId),le={};return Zt()?le.ibi=L.packageName:Rt()?le.apn=L.packageName:Pe(S,"operation-not-supported-in-this-environment"),L.displayName&&(le.appDisplayName=L.displayName),le.sessionId=U,pm(S,C,b.type,void 0,null!==(k=b.eventId)&&void 0!==k?k:void 0,le)})).apply(this,arguments)}function Ly(){return(Ly=(0,B.Z)(function*(S){const{BuildInfo:b}=Ql(),C={};Zt()?C.iosBundleId=b.packageName:Rt()?C.androidPackageName=b.packageName:Pe(S,"operation-not-supported-in-this-environment"),yield ow(S,C)})).apply(this,arguments)}function lf(){return(lf=(0,B.Z)(function*(S,b,C){const{cordova:k}=Ql();let L=()=>{};try{yield new Promise((U,le)=>{let xe=null;function at(){var jt;U();const Kr=null===(jt=k.plugins.browsertab)||void 0===jt?void 0:jt.close;"function"==typeof Kr&&Kr(),"function"==typeof C?.close&&C.close()}function Et(){xe||(xe=window.setTimeout(()=>{le(Oe(S,"redirect-cancelled-by-user"))},2e3))}function Ut(){"visible"===document?.visibilityState&&Et()}b.addPassiveListener(at),document.addEventListener("resume",Et,!1),Rt()&&document.addEventListener("visibilitychange",Ut,!1),L=()=>{b.removePassiveListener(at),document.removeEventListener("resume",Et,!1),document.removeEventListener("visibilitychange",Ut,!1),xe&&window.clearTimeout(xe)}})}finally{L()}})).apply(this,arguments)}function bm(S){return Md.apply(this,arguments)}function Md(){return(Md=(0,B.Z)(function*(S){const b=vw(S),C=yield crypto.subtle.digest("SHA-256",b);return Array.from(new Uint8Array(C)).map(L=>L.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function vw(S){if(Wt(/[0-9a-zA-Z]+/.test(S),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(S);const b=new ArrayBuffer(S.length),C=new Uint8Array(b);for(let k=0;k<S.length;k++)C[k]=S.charCodeAt(k);return C}(0,te.Pz)("authIdTokenMaxAge"),function bS(S){(0,He._registerComponent)(new tt.wA("auth",(b,{options:C})=>{const k=b.getProvider("app").getImmediate(),L=b.getProvider("heartbeat"),U=b.getProvider("app-check-internal"),{apiKey:le,authDomain:xe}=k.options;a(le&&!le.includes(":"),"invalid-api-key",{appName:k.name});const at={apiKey:le,authDomain:xe,clientPlatform:S,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ve(S)},Et=new Rp(k,L,U,at);return function ys(S,b){const C=b?.persistence||[],k=(Array.isArray(C)?C:[C]).map(Dr);b?.errorMap&&S._updateErrorMap(b.errorMap),S._initializeWithPersistence(k,b?.popupRedirectResolver)}(Et,C),Et},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((b,C,k)=>{b.getProvider("auth-internal").initialize()})),(0,He._registerComponent)(new tt.wA("auth-internal",b=>{const C=Er(b.getProvider("auth").getImmediate());return new Py(C)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,He.registerVersion)(rf,"0.23.2",function vS(S){switch(S){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(S)),(0,He.registerVersion)(rf,"0.23.2","esm2017")}("Browser");class Ba extends JR{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(b=>{this.resolveInialized=b})}addPassiveListener(b){this.passiveListeners.add(b)}removePassiveListener(b){this.passiveListeners.delete(b)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(b){return this.resolveInialized(),this.passiveListeners.forEach(C=>C(b)),super.onEvent(b)}initialized(){var b=this;return(0,B.Z)(function*(){yield b.initPromise})()}}function bw(S){return Du.apply(this,arguments)}function Du(){return(Du=(0,B.Z)(function*(S){const b=yield ll()._get(Va(S));return b&&(yield ll()._remove(Va(S))),b})).apply(this,arguments)}function ww(){const S=[],b="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let C=0;C<20;C++){const k=Math.floor(Math.random()*b.length);S.push(b.charAt(k))}return S.join("")}function ll(){return Dr(bu)}function Va(S){return ae("authEvent",S.config.apiKey,S.name)}function aa(S){if(!S?.includes("?"))return{};const[b,...C]=S.split("?");return(0,te.zd)(C.join("?"))}function uf(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Oe("no-auth-event")}}function ul(){var S;return(null===(S=self?.location)||void 0===S?void 0:S.protocol)||null}function Im(S=(0,te.z$)()){return!("file:"!==ul()&&"ionic:"!==ul()&&"capacitor:"!==ul()||!S.toLowerCase().match(/iphone|ipad|ipod|android/))}function Pd(){try{const S=self.localStorage,b=ol();if(S)return S.setItem(b,"1"),S.removeItem(b),!function Tm(S=(0,te.z$)()){return function Us(){return(0,te.w1)()&&11===document?.documentMode}()||function Fd(S=(0,te.z$)()){return/Edge\/\d+/.test(S)}(S)}()||(0,te.hl)()}catch{return zy()&&(0,te.hl)()}return!1}function zy(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Hy(){return(function Iw(){return"http:"===ul()||"https:"===ul()}()||(0,te.ru)()||Im())&&!function Uy(){return(0,te.b$)()||(0,te.UG)()}()&&Pd()&&!zy()}function Gy(){return Im()&&typeof document<"u"}function hf(){return(hf=(0,B.Z)(function*(){return!!Gy()&&new Promise(S=>{const b=setTimeout(()=>{S(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(b),S(!0)})})})).apply(this,arguments)}const Bi={LOCAL:"local",NONE:"none",SESSION:"session"},ff=a,Sw="persistence";function $d(S){return Bd.apply(this,arguments)}function Bd(){return(Bd=(0,B.Z)(function*(S){yield S._initializationPromise;const b=jy(),C=ae(Sw,S.config.apiKey,S.name);b&&b.setItem(C,S._getPersistence())})).apply(this,arguments)}function jy(){var S;try{return(null===(S=function Ld(){return typeof window<"u"?window:null}())||void 0===S?void 0:S.sessionStorage)||null}catch{return null}}const Vd=a;class Ua{constructor(){this.browserResolver=Dr(class My{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Sc,this._completeRedirectFn=Sy,this._overrideRedirectResult=Tu}_openPopup(b,C,k,L){var U=this;return(0,B.Z)(function*(){var le;Wt(null===(le=U.eventManagers[b._key()])||void 0===le?void 0:le.manager,"_initialize() not called before _openPopup()");const xe=yield pm(b,C,k,bn(),L);return function _S(S,b,C,k=500,L=600){const U=Math.max((window.screen.availHeight-L)/2,0).toString(),le=Math.max((window.screen.availWidth-k)/2,0).toString();let xe="";const at=Object.assign(Object.assign({},hw),{width:k.toString(),height:L.toString(),top:U,left:le}),Et=(0,te.z$)().toLowerCase();C&&(xe=wt(Et)?"_blank":C),Ge(Et)&&(b=b||"http://localhost",at.scrollbars="yes");const Ut=Object.entries(at).reduce((Kr,[Oo,Xy])=>`${Kr}${Oo}=${Xy},`,"");if(function er(S=(0,te.z$)()){var b;return Zt(S)&&!(null===(b=window.navigator)||void 0===b||!b.standalone)}(Et)&&"_self"!==xe)return function yS(S,b){const C=document.createElement("a");C.href=S,C.target=b;const k=document.createEvent("MouseEvent");k.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),C.dispatchEvent(k)}(b||"",xe),new Ny(null);const jt=window.open(b||"",xe,Ut);a(jt,S,"popup-blocked");try{jt.focus()}catch{}return new Ny(jt)}(b,xe,ol())})()}_openRedirect(b,C,k,L){var U=this;return(0,B.Z)(function*(){return yield U._originValidation(b),function Xp(S){Yr().location.href=S}(yield pm(b,C,k,bn(),L)),new Promise(()=>{})})()}_initialize(b){const C=b._key();if(this.eventManagers[C]){const{manager:L,promise:U}=this.eventManagers[C];return L?Promise.resolve(L):(Wt(U,"If manager is not set, promise should be"),U)}const k=this.initAndGetManager(b);return this.eventManagers[C]={promise:k},k.catch(()=>{delete this.eventManagers[C]}),k}initAndGetManager(b){var C=this;return(0,B.Z)(function*(){const k=yield function fS(S){return ky.apply(this,arguments)}(b),L=new JR(b);return k.register("authEvent",U=>(a(U?.authEvent,b,"invalid-auth-event"),{status:L.onEvent(U.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),C.eventManagers[b._key()]={manager:L},C.iframes[b._key()]=k,L})()}_isIframeWebStorageSupported(b,C){this.iframes[b._key()].send(mm,{type:mm},L=>{var U;const le=null===(U=L?.[0])||void 0===U?void 0:U[mm];void 0!==le&&C(!!le),Pe(b,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(b){const C=b._key();return this.originValidationPromises[C]||(this.originValidationPromises[C]=function Ey(S){return aw.apply(this,arguments)}(b)),this.originValidationPromises[C]}get _shouldInitProactively(){return Nn()||Se()||Zt()}}),this.cordovaResolver=Dr(class cf{constructor(){this._redirectPersistence=Sc,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Sy,this._overrideRedirectResult=Tu}_initialize(b){var C=this;return(0,B.Z)(function*(){const k=b._key();let L=C.eventManagers.get(k);return L||(L=new Ba(b),C.eventManagers.set(k,L),C.attachCallbackListeners(b,L)),L})()}_openPopup(b){Pe(b,"operation-not-supported-in-this-environment")}_openRedirect(b,C,k,L){var U=this;return(0,B.Z)(function*(){!function vm(S){var b,C,k,L,U,le,xe,at,Et,Ut;const jt=Ql();a("function"==typeof(null===(b=jt?.universalLinks)||void 0===b?void 0:b.subscribe),S,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),a(typeof(null===(C=jt?.BuildInfo)||void 0===C?void 0:C.packageName)<"u",S,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),a("function"==typeof(null===(U=null===(L=null===(k=jt?.cordova)||void 0===k?void 0:k.plugins)||void 0===L?void 0:L.browsertab)||void 0===U?void 0:U.openUrl),S,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),a("function"==typeof(null===(at=null===(xe=null===(le=jt?.cordova)||void 0===le?void 0:le.plugins)||void 0===xe?void 0:xe.browsertab)||void 0===at?void 0:at.isAvailable),S,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),a("function"==typeof(null===(Ut=null===(Et=jt?.cordova)||void 0===Et?void 0:Et.InAppBrowser)||void 0===Ut?void 0:Ut.open),S,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(b);const le=yield U._initialize(b);yield le.initialized(),le.resetRedirect(),function Ty(){om.clear()}(),yield U._originValidation(b);const xe=function Cm(S,b,C=null){return{type:b,eventId:C,urlResponse:null,sessionId:ww(),postBody:null,tenantId:S.tenantId,error:Oe(S,"no-auth-event")}}(b,k,L);yield function Od(S,b){return ll()._set(Va(S),b)}(b,xe);const at=yield function af(S,b,C){return Rd.apply(this,arguments)}(b,xe,C),Et=yield function ym(S){const{cordova:b}=Ql();return new Promise(C=>{b.plugins.browsertab.isAvailable(k=>{let L=null;k?b.plugins.browsertab.openUrl(S):L=b.InAppBrowser.open(S,function on(S=(0,te.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(S)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(S)}()?"_blank":"_system","location=yes"),C(L)})})}(at);return function CS(S,b,C){return lf.apply(this,arguments)}(b,le,Et)})()}_isIframeWebStorageSupported(b,C){throw new Error("Method not implemented.")}_originValidation(b){const C=b._key();return this.originValidationPromises[C]||(this.originValidationPromises[C]=function _m(S){return Ly.apply(this,arguments)}(b)),this.originValidationPromises[C]}attachCallbackListeners(b,C){const{universalLinks:k,handleOpenURL:L,BuildInfo:U}=Ql(),le=setTimeout((0,B.Z)(function*(){yield bw(b),C.onEvent(uf())}),500),xe=function(){var Ut=(0,B.Z)(function*(jt){clearTimeout(le);const Kr=yield bw(b);let Oo=null;Kr&&jt?.url&&(Oo=function $y(S,b){var C,k;const L=function Cw(S){const b=aa(S),C=b.link?decodeURIComponent(b.link):void 0,k=aa(C).link,L=b.deep_link_id?decodeURIComponent(b.deep_link_id):void 0;return aa(L).link||L||k||C||S}(b);if(L.includes("/__/auth/callback")){const U=aa(L),le=U.firebaseError?function By(S){try{return JSON.parse(S)}catch{return null}}(decodeURIComponent(U.firebaseError)):null,xe=null===(k=null===(C=le?.code)||void 0===C?void 0:C.split("auth/"))||void 0===k?void 0:k[1],at=xe?Oe(xe):null;return at?{type:S.type,eventId:S.eventId,tenantId:S.tenantId,error:at,urlResponse:null,sessionId:null,postBody:null}:{type:S.type,eventId:S.eventId,tenantId:S.tenantId,sessionId:S.sessionId,urlResponse:L,postBody:null}}return null}(Kr,jt.url)),C.onEvent(Oo||uf())});return function(Kr){return Ut.apply(this,arguments)}}();typeof k<"u"&&"function"==typeof k.subscribe&&k.subscribe(null,xe);const at=L,Et=`${U.packageName.toLowerCase()}://`;Ql().handleOpenURL=function(){var Ut=(0,B.Z)(function*(jt){if(jt.toLowerCase().startsWith(Et)&&xe({url:jt}),"function"==typeof at)try{at(jt)}catch(Kr){console.error(Kr)}});return function(jt){return Ut.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Sc,this._completeRedirectFn=Sy,this._overrideRedirectResult=Tu}_initialize(b){var C=this;return(0,B.Z)(function*(){return yield C.selectUnderlyingResolver(),C.assertedUnderlyingResolver._initialize(b)})()}_openPopup(b,C,k,L){var U=this;return(0,B.Z)(function*(){return yield U.selectUnderlyingResolver(),U.assertedUnderlyingResolver._openPopup(b,C,k,L)})()}_openRedirect(b,C,k,L){var U=this;return(0,B.Z)(function*(){return yield U.selectUnderlyingResolver(),U.assertedUnderlyingResolver._openRedirect(b,C,k,L)})()}_isIframeWebStorageSupported(b,C){this.assertedUnderlyingResolver._isIframeWebStorageSupported(b,C)}_originValidation(b){return this.assertedUnderlyingResolver._originValidation(b)}get _shouldInitProactively(){return Gy()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Vd(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var b=this;return(0,B.Z)(function*(){if(b.underlyingResolver)return;const C=yield function Tw(){return hf.apply(this,arguments)}();b.underlyingResolver=C?b.cordovaResolver:b.browserResolver})()}}function qy(S){return S.unwrap()}function kw(S){return Aw(S)}function Aw(S){const{_tokenResponse:b}=S instanceof te.ZR?S.customData:S;if(!b)return null;if(!(S instanceof te.ZR)&&"temporaryProof"in b&&"phoneNumber"in b)return Zl.credentialFromResult(S);const C=b.providerId;if(!C||"password"===C)return null;let k;switch(C){case"google.com":k=E0;break;case"facebook.com":k=so;break;case"github.com":k=$p;break;case"twitter.com":k=k0;break;default:const{oauthIdToken:L,oauthAccessToken:U,oauthTokenSecret:le,pendingToken:xe,nonce:at}=b;return U||le||L||xe?xe?C.startsWith("saml.")?qi._create(C,xe):Ra._fromParams({providerId:C,signInMethod:C,pendingToken:xe,idToken:L,accessToken:U}):new Gl(C).credential({idToken:L,accessToken:U,rawNonce:at}):null}return S instanceof te.ZR?k.credentialFromError(S):k.credentialFromResult(S)}function ao(S,b){return b.catch(C=>{throw C instanceof te.ZR&&function Au(S,b){var C;const k=null===(C=b.customData)||void 0===C?void 0:C._tokenResponse;if("auth/multi-factor-auth-required"===b?.code)b.resolver=new Zy(S,function rS(S,b){var C;const k=(0,te.m9)(S),L=b;return a(b.customData.operationType,k,"argument-error"),a(null===(C=L.customData._serverResponse)||void 0===C?void 0:C.mfaPendingCredential,k,"argument-error"),qp._fromError(k,L)}(S,b));else if(k){const L=Aw(b),U=b;L&&(U.credential=L,U.tenantId=k.tenantId||void 0,U.email=k.email||void 0,U.phoneNumber=k.phoneNumber||void 0)}}(S,C),C}).then(C=>{const L=C.user;return{operationType:C.operationType,credential:kw(C),additionalUserInfo:uy(C),user:Ri.getOrCreate(L)}})}function Xl(S,b){return pf.apply(this,arguments)}function pf(){return(pf=(0,B.Z)(function*(S,b){const C=yield b;return{verificationId:C.verificationId,confirm:k=>ao(S,C.confirm(k))}})).apply(this,arguments)}class Zy{constructor(b,C){this.resolver=C,this.auth=function Dw(S){return S.wrapped()}(b)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(b){return ao(qy(this.auth),this.resolver.resolveSignIn(b))}}class Ri{constructor(b){this._delegate=b,this.multiFactor=function hy(S){const b=(0,te.m9)(S);return Hh.has(b)||Hh.set(b,Yp._fromUser(b)),Hh.get(b)}(b)}static getOrCreate(b){return Ri.USER_MAP.has(b)||Ri.USER_MAP.set(b,new Ri(b)),Ri.USER_MAP.get(b)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(b){return this._delegate.getIdTokenResult(b)}getIdToken(b){return this._delegate.getIdToken(b)}linkAndRetrieveDataWithCredential(b){return this.linkWithCredential(b)}linkWithCredential(b){var C=this;return(0,B.Z)(function*(){return ao(C.auth,K_(C._delegate,b))})()}linkWithPhoneNumber(b,C){var k=this;return(0,B.Z)(function*(){return Xl(k.auth,function X0(S,b,C){return xy.apply(this,arguments)}(k._delegate,b,C))})()}linkWithPopup(b){var C=this;return(0,B.Z)(function*(){return ao(C.auth,function tw(S,b,C){return Ad.apply(this,arguments)}(C._delegate,b,Ua))})()}linkWithRedirect(b){var C=this;return(0,B.Z)(function*(){return yield $d(Er(C.auth)),function ei(S,b,C){return function QR(S,b,C){return cm.apply(this,arguments)}(S,b,C)}(C._delegate,b,Ua)})()}reauthenticateAndRetrieveDataWithCredential(b){return this.reauthenticateWithCredential(b)}reauthenticateWithCredential(b){var C=this;return(0,B.Z)(function*(){return ao(C.auth,KT(C._delegate,b))})()}reauthenticateWithPhoneNumber(b,C){return Xl(this.auth,function lS(S,b,C){return J0.apply(this,arguments)}(this._delegate,b,C))}reauthenticateWithPopup(b){return ao(this.auth,function cS(S,b,C){return sm.apply(this,arguments)}(this._delegate,b,Ua))}reauthenticateWithRedirect(b){var C=this;return(0,B.Z)(function*(){return yield $d(Er(C.auth)),function Sn(S,b,C){return function yi(S,b,C){return lm.apply(this,arguments)}(S,b,C)}(C._delegate,b,Ua)})()}sendEmailVerification(b){return function PR(S,b){return sy.apply(this,arguments)}(this._delegate,b)}unlink(b){var C=this;return(0,B.Z)(function*(){return yield function R0(S,b){return q_.apply(this,arguments)}(C._delegate,b),C})()}updateEmail(b){return function ly(S,b){return Uh((0,te.m9)(S),b,null)}(this._delegate,b)}updatePassword(b){return function oa(S,b){return Uh((0,te.m9)(S),null,b)}(this._delegate,b)}updatePhoneNumber(b){return function Pa(S,b){return ew.apply(this,arguments)}(this._delegate,b)}updateProfile(b){return function ay(S,b){return Gp.apply(this,arguments)}(this._delegate,b)}verifyBeforeUpdateEmail(b,C){return function LR(S,b,C){return Vh.apply(this,arguments)}(this._delegate,b,C)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Ri.USER_MAP=new WeakMap;const dl=a;let Nw=(()=>{class S{constructor(C,k){if(this.app=C,k.isInitialized())return this._delegate=k.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:L}=C.options;dl(L,"invalid-api-key",{appName:C.name}),dl(L,"invalid-api-key",{appName:C.name});const U=typeof window<"u"?Ua:void 0;this._delegate=k.initialize({options:{persistence:xS(L,C.name),popupRedirectResolver:U}}),this._delegate._updateErrorMap(Ae),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Ri.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(C){this._delegate.languageCode=C}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(C){this._delegate.tenantId=C}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(C,k){!function Mp(S,b,C){const k=Er(S);a(k._canInitEmulator,k,"emulator-config-failed"),a(/^https?:\/\//.test(b),k,"invalid-emulator-scheme");const L=!!C?.disableWarnings,U=vs(b),{host:le,port:xe}=function ka(S){const b=vs(S),C=/(\/\/)?([^?#/]+)/.exec(S.substr(b.length));if(!C)return{host:"",port:null};const k=C[2].split("@").pop()||"",L=/^(\[[^\]]+\])(:|$)/.exec(k);if(L){const U=L[1];return{host:U,port:yd(k.substr(U.length+1))}}{const[U,le]=k.split(":");return{host:U,port:yd(le)}}}(b);k.config.emulator={url:`${U}//${le}${null===xe?"":`:${xe}`}/`},k.settings.appVerificationDisabledForTesting=!0,k.emulatorConfig=Object.freeze({host:le,port:xe,protocol:U.replace(":",""),options:Object.freeze({disableWarnings:L})}),L||function Op(){function S(){const b=document.createElement("p"),C=b.style;b.innerText="Running in emulator mode. Do not use with production credentials.",C.position="fixed",C.width="100%",C.backgroundColor="#ffffff",C.border=".1em solid #000000",C.color="#b50000",C.bottom="0px",C.left="0px",C.margin="0px",C.zIndex="10000",C.textAlign="center",b.classList.add("firebase-emulator-warning"),document.body.appendChild(b)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",S):S())}()}(this._delegate,C,k)}applyActionCode(C){return function XT(S,b){return Bh.apply(this,arguments)}(this._delegate,C)}checkActionCode(C){return F0(this._delegate,C)}confirmPasswordReset(C,k){return function J_(S,b,C){return $h.apply(this,arguments)}(this._delegate,C,k)}createUserWithEmailAndPassword(C,k){var L=this;return(0,B.Z)(function*(){return ao(L._delegate,function P0(S,b,C){return Hp.apply(this,arguments)}(L._delegate,C,k))})()}fetchProvidersForEmail(C){return this.fetchSignInMethodsForEmail(C)}fetchSignInMethodsForEmail(C){return function FR(S,b){return iy.apply(this,arguments)}(this._delegate,C)}isSignInWithEmailLink(C){return function JT(S,b){return"EMAIL_SIGNIN"===Fh.parseLink(b)?.operation}(0,C)}getRedirectResult(){var C=this;return(0,B.Z)(function*(){dl(Hy(),C._delegate,"operation-not-supported-in-this-environment");const k=yield function XR(S,b){return Xh.apply(this,arguments)}(C._delegate,Ua);return k?ao(C._delegate,Promise.resolve(k)):{credential:null,user:null}})()}addFrameworkForLogging(C){!function Vy(S,b){Er(S)._logFramework(b)}(this._delegate,C)}onAuthStateChanged(C,k,L){const{next:U,error:le,complete:xe}=Rw(C,k,L);return this._delegate.onAuthStateChanged(U,le,xe)}onIdTokenChanged(C,k,L){const{next:U,error:le,complete:xe}=Rw(C,k,L);return this._delegate.onIdTokenChanged(U,le,xe)}sendSignInLinkToEmail(C,k){return function ny(S,b,C){return $0.apply(this,arguments)}(this._delegate,C,k)}sendPasswordResetEmail(C,k){return function QT(S,b,C){return X_.apply(this,arguments)}(this._delegate,C,k||void 0)}setPersistence(C){var k=this;return(0,B.Z)(function*(){let L;switch(function Wy(S,b){ff(Object.values(Bi).includes(b),S,"invalid-persistence-type"),(0,te.b$)()?ff(b!==Bi.SESSION,S,"unsupported-persistence-type"):(0,te.UG)()?ff(b===Bi.NONE,S,"unsupported-persistence-type"):zy()?ff(b===Bi.NONE||b===Bi.LOCAL&&(0,te.hl)(),S,"unsupported-persistence-type"):ff(b===Bi.NONE||Pd(),S,"unsupported-persistence-type")}(k._delegate,C),C){case Bi.SESSION:L=Sc;break;case Bi.LOCAL:L=(yield Dr(qh)._isAvailable())?qh:bu;break;case Bi.NONE:L=sl;break;default:return Pe("argument-error",{appName:k._delegate.name})}return k._delegate.setPersistence(L)})()}signInAndRetrieveDataWithCredential(C){return this.signInWithCredential(C)}signInAnonymously(){return ao(this._delegate,function YT(S){return No.apply(this,arguments)}(this._delegate))}signInWithCredential(C){return ao(this._delegate,ia(this._delegate,C))}signInWithCustomToken(C){return ao(this._delegate,function sa(S,b){return Up.apply(this,arguments)}(this._delegate,C))}signInWithEmailAndPassword(C,k){return ao(this._delegate,function L0(S,b,C){return ia((0,te.m9)(S),oi.credential(b,C))}(this._delegate,C,k))}signInWithEmailLink(C,k){return ao(this._delegate,function tr(S,b,C){return jl.apply(this,arguments)}(this._delegate,C,k))}signInWithPhoneNumber(C,k){return Xl(this._delegate,function aS(S,b,C){return Cy.apply(this,arguments)}(this._delegate,C,k))}signInWithPopup(C){var k=this;return(0,B.Z)(function*(){return dl(Hy(),k._delegate,"operation-not-supported-in-this-environment"),ao(k._delegate,function YR(S,b,C){return gi.apply(this,arguments)}(k._delegate,C,Ua))})()}signInWithRedirect(C){var k=this;return(0,B.Z)(function*(){return dl(Hy(),k._delegate,"operation-not-supported-in-this-environment"),yield $d(k._delegate),function _i(S,b,C){return function sw(S,b,C){return Yl.apply(this,arguments)}(S,b,C)}(k._delegate,C,Ua)})()}updateCurrentUser(C){return this._delegate.updateCurrentUser(C)}verifyPasswordResetCode(C){return function ey(S,b){return ty.apply(this,arguments)}(this._delegate,C)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return S.Persistence=Bi,S})();function Rw(S,b,C){let k=S;"function"!=typeof S&&({next:k,error:b,complete:C}=S);const L=k;return{next:le=>L(le&&Ri.getOrCreate(le)),error:b,complete:C}}function xS(S,b){const C=function Ew(S,b){const C=jy();if(!C)return[];const k=ae(Sw,S,b);switch(C.getItem(k)){case Bi.NONE:return[sl];case Bi.LOCAL:return[qh,Sc];case Bi.SESSION:return[Sc];default:return[]}}(S,b);if(typeof self<"u"&&!C.includes(qh)&&C.push(qh),typeof window<"u")for(const k of[bu,Sc])C.includes(k)||C.push(k);return C.includes(sl)||C.push(sl),C}class Yy{constructor(){this.providerId="phone",this._delegate=new Zl(qy(Ee.Z.auth()))}static credential(b,C){return Zl.credential(b,C)}verifyPhoneNumber(b,C){return this._delegate.verifyPhoneNumber(b,C)}unwrap(){return this._delegate}}Yy.PHONE_SIGN_IN_METHOD=Zl.PHONE_SIGN_IN_METHOD,Yy.PROVIDER_ID=Zl.PROVIDER_ID;const Ky=a;class IS{constructor(b,C,k=Ee.Z.app()){var L;Ky(null===(L=k.options)||void 0===L?void 0:L.apiKey,"invalid-api-key",{appName:k.name}),this._delegate=new rm(b,C,k.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Qy(S){S.INTERNAL.registerComponent(new tt.wA("auth-compat",b=>{const C=b.getProvider("app-compat").getImmediate(),k=b.getProvider("auth");return new Nw(C,k)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:oi,FacebookAuthProvider:so,GithubAuthProvider:$p,GoogleAuthProvider:E0,OAuthProvider:Gl,SAMLAuthProvider:Wl,PhoneAuthProvider:Yy,PhoneMultiFactorGenerator:gm,RecaptchaVerifier:IS,TwitterAuthProvider:k0,Auth:Nw,AuthCredential:Ul,Error:te.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),S.registerVersion("@firebase/auth-compat","0.4.2")}(Ee.Z)},5861:(kt,et,z)=>{"use strict";function B(te,He,je,Re,tt,Ne,ne){try{var K=te[Ne](ne),ee=K.value}catch(X){return void je(X)}K.done?He(ee):Promise.resolve(ee).then(Re,tt)}function Ee(te){return function(){var He=this,je=arguments;return new Promise(function(Re,tt){var Ne=te.apply(He,je);function ne(ee){B(Ne,Re,tt,ne,K,"next",ee)}function K(ee){B(Ne,Re,tt,ne,K,"throw",ee)}ne(void 0)})}}z.d(et,{Z:()=>Ee})},7582:(kt,et,z)=>{"use strict";function He(ke,qe){var Le={};for(var Te in ke)Object.prototype.hasOwnProperty.call(ke,Te)&&qe.indexOf(Te)<0&&(Le[Te]=ke[Te]);if(null!=ke&&"function"==typeof Object.getOwnPropertySymbols){var ft=0;for(Te=Object.getOwnPropertySymbols(ke);ft<Te.length;ft++)qe.indexOf(Te[ft])<0&&Object.prototype.propertyIsEnumerable.call(ke,Te[ft])&&(Le[Te[ft]]=ke[Te[ft]])}return Le}function X(ke,qe,Le,Te){return new(Le||(Le=Promise))(function(ct,Qt){function Fn(Fr){try{_n(Te.next(Fr))}catch(Ar){Qt(Ar)}}function kr(Fr){try{_n(Te.throw(Fr))}catch(Ar){Qt(Ar)}}function _n(Fr){Fr.done?ct(Fr.value):function ft(ct){return ct instanceof Le?ct:new Le(function(Qt){Qt(ct)})}(Fr.value).then(Fn,kr)}_n((Te=Te.apply(ke,qe||[])).next())})}function nt(ke){return this instanceof nt?(this.v=ke,this):new nt(ke)}function Pe(ke,qe,Le){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ft,Te=Le.apply(ke,qe||[]),ct=[];return ft=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),Fn("next"),Fn("throw"),Fn("return",function Qt(Jn){return function(lr){return Promise.resolve(lr).then(Jn,Ar)}}),ft[Symbol.asyncIterator]=function(){return this},ft;function Fn(Jn,lr){Te[Jn]&&(ft[Jn]=function(Wn){return new Promise(function(Mt,fn){ct.push([Jn,Wn,Mt,fn])>1||kr(Jn,Wn)})},lr&&(ft[Jn]=lr(ft[Jn])))}function kr(Jn,lr){try{!function _n(Jn){Jn.value instanceof nt?Promise.resolve(Jn.value.v).then(Fr,Ar):Ls(ct[0][2],Jn)}(Te[Jn](lr))}catch(Wn){Ls(ct[0][3],Wn)}}function Fr(Jn){kr("next",Jn)}function Ar(Jn){kr("throw",Jn)}function Ls(Jn,lr){Jn(lr),ct.shift(),ct.length&&kr(ct[0][0],ct[0][1])}}function be(ke){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Le,qe=ke[Symbol.asyncIterator];return qe?qe.call(ke):(ke=function Dt(ke){var qe="function"==typeof Symbol&&Symbol.iterator,Le=qe&&ke[qe],Te=0;if(Le)return Le.call(ke);if(ke&&"number"==typeof ke.length)return{next:function(){return ke&&Te>=ke.length&&(ke=void 0),{value:ke&&ke[Te++],done:!ke}}};throw new TypeError(qe?"Object is not iterable.":"Symbol.iterator is not defined.")}(ke),Le={},Te("next"),Te("throw"),Te("return"),Le[Symbol.asyncIterator]=function(){return this},Le);function Te(ct){Le[ct]=ke[ct]&&function(Qt){return new Promise(function(Fn,kr){!function ft(ct,Qt,Fn,kr){Promise.resolve(kr).then(function(_n){ct({value:_n,done:Fn})},Qt)}(Fn,kr,(Qt=ke[ct](Qt)).done,Qt.value)})}}}z.d(et,{FC:()=>Pe,KL:()=>be,_T:()=>He,mG:()=>X,qq:()=>nt}),"function"==typeof SuppressedError&&SuppressedError}},kt=>{kt(kt.s=2116)}]);